

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Exchange Sends Message Without Valid O/R Address </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181263">
<META NAME="KBModify" CONTENT="1998/02/25">
<META NAME="KBCreate" CONTENT="1998/02/17">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  There are three known symptoms: 1. Users receive non-delivery-reports (NDRs) such as below:     Your message did not reach some or all of the intended recipients.       Subject:                 Sent:                  The following recipient(s) coul...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QBG2,QAEV,QAID,QAC2,QAR2,QBVV,QAUJ,QAGU,QAYC,QAH6,QAR5,QAR4,QBWD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Exchange Sends Message Without Valid O/R Address</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 25, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181263</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 5.0 and 5.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
There are three known symptoms:
1. Users receive non-delivery-reports (NDRs) such as below:
<P>
<PRE>   Your message did not reach some or all of the intended recipients.
      Subject: &lt;subject&gt;
      Sent: &lt;date&gt; &lt;time&gt;
   The following recipient(s) could not be reached:
      '/O=ORG/OU=SITE/CN=RECIPIENTS/CN=USERA' on 24.11.97 18:24
          The recipient name is not recognized
          MSEXCH:MSExchangeMTA:Site:Server

</PRE><P><LI>In rare cases, the association to a third-party X.400 system may stop
   responding.
</OL>3. In rare cases, the sending Exchange message transfer agent (MTA) may
<PRE>   show 100 percent CPU usage.

</PRE></OL><h2>CAUSE</h2>
 
<P>
In a non-replicated environment, the Exchange MTA may not be able to
resolve a recipient's distinguished name within the Exchange directory. Non-
resolvable distinguished names result usually from invalid recipient
entries in the personal address book (PAB) of a user. If there is an X.400
Connector with an address space of 'C=*' defined, the MTA may attempt to
send a message destined for such a recipient via this connector. In doing
so, the MTA does not generate a valid X.400 O/R address but uses the
recipient's distinguished name as an X.400 directory name.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, Exchange sites connected via an X.400 Connector
with an address space of 'C=*' defined, should be configured as Connected
Sites in the X.400 Connector's Connected Sites property page. If this
resolution is not possible, obtain the following fix or wait for the next
Exchange service pack.
<P>
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Exchange Server versions
5.0 and 5.5.
A supported fix for both versions is now available, but has not been fully
regression-tested and should be applied only to systems experiencing this
specific problem. Unless you are severely impacted by this specific
problem, Microsoft recommends that you wait for the next Service Pack that
contains this fix. Contact Microsoft Technical Support for more
information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
All occurrences of the problem described here involve two or more non-
replicated Exchange sites. Additionally, there must be a connector defined
with the "catch-all" address space of 'C=*'.
<P>
For the above symptoms 2, association is hanging, and 3, MTA causes 100
percent CPU usage, an intermediate third-party X.400 system must be
involved.
<P>
<P>
There are currently three known reasons for the existence of a
distinguished name that cannot be resolved in a user's PAB:

<OL><P><LI>A user has been moved to a different non-replicated Exchange site.
   During this move, the user kept his or her PAB containing recipients
   defined in the original site's directory.
   NOTE: Moving PABs to non-replicated sites is not supported.

<P><LI>A user has been deleted from the directory, but the user has the deleted
   recipient still as an entry in his or her PAB.

<P><LI>This scenario involves two Exchange Server computers, referred to as
   ServerA and ServerB in the following. It involves three Exchange users:
   UserSend, UserForward, and UserReceive. UserSend and UserForward are
   located on ServerA. UserReceive is located on ServerB.
<P>
   ServerA and ServerB are connected via an X.400 Connector. Both sides of
   the X.400 Connector have an address space defined that represents the
   other server's site addressing. ServerB has an additional X.400
   Connector defined to either a third Exchange Server computer or a
   foreign X.400 MTA. The address space on that connector is defined as
   "C=*". The "X.400 bodypart used for message text" on the connector's
   Advanced property page must have different settings on both ends of the
   connector; for example, IA5 on ServerA and IA5 (German) on ServerB.
   
   UserSend sends a message to UserForward. UserForward sends a message to
   UserReceive, inserting the message received from UserSend as attachment
   to this message. When UserReceive opens the attached message,
   UserReceive will be able to add UserSend to his or her PAB. Viewing the
   just added e-mail address, it will be evident that it is a pure
   distinguished name. This distinguished name cannot be resolved within
   ServerB's directory.
<P>
<P>
<P>
<P>
<P>
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hang utilization NDR invalid Address<BR>
Keywords          : XADM kbusage<BR>
Version           : 5.0, 5.5<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 25, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
