

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: Retaining MS Mail Mailbox SMTP Addresses After Dirsync </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147534">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1996/02/25">
<META NAME="Keywords" CONTENT="kbusage XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  As part of the migration process from Microsoft Mail to Microsoft Exchange, Administrators may decide to start using the Internet Mail Connector (IMC) that ships with Microsoft Exchange instead of the Microsoft Mail SMTP Gateway.  In order to do th...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QAYC,QA5V,QAR5,QAJQ,QAR2,QBWD,QBVP,QAUJ,QAGU,QBW4,QAYZ,QAE1,QA3P,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Retaining MS Mail Mailbox SMTP Addresses After Dirsync</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147534</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
As part of the migration process from Microsoft Mail to Microsoft Exchange,
Administrators may decide to start using the Internet Mail Connector (IMC)
that ships with Microsoft Exchange instead of the Microsoft Mail SMTP
Gateway.
<P>
In order to do this, the Administrator needs to set up Directory
Synchronization (dirsync) between Microsoft Mail and Microsoft Exchange.
<P>
After Directory Synchronization has successfully completed, all the
Microsoft Mail mailboxes will now reside in the Microsoft Exchange
Directory as custom recipients. These custom recipients will however have a
different SMTP address than that of the corresponding Microsoft Mail
mailboxes.
<P>
To make the switch from the Microsoft Mail SMTP gateway to the IMC
transparent to the Microsoft Mail users, the Administrator may need to
change the SMTP address of each custom recipient so that it is the same as
the old SMTP address for each user. This will allow each Microsoft Mail
user to receive mail, via the IMC, at the same SMTP address that they used
prior to the introduction of Microsoft Exchange.
<P>
The rest of this article describes how an Exchange Administrator can add
another SMTP address to each MS Mail custom recipient. This new SMTP
address will be the same as the users old SMTP address.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article assumes that Directory Synchronization has been set up so that
all the Microsoft Mail custom recipients, created by Directory
Synchronization are created in a separate recipient container on the
Microsoft Exchange side. It can also be applied in the case where the
custom recipients for each Microsoft Mail postoffice have been created in a
separate container. As long as all the recipients in a container are
Microsoft Mail custom recipients, the information in this article will
apply.
<P>
The process of adding an additional SMTP type address to each Microsoft
Mail custom recipient involves exporting the custom recipient information
to a text file, modifying this text file and then importing this modified
information back into the Exchange Directory. The steps outlined below
explain how this is done.
<P>
The steps below refer to Microsoft Excel 7.0. Most other spreadsheet
programs could also be used.
<P>
Assume that the old SMTP address for the Microsoft Mail users is in the
format:
<P>
<PRE>   user@postoffice.company.com

</PRE><P><LI>From the Exchange Administrator program, select the "Directory Export"
   command from the "Tools" menu.

<P><LI> Select the container that holds the Microsoft Mail custom recipients.
<P><PRE>    If you have more than one such container, repeat these steps for each
    such container.
</PRE>
<P><LI> Select a file to export the information to (msmail.csv).

<P><LI> In the "Export Objects" section, select only "Custom recipient".

<P><LI> Click on the "Export" button. This should export all the user
<P><PRE>    information to the file selected (msmail.csv).
</PRE>
<P><LI> Open up the file msmail.csv in Microsoft Excel, or any other
<P><PRE>    spreadsheet that can read delimited text files.
</PRE>
<P><LI> The first line in this file should contain the object field names.
<P><PRE>    Check if you have a field called "Secondary-Proxy-Addresses". If not
    add this field to the cell at the end of the first line. Assume this
    cell is N1.
</PRE>
<P><LI> Sort all the rows based on the column titled "E-mail address". In
<P><PRE>    Microsoft Excel 7.0, this is done by selecting the "Sort" command from
    the "Data" menu and then selecting the column containing the "E-mail
    addresses" field, e.g. column I. This will sort all the rows so that
    the data displayed now is sorted by Microsoft Mail Network\Postoffice
    name.
</PRE>
<P><LI> Find the column titled "Alias Name". Note the spreadsheet column name,
<P><PRE>    e.g. column E.
</PRE>
<P><LI>Go to column I, (the column titled "E-mail address"). In the second
<P><PRE>    row of this column, note down the postoffice name in the e-mail
    address. For example, if the address is MS:35NET\35PO1\User1, the
    postoffice name is 35PO1.
</PRE>
<P><LI>Go to the cell N2 (the cell below the "Secondary-Proxy-Addresses"
<P><PRE>    cell). Type in ="SMTP:"&amp;E2&amp;"35PO1.company.com". Press the Enter key.
</PRE><P>
<P><PRE>    "E2" is the cell in the second row in the "Alias Name" column.
    "35PO1" is the name of the postoffice you obtained in step 10.
</PRE>
<P><LI>Look at the "E-mail address" column, column I. Count the number of rows
<P><PRE>    from the second row that have the same Network and postoffice name
    (35NET\35PO1 in this example). Suppose there are 150 rows. Hence the
    last row with the same Network\Postoffice name should be Row 151.
</PRE>
<P><LI>Select the cell N2 (the cell below the "Secondary-Proxy-Addresses"
<P><PRE>    cell). Move the mouse cursor to the bottom right corner of this cell.
    The cursor should now change to a + (plus) sign.
</PRE>
<P><LI>While the cursor is a + sign, hold down the left mouse button and drag
<P><PRE>    the cursor to Row 151, which is the last row with the same
    Network\Postoffice name in the e-mail address. (you determined this row
    in step 12). Microsoft Excel should have automatically filled in all
    the cells, in column N up to row 151, with the correct SMTP addresses.
    These addresses should look like:
</PRE><P>
<P><PRE>       user@35PO1.company.com
</PRE><P>
<P><PRE>    where user is the alias name of each record (row in the spreadsheet).
</PRE>
<P><LI>Starting at Row 152 (the first row with the new Network\Postoffice
<P><PRE>    name), repeat steps 11 - 14, for each new Network\Postoffice name.
</PRE>
<P><LI>Save this file and quit from Microsoft Excel.

<P><LI>From the Exchange Administrator program, select the "Directory Import"
<P><PRE>    command from the "Tools" menu.
</PRE>
<P><LI>Select the file you just modified (msmail.csv).

<P><LI>Click on the "Import" button.

<P><LI>The new SMTP address should now be added to each custom recipients'
<P><PRE>    e-mail addresses. This can be verified by bringing up the properties of
    a custom recipient and selecting the "E-mail Addresses" property page.
    The new SMTP address should appear in the list with type "smtp"
    (lowercase smtp).
</PRE><P>
</OL>External Internet users will now be able to send mail to the MS Mail users,
through the IMC, at their old SMTP addresses and this mail will now be
delivered to the MS Mail users via the MS Mail Connector.
<P>
NOTE: When Microsoft Mail users send mail out to the Internet through the
IMC, these messages will appear to have come from the SMTP address that was
automatically generated by dirsync for each custom recipient. This is the
address with type "SMTP" (uppercase SMTP) in the list of e-mail addresses
for each custom recipient. The new address we just added is of type "smtp"
(lowercase smtp). Microsoft Exchange assumes the uppercase SMTP type
address to be the default outgoing address.
<P>
Instead of using the above steps to manipulate the .CSV file, a simple
program or macro could also be written to perform the same task of adding
the "Secondary-Proxy-Addresses" field to each record in the .CSV file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: schedule plus<BR>
Keywords            : kbusage XFOR<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
