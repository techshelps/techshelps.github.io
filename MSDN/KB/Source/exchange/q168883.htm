

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: 4037 Event Starting Internet Mail Service, 1067 IMC Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168883">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1997/05/21">
<META NAME="Keywords" CONTENT="XFOR kbtshoot kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Internet Mail Service (or Internet Mail Connector, in version 4.0) stops responding and cannot be restarted. If you attempt to start it manually or run the Internet Mail Wizard, one of the following events appears in the event viewer's applicat...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAEF,QAEV,QAIJ,QAGB,QACK,QAY2,QAB4,QAO4,QAAP,QAPN,QBKX,QANJ,QA9N,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: 4037 Event Starting Internet Mail Service, 1067 IMC Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168883</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Internet Mail Service (or Internet Mail Connector, in version 4.0)
stops responding and cannot be restarted. If you attempt to start it
manually or run the Internet Mail Wizard, one of the following events
appears in the event viewer's application log:

<UL><LI>Event ID: 4037
   Type: Error
   Source: MSExchangeIMC
   Category: Internal Processing
   Description: An exception has occurred which was handled internally by
   the Internet Mail Connector. This may have resulted in a message not
   being delivered.

<LI>Event ID: 4037
   Type: Error
   Source: MSExchangeIMC
   Category: Internal Processing
   Description: An exception has occurred which was handled internally by
   the Internet Mail Service. This may have resulted in a message not being
   delivered.
<P>
</UL>If you are attempting to start the Internet Mail Connector, the following
error message is also displayed:
<P>
<PRE>   Could not start the Microsoft Exchange Internet Mail Connector service
   on \\&lt;servername&gt;.

   Error 1067: The process terminated unexpectedly.

</PRE>If you attempt to stop the Internet Mail Service, you will find that the
Stop button is unavailable.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may result from a corrupt message in the Exchange Server
directory (Imcdata\in or IMCdata\out folders). Resolving this condition is
the subject of this article.
<P>
The same error and symptom may result from a corrupted message in the MTA
store. For more information, see below under More Information.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem:

<OL><P><LI>Stop the Internet Mail Service using Kill.exe or Tlist from the Windows
   NT Resource Kit or BackOffice Resource Kit. The IMC service should show
   up as stopped in the Control Panel Services.

<P><LI>Create two sub-directories called temp under Imcdata\In and Imcdata\Out

<P><LI>Move all the files from Imcdata\in to Imcdata\in\temp and from
   Imcdata\out to Imcdata\out\temp.

<P><LI>Delete the file Imcdata\queue.dat.

<P><LI>Restart the Internet Mail Service. If it starts and stays on, test the
   normal operation, and then move to step 7.

<P><LI>If the IMC stops again, the corrupt message is not in the directory, but
   rather in the MTA store, and you have to follow the steps in the
   articles referenced in the More Information section below.

<P><LI>Move 50 percent of the messages from Imcdata\in\temp to Imcdata\in
   and\or from Imcdata\out\temp to Imcdata\out. Delete Queue.dat, and then
   stop the Internet Mail Service and restart it. If this process is
   successful, repeat it until you find the bad message(s) and move all the
   good messages out.
<P>
</OL>NOTE: Another method to find the bad message is to try moving all the files
from Imcdata\in to Imcdata\in\temp and from out to out\temp, while the IMC
is still in the locked state. You may receive a message that certain file
can not be moved because it is in use. This file is most probably the
corrupt file that the IMC crashed while trying to process it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The same error and symptom may result from a corrupted message in the MTA
store.
<P>
For additional information on troubleshooting a corrupted message in the
MTA store, please see the following articles in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: 165505
   TITLE     : XADM: How to View/Delete Messages in MTS-IN and MTS-OUT
               Queues

   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q157323.htm">Q157323</A></B>
   TITLE     : XCON: Identifying and/or Reconstructing a Connector Queue
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dr. watson<BR>
Keywords          : XFOR kbtshoot kbusage<BR>
Version           : WinNT:4.0,5.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
