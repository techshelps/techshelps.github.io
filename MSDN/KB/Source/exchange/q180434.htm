

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: How to Remove, Reinstall, and Verify Dirsync Configuration </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180434">
<META NAME="KBModify" CONTENT="1998/03/08">
<META NAME="KBCreate" CONTENT="1998/02/03">
<META NAME="Keywords" CONTENT="XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article describes how to remove and reinstall the directory  synchronization (dirsync) configuration on a Microsoft Exchange Server  computer that is configured as a dirsync server and a Microsoft Mail for  PC Networks computer that is configu...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBSO,QAEF,QBWS,QBQU,QBJZ,QAA1,QANE,QDIZ,QA9N,QAGB,QAFI,QDKD,QAIJ,QDI2,QDH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: How to Remove, Reinstall, and Verify Dirsync Configuration</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180434</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to remove and reinstall the directory 
synchronization (dirsync) configuration on a Microsoft Exchange Server 
computer that is configured as a dirsync server and a Microsoft Mail for 
PC Networks computer that is configured as a dirsync requestor. It also 
describes how to verify the dirsync configuration by performing a manual 
dirsync.
<P>
Removing, reinstalling, and verifying the dirsync configuration may help 
you resolve problems that arise when you attempt to perform directory 
synchronization between the two computers. Note that you should always 
remove and reinstall the configuration on both computers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Removing and Reinstalling on the Microsoft Exchange Server Computer</h3>
 
<P>
To remove and reinstall the dirsync configuration on a Microsoft Exchange 
Server computer that is configured as a dirsync server, follow these 
steps:

<OL><P><LI>Stop the Microsoft Exchange Directory Synchronization service. To do 
   so, follow these steps:
<P>
   a. In Control Panel, double-click Services.
<P>
   b. Click the Microsoft Exchange Directory Synchronization service, 
<P><PRE>      click Stop, click Yes, and then click Close.
</PRE>
<P><LI>Delete the dirsync server object in the Administrator program. To do 
   so, follow these steps:
<P>
   a. Click Start, point to Programs, point to Microsoft Exchange, and 
<P><PRE>      then click Microsoft Exchange Administrator.
</PRE><P>
   b. In the left pane, click Connections under the appropriate Microsoft 
<P><PRE>      Exchange Server site. In the right pane, click the dirsync server 
      object, click Delete on the Edit menu, and then click Yes.
</PRE><P>
<P><PRE>      NOTE: Before you delete the dirsync server object, you must delete 
      any requestor objects under it.
</PRE>
<P><LI>Delete the $System recipient. To do so, click Recipients under the 
   appropriate Microsoft Exchange Server site in the left pane of the 
   Administrator window. In the right pane, click the $System recipient, 
   click Delete on the Edit menu, and then click Yes.
<P>
   NOTE: The $System recipient is a hidden, custom recipient. To view this
   recipient in the Administrator program, verify that All and Hidden 
   Recipients are selected on the View menu.

<P><LI>Copy all the files in the Exchsrvr\Dxadata folder to a temporary 
   folder.

<P><LI>Create a new dirsync server object. To do so, follow these steps:
<P>
   a. In the Administrator program, point to New Other on the File menu, 
<P><PRE>      and then click Dirsync Server.
</PRE><P>
   b. Enter the appropriate information, and then click OK.

<P><LI>Enable maximum logging for dirsync. To do so, follow these steps:
<P>
   a. In the Administrator program, click the appropriate server in the 
<P><PRE>      left pane. In the right pane, click Directory Synchronization, and 
      then click Properties on the File menu.
</PRE><P>
   b. Click the Diagnostics Logging tab, click MSExchangeDX in the list of
<P><PRE>      categories, click Maximum, and then click OK.
</PRE>
<P><LI>Save the contents of the application log, and then clear all events
   from the log. To do so, follow these steps:
<P>
   a. Click Start, point to Programs, point to Administrative
<P><PRE>      Tools (Common), and then click Event Viewer.
</PRE><P>
   b. On the Log menu, click Application.
<P>
   c. On the Log menu, click Save As, type a file name in the File Name
<P><PRE>      box, and then click Save.
</PRE><P>
   d. On the Log menu, click Clear All Events, click No, and then click
<P><PRE>      Yes.
</PRE><P>
   e. On the Log menu, click Exit.

<P><LI>Start the Microsoft Exchange Directory Synchronization service. To do 
   so, follow these steps:
<P>
   a. In Control Panel, double-click Services.
<P>
   b. Click the Microsoft Exchange Directory Synchronization service, 
<P><PRE>      click Start, and then click Close.
</PRE><P>
</OL><h3>Removing and Reinstalling on the Microsoft Mail for PC Networks Computer</h3>
 
<P>
To remove and reinstall the dirsync configuration on a Microsoft Mail for 
PC Networks computer that is configured as a dirsync requestor, follow 
these steps:

<OL><P><LI>Reset the dirsync numbers. To do so, type the following command at a 
   command prompt, and then press ENTER:
<P>
<P><PRE>      listds admin -p&lt;password&gt; -d&lt;drive&gt; -r -z
</PRE><P>
   where &lt;password&gt; is the password for the Admin account and &lt;drive&gt; is 
   the network drive that is mapped to the Microsoft Mail postoffice.

<P><LI>Use the Microsoft Mail administrator program to perform a full export. 
   To do so, start the administrator program, select Config, select 
   DirSync, select Requestor, and then select Export.

<P><LI>Reset the dirsync mailbags. To do so, type the following commands at a 
   command prompt, pressing ENTER after each command:
<P>
<P><PRE>      cd exchsrvr\connect\msmcon\maildata\mbg
      ren system.mbg system.old
      ren inqueue.mbg inqueue.old
      cd exchsrvr\connect\msmcon\maildata\key
      ren system.key system.old
      ren inqueue.key inqueue.old
      debug system.key
</PRE><P>
   At the Debug prompt, type the following commands, pressing ENTER after 
   each command:
<P>
<P><PRE>      -rcx
      CX 0000
      :230
      -f100,32f,0
      -w
      -q
</PRE><P>
   Type the following commands at the command prompt, pressing ENTER after
   each command:
<P>
<P><PRE>      copy system.key inqueue.key
      cd exchsrvr\connect\msmcon\maildata\mbg
      type nul &gt; inqueue.mbg
      type nul &gt; system.mbg
</PRE><P>
</OL><h3>Verifying the Dirsync Configuration</h3>
 
<P>
To verify the dirsync configuration, perform a manual dirsync. For 
information about how to do so, please see the following article in the 
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCHANGE/Q147464.htm">Q147464</A></B>
   TITLE     : XFOR: Manual Dir-Sync with Exchange as Dir-Sync Server
</PRE></OL> 
<PRE>Keywords          : XFOR
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 8, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
