

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XADM: Slow Client Logon Due to Missing Addressing Template </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177308">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/11/25">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix5.00.sp2 XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The following are symptoms of this issue:     Slow client logons (up to 10 minutes or more) during peak logon hours or    even relatively slow logons for solitary or small group logons.     In the Windows NT Performance Monitor (PerfMon), Process, ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QA36,QAI5,QAR5,QAYV,QAMR,QBWD,QDO3,QBF0,QARL,QAA1,QBW7,QABI,QDI2,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Slow Client Logon Due to Missing Addressing Template</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177308</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following are symptoms of this issue:
<P>
<PRE>   Slow client logons (up to 10 minutes or more) during peak logon hours or
   even relatively slow logons for solitary or small group logons.

   In the Windows NT Performance Monitor (PerfMon), Process, % CPU
   utilization, DSAMAIN.EXE (DS) will sustain a very high CPU utilization
   percentage (75% or more) throughout the peak logon periods. In addition,
   the DS may jump up high for relatively long times (1-4 minutes) for
   solitary or small group logons (~5).

   Enabling the Directory Service logging, ExDS interface logging to
   maximum will log numerous "ds_read entered" and "ds_read completed"
   events (1136 and 1137, respectively). Also, enabling maximum MAPI
   interface, logs NspiBind events (1136 - client and otherwise).

   A network trace between the Exchange client and server may show that a
   long time elapses between when the first RPC OpNum2 request to the
   Store’s GUID is issued, and when the server actually returns an RPC
   response to this request.

</PRE><h2>CAUSE</h2>
 
<P>
When the client logs on, a comparison between the existence of One-off
address templates in the directory, and the Address-Types in the ODI cache
of the Store is performed. If an address-type exists in the ODI cache, but
a corresponding address template does not exist in the DS, a flag is set to
reload the ODI cache. The cache is reloaded, but the flag is never reset,
so a cache reload is continually signaled.
<P>
The logon process is serialized behind this cache reload.
<P>
This can noticeably impact logon if:

<OL><P><LI>There are many non-native Exchange address-types, or if a particular
   non-native Exchange address type has many entries in the Microsoft
   Exchange Administrator program under:
<P>
<P><PRE>      &lt;org&gt;/&lt;local-sitename&gt;/Configuration/Site Addressing/Routing tab
</PRE>
<P><LI>No address template is installed in the Site for this address-type.
<P>
</OL><h2>WORKAROUND</h2>
 
<P>
- Make sure that there is a one-off addressing template installed within
<PRE>  the Site for any non-native Exchange address-type.

</PRE></OL>- Examine \exchsrvr\mtadata\GWART0.MTA to derive a list of unique address
<PRE>  types.

</PRE>- View the list of installed one-off address templates under:
<P>
<PRE>     &lt;org&gt;/&lt;local-sitename&gt;/Configuration/Addressing/One-off Address
     Templates/&lt;language&gt;

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.0.
This problem has been corrected in the latest U.S. Service Pack for
Microsoft Exchange Server version 5.0. For information on obtaining the
Service Pack, query on the following word in the Microsoft Knowledge Base
(without the spaces):
S E R V P A C K
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A code change has been implemented to discriminate between the cases when
an address template is "not found" versus the case when "an error occurred
looking for an address template". The reload flag is no longer signaled for
the former case.
<P>
This case involved a single server Microsoft Exchange version 4.0 site that
had replicated with the rest of the organization, which included a mix of
Exchange 4.0 and 5.0 sites and servers. One of the 5.0 sites had
implemented a CCMAIL connector to an extensive cc:Mail installation. This
resulted in many CCMAIL routes being added into the routing table (GWART).
These routing entries were replicated throughout the organization.
<P>
Exchange 5.0 supports the CCMAIL address-type as a native Exchange address-
type, and includes a One-off Address template for this address-type.
Exchange 4.0 does not support the CCMAIL address-type as a native Exchange
address- type. The solitary Exchange 4.0 Site did not have a CCMAIL One-off
Address template installed, thus logons within this Site experienced this
inefficiency.
breakpoint
breakpoint
arrived?
 
<PRE>Keywords          : kbbug4.00 kbbug5.00 kbfix5.00.sp2 XADM
Version           : 4.0 5.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix kbpatch</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
