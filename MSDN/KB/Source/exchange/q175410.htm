

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: IMS/IMC Will not Dial an ISP as Specified </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175410">
<META NAME="KBModify" CONTENT="1998/01/02">
<META NAME="KBCreate" CONTENT="1997/10/20">
<META NAME="Keywords" CONTENT="XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Server version 5.0 Internet Mail Service (IMS) and the Microsoft Exchange Server version 4.0 Internet Mail Connector (IMC) may stop periodically when dialing an Internet Service Provider (ISP).  The dial-up schedule is specif...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWB,QBWP,QBVV,QAYC,QAH6,QAI5,QA1S,QBBI,QDJI,QBG2,QAJ4,QBXE,QAML,QAJ6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: IMS/IMC Will not Dial an ISP as Specified</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175410</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
<LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Server version 5.0 Internet Mail Service (IMS) and
the
Microsoft Exchange Server version 4.0 Internet Mail Connector (IMC) may
stop
periodically when dialing an Internet Service Provider (ISP).
<P>
The dial-up schedule is specified in the Dial-up Connections property page
in
the Microsoft Exchange Adminitrator program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Many ISP's require some sort of user input after the initial modem
connection
has been established. Typically this is to select the service type (for
example,
PPP) and to enter the user account details, in other words, the username
and
password. Because this input needs to be automated for the IMS or IMC to
connect
and send or receive mail, a 'post-connect' script is used. This script is
usually
supplied by the ISP, but it is also possible for you to write your own.
Please
refer to the script.doc in the \winnt\system32\ras directory on your
Windows NT
Server for further information on writing these scripts.
<P>
Occasionally, the ISP may not respond to the 'post-connect' script and
eventually
the IMS or IMC will disconnect from the ISP leaving the script processor
running.
This causes the Remote Access Service (RAS) port to remain locked open,
preventing
any further connections. The IMS or IMC will appear to not make any further
attempts to dial the ISP. Stopping and starting the IMS or IMC will cause
the
following event to be logged in the Windows NT Application Log on each
attempt to
dial the ISP:
<P>
<PRE>   Event ID: 4106
   Source: MSExchangeIMC
   Category: SMTP Interface Events

   The dial-up connection 'OzEmail' could not be made. The error reported
</PRE>was: [633]
<PRE>   The port is already in use or is not configured for Remote Access dial
</PRE>out.
<P>
Rebooting the Windows NT Server will free the locked RAS port.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this situation, a script will need to be written or modified that
has
specific timeout parameters for each 'waitfor' command. The success of each
<PRE>'waitfor'
</PRE>command should also be tested before the script proceeds to the next
command. If the
situation arises where the ISP does not respond to the script, the script
will stop
processing after the timeout has been reached and when the IMS or IMC
disconnects,
the RAS port will not remain locked thus allowing the IMS or IMC to redial
as
scheduled.
<P>
Here is a sample script with the additional timeout logic added. Please
note that
this script is specific to the OzEmail ISP in Australia and may not work
with any
other ISP. Please contact your ISP for further information as to the script
requirements.
<P>
<PRE>  ; OzEmail Script for PPP Access
  ;
  ; Developed by Brendan Helsham (mailto:brendanh@microsoft.com)
  ; Last revised: October 10 1997

  ; Main entry point to script

  proc main

     waitfor "ervice?" until 90
     if $SUCCESS then   ;  Checking whether this is successful...
     transmit "p^M"

     waitfor "sername:" until 60
     if $SUCCESS then   ;  Checking whether this is successful...
     transmit $USERID, raw
     transmit "^M"

     waitfor "assword:" until 60
     if $SUCCESS then   ;  Checking whether this is successful...
     transmit $PASSWORD, raw
     transmit "^M"

     endif
     endif
     endif

  endproc
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: exchange IMC IMS dial RAS locked 633 dun<BR>
Keywords          : XFOR<BR>
Version           : 4.0 5.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
