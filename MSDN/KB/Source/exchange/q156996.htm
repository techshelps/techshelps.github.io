

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XFOR: Postoffice Lists Disappearing from GAL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156996">
<META NAME="KBModify" CONTENT="1997/03/13">
<META NAME="KBCreate" CONTENT="1996/10/11">
<META NAME="Keywords" CONTENT="XFOR kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Entire postoffice lists disappear from the Global Address List (GAL) after you introduce Microsoft Exchange Server as a Directory Synchronization (dir- sync) Requestor to the dir-sync process.  CAUSE =====  If a Custom Recipient (CR) is manually de...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAVZ,QAC2,QA3P,QAY2,QAEF,QBXS,QAR5,QAM1,QAE1,QABA,QDO3,QBWD,QBVX,QBW4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Postoffice Lists Disappearing from GAL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156996</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbinterop kbbug4.00 kbfix4.00.sp3
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Entire postoffice lists disappear from the Global Address List (GAL) after
you introduce Microsoft Exchange Server as a Directory Synchronization (dir-
sync) Requestor to the dir-sync process.
<P>
<P><h2>CAUSE</h2>
 
<P>
If a Custom Recipient (CR) is manually defined on the Microsoft Exchange
Server for a user that resides on one of the Microsoft Mail postoffices,
the Microsoft Exchange Server where the CR was created believes it is
responsible for dir-sync for that address and that postoffice.
<P>
Please see the MORE INFORMATION section for a detailed explanation of the
reproduction scenario.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
A supported fix is now available for Microsoft Exchange Server version 4.0
that provides a new registry entry setting to correct this behavior.
<P>
Add a registry value RequireValidImpFrom of type REG_DWORD to:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeDX

</PRE>and set it to 1.
<P>
When dir-sync creates a list of transactions to send to a dir-sync Server,
if it finds a CR with the target address of type MS and the ImportedFrom
field has a value of NULL, it will silently drop that transaction and
continue. The ImportedFrom field for a record in the Directory is NULL only
if the CR was created manually or imported by the Microsoft Exchange
Administrator program. If a CR is created by means of dir-sync , the
ImportedFrom field will have the name of the Requestor Object in it.
<P>
If you set this value to 0, or if this value is not present, the Directory
Synchronization service (DXA) will behave as it did prior to the fix.
<P>
NOTE: This fix is only for address type MS. If CR of another type (SMTP,
SNADS, and so forth) is imported from a Microsoft Mail postoffice later,
the behavior of the DXA will be the same as before the fix.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0. This problem was corrected in the latest Microsoft Exchange
Service Pack. For information on obtaining the Service Pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
In this scenario, the Microsoft Mail postoffices are MSM1, MSM2, and MSM3.
MSM1 is the dir-sync server and dir-sync is fully working between these
three postoffices.
<P>
Now add a Microsoft Exchange Server as a requester to the dir-sync server
(MSM1) and manually add a CR to the Microsoft Exchange server with an
address that resides on any of the Microsoft Mail postoffices, in other
words, Network/Msm3/Testuser. Allow one dir-sync cycle to occur.
<P>
Upon completion of dir-sync, the Microsoft Exchange Server, MSM1, and MSM2
have all addresses from MSM1 and MSM2 but no addresses from MSM3.
<P>
Because of the CR that was created on the Microsoft Exchange Server, the
Microsoft Exchange Server will send out the following transactions to the
dir-sync server along with its normal Add transactions for the Microsoft
Exchange users that exist on the Microsoft Exchange Server.
<P>
<PRE>R NETWORK\MSM3            Tells the dir-sync  Server to discard all
                          addresses for MSM3
A NETWORK\MSM3\TESTUSER   Tells the dir-sync  Server to add TESTUSER
                          R NETWORK\SHADOW
</PRE>A NETWORK\SHADOW\USER1
A NETWORK\SHADOW\USER2
<P>
and so forth.
<P>
During a normal dir-sync  cycle, when a requestor requests a full export, a
Replace transaction will be sent only for its own postoffice. For example:
<P>
<PRE>R NETWORK\PO          Tells the dir-sync  Server to discard all addresses
                      for postoffice
A NETWORK\PO\USER1    Tells the dir-sync  Server to add USER1
</PRE>A NETWORK\PO\USER2
A NETWORK\PO\USER3
<P>
To get the addresses from MSM3 back into the dir-sync  stream, the
administrator must request that a full export be sent from the Microsoft
Mail postoffice (MSM3). You can achieve this by following these steps:

<OL><P><LI>Start Admin.exe against MSM3.
</OL>2. Choose Config-DirSync-Requester-Export and answer Yes to continue.
3. Exit Admin.exe
<P>
On the next dir-sync  cycle, T1, MSM3's full list will be resent to the
dir-sync server and therefore propagated out to the other requestors.
<P>
The fix for this should be applied and the aforementioned registry setting
should be set, or the Export Custom Recipients option should be cleared on
the dir-sync Requester object on the Export Containers' property page.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop<BR>
KBSubcategory: XFOR<BR>
Additional reference words: 4.00<BR>
Keywords            : XFOR kbinterop<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
