

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Gen: Basic Asynchronous Troubleshooting Procedures </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131513">
<META NAME="KBModify" CONTENT="1997/08/26">
<META NAME="KBCreate" CONTENT="1995/06/13">
<META NAME="Keywords" CONTENT="MailPCGen kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Asynchronous problems with Microsoft Mail for PC Networks can be caused by either hardware or software. The following basic troubleshooting procedures can be used to determine if the hardware is at fault.  MORE INFORMATION  Procedure A: Using the M...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QANE,QDJ9,QAS6,QAI5,QABA,QAWM,QDNQ,QBWS,QBXE,QDJP,QAKG,QABH,QA7O,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Gen: Basic Asynchronous Troubleshooting Procedures</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131513</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.20
MS-DOS
kbenv
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0 and 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Asynchronous problems with Microsoft Mail for PC Networks can be caused by
either hardware or software. The following basic troubleshooting procedures
can be used to determine if the hardware is at fault.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Procedure A: Using the MS-DOS ECHO Command to Check the Modem and Port</h3>
 

<OL><P><LI>Make sure that the modem is connected to a live phone line.
<P>
   NOTE: If an external modem is used, it is important to make sure that
   the cable is a standard straight-through RS-232 serial modem cable
   with no gender-changers on either end. A null-modem cable will not work
   for standard modems connecting via a phone line, nor will a serial
   printer cable work for this purpose. The length of this cable cannot
   exceed 25 feet.

<P><LI>From a MS-DOS command prompt, using the MS-DOS ECHO command, type the
   following command:
<P>
<P><PRE>      ECHO ATDT &gt; COMn
</PRE><P>
   where "n" is the COM port the modem is connected to.
<P>
   Notes:
<P>
<P><PRE>    - The command above is prompting the hardware on the defined port
      for a dialtone (ATDT=ATtention Dial Tone), the dial tone will
      continue for 30 seconds.
</PRE><P>
<P><PRE>    - To stop prompting the port for a dialtone, again using the
      MS-DOS "ECHO" command, type the following:
</PRE><P>
<PRE>         ECHO ATH &gt; COMn

</PRE><P><LI>If a dial tone was heard, go to Procedure C. If not, a "Write Fault
   Error" will appear. Go to the next procedure.
<P>
</OL><h3>Procedure B: Using Microsoft System Diagnostics to Check for IRQ Conflicts</h3>
 

<OL><P><LI>From MS-DOS, run Microsoft System Diagnostics (MSD.EXE) by typing
   MSD at a command prompt.
<P>
   NOTE: For accurate readings, make sure that you are not running MSD
   from a MS-DOS box in Windows or a Virtual MS-DOS Machine (VDM) in
   Windows NT.

<P><LI>Once in MSD, press the C key to check the COM Ports. The following are
   the default COM port settings (port address and IRQ address).
<P>
<PRE>                      COM1      COM2        COM3      COM4
</PRE></OL> 
<PRE>Port address (hex)   03F8H      02F8H      03E8H      02E8H
IRQ address            4          3          4          3

   NOTE: COM1 and COM3 share the same IRQ (IRQ 4), as do COM2 and COM4
   (IRQ3), so a mouse on COM1 cannot coexist with a modem on COM3.

</PRE><P><LI>When you check the COM port settings in MSD, if the modem is on COM1,
   make sure that COM3 is not displayed. If it is, changes need to be made
   with the system in either the system BIOS or a jumper setting on the
   motherboard, depending on the system configuration, or the conflicting
   piece of hardware's settings (for example, network adapters, sound
<P><PRE>    cards, mouse, etc.) need to be changed.
</PRE>
<P><LI>If no conflicts are shown, press the ESC key to exit Comm Ports.

<P><LI>Press the Q key to check the IRQ Status.

<P><LI>Using the table above, check the IRQ address for the COM port the modem
   is on. If there is a device other than default handlers detected for the
   port, changes may need to be made to hardware or software causing the
   conflict (for example, network adapters, sound cards, mouse, etc.). Keep
   in mind that the External program (EXTERNAL.EXE) and Microsoft Mail
   Remote for Windows use the default IRQs. Changes can be made for the
   External program to the EXTERNAL.INI file or command line settings with
   the entries:
<P>
<P><PRE>      AsyncCommPort=&lt;port&gt;, AsyncPort=&lt;address&gt;, AsyncInt=&lt;interrupt&gt;.
</PRE><P>
   The default IRQs must be used or Microsoft Mail Remote for Windows
   will not recognize the COM port. The changes must be made to the other
   device.

<P><LI>Press the ESC key to exit IRQ Status, and press the F3 key to exit
   MSD. If no conflicts were found, or if conflicts that existed in
   previous steps are resolved, go to the next procedure.
<P>
</OL>Procedure C: Checking the Quality of the Modem &amp; Cable on MTA w/ Terminal
 

<OL><P><LI>From Control Panel, double-click the Ports icon.

<P><LI>From the Ports dialog box, select the COM port connected to the modem,
   select the Settings button.

<P><LI>Change the flow control for the port to Hardware by selecting the down
   arrow button in the Flow Control field. Click OK. Click the Close
   button, and exit Control Panel.

<P><LI>From the Settings menu in Terminal, choose Communications.

<P><LI>Select the COM port the modem is connected to in the Connector field.

<P><LI>Select Hardware in the Flow Control field, and click OK.

<P><LI>From the Settings menu, choose Phone Number.

<P><LI>Enter the phone number of the External MTA in the Dial field.

<P><LI>Change the Time-out If Not Connected In [nn] Seconds option to 60
   seconds. Click OK.

<P><LI>Make sure that the modem is connected to a live phone line.

<P><LI>From the Phone menu, choose Dial.

<P><LI>Once connected, the External program will prompt for logon. "Logon:"
<P><PRE>    preceded and followed by control blocks being displayed.
</PRE><P>
   If the Logon prompt is displayed, the quality of the modem, and modem
   cable are satisfactory.
<P>
   If the Logon prompt is NOT displayed, test the following:
<P>
   - Try to swap modem cables.
<P>
   - Try a different modem.
<P>
   - Try swapping phone (RJ-11) cables.
<P>
   - Try a different phone line.
<P>
   - Try running EXTERNAL.EXE or Mail Remote from another workstation.
<P>
   - Make sure that the External Mail program files (EXTERNAL.* and *.OVL
<P><PRE>     from the \MAILEXE directory) are in a directory on the local hard
     disk that is in the PATH= statement in the AUTOEXEC.BAT file. Make
     sure that the files' paths are changed in the batch file from
     which EXTERNAL.EXE is executed.
</PRE><P>
   Run through the steps in Procedure C again after you make the
   necessary changes. Repeat as often as necessary.
<P>
</OL>NOTE: The Terminal settings above only work with Windows 3.x, Windows NT
3.1, 3.5, and 3.51. Windows 95 does NOT use TERMINAL.EXE, but instead uses
HyperTerminal.
<P>
To create a HyperTerminal connection to the External MTA for testing, use
the following procedure:

<OL><P><LI>Click on the Start button. Select Programs, Accessories, and
   HyperTerminal.
<P>
   NOTE: The icon for HyperTerminal is a folder.

<P><LI>Double-click the Hypertrm icon to create a New Connection.

<P><LI>In the Name field, type Test Logon to MTA. Click OK.

<P><LI>Type the number to the MTA in the Phone Number field, and select the
   appropriate modem in the Connect Using field. Click OK.
<P>
   NOTE: The modem must be installed using the Windows 95 Modem
   Wizard before it can be selected.

<P><LI>Click Dial to connect to the MTA.
<P>
</OL>Once you are connected, the External program will prompt you to log on. The
Logon: is preceded and followed by control blocks being displayed.
<P>
If the Logon prompt is displayed, the quality of the modem and modem cable
are satisfactory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information on the above EXTERNAL.INI settings, refer to the
Microsoft Mail for PC Networks "Administrator's Guide," pages 256-257 for
version 3.2 and 3.2a.
<P>
Below are some basic troubleshooting steps to determine if the problem is
due to the software driver or with the compatibility between the modem and
the script used.
<P>
NOTE: The most common incompatibility between the modem and script is while
you are receiving messages. Sending messages usually works fine.
<P>
A slightly corrupt \MAILDATA\GLB\MODEM.GLB file can cause intermittent
connection problems on the External MTA. To resolve this:

<OL><P><LI>Rename the \MAILDATA\GLB\MODEM.GLB file to MODEM.OLD using the MS-DOS
   RENAME command.

<P><LI>Run the Mail Administration utility (ADMIN.EXE), and reset the serial
   information using the Config, Serial options.
<P>
</OL>In addition, you can try to shut down and restart the External MTA. It has
been known to resolve some Remote user connectivity issues as well.
<P>
The External program and the Remote clients use a proprietary script
language for postoffice security reasons. This is designed to prevent
unauthorized users with a modem from hacking into the postoffice and
reading mail.
<P>
The following scripts work well with a variety of modems:
<P>
<PRE>   DEFAULT.SCR
   HAYES24.SCR
   HAYES96.SCR
   USGNERIC.SCR
   VSERIES.SCR
   USVSER96.SCR (included with Mail Remote for Windows version 3.2)

</PRE></OL>It may be necessary to modify an existing script file. MDM or MoDeM files
are included with the program for this purpose. Refer to the modem manual
for the S-Registers for the modem.
<P>
If this modem is not in the list of available modems, contact the modem
manufacturer for a script, for assistance in creating a script, or for help
with modifying an existing one.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../PCMAIL/Q99946.htm">Q99946</A></B>
   TITLE     : PC WRmt: Available Modem Scripts
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.20 Async<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCGen<BR>
Keywords          : MailPCGen kbenv<BR>
Version           : 3.00 3.20<BR>
Platform          : MS-DOS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
