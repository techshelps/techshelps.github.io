

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Win: Mail Message File (MMF) Compression </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q93134 ">
<META NAME="KBModify" CONTENT="1995/10/20">
<META NAME="KBCreate" CONTENT="1992/11/24">
<META NAME="Keywords" CONTENT="kbusage kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Version 3.0 of Microsoft Mail for Windows does not compress the data in the Mail message file (MMF); however, it does eliminate free space left behind when messages are deleted. As a result, Mail keeps the MMF file as small as possible.  Although M...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QBRZ,QBW5,QAPN,QAW6,QALG,QAEF,QAYV,QAFI,QAGB,QBV0,QAEV,QAEB,QBVV,QBUP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Win: Mail Message File (MMF) Compression</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q93134 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Version 3.0 of Microsoft Mail for Windows does not compress the data in the
Mail message file (MMF); however, it does eliminate free space left behind
when messages are deleted. As a result, Mail keeps the MMF file as small as
possible.
<P>
Although Mail does not do data compression, some people refer to the
cleanup process as "compression" or "background compression" and ask about
"compression ratios." This article explains exactly what Mail does to clean
up the MMF file after you delete objects. It also gives the amount of space
used in the MMF file by various objects.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An empty MMF file is about 32K in size. The MMF file grows as you add
objects (messages, attachments, folders, personal addresses, linked
objects, or embedded objects) to the MMF file. Each message requires about
128 bytes of overhead space and about 256 bytes for each attachment or OLE
object.
<P>
Because Mail does not do data compression, a 100K text file takes 100K to
store in the MMF file.
<P>
When you delete an object, Mail reuses that space in the MMF file whenever
possible rather than constantly shrinking the MMF file because the freed
space is usually in the middle of the MMF file. To shrink the MMF file,
Mail uses a background process to move objects around in the MMF file,
filling the holes left by deleted objects. By default, Mail doesn't start
the background process until there is 300K of free space in the MMF file.
It stops when there is 100K free. Entries can be placed in the MSMAIL.INI
file to change both of these values.
<P>
<P><h3>MMF File Space Used by Various Objects</h3>
 

<OL><P><LI>Folders -- use anywhere from 42 to 300 bytes per entry. A quick
   survey of a few folders in a few MMF files shows that the average is
   about 75 to 80 bytes per entry. In addition, each folder uses about
   30 bytes in the folder list (the list you see to the left of a
   message center viewer.

<P><LI>5000K text file -- uses 5000K plus 256 bytes plus the size of the
   icon if the text file is an attachment.

<P><LI>100K binary attachment -- uses 100K plus 256 bytes plus the size of
   the icon.

<P><LI>Address directory with 10,000 name entries of 500 characters per
   entry -- only Personal Address Book (PAB) entries are kept in the
   MMF file. A PAB entry of 500 characters would use about 720 bytes
   in the MMF file. It is unlikely that anyone would have 10,000
   names in their PAB. Address directories other than PABs take up
   space in the postoffice, not in the MMF file.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 store<BR>
KBCategory: kbusage kbenv<BR>
KBSubCategory: MailPCWin<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
