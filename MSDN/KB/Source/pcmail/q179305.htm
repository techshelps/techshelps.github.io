

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Async Mail Flow Connection Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179305">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1998/01/14">
<META NAME="Keywords" CONTENT="MailPCExt MailPCMMTA MailPCWRmt kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Periodically, asynchronous mail flow problems can arise during connection. The procedures in this article can be helpful in troubleshooting the problem.  MORE INFORMATION  To troubleshoot asynchronous mail flow problems:  1. Ensure Mail Agents on b...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAVW,QAVX,QAI5,QBG2,QA5E,QANE,QAB4,QAKP,QAYY,QAAP,QAHT,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Async Mail Flow Connection Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179305</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0, 3.2, 3.2a, 3.5
<LI>Microsoft Mail Remote for Windows, version 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Periodically, asynchronous mail flow problems can arise during connection.
The procedures in this article can be helpful in troubleshooting the
problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To troubleshoot asynchronous mail flow problems:

<OL><P><LI>Ensure Mail Agents on both sides of the connection can access the modem.
   At an MS-DOS prompt, type
<P>
<P><PRE>      ECHO ATDT &gt; COM#
</PRE><P>
   where # is the com port that the mail agent is configured to use.
<P>
   If another MS-DOS prompt is returned, the modem is accessible to the
   Mail Agent. If the error message, "Write fault error writing device
   COM#," is returned, the modem is not accessible to any Mail Agent. This
   must be resolved before the Mail Agents can use the modem. Often another
   application will be using the modem. Look for RAS, Fax applications, or
   any application that uses a modem.

<P><LI>Enable logging on both sides of the connection.
<P>
   a. For Microsoft Mail Remote for Windows, ensure that the System
<P><PRE>      Selector is set to Mail Remote for Windows.
</PRE><P>
   b. Edit Msmail.ini in the Windows directory. Under the [SFS Remote]
<P><PRE>      section, add the following entries and save the file.
</PRE><P>
<PRE>         DebugLog=1
         VerboseLog=1

   c. Restart the client. This detailed logging information can be viewed
      after the connection attempt by choosing &lt;VIEW&gt;&lt;SESSION LOG&gt; in the
      client. Information in this log is replaced by information from
      subsequent connection attempts. To save the information, it must be
      copied and pasted to another file to be saved.

   d. For External.exe, add the following options to the command line:

      -Q123Z -V -Lc:\logfile.txt

   e. Restart External. This detailed logging information can be viewed
      after the connection attempt by opening Logfile.txt. Information
      in this log is appended, so all subsequent connection attempts are
      written to this file. If you are using the Windows NT message
      transfer agent (MTA), you can add these options to the Command-Line
      Options box in the Edit Service dialog. The MTA service must be
      restarted for the change to take effect.

</PRE></OL>Additional information concerning the INI equivalents for the -Qx options
can be found in <B><A HREF="../PCMAIL/Q116434.htm">Q116434</A></B> (see below).

<OL><P><LI>Determine whether there are any errors. Some typical errors are:

</OL></UL><LI>Time out occurred while reading data at the serial layer.

<LI>Time out occurred while writing data at the serial layer.
<P>
   These errors typically point to a problem with the modem script. Verify
   with the modem manufacturer that the appropriate script is being used
   for the modem.

<LI>Sign-on ID or password incorrect.

<LI>Postoffice has not accepted mail item.
<P>
   These errors can indicate a postoffice serial number problem. Ensure
   that the &lt;EXTERNAL ADMIN&gt;&lt;SETUP&gt; information in Admin.exe is correct for
   the postoffice being called. Also, create a new data disk for remote
   users having these problems.

</UL><OL><P><LI>Determine line diagnostics. These appear in the log after each
   connection attempt when -Q2Z is enabled. A sample listing:
<P>
<PRE>      TEST      1-1-98 12:00 Diagnostics for connection:
      TEST      1-1-98 12:00 Bad STX     0
      TEST      1-1-98 12:00 Bad TYPE    0
      TEST      1-1-98 12:00 Bad SEQ     0
      TEST      1-1-98 12:00 Bad CRC1    0
      TEST      1-1-98 12:00 Bad CRC2    0
      TEST      1-1-98 12:00 Time-outs   0
      TEST      1-1-98 12:00 Rejects     0

</PRE></OL>If any of the above diagnostic results are other than zero, this may
indicate "dirty" phone lines. Microsoft cannot guarantee asynchronous mail
flow over a connection indicating anything greater than 0 for these
diagnostics. This can also be an indication of incompatible modem and
script combination. More detailed information regarding these measurements
can be found in Microsoft Knowledge Base article <B><A HREF="../PCMAIL/Q80272.htm">Q80272</A></B> (see below).
<P>
For additional information concerning the INI equivalents for the -Qx
options, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../PCMAIL/Q116434.htm">Q116434</A></B>
   TITLE     : PC Ext: External.ini Equivalents to -Qx Command-Line Options

</PRE></UL>For additional information concerning diagnostic results other than zero,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../PCMAIL/Q80272.htm">Q80272</A></B>
   TITLE     : PC Ext: Diagnostics Produced by the -Qz Parameter on
               External
</PRE> 
<PRE>Keywords          : MailPCExt MailPCMMTA MailPCWRmt kbtshoot
Version           : WINDOWS:3.0,3.2,3.2a,3.5
Platform          : WINDOWS
Issue type        : kbinfo
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
