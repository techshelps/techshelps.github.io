

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Forms: Err Msg: Bad Command Line (on Delivery) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128519">
<META NAME="KBModify" CONTENT="1995/04/04">
<META NAME="KBCreate" CONTENT="1995/04/03">
<META NAME="Keywords" CONTENT="kbprg kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you receive a message containing an electronic form created with version 1.0 of Microsoft Electronic Forms Designer, you may receive the following error:     Bad Command Line  This error will occur when the message is initially received, but i...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH6,QBXT,QA5V,QAIB,QAJQ,QA36,QAPF,QAH4,QAJN,QACI,QAEV,QBWS,QBV8,QAI2,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Forms: Err Msg: Bad Command Line (on Delivery)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128519</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Electronic Forms Designer, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you receive a message containing an electronic form created with
version 1.0 of Microsoft Electronic Forms Designer, you may receive the
following error:
<P>
<PRE>   Bad Command Line

</PRE>This error will occur when the message is initially received, but it will
not occur if the user attempts to open the same message after it has been
delivered.
<P>
<P><h2>CAUSE</h2>
 
<P>
This will occur in the MEFPhone sample, MEFRoute sample, or any E-forms
created using the Template project and the custom command declaration in
either SHARED.INI or MSMAIL.INI that specifies the form should be activated
on delivery. By default, there is no code in the Template project to
support activation on delivery. To check to see if the form is installed to
be activated on delivery or not, see if the array position 7 (position 0 to
15) is 1 or 0 on the form declaration entry in MSMAIL.INI or SHARED.INI.
<P>
Below is an example of a form declaration where the array position 7 (the
8th flag) of the operation map is set to 1 for activation upon delivery.
<P>
<PRE>   [Custom Messages]
   ; all should be on the same line

   IPM.Microsoft.MEFPhone=3.0;;Telephone
    Note;;C:\WINDOWS\SYSTEM\MEFLIB.DLL;&lt;MC:IPM.Microsoft.MEFPhone&gt;
   C:\EFORMS\PROJECTS\PHONE\MEFPHONE.EXE -MSG &lt;COMMAND&gt;
   &lt;MESSAGEID&gt;;1111111100000000;Microsoft Sample Telephone Note;;;

</PRE><h2>RESOLUTION</h2>
 
<P>
To prevent this error, it is necessary to add support for activation on
delivery. The following steps will modify the Template project so that any
new forms created will support opening the form on delivery. Any existing
projects, including the MEFPhone and MEFRoute samples would need to be
modified in a similar manner to support this functionality.

<OL><P><LI>From Microsoft Visual Basic, open the Template project.

<P><LI>Open the EFORM.BAS file included with the project.

<P><LI>In the Proc: window, select ParseCommandLine.

<P><LI>Locate following the program line:
<P>
<P><PRE>      Select Case gCommand
</PRE>
<P><LI>Three lines below that, you should find the following code fragment:
<P>
<P><PRE>      ----------
      Case wcommandOpen
<PRE></PRE>                  If gMessage.Flags And MAPI_SENT Then
                      frmRead.Show
                  Else
                      frmCompose.Show
                  End If
      ----------

   Change it to read:

      ----------
      Case wcommandOpen, wcommandDelivery
                  If gMessage.Flags And MAPI_SENT Then
                      frmRead.Show
                  Else
                      frmCompose.Show
                  End If
      ----------

</PRE><P><LI>Save changes to the Template project.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
For more information on the custom command declaration and the
operation map, refer to the Microsoft Electronic Forms Designer
version 1.0 "Developer's Guide," Chapter 12.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbprg kberrmsg<BR>
KBSubcategory: MailPCForms<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
