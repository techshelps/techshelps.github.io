

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC MAPI: Visual Basic Example for C Code in Tech Reference </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122998">
<META NAME="KBModify" CONTENT="1994/11/22">
<META NAME="KBCreate" CONTENT="1994/11/17">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  The Microsoft Mail for PC Networks  Technical Reference  includes a Microsoft C programming language source code example for sending a mail message and attachment using MAPI. However, no such code is provided for Visual Basic.  MORE INFORMATION  Th...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBS0,QAI4,QBFY,QAPF,QAYC,QABG,QAB3,QA5F,QAMA,QAL7,QALO,QAK6,QAH6,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC MAPI: Visual Basic Example for C Code in Tech Reference</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 22, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122998</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0 and 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Mail for PC Networks "Technical Reference" includes a
Microsoft C programming language source code example for sending a mail
message and attachment using MAPI. However, no such code is provided for
Visual Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code is the Visual Basic equivalent of the C code example
found in the Technical Reference guide.
<P>
<PRE>' ***************************************************
' Visual Basic equivalent of the C programming language
' sample found in the Microsoft Mail Technical Reference
' ***************************************************
</PRE>Dim M As MapiMessage
Dim Mo As MapiRecip
ReDim R(0 To 1) As MapiRecip
ReDim F(0 To 0) As MapiFile
NL = Chr(10)
<P>
F(0).Reserved = 0&amp;
F(0).Flags = 0&amp;
F(0).Position = -1
F(0).PathName = "C:\budget17.wk3"
F(0).FileName = "budget17.wk3"
F(0).FileType = ""
<P>
Msg1$ = "Attached is the budget proposal. "
Msg2$ = "See you Monday."
<P>
M.Subject = Msg1$ + Msg2$
M.MessageType = ""
M.RecipCount = 2
M.FileCount = 1
<P>
R(0).Reserved = 0&amp;
R(0).RecipClass = MAPI_To
R(0).Name = "Sally Jones"
R(0).EIDSize = 0&amp;
R(0).EntryID = ""
<P>
R(1).Reserved = 0&amp;
R(1).RecipClass = MAPI_To
R(1).Name = "Marketing"
R(1).EIDSize = 0&amp;
R(1).EntryID = ""
<P>
rc&amp; = MAPILogon(0&amp;, "admin", "password", 0&amp;, 0&amp;, lhSession&amp;)
<P>
rc&amp; = MAPISendMail(0&amp;, 0&amp;, M, R(0), F(0), 0&amp;, 0&amp;)
If rc&amp; &lt;&gt; SUCCESS_SUCCESS Then MsgBox "Unable to send the message."
<P>
rc&amp; = MAPILogoff(lhSession&amp;, 0&amp;, 0&amp;, 0&amp;)
End
<PRE>' ****************************
' End of source code
' ****************************

</PRE>To get the code to work, MAPILogon and MAPILogoff function calls have been
included in the source code.
<P>
Additional Reference words 3.00 3.20

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory: MailPCMAPI<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 22, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
