

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Ext: Explanation of .PBB and .0LK Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128913">
<META NAME="KBModify" CONTENT="1995/04/21">
<META NAME="KBCreate" CONTENT="1995/04/13">
<META NAME="Keywords" CONTENT="kbother kbref">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  The Microsoft Mail for PC Networks EXTERNAL.EXE program creates .0LK and .PBB files when transferring mail via asynchronous (async) or X.25 communication links. This article provides an explanation of these files.  MORE INFORMATION  A Microsoft Mai...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAJQ,QAWM,QAJZ,QAGU,QANN,QAH4,QAH6,QAEV,QABT,QASR,QAEF,QAY2,QAOG,QAA8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Ext: Explanation of .PBB and .0LK Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128913</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0, 3.2, and 3.2a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Mail for PC Networks EXTERNAL.EXE program creates .0LK and
.PBB files when transferring mail via asynchronous (async) or X.25
communication links. This article provides an explanation of these files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A Microsoft Mail for PC Networks mail system may contain more than one
EXTERNAL.EXE to send mail to either a remote user or an external
postoffice. Likewise, multiple EXTERNAL.EXE programs may serve identical
functions (for example, operate against the same group of postoffices or
remote users). If more than one EXTERNAL.EXE is used against the same
postoffices, the programs must be able to access and generate mail items
without conflicting with one another.
<P>
The .0LK file is used to control access to a specific mail outbound queue,
and the .PBB file is used to ensure that the same mail item can be sent to
multiple destinations by different Externals at the same time.
<P>
<P><h3>OLK Files</h3>
 
<P>
For outbound mail, EXTERNAL.EXE "locks" the mailbag containing the outbound
mail by creating a semaphore file in the P1 subdirectory. The creation and
use of semaphore files in the P1 subdirectory keeps multiple EXTERNAL.EXE
programs from trying to do the same operation against the same mailbag.
Only the EXTERNAL.EXE that currently owns the lock file can send outbound
mail from the mailbag. When the session is completed, the lock is removed.
<P>
The semaphore locking mechanism is a three step process. The first step is
the creation of a file with the mailbag name for a prefix, and .0LK for a
suffix. The file is created in the P1 subdirectory. The second step is to
verify that there are no older types of lock files. The third step is to
open the file with read/write, deny-all permissions. If these steps
succeed, the EXTERNAL.EXE program can service the mailbag. When the session
is complete, the file is closed and deleted.
<P>
If the lock file is stranded for any reason (system hang, machine rebooted
in middle of session, etc.), this file-stranding event does not
automatically create a problem. This will depend on the status of the file
at the server.
<P>
The existence of the file is not a problem in itself, because the next
EXTERNAL.EXE to attempt a lock may be able to open the stranded semaphore
lock file, perform the mail transfer operations, and remove the semaphore
file when finished. If none of the External programs can use the lock file,
it will have to be manually closed through the server administrative
functions.
<P>
<P><h3>PBB Files</h3>
 
<P>
For each message, only one .MAI file is created. Therefore, even though a
single message may be sent to many users, only one .MAI file has been
created for that message. When multiple EXTERNAL.EXE programs deliver the
same mail message from a single postoffice to different users (either
different remote users or different postoffices), each EXTERNAL.EXE program
references that single .MAI file from each of the remote users (or
postoffices) individual mailbag files. For example, Remote User One and
Remote User Two, each have their own mailbag file. Both of those mailbag
files point to a single .MAI message file. Because each remote user has his
or her own mailbag, two separate EXTERNAL.EXE programs may deliver that
single message to both users at the same time.
<P>
To send that single message to each remote user or postoffice, the
EXTERNAL.EXE program must generate a file containing the addressing
information for that .MAI message file. Each instance of EXTERNAL.EXE must
generate a unique addressing-information file for each remote user or
postoffice.
<P>
These unique addressing-information files have the format of XXXXXXXX.PBB
where XXXXXXXX is the hexadecimal identifier (hex-id) of the .MAI file and
the BB is a two letter identifier generated as described in the following
paragraphs. An example of such a file is 000005AF.PBB. EXTERNAL.EXE
generates and places the PBB files in the P1 subdirectory of the
postoffice.
<P>
During a remote or dispatch session, EXTERNAL.EXE generates a unique P1
Locking ID or extension before generating any outgoing mail. It does this
via an algorithm that tries to create a file LOCKP1ID.xxx, where xxx is an
extension that can be anything from .PBB to .PZZ. If LOCKP1ID.PBB is
already in use, an attempt to create "LOCKP1ID.PBC" is done. If this cannot
be done, then the extension is again incremented until all possibilities
are exhausted. There are at least 500 possible combinations, so the
probability of that many concurrent sessions occurring is incredibly small.
<P>
Once the P1 lock (that is, extension) is generated for the session,
EXTERNAL.EXE uses it for the filename extension for generating the
addressing-information file. This allows for multiple EXTERNAL.EXEs to
dispatch the same piece of mail to multiple remote recipients. You will get
filenames like xxx.PBB and xxx.PBC for the same piece of outgoing mail
if a concurrent transmission is occurring (the prefix will be the same as
the .MAI).
<P>
When the session is complete, EXTERNAL.EXE will clean up by deleting any
generated files, including the lock file(s).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 olk OLK mia semophore<BR>
KBCategory: kbother kbref<BR>
KBSubcategory: MailPCExt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
