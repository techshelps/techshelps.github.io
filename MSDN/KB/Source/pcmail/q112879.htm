

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FFAPI: Address List Contains Local Postoffice Addresses </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112879">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/03/22">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Microsoft Mail for PC Networks Mail users may notice addresses from their local Postoffice Address List have been added to the Microsoft File Format API (FFAPI) network/postoffice list. These local postoffice addresses may also appear twice in the ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QAR5,QA3P,QAYC,QBVW,QAEV,QAE1,QBWD,QBW4,QAVZ,QBWU,QA49,QAH5,QAWK,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FFAPI: Address List Contains Local Postoffice Addresses</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112879</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MS-DOS
kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail Software Development Kit (FFAPI), version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Mail for PC Networks Mail users may notice addresses from their
local Postoffice Address List have been added to the Microsoft File Format
API (FFAPI) network/postoffice list. These local postoffice addresses may
also appear twice in the Global Address List.
<P>
This problem will only appear on postoffices that are downstream of the
FFAPI Gateway postoffice.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem is caused by the Administrator of a downstream postoffice
exporting the local postoffice address list to the FFAPI
network/postoffice.
<P>
When the Administrator of a downstream postoffice performs an
External-Admin, Export, and selects to export the local postoffice address
list to ALL postoffices, ADMIN.EXE will send the addresses as a *SPECIAL
system message to all external postoffices - including any downstream
FFAPI network/postoffices definitions.
<P>
The FFAPI-based gateway will attempt to deliver this system message to the
foreign mail system, but may return it as undeliverable because *SPECIAL is
not a valid address.
<P>
When External moves the returned message from the gateway postoffice to the
downstream postoffice, it will recognize the message as a valid *SPECIAL
system message and will add the addresses contained within the message to
the address listed as the FROM address, which will be the FFAPI gateway
network/postoffice that rejected the message.
<P>
If the Global Address List (GAL) is rebuilt (via DirSync or manually using
the REBUILD.EXE utility), each local postoffice user will appear twice in
the GAL.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This problem can be avoided by selectively exporting the postoffice
address list rather than exporting to all postoffices. When selecting
the postoffices to export to, do not include the Mail Connection
proxy postoffice.
<P>
A second option would be to have the FFAPI gateway handle a message
addressed to FFAPINET/FFAPIPO/*SPECIAL in a different manner than normal
messages. This message can be handled one of three ways:

<UL><LI>The gateway simply deletes these messages if they come in.

<LI>The gateway returns the message back to any account other than
   *SPECIAL stating the addressee is invalid.

<LI>The gateway forwards the message to an account stating the
   *SPECIAL addressee is invalid.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in version 3.0 of Microsoft
Mail Software Development Kit (FFAPI). We are researching this problem and
will post new information in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you have encountered this problem, use the following instructions to
repair the Mail Connection proxy address list and the Global Address List
on the downstream postoffice.

<OL><P><LI>Use the IMPORT.EXE utility to extract the FFAPI Gateway address list
   from the Directory Synchronization postoffice:
<P>
<P><PRE>      IMPORT admin -ppassword -xFFAPIET/FFAPIPO -fFFAPINME.DAT -DM
</PRE><P>
   admin = Administrator's Mailbox name
   password = Administrator's Mailbox password
   FFAPIET/FFAPIPO = the FFAPI gateway NETWORK/POSTOFFICE
   FFAPINME.DAT = filename to store extracted addresses
   -DM = drive letter mapped to dirsync server postoffice

<P><LI>Import the extracted FFAPI gateway network/postoffice addresses
   into the downstream postoffice:
<P>
<P><PRE>      IMPORT admin -p&lt;password&gt; -fFFAPINME.DAT -DN
</PRE><P>
   admin = Administrator's Mailbox name
   password = Administrator's Mailbox password
   FFAPINME.DAT = name of input file (extracted in step 1)
   -DN = drive letter mapped to downstream postoffice

<P><LI>If the local postoffice users appear twice in the Global Address List,
   run the REBUILD.EXE utility to regenerate the GAL on the downstream
   postoffice.
<P>
<P><PRE>      REBUILD -DN
</PRE><P>
   -DN = Drive letter mapped to downstream postoffice
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20 Duplicate GAL POL Export Corrupt<BR>
KBCategory: kb3rdparty<BR>
KBSubcategory: MailGWFFAPI<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
