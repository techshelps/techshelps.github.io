

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC MAPI: How To Determine if a Mail Session Already Exists </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128963">
<META NAME="KBModify" CONTENT="1995/04/17">
<META NAME="KBCreate" CONTENT="1995/04/16">
<META NAME="Keywords" CONTENT="kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When a you use the Microsoft Mail for PC Networks Simple Messaging Application Programming Interface (Simple MAPI), you can fairly reliably determine if an Microsoft Mail for Windows session is currently established. This information is helpful due...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAYC,QAH6,QAI4,QAHD,QBS0,QA01,QA6X,QAL7,QAH7,QADK,QAD7,QAMA,QBW7,QAEV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC MAPI: How To Determine if a Mail Session Already Exists</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128963</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0 and 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a you use the Microsoft Mail for PC Networks Simple Messaging
Application Programming Interface (Simple MAPI), you can fairly reliably
determine if an Microsoft Mail for Windows session is currently
established. This information is helpful due to the design of the Windows
client and the inability to have multiple simultaneous logins.
<P>
When it is largely unknown to the developer if a session will currently be
running, the following Microsoft Visual Basic version 3.0 code logic can be
helpful in reducing login errors.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code fragment is just one example of how to optimize a
successful login, without user intervention. This should be helpful for
developers who want to maximize their applications ability to login
successfully.
<P>
NOTE: The message box calls are merely for clarity.
<P>
<PRE>Sub Form_Load ()
' ***                         ***
' *** Start sample login code ***
' ***                         ***

</PRE>rc&amp; = MAPILogon(0&amp;, "", "", 0&amp;, 0&amp;, lhSession&amp;)
If rc&amp; &lt;&gt; SUCCESS_SUCCESS Then
<PRE>  MsgBox "Login Error or session does not exist = " + Str(rc&amp;)
  ' No session exists so lets pass info to create one
  rc&amp; = MAPILogon(0&amp;, "admin", "password", 0&amp;, 0&amp;, lhSession&amp;)
  If rc&amp; &lt;&gt; SUCCESS_SUCCESS Then
    MsgBox "Failure to login at all"
    End
  Else
    MsgBox "Successfully logged in as admin"
    ' Send important message
    rc&amp; = MAPILogoff(lhSession&amp;, 0&amp;, 0&amp;, 0&amp;)
    End
  End If

</PRE>Else
<PRE>  MsgBox "Mail session currently established"
  ' Send important message
  rc&amp; = MAPILogoff(lhSession&amp;, 0&amp;, 0&amp;, 0&amp;)
</PRE>End If
<P>
End
<PRE>End Sub
'*** end code fragment ***'
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.20 MS Mail Technical Reference<BR>
KBCategory: kbtool kbprg kbcode<BR>
KBSubcategory: MailPCMAPI<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
