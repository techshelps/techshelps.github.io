

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Forms: Err Msg: Illegal Function Call </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107771">
<META NAME="KBModify" CONTENT="1997/02/06">
<META NAME="KBCreate" CONTENT="1993/11/29">
<META NAME="Keywords" CONTENT="kbusage kbinterop kbprg kbenv kberrmsg kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you choose the Select E-Form command from the Mail menu of versions 3.0, 3.0b, or 3.2 of Microsoft Mail for Windows, you may receive the following error message:     Illegal Function Call  You may also receive this error message when you selec...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAB4,QBS0,QAI5,QAGI,QBWS,QA5J,QA5I,QAY5,QAY2,QAB9,QBV8,QAG2,QBG2,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Forms: Err Msg: Illegal Function Call</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107771</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Electronic Forms Designer, version 1.0, running with
   Microsoft Mail for PC Networks, version 3.0, 3.0b, or 3.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you choose the Select E-Form command from the Mail menu of versions
3.0, 3.0b, or 3.2 of Microsoft Mail for Windows, you may receive the
following error message:
<P>
<PRE>   Illegal Function Call

</PRE>You may also receive this error message when you select the Route command
in Microsoft Word or Excel.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error sometimes indicates that a universal naming convention (UNC)
path is defined for the SharedExtensionsDir in the MSMAIL.INI file. The
Browser application code that parses a UNC shared extensions path may fail
if the UNC path does not contain a backslash (\) as the last character in
its definition. For example, the following MSMAIL.INI entry may generate
the above error:
<P>
<PRE>   SharedExtensionsDir=\\servername\share

</PRE><h2>RESOLUTION</h2>
 
<P>
To solve the problem, add a "\" to the end of the path definition:
<P>
<PRE>   SharedExtensionsDir=\\servername\share\

</PRE><h2>MORE INFORMATION</h2>
 
<P>
You can also solve this problem by modifying the Browser application code
that handles UNC paths. To do so:

<OL><P><LI>Open the BROWSER.MAK project in Visual Basic (VB\EFORMS\MEFBROWS).

<P><LI>From the Project window, select BROWSER.FRM. Click the View Code button.

<P><LI>From the Proc: list box, select fConnectShared.

<P><LI>Modify the code as follows:
<P>
<P><PRE>      If Left(szSharedDir, 2) = "\\" Then
<PRE></PRE>         ' Handle UNC path and obtain connection substring length
         ' Ensure that the path doesn't end in a trailing slash
         If (Right(szSharedDir, 1) = "\") Then
             szSharedDir = Left(szSharedDir, Len(szSharedDir) - 1)
         End If
         iShare = InStr(3, szSharedDir, "\")
         iPath = Len(szSharedDir)

         ' see if a connection already exists
         szNetDrive = SzExistingConnection(Left(szSharedDir, iPath))

         If szNetDrive = "" Then
         ' No previous connection exists, find a free drive letter
            szNetDrive = GetFreeDrive()
         ' and connect if a drive is free
            If szNetDrive = "" Then
               ' No free drive is available to connect
               FConnectShared = False
               Exit Function
            ElseIf WNetAddConnection(Left(szSharedDir, iPath), "",
      szNetDrive) &lt;&gt; 0 Then
               ' Connection failed
               FConnectShared = False
               Exit Function
            End If
         End If
         szSharedDir = szNetDrive &amp; Right(szSharedDir,
      Len(szSharedDir) - iPath)
      End If

</PRE></OL>NOTE: Code that wraps to a new line here should be entered on the same line
in Visual Basic. Also, this is not the most streamlined code for this
procedure, it requires the fewest changes from the original.

<OL><P><LI>Choose Make .EXE File from the File menu and replace the existing
   MEFBROWS.EXE in the WINDOWS subdirectory.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b 3.20<BR>
KBCategory: kbusage kbinterop kbprg kbenv kberrmsg kbtlc<BR>
KBSubcategory: MailPCForms<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
