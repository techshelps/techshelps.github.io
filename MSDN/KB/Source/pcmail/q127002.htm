

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Ext: Err Msg: A Critical Error Has Occurred... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127002">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1995/03/08">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you run EXTERNAL.EXE, the following error may be displayed and placed in the SESSION.LOG (if logging is enabled):     12-30-94 09:47  A Critical error has occurred M:KEY\xxxxxxxx.KEY  where M: can be any drive letter that a PO is mapped to, an...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVX,QAAP,QAVW,QAB4,QAUD,QALG,QABI,QAP2,QBXS,QAWM,QAGU,QAKP,QBWS,QAO4,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Ext: Err Msg: A Critical Error Has Occurred...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127002</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00a 3.20 3.20a
MS-DOS
kbother kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0a, 3.2, and 3.2a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run EXTERNAL.EXE, the following error may be displayed and placed
in the SESSION.LOG (if logging is enabled):
<P>
<PRE>   12-30-94 09:47  A Critical error has occurred M:KEY\xxxxxxxx.KEY

</PRE>where M: can be any drive letter that a PO is mapped to, and xxxxxxxx.KEY
can be any address for an external postoffice.
<P>
<P><h2>CAUSE</h2>
 
<P>
NOTE: Critical errors may also be due to hardware or network problems. For
further information, query on "error code =" and "device =".
<P>
Hidden, locked, or corrupt .KEY files may cause the above error. Check the
screen or the SESSION.LOG for lines matching the above description. It may
be necessary to activate the /LogVerbose (-v) and /LogSession (-l) options
to accomplish this.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure the specified files are not locked, hidden, or corrupt. If the
file is corrupt, either restore the file from backup or reset the &lt;hex-
id&gt;.KEY and &lt;hex-id&gt;.MBG files. This can be done with one of the following
procedures:
<P>
<P><h3>Procedure 1</h3>
 
<P>
To RESET the &lt;hex-id&gt;.KEY to 560 bytes, type:
<P>
<PRE>   DEBUG &lt;hex-id&gt;.KEY &lt;Enter&gt;
   At the "-" type "F100,32F,0" &lt;Enter&gt;
   At the "-" type "RCX"  &lt;Enter&gt;
   The following will then be displayed:
   CX 1230
   :

   At the ":" type "230" &lt;Enter&gt; (this resets the file to 560 bytes)
   At the "-" type "W"  &lt;Enter&gt; (you should see the message "Writing
   00230 bytes")
   At the "-" type "Q" &lt;Enter&gt; (to quit DEBUG)

</PRE>The filesize should be 560 bytes.
<P>
To RESET the &lt;hex-id&gt;.MBG to 0 bytes, type:
<P>
<PRE>   TYPE NUL &gt; &lt;hex-id&gt;.MBG

</PRE>The correct filesize should be 0 bytes.
<P>
<P><h3>Procedure 2</h3>
 

<OL><P><LI>Run Admin, Local-Admin, Create to create a test user.

<P><LI>Run LISTUSER.EXE with the -f option against the PO to determine the
    hex-id of the test user.

<P><LI>Copy the test user's &lt;hex-id&gt;.KEY and &lt;hex-id&gt;.MBG to the corrupt
    &lt;hex-id&gt;.KEY and &lt;hex-id&gt;.MBG.

<P><LI>Run Admin, Local-Admin, Delete to delete the test user.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../PCMAIL/Q117427.htm">Q117427</A></B>
   TITLE     : MS-DOS External 3.2 and RebootOnCE

   ARTICLE-ID: <B><A HREF="../PCMAIL/Q116434.htm">Q116434</A></B>
   TITLE     : EXTERNAL.INI Equivalents to -Qx Command-Line Options
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00a 3.20 3.20a external critical error key<BR>
KBCategory: kbother kberrmsg<BR>
KBSubcategory: MailPCExt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
