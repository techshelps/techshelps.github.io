

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Forms: User Setup for Running on Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113083">
<META NAME="KBModify" CONTENT="1996/06/03">
<META NAME="KBCreate" CONTENT="1994/03/24">
<META NAME="Keywords" CONTENT="kbtool kberrmsg kbtshoot kbfile">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Microsoft provides additional files necessary to set up version 1.0 of Microsoft Electronic Forms Designer on workstations running version 3.1 of Microsoft Mail for Windows NT. The initial release of E-Forms includes a User Setup program and files ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QAYC,QAFI,QBXB,QAXB,QATJ,QBWO,QABI,QBWS,QDIZ,QA3A,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Forms: User Setup for Running on Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113083</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Electronic Forms Designer, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft provides additional files necessary to set up version 1.0 of
Microsoft Electronic Forms Designer on workstations running version 3.1 of
Microsoft Mail for Windows NT. The initial release of E-Forms includes a
User Setup program and files that perform with the 16-bit MSMAIL.EXE file
under Windows NT. However, in order for E-Forms to interface with
MSMAIL32.EXE (the 32-bit Mail client included with Windows NT), you need
to use the User Setup programs, SETUP32.EXE and MEFINST.EXE, which are
included with this update.
<P>
For complete information about obtaining and installing the SETUP32.EXE and
MEFINST.EXE files, see the following sections:

<UL><LI>To download the updated files
<LI>To install the Setup files on the server
<LI>To replace your SETUP32.EXE and MEFINST.EXE files
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This update contains additional files necessary to set up version 1.0 of
Microsoft Electronic Forms Designer on workstations running version 3.1 of
Microsoft Mail for Windows NT. The initial release of E-Forms includes a
User Setup program and files that perform with the 16-bit MSMAIL.EXE file
under Windows NT. However, in order for E-Forms to interface with
MSMAIL32.EXE (the 32-bit Mail client included with Windows NT), you need to
use the User Setup programs, SETUP32.EXE and MEFINST.EXE, which are
included with this update.
<P>
Before following the steps listed below, use the Server Setup program for
Electronic Forms to install the User Setup files to a shared directory on
the network. For more information, see page 123 of the Electronic Forms
Designer "Developer's Guide." Make sure you complete this process before
continuing.
<P>
<P><h3>To download the updated files</h3>
 
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/FRMUPD.EXE">FRMUPD.EXE</A> <I>(size: 63179 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A HREF="http://support.microsoft.com/download/support/mslfiles/FRMUPD.EXE">FRMUPD.EXE</A> <I>(size: 63179 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/FRMUPD.EXE">FRMUPD.EXE</A> <I>(size: 63179 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location.
      Type "mssupport" (without the quotation marks).
      Double-click the MS Software Library icon.
      Find the appropriate product area.
      Locate and Download FRMUPD.EXE.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/FRMUPD.EXE">FRMUPD.EXE</A> <I>(size: 63179 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>After you download FRMUPD.EXE to a clean directory, run it (by typing
"frmupd" at the MS-DOS prompt) to extract the contents of the file.
You should receive the following files:
<P>
<PRE>   MAPI.DLL    (19,760 bytes, dated 11-29-93,  5:11 P.M.)
   MEFINST.EXE (16,896 bytes, dated  2-21-94, 10:53 P.M.)
   MEFLIB.DLL  (25,088 bytes, dated 11-19-93,  5:41 P.M.
   MEFXEC.EXE  (19,280 bytes, dated 10-21-93,  1:30 P.M.)
   SETUP32.EXE (18,432 bytes, dated 12/08/93,  1:24 P.M.)
   README.TXT

</PRE><h3>To install the Setup files on the server</h3>
 
<P>
The administrator must complete the following steps to correctly
install E-Forms Windows NT Setup files on the server:
<P>
At the MS-DOS command prompt, type the following and press ENTER
<P>
<PRE>   copy path:\*.* destination

</PRE>where &lt;path&gt; is the drive and directory where you ran the self-extracting
FRMUPD.EXE file and &lt;destination&gt; is the drive and directory where the
E-Forms User Setup executables currently reside. For example, if you ran
the self-extracting file from the TEST directory on drive D, and your
existing shared E-Forms directory is located in the MAILDATA\ADDONS\EFORMS
directory on drive M, type the following command:
<P>
<PRE>   copy d:\test\*.* m:\maildata\addons\eforms

</PRE><h3>To set up E-Forms on a Windows NT workstation</h3>
 
<P>
Notes:
<P>
Prior to trying to install E-forms for Windows NT, do the following:

<UL><LI>Verify that the SETUP.INI file in the directory with SETUP32.EXE
   contains the correct entries for SharedExtensionsDir= and maximum= .

<LI>Have the user logoff and logon.

<LI>Run SETUP32.EXE from the install point.

<LI>Run MEFINST.EXE from the install point.
<P>
</UL>If any program has called any of the DLLs used by Mail the SETUP32.EXE
process fails to update the registry, which in turn results in the
inoperability of E-Forms in the Windows NT mail client.
<P>
Each user must complete the following steps to correctly install
E-Forms on his or her machine:

<OL><P><LI>If the Windows NT workstation is using Microsoft Mail or any
   application that uses Microsoft Mail (such as Microsoft Schedule+,
   Microsoft Word, or Microsoft Excel), Exit and Sign Out of Microsoft
   Mail.

<P><LI>Use File Manager to connect the workstation to the shared E-Forms
   directory on the network (for example, MAILDATA\ADDONS\EFORMS).

<P><LI>Double-click SETUP32.EXE in the EFORMS subdirectory.

<P><LI>When the following prompt appears:
<P>
<P><PRE>      Please enter the full path of the E-Form files...
</PRE><P>
   enter the path to the shared E-Forms directory on the
   network (for example, M:\MAILDATA\ADDONS\EFORMS). Click Continue.
   The standard E-Forms Setup program will run.

<P><LI>To complete the installation on the Windows NT workstation, double-
   click MEFINST.EXE in the EFORMS subdirectory.

<P><LI>When the dialog box Windows NT Libraries for E-Forms appears,
   verify that Install Libraries and Fix Previously Installed E-
   Forms are selected. Click OK.
<P>
   NOTE: The Install Libraries option copies 32-bit versions of the
   E-Forms library files to the SYSTEM32 directory. The Fix
   Previously Installed E-Forms option attempts to update existing custom
   message declarations in the Registry database to interface with the
   new 32-bit E-Forms files.
<P>
</OL>Notes

<UL><LI>The Setup programs included with this update, SETUP32.EXE and
   MEFINST.EXE, are exclusively designed to configure E-Forms to
   run on a Windows NT workstation running MSMAIL32.EXE. In order to
   use E-Forms with the 16-bit version of Mail under Windows NT, you
   should run the SETUP.EXE file included with version 1.0 of
   Electronic Forms Designer.

<LI>This update installation should be performed on a clean installation
   of Windows NT and the 32-bit Windows NT Mail Client. There should
   not be any existence of any pervious versions of Microsoft Mail files.

<LI>If the E-Form custom message types are defined in a SHARED.INI file
   on a shared extensions directory, a new SHARED32.INI file needs to
   be created. If a SharedExtensionsDir setting is defined for Mail,
   the MSMAIL32.EXE file looks for a SHARED32.INI file upon start up.
   By default, the E-Forms Setup program creates only the SHARED.INI
   file.

<LI>To create a SHARED32.INI file for the MSMAIL32.EXE client, copy the
   existing SHARED.INI file to SHARED32.INI. Any updates to the custom
   message declarations in the shared files should be made to both the
   SHARED.INI and SHARED32.INI files.

<LI>E-Forms can be installed and configured to run with MSMAIL.EXE or
   MSMAIL32.EXE, but not both if Windows 3.x and Windows NT share the
   same directory.

<LI>When you open an E-Form, the E-Forms window may appear beneath the
   current window if the E-Form Cache has been turned on. To turn the
   cache off, you may need to modify the Registry database. For more
   information, see pages 137-138 of the Electronic Forms Designer
   "Developer's Guide."
<P>
</UL><h3>Troubleshooting E-Forms on Windows NT</h3>
 
<P>
Notes:

<UL><LI>The troubleshooting information in this article should only be used
   after you have applied the update described above to a Microsoft
   Windows NT machine running the 32-bit Microsoft Mail client with
   Electronic Forms Designer.

<LI>The following describes some reasons why electronic forms (E-Forms) can
   fail on a Windows NT machine running the 32-bit Windows NT Mail client.

<LI>The following three components are involved in the operation of
   E-forms on Windows NT.
<P>
<PRE>      \WINNT\SYSTEM32\MEFLIB.DLL   11/19/93   04:41p  (32 bit)
      \WINNT\SYSTEM\MEFXEC.EXE     10/21/93   12:30p  (16 bit)
      \WINNT\SYSTEM\MEFLIB.DLL     05/06/93   12:00a  (16 bit)

   The MEFLIB.DLL version found in the \WINNT\SYSTEM32 directory is a
   32-bit file that performs addressing translation for calls made to
   the 16-bit MEFLIB.DLL found in the \WINNT\SYSTEM directory.

</PRE></OL><h3>Possible Issues and Resolutions</h3>
 

<OL><P><LI>When you use Electronic Forms Designer with Microsoft Windows NT
   32-bit Mail client, you may get the following error:
<P>
<P><PRE>      &lt;path&gt; the DLL for this mail extension (or one of its components)
      could not be found. Check your mail configuration, and if changes
      are necessary restart mail.
</PRE><P>
   There may be an incorrect setting for MEFLIB.DLL in the Windows
   NT registry database. This information can be found in the Custom
   Commands or Custom Messages section under the H_KEY_CURRENT_USER
   on Local Machine\Software\Microsoft\Mail contains the entries for all
   E-Forms.
<P>
   Also, there should be no path associated with MEFLIB.DLL. Windows NT
   will load this file only from the \WINNT\SYSTEM32 directory.
   Also make sure \WINNT\SYSTEM is not on the PATH statement in the
   AUTOEXEC.BAT file.

<P><LI>If the wrong version of MEFLIB.DLL (16-bit version) is placed
   in the \WINNT\SYSTEM32 directory, you will get the following error:
<P>
<P><PRE>      The application or DLL \DosDevices\C:\WINNT\SYSTEM32
      \MEFLIB.DLL is not a valid Windows NT image. Please
      check this against your installation diskette.
</PRE><P>
   Make sure the 32 bit MEFLIB.DLL (11/19/93 04:41p ) is present in
   the \WINNT\SYSTEM32 directory

<P><LI>Shared Extensions Directory setting in the Windows NT Registration
   Database is missing or invalid.
<P>
   The Shared Extensions value must be present in the Microsoft Mail Key
   of the Registration Database. To edit the entry, go to the
   H_KEY_CURRENT_USER on Local Machine\Software
   \Microsoft \Mail\Microsoft Mail. Make sure the following entry is
   there:
<P>
<P><PRE>      SharedExtensionsDir:REG_SZ:M:\ADDONS\
</PRE><P>
   This is required so that BROWSER.EXE can find the available forms upon
   startup.

<P><LI>Missing a SHARED32.INI file in the shared extensions directory, for
   example, M:\MAILDATA\ADDONS.
<P>
   This file is a duplicate of the SHARED.INI file that is in the
   \ADDONS directory.
<P>
   Make a copy of SHARED.INI, and rename it to SHARED32.INI. This file
   will give the definitions of the forms that come with the Electronic
   Forms Designer. The following information should be in SHARED32.INI:
<P>
<P><PRE>      [Custom Messages]
      IPM.Microsoft.MEFPhone=3.0;;Telephone
      Note;;MEFLIB.DLL;&lt;MC:IPM.Microsoft.MEFPhone&gt;&lt;ExtsDir&gt;EFORMS\PHONE
      \MEFPHONE.EXE -MSG &lt;COMMAND&gt; &lt;MESSAGEID&gt;;1111111000000000;Microsoft
      Telephone Note;;;IPM.Microsoft.MEFRouting=3.0;;Routing
      Form;;MEFLIB.DLL;&lt;MC:IPM.Microsoft.MEFRouting&gt;&lt;ExtsDir&gt;EFORMS\ROUTE
      \MEFROUTE.EXE -MSG &lt;COMMAND&gt; &lt;MESSAGEID&gt;;1111111000000000;Microsoft
      Routing Form;;;;IPM.VendorName.Sample=3.0;;Sample Shared
      Declaration;;MEFLIB.DLL;&lt;MC:IPM.VendorName.Sample&gt;&lt;ExtsDir&gt;EFORMS
      \SAMPLE\SAMPLE.EXE -MSG&lt;COMMAND&gt;&lt;MESSAGEID&gt;;1111111000000000;
      Description of Shared Sample Form;;;
</PRE>
<P><LI>E-Forms can fail because it can not locate the 16-bit versions of
   MEFXEC.EXE and/or MEFLIB.DLL, or either file is missing or corrupt.
   No error is returned, and there may be a brief moment where the
   mouse pointer will display a the hourglass cursor (the please wait
   status).
<P>
   If MEFXEC.EXE and/or MEFLIB.DLL are missing from the \WINNT\SYSTEM
   directory, replace the correct files, or reinstall E-Forms Designer.

<P><LI>If there is a working directory set in Program Manager for the
   Windows NT Mail icon properties for \WINNT\SYSTEM32, you will get the
   hourglass cursor, as if the files were missing or corrupt.
<P>
   To work around this problem, remove the working directory path, and
   restart Mail.

<P><LI>After you use E-Forms and exit Windows NT 32-bit Mail, you may not
   be able to restart the client. No error is returned, and there may
   be a brief moment where the mouse pointer will display the
   hourglass cursor. Logging out of Windows NT at that time will result
   in the system reporting that the previously run form is still in memory.
<P>
   To work around this problem, disable the E-Forms cache by setting the
   maximum E-Forms cache value in the registry to 0. If the MSMAIL.INI
   file is in the WINNT directory, make sure the maximum cache value is
   also set to 0.

<P><LI>If problems regarding E-Forms still persist.
<P>
   It is not recommended to have both the Windows NT Mail (32-bit) and
   Microsoft Mail for PC Networks (16-bit) clients installed on the same
   machine.
<P>
   You should determine which client you wish to maintain. If Windows NT
   Mail is used, the 16-bit client and all its components should be
   removed (with the exception of the MSMAIL.INI and SHARED.INI files).
<P>
   Please refer to the Microsoft Knowledge Base for a list of all files
   that are installed with Windows and/or Windows for Workgroups mail
   clients. These files should be removed; the 32-bit Windows NT Mail
   client files must be reinstalled, and the update must be reapplied.
<P>
</OL>For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../PCMAIL/Q131638.htm">Q131638</A></B>
   TITLE     : Client Files for Windows for Workgroups Mail

   ARTICLE-ID: <B><A HREF="../PCMAIL/Q132045.htm">Q132045</A></B>
   TITLE     : Files Installed with Version 3.2a
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbtool kberrmsg kbtshoot kbfile<BR>
KBSubcategory: MailPCForms<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
