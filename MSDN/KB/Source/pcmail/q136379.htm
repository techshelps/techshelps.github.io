

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FFAPI: Err Msg: [021] Message Was Not Delivered Due to... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136379">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/09/06">
<META NAME="Keywords" CONTENT="MailGWFFAPI kbenv kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you send a message and later receive a non-delivery message, the following message may be included:     [021] Message was not delivered due to missing routing file.  The message is also placed in the SYSTEM.LOG of the postoffice of the recipie...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAEV,QBVV,QAM5,QAEF,QBD2,QAXB,QAB4,QBCT,QAWM,QAO4,QAH6,QAGC,QAGB,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FFAPI: Err Msg: [021] Message Was Not Delivered Due to...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136379</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MS-DOS
kbenv kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail Software Development Kit: FFAPI for Gateways and
   Applications, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you send a message and later receive a non-delivery message, the
following message may be included:
<P>
<PRE>   [021] Message was not delivered due to missing routing file.

</PRE>The message is also placed in the SYSTEM.LOG of the postoffice of the
recipient. This non-delivery message can be inappropriate in that the
recipient has received the message.
<P>
<P><h2>CAUSE</h2>
 
<P>
Gateways and FFAPI-based applications can contribute to the occurrence of
this incorrect message. When these programs execute the mailer process,
they will delete the routing file prior to updating the inqueue of the
postoffice. When the inqueue cannot be updated due to file contention, a
reference will continue to exist for a message that has no associated
routing file. This will cause the 021 message on the next cycle of inqueue
processing.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
When possible, the following steps should be taken to reduce the occurrence
of these errors.

<UL><LI>Use the mailer disable option on gateways that support this option.
   When you use the mailer disable option, an external program must be
   available to perform the mailer option. (Version 3.2 and later of
   the External Mail program (EXTERNAL.EXE will not delete the routing
   file if the inqueue cannot be updated.)
<P>
   The SMTP and X400 gateways support -md (mailer disable.)

<LI>Place gateways and FFAPI-based applications on postoffices that have
   a minimal amount of inqueue activity. This will reduce the occurrence
   of inqueue file contention and increase the likelihood that the
   inqueue will be updated successfully.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in version 3.0 of Microsoft
Mail Software Development Kit: FFAPI for Gateways and Applications. A fix
for this problem is in development, but has not been regression-tested and
may be destabilizing in production environments. Contact Microsoft Product
Support Services for more information on the availability of this fix.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Mailer is the process that handles mail that has been posted to the inqueue
mailbag of a postoffice. The process involves posting a message header into
each recipients mailbag, updating the inqueue to remove the reference to
the mail item, and deleting the routing file that was used to identify
local recipients of the message.
<P>
The 021 error can occur when the mailer process is unable to access the
inqueue to delete the reference to the mail item following mail delivery.
On a subsequent mailer process, a header is found that no longer has a
routing file associated with it. This produces the 021 error message in the
SYSTEM.LOG and results in the non-delivery notice being sent to the sender
of the mail item.
<P>
NOTE: The problem described in this article will not occur in mail systems
that have version 3.2 or later of the External Mail program. These versions
of External will not delete the routing file when the inqueue cannot be
updated.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 inqueue3 key pcmail<BR>
KBCategory: kbenv kberrmsg<BR>
KBSubcategory: MailGWFFAPI<BR>
Keywords          : MailGWFFAPI kbenv kberrmsg<BR>
Version           : 3.00<BR>
Platform          : MS-DOS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
