

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC DirSync: Err Msg: File Error Sorting Queue USRTRANS.GLB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112301">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1994/03/06">
<META NAME="Keywords" CONTENT="kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  The update transactions that were expected may not appear in the Global Address List (GAL) and the following error messages may appear in the DIRSYNC.LOG file:     FATAL [150] Could not append transactions to the updates file    ERROR [45]  File er...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QDOX,QDIJ,QAVZ,QAJZ,QAFI,QAKP,QBF0,QAYC,QBXS,QBXB,QBWS,QAY2,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC DirSync: Err Msg: File Error Sorting Queue USRTRANS.GLB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112301</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0, 3.2, and 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The update transactions that were expected may not appear in the Global
Address List (GAL) and the following error messages may appear in the
DIRSYNC.LOG file:
<P>
<PRE>   FATAL [150] Could not append transactions to the updates file
   ERROR [45]  File error sorting queue usrtrans.glb

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when the USRTRANS.GLB file is corrupted. The corruption
may be due to a network problem. If this is the case, network rights and
network hardware may need to be examined. Slow or unreliable network
interface cards in the workstation or file server may need to be examined
as well.
<P>
Another cause of the Error [45] is if there is a SORTLOCK.GLB file in the
postoffice's GLB subdirectory. SORTLOCK.GLB is a temporary file that
ensures that IMPORT.EXE is not run on the same PO at the same time.
<P>
An additional cause for an error 45 is a corrupt REQCONF.GLB file.
Depending on the nature of the corruption, LISTDS may be
used to fix the corrupt file. The problems with the REQCONF.GLB result in
ONLY an error 45 in the DIRSYNC.LOG with no accompanying errors:
<P>
<PRE>   Status      Microsoft (R) Mail Import v3.2
   Error [45]  File error sorting queue: USRTRANS
   Status      Import is finished.

</PRE>NOTE: The specific issues dealt with had a corrupt pointer to the USRTRANS
file in the REQCONF.GLB. This was corrected by setting all of the
pointers (4 total) to -1.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The USRTRANS.GLB file needs to be reset to zero bytes, and the requestor
postoffice must ask for a full import from the directory synchronization
(Dir-Sync) server, by following these steps:

<OL><P><LI>From MS-DOS, change to the GLB subdirectory in the Mail database.

<P><LI>Use the MS-DOS TYPE command to reset the size of the USRTRANS.GLB file
   to zero bytes:
<P>
<P><PRE>      type NUL &gt; USRTRANS.GLB
</PRE>
<P><LI>Delete the temporary files if they are present in the GLB directory:
   IGWTRANS.GLB, INMETRAN.GLB, IUSRTRAN.GLB, SRVUPDS.GLB, REQUPDS.GLB,
   and any SORTxxx files, where XXXX is a number.
<P>
   Verify that SRVTRANS.GLB, GWTRANS.GLB, and NMETRANS.GLB are
   zero bytes.

<P><LI>Verify that:
<P>
   a. There is sufficient disk space available by going to the Dir-Sync
<P><PRE>      Server, adding the file sizes for all USR files in the USR
      subdirectory in the Mail database, then tripling that amount.
</PRE><P>
   b. The workstation running DISPATCH.EXE has set FILES=60 (or greater)
<P><PRE>      in the CONFIG.SYS file.
</PRE><P>
   c. There are sufficient network access rights available for the dispatch
<P><PRE>      machine.
</PRE><P>
   d. The network hardware is reliable.

<P><LI>Allow Dir-Sync to run through another cycle.
<P>
</OL>If the error reoccurs after these steps, perform steps 1 and 2 again, and
then proceed with the following steps:

<OL><P><LI>Run IMPORT.EXE on the Dir-Sync Server. Use the following command to
   create the RESYNC.GLB file.
<P>
<P><PRE>      option '-S'
</PRE>
<P><LI>Copy the RESYNC.GLB file from the Dir-Sync server's GLB directory to the
   requestor's GLB directory.

<P><LI>Delete the RESYNC.GLB file from the Dir-Sync server.

<P><LI>Allow Dir-Sync to run through another cycle.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: fatal150 error45 150 45<BR>
Keywords          : kbfaq<BR>
Version           : 3.00 3.00a 3.20 3.50<BR>
Platform          : MS-DOS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
