

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC Gen: README.TXT: Mail 3.5 Diagnostics Utility </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134753">
<META NAME="KBModify" CONTENT="1995/08/14">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="kbreadme">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT=" The following is the README.TXT from the version 3.5 Microsoft Mail for PC Networks Mail Diagnostics disk.           MICROSOFT MAIL POSTOFFICE DIAGNOSTICS UTILITY          =============================================  THIS UTILITY IS PROVIDED  AS I...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QABH,QABI,QBCU,QAYC,QAGU,QAB4,QAZV,QAM1,QAAP,QAFI,QAI5,QAH4,QAJH,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Gen: README.TXT: Mail 3.5 Diagnostics Utility</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 14, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134753</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, version 3.5
</UL> 
<P>
The following is the README.TXT from the version 3.5 Microsoft Mail for PC
Networks Mail Diagnostics disk.
<P>
<PRE>         MICROSOFT MAIL POSTOFFICE DIAGNOSTICS UTILITY
         =============================================

</PRE>THIS UTILITY IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER
EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.
<P>
WARNING: In order to avoid any risk of loss of data or data corruption,
please make a backup copy of your Microsoft Mail postoffice. DO NOT RUN
THIS UTILITY ON A PRODUCTION POSTOFFICE WITHOUT A BACKUP BEING AVAILABLE.
<P>
<P><h2>Introduction</h2>
 
<P>
The Microsoft Mail Postoffice Diagnostics utility is a Windows-based
utility that checks Microsoft Mail databases on version 2.1, and 3.x
postoffices. Microsoft designed this utility to enable you to better
administer and maintain your postoffice without relying on Microsoft
Product Support Services.
<P>
WARNING: Before you use the Diagnostics utility to fix the database, make
an ADDITIONAL backup copy of your Microsoft Mail postoffice. If an error
occurs during a fix, you can restore the backup made immediately before you
used the Diagnostics utility to perform the fix. In all other
circumstances, you should restore the database from your most recent
regularly scheduled backup.
<P>
You can use the Diagnostics utility tools to diagnose and resolve potential
corruption problems on the postoffice. The Diagnostics utility contains a
General Postoffice Summary tool and four tools that check:
<P>
<PRE> * Address and group files

 * User mail files

 * Server folder files

 * Directory synchronization (Dir-Sync) files (version 3.x postoffices
   only)

</PRE>The utility adds to the utility log file any problems it finds in the
database. You can also use the Diagnostics utility tools to check and fix
the database. When you use the check and fix tools, you decide which
problems the utility fixes.
<P>
WARNING: If you use the Diagnostics utility to check and fix the database,
no users or programs should access the postoffice while the utility is
running. It is also best to check the database when there is little or no
activity on the postoffice; checking the database when users are logged on
to the postoffice can cause inaccurate error reporting.
<P>
<P><h2>Requirements</h2>
 
<P>
To use this utility, you must have:
<P>
<PRE> * Microsoft Mail postoffice version 2.1 or 3.x

 * Administrator access rights to the postoffice

 * Full network operating system access rights to the postoffice and all
   its subdirectories

 * Hardware and software required for Microsoft Windows

</PRE><h2>Installing and Starting the Diagnostics Utility</h2>
 
<P>
To install the Diagnostics utility

<OL><P><LI> Start Windows.

<P><LI> In the Windows Program Manager, choose Run from the File menu.

<P><LI> Insert the disk into your floppy disk drive.

<P><LI> In the Command Line box, type the following and press ENTER
<P>
<P><PRE>    &lt;drive&gt;:setup
</PRE><P>
<P><PRE>    where &lt;drive&gt; is the floppy disk drive containing the MS Mail PO
    Diagnostics 3.5 Setup Disk. For example, if the MS Mail
    PO Diagnostics 3.5 Setup Disk is in drive A, type the
    following command:
</PRE><P>
<P><PRE>       a:setup
</PRE><P>
</OL>To start the Diagnostics utility
<P>
*  In the MS Mail PO Diag 3.5 group, double-click the
<PRE>   MS Mail PO Diagnostics 3.5 icon. The Microsoft Mail Postoffice
   Diagnostics dialog box appears.

</PRE></OL>WARNING: Do not use the Diagnostics utility to check and fix the database
unless you have a recent backup of the postoffice. Not all problems can be
fixed by the utility, and maintaining a good backup schedule is essential
to restoring postoffice operation, especially in cases where the database
is corrupt.
<P>
Be aware that the size of your postoffice affects the time required to
check and fix the database. You may notice this when running the Address
and Group or User Mail tools--checking and fixing the database with these
tools may require several hours to complete.
<P>
<P><h2>Fixing Database Errors</h2>
 
<P>
DO NOT use the Diagnostics utility to fix the database errors while other
programs or users are accessing the postoffice database. This may cause
improper fixes or corruption to the postoffice database.
<P>
It is recommended that you should run Diagnostics utility to check the
postoffice database first before fix. This will allow you to analyze the
database problems encountered and decide which database errors that you
should fix.
<P>
<P><h2>Finding Information About the Diagnostics Utility</h2>
 
<P>
The documentation for the Diagnostics utility is online Help.
<P>
To view the table of contents for Help, choose Contents from the Help menu.
<P>
To view Help instructions, choose How To Use Help from the Help menu.
<P>
<P><h2>Maintaining the Network Connection</h2>
 
<P>
It is important to maintain the network connection to the postoffice when
using the Diagnostics utility. If you are disconnected from the network
while the Diagnostics utility is running, the tools may report missing
files or directories.
<P>
<P><h2>Additional Information About Error Messages</h2>
 
<P>
<P><h3>Error 117</h3>
 
When you fix the database, and the following error message appears
"Detected an incorrect value in file &lt;filename&gt;. The value will be
reset to its default. Do you want it corrected? [117]"
<P>
<PRE>If &lt;filename&gt; is      Do this
----------------      ---------
ACCESS.GLB            After the fix, a user may have been reset to the
or                    default user attributes, or may have lost the
ACCESS2.GLB           ability to create and access private, group or
                      shared folders.

                      Check the user access privileges and folder
                      privileges for every user in your postoffice. You
                      can print the user report (using the Administrator
                      program Local-Admin Print commands) to check the
                      user access and folder privileges for users in your
                      postoffice. If you find the privileges for a user
                      are not correct, you can then change the user access
                      or folder privileges using the Administrator program
                      Local-Admin Modify commands.

ACCESS3.GLB           If there are any DOS Remote users who are set to
                      CALL/REQUEST remote user type, ensure that their
                      remote user access times are correct (using the
                      Administrator program Remote Modify commands).

                      If there are any DOS Client users, request them
                      to check the location of their folders (using the
                      Mail program Options Folders Private-Storage
                      commands). The location of the folders may have
                      been reset to the server.

                      If there are any DOS Client users, request them to
                      check their logfile paths for compose messages and
                      read messages (using the Mail program Options
                      Configure commands). These may have been changed.

GLOBAL.GLB            Check the Mail default options for creating users
                      in your postoffice (using the Administrator program
                      Local-Admin Options commands). These options may
                      have been reset to the initial defaults.

MASTER.GLB            Ensure that the hop count for indirect postoffices
                      is correct (using the Administrator program Config
                      Hop count commands).

                      If the postoffice accesses a SNADS gateway, ensure
                      that the address mappings are correct.

PROCESS.GLB           If the postoffice is configured for directory
                      synchronization, ensure that the schedule for
                      directory synchronization processes is correct:
                      - schedule for Server (using the Administrator
                        program Config Dir-Sync Server Schedule commands)
                      - schedule for Requestor (using the Administrator
                        program Config Dir-Sync Requestor Schedule
                        commands)

REQCONF.GLB           If the postoffice is configured as a Requestor
                      in directory synchronization, ensure that the
                      requestor configuration is correct:
                      - registration (using the Administrator program
                        Config Dir-Sync Requestor Registration commands)
                      - address types (using the Administrator program
                        Config Dir-Sync Requestor Types commands)
                      - configuration (using the Administrator program
                        Config Dir Sync Requestor Options commands)

SRVCONF.GLB           If the postoffice is configured as a Server in
                      directory synchronization, ensure that the server
                      configuration is correct:
                      - configuration (using the Administrator program
                        Config Dir-Sync Server Options commands)
                      - requestor list (using the Administrator program
                        Config Dir-Sync Server Requestors Modify commands)

</PRE><h3>Error 129</h3>
 
The utility available from Microsoft Product Support Services is called
FIXFLD, not FOLDFIX, as described in the online Help.
<P>
<P><h3>Unknown or inaccessible address -- User Mail/Blank Message Creation</h3>
 
The User Mail Check and Fix detects missing .MAI files if under
"Details of Check" you selected "Mailbag Pointers." When the utility
recreates the .MAI file, the mail is addressed with a TO and FROM of
TESTNET/TESTPO/Admin.
<P>
When the user opens this mail message, he or she is instructed to resubmit
it. If the user replies to this message, the Mail program will issue the
following message:
<P>
<PRE>               Unknown or inaccessible address:
                     TESTNET/TESTPO/Admin
                  Press any key to continue...

</PRE>To resolve this problem, ask the user to forward this message to the
recipient, not create a reply. (The recipient's name can be found on the
message header in the Inbox.)
<P>
<P><h3>Problems with Directory Synchronization</h3>
 
The instructions for error 161 incorrectly states that the utility will
detect a missing MSTTRANS.GLB file. The Directory Synchronization Check
does not detect a missing MSTTRANS.GLB file on a directory server
postoffice. If Directory Synchronization does not work, check to see that
the MSTTRANS.GLB file is in the GLB subdirectory. If the MSTTRANS.GLB file
is missing, ignore the instructions for resynchronizing and call Product
Support Services.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50<BR>
KBCategory: kbreadme<BR>
KBSubcategory: MailPCGen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 14, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
