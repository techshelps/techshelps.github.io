

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: No L2029 Error, "APPLOADER" in Module-Definition File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87545 ">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1992/08/03">
<META NAME="Keywords" CONTENT="kb16bitonly LINKIss kbbuglist kberrmsg kbfixlist kbtool">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  In the Microsoft Windows operating system, an attempt to load an mixed- language program build with Microsoft C/C++ version 7.0 and Microsoft FORTRAN version 5.1 fails and Windows generates a general protection (GP) fault.  CAUSE =====  The applica...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QDL9,QBWO,QBWN,QAVX,QAVW,QBFY,QAAP,QBWQ,QAH4,QAGI,QAE2,QDIR,QAR4,QBSU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: No L2029 Error, "APPLOADER" in Module-Definition File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87545 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.30   | 5.31 | 5.30
MS-DOS | OS/2 | WINDOWS
kbtool kberrmsg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft LINK for MS-DOS and Windows, version 5.3
<LI>Microsoft LINK for OS/2, version 5.31
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the Microsoft Windows operating system, an attempt to load an mixed-
language program build with Microsoft C/C++ version 7.0 and Microsoft
FORTRAN version 5.1 fails and Windows generates a general protection (GP)
fault.
<P>
<P><h2>CAUSE</h2>
 
<P>
The application was built with Microsoft LINK version 5.3 and includes the
following statement in its module-definition (.DEF) file:
<P>
<PRE>   APPLOADER '__MSLANGLOAD'

</PRE>The error occurs when the file contains unresolved externals. Because the
internal flag that indicates unresolved externals is overwritten by the
routine that resolves the custom loader, no error message occurs when
unresolved externals remain nor is the error bit set in the executable
file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If Windows version 3.1 is the target operating system, remove the APPLOADER
statement from the .DEF file and relink. If Windows version 3.0 is the
target operating system, remove the APPLOADER statement from the .DEF file
and relink. If no errors occur, edit the .DEF file to place the APPLOADER
statement back into the .DEF file and relink.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in LINK version 5.3 for MS-DOS
and Windows (distributed with Microsoft C/C++ version 7.0) and LINK version
5.31 for OS/2. This problem was corrected in LINK version 5.31.009
(distributed with the C/C++ version 7.0a patch disk). To obtain the patch
disk, obtain a disk from Microsoft. To obtain a disk in the United States,
call Microsoft Product Support Services at (206) 454-2030. Outside the
United States, contact the Microsoft subsidiary for your area. To locate
your subsidiary, go to the Microsoft Web site
<B><A HREF="http://www.microsoft.com/worldwide/default.htm">http://www.microsoft.com/worldwide/default.htm</A></B>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The APPLOADER statement in the .DEF file instructs LINK to replace the
default loader provided by Windows with a custom loader. The FORTRAN run-
time library includes a custom loader called _MSLANGLOAD. This loader
enables an application to load huge static data (static data items larger
than 64K each) in Windows 3.0. Because the Windows 3.1 loader can load huge
static data, the APPLOADER statement is not required.
<P>
Mixed-language programs built with C/C++ version 7.0 and FORTRAN version
5.1 must include an additional library, OLDNAMES.LIB, that is not required
when the application is built with Microsoft C version 6.0. This
requirement is a frequent cause of unresolved external errors, especially
in projects that linked successfully when built with C 6.0. Under normal
circumstances, an unresolved external error sets an error bit in the
executable file, which prevents the Windows loader from attempting to load
the incomplete executable file.
<P>
The following sample project demonstrates this problem. Note that the code
calls the SUB2 subroutine but does not include any code with which to
resolve the call. LINK version 5.3 does not generate any error; LINK
version 5.15 correctly generates the following error message:
<P>
<PRE>   error L2029: 'SUB2' : unresolved external

</PRE><h3>TEST.FOR</h3>
 
<P>
C Compile options required: fl /c /MW test.for
<PRE>C Link command line:        link /NOD test,,, llibfew, test.def

      program test
      call sub2
      end

</PRE><h3>TEST.DEF</h3>
 
<P>
<PRE>NAME           TEST WINDOWAPI
APPLOADER      '__MSLANGLOAD'
EXETYPE        WINDOWS 3.0
STUB           'WINSTUB.EXE'
</PRE>PROTMODE
<PRE>CODE           PRELOAD MOVEABLE DISCARDABLE
DATA           PRELOAD MOVEABLE
HEAPSIZE       1024
STACKSIZE      8096
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.30<BR>
KBCategory: kbtool kberrmsg kbbuglist kbfixlist<BR>
KBSubcategory: LinkIss<BR>
Keywords          : kb16bitonly LINKIss kbbuglist kberrmsg kbfixlist kbtool<BR>
Version           : 5.30   | 5.31 | 5.30<BR>
Platform          : MS-DOS OS/2 WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
