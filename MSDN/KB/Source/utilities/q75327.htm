

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Macros Do Not Become Part of the Environment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75327 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1991/08/18">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  When NMAKE defines a macro in a makefile, it does not define a corresponding environment variable for the processes NMAKE invokes. However, if an environment variable of the same name already exists, NMAKE reassigns it to have the same value as the...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAX1,QBVV,QAVW,QAVX,QAH4,QBFY,QAB4,QAHD,QAE2,QAPF,QBXA,QBWP,QBXS,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Macros Do Not Become Part of the Environment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75327 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft NMAKE Utility for MS-DOS, versions 1.11, 1.12, 1.13, 1.2,
   1.3, and 1.4
<LI>Microsoft NMAKE Utility for OS/2, versions 1.11, 1.12, 1.13, and
   1.21
<LI>Microsoft NMAKE Utility for Windows NT, versions 1.4 and 1.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When NMAKE defines a macro in a makefile, it does not define a
corresponding environment variable for the processes NMAKE invokes.
However, if an environment variable of the same name already exists,
NMAKE reassigns it to have the same value as the macro.
<P>
For example, the first sample makefile below defines a CL macro. If an
environment variable named CL exists, the CL macro in the makefile
temporarily reassigns the CL environment variable such that the
compiler only compiles files and does not link them. If the CL
environment variable does not already exist, the CL macro is not added
to the environment and does not change the compiler settings.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create an environment variable in a makefile, use the SET command.
The second sample makefile below demonstrates creating the CL
environment variable if it does not already exist in the inherited
environment.
<P>
The reassignment of existing environment variables can lead to
unexpected errors. In the third sample program, if the environment
variable 'LINK' is defined, one of the following errors will be
generated:
<P>
<PRE>   LINK : error LNK1104: cannot open file "link.obj" (32 bit)

 -or-

   LINK : fatal error L1093: link.obj : object file not found (16 bit)

</PRE>NTWIN32.MAK, the Win32 application master NMAKE definitions file for
the Microsoft Win32 SDK for Windows NT programming samples, contains
the macro definition "link=link". Any makefile which has
"!include &lt;NTWIN32.MAK&gt;" will fail with LNK1104, if the environment
variable 'LINK' is defined.
<P>
The following warnings for the 32 bit compiler are generated for
makefiles which define the MACRO 'cl' if the environment variable 'CL'
was also defined:
<P>
<PRE>   Command line warning D4024 : unrecognized source file type 'cl',
        object file assumed
   Command line warning D4027 : source file 'cl' ignored

</PRE>NOTE: If you use NMK.COM instead of NMAKE, you must use the SET
command to reassign any environment variables. NMK.COM does not permit
you to use macro assignments to override the environment. For more
information, query in the Microsoft Knowledge Base on the following
words:
<P>
<PRE>   NMK.COM and environment and macros

</PRE><h3>Sample Makefile #1</h3>
 
<P>
# If the CL environment variable does not exist, this makefile
# compiles and links TEST.C. If the CL environment variable exists,
# the makefile changes its value to "/c" and prevents the linker from
# running.
<P>
CL=/c
<P>
ALL:
<PRE>   cl test.c

</PRE><h3>Sample Makefile #2</h3>
 
<P>
# This is a modified makefile from sample 1. Because CL is set with
# the SET command, the linker does not run.
<P>
INCLUDE=d:\include
ALL:
<PRE>   set cl=/c
   cl test.c

</PRE><h3>Sample Makefile #3</h3>
 
<P>
# If the LINK environment variable does not exist, this makefile
# compiles and links TEST.C. If the LINK environment variable exists,
# the makefile changes its value to "link" and the linker error:
# LNK1104 or L1093 will be generated.
<P>
link=link
<P>
ALL:
<PRE>   cl /c test.c
   $(link) test.obj

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.20 1.30 1.40 1.50<BR>
KBCategory: kbtool<BR>
KBSubcategory: NmakeIss LinkIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
