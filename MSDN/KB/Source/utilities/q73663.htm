

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: LINK May Incorrectly Generate L2049 for Resource-Only DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73663 ">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1991/07/02">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  The Microsoft LINK utility versions 5.03, 5.05, 5.1, and 5.11 will generate the following error if you attempt to link a resource-only DLL that contains no code or data:     LINK: error L2049: no segments defined  Although a valid DLL is created in...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAVX,QAVW,QAB4,QAH4,QAE2,QBXA,QBXS,QAKP,QAR4,QDNN,QBCU,QACM,QAHE,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: LINK May Incorrectly Generate L2049 for Resource-Only DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73663 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.03 5.05 5.10 5.11 | 5.03 5.05 5.10 5.11
<PRE>MS-DOS              | OS/2
</PRE>kbtool kberrmsg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft LINK Utility for MS-DOS, version(s) 5.03, 5.05, 5.1, and
   5.11
<LI>Microsoft LINK Utility for OS/2, version(s) 5.03, 5.05, 5.1, and
   5.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft LINK utility versions 5.03, 5.05, 5.1, and 5.11 will
generate the following error if you attempt to link a resource-only
DLL that contains no code or data:
<P>
<PRE>   LINK: error L2049: no segments defined

</PRE>Although a valid DLL is created in this case, these versions of LINK
set the error bit in the DLL's header and return an error code to the
calling program.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Beginning with LINK version 5.13, the L2049 error was converted to a
warning and the error bit is no longer set in the output file. To work
around the problem with LINK 5.03, 5.05, 5.1, or 5.11, the EXEHDR
utility may be used to reset the error bit in the header.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in LINK versions 5.03, 5.05,
5.1, and 5.11. This problem was corrected in LINK version 5.13.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A resource-only DLL does not contain code or data--it is only used to
store bitmaps, menus, fonts, and other static resources, but LINK
versions 5.03, 5.05, 5.1, and 5.11 flag the lack of segments with an
L2049 error and mark the output file as invalid.
<P>
To use the DLL, you can use EXEHDR to turn off the error bit by
invoking it with the /RESET option. For example:
<P>
<PRE>   EXEHDR /RESET RESOURCE.DLL

</PRE>The most efficient method is to add this statement to the description
block in your makefile that contains the LINK command. For example:
<P>
<PRE>   test.dll: test.obj test.def
      link test,test.dll,,,test.def;
      exehdr /reset test.dll

</PRE>Note that in order to stop NMAKE from terminating with the error code
from LINK, you should use either the /I (ignore exit codes) switch
when invoking NMAKE, specify the .IGNORE directive inside the
makefile, or add a dash (-) before the LINK command to indicate that
processing the makefile should continue even if there is an error with
the link step. See your NMAKE documentation for further information
about the /I option, the .IGNORE directive, and the dash operator.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10<BR>
KBCategory: kbtool kberrmsg kbbuglist kbfixlist<BR>
KBSubcategory: LinkIss<BR>
Keywords          : kb16bitonly<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
