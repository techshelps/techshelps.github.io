

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Unexpected "This Program Requires Microsoft Windows" Msg </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84323 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1992/05/10">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  An attempt to run, in MS-DOS, an application generated by Microsoft FORTRAN version 5.1, fails and generates the following message:     This program requires Microsoft Windows  If the application is run in Windows, the system may open an MS-DOS ses...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAB4,QAAP,QAH4,QAJH,QAPF,QDIR,QBE7,QBE6,QBWQ,QBWS,QAE2,QA5E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Unexpected "This Program Requires Microsoft Windows" Msg</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84323 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.0x 5.1x 5.20 5.3x 5.50 | 5.0x 5.10 5.11 5.13 5.15
<PRE>MS-DOS                   | OS/2
</PRE>kbtool kbcode kberrmsg kberrmsg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft LINK for MS-DOS, versions 5.0x, 5.1x, 5.2, 5.3x, and 5.5
<LI>Microsoft LINK for OS/2, versions 5.0x, 5.1, 5.11, 5.13, and 5.15
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to run, in MS-DOS, an application generated by Microsoft FORTRAN
version 5.1, fails and generates the following message:
<P>
<PRE>   This program requires Microsoft Windows

</PRE>If the application is run in Windows, the system may open an MS-DOS
session, display the message above and close the MS-DOS session, returning
to Windows without running the application.
<P>
<P><h2>CAUSE</h2>
 
<P>
Most likely, one of the following errors occurred linking the application:
<P>
<PRE>   L2025: Multiply Defined Symbol
   L2029: Unresolved External

</PRE>When one of these errors occurs, Microsoft LINK sets an error bit in the
executable file header. The error bit warns the application loader that the
file contains an error. In Windows, this bit causes the loader to start an
MS-DOS session for the application. If the application is designed for
Windows, the MS-DOS correctly displays the error message above.
<P>
If an L2025 or L2029 error occurs creating an application for the MS-DOS
operating system, the loader does not reject the application. However, in
the MS-DOS operating system, running an application that has unresolved
externals may generate incorrect results or cause the system to hang. In
the OS/2 operating system, the application generates a general protection
(GP) fault if it attempts to access a restricted memory location.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The best method to address this situation involves resolving the LINK error
at its source. If this is not possible or undesirable, use the EXEHDR
utility to manually reset the error bit. The syntax to call the EXEHDR
utility is as follows:
<P>
<PRE>   EXEHDR /r &lt;filename&gt;

</PRE><h2>STATUS</h2>
 
<P>
Versions 3.0 and 3.1 of the Windows loader each interpret the error bit as
described above.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following FORTRAN code reproduces the problem:
<P>
<P><h3>Sample Code</h3>
 
<P>
This is the source code for the SAMPLE.FOR file:
<P>
<PRE>      PROGRAM Sample_Test
      PRINT *, 'FORTRAN Test'
      GOTO 20
      CALL MySub (123)          ! MySub is unresolved at link time
 20   CONTINUE
      END

</PRE><h3>Project Makefile</h3>
 
<P>
ALL : Sample.EXE
<P>
Sample.EXE : Sample.OBJ
<PRE>   Link Sample.OBJ,, nul, /NOD LLIBFEW.LIB, FL.DEF

</PRE>Sample.OBJ : Sample.FOR
<PRE>   FL /c /MW Sample.FOR
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.01.20 5.01.21 5.02 5.03 5.05 5.10 5.11<BR>
5.13 5.15 5.20 5.30 5.31.009 5.50<BR>
KBCategory: kbtool kbcode kberrmsg kberrmsg kbprb<BR>
KBSubcategory: LinkIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
