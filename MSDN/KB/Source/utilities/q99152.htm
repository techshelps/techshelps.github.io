

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: MOVE Application Requires Additional Memory to Load </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99152 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1993/05/24">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  An application that uses the Microsoft Overlaid Virtual Environment may require more memory to run than the same program build with old style (C 6.0) overlays or without any overlay manager. While the size of the executable file may not change sign...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAEF,QACI,QAW9,QALM,QAKR,QAHE,QDIJ,QAOT,QAGB,QBV8,QAJH,QA9N,QANJ,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: MOVE Application Requires Additional Memory to Load</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99152 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.30 5.31 5.50 5.60
MS-DOS
kbtool kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft LINK for MS-DOS, versions 5.3, 5.31, 5.5, and 5.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An application that uses the Microsoft Overlaid Virtual Environment
may require more memory to run than the same program build with old
style (C 6.0) overlays or without any overlay manager. While the
size of the executable file may not change significantly, the
EXEHDR utility indicates that more memory is required to load the
program. (In EXEHDR version 3.0, memory required to load is the
last line of information displayed for an MS-DOS program.)
<P>
Additionally, the program may not recognize that it contains
overlays. Each segment specified in the SEGMENTS statement in the
module definition (.DEF) file is empty. In a tracing version of the
application, the trace file, MOVE.TRC, is also empty.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when one or more modules of the program is
compiled with the /Gy (Enable function-level linking) compiler
option and these modules are listed in the SEGMENTS statement in
the .DEF file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid the problem, do one of the following:

<UL><LI>In the .DEF file, specify overlays in the FUNCTIONS statement
   instead of in the SEGMENTS statement. LINK places function code
   into the appropriate comdat_seg&lt;n&gt; segment in the overlay
   (discussed below). Specify the /Gy compiler option switch only
   for those modules that require function-level linking.

<LI>Remove the /Gy option switch from the compiler command line.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The compiler creates a separate segment for each function in modules
compiled with the /Gy option switch. The compiler names each segment
comdat_seg&lt;n&gt;, where &lt;n&gt; is assigned successive integer values as
segments fill up. In addition, the compiler creates an empty segment
(0 bytes long) with the name &lt;modulename&gt;_TEXT. The error occurs
because the SEGMENTS statement in the DEF file specifies the empty
&lt;modulename&gt;_TEXT segments. LINK creates empty overlays and places the
functions into the root overlay (overlay 0). Because each overlay is
empty, the MOVE.TRC file produced by the tracing version of the
overlaid program is also empty.
<P>
While the empty segment that the compiler produces with the /Gy option
switch prevents erroneous linker messages, it causes the side-effects
listed above when the segment is placed into an overlay.
<P>
The program may require more memory to load because the MOVE overlay
manager requires about 16K. If the code that is expected to be in an
overlay is placed into the root overlay, the application requires more
memory.
<P>
A code sample that demonstrates this problem is fairly easy to create,
however, it requires too many files and lines of code to include one
in this article. To demonstrate this problem, find an application that
use MOVE overlays and the SEGMENTS statement in its .DEF file. Build
the application and use EXEHDR to determine its load size. Then add
the /Gy option switch to the compiler options for each module placed
into an overlay. Rebuild the application and determine its load size.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.30 5.31.009 5.50<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: MoveOverlay<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
