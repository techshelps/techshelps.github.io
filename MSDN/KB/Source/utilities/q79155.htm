

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>L2022, L2029 Errors Linking Application with a .DEF File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79155 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1991/12/12">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  An attempt to link an application fails and Microsoft LINK  generates the following messages        error L2022:        (alias               ): export undefined       error L2029:       : unresolved external  CAUSE =====  A function name specified ...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QA3P,QAB9,QBE7,QBE6,QAY5,QBV8,QARM,QDKW,QAAP,QAB4,QAE2,QAJH,QBVV,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>L2022, L2029 Errors Linking Application with a .DEF File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79155 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.0x 5.1x 5.20 5.3x 5.50 5.60 | 5.0x 5.10 5.11 5.13 5.15
<PRE>MS-DOS                        | OS/2
</PRE>kbtool kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft LINK for MS-DOS, versions 5.0x, 5.1x, 5.2, 5.3x, 5.5, and
   5.6
<LI>Microsoft LINK for OS/2, versions 5.0x, 5.1, 5.11, 5.13, and 5.15
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to link an application fails and Microsoft LINK  generates the
following messages
<P>
<PRE>      error L2022: &lt;name&gt; (alias &lt;internalname&gt;): export undefined
      error L2029: &lt;name&gt;: unresolved external

</PRE><h2>CAUSE</h2>
 
<P>
A function name specified in the EXPORTS section of an  application's
module definition (.DEF) file does not match the  actual function name.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Modify the function name in the .DEF file to match the name of the
function in the code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The text below presents two situation in which the errors above occur when
Microsoft LINK creates an application for the Microsoft Windows or the OS/2
Presentation Manager operating systems.

<UL><LI>An application defines a MainWndProc() window procedure with the
   _pascal attribute. The .DEF file contains an "EXPORTS MainWndProc"
   statement. The LINK command line includes the /NOI[GNORECASE]
   option switch. Because MainWndProc() has the _pascal attribute, its
   true name is MAINWNDPROC(). Further, because the /NOI switch
   specifies case sensitivity, MainWndProc() and MAINWNDPROC() are not
   equivalent and the exported function name is not defined.
<P>
   To work around this situation, either remove /NOI from the linker
   command line or modify the .DEF file to specify the function name
   in upper-case letters.

<LI>An application defines a ClientWndProc() procedure with the _cdecl
   attribute. The .DEF file contains an "EXPORTS ClientWndProc"
   statement. Because ClientWndProc() has the _cdecl attribute, its
   true name is _ClientWndProc(). ClientWndProc() and _ClientWndProc()
   are not equivalent and the export is undefined.
<P>
   To work around this situation, modify the .DEF file to prepend the
   procedure name with an underscore. Be sure to preserve the case of
   the function name in the file.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 5.01.20 5.01.21 5.02 5.03 5.05 5.10 5.11<BR>
5.13 5.15 5.20 5.30 5.31.009 5.50 5.60<BR>
KBCategory: kbtool kberrmsg<BR>
KBSubcategory: LinkIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
