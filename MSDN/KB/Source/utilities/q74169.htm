

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: L4001 Warning May Be Caused by Using Incorrect Linker </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74169 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1991/07/14">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  During the process of linking an application, Microsoft LINK generates the following message:     warning L4001: frame-relative fix-up,            frame ignored near xxx in segment yyy  In most cases, LINK ignores the initial frame and performs a f...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAH4,QBE7,QBE6,QAAP,QBWP,QAE2,QAGI,QBXA,QAR4,QAIJ,QAPF,QAY2,QAO4,QDIR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: L4001 Warning May Be Caused by Using Incorrect Linker</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74169 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.0x 5.1x 5.2x 5.3x 5.50 | 5.0x 5.10 5.11 5.13 5.15
<PRE>MS-DOS                   | OS/2
</PRE>kbtool kbcode kberrmsg kberrmgs kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft LINK for MS-DOS, versions 5.0x, 5.1x, 5.2x, 5.3x, and 5.5
<LI>Microsoft LINK for OS/2, versions 5.0x, 5.1, 5.11, 5.13, and 5.15
<LI>Microsoft Macro Assembler for MS-DOS and OS/2, versions 6.0, 6.0a,
   6.0b, and 6.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
During the process of linking an application, Microsoft LINK generates the
following message:
<P>
<PRE>   warning L4001: frame-relative fix-up,
           frame ignored near xxx in segment yyy

</PRE>In most cases, LINK ignores the initial frame and performs a far address
calculation.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error can occur incorrectly when the incorrect linker is used. For
example, the error occurs if an assembly module is assembled with USE32
segments in Microsoft Macro Assembler (MASM) and LINK version 5.x attempts
to create the .EXE file. The same error occurs if MASM version 6.0, 6.0a,
6.0b, or 6.1 creates code for the FLAT memory model.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The resolution depends on the target operating system. When Windows NT is
the target, use the CVTOMF utility provided with the Windows NT Software
Development Kit (SDK) to convert the generated object file from OMF format
to COFF format. Then use the LINK utility provided with the Windows NT SDK
to build the application. If OS/2 version 2.0 is the target, use LINK386
from the IBM OS/2 2.0 development kit.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code sample demonstrates both the error message discussed
above and the methods to avoid it. Assemble the code below with MASM
version 6.0, 6.0a, 6.0b, or 6.1. To reproduce the error message above, link
with a segmented-executable linker, such as LINK version 5.x. To create a
correct executable file, link the code with LINK386 from IBM.
<P>
<P><h3>Sample Code</h3>
 
<P>
; Assemble options needed: /c
;     Link options needed: Link with LINK 5.x to see errors
<PRE>;                          Link with LINK386 for correct results

</PRE>INCLUDELIB DOSCALLS.LIB ; OS/2 systems call library
<P>
.386
.MODEL flat, syscall
<P>
Dos32Write PROTO NEAR32 syscall,
<PRE>    hf:WORD, pvBuf:NEAR32, cbBuf:WORD, pcbBytesWritten:NEAR32

</PRE>Dos32Exit PROTO NEAR32 syscall,
<PRE>    fTerminate:WORD, ulExitCode:WORD

</PRE>.STACK 4096
<P>
.DATA
<P>
msg DB "Hello, world.", 13, 10
written DW 0
<P>
.CODE
_start:
<PRE>    INVOKE  Dos32Write,        ; OS/2 system call
        1,                     ; File handle for screen
        NEAR32 PTR msg,        ; Address of string
        LENGTHOF msg,          ; Length of string
        NEAR32 PTR written     ; Bytes written

    INVOKE  Dos32Exit,         ; OS/2 system call
        0,                     ; Terminate all treads
        0                      ; Result code for parent process

</PRE>END _start
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.01.20 5.01.21 5.02 5.03 5.05 5.10 5.11<BR>
5.13 5.15 5.20 5.30 5.31.009 5.50 6.00 6.00a 6.00b 6.10<BR>
KBCategory: kbtool kbcode kberrmsg kberrmsg kbprb<BR>
KBSubcategory: LinkIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
