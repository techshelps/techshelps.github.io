

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>With IgnoreDomain=1 Option, ACL Can Be Matched to Wrong Account </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181812">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1998/02/26">
<META NAME="Keywords" CONTENT="kbbug2.00 ciscrs kbbug1.00">
<META NAME="KBArea" CONTENT="Support; KB; sitemcis">
<META NAME="Description" CONTENT="  If you use the IgnoreDomain=1 option, and the same account name exists in multiple domains, the access control lists (ACLs) can be matched to the wrong account. If you use the Ignore=0 option, all user-created local accounts are lost. These are the...">
<META NAME="Product" CONTENT="sitemcis">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBG2,QAI5,QA9A,QAR4,QAHH,QAAW,QAGU,QDO3,QBW3,QBVV,QAM1,QALQ,QAGI,QDKW,QABO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>With IgnoreDomain=1 Option, ACL Can Be Matched to Wrong Account</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181812</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Commercial Internet System version 1.0 SP1
   - Microsoft Content Replication System
<LI>Microsoft Site Server version 2.0 SP1
   - Microsoft Content Replication System
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the IgnoreDomain=1 option, and the same account name exists in
multiple domains, the access control lists (ACLs) can be matched to the
wrong account. If you use the Ignore=0 option, all user-created local
accounts are lost. These are the built in accounts: Administrators, Backup
Operators, Everyone, Guests, Interactive, Network, Power Users, Replicator,
Users. The Authenticated Users account, which was added in Windows NT 4.0
SP3, is treated as if it is a local account. Thus, it is dropped when
IgnoreDomain=0. These are the built-in (system) local groups:
Administrators, Backup Operators, Guests, Power Users, Replicator, Users.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Content Replication System (CRS) maps ACL entries in one of two ways,
according to the IgnoreDomain flag:
<P>
IgnoreDomain=1
Well-known accounts, built-in local groups, and user-created accounts are
correctly mapped to the SID of the account on the end-point computer.
Domain accounts are mapped to the first domain that has that account. The
LookupAccountName request is passed to remote domains if the local domain
does not match the SID of the account. Accounts that are not matched are
dropped.
<P>
IgnoreDomain=0 on Target and Source
Well-known accounts and built-in local groups are correctly mapped to the
SID of the well-known account on the end-point computer. User-created local
accounts are dropped. Domain accounts are exactly mapped to preserve the
domain name. The LookupAccountName request will only return a SID if the
account exists in that domain. Accounts that are not matched are dropped.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, assign local accounts to files and folders
only when IgnoreDomain=1, or assign domain accounts only when
IgnoreDomain=0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If this behavior is a serious problem, then apply the fix described below.
The new algorithm for IgnoreDomain=0 in the fix is to strip the domain name
if it is equal to the machine name. This will cause local accounts on the
start-point server to map to local accounts on the end-point server. If the
account does not map to a local account, then it will be dropped.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Commercial
Internet System, version 1.0 SP1 and Microsoft Site Server 2.0 SP1.
A supported fix is now available, but it has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Technical Support for more information.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: replicate MCIS<BR>
Keywords          : kbbug2.00 ciscrs kbbug1.00<BR>
Version           : WINNT:2.0<BR>
Platform          : winnt<BR>
Hardware          : ALPHA PPC x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
