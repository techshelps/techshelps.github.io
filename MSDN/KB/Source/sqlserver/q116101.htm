

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Boundaries of Implicit Transactions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116101">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/06/13">
<META NAME="Keywords" CONTENT="kbprg SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article discusses what constitutes a implicit transaction in SQL Server.  MORE INFORMATION  Users can explicitly delimit the boundaries of transactions with the BEGIN, COMMIT, and ROLLBACK TRANSACTION commands. These user-defined transactions ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAXB,QBV8,QAB9,QAB4,QAAP,QDMG,QBXJ,QAC1,QBD2,QAIB,QADX,QAVI,QBVV,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Boundaries of Implicit Transactions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116101</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 4.2 for OS/2
<LI>Microsoft SQL Server, version 4.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses what constitutes a implicit transaction in SQL
Server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Users can explicitly delimit the boundaries of transactions with the BEGIN,
COMMIT, and ROLLBACK TRANSACTION commands. These user-defined transactions
are started with a BEGIN TRANSACTION command. All updates done from the
BEGIN TRANSACTION command to a subsequent COMMIT TRANSACTION or ROLLBACK
TRANSACTION are considered to be one transaction and are either all
successful or all rolled back as one unit.
<P>
Outside of a user-defined transaction, SQL Server defaults to considering
each individual UPDATE, INSERT, or DELETE command to be a distinct
transaction. These are known as implicit transactions. If a batch of UPDATE
commands is submitted and an error occurs when executing one of the
commands, all of the updates prior to that command will have already been
committed to the database because SQL Server would have considered each one
to be an implicit transaction.
<P>
However, there are times when it might appear that SQL Server has not
followed this rule. These are due to errors which occur before a batch of
commands is executed and are discussed briefly in the SQL Server
"Programmers Reference for C" section on the dbsqlsend() command.
<P>
Commands are always sent to SQL Server in a batch. In the SQL Server tools,
a batch is terminated with a go command:
<P>
<PRE>   select * from sysusages
   select dbid, name from sysdatabases
   go

</PRE>In DB-Library (DB-Lib) applications a batch is terminated when the
dbsqlexec() or dbsqlsend() function is called. The entire batch is sent to
SQL Server, which first parses the batch and builds an execution plan for
it, then executes the plan.
<P>
If some error prevents SQL Server from compiling the execution plan, none
of the commands in the batch are executed, and the user might think the
entire batch was rolled back. Examples of this type of error include (but
are not limited to) invalid names, syntax errors, or permissions errors.
While it might appear the entire batch was rolled back, instead nothing in
the batch was executed.
<P>
If the execution plan is successfully built and SQL Server begins executing
the plan, then the standard rule that each individual command is a distinct
transaction (outside a user-defined transaction) applies. If a run time
error occurs during the execution of one of the commands in the batch, any
UPDATE commands already executed will have been committed. Examples of
these types of errors include (but are not limited to) insufficient
resource errors, trigger violations, and deadlocks.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dblib Windows NT<BR>
Keywords            : kbprg SSrvWinNT<BR>
Version             : 4.2 | 4.2<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
