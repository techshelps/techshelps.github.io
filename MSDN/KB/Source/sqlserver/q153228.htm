

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Replication Tasks Affect Query Timeout for Other SQLExec </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153228">
<META NAME="KBModify" CONTENT="1997/09/08">
<META NAME="KBCreate" CONTENT="1996/07/02">
<META NAME="Keywords" CONTENT="kbbug6.00 kbbug6.50 kbfix6.50.sp2">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Any SQLExec task that uses DB-Library can have its query timeout affected by a replication task. Replication tasks use a DB-Library function to globally set the query timeout for the SQLExecutive process, thereby affecting all  DB-Library based  ta...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAL4,QAL3,QAG0,QACF,QAR4,QABA,QAFO,QA63,QAHT,QAKP,QBXS,QAKD,QAH6,QAHE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Replication Tasks Affect Query Timeout for Other SQLExec</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153228</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Any SQLExec task that uses DB-Library can have its query timeout affected
by a replication task. Replication tasks use a DB-Library function to
globally set the query timeout for the SQLExecutive process, thereby
affecting all "DB-Library based" tasks including TSQL, LogReader, SYNC, and
Distribution tasks.
<P>
Because of this problem, replication tasks may encounter the following
message in the Task History:
<P>
<PRE>   SQL Server connection timed out. Unable to successfully execute
   &lt;command&gt; on &lt;server&gt;

</PRE>SQLExecutive will automatically retry the replication task, but the task
may never run if the query timeout is not long enough.
<P>
TSQL tasks may encounter the following error as a Failure:
<P>
<PRE>   SQL Server connection timed out. (Error 10024)

</PRE>WORKAROUND
 
<P>
Override the default query timeout for any SYNC or Distribution task with
the -q0 parameter value (This is only needed for SQL Server 6.5 because the
default query timeout for these tasks is 30 seconds, but is 0 for SQL
Server 6.0). This can force all tasks to use an infinite query timeout
(which is the default for TSQL and LogReader tasks).
<P>
For TSQL tasks, you could instead use a CmdExec task using ISQL.EXE with
the -t parameter to force a query timeout.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.0 and 6.5. This problem has been corrected in U.S. Service Pack 2
for Microsoft SQL Server version 6.5. For more information, contact your
primary support provider.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The LogReader, SYNC, and DB-Library subsystems in SQLExecutive all use
dbsettime() to set DB-Library query timeout values. By using dbsettime()
instead of dbsetopt(&lt;dbproc&gt;, DBSETTIME, &lt;value&gt;), the query timeout set by
one of these tasks can affect any other SQLExecutive task that uses DB-
Library, including TSQL tasks which do not have an option to control query
timeout.
<P>
Since the default query timeout for the SYNC and Distribution tasks is 30
seconds in 6.5, any execution of the SYNC task, even if it has no work to
perform, can affect the query timeout for the current execution of a TSQL
task or other replication task such as LogReader. For SQL 6.0, this problem
will only occur if the -q parameter is used for any of the replication
tasks.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Err DBLib<BR>
Keywords          : kbbug6.00 kbbug6.50 kbfix6.50.sp2<BR>
Version           : 6.0 6.5<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
