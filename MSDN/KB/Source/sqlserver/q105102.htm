

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: dbwritetext Returns SQL Server Message 156 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105102">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1993/10/10">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When attempting to call the dbwritetext function to update a text or image value, a DB-Library application can receive the following error message 156:     Incorrect syntax near the keyword NULL.  CAUSE =====  This error is caused by passing a NULL...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAKD,QALW,QABM,QAY5,QA5V,QAGI,QAB9,QATX,QAMB,QDPB,QBV8,QAB4,QAC1,QA62 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: dbwritetext Returns SQL Server Message 156</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105102</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server Programmer's Toolkit, version 4.2
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to call the dbwritetext function to update a text or
image value, a DB-Library application can receive the following error
message 156:
<P>
<PRE>   Incorrect syntax near the keyword NULL.

</PRE><h2>CAUSE</h2>
 
<P>
This error is caused by passing a NULL text pointer value returned by
dbtxptr, and a NULL text timestamp value returned by dbtxtimestamp, to
the dbwritetext function.
<P>
The dbtxptr and dbtxtimestamp functions return pointers to values from
the current DB-Library row, similar to dbdata. The dbtxptr and
dbtxtimestamp functions can return NULL values for two reasons:

<OL><P><LI>The text or image value in the row and column returned by the
   SELECT statement is NULL.

<P><LI>The dbtxptr and dbtxtimestamp functions are called when DB-Library
   has no current row. DB-Library has no current row when dbnextrow has
   returned NO_MORE_ROWS, or dbresults has returned NO_MORE_RESULTS.
<P>
</OL><h2>WORKAROUND</h2>
 
<P>
Ensure that both the dbtxptr and dbtxtimestamp functions return valid,
non-NULL values before passing them to dbwritetext. This can be achieved
by ensuring that:

<OL><P><LI>The text or image value in the row and column returned by the SELECT
   statement is non-NULL.

<P><LI>The dbtxptr and dbtxtimestamp functions are called when DB-Library
   has a valid current row. DB-Library has a current row when dbnextrow
   returns REG_ROW.

<P><LI>The non-NULL values returned by dbtxptr and dbtxtimestamp are passed
   to dbwritetext while the same row is still current. In other words, do
   not call dbnextrow until these values are actually used.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.20 4.20.00 dblib<BR>
Keywords            : kbprg SSrvDB_Lib SSrvProg<BR>
Version             : 4.2<BR>
Platform            : OS/2 Windows<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
