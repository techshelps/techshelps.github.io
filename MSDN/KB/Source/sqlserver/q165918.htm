

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Bypass (Emergency) Mode and DUMP TRANSACTION WITH NO_LOG </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165918">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1997/03/26">
<META NAME="Keywords" CONTENT="kbusage SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  In infrequent situations, a database may be marked SUSPECT due to recovery failure at startup time. Normally, this prevents anybody from accessing the data. However, it is possible to manually set the status of a SUSPECT database to  bypass mode  (...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QBXS,QA5W,QA0N,QABM,QDMH,QAML,QABA,QBXJ,QAXB,QAYY,QAU3,QAMR,QAB4,QAJ6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Bypass (Emergency) Mode and DUMP TRANSACTION WITH NO_LOG</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165918</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.2, 6.0, and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In infrequent situations, a database may be marked SUSPECT due to recovery
failure at startup time. Normally, this prevents anybody from accessing the
data. However, it is possible to manually set the status of a SUSPECT
database to "bypass mode" (also called "emergency mode") and SELECT or use
the Bulk Copy Program (BCP) to copy out the data. While you cannot do any
regular data modifications in bypass mode, it is possible to run DUMP
TRANSACTION WITH NO_LOG. Note that doing this operation in bypass mode is
unsupported and is a potentially dangerous operation.
<P>
For similar reasons, if startup recovery is taking a long time, you should
not abort it, set the database in bypass mode, and then do DUMP TRANSACTION
WITH NO_LOG.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
All actions taken by DUMP TRANSACTION are usually logged, so it is
recoverable and abortable. However, log space is consumed by the DUMP
command itself. If the transaction log is so full that insufficient space
exists to do a logged DUMP TRANSACTION, the WITH NO_LOG option can truncate
the transaction log with no logging.
<P>
DUMP TRANSACTION WITH NO_LOG is relatively safe under normal conditions.
The server takes measures to ensure that recovery will succeed even if the
server fails during this operation.
<P>
Under rare circumstances automatic recovery (also called startup recovery)
may fail, marking a database SUSPECT. Recovery fails for a specific reason.
It is very important to note the errorlog message that initially caused
recovery to fail, because it may help to diagnose the cause.
<P>
"Recovery" is the process of making the database consistent by redoing or
undoing all transactions that were either started after or uncommitted at
the time of the last checkpoint. This process relies on the write-ahead
nature of the transaction log (all modified pages are written to the log
before being written to the database). Recovery consists of reading each
log record, comparing its timestamp to the timestamp of the corresponding
database page, and either undoing the change (in the case of an uncommitted
transaction) or redoing the change (in the case of a committed
transaction).
<P>
After noting the errorlog message that is causing recovery to fail, try
setting the database status back to NORMAL, and restart SQL Server to see
if recovery succeeds the second time. You can change the database status by
means of the sp_resetstatus stored procedure. This is a supplemental stored
procedure you can install from the Instsupl.sql script in the Mssql\Install
directory. For more information, see "Resetting the Suspect Status" in the
online documentation.
<P>
If recovery still fails, note the error message and contact your primary
support provider. You should also verify the availability of your last good
database backup, because it may be needed. However much of the data in your
database is often still available, albeit transactionally (and physically)
inconsistent. You can access this data by setting the database status to
bypass, or emergency mode. This is done by setting sysdatabases.status to
-32768 for the database, after turning "allow updates" on. For example, use
the following command:
<P>
<PRE>   UPDATE SYSDATABASES SET STATUS=-32768 WHERE NAME='DBNAME'

</PRE>After doing this, you can enter the database and SELECT the data or use BCP
to get it out. You may encounter errors while doing this, but in most cases
much of the data can be retrieved.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage SSrvGen<BR>
Version             : 4.2 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbinfo<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
