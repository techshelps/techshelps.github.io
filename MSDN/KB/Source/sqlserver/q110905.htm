

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Readpipe Return Codes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110905">
<META NAME="KBModify" CONTENT="1997/11/07">
<META NAME="KBCreate" CONTENT="1994/02/01">
<META NAME="Keywords" CONTENT="SSrvServer kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Two applications, Makepipe and Readpipe, are available to help diagnose problems creating and reading Named Pipes over the network. This article describes some of the more common return codes from the MS-DOS, OS/2, Windows and Windows NT versions o...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAH4,QAUD,QANE,QAUJ,QABM,QDL9,QBWQ,QBWO,QBWN,QAVZ,QBVV,QAY2,QARL,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Readpipe Return Codes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110905</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server Programmer's Toolkit, version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Two applications, Makepipe and Readpipe, are available to help diagnose
problems creating and reading Named Pipes over the network. This article
describes some of the more common return codes from the MS-DOS, OS/2,
Windows and Windows NT versions of these applications.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Named Pipes provide an easy access conduit for reliable connection-oriented
data transfer between two processes. These two processes are normally
differentiated as a client process and a server process.
<P>
The server process (Makepipe) creates the pipe and manages access to it.
The resources that make up the pipe are owned by the server process and
physically exist on the station where the server process is running. The
client process (Readpipe) uses the services of the underlying network
protocols to access the remote pipe resources.
<P>
The server process (Makepipe) creates the named pipe and waits for a client
to connect on the other end. The call to create the pipe (DosMakeNmPipe)
returns a handle to the pipe. The client process (Readpipe) uses DosOpen
and the name of the pipe to connect. Upon successful connection, DosOpen
returns a handle to the pipe. Both sides can now use their respective
handles to write to (DosWrite) and read from (DosRead) the pipe.
<P>
Both Makepipe (Server - OS/2, Windows NT), Readpipe (Client - OS/2, MS-DOS,
Windows NT) and READPIPW.EXE (Client - Windows) are executable files used
to determine if a Named Pipe Session from the Server is able to communicate
with the Client on a supported network.
<P>
The following are the return codes that are commonly seen when encountering
problems with Readpipe or the network:
<P>
<PRE>STATUS     DESCRIPTION              POSSIBLE CAUSE
</PRE> 
<PRE>  3        Path Not Found           Named Pipes not installed correctly
  5        Access Denied            Permissions not granted on Named Pipes
  6        Invalid Handle           Network layer problem - check hardware
 13        Invalid Data             Wrong version of NETAPI.DLL
 53        Network Name Not Found   Network layer problem
 65        Network Access Denied    Permissions not granted on Named Pipes
 84        Out of Structures        Configuration settings
109        Broken Pipe              Network layer problem
110        Open Failed              Possible protocol incompatibility
206        Filename Exceeded Range  Server name more than eight characters
231        Pipe Busy                Pipe is not available

</PRE><h3>Windows NT Files:</h3>
 
<P>
The Windows NT files for MAKEPIPE.EXE and READPIPE.EXE are typically found
in the C:\SQL\BINN directory. Both of these files must be executed within a
Windows NT Command Prompt.
<P>
<P><h3>OS/2 Files:</h3>
 
<P>
The OS/2 files for MAKEPIPE.EXE and READPIPE.EXE are typically found in the
C:\SQL\BINP directory. These programs are not Presentation Manager programs
and as a result must be executed from within an OS/2 Window or OS/2 Full
Screen session.
<P>
<P><h3>Windows Files:</h3>
 
<P>
A new version of Readpipe has been developed, called READPIPW.EXE. This is
Win16 application that exists in the C:\SQL\BIN directory on the Windows
workstation. An icon for this program is not automatically created when
Microsoft SQL Administrator for Windows is installed. This program can be
easily setup to run from the Windows Desktop via the Windows Program
Manager.
<P>
<P><h3>MS-DOS Files:</h3>
 
<P>
The MS-DOS version of READPIPE.EXE is typically found in the C:\SQL\BIN
directory. This program can be executed from a MS-DOS Command Prompt or
from within a MS-DOS Prompt under Windows.
<P>
Two articles <B><A HREF="../URJump.htm">Q105104</A></B> "Readpipe for Windows Utility Tests Named Pipes" and
<B><A HREF="../SQLSERVER/Q68941.htm">Q68941</A></B> "Procedure for Testing Named Pipes" contain more information
on the specific use of these programs.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.20<BR>
Keywords          : SSrvServer kbprg kbtool<BR>
Version           : 4.2<BR>
Platform          : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
