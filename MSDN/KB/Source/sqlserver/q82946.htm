

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Moving Databases Between Servers Using DUMP/LOAD </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82946 ">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1992/04/01">
<META NAME="Keywords" CONTENT="kbusage SSrvGen SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When moving databases between servers using the DUMP and LOAD commands, the device fragments of the target database must match the device fragments of the source database not only in size, but also in sequence. If the device fragments are inconsist...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAZV,QAYV,QANJ,QAB5,QDMH,QA9N,QAYY,QAKD,QAEF,QAAP,QBWT,QAWH,QAKC,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Moving Databases Between Servers Using DUMP/LOAD</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82946 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
  - Microsoft SQL Server versions 4.2, 4.21, and 4.21a
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When moving databases between servers using the DUMP and LOAD
commands, the device fragments of the target database must match the
device fragments of the source database not only in size, but also in
sequence. If the device fragments are inconsistent, the integrity of
the LOAD may be compromised.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A database may be fragmented on a single device or across multiple
devices. The fragmentation is dependent on the way in which the
database is created, logged, and altered.
<P>
For example, consider a 12-MB database consisting of 8 MB of data and
a 4-MB log. The database FRAGMENTED is created on SERVER1 with the
following commands:
<P>
<PRE>   CREATE DATABASE fragmented
   ON dev1 = 2, dev2 = 2, dev3 = 2, dev4 = 2, log1 = 2, log2 = 2
   EXEC SP_LOGDEVICE fragmented, log1
   EXEC SP_LOGDEVICE fragmented, log2

</PRE>FRAGMENTED is created on SERVER2 with the following commands:
<P>
<PRE>   CREATE DATABASE fragmented
   ON dev1 = 4, log1 = 4, dev2 = 4
   EXEC SP_LOGDEVICE fragmented, log1

</PRE>Selecting segmap, lstart, and size from SYSUSAGES, where
<P>
<PRE>   dbid = DB_ID( 'fragmented' )

</PRE>results in the following:
<P>
<PRE>   SERVER1

   segmap  lstart  size
     3         0   1024
     3      1024   1024
     3      2048   1024
     3      3072   1024
     4      4096   1024
     4      5120   1024

   SERVER2

   segmap  lstart  size
     3         0   2048
     4      2048   2048
     3      4096   2048

</PRE>NOTE: A segmap value of 3 indicates a data segment and a segmap
value of 4 indicates a log segment. Lstart indicates the starting
logical address for this segment and size is the total number of 2K
data pages in the segment.
<P>
Comparing the values in the two tables reveals that only the first two
segments on SERVER1 correctly map to the first segment on SERVER2. The
remaining segments map to the wrong segmap for the corresponding
logical addresses. In other words, SERVER1's third segment
(lstart=2048) maps to SERVER2's second segment (lstart=2048). However,
SERVER1's third segment is for data, and SERVER2's second segment is
for log.
<P>
Because of the way LOAD works with SQL Server, some of SERVER1's data
may be loaded into SERVER2's log area, and some of SERVER1's log may
be loaded into SERVER2's data area. SQL Server merely copies
page-for-page when doing a load; for optimum speed, no checks are made
against a page's segment to prevent the mismatch above.
<P>
The LOAD will succeed with no indications of errors during the load or
upon completion. However, running DBCC CHECKALLOC indicates a problem,
most commonly an 2558 error (if one exists). Microsoft recommends
running DBCC CHECKDB and DBCC CHECKALLOC after the completion of all
loads.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Dumping loading Windows NT<BR>
Keywords            : kbusage SSrvGen SSrvWinNT<BR>
Version             : 4.2 | 4.2 4.21 4.21a<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
