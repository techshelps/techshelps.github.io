

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: ODBC Catalog Functions in Static Cursors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149923">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1996/04/16">
<META NAME="Keywords" CONTENT="kbprg kbusage SSrvProg SSrvSTProc">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The 2.65.0201 or later versions of the Microsoft SQL Server ODBC Driver support calling the ODBC catalog API functions while using static server cursors. This does not mean that the catalog stored procedures themselves can be called from within a s...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB9,QAZV,QAO2,QA9E,QAGI,QAY5,QBV8,QBWS,QAPN,QA2Q,QAU9,QACI,QDIT,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: ODBC Catalog Functions in Static Cursors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149923</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The 2.65.0201 or later versions of the Microsoft SQL Server ODBC Driver
support calling the ODBC catalog API functions while using static server
cursors. This does not mean that the catalog stored procedures themselves
can be called from within a static server cursor.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The section "Additional ODBC SQL Server Driver Information" in the SQL
Server 6.5 "Programing ODBC for SQL Server" manual states that the ODBC
catalog API functions can be called while using a static server cursor.
Users who know that the Microsoft SQL Server Driver implements the ODBC
Catalog API functions as calls to SQL Server catalog stored procedures (for
example, SQLTables was implemented as a call to sp_tables) may assume this
means that static cursors can be opened on the catalog stored procedures.
<P>
However, this is not a correct assumption. SQL Server 6.5 still has the
restriction that server cursors can only be opened for a single select
statement, or an execution of a procedure which contains only a single
select statement. This prevents opening server cursors against the catalog
stored procedures, because the procedures contain more than a single select
statement. What the sentence in the manual is saying is that the ODBC
Catalog API functions have been changed so that they can be called when the
application has set its statement or connection options to use static
cursors.
<P>
In SQL Server 6.5, the implementation of the ODBC catalog functions was so
that the Microsoft SQL Server ODBC Driver driver does not open a cursor
directly on the underlying catalog stored procedure using a static cursor.
It instead:

<OL><P><LI>Creates a temp table with the same format as the output of the
   procedure.

<P><LI>Uses the new 6.5 feature allowing an insert command to populate a table
   with the results of an execute of a stored procedure to put the catalog
   stored procedure results into the temporary table (more details can be
   found in the SQL Server 6.5 "Books Online," What's New in SQL Server
   6.5, Part 4 What's New in Transact-SQL, Statements and Functions, INSERT
   Statement.

<P><LI>Opens a static cursor based on a select of the temp table.

<P><LI>Drops the temp table (the static cursor will still have the contents of
   the select).

<P><LI>Processes further application requests for the catalog information by
   referencing the static cursor.
<P>
</OL>Please note that because calling the catalog stored procedures using a
static cursor entails creating a temporary table, doing this within a
transaction will require the server to place locks on some system tables in
tempdb. Users can therefore introduce locking contention on the tempdb
system tables if they have a lot of ODBC clients calling the ODBC catalog
functions using static cursors within transactions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: cursor odbc<BR>
Keywords            : kbprg kbusage SSrvProg SSrvSTProc<BR>
Version             : 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
