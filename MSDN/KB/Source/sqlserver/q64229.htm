

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Using a Stored DATETIME Key for Data Retrieval </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q64229 ">
<META NAME="KBModify" CONTENT="1997/11/07">
<META NAME="KBCreate" CONTENT="1990/07/27">
<META NAME="Keywords" CONTENT="SSrvDB_Lib SSrvProg SSrvTrans kbprg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  If you have a table with a key of type SQLDATETIME, after an entry has been selected by an application and you save the key in a program variable of type DBDATETIME, the best way to retrieve the customer information (given that you have the key sto...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAP2,QAVZ,QAYY,QAJ4,QATX,QBWS,QBNT,QAO0,QA2S,QA2Q,QAYL,QAUR,QA50,QBW9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using a Stored DATETIME Key for Data Retrieval</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q64229 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server Programmer's Toolkit, version 4.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you have a table with a key of type SQLDATETIME, after an entry has been
selected by an application and you save the key in a program variable of
type DBDATETIME, the best way to retrieve the customer information (given
that you have the key stored in a variable of type DBDATETIME) is the
following:
<P>
<PRE>   When you save your key as type DBDATETIME, it is possible to lose a
   portion of the unique time information. Converting the key to a string
   of type 9 or 109 prior to selection is the most reliable method of
   using a key of type DATETIME for further data retrieval.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
There are several things you need to consider when using a stored DATETIME
key for data selection:

<OL><P><LI>Uniqueness of the key. Both dbbind() and dbconvert() produce string
   results that do not contain the second and millisecond fields of
   the DATETIME data. This could cause serious data redundancy
   problems if these values were used as primary keys. Fortunately,
   you can avoid this problem by using the SQL CONVERT() function when
   selecting the data. Be sure to convert the data using either type 9
   or type 109 (as shown in the sample code). This will retain the
   entire value of the stored data field.

<P><LI>Storing the converted data as a string. Be sure to append a NULL
   ("/0") on the end of the string in your storage structure.
   Strncpy() does not do this for you.

<P><LI>Use of a string when selecting on type DATETIME. You must add a set
   of quotation marks on either side of the selection string for the
   SQL syntax to be correct.
<P>
</OL>There is a file in the Software/Data Library named DKEY.EXE that contains a
sample program that uses a stored DATETIME key for selection into a table.
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/DKEY.EXE">DKEY.EXE</A> <I>(size: 18782 bytes)</I> 
                     , a self-extracting file, on the following services:

</PRE><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select SQL Server.
      Enter kbfile &lt;FILENAME&gt;.EXE, and click GO!
      Open the article, and click the button to download the file.
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get &lt;FILENAME&gt;.EXE
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location.
      Type "mssupport" (without the quotation marks).
      Double-click the MS Software Library icon.
      Find the SQL Server product area.
      Locate and Download &lt;FILENAME&gt;.EXE.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download &lt;Filename&gt;.exe
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dblib DB-Lib Windows NT<BR>
Keywords          : SSrvDB_Lib SSrvProg SSrvTrans kbprg<BR>
Version           : 4.2 | 4.2 | 4.2<BR>
Platform          : MS-DOS OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
