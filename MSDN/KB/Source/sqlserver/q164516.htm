

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Error 17832 Caused by Blocking Timeout in 16-Bit Sockets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164516">
<META NAME="KBModify" CONTENT="1997/07/21">
<META NAME="KBCreate" CONTENT="1997/03/03">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork SSrvDB_Lib SSrvNet_Lib SSrvODS">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When the 16-bit sockets Net-Library (Dbmssoc3.dll) is used on a computer running Windows 95 to connect to SQL Server, the connection may time out with an operating system error -2. On the server side, a series of  17832 Unable to read login packet ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QAAP,QAB4,QABM,QAGI,QBG2,QDIR,QAA8,QAKP,QBXS,QA5E,QAU3,QAUD,QAMR,QACE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Error 17832 Caused by Blocking Timeout in 16-Bit Sockets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164516</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When the 16-bit sockets Net-Library (Dbmssoc3.dll) is used on a computer
running Windows 95 to connect to SQL Server, the connection may time out
with an operating system error -2. On the server side, a series of "17832
Unable to read login packet" errors are logged in the SQL Server errorlog.
The errors appear to occur simultaneously at first, and the frequency of
the error then changes to one error per second. This lasts for a period of
time approximately equal to the LoginTimeOut set by the application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To avoid re-entrancy issues, the 16-bit sockets Net-Library makes socket
connect calls in blocking mode. It registers its own blocking hook
function, which temporarily disables Windows message dispatching, and will
time out the connect call if the connect call does not return within the
blocking timeout (the default is five seconds). Upon receiving error 10004
(WSAEINTR) due to the blocking timeout, DB-Library or the ODBC driver will
retry the connection at incremental time intervals up to one second, until
the logon timeout finally expires. However, when a socket connect call is
interrupted on Windows 95, Winsock (Wsock.vxd) incorrectly returns an
undocumented error -2 on all subsequent connect attempts, even though the
connections are established successfully. The 16-bit Net-Library then
reacts to the unrecognized error -2 by closing the socket. On the server
side, SQL Server reports the Open Data Services (ODS) error 17832 for each
logon attempt when it tries to read from the closed connection, through
which the logon packet is expected to be sent.
<P>
On a normal TCP/IP network, the default blocking timeout (five seconds)
should be long enough, so socket connections are made without ever having
to invoke the blocking timeout. But if for any reason you observe that SQL
Server connections using the 16-bit sockets Net-Library fail frequently
with operating system error -2, and a large number of error 17832s are
logged on the server, you can increase the blocking timeout value to avoid
the problem. Just set the MaxSecondsToBlock value under the [SQL Server]
section in the Win.ini file. For example, you can use the following entry
to set the blocking timeout to 20 seconds:
<P>
<PRE>   [SQL Server]
   MaxSecondsToBlock=20

 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbinterop kbnetwork SSrvDB_Lib SSrvNet_Lib SSrvODS<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
