

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ESQL: Errors When Linking COBOL Applications for MS-DOS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96870 ">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1993/03/30">
<META NAME="Keywords" CONTENT="kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  You can use Micro Focus COBOL 3.0 or Microsoft COBOL 5.0 to compile and link MS-DOS applications with Microsoft Embedded SQL for COBOL Programmer's Toolkit (ESQL/COBOL). However, you may run into some linking errors using these versions of COBOL co...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBXT,QAE2,QADO,QAAP,QBXA,QDKW,QBJQ,QBFY,QAOT,QAJH,QAKP,QBHQ,QA7M,QA19 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ESQL: Errors When Linking COBOL Applications for MS-DOS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96870 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
<PRE>  - Microsoft Embedded SQL version 4.2 for COBOL
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You can use Micro Focus COBOL 3.0 or Microsoft COBOL 5.0 to compile
and link MS-DOS applications with Microsoft Embedded SQL for COBOL
Programmer's Toolkit (ESQL/COBOL). However, you may run into some
linking errors using these versions of COBOL compilers.
<P>
When linking MS-DOS applications using ESQL/COBOL 4.2, you will
normally use the following link command line as documented in the
ESQL/COBOL 4.2 "Programmer's Reference":
<P>
<PRE>   link yourprog.obj+sqlinim+MFC6INTF+C6DOSIF+C6DOSLB,,,
   lcobol+cobapi+llibcer+sqlakd+rldblib /NOE /NOD /NOF /NOP;

</PRE>This works correctly under earlier versions of the COBOL compilers
such as Micro Focus COBOL 2.5 or Microsoft COBOL 4.5. However, with
the new Micro Focus COBOL 3.0 or Microsoft COBOL 5.0, you will get
the following link errors:
<P>
<PRE>   rldblib.lib(..\..\src\dbmidio.c): error L2025: DOSSLEEP:
      symbol defined more than once
   rldblib.lib(..\..\src\dbmidio.c): warning L4004: possible
      fixup overflow at 24D in segment _DBMDIO
      target external 'DOSSLEEP'
   rldblib.lib(..\..\src\dbmidio.c): error L2002: fixup
      overflow at 24D in segment _DBMIDIO
      target external 'DOSSLEEP'

</PRE><h2>CAUSE</h2>
 
<P>
Due to changes in the new COBOL compiler libraries, the original
link line for linking MS-DOS applications as documented does not
work correctly.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, you can re-arrange the link line as
follows:
<P>
<PRE>   link yourprog.obj+sqlinim+MFC6INTF+C6DOSIF+C6DOSLB,,,
   lcobol+llibcer+rldblib+sqlakd+cobapi /NOE /NOD /NOF /NOP;

</PRE>Please note that the order of the library files is changed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: PTK MSDOS<BR>
Keywords            : kb3rdparty<BR>
Version             : 4.2 5.0<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
