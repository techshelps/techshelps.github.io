

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Record Has Been Changed" Error After Upsizing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163994">
<META NAME="KBModify" CONTENT="1997/03/11">
<META NAME="KBCreate" CONTENT="1997/02/20">
<META NAME="Keywords" CONTENT="SSrvGen kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  If you move a table from Microsoft Access 95 to SQL Server 6.5 with the Upsizing Wizard, and if the Upsizing Wizard added a timestamp field, Microsoft Access produces a dialog box titled Write Conflict that contains the following error:     This re...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QA5V,QA1S,QABM,QDN9,QBD2,QAC1,QA7O,QA7N,QA9N,QAH6,QDKW,QAA5,QAKD,QAIK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Record Has Been Changed" Error After Upsizing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163994</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you move a table from Microsoft Access 95 to SQL Server 6.5 with the
Upsizing Wizard, and if the Upsizing Wizard added a timestamp field,
Microsoft Access produces a dialog box titled Write Conflict that contains
the following error:
<P>
<PRE>   This record has been changed by another user since you started
   editing it. If you save the record, you will overwrite the changes
   the other user made.

   Copying the changes to the clipboard will let you look at the values
   the other user entered, and then paste your changes back in if you
   decide to make changes.

</PRE>This problem does not occur with SQL Server 6.0 or with Microsoft Access
97.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Upsizing Wizard moves the data to the server and then sends an alter
table statement to add the timestamp field. This adds the timestamp field,
but leaves it blank. After the upsizing is complete and it sends the
update
to the server, Microsoft Access sends the update with the timestamp value
of null, but it uses the SQL Server 6.0 syntax (that was appropriate when
the Upsizing Wizard was written). However, this procedure fails with SQL
Server 6.5. This problem is caused by the change in the default ANSI_NULLS
option for the driver. For more information, see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q152021.htm">Q152021</A></B>
   TITLE     : PRB: Deleting Records Containing NULLs Using DAO

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do the following:

<OL><P><LI>Use ISQL\W or Enterprise Manager to update every record in the table by
   sending a query that updates one of the fields to itself. For example,
   use the following query:
<P>
<P><PRE>      UPDATE newtable
      SET zipcode = zipcode
</PRE><P>
   This method updates every record without changing the content. By
   updating each record, the server provides values for the timestamp
   field.

<P><LI>In Microsoft Access, refresh the recordset or close and open the table
   again.
<P>
</OL>Now updates will work, because Microsoft Access will use a value for the
timestamp, instead of null.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Another workaround is to upsize the table without data. Then link to the
table and move the data into it with an append query. (AutoNumber/identity
fields require the use of IDENTITY_INSERT.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 6.50<BR>
Keywords            : SSrvGen kbinterop kbprb<BR>
Version             : 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
