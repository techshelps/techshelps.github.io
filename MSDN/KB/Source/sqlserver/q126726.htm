

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Using SQLMail with a NetWare Post Office </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126726">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1995/03/01">
<META NAME="Keywords" CONTENT="kb3rdparty kbsetup SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When you run Microsoft SQL Server on Windows NT, you need to run the SQL Server service under the system account (sometimes called the LocalSystem account) in order to have SQLMail functionality.  A service running under the system account has no u...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QALZ,QDI2,QABM,QBWP,QAYC,QAI5,QBG2,QAIJ,QAGU,QACK,QBWS,QBW7,QAFZ,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using SQLMail with a NetWare Post Office</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126726</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21 and 4.21a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you run Microsoft SQL Server on Windows NT, you need to run the SQL
Server service under the system account (sometimes called the LocalSystem
account) in order to have SQLMail functionality.
<P>
A service running under the system account has no user account information
to use when accessing remote resources. Therefore, the SQL Server service
cannot directly access certain server software, including Novell NetWare.
<P>
However, it is still possible to set up SQLMail to work when the mail post
office is on a Novell NetWare file server. This can be done by going
through the Gateway Services for NetWare, which ship with Microsoft Windows
NT version 3.5.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can follow the steps below to set up SQLMail to work with a NetWare
post office:

<OL><P><LI>Set up a gateway share on the Windows NT Server to point to the
   post office share on the NetWare computer. This step will require
   supplying a valid NetWare user account and password for an account
   that has RWCD access to the post office share. For more information
   on how to set this up, see the Windows NT documentation on the
   Gateway Services for NetWare.

<P><LI>Set up the Win32 Mail client (MSMAIL32.EXE) to connect to the
   NetWare post office using the drive letter specified for the gateway
   connection.

<P><LI>Verify that the user setting up SQLMail can successfully
   start a mail session, then send mail using the Win32 mail client.

<P><LI>In the SQL Setup program, go to Set Server Options, Mail Login
   and select the check box for Copy SQLMail Configuration From Current
   User Account. This will copy the mail client configuration information
   from the current user account into the following location in the Windows
   NT registry:
<P>
<P><PRE>      \\HKEY_USERS\.DEFAULT\Software\Microsoft\Mail\MicrosoftMail
</PRE><P>
</OL>Once you successfully complete the above steps, you can set up SQLMail to
start automatically when SQL Server starts, or it can be started manually
using the xp_startmail extended stored procedure with a valid mail username
and password.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q118501.htm">Q118501</A></B>
   TITLE     : INF: Troubleshooting SQLMail Problems
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sqlmail mapi postoffice<BR>
Keywords            : kb3rdparty kbsetup SSrvWinNT<BR>
Version             : 4.21 4.21a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
