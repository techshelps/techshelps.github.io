

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: How to Debug Direct Connections to SQL Srv over IPX/SPX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138716">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1995/10/25">
<META NAME="Keywords" CONTENT="kbnetwork kbprg SSrvLan SSrvNet_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  A Novell NetWare IPX/SPX client normally connects to Microsoft SQL Server by first querying the NetWare Bindery for address resolution. However, if NetWare Binderies are not available for whatever reason, you can configure your IPX/SPX clients to c...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QAKC,QABM,QAI5,QBC6,QBG2,QAG8,QAM5,QBWD,QBVV,QABI,QA6A,QA2O,QABA,QAHN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Debug Direct Connections to SQL Srv over IPX/SPX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138716</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21 and 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A Novell NetWare IPX/SPX client normally connects to Microsoft SQL Server
by first querying the NetWare Bindery for address resolution. However, if
NetWare Binderies are not available for whatever reason, you can configure
your IPX/SPX clients to connect to SQL Server directly by hardcoding the
IPX address information in the connection string. This is documented in the
SQL Server product manuals, both versions 4.2 and 6.0. Because this article
only provides supplemental information related to this subject, it is
recommended that you use this article in conjunction with the product
documentation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you still can not make direct connections to SQL Server after following
the instructions in the documentation (page 90-92 of the version 6.0
"Administrator's Companion," or page 108 of the version 4.21 "Configuration
Guide"), here are some additional tips:

<OL><P><LI>The Windows NT command "IPXROUTE CONFIG" returns more complete
   information about the IPX address and network number than the "NET
   CONFIG SERVER" as recommended in the manual.

<P><LI>The network number used in the SQL connection string should be in
   decimal. Because network numbers are typically in hexadecimal, you need
   to convert them into decimal in the connection string.

<P><LI>If the client is on the same segment as the SQL Server, you can
   use "0" as the network number. In NetWare networks, when a node sends
   IPX packets with "0" as the network number, other IPX nodes will
   interpret this "0" as the network number of the local network cable
   segment where the sending node resides, and accept these packets as
   local IPX packets because a routed IPX packet will never have "0" as
   the network number.

<P><LI>To verify whether one particular network number is correct, use this
   network number on the local server for the direct connection. If you
   can not even connect from the local server, you should verify that the
   direct connection works from the local server by using "0" as the
   network number. If the local direct SPX connection does not work even
   with "0" as the network number, it probably indicates that there are
   problems with the network adapter card or drivers on this local server
   that does not support loopback traffic. Further verify this by making
   direct SPX connections from other clients.

<P><LI>If the server has more than one NIC (Network Interface Card), you
   should configure the internal network number properly. See Knowledge
   Base article <B><A HREF="../SQLSERVER/Q137787.htm">Q137787</A></B> for more information. If the "IPX internal network
   number" as returned by "IPXROUTE CONFIG" is not zero, you should use the
   following as the direct connection string:
<P>
<P><PRE>      000000000001,33854,&lt;IPX internal network number&gt;
</PRE><P>
   where &lt;IPX internal network number&gt; is the number returned from
   "IPXROUTE CONFIG", which you should convert into decimal.

<P><LI>If you have verified the IPX address and network number but still
   can not make direct connections from a Windows client (16-bit), please
   see Knowledge Base article <B><A HREF="../SQLSERVER/Q128618.htm">Q128618</A></B>.

<P><LI>If you can make the connection via IPX/SPX using the service name (that
   is, the SQL Server name), but the direct connection fails, you can check
   your direct connection string against the information in the NetWare
   bindery. For information about how to check the bindery objects, please
   see Knowledge Base article <B><A HREF="../SQLSERVER/Q112713.htm">Q112713</A></B>.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hardcoding MAC Address<BR>
Keywords            : kbnetwork kbprg SSrvLan SSrvNet_Lib<BR>
Version             : 4.21 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
