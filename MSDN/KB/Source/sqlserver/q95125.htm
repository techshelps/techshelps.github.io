

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: dbwritetext Sample Code Documentation Incorrect </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95125 ">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1993/02/01">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib SSrvDoc_Err">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The dbwritetext documentation on page 246 and 247 of the  Programmer's Reference for C  contains incorrect sample code.  MORE INFORMATION  On page 246, replace the last part of the code in the example, from the following lines to the end     while ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAXB,QAML,QABM,QAZM,QAZL,QATX,QAPF,QAMB,QAKD,QAC1,QBD2,QAAP,QAE1,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: dbwritetext Sample Code Documentation Incorrect</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95125 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server Programmer's Toolkit, version 4.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The dbwritetext documentation on page 246 and 247 of the "Programmer's
Reference for C" contains incorrect sample code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
On page 246, replace the last part of the code in the example, from the
following lines to the end
<P>
<PRE>   while (dbnextrow(q_dbproc)
       != NO_MORE_ROWS);

</PRE>to read as follows:
<P>
<PRE>   while (dbnextrow(q_dbproc) != NO_MORE_ROWS)
   {
       /* Change the value of "abstract_var". */
       strcpy(abstract_var, "A brand new value.");
       /* Update the text column. */
       dbwritetext(u_dbproc, "articles.abstract", dbtxptr(q_dbproc, 1),
           DBTXPLEN, dbtxtimestamp(q_dbproc, 1), TRUE,
           (DBINT)strlen(abstract_var), abstract_var);
   }
   /* Done. */
   dbexit();

</PRE>On page 247, replace the last part of the code in the example, from
the following lines to the end
<P>
<PRE>   while (dbnextrow(q_dbproc)
       != NO_MORE_ROWS);

</PRE>to read as follows:
<P>
<PRE>   while (dbnextrow(q_dbproc) != NO_MORE_ROWS)
   {
       /* Change the value of part of the text column. This example */
       /* adds a sentence to the end of the existing text.*/
       /* Update the text column. */
       dbwritetext(u_dbproc, 'articles.abstract", dbtxptr(q_dbproc, 1),
           DBTXPLEN, dbtxtimestamp(q_dbproc, 1), TRUE,
           (DBINT)(strlen(part1) + strlen(part2)), NULL);
       dbsqlok(u_dbproc);
       dbresults(u_dbproc);
       /* Send the update value in chunks. */
       dbmoretext(u_dbproc, (DBINT)strlen(part1), part1);
       dbmoretext(u_dbproc, (DBINT)strlen(part2), part2);
       dbsqlok(u_dbproc);
       while (dbresults(u_dbproc) != NO_MORE_RESULTS);
   }
   dbexit();
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: db-lib dblib<BR>
Keywords            : kbprg SSrvDB_Lib SSrvDoc_Err<BR>
Version             : 4.2 | 4.2 | 4.2<BR>
Platform            : MS-DOS OS/2 WINDOWS<BR>
Issue type          : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
