

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Remote Stored Procedure Call Fails with Error 7221 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129604">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1995/04/30">
<META NAME="Keywords" CONTENT="kbtool SSrvLan SSrvNet_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Under certain circumstances when you run a remote stored procedure, you could receive the following error on the SQL Server where the remote stored procedure is initiated:     Msg 7221, Level 17, State 2    Login to site '             ' failed  CAU...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QANN,QBWP,QAUJ,QAB4,QAAP,QBWS,QAI5,QAGI,QBWD,QAB9,QBG2,QAJH,QACK,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Remote Stored Procedure Call Fails with Error 7221</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129604</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.2, 4.21, and 4.21a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Under certain circumstances when you run a remote stored procedure, you
could receive the following error on the SQL Server where the remote
stored procedure is initiated:
<P>
<PRE>   Msg 7221, Level 17, State 2
   Login to site '&lt;server name&gt;' failed

</PRE><h2>CAUSE</h2>
 
<P>
The conditions for this error to occur are:

<OL><P><LI>The SQL Server where the Remote Stored Procedure is initiated is
   running with the local system account.

<P><LI>The Open Data Services (ODS) application that services the remote
   stored procedure is run on Windows NT version 3.5 or later.
<P>
</OL>This error occurs because SQL Server is not able to connect to the named
pipe that the ODS application is listening on because, by default, the
local system account has no permissions to connect to a named pipe on
Windows NT version 3.5 or later on another computer.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In order to enable SQL Server to connect with the local system account, you
should ensure that the named pipe that the remote ODS application is
listening on is included in the NullSessionPipes value of the
HKEY_LOCAL_MACHINE setting
SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters for the server
that is running the ODS application. You should then reboot that server.
<P>
For example, if you are running the sample ODS application PROCSRV on a
server named NTSRV and listening on the named pipe \\.\pipe\procsrv\query,
you would need to add procsrv\query to the NullSessionPipes value on the
server NTSRV.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: RPC<BR>
Keywords            : kbtool SSrvLan SSrvNet_Lib<BR>
Version             : 4.2 4.21 4.21a<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
