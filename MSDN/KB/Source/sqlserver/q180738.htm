

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Windows NT Error 2140 When Starting SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180738">
<META NAME="KBModify" CONTENT="1998/02/23">
<META NAME="KBCreate" CONTENT="1998/02/09">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Attempting to start the MSSQLServer service may cause the following error:     Windows NT Error 2140: An internal Windows NT error occurred.  The following error may also appear in the SQL Server errorlog:     Init config error 2. The system cannot...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QAIJ,QABI,QAAP,QAOE,QAMA,QAA1,QDIV,QBXB,QATJ,QAB4,QAFI,QDI2,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Windows NT Error 2140 When Starting SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180738</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to start the MSSQLServer service may cause the following error:
<P>
<PRE>   Windows NT Error 2140: An internal Windows NT error occurred.

</PRE>The following error may also appear in the SQL Server errorlog:
<P>
<PRE>   Init config error 2. The system cannot find the file specified.
   Opening master.dat for config information.

</PRE><h2>CAUSE</h2>
 
<P>
These errors can be caused by any of the following:

<UL><LI>The Master.dat file is not in the correct directory, or the Windows NT
   account being used does not have appropriate permissions to that
   directory.

<LI>The Windows NT user account that the MSSQLServer service starts under
   does not have permission to the registry keys.

<LI>An sp_configure value has been set out of range.

<LI>Registry entries are missing.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To resolve this problem, do the following:

<OL><P><LI>Check to make sure the Master.dat file exists in the &lt;SQL_root&gt;\Data
   directory. There may be a case where the master device was installed to
   another directory. To determine this, check the errorlog from the
   &lt;SQL_root&gt;\Log directory. If you find an  operating system error 2
   ("Could not find the file specified"), it will also list the path to the
   directory where SQL Server expects to find Master.dat.
<P>
   If you locate Master.dat and it is not in the &lt;SQL_root&gt;\Data directory,
   use the following command to start the MSSQLServer service:
<P>
<P><PRE>      sqlservr /d&lt;path_to_Master.dat&gt; /e&lt;path_to_errorlog&gt;
</PRE><P>
   NOTE: There is no space between the command switches (that is, "d" or
   "e") and the paths. For more information on the SQLSERVR command-line
   executable program, see the SQL Server Books Online.
<P>
   If SQL Server starts, the startup entries in the registry are incorrect.
   To correct them, skip to step 4 of this procedure, below.

<P><LI>In Control Panel Services, select the MSSQLServer service and click
   Startup. In the Log On As section, note what account SQL Server is
   running under. Make sure this Windows NT account has all the appropriate
   permissions to read all the SQL Server registry keys, as well as the
   directory containing the Master.dat file. For additional information on
   MSSQLServer service permissions, see the following article in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../SQLSERVER/Q164167.htm">Q164167</A></B>
<PRE></PRE>      TITLE     : INF: Troubleshooting SQL Security Manager Messages

</PRE><P><LI>Check to make sure that the sp_configure values are not set too high.
   For information on how to do this, see the following article in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../SQLSERVER/Q173090.htm">Q173090</A></B>
<PRE></PRE>      TITLE     : INF: Changing Configuration Values When SQL Server Won't
                  Start

</PRE><P><LI>If none of the steps above resolves the problem, run Registry Rebuild
   for SQL Server from SQL Server setup. To do this, perform the steps
   below.
<P>
   CAUTION: It is recommended that you make a complete backup of your
   system before performing the registry rebuild.
<P>
   a. Restart the computer and log on as the administrator of the local
<P><PRE>      machine.
</PRE><P>
   b. Use SQL Server Setup to note the options that are currently
<P><PRE>      configured in the registry, for example, the network libraries that
      SQL Server is currently listening in on, or the Security model
      (Standard, Integrated, or Mixed) that SQL Server is using.
</PRE><P>
   c. From a command prompt, issue the following command from the
<P><PRE>      &lt;SQL_root&gt;\Binn directory:
</PRE><P>
<PRE>         setup /t RegistryRebuild = On

      NOTE: This command must be typed exactly as shown, including
      capitalization. The spaces surrounding the equal sign (=) are
      required.

      SQL Server Setup will start. It will appear as though SQL Server is
      being reinstalled, but it is just rewriting the registry
      information. Ensure that the path to where SQL Server and Master.dat
      are located is correct. Reset any options noted in the previous step
      (step b.)

      NOTE: Information on the character set, sort order, and size of the
      master database is stored within the existing Master.dat file.

   d. Start SQL Server normally.

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
For more information on the RegistryRebuild option of Setup, see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q157805.htm">Q157805</A></B>
   TITLE     : BUG: RegistryRebuild Option of Setup Is Not Documented
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: initconfig event log errorlog<BR>
Version           : WINNT:6.0,6.5<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
