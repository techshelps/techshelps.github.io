

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Movement of Keyset in a Mixed Cursor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89923 ">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1992/10/05">
<META NAME="Keywords" CONTENT="kbother SSrvServer">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  A mixed cursor is keyset-driven inside the keyset, but fully dynamic outside the keyset. This article discuss the movement of a keyset in this type of cursor.  MORE INFORMATION  By using the Microsoft Cursor APIs in dblib, you can create four diffe...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QAC6,QAGI,QANJ,QABM,QA9N,QAEF,QACI,QBXS,QA5V,QAWE,QAVQ,QAL3,QAK1,QACJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Movement of Keyset in a Mixed Cursor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89923 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A mixed cursor is keyset-driven inside the keyset, but fully dynamic
outside the keyset. This article discuss the movement of a keyset in
this type of cursor.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By using the Microsoft Cursor APIs in dblib, you can create four
different kinds of cursors: static, keyset-driven, dynamic, and mixed.
A keysetdriven cursor keeps all the keys of the result set locally and
the fetch buffer is smaller than the keyset. A dynamic cursor has the
fetch buffer equal to the keyset. A mixed cursor has keyset that is
larger than the fetch buffer, but smaller than the result set. Hence,
it is keyset-driven inside the keyset, but fully dynamic outside of
it.
<P>
While the fetch buffer can be moved by direct API calls
(dbcursorfetch, for example), the movement of keyset is always
implicit. In a fully keyset-driven cursor, the keyset does not move
because it is equal to the result set. In a fully dynamic cursor, the
keyset moves with the fetch buffer. The movement of keyset is more
involved in a mixed cursor. For example, for a mixed cursor, if the
result set size is 100, the keyset size is 20 and the fetch buffer is
10.
<P>
Also, assume that the fetch buffer starts from the third row in the
keyset. Then, a call to dbcursorfetch with FETCH_NEXT option will
return only the next eight rows (rows 13-20 in the keyset) because it
is unable to span the keyset boundary. To move the keyset down,
dbcursorfetch should be called with either FETCH_RANDOM or
FETCH_RELATIVE option, and the rownum set to 13. This will fetch the
next eight rows within the keyset. The next call to dbcursorfetch with
the FETCH_NEXT option will result in moving the keyset down and
fetching the two remaining rows. This is the only way that a keyset
can move in case of a mixed cursor.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: cursors<BR>
Keywords            : kbother SSrvServer<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
