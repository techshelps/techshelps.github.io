

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Restrictions on the Use of Xp_sqlinventory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172389">
<META NAME="KBModify" CONTENT="1997/08/08">
<META NAME="KBCreate" CONTENT="1997/08/05">
<META NAME="Keywords" CONTENT="SSrvStProc kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  SQL Server 6.5 includes the xp_sqlinventory extended stored procedure to capture SQL Server configuration and inventory information, and store it in a specified database and table. This article documents some restrictions on the use of xp_sqlinvent...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWS,QA5V,QAB9,QAA1,QDIV,QAK9,QAIJ,QABN,QA9A,QAYY,QAI5,QABY,QBVX,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Restrictions on the Use of Xp_sqlinventory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172389</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SQL Server 6.5 includes the xp_sqlinventory extended stored procedure to
capture SQL Server configuration and inventory information, and store it in
a specified database and table. This article documents some restrictions on
the use of xp_sqlinventory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When SQL Server starts, the sp_sqlregister stored procedure is run. This
procedure calls the xp_sqlregister extended stored procedure, which gathers
basic configuration information from the operating system, network, and SQL
Server, and then broadcasts the SQL Server's presence to every computer on
the domain by means of mailslot. Any server executing xp_sqlinventory can
collect the information and store it into a table.
<P>
The sp_sqlregister stored procedure is installed as a default startup
procedure. If desired, you can run the sp_unmakestartup stored procedure to
remove sp_sqlregister as a startup stored procedure. To mark sp_sqlregister
as a startup procedure, use sp_makestartup. For further information, refer
to the Microsoft SQL Server Books Online.
<P>
The one restriction noted in the printed and online documentation is that
SQL Servers running under the Local System account will not be included in
the inventory list. To be recorded, SQL Servers must be started under a
domain user account. In addition, only those servers that have started
since xp_sqlinventory was first invoked will be recorded. When
xp_sqlinventory is first invoked, it does not record every server currently
running in the domain. To record information from all servers in the
domain, either each SQL Server must be restarted while xp_sqlinventory is
running, or xp_sqlregister must be run by an operator on each server.
<P>
If the default Net-Library is not set to named pipes on the server,
xp_sqlregister may fail to connect to the server at startup, giving an
"Unable to connect" message. For more information, see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q167352.htm">Q167352</A></B>
   TITLE     : BUG: "Unable to Connect" Msg May Occur in Application Event
               Log

</PRE>Because xp_sqlregister is broadcasting to a mailslot, all servers on which
inventory information is to be gathered must be on the same network
segment, because routers may filter out the broadcasts. To work around this
restriction, set up one server in each segment to capture the broadcasts
and publish them to a central subscription server.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: netlib net-lib lib net machine<BR>
Keywords          : SSrvStProc kbusage<BR>
Version           : 6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
