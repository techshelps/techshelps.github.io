

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Using DB-Library with Borland C++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104717">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1993/09/27">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Using DB-Library for Microsoft Windows and MS-DOS with Borland C++ version 3.1 requires a few additional steps to configure correctly.  MORE INFORMATION  Follow these steps to create a Borland C++ project for a DB-Library application:  1. Select th...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QAG2,QDL9,QBWO,QBWN,QAH4,QAFI,QBWQ,QBXS,QBWS,QABM,QBXB,QA2Q,QATJ,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using DB-Library with Borland C++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104717</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server Programmer's Toolkit, version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using DB-Library for Microsoft Windows and MS-DOS with Borland C++
version 3.1 requires a few additional steps to configure correctly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Follow these steps to create a Borland C++ project for a DB-Library
application:

<OL><P><LI>Select the Options menu, choose Directories. Include the directory
   where the DB-Library .H header files are located
   (C:\SQL\DBLIB\INCLUDE by default) in the Include Directories box.
   Include the directory where the DB-Library .LIB library files are
   located (C:\SQL\DBLIB\LIB by default) in the Library Directories box.

<P><LI>Select the Project menu, choose Open Project. Pick an appropriate
   project File Name, using the Directories list box to specify the
   directory where the application's C/C++ source code files reside.

<P><LI>Select the Options menu, choose Application. Pick the appropriate
   application option button:
<P>
   a. For Windows, pick Windows App or Windows DLL
   b. For MS-DOS, pick DOS Standard

<P><LI>Select the Project menu, choose Add Item. In the File Name box of the
   Add To Project List dialog box, type the directory (C:\SQL\DBLIB\LIB
   by default) and file name of the appropriate DB-Library .LIB library
   file:
<P>
   a. For Windows, use W3DBLIB.LIB
   b. For medium model MS-DOS, use BMDBLIB.LIB
   c. For large model MS-DOS, use BLDBLIB.LIB
<P>
   then use the Add button to include the file in the project. Ensure
   that the appropriate .LIB file is now listed in the Project window.

<P><LI>Include the C/C++ application's source code files in the project.

<P><LI>For MS-DOS, select the Options menu, choose Compiler, then Code
   Generation. From the Model list, choose the appropriate memory model:
<P>
   a. For medium model MS-DOS, pick Medium
   b. For large model MS-DOS, pick Large

<P><LI>Select the Options menu, choose Compiler, then Advanced Code
   Generation. Ensure that the Generate Underbars box is checked. If this
   option is unchecked, Borland linker errors similar to the following
   will occur:
<P>
   Linker Error: Undefined symbol dbinit in module SQLTEST.C

<P><LI>For Windows, select the Options menu, choose Linker, then Settings.
   Ensure that both Case-Sensitive Link and Case-Sensitive Exports are
   checked. If either of these options are unchecked, Borland linker
   errors similar to the following will occur:
<P>
   Linker Error: Undefined symbol _dbinit in module SQLTEST.C

<P><LI>For Windows, select the Options menu, choose Compiler, then Entry/Exit
   Code. NOTE: Windows all functions exportable is the default. If
   either Windows explicit functions exported or Windows DLL explicit
   functions exported is chosen, the application's DB-Library error and
   message handlers must be declared using the Borland C++ __export
   keyword. Failure to do can result in a general protection fault (GP
</OL>fault)
<PRE>   inside the application's DB-Library error or message handler.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dblib<BR>
Keywords            : kbprg SSrvDB_Lib SSrvProg<BR>
Version             : 4.2<BR>
Platform            : MS-DOS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
