

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Non SA CmdExec Task or Xp_cmdshell May Cause Error 1314 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171291">
<META NAME="KBModify" CONTENT="1997/07/11">
<META NAME="KBCreate" CONTENT="1997/07/11">
<META NAME="Keywords" CONTENT="kbenv kbusage SSrvAdmin SSrvEntMan SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  If you run CmdExec tasks while not logged on as the system administrator (SA), you may receive the error message below. This error is reported in the task history, as well as in the Application Log of Windows NT Server's Event Viewer:     A problem...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QACK,QAB4,QAA1,QBWP,QDI2,QBG2,QBWS,QDKW,QAAP,QAGR,QAI5,QBWG,QBVV,QALM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Non SA CmdExec Task or Xp_cmdshell May Cause Error 1314</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171291</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you run CmdExec tasks while not logged on as the system administrator
(SA), you may receive the error message below. This error is reported in
the task history, as well as in the Application Log of Windows NT Server's
Event Viewer:
<P>
<PRE>   A problem occurred while attempting to logon as the Windows NT user
   'SQLExecutiveCmdExec':  A required privilege is not held by the client.

</PRE>If you run xp_cmdshell while not logged on as the SA, you may receive the
following error message:
<P>
<PRE>   xpsql.c: Error 1314 from LogonUser on line 359

</PRE><h2>CAUSE</h2>
 
<P>
The SQL Executive service (for CmdExec tasks) or the MSSQLServer service
(for xp_cmdshell tasks) is not running under an account with the
permissions documented in the "MSSQLServer Service and SQL Executive
Requirements" topic of the SQL Server Books Online. You can find this topic
in Part 2, "What's New for Setup," of the "What's New in SQL Server 6.5"
book, under "Platform Support" and "Running on Windows NT 3.51 or Later."
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem for CmdExec tasks, use either of the following
methods:

<UL><LI>If the task can be owned by the SA, re-create the task using an SA
   login.
<P>
   -or-

<LI>Re-create the permissions on the SQL Executive service account by using
   the following steps:
<P>
   1. Use SQL Enterprise Manager to set up the SQL Executive service to run
<P><PRE>      under the same account again, which will reset the permissions
      required.
</PRE><P>
   2. Stop and restart the SQL Executive service.
<P>
</UL>To work around this problem for xp_cmdshell, use either of the following
methods:

<UL><LI>Disable the "xp_cmdshell - Use SQLExecutiveCmdExec Account for Non SAs"
   option in SQL Enterprise Manager or SQL Setup.

<LI>Re-create the permissions on the SQL Server service account by using the
   following steps:
<P>
   1. Use SQL Enterprise Manager to set up the SQL Executive service to run
<P><PRE>      under the account that the MSSQLServer service is running under,
      which will reset the permissions required.
</PRE><P>
   2. Change the SQL Executive service back to its original account.
<P>
   3. Stop and restart the MSSQLServer service.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SQLExecutive<BR>
Keywords            : kbenv kbusage SSrvAdmin SSrvEntMan SSrvGen<BR>
Version             : 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
