

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Grant or Revoke Permissions for ESQL Stored Procedures </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112714">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/03/17">
<META NAME="Keywords" CONTENT="kbprg SSrvCobol SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When compiling Embedded SQL for COBOL (ESQL) applications using SQLACCESS option, stored procedures will be created on the SQL Server for all static SQL statements. When executing the static queries at run time, the application will call the stored...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QDNQ,QABM,QAUJ,QAGI,QBV8,QBM2,QBWG,QAH4,QAGC,QBWS,QAK7,QAJH,QDMW,QA6T V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Grant or Revoke Permissions for ESQL Stored Procedures</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112714</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft Embedded SQL version 4.21 for COBOL
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When compiling Embedded SQL for COBOL (ESQL) applications using SQLACCESS
option, stored procedures will be created on the SQL Server for all static
SQL statements. When executing the static queries at run time, the
application will call the stored procedures automatically. Often you may
need to grant or revoke execution permissions on the stored procedures for
security controls. However, this task may become tedious because there may
be many stored procedures and all of them have very long names. This
article discusses the options available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Depending on your specific requirement, you may choose one of the following
two options:

<OL><P><LI>Using SQL scripts:
<P>
   You can create an isql batch file that will select all stored
   procedures beginning with the program (or module) string, then
   use isql to grant permission on these procedures. For example,
   assume the ESQL/COBOL program name is myprog, then you can create a
   script file named
<P>
   getnames.sql:
<P><PRE>      select "grant execute on ", name, " to public"
      from sysobjects
      where name like "myprog%"
</PRE><P>
</OL>Then run the following SQL scripts:
<P>
<PRE>   isql -Usa -Ppassword -Smyserver -igetnames.sql -ograntall.sql
   isql -Usa -Ppassword -Smyserver -igrantall.sql

</PRE></OL>NOTE: You will need to modify the scripts GETNAMES.SQL and GRANTALL.SQL to
remove the headers and other non Transact-SQL text, and add the necessary
Transact-SQL commands such as "use yourdatabase" and "go". You can also use
MS-DOS batch commands such as ECHO to automate the generation and execution
of the scripts.

<OL><P><LI>Using pre-compiled stored procedures:
<P>
   Instead of having the ESQL/COBOL precompile service to generate the
   stored procedures for you, you can create the stored procedures
   yourself and simply call the stored procedures in place of the SQL
   statements. Using ESQL command EXECUTE, you can avoid a stored
   procedure from being compiled into another procedure when compiling
   the application.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbprg SSrvCobol SSrvProg<BR>
Version             : 4.21<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
