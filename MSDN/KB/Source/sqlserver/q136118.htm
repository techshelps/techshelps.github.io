

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: 6.0 Transfer Manager With Dependencies Causes Error 145 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136118">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1995/08/31">
<META NAME="Keywords" CONTENT="kbtool SSrvTran">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  An attempt to use the SQL Transfer Manager to transfer a version 6.0 database with the  Include Dependencies  checkbox selected will fail. Examination of the transfer log shows the following error messages:     Server message 145, severity 1, state...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAH5,QASP,QAH6,QAB4,QAEV,QDNQ,QAGU,QAW6,QAPN,QALS,QAAP,QAUJ,QAYC,QAGR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 6.0 Transfer Manager With Dependencies Causes Error 145</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136118</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to use the SQL Transfer Manager to transfer a version 6.0
database with the "Include Dependencies" checkbox selected will fail.
Examination of the transfer log shows the following error messages:
<P>
<PRE>   Server message 145, severity 1, state 15:  Order-by
      items must appear in the select-list if SELECT
      DISTINCT is specified.
   Server message 207, severity 2, state 16:  Invalid
      column name 'tid'.
   Server message 208, severity 1, state 16:  Invalid
      object name #tempudt'.
   Server message 208, severity 1, state 16:  Invalid
      object name '#t1'.
   Server message 208, severity 1, state 16:  Invalid
      object name '#t1'.
   Server error 10007, severity 5:  General SQL Server
      error: Check messages from the SQL Server.

</PRE>This does not happen if you do not select the "Include Dependencies"
checkbox.
<P>
<P><h2>CAUSE</h2>
 
<P>
If your source server is Microsoft SQL Server version 6.0, the OBJECT60.SQL
script must have been run on the server if you are including dependencies.
Otherwise, SQL Transfer Manager tries to create the 4.21 dependency-
evaluator stored procedure, which fails due to parser changes in version
6.0.
<P>
This is documented in the Microsoft SQL Server "Administrator's Companion,"
Chapter 11, under "Transferring Objects and Data Using SQL Transfer
Manager".
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Run the OBJECT60.SQL script located in the \SQL60\INSTALL directory. See
Appendix A of the "Administrator's Companion," "Using SQL Administrator and
SQL Object Manager" for details on installing this script.
<P>
Alternatively, you can use the 204 trace flag as documented in the
"Transact-SQL Reference" manual under "Trace Flags."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 errors<BR>
Keywords            : kbtool SSrvTran<BR>
Version             : 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
