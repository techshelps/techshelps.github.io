

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: IIS Queries to SQL Server Generate Error 1326 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152828">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1996/06/25">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When you use anonymous connections for IIS and you attempt to query remote SQL servers using named pipes, the following error may occur:     [State =01000][Error=1326][Microsoft][ODBC SQL Server Driver]    [SQL Server][dbnmpntw] ConnectionOpen (Cre...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABM,QBG2,QAI5,QAUJ,QAB4,QAAP,QAKR,QA4H,QARL,QBVX,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: IIS Queries to SQL Server Generate Error 1326</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152828</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21, 6.0 and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use anonymous connections for IIS and you attempt to query remote
SQL servers using named pipes, the following error may occur:
<P>
<PRE>   [State =01000][Error=1326][Microsoft][ODBC SQL Server Driver]
   [SQL Server][dbnmpntw] ConnectionOpen (CreateFile())

</PRE>Error 1326 means "Logon failure: unknown user name or bad password."
This error is raised because the IIS Service does not have any rights to
use the named pipe.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order for a SQL server client to gain access to a Windows NT named pipe,
the client needs to be validated by the Windows NT server. This is normally
accomplished through a Workgroups style validation method where identical
usernames and passwords are created on the client and the server, or the
domain method where both the client and server are domain members.
<P>
The Internet Information Server (IIS) setup process creates a Windows NT ID
called IUSR_machinename (where machinename is the name of the Windows NT
server), and adds that user to the Guest local group. The IIS service runs
under this Windows NT account name.
<P>
If the connection to IIS is anonymous, IIS uses the Windows NT account
IUSR_machinename and so any network activity performed by IIS is done
under this account ID.
<P>
If the SQL server resides on the same server as IIS, then named pipes
connections work and validation is successful.
<P>
If the SQL server resides on a separate server from IIS, then the
IUSR_machinename account needs to be validated on the Windows NT server
that SQL resides on.
<P>
This validation can be implemented by several methods:

<UL><LI>Add the account to the local user account database on the NT server
   that SQL resides on.

<LI>Make the Windows NT ID IUSR_machinename a member of the domain that
   the SQL server resides in.

<LI>Enable the Windows NT ID Guest.
<P>
</UL>For more information regarding security and Microsoft Internet Information
Server, please refer to the following article in the Microsoft Knowledge
Base:
<P>
Article-ID: <B><A HREF="../IIS/Q142868.htm">Q142868</A></B>
<PRE>TITLE     : IIS: Authentication &amp; Security Features
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ODBC IIS<BR>
Version             : 4.21 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
