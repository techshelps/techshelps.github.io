

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SQL Server and C2 Security </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148974">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork kbusage SSrvInst SSrvLan">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Most of the SQL Server applications and utilities that use network access of some kind, for example Isql.exe, Isqlw.exe, Sqlew.exe, and Perfmon.exe, require access to the Windows NT \\Hkey_local_machine\Software\Description key. These applications ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABM,QAH5,QAAD,QAI5,QBWG,QAK7,QBW7,QBWU,QAJH,QAGU,QA7O,QA5E,QAOE,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SQL Server and C2 Security</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148974</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Most of the SQL Server applications and utilities that use network access
of some kind, for example Isql.exe, Isqlw.exe, Sqlew.exe, and Perfmon.exe,
require access to the Windows NT \\Hkey_local_machine\Software\Description
key. These applications will either access or create a subkey called
Microsoft\RPC\UuidTemporaryData key with two values. The values that are
created are NetworkAddress and NetworkAddressLocal.
<P>
The Windows NT Resource Kit contains a utility that was written to assist
users in configuring C2 security on a particular Windows NT Server. There
can be a significant problem if the C2 Security Manager is used to modify
the Registry Security to make the Windows NT Registry secure. The utility
is supposed to use the C2REGACL.INF file as a guide for modifying registry
keys. When the change is made to the
\\hkey_local_machine\software\description key by the application, the
resulting permissions do not match what was specified in the CEREGACL.INF
file. The most significant change is that the Administrator has Full
Control prior to the change and only Read permission afterward. This change
can prevent the Administrator from restoring permissions on the key and
will prevent network access by applications executed on the console of the
Windows NT Server. Other permissions that are lost are Creator Owner - Full
Control, and Everyone - Special Access. The System account has full
control, however, there is way to access this account from Winlogon and
other applications.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In one attempt to workaround this problem, Regedt32 would allow the
Administrator to make the changes on the key, however, the affect was
limited because the changes were kept until the server was shutdown and
restarted. When the server was rebooted, the permissions on the key
reverted to Administrator - Read Only. The administrator is unable to make
permanent changes to this key.
<P>
The alternative resolutions to this problem are:

<UL><LI>Reinstall Windows NT, which will rebuild the registry.

<LI>Attempt to assign Full Control on the \\hkey_local_machine\software key
   to a specific user who is a member of both the Local and Domain
   Administrator's groups. This will allow this particular user to use the
   application's setup to be executed via the console. Note that this is a
   temporary resolution, because the registry will still have to be
   reinitialized at some point by reinstalling Windows NT.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: security c2 winnt secure<BR>
Keywords            : kbinterop kbnetwork kbusage SSrvInst SSrvLan<BR>
Version             : 3.5x 6.x 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
