

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Cannot Reinstall SQL Server After Deleting Files Manually </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173180">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1997/08/27">
<META NAME="Keywords" CONTENT="SSrvInst kberrmsg kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  SQL Server Setup fails during the installation process when it attempts to start SQL Server. Setup shows the following error message in a dialog box before it quits:     The SQL Server installation could not be successfully completed.    Setup coul...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QABM,QDI2,QAEF,QDIZ,QDH6,QA9N,QAB4,QDKD,QANJ,QBVV,QBWP,QAGB,QACI,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Reinstall SQL Server After Deleting Files Manually</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173180</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SQL Server Setup fails during the installation process when it attempts to
start SQL Server. Setup shows the following error message in a dialog box
before it quits:
<P>
<PRE>   The SQL Server installation could not be successfully completed.
   Setup could not connect to the SQL server.

</PRE>The Windows NT event log shows the following error message:
<P>
<PRE>   Msg 17113 : initconfig: error 2(The system cannot find the file
   specified.) opening 'master.dat' for config information

</PRE><h2>CAUSE</h2>
 
<P>
A previous installation of SQL Server was removed by deleting the files
from the SQL Server directory. Manually deleting registry keys and removing
files is not the best way to remove SQL Server. Doing this causes any
subsequent reinstallation to fail with the following error in the errorlog:
<P>
<PRE>   initconfig: error 2(The system cannot find the file specified.) opening
   'master.dat' for config information

</PRE>The "Remove SQL Server option" may also be unavailable in the Setup
program, so the only way to correctly reinstall SQL Server is to cleanly
remove SQL Server and then reinstall it.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To reinstall SQL Server correctly, perform the following steps:

<OL><P><LI>Run "setup /t RegistryRebuild = ON" (without the quotation marks) from
   the Binn directory under the directory where SQL Server was installed.
<P>
   This rebuilds the registry and fills in any missing parameters. Type the
   same information in the setup dialog boxes as the first time SQL Server
   was installed. Setup will not copy any files or run any scripts, but it
   will re-create the registry and services as if you had done a full
   installtion.

<P><LI>Run Setup again, and this time choose to remove SQL Server. This not
   only removes all the files, but also removes the registry entries.

<P><LI>Reinstall SQL Server normally.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The RegistryRebuild = ON switch can not only be used in this situation, but
also to recover from a situation where the Windows NT registry has been
damaged, inadvertently modified, or restored. For more information, see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q157805.htm">Q157805</A></B>
   TITLE     : BUG: RegistryRebuild Option of Setup Is Not Documented
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: regrebuild rebuildregistry gray grey greyed grayed<BR>
disabled input enter<BR>
Keywords          : SSrvInst kberrmsg kbsetup<BR>
Version           : 6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
