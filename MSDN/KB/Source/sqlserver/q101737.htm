

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Configuring ODS Servers for Alternate Pipes Under NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101737">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1993/07/21">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  In order to configure an Open Data Services application ( including SQL Server ) to listen on alternate named pipes, it is necessary to make certain modifications to the NT Registry for the application. Similarly, if one wishes to direct DB-Library...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QBBI,QAKD,QAUJ,QDJ3,QDIZ,QARL,QAMO,QAMN,QAKR,QAJH,QAI5,QBVX,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Configuring ODS Servers for Alternate Pipes Under NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101737</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In order to configure an Open Data Services application ( including SQL
Server ) to listen on alternate named pipes, it is necessary to make
certain modifications to the NT Registry for the application. Similarly, if
one wishes to direct DB-Library to attempt to connect to a server using a
non-default network library (net-library) or pipe name, it is necessary to
make registry entries directing DB-Library to use the non-default values.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Under NT, the SRVERNAME parameter to srv_init specifies the registration
key under which ODS can find the registry value (ListenOn) with the
appropriate connection string data. This is a change in behavior from the
OS/2 release, wherein the SERVERNAME parameter specified the actual pipe
name used by the ODS application.
<P>
In order to configure your ODS applications to listen on an alternate pipe
or use a non-default net-library, you will need to add the following key to
your registry:
<P>
\HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\SQLServer\&lt;servername&gt;
<P>
with the value:
<P>
ListenOn:REG_MULTI_SZ: &lt;server side netlib&gt;,&lt;pipe&gt;
<P>
For a client or an NT SQL Server issuing RPCs to connect to this server via
the specified net-library and pipe name, you will need the key:
<P>
\HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\SQLServer\Client\ConnectTo
<P>
with a value:
<P>
&lt;servername&gt;: REG_SZ: &lt;client side netlib&gt;,&lt;pipe&gt;
<P>
For example, say you wanted a copy of PROCSRV identified as server "PROC1"
and listening on pipe \\.\PIPE\PROC1, \\. specifying the local server. You
also want the local SQL Server to be able to send RPCs to this server using
the named pipe net-libraries. The following entries would need to exist in
the NT registry:
<P>
\HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\SQLServer\PROC1
<P>
with value:
<P>
ListenOn:REG_MULTI_SZ:SSNMPNTW, \\.\PIPE\PROC1
<P>
and:
<P>
\HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\SQLServer\Client\ConnectTo
<P>
with value:
<P>
PROC1:REG_SZ:DBNMPNTW,\\.\PIPE\PROC1
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Transact-SQL DB-Library gateway GDK Windows NT<BR>
dblib<BR>
Keywords            : kbprg SSrvDB_Lib<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
