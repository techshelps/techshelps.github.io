

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Fast Query to Return Number of Rows in a Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73006 ">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1991/06/15">
<META NAME="Keywords" CONTENT="kbprg SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The following is the query most often used to return the number of rows in a given table:     SELECT COUNT(*)    FROM               For large tables, this query may take a while to run. There is, however, a faster method of determining the number o...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QATJ,QA28,QAUD,QAKC,QAG8,QBC6,QAXB,QAPN,QABM,QBD2,QADX,QARR,QAC1,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Fast Query to Return Number of Rows in a Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73006 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following is the query most often used to return the number of
rows in a given table:
<P>
<PRE>   SELECT COUNT(*)
   FROM &lt;table name&gt;

</PRE>For large tables, this query may take a while to run. There is,
however, a faster method of determining the number of rows in a table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In some applications, you might want to maintain a constant
tally of the number of rows in a table. If you use the query shown
above, the query expends considerable overhead counting each row of
the table.
<P>
The "rows" column in the sysindexes table can also return the
current number of rows in any given table. Use the following
query to retrieve the row count comparatively quickly, since querying
the sysindexes table needs to find only one row:
<P>
<PRE>          SELECT rows
          FROM sysindexes
          WHERE id = object_id ("&lt;table name&gt;")
          AND indid &lt; 2

</PRE><h3>Notes</h3>
 

<OL><P><LI>The "AND indid &lt; 2" clause is necessary because the sysindexes
   table contains one row for each clustered index, one row for each
   nonclustered index, and one row for each table that has no
   clustered index. The "indid" column may contain one of the
   following values:
<P>
<P><PRE>      0  if the object is a table
      1  if the object is a clustered index
      &gt;1 if the object is a nonclustered index
</PRE><P>
   The "rows" column is updated dynamically only if "indid" is 0 or 1.
   If "indid" is greater than 1, the "rows" column is updated only
   when the index is created and when UPDATE STATISTICS is run.
   Therefore, adding the "AND indid &lt; 2" clause ensures that the value
   returned by the query is the current number of rows when the
   query is run.

<P><LI>The "rows" column is NOT updated dynamically while rows are
   being added to the table using BCP (regardless of whether slow or
   fast BCP is used), but is updated immediately after BCP finishes.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbprg SSrvProg<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
