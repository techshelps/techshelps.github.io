

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Troubleshooting SQLMail with Microsoft Exchange Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153159">
<META NAME="KBModify" CONTENT="1997/07/11">
<META NAME="KBCreate" CONTENT="1996/07/01">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  You can use certain basic troubleshooting techniques to diagnose and resolve most SQLMail problems. Typically, errors in starting a SQLMail session or sending mail from SQLMail with a Microsoft Exchange Server fall into two categories: permissions ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QDJ2,QABM,QAUJ,QAYC,QABI,QBTX,QBWP,QAI5,QBWF,QAGU,QAJQ,QBG2,QA2Q,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Troubleshooting SQLMail with Microsoft Exchange Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153159</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use certain basic troubleshooting techniques to diagnose and
resolve most SQLMail problems. Typically, errors in starting a SQLMail
session or sending mail from SQLMail with a Microsoft Exchange Server fall
into two categories: permissions problems and Exchange client setup
problems. SQLMail functionality is documented in the "Books Online" for
version 6.x. These should be thoroughly reviewed before using SQLMail.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You should examine the following checklist of items, preferably in the
order given:

<OL><P><LI>Log on to Windows NT with a user account that is an administrator of
   the local computer and is a domain account.

<P><LI>Confirm that the Exchange client, EXCHNG32.EXE, can connect to the
   Exchange server and mail can be sent.

<P><LI>Confirm that the Exchange profile used does not have a Personal
   Message Store (.pst) by running the Mail and Fax tool in Control
   Panel. Click the Show Profiles button and in the Mail dialog box select
   the default profile in the profile list according to the drop-down list
   labeled "When starting Microsoft Exchange, use this profile." Click the
   Properties button.

<P><LI>Select the services tab in the new dialog box and confirm that the only
   services are Microsoft Exchange Server and Personal Address Book. Click
   the Delivery tab and confirm that what is selected on the Deliver To
   drop-down list is the Mailbox on the Exchange Server, which should be
   something like "Mailbox - &lt;Friendly User Name&gt;" where Friendly User Name
   is the name of the user who logged on to Windows NT in step one.

<P><LI>To run SQLMail with an Exchange Server, it is necessary that the
   MSSQLServer service is run under the same user account that logged on
   during step one above. You can determine this by opening the Services
   tool in Control Panel, selecting the MSSQLServer service and clicking
   the Startup button.

<P><LI>Confirm that the SQLMail user name and password are correct by
   running SQL Server Setup. Select Set Server Options and click the Mail
   Login button. The user name must match the Profile name from step three
   above.
<P>
</OL>NOTE: The password and Copy SQLMail Configuration in the Current User
Account check box do not matter since both no longer apply.
<P>
NOTE: SQL Server Setup version 6.5 will only ask for the Exchange Profile
name.

<OL><P><LI>Test SQL Server access permissions to the Exchange Server. You can
   do this by using the XP_CMDSHELL extended stored procedure, which runs
   with the same permissions as SQLMail. Use the following command to test
   connectivity to the server, assuming the Exchange Server is located on a
   computer named "NTServer".
<P>
<P><PRE>      xp_cmdshell "NET USE \\NTServer\IPC$"
</PRE><P>
</OL>If the above command fails, step three has not been completed correctly.

<OL><P><LI>At this point SQLMail should be able to Autostart or be started
   manually with the xp_startmail extended stored procedure. Additionally,
   you can choose the profile to use with xp_startmail by replacing
   &lt;Profile name&gt; with the profile name from step three, as in the
   following example:
<P>
<P><PRE>      xp_startmail "&lt;Profile name&gt;",""
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Exchng32 Mapi Mail<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
