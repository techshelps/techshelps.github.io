

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Manual Replication Setup w/ A Remote Distributor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137665">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1995/10/02">
<META NAME="Keywords" CONTENT="kbsetup kbusage SSrvInst SSrvRep">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The Microsoft SQL Server version 6.0  Administrator's Companion  documents how to set up Replication manually, but does not specifically address how to set up Replication manually when a remote distribution server is used. This article discusses th...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH6,QAA1,QDI2,QABM,QAS1,QAZV,QAUJ,QAPF,QATJ,QANN,QBVX,QAFO,QDNQ,QBVV,QAD2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Manual Replication Setup w/ A Remote Distributor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137665</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft SQL Server version 6.0 "Administrator's Companion" documents
how to set up Replication manually, but does not specifically address how
to set up Replication manually when a remote distribution server is used.
This article discusses the necessary changes to do this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The information here is based on the information in the SQL Server
"Administrator's Companion," Chapter 15, "Advanced Replication," under the
section titled "Setting up Replication Manually." Steps one through six are
presented here with modifications that are necessary to set up Replication
manually when a remote distribution server is used.

<OL><P><LI>On the distribution server, create a device for the
   distribution database if it does not already exist. For
   example:
<P>
   DISK INIT
   NAME = 'distdata',
   PHYSNAME = 'c:\sql60\data\distrib.dat',
   VDEVNO = 5,
   SIZE = 15360
   go
   DISK INIT
   NAME = 'distlog',
   PHYSNAME = 'c:\sql60\data\dislog.dat',
   SIZE = 7680
   VDEVNO = 6
   go

<P><LI>On the distribution server, create the distribution
   database if it does not already exist. For example:
<P>
   CREATE DATABASE distribution on distdata = 30
   LOG ON distlog = 15
   go

<P><LI>On the distribution server, make the distribution
   database the current database, and then run the
   INSTDIST.SQL script. This is only necessary if the
   distribution database has not already been installed.
<P>
   This script is located in the \SQL60\INSTALL directory.
   It adds tables, indexes, and stored procedures to the
   distribution database.

<P><LI>On the publication server, use regedt32 or xp_regwrite
   to set key values for the name and the working directory
   for the remote distribution database.
<P>
   For example, if on a server named WOLFHOUND you have
   created a distribution database named distribution and
   will use a working directory of D:\SQL60\REPLDATA, you
   could set the key values as follows:
<P>
   xp_regwrite 'HKEY_LOCAL_MACHINE',
<PRE>   'SOFTWARE\Microsoft\MSSQLServer\Replication',
   'DistributionDB',
   'REG_SZ',
   'distribution'
   go

   exec("xp_regwrite 'HKEY_LOCAL_MACHINE',
   'SOFTWARE\Microsoft\MSSQLServer\Replication',
   'WorkingDirectory',
   'REG_SZ',
   '\\WOLFHOUND\D$\SQL60\REPLDATA'")
   go

</PRE><P><LI>On the publication server, add the distribution server
   using sp_addserver. Then, use sp_serveroption to define
   this server as the distribution server. For example, if
   the server is named WOLFHOUND:
<P>
   sp_addserver 'WOLFHOUND'
   go
   sp_serveroption 'WOLFHOUND', 'dist', 'true'
   go
<P>
   On the distribution server, add the publishing server
   using sp_addserver. If the distribution server is being
   installed for the first time, use sp_serveroption to
   define this server as the distribution server. For
   example, if the distribution server is named WOLFHOUND,
   and the publishing server is named BEAGLE:
<P>
   sp_addserver 'BEAGLE'
   go
   sp_serveroption 'WOLFHOUND', 'dist', 'true'
   go

<P><LI>Use sp_addserver to define the remaining settings. For
   example, on the distribution server:
<P>
   sp_addpublisher 'BEAGLE', 'dist'
   go
<P>
   And on the publishing server, for example:
<P>
   sp_addpublisher 'BEAGLE'
<P>
</OL>At this point, you can continue with step seven as documented in the
SQL Server "Administrator's Companion."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 replication installation<BR>
Keywords            : kbsetup kbusage SSrvInst SSrvRep<BR>
Version             : 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
