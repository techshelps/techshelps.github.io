

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Troubleshooting SQL Security Manager Messages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164167">
<META NAME="KBModify" CONTENT="1997/04/10">
<META NAME="KBCreate" CONTENT="1997/02/24">
<META NAME="Keywords" CONTENT="kbenv kbother kbusage SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article explains some messages that you may receive when working with SQL Security Manager, the causes of the problems, and their resolutions. It applies to situations where the MSSQLServer service starts up with an account that has been grant...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAD,QABM,QAH5,QAGU,QAK7,QAI5,QAEV,QABO,QAVY,QBWP,QAA1,QBWU,QBG2,QBXJ,QAGR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Troubleshooting SQL Security Manager Messages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164167</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains some messages that you may receive when working with
SQL Security Manager, the causes of the problems, and their resolutions. It
applies to situations where the MSSQLServer service starts up with an
account that has been granted the Windows NT Server 'Log on as a service'
right, and is a member of the local Administrators group.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
I.
An attempt to log in to SQL Security Manager is rejected, and the following
message returned:
<P>
<PRE>   This SQL Server does not support Windows NT SQL Server security stored
   procedures.

</PRE>If the server is set up to use Integrated Security, the following message
is encountered:
<P>
<PRE>   Msg. No.: 18450 Severity: 14 State: 1
   Login failed- User: loginid Reason: Not defined as a valid user of a
   trusted SQL Server connection

</PRE>Where loginid is the MSSQLServer service startup account.
<P>
This problem occurs if system administrator (SA) privileges have previously
been revoked from the Administrators group.
<P>
II.
Within Security Manager, the groups that have been granted user or SA
privileges cannot be expanded by double-clicking on them. Attempting to
grant user or SA privileges produces the following message:
<P>
<PRE>   xp_logingrant failure - Unable to query SQL Server security information

</PRE>This problem occurs as a result of revoking SA privileges on the local
Administrators group within the current Security Manager session.
<P>
III.
<P>
A log on to SQL Security Manager is successful. However, when viewing user
or sa privileges, no groups are shown, and the following message appears:
<P>
<PRE>   No accounts have been granted user authority.

</PRE>When you attempt to grant user or SA privileges to any group, the following
message appears:
<P>
<PRE>   xp_logingrant failure - Unable to query SQL Server security information

</PRE>If the server is set up for Integrated Security, a connection is refused,
and you receive the following message:
<P>
<PRE>   You must use the System Administrator's (sa) account when using the SQL
   Security Manager.

</PRE>These messages indicate that the registry permission (on the key mentioned
in the RESOLUTION section of this article) for the local Administrators
group has been set to Read.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To effectively use SQL Security Manager, SA privileges must be returned to
the local Administrators group. Usually, this cannot be achieved with
Security Manager. Use the Registry Editor to restore these permissions.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Open Regedt32.exe

<P><LI>Navigate to the following key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\MSSQLServer
</PRE>
<P><LI>On the Security menu, click Permissions.

<P><LI>Grant the local Administrators group Full Control of this key.
<P>
</OL>If the registry key is set properly as outlined above, the following is
another message that may be received when attempting to log in to Security
Manager:
<P>
<PRE>   Msg. No.: 18452 Severity: 14 State: 1
   Login Failed- User: sa Reason: Not associated with a Trusted SQL Server
   Connection

</PRE></OL>This error may occur when the server has been set to use Integrated
Security and the default network library does not support trusted
connections, such as NWLink IPX/SPX, TCP/IP Sockets or Apple Talk. In this
case, you will either have to configure the server for Standard or Mixed
Security, or change the default network library to Named Pipes or Multi-
Protocol, using the SQL Client Configuration Utility.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: grey gray greyed grayed<BR>
Keywords            : kbenv kbother kbusage SSrvGen<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
