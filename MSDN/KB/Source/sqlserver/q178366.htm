

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: SELECT Into Variable with NO_BROWSETABLE Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178366">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1997/12/19">
<META NAME="Keywords" CONTENT="kbbug6.50.sp3 SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: NT: 17676 (6.5)   If NO_BROWSETABLE is set ON, selecting data into a variable from a table with a timestamp column fails with the following message:     DB-Library: Possible network error: Bad token from SQL Server:    Datastream processing ou...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QABM,QAKP,QAYL,QAS1,QA2Q,QAG2,QDNQ,QBXS,QAY2,QDKW,QAE1,QBG2,QA9N,QAY4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SELECT Into Variable with NO_BROWSETABLE Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178366</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5 Service Pack 3 and Service Pack 4
</UL> 
BUG #: NT: 17676 (6.5)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If NO_BROWSETABLE is set ON, selecting data into a variable from a table
with a timestamp column fails with the following message:
<P>
<PRE>   DB-Library: Possible network error: Bad token from SQL Server:
   Datastream processing out of sync.
   Net-Library error 0:

   DB-Library Process Dead - Connection Broken

</PRE>A sample script that demonstrates the problem is provided in the MORE
INFORMATION section of this article.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, remove the timestamp column from the table.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server version 6.5
Service Pack 3 and Service Pack 4. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem does not occur on builds of SQL Server earlier than 6.50.258
(Service Pack 3). This problem has been tested and reproduced on SQL Server
build 6.50.281 (Service Pack 4).
<P>
SET NO_BROWSETABLE ON is an undocumented option performed for Remote Data
Service (RDS) ActiveX Data Connector (ADC) connections to SQL Server.
Enabling this option makes every SELECT statement act as though FOR BROWSE
had been appended to the statement, but bypasses the temporary table that
FOR BROWSE normally pipes the results through. The net effect is to add
keys and timestamps to the query as hidden output columns so the client can
update specific rows (updateable cursors) without separate trips to the
server to pick up the meta-data and munging the query to get the
appropriate columns.
<P>
The following script demonstrates the problem:
<P>
<PRE>   set nocount on
   go
   use pubs
   go
   DROP TABLE test_unknown_token1
   go
   CREATE TABLE test_unknown_token1 (
      col1 char(1),
      timestamp timestamp
   )
   go

   insert test_unknown_token1 (col1) values ('1')
   go

   set no_browsetable on
   go
   declare @ochrStatus char(1)

   SELECT @ochrStatus = col1
   FROM dbo.test_unknown_token1
   WHERE col1='1'
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sp sp3 sp4 temp<BR>
Keywords          : kbbug6.50.sp3 SSrvProg<BR>
Version           : WINNT:6.5 SP3 SP4<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
