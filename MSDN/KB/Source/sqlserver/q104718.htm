

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Net-Library Reports OS and Network Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104718">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1993/09/27">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib SSrvNet_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  DB-Library version 4.20.50 and Network Library (Net-Library) version 4.20.30 and later have an enhanced run-time error reporting. If a network or operating system error is encountered during run-time, the Net-Library will pass the network or operat...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAB4,QDIR,QAVZ,QAH4,QAY5,QAKP,QAUD,QAJQ,QBV8,QAB9,QABM,QBWP,QABB,QA7M V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Net-Library Reports OS and Network Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104718</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server Programmer's Toolkit, version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
DB-Library version 4.20.50 and Network Library (Net-Library) version
4.20.30 and later have an enhanced run-time error reporting. If a network
or operating system error is encountered during run-time, the Net-Library
will pass the network or operating system error code back to the
application's DB-Library error handler.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The network or operating system errors reported by the Net-Library will
usually have the following format:
<P>
<PRE>  Net-Library Error &lt;net/os error code&gt;:
    &lt;Net-Library function&gt; (&lt;net/os function&gt;).

</PRE>where
<P>
&lt;net/os error code&gt;
<P>
is the error code returned by the &lt;net/os function&gt; during run-time.
The meaning of this error code depends on the &lt;net/os function&gt; that
returned this error code, and the Net-Library in use at the
time the error occurred. Please examine your network or operating
system documentation for complete information about this error code.
<P>
&lt;Net-Library function&gt;
<P>
is the Net-Library function that was in use when the run-time error
occurred.
<P>
&lt;net/os function&gt;
<P>
is the network or operating system function that returned the error code.
Please examine your network or operating system documentation for complete
information.
<P>
To properly distinguish DB-Library, Net-Library, and operating system
errors, a DB-Library application should have an error handler similar to
the following:
<P>
<PRE>   int err_handler(dbproc, severity, dberr, oserr, dberrstr, oserrstr)

   DBPROCESS   *dbproc;
   int         severity;
   int         dberr;
   int         oserr;
   char        *dberrstr;
   char        *oserrstr;

  {
         printf("DB-Library error %d: %s\n", dberr, dberrstr);

         if (severity == EXCOMM &amp;&amp; (oserr != DBNOERR || oserrstr))
             printf(Net-Library error %d: %s\n"' oserr, oserrstr);

         if (oserr != DBNOERR)
             printf("Operating system error %d: %s\n", oserr, oserrstr);

         if ((dbproc == NULL) || (DBDEAD(dbproc))
             return(INT_CANCEL);
         else
             return(INT_CANCEL);
     }

</PRE>For a 16-bit MS-DOS or Windows DB-Library client, the operating system
errors are standard MS-DOS extended error and are documented in the
"Microsoft MS-DOS Programmer's Reference" (ISBN 1-55615-329-5) in
Appendix C on pages 447-449, "The Programmer's PC Sourcebook" by Thom
Hogan (second edition, ISBN 1-55615-321-X) on pages 3-123 and 3-124, also
"Advanced MS-DOS Programming" by Ray Duncan (second edition, ISBN 1-
55615-157-8) on pages 453-455 and in "The MS-DOS Encyclopedia" (ISBN
1-55615-174-8) in Appendix C on pages 1461-1462. They are the same
codes returned by Microsoft C run-time function _dosexterr(), and also
MS-DOS Int 21 Function 59H.
<P>
For a 16-bit OS/2 DB-Library client, the operating system errors are
standard OS/2 errors (many are in common with the MS-DOS errors) and are
documented in the "Microsoft OS/2 Programmer's Reference" Volume 3 (ISBN
1-55615-222-1) in Appendix A on pages 409-413, and also in "Essential
OS/2 Functions" by Ray Duncan (ISBN 1-55615-177-2) on pages 193-203.
<P>
For a 32-bit Windows NT DB-Library client, the operating system errors
are standard Windows NT errors (many are in common with the MS-DOS
errors) and are documented in the "Microsoft Win32 Programmer's
Reference" Volume 2 (ISBN 1-55615-516-6) in Appendix A on pages 819-869.
They are the same codes returned by Win32 function GetLastError().
<P>
For example, if the following error occurred while using the named pipe
Net-Library on a Microsoft LAN Manager-based network:
<P>
<PRE>   DB-Library Error 10010:
     Possible network error: Read from SQL Server failed.
   Net-Library Error 53:
     ConnectionRead (read()).

</PRE>This means that LAN Manager error 53 occurred when the named pipe
Net-Library function ConnectionRead called the network read() function.
The meaning of LAN Manager error 53 can be determined by examining the
LAN Manager documentation, or typing NET HELPMSG 53 at an OS/2 command
prompt which returns:
<P>
<PRE>   SYS0053: The network path was not found.

</PRE>This error means that the server that you specified does not exist or has
not been started. You should verify that you specified the path name
correctly. Contact your network administrator if you continue to have
problems.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dblib<BR>
Keywords            : kbprg SSrvDB_Lib SSrvNet_Lib<BR>
Version             : 4.2.5 | 4.2.5<BR>
Platform            : MS-DOS OS/2<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
