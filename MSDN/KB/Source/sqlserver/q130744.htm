

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Connection Problems from NT Clients via IPX/SPX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130744">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1995/05/25">
<META NAME="Keywords" CONTENT="kbenv SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  In a large LAN with many Novell NetWare file servers and routers, or a small LAN but attached to a Wide Area Network (WAN), a Windows NT client may have difficulties connecting to SQL Servers using IPX/SPX. SQL Server may be located on the local LA...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QAVZ,QARL,QAI5,QBWE,QA39,QAKC,QBG2,QBC6,QABT,QBVX,QAG8,QBWD,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Connection Problems from NT Clients via IPX/SPX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130744</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 4.21a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a large LAN with many Novell NetWare file servers and routers, or a
small LAN but attached to a Wide Area Network (WAN), a Windows NT client
may have difficulties connecting to SQL Servers using IPX/SPX. SQL Server
may be located on the local LAN, and other SQL Server clients, such as MS-
DOS or Windows, may connect to the same SQL Server just fine using IPX/SPX.
<P>
When trying to enumerate available SQL Servers on the network by selecting
the List Servers button in SQL Server tools such as ISQL/W, you may not see
the SQL Server you are trying to connect to, although you might see other
SQL Servers running in remote LANs.
<P>
<P><h2>CAUSE</h2>
 
<P>
Before a client can connect to a SQL Server, it first needs to resolve the
server name to its network address. This is done through browsing the
bindery on NetWare file servers. To browse through a bindery, the client
needs to attach to the NetWare file server first. On a regular client such
as DOS or Windows, the file server attachment is made right after the
NetWare shell is loaded, and usually you can specify a preferred file
server to attach to. On a Windows NT client, however, direct attachment to
a specified NetWare file server is not possible unless the Microsoft
Service for NetWare software is installed.
<P>
SQL Server client for Windows NT works around this limitation by
dynamically attaching to a NetWare file server. It does so by broadcasting
General Query SAPs to the local network segment, and attaches to the first
NetWare file server that responds to the SAP query. This should not cause
any problems as the file server attached this way will always be a local
file server. However, when a router responds to the SAP query, it will
return a list of file servers that it is aware of. If a router's response
arrives first, then the file server on the top of the list will be used for
the attachment, and the NT client may end up attaching to a file server
that is on a remote LAN many routers away or even across a WAN.
<P>
When the NT client browses the bindery of the remote file server for SQL
Server objects, it will see the SQL Servers running on the remote network,
and may not see the local SQL Servers if the routers in-between are
configured to filter out SQL Server SAP traffic, which is typically done to
avoid unnecessary SAP broadcasting to remote LAN's.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You will not experience this connection problem under normal situations.
However, if you do, you can workaround it by using the direct connections.
<P>
To configure for direct connections, you need to find out the following
information about the SQL Server machine: NIC MAC address, IPX network
segment number and IPX socket number for SQL Server. You can use the
Windows NT command IPXROUTE CONFIG to retrieve MAC address and network
segment number, and the IPX socket number should be 33854, by default.
<P>
You can use SQL Client Configuration Utility to configure this client for
direct connections. Using Advanced feature, you add an entry with the
following as the connection string:
<P>
<PRE>   &lt;MAC address&gt;,33854,&lt;network number&gt;

</PRE>where &lt;MAC address&gt; should be in hexadecimal and &lt;network number&gt; is in
decimal.
<P>
NOTE: The network number returned from IPXROUTE is in hexadecimal, and you
should convert it to decimal. For further information, see SQL Server
"Configuration Guide."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Windows NT Connection bindery<BR>
Keywords            : kbenv SSrvWinNT<BR>
Version             : 4.21a<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
