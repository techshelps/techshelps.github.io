

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Shared Access to Modified Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q45542 ">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1989/06/07">
<META NAME="Keywords" CONTENT="kbusage SSrvServer">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When a user modifies a table, other users cannot be permitted to read the tentative modifications if J.N. Gray's (see below) consistency level 2 is to be maintained (restrict access to  dirty  data). Because the finest granularity of locking suppor...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QBD2,QABM,QAC1,QAGU,QAA3,QAA5,QBFN,QAOC,QALQ,QAHT,QABT,QAYY,QAA8,QA1S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Shared Access to Modified Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q45542 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a user modifies a table, other users cannot be permitted to read
the tentative modifications if J.N. Gray's (see below) consistency
level 2 is to be maintained (restrict access to "dirty" data). Because
the finest granularity of locking supported by SQL Server is the page,
no page containing uncommitted updates can be read by another user. If
many pages are locked, SQL Server may decide that it is more efficient
to lock the entire table.
<P>
SAVE TRANSACTION does not commit. It is an intermediate rollback
point. As always, dirty data cannot be accessed by others until it is
committed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
According to J.N. Gray in "Granularity of Locks and Degrees of
Consistency in a Shared Data Base" (1979) there are four levels of
consistency:

<OL><P><LI>In Level 0, updates are permitted to uncommitted (dirty) data. This
   can result in inconsistency because if the tentative update is
   updated again by another user, and the first user aborts or rolls
   back, the second user's update will be lost.

<P><LI>In Level 1, updates to uncommitted updates are prohibited, but
   reads to uncommitted updates are permitted. This can result in
   decisions being made on data that is still tentative (may be rolled
   back).

<P><LI>In Level 2, reading uncommitted updates is prohibited. This is the
   lowest level of consistency supported by SQL Server. Occasionally,
   there are reasons to want to read uncommitted updates, but SQL
   Server provides no option to do so at this time. SQL Server
   implements this level of consistency by holding "exclusive" locks
   on all updated pages for the duration of the logical unit of work
   (LUW). If BEGIN TRAN is not used, the locks are held for the
   duration of the SQL statement that caused them. If BEGIN TRAN is
   used, the locks are held until COMMIT TRAN is executed.

<P><LI>In Level 3, other users are prohibited from updating data that has
   been read by a particular user until that user commits. This allows
   a user to "see" an unchanging image of the data for the duration of
   the transaction. Other users may read the data, but no other users
   may update it. SQL Server implements this level of consistency by
   holding "share" locks on all pages in tables read with the HOLDLOCK
   option until the transaction commits. Exclusive locks are placed on
   updated pages, just as in level 2. Locks are released at the end of
   the LUW, just as in level 2.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Optimization and tuning<BR>
Keywords            : kbusage SSrvServer<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
