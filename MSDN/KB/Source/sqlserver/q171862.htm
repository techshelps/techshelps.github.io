

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SQL Service Manager Shows Indeterminate for Non-Admin User </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171862">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="SSrvAdmin kbenv">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  If a user is logged on to a Windows NT Server 4.0 computer running Microsoft SQL Server and the user is not logged on as an administrator, SQL Service Manager will show 'Service State Indeterminate' and not list any services. SQL Enterprise Manager...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QAGU,QAH5,QACK,QBWU,QBVV,QAGR,QBW7,QAI5,QA7O,QAOE,QAMN,QAB5,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SQL Service Manager Shows Indeterminate for Non-Admin User</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171862</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a user is logged on to a Windows NT Server 4.0 computer running
Microsoft SQL Server and the user is not logged on as an administrator, SQL
Service Manager will show 'Service State Indeterminate' and not list any
services. SQL Enterprise Manager and Control Panel Services will still show
the current status of the MSSQLServer, SQLExecutive, and MSDTC services for
a user who is not logged on as an administrator.
<P>
<P><h2>CAUSE</h2>
 
<P>
SQL Service Manager tries to read the registry for a list of services that
it controls, using the machine name. It also uses the permissions of the
user who is logged on to Windows NT. If the user who logged on to Windows
NT is not an administrator, SQL Service Manager is not able to read the
HKEY_LOCAL_MACHINE key on the &lt;machine name&gt;\SOFTWARE\Microsoft\MSSQLServer
folder in the registry.
<P>
There is a new functionality in Windows NT 4.0 that provides a system
administrator with the ability to secure remote registry access. The
security on the following registry key dictates which users or groups can
access the registry remotely:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers
   \Winreg

</PRE>In a default installation of Windows NT Workstation, this key does not
exist. In a default installation of Windows NT Server, this key exists and
grants administrators full control for remote registry operations. For more
information, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q155363.htm">Q155363</A></B>
   TITLE     : How To Regulate Network Access to the Windows NT Registry

</PRE><h2>WORKAROUND</h2>
 
<P>
The following optional subkey defines specific paths into the registry that
are allowed access, regardless of the security on the winreg registry key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers
   \Winreg\AllowedPaths\Machine (entry of type REG_MULTI_SZ)

</PRE>The AllowedPaths registry key contains multiple strings, which represent
registry entries that can be read by Everyone. This allows specific system
functions (such as checking printer status) to work correctly regardless of
how access is restricted by the winreg registry key.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall SQL Server. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
By adding an additional string "SOFTWARE\Microsoft\MSSQLServer\SQL Service
Manager" to the Machine value, SQL Service Manager can then display the
current state of the SQL Server services for non administrator users. Any
changes to the above registry entries require a restart for the changes to
take effect.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: start stop rpc redirector<BR>
Keywords          : SSrvAdmin kbenv<BR>
Version           : 6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
