

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Error 5105 if Disk Init Reuses vdevno </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112589">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/03/15">
<META NAME="Keywords" CONTENT="kbbug4.20 kbbug4.21 kbbug4.21a kbother SSrvServer SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# OS/2: 1569 (4.2)        NT:  436 (4.2)   A device activation error may occur if a device is dropped, then a subsequent disk init incorrectly reuses the same vdevno. However, the 5105 error issued is misleading as to the true cause of the error. ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAAP,QAB5,QAB4,QAKP,QAFI,QBNY,QAC9,QAJQ,QDNQ,QAUJ,QBVV,QBFY,QAS1,QAHD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error 5105 if Disk Init Reuses vdevno</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112589</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 4.2 for OS/2
<LI>Microsoft SQL Server, versions 4.2, 4.21, and 4.21a
</UL> 
BUG# OS/2: 1569 (4.2)
<PRE>       NT:  436 (4.2)

</PRE><h2>SYMPTOMS</h2>
 
<P>
A device activation error may occur if a device is dropped, then a
subsequent disk init incorrectly reuses the same vdevno. However, the 5105
error issued is misleading as to the true cause of the error.
<P>
The system administrator assigns each SQL Server device a virtual device
number (vdevno) unique for that SQL Server. As noted in the remarks
section of the DISK INIT command, vdevno's and physical file names are
not reusable. If the SA drops a device and then attempts to initialize
another device with the same vdevno, the disk init command will fail
with a 5105 error:
<P>
<PRE>   Device activation error.
   The physical file name '%.*s' may be incorrect.

</PRE>The SQL Server errorlog will also have the following entry:
<P>
<PRE>  kernel  udactivate: vdn X already active

</PRE>The physical file created by the failed disk init will exist on the disk,
but the device will not exist in SQL Server.
<P>
For example, the second disk init in the following script will fail:
<P>
<PRE>   disk init name='test5105', physname='c:\test5105.dat',
             vdevno=5, size=512
   go
   sp_dropdevice test5105
   go
   disk init name='next5105', physname='c:\next5105.dat',
             vdevno=5, size=512
   go

</PRE>After this script runs, both the files TEST5105.DAT and NEXT5105.DAT will
exist in the c:\ directory.
<P>
With this error, it would be better for SQL Server to issue a 5104 message:
<P>
<PRE>   Device number %ld already used.

</PRE><h2>WORKAROUND</h2>
 
<P>
Rerun the disk init command with a new vdevno and a new physical file
name. If the SQL Server is shutdown and then restarted, the physical
file that was created by the disk init, which failed with the error 5105,
can be deleted manually, and the name respecified.
<P>
NOTE: After SQL Server has been stopped and restarted the vdevno can also
be reused.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server version 4.2 for
OS/2 and Microsoft SQL Server version 4.2. This problem does not occur in
version 6.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbbug4.20 kbbug4.21 kbbug4.21a kbother SSrvServer SSrvWinNT<BR>
Version             : 4.2 | 4.2 4.21 4.21a<BR>
Platform            : OS/2 WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
