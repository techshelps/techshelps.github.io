

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: "Unable to Connect" Msg May Occur in Application Event Log </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167352">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1997/04/23">
<META NAME="Keywords" CONTENT="kbbug6.00 kbbug6.50 kbenv SSrvNet_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 15849 (Windows: 6.5)   Under certain situations, one of the following errors may be logged by SQL Server in the Application Event Log:   - Severity: 9 Error:10004, OS: 11001 Unable to connect: SQL Server is    unavailable or does not exist.   ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB4,QABA,QAI5,QAO4,QBWD,QAAP,QBXS,QBVV,QABI,QAKP,QA40,QARL,QAPN,QABH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: "Unable to Connect" Msg May Occur in Application Event Log</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167352</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
BUG #: 15849 (Windows: 6.5)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Under certain situations, one of the following errors may be logged by SQL
Server in the Application Event Log:

<UL><LI>Severity: 9 Error:10004, OS: 11001 Unable to connect: SQL Server is
   unavailable or does not exist.
   General network error.  Check your documentation.ConnectionOpen
   (gethostbyname()()).
<P>
   -or-

<LI>Severity: 9 Error:10004, OS: 252 Unable to connect: SQL Server is
   unavailable or does not exist.
   General network error.  Check your documentation.ConnectionOpen
   (ReadPropertyValue()).
<P>
</UL>Similar messages may also appear, depending on which Net-Library you have
set as the default.
<P>
<P><h2>CAUSE</h2>
 
<P>
By default, the xp_sqlregister extended stored procedure is run
automatically at SQL Server startup. If the default client Net-Library on
the server is set to non-named pipes IPCs such as TCP/IP or IPX/SPX, you
would see this error message in the Windows NT Server Event Viewer. This
error message occurs when this particular extended stored procedure tries
to log on to SQL Server using dot "." as the local server name. This fails
because dot "." is not valid as the local server name under non-named pipes
IPCs.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Do not set the default Net-Library to non-named pipes IPCs on the server.
Because the setting of a default client Net-Library on the server does not
affect how other clients connect to SQL Server, you should never have to
set the default Net-Library on the server to anything other than named
pipes. If you need to connect to other SQL Servers from this server using
non-named pipes IPCs, you can always do so through advanced entries in the
client configuration. For more details, see the SQL Server the Books
Online.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
versions 6.0 and 6.5. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: netlib errorlog eventlog<BR>
Keywords            : kbbug6.00 kbbug6.50 kbenv SSrvNet_Lib<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
