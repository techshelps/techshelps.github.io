

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Cannot Connect to SQL Server Using ISQL/SAF/SQLTEST(R/P) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q38695 ">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1988/12/01">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib SSrvISQL">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  After successfully installing SQL Server, the following error message appears when trying to connect to it from a workstation using ISQL, SAF, or SQLTEST(R/P):     Operating-system error:        Open failed on network pipe : \PIPE\SQL\QUERY    DB-L...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QABM,QBWD,QAI5,QAIJ,QAB4,QAUJ,QBVV,QBBI,QAGU,QBV8,QBWS,QDIV,QBWE,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Connect to SQL Server Using ISQL/SAF/SQLTEST(R/P)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q38695 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After successfully installing SQL Server, the following error
message appears when trying to connect to it from a workstation
using ISQL, SAF, or SQLTEST(R/P):
<P>
<PRE>   Operating-system error:
       Open failed on network pipe : \PIPE\SQL\QUERY
   DB-Library:
       Unable to connect: SQL Server is unavailable or does not exist.

</PRE><h2>WORKAROUND</h2>
 
<P>
Before starting SQL Server with NET START SQLSERVER, the LAN
Manager server service must be started and IPC$ must be shared on
the server computer using the following commands:
<P>
<PRE>   net start server
   net share ipc$

</PRE>The LAN Manager workstation service must also be started on the
workstation computer by using the following command:
<P>
<PRE>   net start wksta

</PRE>The server computer name must be specified to ISQL using the -N and
-S parameters:
<P>
<PRE>   ISQL -Usa -P -N -Sservername

</PRE>Note that "servername" follows the -S without an intervening space
and that leading backslashes are not used. Backslashes are not used
when specifying a server name in SAF, SQLTEST(R/P), BCP, or CONSOLE.
It is usually a good idea to place the -S parameter last to avoid
having the next parameter taken as part of the server name.
<P>
If user-level security is active on the server computer (the
default), an account must be created on the server computer for
each workstation (using NET ADMIN). Furthermore, to connect with
SQL Server, each of these accounts must be permitted to use the
share name \PIPE (also done with NET ADMIN). LAN Manager is
supplied with a default account group name, *USERS. This group is
already permitted to use \PIPE; therefore, merely adding an account
that is a member of the *USERS group should be sufficient.
<P>
In addition, when user-level security is active, the workstation
must issue a NET LOGON command before attempting to connect with
SQL Server. Many NET commands perform an implicit NET LOGON;
therefore, this may not be necessary unless SQL Server access is
attempted before other NET commands are issued. When in doubt, use
the CONFIG option of the NET command to determine whether or not
you are actually logged on (the Logon option is deactivated if you
are already logged on).
<P>
Note that the pipe name that failed to open is displayed in the
error message. If a server name is correctly specified, it will
appear in the message as follows:
<P>
<PRE>   Open failed on network pipe : \\MYSERVER\PIPE\SQL\QUERY

</PRE>If the server name (in this case "\\MYSERVER") does not appear in
the error message, either the server name was not specified
correctly or it was intentionally omitted to indicate that a
local named pipe is to be used (ISQL, BCP, CONSOLE, or SQLTESTP
only). Local named pipes can be used only when the server and
client reside on the same machine. If only local named pipes are
used, you do not need to start the LAN Manager server or
workstation services SHARE IPC$ and NET LOGON.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dblib connect net logon pipe user-level security<BR>
Keywords            : kbprg SSrvDB_Lib SSrvISQL<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
