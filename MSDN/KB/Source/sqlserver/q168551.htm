

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Joins Via Dynamic Cursor Execute Slower Than Other Cursors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168551">
<META NAME="KBModify" CONTENT="1997/08/14">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="kbbug6.50 SSrvTran_SQL kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: NT: 16936 (6.50)   Joins via a dynamic cursor may execute considerably slower than the same query would when run using a different type of cursor, or if run outside of a cursor.  Because row eligibility within the cursor is reevaluated during ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QABM,QDMG,QAJQ,QAVQ,QAY5,QABA,QAP2,QAOX,QAY2,QAX6,QAMR,QALZ,QAKP,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Joins Via Dynamic Cursor Execute Slower Than Other Cursors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168551</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft SQL Server, version 6.5
 
BUG #: NT: 16936 (6.50)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Joins via a dynamic cursor may execute considerably slower than the same
query would when run using a different type of cursor, or if run outside of
a cursor.
<P>
Because row eligibility within the cursor is reevaluated during each fetch,
dynamic cursors are more resource intensive than other types of cursors and
are thus expected to be somewhat slower. Depending on the available indexes
and the table sizes, the performance difference can sometimes be an order
of magnitude different.
<P>
<P><h2>CAUSE</h2>
 
<P>
The optimizer is failing to properly analyze the cost of the various join
possibilities when choosing a query plan. The resulting plan may be
different from what would be picked if the same query were executed outside
of the cursor, or if executed using a different type of cursor.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use a different type of cursor, such as a keyset cursor. If possible,
consider changing the process to not use a cursor, as set operations are
typically much faster than using any type of cursor.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.5. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you evaluate the showplan output, a dynamic cursor will print out two
different query plans. The first plan is displayed when the cursor is
declared, the second plan at the first FETCH. The second plan is the one
used to perform the query. If the query plan from these two outputs is
different, you may experience the slow performance possible with this bug.
<P>
With SQL Server 6.5, the default cursor syntax will declare a dynamic
cursor rather than a keyset cursor, so you must now use the SCROLL keyword
to declare a keyset cursor. If the application has been upgraded from 6.0
(where it was using keyset cursors by default), you can simply revert back
to the 6.0 behavior by using trace flag 7501. This trace flag simply causes
the default cursor type to be keyset rather than dynamic. Consult the
Administrator's Companion of the SQL Server documentation for more
information on using trace flags.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: upgrade performance slow<BR>
Keywords          : kbbug6.50 SSrvTran_SQL kbbuglist<BR>
Version           : Windows:6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
