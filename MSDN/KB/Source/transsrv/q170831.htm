

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Proxy-Stubs for Custom Interfaces Must Include Mtxih.lib </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170831">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1997/06/30">
<META NAME="Keywords" CONTENT="kbprg kbusage TSrvGen TSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; transsrv">
<META NAME="Description" CONTENT="  Microsoft Transaction Server components must be accompanied by proxy- stub DLLs, which enable out-of-process calls. For OLE automation interfaces, Microsoft Transaction Server is able to use the Oleaut32.dll proxy-stub provided with the operating s...">
<META NAME="Product" CONTENT="transsrv">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXT,QBBS,QBVV,QAGI,QBVX,QBXJ,QBS0,QBXA,QAJG,QBWP,QBFY,QAPN,QAO4,QAHE,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Proxy-Stubs for Custom Interfaces Must Include Mtxih.lib</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170831</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Transaction Server, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Transaction Server components must be accompanied by proxy-
stub DLLs, which enable out-of-process calls. For OLE automation
interfaces, Microsoft Transaction Server is able to use the Oleaut32.dll
proxy-stub provided with the operating system. However, if you compile
your own proxy-stub to be used instead of Oleaut32.dll, Microsoft
Transaction Server requires that it link in functions from Mtxih.lib.
<P>
Calls to your Microsoft Transaction Server object through a custom
interface will fail unless you perform the following steps:

<OL><P><LI>Add Mtxih.lib as the first library in the link line of the proxy-stub's
   mk file. Do not add the /NODEFAULTLIB switch to this line.

<P><LI>Add Ole32.lib and Advapi32.lib to the link line. (Other files may also
   be necessary, depending on the nature of your interface.)

<P><LI>Add the /MD flag to the .c.obj line in the mk file.

<P><LI>Recompile the proxy-stub.

<P><LI>Use Regsvr32 to register the proxy-stub DLL.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Transaction Server allows you to create an instance of the custom
interface component. However, the following problems may occur if you have
not correctly linked Mtxih.lib with your custom interface's proxy-stub or
if the proxy-stub is not correctly registered:

<UL><LI>Calls to the component may fail.

<LI>Visual Basic clients may report error 800703e6 or 80010105.

<LI>In Microsoft Transaction Server Explorer, the component's icon may
   continue rotating even after all clients have released references to the
   component.

<LI>Microsoft Transaction Server may log an error in the Windows NT Server
   event log, stating that EventID 4133 occurred in the context wrapper,
   with the following accompanying message:
<P>
<P><PRE>      Interface is not supported by Microsoft Transaction Server. It does
      not have either a type library or a proxy stub. The object that
      implements it does not support IDispatch::GetTypeInfo, ITypeLib, or
      ItypeInfo.
</PRE><P>
</UL>The following is an example of a correct mk file:
<P>
<PRE>   atl9ps.dll: dlldata.obj atl9_p.obj atl9_i.obj
      link /dll /out:atl9ps.dll /def:atl9ps.def /entry:DllMain
   dlldata.obj atl9_p.obj atl9_i.obj mtxih.lib kernel32.lib rpcndr.lib
   rpcns4.lib rpcrt4.lib oleaut32.lib uuid.lib ole32.lib advapi32.lib

   .c.obj:
      cl /c /Ox /MD /DWIN32 /D_WIN32_WINNT=0x0400 /DREGISTER_PROXY_DLL
   $&lt;

   clean:
      @del atl9ps.dll
      @del atl9ps.lib
      @del atl9ps.exp
      @del dlldata.obj
      @del atl9_p.obj
      @del atl9_i.obj

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information, see the Web sites at:

<UL><LI><B><A HREF="http://support.microsoft.com/support/default.asp">http://support.microsoft.com/support/default.asp</A></B>

<LI><B><A HREF="http://www.microsoft.com/transaction/">http://www.microsoft.com/transaction/</A></B>
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: mts<BR>
Keywords          : kbprg kbusage TSrvGen TSrvProg<BR>
Version           : 1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
