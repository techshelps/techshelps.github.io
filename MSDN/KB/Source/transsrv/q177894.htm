

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Recalculate Links Increments InterDev Files Under Source Co </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177894">
<META NAME="KBModify" CONTENT="1998/02/09">
<META NAME="KBCreate" CONTENT="1997/12/09">
<META NAME="Keywords" CONTENT="ssidev">
<META NAME="KBArea" CONTENT="Support; KB; transsrv">
<META NAME="Description" CONTENT="  Some Microsoft Visual InterDev files in a project that have been placed under source control may show increments to their version number when no changes have actually taken place. This occurs when recalculate links is run, or if the file is checked...">
<META NAME="Product" CONTENT="transsrv">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QABH,QASR,QA56,QA55,QDML,QBXS,QAEY,QAKJ,QAEF,QDIX,QAKC,QBXL,QAH0,QBC6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Recalculate Links Increments InterDev Files Under Source Co</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177894</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Studio 97
<LI>Microsoft Visual InterDev, version 1.0
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Some Microsoft Visual InterDev files in a project that have been placed
under source control may show increments to their version number when no
changes have actually taken place. This occurs when recalculate links is
run, or if the file is checked out and back in, although no changes are
made to the file. The comment below is added in SourceSafe:
<P>
<PRE>   Page changed because one of its dependencies changed.

</PRE><h2>CAUSE</h2>
 
<P>
The cause is a bug in Visual SourceSafe version 5.0. Visual SourceSafe
increments a file's version every time a file containing Visual SourceSafe
keywords is checked in. This behavior occurs even though the SourceSafe
option for "Check in Unchanged Files" is set to "Undo Check out".
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There is currently no workaround from Visual InterDev that allows the use
of keywords and prevents the version from being incremented.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Microsoft Visual SourceSafe
version 5.0. We are researching this bug and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Recalculate Links command causes the incrementing behavior to occur
because it checks out and checks in each file in the Web project. This can
dramatically increase the number of erroneous versions of a file.
<P>
The following keywords incorrectly increment a file's version number every
time the file is checked out:
<P>
<PRE>   $Log: $
   $Revision: $
   $History: $
   $Header: $
   $Date: $

</PRE>Other keywords, such as $Author: $ increments only the version when the
information they reference is changed. Other keywords include:
<P>
<PRE>   $Archive: $
   $Author: $
   $Header: $
   $Logfile: $
   $Modtime: $
   $Workfile: $
   $NoKeywords: $

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In the SourceSafe Admin tool, set "Expand keywords in files of type:" to
   "*.asp".

<P><LI>In a Visual InterDev project, create a new .asp file, and add the
   following text:
<P>
<PRE>      $Revision: $   Visual SourceSafe version number

   NOTE: Any one of the keywords mentioned above causes this behavior.

</PRE><P><LI>Select 'Enable Web Source Control' from the Project menu.

<P><LI>In Visual SourceSafe Explorer, in the Options dialog box from the Tools
   menu, ensure that 'Check in Unchanged Files' is set to 'Undo Check out.'

<P><LI>In Visual InterDev, right-click the Project name and select Recalculate
   Links.

<P><LI>In Visual SourceSafe Explorer select Show History of the file. Note that
   the file is modified and a new version is created even though the option
   is set to Undo the checkout.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SSAFE/Q168247.htm">Q168247</A></B>
   TITLE     : BUG: Keywords Cause New Version When "Undo Check Out" Set

</PRE></OL> 
<PRE>Keywords          : ssidev
Version           : WINDOWS:1.0,4.0,5.0,97
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbnofix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
