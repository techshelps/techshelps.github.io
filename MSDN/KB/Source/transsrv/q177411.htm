

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ODBC Driver Must Be Thread Safe If Used with MTS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177411">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/11/28">
<META NAME="Keywords" CONTENT="kbusage TSrvODBC">
<META NAME="KBArea" CONTENT="Support; KB; transsrv">
<META NAME="Description" CONTENT="  An ODBC driver must be thread-safe if it is to be used by a Microsoft Transaction Server (MTS) component. MTS components transparently use an ODBC connection obtained from a pool of connections that is managed by the ODBC Driver Manager. This allow...">
<META NAME="Product" CONTENT="transsrv">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QA9E,QAUQ,QAU9,QAGI,QBVX,QAY2,QAJG,QAJ6,QAVZ,QDMW,QBVV,QA8O,QA3N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODBC Driver Must Be Thread Safe If Used with MTS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177411</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Transaction Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An ODBC driver must be thread-safe if it is to be used by a Microsoft
Transaction Server (MTS) component. MTS components transparently use an
ODBC connection obtained from a pool of connections that is managed by the
ODBC Driver Manager. This allows MTS to use a pool of connections that it
can keep very busy, without the cost of opening and closing a connection
for each component that accesses the database. Connections are used by a
component and then returned to the pool.
<P>
Connections in the pool that have not been used for a set period of time
will be freed, to minimize the use of server resources. The ODBC connection
pool manager uses a worker thread to check for connections that have not
been used for a certain amount of time. By default, the CPTimeout
(connection pool timeout) value is 60 seconds, but you can change it if you
want. Because this worker thread is different than the thread that opened
the connection, the ODBC driver must be able to handle disconnect requests
(SQLDisconnect) coming from a thread other than the thread that called
SQLConnect. Some ODBC drivers cause a general protection fault (GPF) when
the disconnect request is from a different thread.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information, visit the Web sites at:

<UL><LI><B><A HREF="http://www.microsoft.com/transaction/">http://www.microsoft.com/transaction/</A></B>

<LI><B><A HREF="http://www.microsoft.com/support/transaction/">http://www.microsoft.com/support/transaction/</A></B>
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: open database connectivity gp threadsafe<BR>
Keywords          : kbusage TSrvODBC<BR>
Version           : WINNT:1.0<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
