

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO/Jet Cannot Be Used in Transaction Server Components </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166107">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1997/03/31">
<META NAME="Keywords" CONTENT="kbprg TSrvODBC">
<META NAME="KBArea" CONTENT="Support; KB; transsrv">
<META NAME="Description" CONTENT="  Microsoft Data Access Objects (DAO) using the Jet Engine cannot be used within a Microsoft Transaction Server component.  MORE INFORMATION  When given incomplete or incorrect information about an ODBC Data Source, Jet invokes a dialog box to prompt...">
<META NAME="Product" CONTENT="transsrv">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAI5,QAHE,QAJG,QBVV,QBG2,QA9E,QANE,QBS0,QALH,QBXJ,QAYY,QDMW,QBFY,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DAO/Jet Cannot Be Used in Transaction Server Components</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166107</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Transaction Server, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Data Access Objects (DAO) using the Jet Engine cannot be used
within a Microsoft Transaction Server component.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When given incomplete or incorrect information about an ODBC Data Source,
Jet invokes a dialog box to prompt the user for the correct or complete
information. Because the component is running on a server that may be
unattended, or because the component may not have access to the desktop, a
logon dialog box has the effect of causing the component to stop
responding.
<P>
Calling SQLDriverConnect with the SQL_DRIVER_NOPROMPT flag prevents this
from occurring. However, Jet does not invoke SQLDriverConnect with this
flag. ODBC 3.0 Connection Pooling requires SQL_DRIVER_NOPROMPT; therefore,
Microsoft Transaction Server denies a connection to any component that does
not use this flag.
<P>
The C++ Classes, MFC DAO, only provide DAO connection with Jet, and
therefore cannot be used. The C++ DAO SDK 3.5 classes do provide
ODBCDirect, which is really a separate engine from Jet (by way of RDO). You
can specify a flag (dbDriverNoPrompt) in the OpenConnection method with
ODBCDirect that enables the SQL_DRIVER_NOPROMPT flag. Likewise, DAO 3.5
within Visual Basic 5.0 also offers ODBCDirect.
<P>
Other database connectivity alternatives include the following:

<UL><LI>Use ADO.

<LI>Use RDO.

<LI>Use ODBC API.

<LI>Use DAO 3.5 with the ODBCDirect engine.

<LI>Use MFC ODBC Database Classes, but use OpenEx instead of Open, because
   OpenEx allows you to specify SQL_DRIVER_NOPROMPT.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
<B><A HREF="http://www.microsoft.com/transaction/">http://www.microsoft.com/transaction/</A></B>
<B><A HREF="http://www.microsoft.com/support/transaction/">http://www.microsoft.com/support/transaction/</A></B>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MfcDao MfcDatabase dbDao hang hanging stop stopped<BR>
freeze freezes locked locked-up locks up open<BR>
Keywords          : kbprg TSrvODBC<BR>
Version           : 1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
