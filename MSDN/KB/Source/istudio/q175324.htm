

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Doctype Parsing Behavior in Visual InterDev </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175324">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/17">
<META NAME="Keywords" CONTENT="VIASP VIFPSE kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  The following error occurs when browsing an Active Server Pages (ASP) file:     Response object error 'ASP 0156'      Header Error                     , line 3      The HTTP headers are already written to the client browser. Any HTTP      header mo...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QDNQ,QA55,QA56,QBXT,QA9N,QAIB,QA5V,QAVK,QAUR,QAAP,QAB4,QA3N,QAYZ,QASB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Doctype Parsing Behavior in Visual InterDev</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175324</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 97 for Windows
<LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error occurs when browsing an Active Server Pages (ASP) file:
<P>
<PRE>   Response object error 'ASP 0156'
     Header Error
     &lt;your asp file&gt;, line 3
     The HTTP headers are already written to the client browser. Any HTTP
     header modifications must be made before writing page content.

</PRE><h2>CAUSE</h2>
 
<P>
The following conditions cause the error to occur:

<UL><LI>The ASP file contains a WebBot from FrontPage 97.
<LI>The ASP file contains a 'response.expires' or 'response.buffer'.
<P>
</UL>Every time the file is saved in Visual InterDev the FrontPage Server
Extensions parse the file and add the following line to the top of the file
(the local copy does not change, so you have to get working copy to see the
changes):
<P>
<PRE>   "&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"&gt;"

</PRE>With the above line added to the file, the response properties mentioned
above are now set after the HTTP header has been written to the client
browser.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Remove the WebBot.
<P>
-or-
<P>
Edit the ASP file in NotePad and remove the [ASCII 147]DOCTYPE[ASCII 148]
line.
<P>
-or-
<P>
Don't use [ASCII 147]response.expires[ASCII 148] or [ASCII
147]Response.buffer[ASCII 148]
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI> Create a new .htm file in a Visual InterDev project.

<P><LI> Open the .htm file in Microsoft FrontPage97 (Visual InterDev edition).

<P><LI> Add the Timestamp bot to the .htm file. Save and close.

<P><LI>Rename the .htm file extension to .asp and open the .asp file in the
   default editor.

<P><LI> Add the following code to the third line (after &lt;%@ LANGUAGE...) in the
<P><PRE>    file &lt;%response.expires=0%&gt;. Save and preview the file.
</PRE><P>
</OL>The error described above appears.
<P>
Get a working copy of the file and select Use Master Copy when prompted.
<P>
The first line of the file now contains the &lt;doctype...&gt; instead of &lt;%@
language =...&gt;
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : VIASP VIFPSE kberrmsg
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
