

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Configure VID to Work with an Authenticated Web Project </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178215">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/12/17">
<META NAME="Keywords" CONTENT="FTAuthent">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  The default setup of a Visual InterDev project will not allow both the Web server to access a file database (for example, Access or FoxPro database) and authors on remote machines to use Visual InterDev to work on the project when Active Server Pag...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVX,QA55,QA56,QA1S,QAI5,QAZV,QBQU,QAVZ,QBW7,QARL,QAYY,QBWA,QAYL,QDKY,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Configure VID to Work with an Authenticated Web Project</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178215</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The default setup of a Visual InterDev project will not allow both the Web
server to access a file database (for example, Access or FoxPro database)
and authors on remote machines to use Visual InterDev to work on the
project when Active Server Pages (ASP) pages that perform database access
are secured.
<P>
This article describes how to setup a Visual InterDev project so that data
access works correctly from the secured pages, and individuals on other
machines can use Visual InterDev to author those pages.
<P>
While this article uses an Access .mdb file as the example, the discussion
applies to any file based resource.
<P>
Symptoms for this problem can appear on either the Web server or the Visual
InterDev clients. The most common symptoms are as follows:

<OL><P><LI>Data access fails on the ASP pages returning the error:
<P>
<P><PRE>      Microsoft OLE DB Provider for ODBC Drivers error '80004005'
      [Microsoft][ODBC Microsoft Access 97 Driver] The Microsoft Jet
      database engine cannot open the file '(unknown)'. It is already
      opened exclusively by another user, or you need permission to view
      its data.
</PRE>
<P><LI>Data connection icon in a Visual InterDev project shows with a red "X."
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The root of this problem is that the Web server and Visual InterDev clients
have conflicting needs with respect to the kind of path used to reference
the database.
<P>
<P><h3>Web Server Needs</h3>
 
<P>
To avoid "delegation" errors, the database must reside on the Web server,
and the Web server must reference the database using a local drive letter.
A UNC path cannot be used.
<P>
(Delegation refers to Windows NT's inability to access resources on other
machines running Windows NT when NT Challenge/Response has been used as an
authentication method. For a full discussion of delegation see the article
on <B><A HREF="http://www.microsoft.com/workshop/server/asp/feature/Security.htm.">http://www.microsoft.com/workshop/server/asp/feature/Security.htm.)</A></B>
<P>
<P><h3>Client Needs</h3>
 
<P>
Since the database must reside on the Web server, Visual InterDev clients
must reference the .mdb file using a network path (either a mapped drive
letter or UNC)
<P>
The Global.asa created by Visual InterDev includes path information (DBQ=)
that will use either a local or network path to the database. This will
necessarily cause problems for either the server or the Visual InterDev
clients.
<P>
<P><h2>SOLUTION</h2>
 
<P>
The Global.asa connection string variable must be changed so that it
references only the name of a DSN. For example, change the variable
Session("Conn_ConnectionString") from something like this:
<P>
<PRE>   DSN=MyDSN;DBQ=C:\data\orders.mdb;DriverId=25;FIL=MS Access...

</PRE></OL>to simply this:
<P>
<PRE>   DSN=MyDSN

</PRE>Notice that there is no longer a DBQ in the connection string that points
to the file. When the Web server reads the Global.asa, it will look on its
own local system for the "MyDSN" data source and use the information it
contains to access the database. Likewise, when the Visual InterDev clients
read the Global.asa, they will look on their local systems for a DSN of the
same name and use that information. The key is to manually create these
DSN's with the appropriate information for each platform.
<P>
To create the appropriate DSN use the following steps:

<OL><P><LI>Create a DSN on the Web server that uses a local path to point to the
   database. Create DSNs on Visual InterDev client machines that use
   network paths to point to the database on the Web server.

<P><LI>Use Visual InterDev to create a data connection. Choose the DSN on the
   local machine.

<P><LI>Manually change the ConnectionString variable in the Global.asa as shown
   in the example above.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For a complete discussion on NT challenge/response and delegation, see the
following:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/workshop/server/asp/feature/Security.htm">http://www.microsoft.com/workshop/server/asp/feature/Security.htm</A></B>

</PRE></OL>For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : FTAuthent
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
