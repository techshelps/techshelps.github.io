

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Changing Permissions May Cause Web to Be Unavailable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165894">
<META NAME="KBModify" CONTENT="1997/12/09">
<META NAME="KBCreate" CONTENT="1997/03/26">
<META NAME="Keywords" CONTENT="kbprb">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  With a Web project loaded, changing the Web Permissions to  Use unique permissions for this Web  and  Only registered users have browse access  may cause a failure on subsequent project loads. This will be indicated by the message:     Unable to op...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QAVZ,QBWG,QAI5,QBW7,QAK7,QBWU,QALQ,QAH5,QAEF,QABO,QAQW,QAJN,QBWT,QBWF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Changing Permissions May Cause Web to Be Unavailable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165894</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With a Web project loaded, changing the Web Permissions to "Use unique
permissions for this Web" and "Only registered users have browse access"
may cause a failure on subsequent project loads. This will be indicated by
the message:
<P>
<PRE>  "Unable to open web &lt;WEBNAME&gt;. Server error. Web &lt;WEBNAME&gt; is busy. Try
  again later."

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs only when the server machine is configured so that the
Anonymous User for the machine is also a member of the Administrator’s
group. In this case, the standard authentication protocol for any Web
client will first attempt to log on as the Anonymous User. This will result
in all users being logged in to the server as the anonymous user and give
any user administrator privileges.
<P>
When "Only registered users have browse access" is selected, then the
anonymous user is removed from the folder permissions for the Web. This
results in a condition where the user will be logged in to the Web project
as the Anonymous User, but will not have read permission to the Web
project. The loading of project information will fail and the server
operation will time out, producing the error message.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When the Anonymous User is a member of the administrator group, then any
Web browser client will be able to access the machine as an administrator.
This is inherently insecure, and should be avoided unless dictated by
specific circumstances. The preferred workaround is to remove the Anonymous
User from the Administrators group on the Web machine.
<P>
Because browsing permissions are based on the file permissions on the Web
server, the only way to ensure that only registered users have browse
permission is to remove the Anonymous user's read permissions on the file.
If you have added the Anonymous User to the Administrator group on the
machine, then it is possible for any user to work around your security and
read any file on your machine. In this case, the "Only registered users
have browse access" cannot be enforced so the option should be turned off.
This will restore read access to the files and allow the project to be
loaded by Visual InterDev.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>On the server machine, add the Anonymous User to the Administrator
   group.

<P><LI>On the client machine, open a Web in Visual InterDev and access the
   Project/Web Permissions dialog. Select "Use unique permissions for this
   Web" and "Only registered users have browse access."

<P><LI>Close the Web project.

<P><LI>Reopen the Web project.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : kbprb
Version           : 1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
