

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ODBC Error when Passing Date Parameters to SQL Stored Proc </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174638">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/02">
<META NAME="Keywords" CONTENT="VIADO VIODBC">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  One of the following errors occurs when passing a date to a SQL Stored Procedure:     Microsoft OLD DB Provider for ODBC Drivers error 80004005    At least one parameter contained a type that was not supported.     -OR-     Microsoft OLD DB Provide...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAB9,QAH7,QAH6,QAH4,QAD7,QAB4,QDNQ,QBXS,QBWA,QAP2,QAYY,QA56,QA55,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ODBC Error when Passing Date Parameters to SQL Stored Proc</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174638</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
One of the following errors occurs when passing a date to a SQL Stored
Procedure:
<P>
<PRE>   Microsoft OLD DB Provider for ODBC Drivers error 80004005
   At least one parameter contained a type that was not supported.

   -OR-

   Microsoft OLD DB Provider for ODBC Drivers error 80040e21
   Driver not capable.

</PRE><h2>CAUSE</h2>
 
<P>
The data type of the parameter being passed to the stored procedure does
not match the data type the stored procedure is expecting. For example,
passing a value of "7/21/97" to a stored procedure that is expecting
DateTime data will cause the error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure the data type you are passing to the stored procedure is of the
same type as the stored procedure is expecting. Using Visual InterDev's
Data Command control to create the Active Server Pages (ASP) code to call
your stored procedure will ensure the parameter is of the correct type.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create or open a Visual InterDev project.

<P><LI>Add a data connection to the "Pubs" database on your SQL server.

<P><LI>From the Data View tab, right-click the Stored Procedures folder for
   the "Pubs" database and choose "New Stored Procedure" from the context
   menu.

<P><LI>Copy/paste the code between the "===" lines below into the new stored
   procedure.
<P>
<P><PRE>      ========new stored procedure code==========
      CREATE PROCEDURE sp_custom_sel
<PRE></PRE>         @custdate datetime

       AS

      SELECT *
         FROM employee
         WHERE employee.hire_date=@custdate

      ===========================================

</PRE><P><LI>Create a new ASP file in the project.

<P><LI>Copy/paste the code below
<P>
<P><PRE>      ======ASP file to call stored procedure===================
      &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
</PRE><P>
<P><PRE>      &lt;HTML&gt;
      &lt;HEAD&gt;
</PRE><P>
<P><PRE>      &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
      &lt;META HTTP-EQUIV="Content-Type" content="text/html;
       charset=iso-8859-1"&gt;
      &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
      &lt;/HEAD&gt;
      &lt;BODY&gt;
</PRE><P>
<P><PRE>      &lt;%
      Set pubs = Server.CreateObject("ADODB.Connection")
      pubs.ConnectionTimeout = Session("pubs_ConnectionTimeout")
      pubs.CommandTimeout = Session("pubs_CommandTimeout")
      pubs.Open Session("pubs_ConnectionString"),
      Session("pubs_RuntimeUserName"), Session("pubs_RuntimePassword")
      Set cmdTemp = Server.CreateObject("ADODB.Command")
      Set DataCommand1 = Server.CreateObject("ADODB.Recordset")
      cmdTemp.CommandText = "dbo.""sp_custom_sel"""
      cmdTemp.CommandType = 4
      Set cmdTemp.ActiveConnection = pubs
      Set tmpParam = cmdTemp.CreateParameter("Return Value", 3, 4, 4)
      cmdTemp.Parameters.Append tmpParam
</PRE><P>
<P><PRE>      '*************************************
      'The 7 in the "CreateParamter" below defines the passed value
      '-"7/18/61"-as a Date data type.  Changing the 7 to 135 defines the
      'passed value as a Datetime data type, which the stored procedure is
      'expecting. For more information on data type values, see the "Type
      'Property" topic in InfoView.
      '*************************************
      Set tmpParam = cmdTemp.CreateParameter("@custdate",
<PRE></PRE>        7, 1, 16,"7/18/97")


      cmdTemp.Parameters.Append tmpParam
      'DataCommand1.Open cmdTemp, , 0, 1
      cmdTemp.execute
      %&gt;
      &lt;/BODY&gt;
      &lt;/HTML&gt;
      ==============================================================

</PRE><P><LI>Preview the ASP page. The error described in the SYMPTOMS section above
   will appear.

<P><LI>Change the 7 in the "CreateParameter" line of the ASP to 135. Save and
   run the ASP page. No error will appear.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : VIADO VIODBC
Component         : dao
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
