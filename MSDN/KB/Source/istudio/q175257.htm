

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Database Diagram Does Not Restore Relationships After Cance </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175257">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/16">
<META NAME="Keywords" CONTENT="kbDtDbDesigner kbDtQDesigner VIDataTools">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  If you cancelled saving a Database Diagram that involved multiple table edits after a previous attempt to save, you might discover that relationships to tables no longer exist the next time you open your diagram.  CAUSE =====  The Database Designer...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUR,QAB7,QAZV,QAU7,QAAP,QALW,QA56,QA55,QAR4,QAB4,QBWS,QBVV,QA5E,QAYV,QARR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Database Diagram Does Not Restore Relationships After Cance</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175257</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Database Tools, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you cancelled saving a Database Diagram that involved multiple table
edits after a previous attempt to save, you might discover that
relationships to tables no longer exist the next time you open your
diagram.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Database Designer groups all the DDL changes required for tables into
separate transactions. In many cases, the Database Designer deletes foreign
key relationships that point to a table before it can re-create it in a
separate transaction. Should the commit action fail on one of the related
tables, the database state will be inconsistent with what is shown in the
diagram. If you then close the diagram without saving, you'll lose your
relationships.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you encounter an error during a diagram save action, you should use the
Query Designer to fix your data or go back into your diagram and remove any
constraints that might prevent you from saving the diagram. Once you've
corrected the problem, save your diagram changes and the relationships will
be restored correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information regarding how to resolve commit failures when saving
diagrams, see the Help topic "Troubleshooting Errors" under Visual Database
Tools/Database Designer/Troubleshooting.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example uses the pubs database that ships with SQL Server.

<OL><P><LI>Create a new Database Diagram and add the stores, sales, and discounts
   tables to the diagram. Select all the tables, and select Table from the
   View menu, then click the Column Properties command.

<P><LI>Change the datatype for stor_id in the discounts table to id (varchar)
   and accept the Datatype Change Required dialog box. Check off Allow
   Nulls for the stor_id column in the discounts table.

<P><LI>Save diagram, click yes on the Save dialog box and you get a save
   incomplete dialog box with the following ODBC error:
<P>
<P><PRE>      [Microsoft][ODBC SQL Server Driver][SQL Server]Attempt to insert the
      value NULL into column 'stor_id', table 'pubs.dbo.Tmp_discounts_8';
      column does not allow nulls. INSERT fails.
</PRE>
<P><LI>Click OK and close the diagram, say no to save changes reopen the saved
   diagram. The relation between the stores and discounts table is gone.
<P>
</OL>The correct way of handling the ODBC error was to either click back ON
Allow Nulls for the stor_id column in the discounts table and then save the
diagram. The Database Designer would have correctly restored the
relationship between discounts and stores tables.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Visual InterDev Help: search on "Troubleshooting Errors" under Visual
Database Tools/Database Designer/Troubleshooting.
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : kbDtDbDesigner kbDtQDesigner VIDataTools
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
