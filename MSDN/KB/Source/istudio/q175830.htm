

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Using Wildcards in Filter of Data Form Wizard Created Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175830">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/28">
<META NAME="Keywords" CONTENT="VIWizards kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  The following error occurs when attempting to set filter criteria containing a wild card character at the beginning of the string:     Source: DataForm    Error Number: 20001    Description: Wildcard characters * and % can only be used at the end o...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPF,QAML,QAIK,QABI,QAMB,QAPN,QAY5,QBT6,QBSO,QBV4,QDNQ,QBXT,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Using Wildcards in Filter of Data Form Wizard Created Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175830</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error occurs when attempting to set filter criteria
containing a wild card character at the beginning of the string:
<P>
<PRE>   Source: DataForm
   Error Number: 20001
   Description: Wildcard characters * and % can only be used at the end of
   the criteria

</PRE><h2>CAUSE</h2>
 
<P>
The DataForm Wizard produces code that uses the Recordset's Filter
property. According to the ActiveX Data Objects (ADO) documentation on the
Filter property (From Visual InterDev's InfoView select ADO Reference, ADO
Objects, and then Recordset Object), "Only the asterisk (*) and percent
sign (%) wild cards are allowed, and they must be the last character in the
string."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In order to implement a solution that allows wild card characters at the
beginning of filter criteria, you must make major modifications to the code
produced by the DataForm Wizard.

<OL><P><LI>Convert the DataForm Wizard generated code from a "Filter" model to a
   "Requery" model. To do this, follow the instructions provided in the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../ISTUDIO/Q167819.htm">Q167819</A></B>
<PRE></PRE>      TITLE     : HOWTO: Convert Filtering in DataForm Wizard to Requery
                  Model

   Make sure your code works correctly before moving on.

</PRE><P><LI>Search for "Filter = Session" and comment out the following line in
   xxxform.asp:
<P>
<P><PRE>      'rsxxx.Filter = Session("rsxxx_Filter")
</PRE>
<P><LI>Comment out the following lines in the "PrepFilterItem" function of
   xxxaction.asp:
<P>
<P><PRE>      ' Check for leading wildcards
      'If Left(strValue, 1) = "*" Or Left(strValue, 1) = "%" Then
<PRE></PRE>      '   RaiseError errInvalidPrefix, strFieldName
      'End If

</PRE><P><LI>If your filter uses multiple criteria -- like "field=0 and field2 like
   %xx%" -- you will have to make the following change in the last line of
   the "PrepFilterItem" function in xxxAction.asp:
<P>
   From:
<P>
<P><PRE>      PrepFilterItem = "[" &amp; strFieldName &amp; "]" &amp; " " &amp; strOperator &amp; " " &amp;
      strDelimiter &amp;  strValue &amp; strDelimiter
</PRE><P>
   To:
<P>
<P><PRE>      PrepFilterItem = "(" &amp; strFieldName &amp; " " &amp; strOperator &amp; " " &amp;
      strDelimiter &amp; strValue &amp;  strDelimiter &amp;")"
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Enter "%xxx%" into one of the text boxes in the Filter page.

<P><LI>Click Apply.
<P>
</OL>The error described in the SYMPTOMS section above occurs.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : VIWizards kberrmsg
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
