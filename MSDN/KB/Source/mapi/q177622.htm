

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: How to Create a Restriction </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177622">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/12/04">
<META NAME="Keywords" CONTENT="kbcode EDKAPI">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  Restrictions are used by Exchange to limit the rows returned in a table. Restrictions are used throughout the product for determining the conditions for rules, searching for messages, and for creating views of messages. This article describes how t...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABN,QAK9,QAA8,QAH4,QAUD,QAEV,QAYC,QAI4,QA6A,QAPF,QAO3,QAO2,QAL7,QBXR,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: How to Create a Restriction</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177622</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Exchange Development Kit (EDK), version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Restrictions are used by Exchange to limit the rows returned in a table.
Restrictions are used throughout the product for determining the conditions
for rules, searching for messages, and for creating views of messages. This
article describes how to create a restriction and provides a code example.
The code provided is not complete. It assumes that you already have a
handle to a MAPI session, a pointer to the message store, a pointer to the
folder the rule is to be applied to, and that you will release the
appropriate structures before exiting the function.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps for Creating a Restriction</h3>
 

<OL><P><LI>Create a string that contains the property and the value you want to
   look for.

<P><LI>Call HrStringToRestriction() with the restriction string, NULL, and a
   pointer to a restriction. NULL for the second parameter lets
   HrStringToRestriction() create the restriction and allocate memory for
   the restriction.
<P>
<PRE>      LPSRestriction   lpRes =         NULL;
      hr = CreateRestriction(lpRes);

      HRESULT CreateRestriction(LPSRestriction lpRes)
      {
         HRESULT hr = NULL;

         //  hr = HrStringToRestriction("PR_SENDER_NAME } \"Bugs Bunny\"",
         //                             NULL ,
         //                             &amp;lpRes);
         hr = HrStringToRestriction("PR_SUBJECT } \"Test\"",
                         NULL , &amp;lpRes);

         if (FAILED(hr))
         {
            MessageBox(NULL,"Restriction Failed",NULL,MB_OK);
            return hr;
         }

         if (lpRes-&gt;rt = RES_CONTENT)
         {
           lpRes-&gt;res.resContent.ulFuzzyLevel =   FL_SUBSTRING   |
                                 FL_IGNORECASE  |
                                 FL_LOOSE;
         }
         return hr;
      }

   NOTE:  To use this code, the following libraries and headers
   are required:

      Mapi32.lib
      Uuid.lib
      Version.lib
      Edkmapi.lib
      Edkutils.lib
      Addrlkup.lib
      Edkguid.lib
      Rulecls.lib
      Edkdebug.lib
      Edk.h

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following topics in the Microsoft
Developer Network Library (MSDN). These topics can be found in the Win32
Messaging (MAPI) section of the Platform SDK.

<UL><LI>Starting a MAPI Session
<LI>Opening a Message Store
<LI>Opening the Default Message Store
<LI>Opening a Folder
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Restriction Restrictions HrStringToRestriction<BR>
Keywords          : kbcode EDKAPI<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
