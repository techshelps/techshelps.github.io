

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Forwarding Messages Using CDO Version 1.2 (VB Sample) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178789">
<META NAME="KBModify" CONTENT="1998/01/08">
<META NAME="KBCreate" CONTENT="1998/01/05">
<META NAME="Keywords" CONTENT="kbcode cdo">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  The Forward method has been added to the Collaboration Data Objects (CDO) version 1.2 library. When you use the Forward method, it may not perform as desired because the body of the message is not copied to the message to be forwarded. This behavio...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QAPN,QAYC,QAFQ,QBHQ,QAMB,QAH4,QAYY,QBXS,QA3Z,QA3Y,QAW6,QABC,QBVV,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Forwarding Messages Using CDO Version 1.2 (VB Sample)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178789</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Collaboration Data Objects (CDO), version 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Forward method has been added to the Collaboration Data Objects (CDO)
version 1.2 library. When you use the Forward method, it may not perform as
desired because the body of the message is not copied to the message to be
forwarded. This behavior is by design.
<P>
This article contains a Visual Basic code sample showing how to make this
work.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem stems from the fact that the Collaboration Data Objects (CDO)
library only supports non-RTF (Rich Text Format) by default, but can also
be extended to support RTF. This method explicitly leaves the decision up
to the developer to determine how a message is to be forwarded.
<P>
<PRE>   'This code sample is dependent upon the CDO version 1.2 library being
   'installed on the target computer.
   '
   Dim objSession As MAPI.Session
   Dim objMsgColl As Messages
   Dim objMsg1 As Message
   Dim objFwdMsg As Message

   Private Sub Form_Load()
   'Create Session and Logon.
   Set objSession = CreateObject("mapi.session")
   objSession.Logon
   Set objMsgColl = objSession.Inbox.Messages
   'First Message.
   Set objMsg1 = objMsgColl.GetFirst
   Set objFwdMsg = objMsg1.Forward
   'BEGIN objFwdMsg BODY CONSTRUCTION
   '
   'For RTF in the body, uncomment both of the following lines of
   'code. For plain text, uncomment the first line,
   'which is not really required for RTF, except that if you happen
   'to forward the message to a client that cannot read RTF, populating
   'this property allows that client to display the non-RTF
   'variant of the body.
   '
   'objFwdMsg.Text = objMsg1.Text
   'objFwdMsg.Fields.Add CdoPR_RTF_COMPRESSED, _
   objMsg1.Fields(&amp;H10090102).Value
   '
   'END objFwdMsg BODY CONSTRUCTION
   objFwdMsg.Recipients.Add Name:="YourRecipEmailNameHere"
   objFwdMsg.Recipients.Resolve
      objFwdMsg.Send

      objSession.Logoff
      Set objSession = Nothing
      Unload Me

      End Sub

</PRE>NOTE: This process of copying the compressed RTF stream to the new message
also works for the CDO version 1.1 library. However, version 1.1 of the CDO
library does not support the Forward method, so a "Forward" would need to
be emulated by copying one field at a time from the fields collection of
the original message to the target message.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For information on where to acquire the most recent version of the CDO
library tested for client-side use, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../MAPI/Q171440.htm">Q171440</A></B>
   TITLE     : INFO: Where to Acquire the Active Messaging Libraries

</PRE>For additional information about Collaboration Data Objects versus Active
Messaging, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../MAPI/Q176916.htm">Q176916</A></B>
   TITLE     : INFO: Active Messaging and Collaboration Data Objects (CDO)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ActMsg OleMsg<BR>
Keywords          : kbcode cdo<BR>
Version           : WINDOWS:1.2<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
