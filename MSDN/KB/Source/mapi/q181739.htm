

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: IIS 4.0 Automatic Password Synchronization and CDO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181739">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1998/02/25">
<META NAME="Keywords" CONTENT="cdo">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  An error occurs when any or all of the following conditions are true:   - Using Active Server Pages to access an Exchange Server.   - Using Internet Information Server version 4.0.   - You are attempting to use an Anonymous Exchange mailbox.   - In...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWK,QA1S,QAI5,QAB4,QAGU,QBW7,QDN9,QBWS,QBVV,QA2Q,QAVZ,QDNW,QAG2,QAA1,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: IIS 4.0 Automatic Password Synchronization and CDO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181739</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Collaboration Data Objects (CDO), versions 1.1, 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An error occurs when any or all of the following conditions are true:

<UL><LI>Using Active Server Pages to access an Exchange Server.

<LI>Using Internet Information Server version 4.0.

<LI>You are attempting to use an Anonymous Exchange mailbox.

<LI>Internet Information Server (IIS) is set to "Allow Anonymous Access".

<LI>Anonymous Access is set to "Enable Automatic Password Synchronization".
<P>
</UL>The error that occurs is one of the following error messages:
<P>
<PRE>   Collaboration Data Objects error '000004f9'
   The information store could not be opened.
   [MAPI 1.0 - [MAPI_E_LOGON_FAILED(80040111)]]

   -or-

   401.1 Unauthorized: Logon Failed


</PRE><h2>CAUSE</h2>
 
<P>
This happens when you are attempting to access an Exchange mailbox that has
been set up to allow Anonymous access to Exchange. This is most frequently
done to allow users to send mail from a Web application using Microsoft
Exchange where you do not need to or are unable to authenticate the user
with Windows NT Challenge\Response Authentication (also referred to as
NTLM) or Basic Authentication.
<P>
Internet Information Server (IIS) version 4.0 has an additional feature
that allows for password synchronization between IIS 4.0 and the computer
user accounts. Password synchronization should only be used with anonymous
user accounts defined on the local computer, not with anonymous accounts
remote computers. This feature will not work to authenticate an anonymous
user to a remote Exchange server.
<P>
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You must turn "Automatic Password Synchronization" off. To accomplish this
task follow these steps:

<OL><P><LI>Right-click the virtual server in question.

<P><LI>Select Properties.

<P><LI>Select Directory Security.

<P><LI>Select "Allow Anonymous Access" to enable the "Edit" control.

<P><LI>Select "Edit".

<P><LI>Clear the "Enable Automatic Password Synchronization" option.

<P><LI>Choose OK twice and click Apply to save the settings.
<P>
</OL> 
<PRE>Keywords          : cdo
Version           : WINDOWS:1.1,1.2
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
