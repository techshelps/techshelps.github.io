

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Adding Help to a Service Provider Property Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167891">
<META NAME="KBModify" CONTENT="1997/05/13">
<META NAME="KBCreate" CONTENT="1997/05/01">
<META NAME="Keywords" CONTENT="EMAPI">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  When MAPI is used to write a service provider, it is sometimes necessary to enable Help for the property pages included with the provider. The property pages are exposed by asking for the properties of a service under the Services tab of a profile....">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWB,QBQU,QAPN,QA6A,QA4H,QASR,QBWA,QAKC,QBC9,QBC8,QANO,QACK,QAIC,QBC6,QBWC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Adding Help to a Service Provider Property Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167891</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Extended Messaging Application Programming Interface (MAPI), version
   1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When MAPI is used to write a service provider, it is sometimes necessary to
enable Help for the property pages included with the provider. The property
pages are exposed by asking for the properties of a service under the
Services tab of a profile. The steps listed below describe the method used
to add Help to these property pages.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The steps outlined below assume that a dialog box already exists for the
property page of your service provider and MAPI display tables are being
used for these property pages.

<OL><P><LI>Modify the Mapisvc.inf file to include a section titled [Help File
   Mappings]. Add an entry for your service provider that points to your
   Help file, for example:
<P>
<P><PRE>      [Help File Mappings]
      My Service Provider=C:\TEST\myhelp.hlp
</PRE>
<P><LI>Since the display table uses an array of DTPAGE structures you must set
   the lpszComponent member of the DTPAGE structure you are interested in.
   So to set the help of the first page to point to your help file you
   would modify the lpszComponent member as follows:
<P>
<P><PRE>      DtPropPages[0].lpszComponent = "My Service Provider";
</PRE><P>
   where DtPropPages[0] is an array of DTPAGE types. This text string
   should match the entry in the Mapisvc.inf file that was added.

<P><LI>Another member of the DTPAGE structure points to a second structure that
   defines all the controls and properties on the DTPAGE. This member is
   lpctl and points to a variable of type DTCTL.
<P>
<P><PRE>      DtPropPages[0].lpctl = UserConfigPage;
</PRE>
<P><LI>The next step is to point the property page to a specific topic in your
   Help file that you enabled in step 2. One of the controls that can be
   added to the DTCTL structure is the DTBLPAGE. The DTBLPAGE structure
   describes a tabbed page that is a control that is used to separate
   several related dialog boxes. The fourth member of the DTBLPAGE
   structure is the mapped Topic ID you want to link to in your Help file,
   for example:
<P>
<PRE>      DTBLPAGE        DtPage       = { sizeof(DTBLPAGE),  0, 0, 1};

   The fourth member, which is the number 1, is the mapped Topic ID from
   your help file.

</PRE><P><LI>The last step is to modify your Help file to create a mapped Topic ID.
   You must map your Topic ID to the same number you specified in step 4
   above. In this case, you mapped a Topic ID to the number 1, for example:
<P>
   If your help file contains a Topic ID of 'Service_Provider_Help', you
   should map this topic to the number 1. The Microsoft Help Workshop has
   an option to map topics to numerical values. Your mapping would look
   like this:
<P>
<P><PRE>      Service_Provider_Help=1
 </BLOCKQUOTE>


	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : EMAPI<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
