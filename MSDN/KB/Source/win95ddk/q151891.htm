

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Call GDI Functions from a Print Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151891">
<META NAME="KBModify" CONTENT="1997/03/11">
<META NAME="KBCreate" CONTENT="1996/05/30">
<META NAME="Keywords" CONTENT="DDK DDKPRNT kbhowto kbprg kbprint">
<META NAME="KBArea" CONTENT="Support; KB; win95ddk">
<META NAME="Description" CONTENT="  A print driver can call GDI functions having the same name as printer- driver entry-point functions by explicitly or implicitly reloading GDI.  MORE INFORMATION  Windows 95 printer drivers export functions that have the same name as the GDI functio...">
<META NAME="Product" CONTENT="win95ddk">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAGI,QBV8,QAB9,QAIF,QAU9,QDL9,QBWO,QBWN,QAOX,QADF,QAJQ,QAY2,QAUJ,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Call GDI Functions from a Print Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151891</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS 95
kbprg kbprint kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95 Device Driver Kits (DDK)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A print driver can call GDI functions having the same name as printer-
driver entry-point functions by explicitly or implicitly reloading GDI.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows 95 printer drivers export functions that have the same name as the
GDI functions. In order to call the GDI functions from a printer driver,
such as BitBlt, ExtTextOut, etc., do the following:

<OL><P><LI>Import the GDI functions in the .DEF file under the IMPORTS section of
   the driver's .DEF file and use the imported function names.

<P><LI>Do a LoadLibrary on GDI.EXE and obtain the address of the desired
   function to be called using the GetProcAddress function. Once the
   address is obtained, the function can be called using the function
   pointer.

<P><LI>Define a DLL with functions that will call the GDI functions and IMPORT
   the DLL functions in the printer driver. For example, to call a GDI
   function, you would call the corresponding function in the DLL that, in
   turn, would make the GDI function call.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: debugging print driver<BR>
KBCategory: kbprg kbprint kbhowto<BR>
KBSubcategory: DDK DDKPRNT<BR>
Keywords            : DDK DDKPRNT kbhowto kbprg kbprint<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
