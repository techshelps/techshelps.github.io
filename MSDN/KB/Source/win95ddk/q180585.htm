

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Windows 95 DDK Print Processor Sample Causes Word 97 Fault </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180585">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1998/02/05">
<META NAME="Keywords" CONTENT="NTDDKPrnt">
<META NAME="KBArea" CONTENT="Support; KB; win95ddk">
<META NAME="Description" CONTENT="  The print processor sample in the Windows 95 DDK causes Word 97 to fault when printing large documents.  CAUSE =====  This happens because the print processor links with Winspool.lib.  RESOLUTION  To fix the problems, modify the makefile to link wi...">
<META NAME="Product" CONTENT="win95ddk">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVK,QAIH,QDL9,QBWQ,QBWO,QBWN,QAOX,QAPF,QALZ,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Windows 95 DDK Print Processor Sample Causes Word 97 Fault</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180585</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Windows 95 Device Driver Kit (DDK), version 4.0
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The print processor sample in the Windows 95 DDK causes Word 97 to fault
when printing large documents.
<P>
<P><h2>CAUSE</h2>
 
<P>
This happens because the print processor links with Winspool.lib.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To fix the problems, modify the makefile to link with Spoolss.lib and not
Winspool.lib as shown below.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   \DDK|\PRINTER\SAMPLES\SPOOLER\WINPRINT\MAKEFILE
   "
   [ASCII 133][ASCII 133][ASCII 133][ASCII 133]
   [ASCII 133][ASCII 133][ASCII 133][ASCII 133]
   [ASCII 133][ASCII 133][ASCII 133][ASCII 133]

   LINK_OPTS = /NOLOGO /DEBUG /DEBUGTYPE:CV /SUBSYSTEM:WINDOWS USER32.LIB
   GDI32.LIB KERNEL32.LIB SPOOLSS.LIB /ENTRY:DLLENTRYPOINT

   LIBS = SPOOLSS.LIB LIBC.LIB ADVAPI32.LIB MPR.LIB SHELL32.LIB

   [ASCII 133][ASCII 133][ASCII 133][ASCII 133]
   [ASCII 133][ASCII 133][ASCII 133][ASCII 133]
   [ASCII 133][ASCII 133][ASCII 133][ASCII 133]
   "

</PRE><h2>STATUS</h2>
 
<P>
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
 
<PRE>Keywords          : NTDDKPrnt
Version           : WINDOWS:4.0
Platform          : WINDOWS
Issue type        : kbprb
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
