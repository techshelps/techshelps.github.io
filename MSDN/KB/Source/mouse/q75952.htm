

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Function 38: Get Maximum Virtual Coordinates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75952 ">
<META NAME="KBModify" CONTENT="1996/09/16">
<META NAME="KBCreate" CONTENT="1991/09/10">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; mouse, hw, win95x, winnt, hwother, win3x, msdos">
<META NAME="Description" CONTENT="  The code example below demonstrates the use of mouse function 38. For additional information, refer to the  Microsoft Mouse Programmer's Reference Guide.   MORE INFORMATION  Mouse function 38 returns whether the mouse is enabled, and returns the vi...">
<META NAME="Product" CONTENT="Mouse">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAY5,QBE7,QBE6,QDH9,QA5W,QAU9,QBXS,QBV8,QAB9,QAQ7,QAC1,QA62,QAYA,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Function 38: Get Maximum Virtual Coordinates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75952 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mouse Driver for MS-DOS, versions 6.x, 7.x, 8.x, and 9.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The code example below demonstrates the use of mouse function 38. For
additional information, refer to the "Microsoft Mouse Programmer's
Reference Guide."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Mouse function 38 returns whether the mouse is enabled, and returns
the virtual X and Y maximum coordinates.
<P>
Note: If the mouse driver version is earlier than version 7.05,
function 38 returns the current set virtual X &amp; Y maximum (in current
mode). For driver versions 7.05 and later, function 38 returns the
absolute virtual X &amp; Y maximum (in current mode).
<P>
<PRE>   Input          Output
   -----          ------

   AX = 38        BX = Mouse disabled flag
                       0 if mouse is enabled
                       !0 if mouse is disabled
                  CX = Virtual X maximum (in current video mode)
                  DX = Virtual Y maximum (in current video mode)

// This is an example of mouse function 38.
// Function 38: Get Maximum Virtual Coordinates

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#define v626  0x0626
#define v705  0x0705

unsigned int  bxr,cxr,dxr, dvr;

char *mdf, *vmm;


void main( void )
</PRE>{
<P>
<PRE>/* check driver version */
 _asm
    {
    mov ax,36
    int 33h
    mov dvr,bx   ;save results
    }

</PRE>if ( dvr &lt; v626)
<PRE>      {
</PRE>printf("function 38 requires driver 6.26 or greater \n");
exit(0);
<PRE>      }

/* function 38 */
 _asm
    {
    mov ax,38
    int 33h
    mov bxr,bx    ;save results
    mov cxr,cx
    mov dxr,dx
    }

</PRE>printf("Function 38 Returned Values \n");
<PRE>printf("   Value in BX is %Xh \n",bxr);
printf("   Value in CX is %Xh \n",cxr);
printf("   Value in DX is %Xh \n\n",dxr);

</PRE>if (!bxr) mdf= "ENABLED"; else mdf= "DISABLED";
printf("MOUSE DISABLED FLAG.\n");
<PRE>printf("   mouse driver %s\n\n",mdf);

</PRE>printf("MOUSE MAXIMUMS\n");
<PRE>printf("   {Note: if driver version is prior 7.05 this returns \n");
printf("    current set virtual X &amp; Y max (in current mode) \n");
printf("    for driver version 7.05 and higher this returns\n");
printf("    Absolute virtual X &amp; Y max (in current mode)} \n\n");

</PRE>if (dvr  &lt; v705)  vmm= "CURRENTLY SET"; else vmm = "ACTUAL";
<PRE>printf("   %s virtual X max :&gt;&gt;%d&lt;&lt; (for current mode)\n",vmm,cxr);
printf("   %s virtual Y max :&gt;&gt;%d&lt;&lt; (for current mode)\n",vmm,dxr);

</PRE>printf("\n\n");
}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbhw kbprg<BR>
KBSubcategory:
<P>

Additional reference words: 8.00 8.10 8.20 9.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
