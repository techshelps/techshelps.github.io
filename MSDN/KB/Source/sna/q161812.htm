

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TN3270 Server Does Not Send All Data to Host </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161812">
<META NAME="KBModify" CONTENT="1997/03/13">
<META NAME="KBCreate" CONTENT="1997/01/06">
<META NAME="Keywords" CONTENT="snalua snatn3270 kbbug2.00 kbbug2.10 kbbug2.11 kbbug3.00 kbfix2.11.sp2">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When a TN3270 emulator submits data to the TN3270 Server, the TN3270 Server does not transfer all of the data to the host. The TN3270 emulator session stays intact. The host application may complain that not all of the data was sent, and sends any ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH6,QBVV,QAYY,QALG,QAIJ,QAC2,QAGI,QAKP,QDO3,QDN1,QAYZ,QAR4,QAIV,QABA,QAR5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>TN3270 Server Does Not Send All Data to Host</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161812</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.11 3.00
WINDOWS
kbnetwork kbbug2.00 kbbug2.10 kbbug2.11 kbbug3.00 kbfix2.11.sp2
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 2.0, 2.1, 2.11, and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a TN3270 emulator submits data to the TN3270 Server, the TN3270
Server
does not transfer all of the data to the host. The TN3270 emulator session
stays intact. The host application may complain that not all of the data
was sent, and sends any errors as data to the receiving application.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem is caused by the TN3270 Server's logic for handling SYSREQ
requests. In TN3270, one way for a TN3270 client to send a SYSREQ request
is to send an SNA TESTREQ key value 0x01. (Note: TESTREQ/SYSREQ are
normally 0xF0. However, the original specification for TN3270 did not
specify what message a TN3270 client should send when the user press the
TESTREQ/SYSREQ key, so different vendors implemented it in different
ways.)
The TN3270 Server has logic to spot this key as the first byte of an RU,
and not to send it to the host, but instead to send a SYSREQ request.
However, this code should have been looking for a TESTREQ as the first
byte
of a chain, not the first byte of an RU. In this case, one of the
subsequent RUs in the chain began with 0x01 and the TN3270 Server treated
this as a TESTREQ key and ended the chain (EC) when it should not have.
<P>
NOTE: Splitting a chain into RUs is arbitrary, so there is no significance
to where the split occurs.
<P>
This problem is seen when chunks of data are larger than the RU size
supported for the session, and the chunks need to be split up. The chunk
size (chain size) is controlled by the Structured Field Size, configurable
in some TN3270 emulators. The RU size is controlled by the primary half
session's bind image (byte 10).
<P>
The following is a sample trace that shows the problem:
<P>
Beginning of Chain (BC):
<P>
<PRE>|000000c9.000000ca DLC    ----------------------------------------------
</PRE>17:06:52.39
<PRE>|000000c9.000000ca DLC    01020101-&gt;0A160080 DLC DATA
|000000c9.000000ca DLC                       DAF:01 OAF:03 ODAI:off Normal
|000000c9.000000ca DLC                       RQE FMD BC DR1 BB
</PRE>|000000c9.000000ca DLC
<PRE>|000000c9.000000ca DLC    ---- Header  at address 00CC4620, 4 elements ---
-
|000000c9.000000ca DLC    00050004 00032C00 01030068 0100E800
</PRE>&lt;......,....h..Y.&gt;
|000000c9.000000ca DLC
<PRE>|000000c9.000000ca DLC    ---- Element at address 011BCA3C, start 10, end
</PRE>268 ----
<PRE>|000000c9.000000ca DLC    02908088 ...etc

</PRE>Middle Chain (MC):
<P>
<PRE>|000000c9.000000ca DLC    ----------------------------------------------
</PRE>17:06:52.59
<PRE>|000000c9.000000ca DLC    01020101-&gt;0A160080 DLC DATA
|000000c9.000000ca DLC                       DAF:01 OAF:03 ODAI:off Normal
|000000c9.000000ca DLC                       RQE FMD MC DR1
</PRE>|000000c9.000000ca DLC
<PRE>|000000c9.000000ca DLC    ---- Header  at address 00CC444C, 4 elements ---
-
|000000c9.000000ca DLC    00050004 40032C00 01030069 0100E800
</PRE>&lt;....@.,....i..Y.&gt;
|000000c9.000000ca DLC
<PRE>|000000c9.000000ca DLC    ---- Element at address 011BD7EC, start 10, end
</PRE>268 ----
<PRE>|000000c9.000000ca DLC    009000FF ...etc

</PRE>More middle chains flow...
<P>
End Chain (EC)
<P>
<PRE>|000000c9.000000ca DLC    ----------------------------------------------
</PRE>17:06:54.79
<PRE>|000000c9.000000ca DLC    01020101-&gt;0A160080 DLC DATA
|000000c9.000000ca DLC                       DAF:01 OAF:03 ODAI:off Normal
|000000c9.000000ca DLC                       RQE FMD EC DR1 CD
</PRE>|000000c9.000000ca DLC
<PRE>|000000c9.000000ca DLC    ---- Header  at address 00CC46F0, 4 elements ---
-
|000000c9.000000ca DLC    00050400 00032C00 01030072 0100E800
</PRE>&lt;......,....r..Y.&gt;
|000000c9.000000ca DLC
<PRE>|000000c9.000000ca DLC    ---- Element at address 011BE7E4, start 10, end
</PRE>268 ----
<PRE>|000000c9.000000ca DLC    01902001 ...etc
                                ^^ - This is the TESTREQ key.

</PRE>The SYSREQ and TESTREQ AID bytes are found in the "IBM 3270 Information
Display System" reference (Part #: GA23-0061-2).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, obtain the hotfix mentioned below. With this
hotfix, the TN3270 Server now looks for TESTREQ as the first byte of a
chain instead of an RU.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 2.0,
2.1, 2.11, and 3.0.
<PRE> A supported fix is now available for version 2.11
</PRE>Service Pack 1, but has not been fully regression-tested and should be
applied only to systems experiencing this specific problem. Unless you are
severely impacted by this specific problem, Microsoft recommends that you
wait for the next Service Pack that contains this fix. Contact Microsoft
Technical Support for more information.
receive
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbbug2.00 kbbug2.10 kbbug2.11 kbbug3.00<BR>
kbfix2.11.sp2<BR>
KBSubcategory: snatn3270 snalua<BR>
Additional reference words: prodsna 2.00 2.10 2.11 3.00<BR>
Keywords            : snalua snatn3270 kbbug2.00 kbbug2.10 kbbug2.11 kbbug3.00 kbfix2.11.sp2<BR>
Version             : 2.00 2.10 2.11 3.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
