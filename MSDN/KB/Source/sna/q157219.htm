

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INETINFO Access Violation When Using SNA Server APPC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157219">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/10/08">
<META NAME="Keywords" CONTENT="kbbug2.11 kbfix2.11.sp2 kbinterop kbprg snaappc">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When you run Microsoft Internet Information Server (IIS) version 2.0 and use the HTTPODBC DLL to query a DB2 database using the StarQuest ODBC/DRDA driver included with the Microsoft SNA Server 2.11 Windows NT client software, the StarQuest ODBC dr...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAR4,QA1S,QBWP,QAI4,QAKP,QA9E,QAU9,QAAP,QDN9,QBW7,QAI5,QBWG,QBVX,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INETINFO Access Violation When Using SNA Server APPC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157219</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server version 2.11 and 2.11 Service Pack 1
<LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Internet Information Server version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Microsoft Internet Information Server (IIS) version 2.0 and
use the HTTPODBC DLL to query a DB2 database using the StarQuest ODBC/DRDA
driver included with the Microsoft SNA Server 2.11 Windows NT client
software, the StarQuest ODBC driver uses an APPC session to communicate
with a host or AS/400 DB2 database.
<P>
Whenever a SQL error is encountered by the ODBC driver, or even after
a successful query response, the following access violation occurs:
<P>
<PRE>   App: exe\inetinfo.dbg &lt;process id&gt;
   When: &lt;date and time&gt;
   Exception number: c0000005 (access violation)

</PRE>The Drwtsn32.log shows all the threads of the process; however, the log
does not indicate the thread that encountered the "FAULT."
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when Wappc32.dll is unloaded while one of the
Snadmod.dll threads is executing the APPC routing procedure. The following
stack trace of the failure is observed, indicating that the Snadmod.dll
attempted to invoke a function that is no longer in memory:
<P>
&gt; kb=24DFF1c, 24dff14, 24dff54
<PRE>FramePtr  RetAddr   Param1   Param2   Param3   Function Name
</PRE>024dff1c  01ffaf06  101541a8 025b0004 00000001 0x024dff54
024dff50  01fee05a  101541a8 00000001 00000000 SNADMOD!sepdq2_int+0x106
024dff78  01fee32e  024dffa8 024dffa2 024dffa6 SNADMOD!sbpdin_int+0x21a
024dffb8  77f04f4a  00000000 02028172 00000000 SNADMOD!sepdramp+0xde
024dffec  00000000  01fee250 00000000 00000000
KERNEL32!BaseThreadStart+0x51
<P>
SNADMOD!_sepdq2_int@8+0x100:
<PRE>0x01ffaf00  51               push         ecx
0x01ffaf01  57               push         edi
0x01ffaf02  ff542420         call         dword ptr [esp+20]

</PRE><h2>RESOLUTION</h2>
 
<P>
A hot fix to SNA Server 2.11 and 2.11 Service Pack 1 is available to
correct this problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 2.11
and 2.11 Service Pack 1.
This problem was corrected in the latest Microsoft SNA Server 2.11 U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna internet<BR>
Keywords            : kbbug2.11 kbfix2.11.sp2 kbinterop kbprg snaappc<BR>
Version             : 2.0 2.11 4.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
