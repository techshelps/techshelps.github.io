

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Auto Started TP Is Not Invoked if TP Has Mixed-Case TP Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158515">
<META NAME="KBModify" CONTENT="1997/03/18">
<META NAME="KBCreate" CONTENT="1996/10/31">
<META NAME="Keywords" CONTENT="prodsna snaappc snacpic snatp kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  The SNA Server logs the following events in the Microsoft Windows NT Application Event Log if the Autostarted Transaction Program (TP) fails to start because the TP Name contains any lower case letters:     Event ID: 21    Source: SNA Server    Des...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QAIJ,QDO3,QARM,QACK,QBVV,QAO4,QAA1,QAPN,QDI2,QAGX,QAKP,QBWD,QDJ3,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Auto Started TP Is Not Invoked if TP Has Mixed-Case TP Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158515</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.11 2.11.sp1
WINDOWS NT
kbprog kbprg kbbug2.00 kbbug2.10 kbbug2.11 kbbug2.11.sp1
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server versions 2.0, 2.1, 2.11, and 2.11
   Service Pack 1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SNA Server logs the following events in the Microsoft Windows NT
Application Event Log if the Autostarted Transaction Program (TP) fails to
start because the TP Name contains any lower case letters:
<P>
<PRE>   Event ID: 21
   Source: SNA Server
   Description: (1124) Negative Response Sent on Connection
                &lt;connection name&gt; (SENSE = 846)

   Event ID: 60
   Source: SNA Server
   Description: Failed to invoke APPC TP &lt;TP Name in EBCDIC&gt; (TP Name in
                ASCII), sense data = 84c0000

</PRE>NOTE: Event 60, sense data 084C0000, is a common error that occurs when
SNA Server receives an FMH-5 Attach (conversation startup request for
a specified TP name) and the TP name is not configured in the SNA
"subdomain" or cannot be started. It is very uncommon for the TP name
to be defined in mixed-case format; the problem documented in this
article is not a common cause of the above events.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem is only an issue for Autostarted TPs that have a mixed-case TP
name. The SnaBase service reads the configured TP entries from the registry
and adds them to SNA Server's Service Table to register them in the SNA
Server Subdomain. SnaBase was automatically capitalizing the TP Name even
if the TP had been configured in the Registry with a mixed-case TP Name.
<P>
When SNA Server tries to invoke a TP, it searches through the Service Table
to match the TP Name that it receives in an Incoming Attach with one that
is listed in the Service Table. In this case, the Incoming Attach specified
a mixed-case TP Name, and because the Service Table only contained the
upper-case name, the TP could not be started, resulting in the errors
listed above.
<P>
Notes:

<UL><LI>Operator started TPs with a mixed-case TP Name do not experience this
   problem.

<LI>TPSETUP automatically capitalizes the TP Name in the Registry when it
   is used to set up the TP. If you need to set up a TP with a mixed-case
   name, you will need to set it up manually. Please refer to Chapter 2 of
   the SNA Server “APPC Programmer's Guide” for more information on how to
   configure invokable TPs.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Use TP Names that contain only upper-case characters.
<P>
Because it may not always be possible to avoid mixed-case TP Names, a fix
has been made to SNA Server so that TP Names are no longer automatically
capitalized before they are put into the Service Table.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SNA Server
versions 2.0, 2.10, 2.11, and 2.11 Service Pack 1.
This problem was corrected in the latest Microsoft SNA Server 2.11 U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprog kbprg kbbug2.10 kbbug2.11 kbbug2.11.sp1 kbfix2.11.sp2<BR>
KBSubcategory: prodsna snaappc snacpic snatp<BR>
Additional reference words: sp1 invoked kbbug2.00<BR>
Keywords            : prodsna snaappc snacpic snatp kbbuglist<BR>
Version             : 2.00 2.10 2.11 2.11.sp1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
