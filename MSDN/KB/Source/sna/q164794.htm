

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SNA Server Issues with DBCS Printing to an AS/400 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164794">
<META NAME="KBModify" CONTENT="1997/04/14">
<META NAME="KBCreate" CONTENT="1997/03/06">
<META NAME="Keywords" CONTENT="kbbug3.00 kbfix3.00.sp1 kbprint snaprintservice">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT=" This article only applies to DBCS (double byte character set) code pages. DBCS code pages include all of the following:     290 Japanese (Katakana)    930 Japanese (Extend Katakana)    931 Japanese (English-lower)    933 Korean    935 Chinese (PRC) ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBXT,QA5V,QAIB,QAML,QAWP,QBVV,QAUD,QAAQ,QACR,QBVX,QAL3,QAB1,QAH6,QDO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server Issues with DBCS Printing to an AS/400</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164794</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, version 3.0
</UL> 
<P>
This article only applies to DBCS (double byte character set) code pages.
DBCS code pages include all of the following:
<P>
<PRE>   290 Japanese (Katakana)
   930 Japanese (Extend Katakana)
   931 Japanese (English-lower)
   933 Korean
   935 Chinese (PRC)
   937 Chinese (Taiwan)
   939 Japanese (Extend English)

</PRE><P><LI>Carriage Return (0x0D) Not Interpreted Correctly with 5250 Printing

<P><LI>Print Server Doesn't Send Form Feed (FF) When NL or LF Is on Last Line

<P><LI>Last Line Doesn't Print When Using SNA Server Print Server

<P><LI>SNA Server Print Server Ignores the First LF and NL

<P><LI>Problem with PrintPosition (AbsoluteHorizontalMove)

<P><LI>Added Support for Thick Dotted Line, SHF, SPCC, and STO

<P><LI>FF Command Is Not Positioned at Line-1 Column-1 of Next Page

<P><LI>Application Exception in Snaprint.exe with STO
<P>
</OL> 

<OL><P><LI>Carriage Return (0x0D) Not Interpreted Correctly with 5250 Printing
<P>
</OL><h2>SYMPTOMS</h2>
 
<P>
Sending the following sequence to the 5250 Print Service (J version)
<P>
<PRE>   "AAAA"+CR+LF+"BBBB"+NL (interpreted to ASCII for clarity)

</PRE></OL>Will result in:
<P>
<PRE>   AAAA
       BBBB

</PRE>The expected result is:
<P>
<PRE>   AAAA
   BBBB

</PRE> 

<OL><P><LI>Print Server Doesn't Send Form Feed (FF) When NL or LF Is on Last Line
<P>
</OL><h2>SYMPTOMS</h2>
 
<P>
When using the SNA Server Print Server (J version) to print to an AS/400,
and a new line (NL) or line feed (LF) character is on the last line of
the printable area, a form feed (FF) is not generated. Therefore, any
remaining printable text is not printed on the next page.
<P>
 

<OL><P><LI>Last Line Doesn't Print When Using SNA Server Print Server
<P>
</OL><h2>SYMPTOMS</h2>
 
<P>
When using the SNA Server Print Server (J version) to print to an AS/400,
the last line may not print. The SNA Server Print Server (J version) does
not correctly flush the write buffer for an end-of-page.
<P>
 

<OL><P><LI>SNA Server Print Server Ignores the First LF and NL
<P>
</OL><h2>SYMPTOMS</h2>
 
<P>
SNA Server Print Server ignores the first line feed or new line it comes
across.
<P>
 

<OL><P><LI>Problem with PrintPosition (AbsoluteHorizontalMove)
<P>
</OL><h2>SYMPTOMS</h2>
 
<P>
The following is a sample datastream (converted to ASCII for ease of
readability):
<P>
<PRE>   "AAAAA"+LF+PP(AHM 3)+"BBBB"+NL

</PRE></OL>The expected result is:
<P>
<PRE>   AAAAA
      BBBBB

</PRE>The actual result is:
<P>
<PRE>   AAAAA

   ("BBBB" was not printed.)

</PRE> 

<OL><P><LI>Added Support for Thick Dotted Line, SHF, SPCC, and STO
<P>
</OL><h2>SUMMARY</h2>
 
<P>
The following features have been added to DBCS printing in the SNA Server
3.0 J version:

<UL><LI>Support for Thick Dotted Line.

<LI>Support for the Set Horizontal Format (SHF) SCS command to support
   Max Print Position (MPP).

<LI>Support for the Set Presentation of Control Character (SPCC) command, to
   support the presentation of control characters (SI/SO).

<LI>Support for the Set Text Orientation (STO) command, to rotate a DBCS
   character.
<P>
</UL>These changes were made to the DBCS environment, and do not include SBCS.
<P>
 

<OL><P><LI>FF Command Is Not Positioned at Line-1 Column-1 of Next Page
<P>
</OL><h2>SYMPTOMS</h2>
 
<P>
The following is a sample datastream:
<P>
Sent data:
<P>
<PRE>   "12345" (NL) "67890" (FF) "ABCDE"
   (NL:New Line)

</PRE></OL>The following is the result:
<P>
<PRE>   &lt;Page 1&gt;
   12345 &lt;line 1&gt;
   67890 &lt;line 2&gt;

   &lt;Page 2&gt;
     &lt;line 1&gt;
       ABCDE   &lt;line 2&gt;

</PRE>Notice the ABCDE is indented to the right; it should be left justified.
<P>
 

<OL><P><LI>Application Exception in Snaprint.exe with STO
<P>
</OL><h2>SYMPTOMS</h2>
 
<P>
When printing to an AS/400 using SNA Server 3.0 Print Server and selecting
a DBCS character set, a general protection fault (GPF) occurs if you send a
print job with STO in its datastream.
<P>
The GPF is in the following function:
<P>
<PRE>   WinVPRTSetTextOrientation within SNAPrint.exe.

</PRE></OL>The following is the assembler call:
<P>
<PRE>   cmp     byte ptr [edx],0x40          ds:00000000=??

</PRE> 
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve these problems, obtain the hotfix mentioned below.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 3.0.
This problem was corrected in the latest Microsoft SNA Server 3.0 U.S.
Service Pack. For information on obtaining the service pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug3.00 kbfix3.00.sp1 kbprint snaprintservice<BR>
Version             : 3.0<BR>
Platform            : WINNT<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
