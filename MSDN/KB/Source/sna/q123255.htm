

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WFW 3.11 Fails to Connect to SNA Server on Windows NT 3.5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123255">
<META NAME="KBModify" CONTENT="1996/06/18">
<META NAME="KBCreate" CONTENT="1994/11/28">
<META NAME="Keywords" CONTENT="kbnetwork kbinterop kbbug3.50">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  After upgrading an SNA Server computer from Microsoft Windows NT version 3.1 to Windows NT version 3.5 or 3.51, Microsoft Windows for Workgroups version 3.11 client computers fail to connect to SNA Server:     SNA Server Error: 546    Cannot establ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWO,QARL,QDNL,QDL9,QBWQ,QBWN,QAI5,QAC1,QAXB,QAKP,QAJ4,QBWD,QAUJ,QBD2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WFW 3.11 Fails to Connect to SNA Server on Windows NT 3.5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123255</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, and 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After upgrading an SNA Server computer from Microsoft Windows NT version
3.1 to Windows NT version 3.5 or 3.51, Microsoft Windows for Workgroups
version 3.11 client computers fail to connect to SNA Server:
<P>
<PRE>   SNA Server Error: 546
   Cannot establish connection with SNA Server &lt;server name&gt;.

</PRE><h2>CAUSE</h2>
 
<P>
The Microsoft IPX/SPX compatible transport (NWLink) is installed by default
with Microsoft Windows for Workgroups 3.11. When you configure the SNA
Server client to use the "MS Network Client (named pipes)" interface, the
NWLink transport is automatically used. This works fine with a Windows NT
3.1 server.
<P>
Under Windows NT 3.5, a new feature, direct hosting, was added to improve
performance. This allows a Windows for Workgroups client to communicate
directly with the server over IPX/SPX, rather than over NetBIOS. However,
applications which use named pipes do not work correctly over direct-hosted
IPX/SPX connections.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To resolve this problem, add the following entry to the [network] section
of SYSTEM.INI on the Windows for Workgroups 3.11 client computer:
<P>
<PRE>   [network]
   DirectHost=NO

</PRE>The client workstation must be rebooted for this change to take effect.
<P>
Microsoft provides updated Windows for Workgroups 3.11 client modules on
the Windows NT 3.5 CD-ROM, though the updated modules do not solve the
direct hosting problem. However, other named pipes applications (such as
SQL Server) work fine with these updates.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.5. We
are researching this problem and will post new information here as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbinterop kbbug3.50 kbbug3.51<BR>
KBSubcategory: ntdistrib ntnetserv<BR>
Additional reference words: directhosting wfw wfwg prodsna 2.00 2.10 2.11<BR>
nwlink<BR>
DirectHost 3.50 3.51<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
