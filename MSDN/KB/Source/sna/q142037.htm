

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SNA Server Fails to Release Memory in SNA TCP/IP Interface DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142037">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/01/03">
<META NAME="Keywords" CONTENT="kbbug2.10 kbbug2.11 kbnetwork ntnetserv">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  A Windows NT Server running SNA Server 2.11 slows down when running SNA Server clients that use TCP/IP.  This problem occurs sporadically.  CAUSE =====  An SNA Server Service internal trace shows that SNA Server TCP/IP asynchronous writes are not c...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDNT,QAI5,QBG2,QAGB,QBWD,QAPN,QAO4,QDO3,QBJQ,QAKJ,QAKP,QBVX,QBVV,QBB0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server Fails to Release Memory in SNA TCP/IP Interface DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142037</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.1 and 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Windows NT Server running SNA Server 2.11 slows down when running SNA
Server clients that use TCP/IP.
<P>
This problem occurs sporadically.
<P>
<P><h2>CAUSE</h2>
 
<P>
An SNA Server Service internal trace shows that SNA Server TCP/IP
asynchronous writes are not completing. These pending writes continue to
consume system memory. The SNA Server client configured for TCP/IP may
continuously attempt to open a session with the SNA Server. The SNA Server
tries to send a response but the write never completes and is unable to
release the i/o (input/output) buffer memory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
SNAIP.DLL now aborts a connection if the connection has more than 100
pending writes queued. Every time a connection is aborted, an event 706 is
logged in the application log:
<P>
<PRE>   Event Id: 706

   Description:
   Connection to client %2 has been aborted due to too many (%1) pending
   writes.

   Explanation

   SNA Server has aborted a TCP/IP connection because asynchronous writes
   queued on the connection have not completed.

   ACTION

   Provide network support personnel with the event log file(s) related to
   SNA, and SNA internal trace file(s). For information about SNA log and
   trace files, see the "Microsoft SNA Server Administration Guide."

</PRE>You can configure the abort limit by adding the MaxPendingWrites registry
parameter:

<OL><P><LI>Go to the HKEY_LOCAL_MACHINE subtree under the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\SnaBase\Parameters\SnaTcp
</PRE><P>
   If the SnaTcp subkey does not exist, it will need to be added it
   before going onto the next step.

<P><LI>Add the following information:
<P>
<P><PRE>      Value Name: MaxPendingWrites
      Data Type:  REG_DWORD
<PRE></PRE>      Data:       &lt;value&gt; (decimal)

   where &lt;value&gt; is by default 100 (decimal) with the updated SNAIP.DLL
   file (see below) installed.

</PRE></OL>Microsoft has updated the following files to correct this problem:
<P>
<PRE>   &lt;snaroot&gt;\SYSTEM\SNAIP.DLL
   &lt;snaroot&gt;\SYSTEM\SNAEVENT.DLL

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server for Windows NT.
This problem was corrected in the latest SNA Server for Windows NT, 2.11
U.S. Service Pack. For information on obtaining the Service Pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbbug2.10 kbbug2.11 kbnetwork ntnetserv<BR>
Version             : 2.1 2.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
