

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>APPC/5250 Hot Backup Fails if Configured for "On Demand" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139898">
<META NAME="KBModify" CONTENT="1996/02/01">
<META NAME="KBCreate" CONTENT="1995/11/19">
<META NAME="Keywords" CONTENT="kbnetwork kbbug2.00 kbbug2.10 kbbug2.11">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  A 5250 emulator that loses the AS/400 session due to a connection outage on a SNA Server gets the following error when you try to reestablish a session with the AS/400:     The connection to the AS/400 cannot be activated.     Primary Return Code =...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QDIU,QBWP,QBE4,QA3W,QAUR,QAKP,QDJ3,QDIZ,QAAP,QAUD,QAJ6,QAH4,QDO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>APPC/5250 Hot Backup Fails if Configured for "On Demand"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139898</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, and 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A 5250 emulator that loses the AS/400 session due to a connection outage on
a SNA Server gets the following error when you try to reestablish a session
with the AS/400:
<P>
<PRE>   The connection to the AS/400 cannot be activated.

   Primary Return Code = 0003
   Secondary Return Code = 00000004

</PRE><h2>CAUSE</h2>
 
<P>
When SNA Server is configured to use a default Local APPC LU, the hot
backup function for APPC/5250 does not give a Remote LU on a disabled
connection a lower priority than a Remote LU on an Inactive connection
which causes hot backup to fail. If only one of the connections is "Active"
and it fails, the other "On Demand" connections still have a lower priority
than the previously Active connection that has since failed. Since this
failed connection still has the higher priority, none of the On Demand
connections are activated. Therefore, hot backup fails and the 5250
emulator reports the error above.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has updated the following files to correct this problem:
<P>
<PRE>   Source files affected:

      \DCL\S1SRC\SLPRCHLU.C

   Binaries affected:

      &lt;snaroot&gt;\SYSTEM\SNASERVR.EXE
      &lt;snaroot&gt;\SYSTEM\TRCSERVR.EXE

</PRE>To work around this problem, SNA Servers that provide hot backup for
APPC/5250 sessions can have their AS/400 connections configured for "On
Server Startup" activation.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server for Windows NT.
This problem was corrected in the latest SNA Server for Windows NT, 2.11
U.S. Service Pack. For information on obtaining the Service Pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
If there are two or more SNA Servers in a domain that are configured to
provide Hot Backup for APPC/5250 sessions and those SNA Servers have
connections to an AS/400 that have a status of On Demand when viewed in SNA
Server Admin, the first 5250 emulator to request a session with the AS/400
forces one of these On Demand connections to become Active.
<P>
Subsequent 5250 sessions now use this Active connection to gain access to
the AS/400. If this Active connection fails, 5250 users that attempt to
reconnect to the AS/400 fail with the error described in the symptom
section.
<P>
If more than one of the SNA Servers in the domain have an Active connection
to the AS/400, 5250 users are able to reconnect to the AS/400 even if the
connection on the SNA Server that they were originally communicating
through fails.
<P>
For additional information on how to configure SNA Servers for hot backup
and load balancing, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SNA/Q128244.htm">Q128244</A></B>
   TITLE     : SNA Server Load Balancing and Hot Backup
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbbug2.00 kbbug2.10 kbbug2.11<BR>
KBSubcategory: ntnetserv<BR>
Additional reference words: prodsna 2.00 2.10 2.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
