

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 3.x APPC Application Fails with F002 (AP_TP_BUSY) Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137246">
<META NAME="KBModify" CONTENT="1996/04/24">
<META NAME="KBCreate" CONTENT="1995/09/24">
<META NAME="Keywords" CONTENT="kbnetwork kbprg kbbug2.00 kbbug2.10 kbbug2.11">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  The Microsoft SNA Server APPC Programmer's Reference documents the following reason for a primary return code of F002 (AP_TP_BUSY) error:     F002   AP_TP_BUSY     The Local TP has issued a call to APPC while APPC was processing another    call for...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QAB4,QAGI,QAUD,QBE7,QBE6,QAAP,QABI,QABH,QARL,QAJH,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 3.x APPC Application Fails with F002 (AP_TP_BUSY) Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137246</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, and 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft SNA Server APPC Programmer's Reference documents the
following reason for a primary return code of F002 (AP_TP_BUSY) error:
<P>
<PRE>   F002   AP_TP_BUSY

   The Local TP has issued a call to APPC while APPC was processing another
   call for the same TP. This may occur if the local TP has multiple
   threads, and more than one thread is issuing APPC calls using the same
   tp_id.

</PRE>However, this is not the only possible cause of this error when running the
Windows 3.x client. The SNA Server Windows 3.x APPC interface also returns
AP_TP_BUSY (primary return code = F002) to an application if it calls into
the APPC interface from a Windows procedure from SendMessage().
<P>
Applications that talk over the CPIC interface may also encounter this
problem because the CPIC API communicates over the APPC API. If this APPC
error is returned to the CPIC interface as a result of a CMINIT call, CPIC
returns Error 20 (product specific error) to the application. To see if
this error is occurring, SNA Server Windows 3.x CPIC and APPC API tracing
must be enabled. For additional information, please see the following
article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SNA/Q123256.htm">Q123256</A></B>
   TITLE     : Enabling SNA Server Windows 3.x Client Traces

</PRE>Some third party applications require do not run reliably on the SNA Server
Windows 3.x client software unless the TP_BUSY check is disabled. Wall Data
Rumba AS/400 Shared Folders requires that the TP_BUSY check is disabled.
<P>
<P><h2>CAUSE</h2>
 
<P>
This additional TP_BUSY check is done by the APPC interface to prevent a
possible deadlock within Windows.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Using the SNA Server 2.11 Windows 3.x client software, the following
parameter can be set in the [wnap] section of WIN.INI file to disable this
SendMessage check:
<P>
<PRE>   SendMessageCheck=NO

</PRE>The SNA Server Windows client process (WNAP) must be stopped and started
to enable this change.
<P>
WARNING: This parameter should be used with caution, since it can lead to
deadlocks from within Windows, depending on the other Windows applications
that are running on the computer.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has implemented this setting within the SNA Server 2.11 Windows
client software. SNA Server 2.0 and 2.1 customers should upgrade to SNA
Server 2.11.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbprg kb3rdparty kbbug2.00 kbbug2.10 kbbug2.11<BR>
KBSubcategory: ntnetserv<BR>
Additional reference words: prodsna 2.00 2.10 2.11 tp_busy F002<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
