

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TPSTART Enhanced to Support 16-bit Windows Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140609">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1995/12/04">
<META NAME="Keywords" CONTENT="kbbug2.10 kbbug2.11 kbnetwork ntnetserv snaappc snacpic snatp">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When you attempt to invoke a 16-bit Windows application with TPSTART.EXE, the invokable transaction program (TP) application program starter for SNA Server Windows NT clients, the following errors occur:   - On Windows NT 3.5:        16-bit Windows...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAIJ,QDL9,QBWQ,QBWO,QBWN,QAJH,QBWS,QA5E,QDIV,QBVV,QAAP,QAKP,QBXS,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>TPSTART Enhanced to Support 16-bit Windows Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140609</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, and 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to invoke a 16-bit Windows application with TPSTART.EXE,
the invokable transaction program (TP) application program starter for SNA
Server Windows NT clients, the following errors occur:

<UL><LI>On Windows NT 3.5:
<P>
<P><PRE>      16-bit Windows subsystem
      NTVDM encountered a system error. Access is denied
</PRE><P>
<P><PRE>      Choose close to terminate the app, or ignore to continue
</PRE><P>
   After pressing Ignore, this popup occurs 10-12 times. After choosing
   Ignore each time, the application finally starts. However, subsequent
   attempts to autostart the application fail.

<LI>On Windows NT 3.51:
<P>
<P><PRE>      TPSTART.EXE calls CreateProcess properly, but it receives an Error 5
      (ACCESS_DENIED).
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
TPSTART.EXE does not support the startup of 16-bit Windows applications.
<P>
The TPSTART.EXE program is setting the DETACHED_PROCESS flag when calling
CreateProcess, which causes the startup of 16-bit Windows applications to
fail with ACCESS_DENIED. This problem does not occur when starting 32-bit
Windows applications, even though the 32-bit application is not a detached
process.
<P>
Also, if the TP is configured as queued (with SNAServiceType=5), SNA Server
does not detect that the application has ended since the default Windows NT
virtual DOS machine (VDM) is still running. This causes a second invocation
of the TP to fail.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has updated the file &lt;snaroot&gt;\SYSTEM\TPSTART.EXE to correct this
problem.
<P>
To support autostarting of 16-bit Windows applications, the following new
TP-specific registry settings are now supported under the subtree
HKEY_LOCAL_MACHINE under the subkey:
<P>
<PRE>   /SYSTEM/CurrentControlSet/Services/SnaBase/Parameters/TPs/&lt;tpname&gt;/
   Parameters/

</PRE>Add following information:
<P>
<PRE>   Value Name: Win16App
   Data Type:  REG_SZ
   Data:       YES

</PRE>The following entry under the same subkey is also required to autostart 16-
bit Windows applications:
<P>
<PRE>   Value Name: SeparateWowVDM
   Data Type:  REG_SZ
   Data:       YES

</PRE>This causes TPSTART.EXE to start the 16-bit application in its own Windows
NT VDM. This entry is required if TP is queued (where SNAServiceType=5). If
the TP is configured as queued, and SeparateWowVDM is not set to YES, then
the TP is only invoked once. Subsequent attempts to start the TP fail,
because according to SNA Server the TP is still running, because SNA Server
finds that the Windows NT VDM (NTVDM) process ID is still running.
Starting a separate NTVDM corrects this problem because the NTVDM process
ends when the 16-bit Windows application ends.
<P>
<P><h2>STATUS</h2>
 
<P>
This feature is included in the latest U.S. Service Pack for SNA Server for
Windows NT, version 2.11. For information on obtaining the Service Pack,
query on the following word in the Microsoft Knowledge Base (without the
spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna appc cpic<BR>
Keywords            : kbbug2.10 kbbug2.11 kbnetwork ntnetserv snaappc snacpic snatp<BR>
Version             : 2.1 2.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
