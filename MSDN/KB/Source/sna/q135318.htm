

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Setup IBM CA/400 to Work Over the SNA 2.11 Win 3.x Client </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135318">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1995/08/20">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork ntnetserv ntprotocol sna3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  This article describes setting up Client Access 400 (CA400) with the SNA Server 2.11 or 3.0 Windows 3.x Client.  MORE INFORMATION  To install CA400, follow these steps:  1. Install the SNA Server Windows 3.x client software by running the Setup    ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBFY,QDIZ,QARL,QBWS,QBWO,QBWN,QA1S,QAIJ,QDL9,QBWQ,QBE7,QBE6,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Setup IBM CA/400 to Work Over the SNA 2.11 Win 3.x Client</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135318</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.11 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes setting up Client Access 400 (CA400) with the SNA
Server 2.11 or 3.0 Windows 3.x Client.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To install CA400, follow these steps:

<OL><P><LI>Install the SNA Server Windows 3.x client software by running the Setup
   program located in the \clients\win3x directory on the SNA Server 2.11
   or 3.0 CD-ROM.

<P><LI>Using Notepad or another text editor, edit the [WNAP] section of the
   WIN.INI file so that the following values are modified as shown:
<P>
<P><PRE>      CA400=YES
      CA400SharedFolders=YES
</PRE>
<P><LI>In the [SNAServerEHNAPPC] section, add the following entry:
<P>
<P><PRE>      LocalLU=&lt;localLU&gt;
</PRE><P>
   The Local APPC LU alias can be found in SNA Server Admin. configured off
   the SNA Server service.  This Local LU must be partnered with a Remote
   APPC LU associated with your AS/400 that is running OS/400 V3R1 or
   later.
<P>
   The &lt;localLU&gt; parameter needs to be in all capital letters or several
   errors may occur.

<P><LI>Install the IBM Client Access/400 shared folders feature from the
   installation disks by running the INSTALL.EXE program.

<P><LI>After CA400 is installed, a dialog box appears telling you to restart
   Windows. Do NOT click OK! Instead, go to the \CAWIN directory and rename
   the following files:
<P>
<P><PRE>      rename EHNAPPC.DLL  EHNAPPC.IBM
      rename EHNRTRW.DLL  EHNRTRW.IBM
</PRE>
<P><LI>Return to the CA/400 dialog box and choose OK to allow CA/400 to restart
   Windows.

<P><LI>After restarting Windows, CA400's setup will continue. In the dialog box
</OL>that appears, select the "Connect Type" as None. Choose OK. If installing
v3.r1.m1 of CA/400, select "Other Router". You will then be prompted for a
server name. Specify the Remote LU Name you assigned in SNA Server
configuration.

<OL><P><LI>After selecting OK, CA400 Setup will inform you that you need to restart
   Windows again because the configuration has changed. Do it.

<P><LI>After restarting, go into the CA400 folder and run the SETUP icon. You
   should see the SNA Server Windows 3.x client icon (WNAP.EXE) start up
   automatically. At this point, CA400 will attempt to log you into ANY
   AS400's you have configured thru SNA Server Admin. If the dialog box
   that comes up is pointing to an AS400 that is NOT running OSV3R1 (or
   better), press cancel. Do this until the dialog presents an AS400 that
   is running OSV3R1. At this point, enter the common user ID/Password for
   that system.

<P><LI>With Client Access Setup open on your screen, select the icon for the
   Rumba/400 install. When you select this option, CA400 will install
   Rumba/400 from the AS400 to your client.
<P>
</OL>The following information is for reference purposes only. It shows the
changes that may be made to system files. This may vary depending on what
options you have chosen on your client.
<P>
<P><h2>PCS.INI</h2>
 
[PCS/400]
INITCFG=NO
GROUP=INS
RUMBA=INS
<P>
[Shared Folders]
SFLR01=1,I
<P>
[UPDT]
UPDT01=I:\QPWXCWN,C:\CAWIN,S,,,Client Access/400
UPDT02=I:\QPWXCRB\,C:\RUMBACAW,S,,,RUMBA/400
<P>
[NETWORK]
I:=0
<P>
[ADVANCED]
ExtraFunction=No
<P>
<P><h2>NSD.INI</h2>
 
[Configuration]
LANGUAGE=2924
DIRECTORY=C:\CAWIN
COMMONUSERID=
LOCALLUNAME=
DLCTYPE=NonNSWin
RTDN=
<P>
[MODES]
QPCSUPP=*, 2, 32, 16
QSERVER=*, 2, 32, 16
SNASVCMG=256, 1, 2, 1
BLANK=,2, 8, 4
#BATCH=256, 3, 8, 4
#INTER=, 7, 8, 4
<P>
<P><h2>WIN.INI</h2>
 
[SnaServerEHNAPPC]
LocalLu=DONALD
DILBERT=SNA
<P>
[Wnap]
WBinPath=C:\SNA.WIN
Remote=DISNEYWORLD
LocalFlag=LOCAL
NosType=LANMAN
NosSetup=WFW
NetSetup=NO
CA400=YES
CA400SharedFolders=YES
<P>
[CAWIN]
EHNP=C:\CAWIN
EHNL=2924
<P>
[CAMAPI]
HLL=C:\RUMBACAW\EEHLLAPI.DLL
<P>
<P><h2>SYSTEM.INI</h2>
 
[386Enh]
device=C:\CAWIN\VREFLECT.386
device=C:\CAWIN\VNSWUTIL.386
device=C:\CAWIN\VNCD.386
<P>
<P><h2>AUTOEXEC.BAT</h2>
 
Autoexec.bat
C:\DOS\SMARTDRV.EXE /L /X 2048 128
LH /L:1,40688 C:\DOS\MSCDEX.EXE /S /d:aspicd0 /m:12
@ECHO OFF
PROMPT $P$G
path c:\wfw311;c:\dos;C:\SNA.WIN;C:\RUMBACAW;c:\CAWIN;
SET TEMP=C:\TEMP
C:\WFW311\net start
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbinterop kbnetwork ntnetserv ntprotocol sna3rdparty<BR>
Version             : 2.11 3.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
