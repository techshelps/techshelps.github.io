

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Client Functions Can't Use TCP/IP Sockets on SNA Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165705">
<META NAME="KBModify" CONTENT="1997/04/14">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="kbbug2.11.sp1 kbbug3.00 kbfix3.00.sp1 kbnetwork prodsna snaadmin snamanager snawinnt">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When running SNA Admin, SNA Manager, or any SNA applications on an SNA Server, the Admin/Manager program or SNA application always uses named pipes when communicating to other SNA Servers in the subdomain. There is no way to force SNA Admin or the ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAUJ,QAJ4,QDNT,QASC,QAKJ,QAH6,QBWD,QARL,QAY5,QAXB,QAHT,QBVX,QBQU,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Client Functions Can't Use TCP/IP Sockets on SNA Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165705</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 2.11 Service Pack 1, 2.11 Service
   Pack 2, and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When running SNA Admin, SNA Manager, or any SNA applications on an SNA
Server, the Admin/Manager program or SNA application always uses named
pipes when communicating to other SNA Servers in the subdomain. There is no
way to force SNA Admin or the SNA application to use a non-named pipe
transport (such as TCP/IP sockets or IPX/SPX).
<P>
<P><h2>CAUSE</h2>
 
<P>
When initiating client functions from an SNA Server, the DMOD would always
choose the first LAN transport configured, which always defaults to
Microsoft Networking named pipes (Snalm.dll), even when named pipes is not
selected during SNA Server Setup. The named pipe transport is always used
on the SNA Server, because this transport supports file access to the
shared SNA Server configuration file, which is always performed over
Microsoft Networking.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Updates to SNA Server versions 2.11 (post Service Pack 2) and 3.0 are
available to correct this problem. With this update applied on an SNA
Server, SNA Server Admin (and other client functions) can now use TCP/IP
sockets or other non-named pipe transport methods to communicate with other
SNA Servers in the SNA subdomain.
<P>
Within SNA Server Setup, the administrator defines what client LAN
transports the server will support. If both named pipes and TCP/IP sockets
are chosen, then the following registry value must be added to allow SNA
Admin (or any SNA application running on the SNA Server) to use TCP/IP
sockets instead of named pipes:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SnaBase\Parameters

   Value Name:  TransportBase
   Data Type:  REG_DWORD

   Data: 1

</PRE>NOTE: The first TransportBase is 0 which always points to Snalm.dll.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 2.11,
2.11 Service Pack 1, 2.11 Service Pack 2, and 3.0.
This problem was corrected in the latest Microsoft SNA Server 3.0 U.S.
Service Pack. For information on obtaining the service pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug2.11.sp1 kbbug3.00 kbfix3.00.sp1 kbnetwork prodsna snaadmin snamanager snawinnt<BR>
Version             : 2.11.sp1 2.11.sp2 3.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
