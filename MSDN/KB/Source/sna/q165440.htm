

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Shared Folders Gateway Only Shows Root Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165440">
<META NAME="KBModify" CONTENT="1997/04/14">
<META NAME="KBCreate" CONTENT="1997/03/19">
<META NAME="Keywords" CONTENT="kbbug3.00 kbfix3.00.sp1 kbnetwork prodsna snasharedfolders">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When the drive assigned to a shared folder is viewed in File Manager or Windows Explorer, only the root directory is shown. This was originally reported on the 120-day evaluation version of SNA Server 3.0, but may occur on the retail version as wel...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QAFI,QA3A,QAA1,QDI2,QBXB,QBVW,QATJ,QAIJ,QAC2,QDO3,QBWP,QBIC,QA0K,QAVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Shared Folders Gateway Only Shows Root Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165440</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the drive assigned to a shared folder is viewed in File Manager or
Windows Explorer, only the root directory is shown. This was originally
reported on the 120-day evaluation version of SNA Server 3.0, but may occur
on the retail version as well.
<P>
The Browse feature of the Shared Folders Gateway properties page will
successfully display all of the folders.
<P>
<P><h2>CAUSE</h2>
 
<P>
Snanls.dll was not installed unless the SNA Server Print Service was also
installed. Snanls.dll does EBCDIC to ASCII translation. Here is the sample
failing trace showing a folder name query to be "aoooooooo.ooo" ('.' is
incorrectly translated a 'K' in SNA Server trace):
<P>
<PRE>|000000ba.0000004c DLC    ----------------------------------------------
</PRE>14:40:06.79
<PRE>|000000ba.0000004c DLC    01020101-&gt;06160000 DLC DATA
|000000ba.0000004c DLC                       DAF:02 OAF:01 ODAI:off Normal
|000000ba.0000004c DLC                       RQE FMD BC EC DR1 CD
</PRE>|000000ba.0000004c DLC
<PRE>|000000ba.0000004c DLC    ---- Header  at address 014A43B0, 1 elements ----
|000000ba.0000004c DLC    07050004 00002C00 02010006 0100B700
</PRE>&lt;......,.........&gt;
|000000ba.0000004c DLC
<PRE>|000000ba.0000004c DLC    ---- Element at address 0199C11C, start 10, end
</PRE>92 ----
<PRE>|000000ba.0000004c DLC    03902000 50D00101 00004A10 09001111     &lt;..
</PRE>.P.....J.....&gt;
<PRE>|000000ba.0000004c DLC    0E616F6F 6F6F6F6F 6F6F4B6F 6F6F0006
</PRE>&lt;.aooooooooKooo..&gt;
<PRE>|000000ba.0000004c DLC    11FB0001 00061116 00400005 1133F100
</PRE>&lt;.........@...31.&gt;
<PRE>|000000ba.0000004c DLC    051132F1 00141102 113A112B 11661194
</PRE>&lt;..21.....:.+.f.m&gt;
<PRE>|000000ba.0000004c DLC    11321133 110E1110 00051101 00000611
</PRE>&lt;.2.3............&gt;
<PRE>|000000ba.0000004c DLC    10002A                                  &lt;..*
&gt;

</PRE>Here is an example of the successful case showing the query for the folder
name being "/????????.???". In this case Snanls.dll was copied to the
&lt;Snaroot&gt;\System directory:
<P>
DLC   ---------------------------------------------------------------------
 
DLC   01020101-&gt;04160000 DLC DATA
<PRE>DLC                      DAF:01 OAF:01 ODAI:off Normal
DLC                      RQE FMD BC EC DR1 PI CD
DLC
</PRE>DLC   ---- Header  at address 014242E0, 1 elements ----
<PRE>DLC   0705B006 00002C00 01010008 0100AA00     &lt;......,.........&gt;
DLC
</PRE>DLC   ---- Element at address 0191C11C, start 10, end 92 ----
<PRE>DLC   03912000 50D00101 00004A10 09001111     &lt;.j .P.....J.....&gt;
DLC   0E2F3F3F 3F3F3F3F 3F3F2E3F 3F3F0006     &lt;./????????.???..&gt;
DLC   11FB0001 00061116 00400005 1133F100     &lt;.........@...31.&gt;
DLC   051132F1 00141102 113A112B 11661194     &lt;..21.....:.+.f.m&gt;
DLC   11321133 110E1110 00051101 00000611     &lt;.2.3............&gt;
DLC   10002A                                  &lt;..*             &gt;

</PRE>NOTE: The Browse button in the Shared Folders Property page will retrieve
the folder names because the EBCDIC to ASCII translation is done internally
in that particular component. It does not rely on Snanls.dll.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, install the Print Server feature.
<P>
The final resolution has two parts:

<UL><LI>Setup was modified to always install Snanls.dll.
<P>
 -and-

<LI>Shared folders gateway now reports an error if the call to SNANLS fails.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 3.0.
This problem was corrected in the latest Microsoft SNA Server 3.0 U.S.
Service Pack. For information on obtaining the service pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug3.00 kbfix3.00.sp1 kbnetwork prodsna snasharedfolders<BR>
Version             : 3.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
