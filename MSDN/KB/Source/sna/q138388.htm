

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dynamically Loading/Unloading WINRUI32.DLL Causes System Hang </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138388">
<META NAME="KBModify" CONTENT="1996/02/01">
<META NAME="KBCreate" CONTENT="1995/10/18">
<META NAME="Keywords" CONTENT="kbnetwork kbinterop kbprg kbbug2.00 kbbug2.10 kbbug2.11">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When you dynamically load and unload the WINRUI32.DLL, your computer hangs. This symptom occurs sporadically.  CAUSE =====  This problem occurs during a call to FreeLibrary (hLibModule) where hLibModule was previously set to the result of a call to...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBWP,QDJO,QAR4,QDNN,QAIF,QAEF,QDO3,QBSO,QAY0,QAO4,QAM5,QAJ6,QAKP,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Dynamically Loading/Unloading WINRUI32.DLL Causes System Hang</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138388</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft SNA Server versions 2.0, 2.1, and 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you dynamically load and unload the WINRUI32.DLL, your computer hangs.
This symptom occurs sporadically.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs during a call to FreeLibrary (hLibModule) where
hLibModule was previously set to the result of a call to LoadLibrary
(WINRUI32.DLL).
<P>
The hang occurs when the WINRUI32.DLL is unloaded by the FreeLibrary()call.
The hang is caused by WINRUI32.DLL trying to remove its DMOD routing
procedure during DLL detach processing. There are certain procedures that
cannot be reliable performed inside detach processing, for example, waiting
for something like the DMOD routing proc table to become available.
<P>
Existing applications that do not call WinRUIStartup/WinRUICleanup continue
to function as before.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has updated the file LIBS\WIN32WINRUI32.DLL to correct this
problem.
<P>
The fix to the WINRUI32.DLL removes the RUI routing procedure during the
processing of the WinRUICleanup() call and ensures that the DLL detach
processing does not attempt to do it again. To properly load and unload the
DLL you need to always call WinRUIStartup before your first RUI verb and
WinRUICleanup before freeing the WINRUI32.DLL.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server for Windows NT.
This problem was corrected in the latest SNA Server for Windows NT, 2.11
U.S. Service Pack. For information on obtaining the Service Pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbinterop kbprg kbbug2.00 kbbug2.10 kbbug2.11<BR>
KBSubcategory: ntnetserv ntprotocol<BR>
Additional reference words: prodsna 2.00 2.10 2.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
