

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SNARAS Receives 651 RAS Error After Failed Connection Attempt </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162594">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/01/24">
<META NAME="Keywords" CONTENT="kbbug2.00 kbbug2.10 kbbug2.11 snaras kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  You may want to use the NETBIOS interface made available in SNARAS to employ Microsoft networking over your existing SNA network, which consists mainly of 9600 SDLC multidrop links. This would allow you to use Systems Management Server remote contr...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAJ4,QAI5,QAAP,QAVZ,QBWP,QBG2,QAMR,QAGB,QA5E,QAU3,QAKP,QAE2,QDJZ,QA7Y V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNARAS Receives 651 RAS Error After Failed Connection Attempt</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162594</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 2.0, 2.1, 2.11, and 2.11 Service Pack 1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may want to use the NETBIOS interface made available in SNARAS to
employ Microsoft networking over your existing SNA network, which consists
mainly of 9600 SDLC multidrop links. This would allow you to use Systems
Management Server remote control facilities and manage your computers
running Windows NT Server through the Windows NT Administrative Utilities
and the SNA Administrator UI.
<P>
However, implementing SNARAS over slow SDLC links on WAN networks can
result in the following errors. When the SNARAS connection is dialed using
the remote access client phonebook, after 10 seconds or so the following
error message appears:
<P>
<PRE>   Error 629
   Port was disconnected by remote machine.

</PRE>At this point, you have the option to cancel or retry. If you click Retry,
after about 5 seconds the following error message may appear:
<P>
<PRE>   Error 651
   Your modem or other connecting device has reported an error.

</PRE><h2>CAUSE</h2>
 
<P>
The very low network bandwidth being used is insufficient to host the
complex protocols employed to achieve Microsoft networking. The low
bandwidth is further eroded as peer entities in all the protocol stacks
being used time out request and initiate their retransmission routines.
<P>
The problem ultimately is the low bandwidth of the end-to-end connection,
which can be as low as 120 KBps as a result of a mixture of low speed SDLC
links between FEPs and other SNA traffic over the same links. SNARAS
provides a guaranteed delivery, but RAS "believes" that it is not
guaranteed and this level of bandwidth is too low for RAS to use.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Upgrade slow links to links that can adequately handle NetBIOS/Server 
Message Block (SMB) traffic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Within the SNARAS components connection timeouts can be seen by employing
the checked versions of Snaras.dll and Rassna.dll to produce internal
tracing, as demonstrated below:
<P>
<P><h3>RASSNA.DLL internal tracing</h3>
 
66:d5 RasSna1 SriBindOutgoingComplete: issue connect
66:d5 RasSna1 SriConnect: sent OK
66:d5 SriCallback - message 0x14B378 type 259 rc 9
66:d5 RasSna1 SriConnectComplete: rc=9
66:d5 RasSna1 SriConnectComplete: failed, rc=9
66:d5 RasSna1 SriConnectComplete: setting event 000001A4
66:b6 RasSna1 DeviceWork: Entered
66:b6 RasSna1 DeviceWork: resetting event 000001A4
66:b6 RasSna1 DeviceWork: LastError = 651
66:b6 RasSna1 DeviceWork: Exit rc=651
<P>
<P><h3>SNARAS.DLL internal tracing</h3>
 
66:d5 ProcessAPPCWork - Outstanding verbs on conv 0
66:d5 RAS_LINE_CONNECTING
66:d5 RECEIVEANDWAIT complete on AAR, rc1 0, rc2 0
66:d5 RAWComplete - connect error so terminate line
66:d5 TermLine - start terminate on line AA
66:d5 Client, Send TP id=03000000A03A1700
66:d5 IssueTPEnded - issue TP Ended type 1 on AAS
<P>
However, these failures occur as a result of an underlying network failure
which can be seen if RAS PPP logging is enabled. The logs will show PPP
packets get received  a very long time after they are sent, causing PPP LCP
to come down and re-negotiate. So LCP goes up and down for a long time
until it disconnects. This is called a cross connection.
<P>
Although there are Microsoft Knowledge Base articles that describe how to
tune timing parameters in the network protocols right up to SMB layer,
Microsoft network architecture is not designed to work over networks
offering such low bandwidth.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords          : kbbug2.00 kbbug2.10 kbbug2.11 snaras kbnetwork<BR>
Version           : 2.0 2.1 2.11<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
