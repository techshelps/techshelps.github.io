

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SNA Server Does Not STSN Sequence Numbers On Positive </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163210">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1997/02/05">
<META NAME="Keywords" CONTENT="kbbug2.00 kbbug2.11 kbnetwork snalua snaprog snaserverservice kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  An SLI application can register a SLI_STSN_ROUTINE to handle the STSN (Set and Test Sequence Numbers) command from the host PLU. When the SLI application returns a positive response, SNA Server does not echo back the sequence numbers indicated in t...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKC,QAR4,QBC6,QAA7,QAB7,QBXS,QAVX,QAVW,QAIJ,QAG8,QAC2,QBVV,QAGI,QBWD,QDO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server Does Not STSN Sequence Numbers On Positive</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163210</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, 2.11, 2.11 SP1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An SLI application can register a SLI_STSN_ROUTINE to handle the STSN (Set
and Test Sequence Numbers) command from the host PLU. When the SLI
application returns a positive response, SNA Server does not echo back the
sequence numbers indicated in the STSN host request.
<P>
You may want SNA Server to send the SNA sequence numbers on every STSN
response (positive or negative). SNA Server only returns the sequence
numbers in the case of a TEST NEGATIVE response.
<P>
<P><h2>CAUSE</h2>
 
<P>
SNA Server does not echo back the sequence numbers in the positive case.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
An update to SNA Server 2.11 Service Pack 1 is available to correct this
problem.  The updated modules include:
<P>
<PRE>   &lt;snaroot&gt;\SYSTEM\SNASERVR.EXE
   &lt;snaroot&gt;\SYSTEM\WINRUI32.DLL

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 2.0,
2.1, 2.11 and 2.11 SP1 (this problem is fixed in SNA Server 3.0).
A supported 2.11 fix is now available, but has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Technical Support for more information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Annotated SNA Server DLC message traces are included below; these describe
two scenarios where SNA Server fails to echo STSN sequence numbers on
positive response.

<OL><P><LI>When the host sends an STSN with the SET, SET options, to which SNA
   Server responds with TESTPOS, TESTPOS. This is correct; however, SNA
   Server does NOT echo back the sequence numbers in the response.
<P>
</OL>Host issues STSN REQUEST: SET,SET,37,0
<P>
<PRE>   DLC    ---------------------------------------------- 10:35:57.17
   DLC    01161000-&gt;0A020101 DLC DATA
   DLC                       DAF:02 OAF:01 ODAI:off Exp.
   DLC                       STSN   RQD SC  FI BC EC DR1
   DLC
   DLC    ---- Header  at address 00D14174, 1 elements ----
   DLC    06060100 00002D00 02010A88 01000D01     &lt;......-....h....&gt;
   DLC
   DLC    ---- Element at address 0120FB48, start 10, end 18 ----
   DLC    6B8000A2 50002500 00                    &lt;k..sP.%..       &gt;

SNA Server responds with STSN REPLY:   TESTPOS,TESTPOS,0,0

   DLC    ---------------------------------------------- 10:35:58.94
   DLC    0A020101-&gt;01161000 DLC DATA
   DLC                       DAF:01 OAF:02 ODAI:off Exp.
   DLC                       STSN   +RSP SC  FI BC EC DR1
   DLC
   DLC    ---- Header  at address 00D151E8, 1 elements ----
   DLC    0100880A 00012D00 01020A88 01000D01     &lt;..h...-....h....&gt;
   DLC
   DLC    ---- Element at address 0120EB50, start 10, end 18 ----
   DLC    EB8000A2 50000000 00                    &lt;...sP....       &gt;

</PRE><P><LI>When the host sends an STSN with the SET, SET &amp; TEST options, to which
  SNA Server responds with TESTPOS, TESTNEG. This is also correct; however,
  SNA Server only fills in the TESTNEG sequence number in the response.
<P>
</OL>Host issues STSN REQUEST: SET,SET&amp;TEST,44,27
<P>
<PRE>   DLC    ---------------------------------------------- 10:40:45.11
   DLC    01161000-&gt;0A020101 DLC DATA
   DLC                       DAF:02 OAF:01 ODAI:off Exp.
   DLC                       STSN   RQD SC  FI BC EC DR1
   DLC
   DLC    ---- Header  at address 00D156C8, 1 elements ----
   DLC    06060100 00002D00 02010A9A 01000D01     &lt;......-.........&gt;
   DLC
   DLC    ---- Element at address 0120EFE0, start 10, end 18 ----
   DLC    6B8000A2 70002C00 1B                    &lt;k..sp.,..       &gt;

SNA Server responds with STSN REPLY:   TESTPOS,TESTNEG,0,25

   DLC    ---------------------------------------------- 10:40:47.81
   DLC    0A020101-&gt;01161000 DLC DATA
   DLC                       DAF:01 OAF:02 ODAI:off Exp.
   DLC                       STSN   +RSP SC  FI BC EC DR1
   DLC
   DLC    ---- Header  at address 00D14B9C, 1 elements ----
   DLC    01009A0A 00012D00 01020A9A 01000D01     &lt;......-.........&gt;
   DLC
   DLC    ---- Element at address 012137BC, start 10, end 18 ----
   DLC    EB8000A2 70000000 19                    &lt;...sp....       &gt;
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbbug2.00 kbbug2.11 kbnetwork snalua snaprog snaserverservice kbbuglist<BR>
Version             : 2.0 2.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
