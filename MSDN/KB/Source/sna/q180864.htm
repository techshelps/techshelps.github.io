

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Print Sessions Stop with Host Print Service </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180864">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1998/02/10">
<META NAME="Keywords" CONTENT="prodsna snaprintservice kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWP,QAKC,QAKP,QA3S,QDN1,QACK,QDO3,QBC6,QA6A,QAO4,QAIJ,QABN,QBI8,QDJ3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Print Sessions Stop with Host Print Service</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180864</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 3.0, 3.0 SP1, 3.0 SP2
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a
Registry Key" Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An SNA Server computer using the Host Print service configured with a large
number of print sessions may experience problems starting print sessions.
When this occurs, print sessions may appear to stop responding or get stuck
in a Spooling status when attempting to start the session or sessions. This
problem may cause other symptoms as well.
<P>
NOTE: Due to the factors involved, there are no specifics on exactly how
many print sessions can be defined before this problem may occur.
<P>
CAUSE
 
<PRE>  
</PRE>There is a limit on the number of DCs (Device Contexts) that can exist on a
Windows NT Server computer at one time. The number of DCs that can be
created depends on a number of factors; therefore, a specific number cannot
be given. After the limit of DCs has been reached, the problem that occurs
when starting print sessions may become apparent.
<PRE>  
  
</PRE><h2>STATUS</h2>
 
<PRE>  
</PRE>Microsoft has confirmed this to be a problem in SNA Server versions 3.0,
3.0 SP1, and 3.0 SP2.
A supported fix is now available, but has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Technical Support for more information.
<P>
The updated modules are Winvprt.dll and Ppd5250.dll.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<PRE>  
</PRE>An update has been made to Host Print service so that it can be configured
to reject print jobs if there are already 30 (or a number configured in the
registry) DCs open and also to log an Event 21 to the Windows NT
Application event log. In this case, the SNA Print Server will return IBM
Sense Code 0x0814 (Bracket BID Reject - RTR Forthcoming) to the host when a
print job is rejected for this reason. The host should interpret this error
as meaning that the print job can be re-sent at a later time.
<PRE>  
</PRE>NOTE: The SNA Print service may reject print jobs for reasons other than
this, which would result in the same IBM sense code being returned to the
host.
<P>
If there is a need to control how many DCs the print server is allowed to
create, follow these steps:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.

<OL><P><LI>Apply the hotfix.
</OL>2. Start the Windows NT Registry Editor (Regedt32.exe) and find the
<PRE>   following key:
       
       HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SnaPrint
       \Parameters\
       
   Add the following entry to this key:
   
       Value Name: MaxGDISessions
       Data Type: REG_SZ
       String: &lt;value&gt;
  
  where value is 1 - 30.
  
</PRE></OL>In addition, the limit of 30 DCs is not applicable if the host print
sessions are configured to use a PDF file. Print sessions configured to use
a PDF file do not create DCs, and they do not make any other Graphical
Device Interface (GDI) calls.
<P>
 
<PRE>Keywords          : prodsna snaprintservice kbbuglist kbfixlist
Version           : WINDOWS:3.0,3.0SP1,3.0SP2
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
