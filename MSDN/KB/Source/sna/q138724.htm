

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Notes on Installing SNA Server on Citrix's OEM version of WinNT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138724">
<META NAME="KBModify" CONTENT="1997/11/05">
<META NAME="KBCreate" CONTENT="1995/10/25">
<META NAME="Keywords" CONTENT="snaadmin snamanager kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  The installation of Microsoft SNA Server on Citrix's OEM version of Windows  NT requires specific steps which are documented by Citrix. There are  specific requirements depending on whether SNA Server Version 2.11 or 3.0  will be installed.   The r...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QANE,QACK,QBTX,QDO3,QBVX,QBWS,QDIZ,QAGB,QDIV,QBWP,QACF,QAB9,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Notes on Installing SNA Server on Citrix's OEM version of WinNT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138724</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.11 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The installation of Microsoft SNA Server on Citrix's OEM version of Windows 
NT requires specific steps which are documented by Citrix. There are 
specific requirements depending on whether SNA Server Version 2.11 or 3.0 
will be installed. 
<P>
The required steps are documented in either the Help file that is included 
with the Citrix Winframe software or in application notes provided by 
Citrix. Additional information can also be located on Citrix's Website 
(www.citrix.com).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
SNA Server 2.11 (all service packs):
<P>
The following is an excerpt from the Winframe Help file and pertains only
to 2.11:
<P>
SNA Server and Client Installation
<P>
For the SNA Server-based installation on a WinFrame application server,
follow the instructions as described in the Microsoft SNA Server
Installation Guide.
<P>
However, installing on a WinFrame application server has an additional
caveat. There are three files that must be registered as system global.
Follow the procedures below:

<OL><P><LI>From the SNA Server Setup Finish dialog box, choose the Exit button.

<P><LI>From the Main Group, start an MS DOS Prompt.

<P><LI>   REGISTER SNADMOD.DLL /SYSTEM
<P><PRE>      REGISTER SNAMANAG.DLL /SYSTEM
      REGISTER SNAADMIN.EXE /SYSTEM
</PRE>
<P><LI>Type NET START SNABASE and press Enter.
<P>
</OL>Configuration
<P>
To configure the Microsoft SNA Server connection, LU and users, follow the 
instructions as described in the Microsoft SNA Server Administration Guide.
<P>
SNA Server 3.0 (all service packs):
<P>
Citrix WinFrame Version 1.6 or higher with Service Pack 5 and Hotfix 
SE165075 is required when using SNA Server 3.0.
<P>
There are three known issues when installing SNA Server 3.0 on Cirtrix 
Winframe 1.6.

<OL><P><LI>SNA Setup causes an exception in PROGMAN.EXE when Winframe Service Pack
   5 is installed.
</OL>2. Installation of SNA Server is very slow on WinFrame.
3. SNA system EXEs and DLLs must be registered system global in order to
<PRE>   run SNA Server.

</PRE></OL>To Install Microsoft SNA Server on a WinFrame Server
 
<P>
SNA Server is installed by executing the program SETUP.EXE on the SNA Server
compact disk. This is a 16-bit program that calls the actual 32-bit install 
program ACMSETUP.EXE. Because of a WinFrame performance tuning Registry 
entry, SETUP.EXE consumes nearly 100% of the CPU while running in the 
background Because of this, ACMSETUP.EXE does not receive enough CPU 
resources to complete in a timely fashion. The procedure below modifies the 
performance tuning parameters to allow SNA Server to install properly, and 
restores the settings after installation.

<OL><P><LI>Install WinFrame on your server hardware.
</OL>2. After installing WinFrame , obtain and apply WinFrame Service Pack 5. You
<PRE>   can download Service Pack 5 from the Citrix Web site:

      <B><A HREF="http://www.citrix.com">http://www.citrix.com.</A></B>

</PRE><P><LI>Obtain and apply WinFrame Hotfix WF160514. As of 08/13/97, use
   SE165075.EXE because it is the replacement hotfix for WF160514 which is 
   no longer on the FTP server. You can download hotfixes from the Citrix
   Web site. If you do not apply Hotfix WF160514 after applying Service
   Pack 5, the SNA Setup program will cause a trap in PROGMAN.EXE when you
   attempt to install SNA Server 3.0.
</OL>4. Log on as an administrator.
5. At a command prompt, type regedt32 and press Enter.
6. Locate the Registry key:
<P>
<PRE>   \\HKEY_LOCAL_MACHINE\SOFTWARE\Citrix\Compatibility\Applications\SETUP

</PRE><P><LI>Change the value MsgQBadAppSleepTimeInMillisec: REG_DWORD from 0 to 1.
</OL>8. Save the changes and exit the Registry Editor.
9. At a command prompt, enter the following commands:
<P>
<PRE>       change user /install
       setbuild /ms

</PRE><P><LI>Install Microsoft SNA Server and SNA Client according to the supplied
<P><PRE>    installation instructions in the SNA Server documentation.
</OL></PRE>11. At a command prompt, type regedt32 and press Enter.
12. Locate the Registry key:
<P>
<PRE>   \\HKEY_LOCAL_MACHINE\SOFTWARE\Citrix\Compatibility\Applications\SETUP

</PRE><P><LI>Change the value MsgQBadAppSleepTimeInMillisec: REG_DWORD from 1 to 0.
</OL>14. Save the changes and exit the Registry Editor.
15. Use change user /execute to return the session to execute mode.
16. Use Notepad (or another text editor) to create a batch file named
<PRE>    SNAREG.CMD that contains the following commands:

   @ECHO OFF
   REM *** SNAREG.CMD: Batch file to register SNA Server 3.0 ***
   REM *** files system global ***
   REGISTER %SNAROOT%\SNADMOD.DLL /SYSTEM
   REGISTER %SNAROOT%\SNAMANAG.DLL /SYSTEM
   REGISTER %SNAROOT%\WAPPC32.DLL /SYSTEM
   REGISTER %SNAROOT%\DBGTRACE.DLL /SYSTEM
   REGISTER %SNAROOT%\MNGBASE.DLL /SYSTEM
   REGISTER %SNAROOT%\SNATRC.DLL /SYSTEM
   REGISTER %SNAROOT%\SNALM.DLL /SYSTEM
   REGISTER %SNAROOT%\SNANW.DLL /SYSTEM
   REGISTER %SNAROOT%\SNAIP.DLL /SYSTEM
   REGISTER %SNAROOT%\SNABASE.EXE /SYSTEM
   REGISTER %SNAROOT%\SNASERVR.EXE /SYSTEM
   REGISTER %SNAROOT%\SNASII.DLL /SYSTEM
   REGISTER %SNAROOT%\SNALINK.DLL /SYSTEM

</PRE></OL>This file contains commands used to register some SNA executable files and
DLLs as system global. Save the file and exit Notepad.

<OL><P><LI>Before executing the SNAREG.CMD batch file, you must stop the SNABase
<P><PRE>    service or the batch file will not function properly. To stop the SNABase
    service:
</PRE><P>
  a) After installing SNA Server 3.0, run the Services application in Control
<P><PRE>     Panel. The Services dialog box appears.
</PRE>  b) Select the SNABase service in the Service list box and then click the
<P><PRE>     Startup button. The Service Startup dialog box appears.
</PRE>  c) Select Disabled in the Startup Type box and then click OK.
  d) Click the Close button in the main Services dialog box.
  e) Exit Control Panel. Shutdown and reboot the WinFrame server.
  f) Logon to WinFrame as an administrator.
  g) Start a command prompt session and execute the SNAREG.CMD batch file.
  h) After the SNAREG.CMD batch file has completed, run the Services
<P><PRE>     application in Control Panel. The Services dialog box appears.
</PRE>  i) Select the SNABase service in the Service list box and then click the
<P><PRE>     Startup button. The Service Startup dialog box appears.
</PRE>  j) Select Automatic in the Startup Type box and then click OK.
  k) Click the Close button in the main Services dialog box.
  l) Exit Control Panel. Shutdown and reboot the WinFrame server.

<P><LI>Configure SNA Server as required for your installation according to the
<P><PRE>    SNA Server 3.0 documentation.
</PRE><P>
</OL>The third-party products discussed here are manufactured by Citrix Systems, 
Inc., a vendor independent of Microsoft; we make no warranty, implied or 
otherwise, regarding these products' performance or reliability. 
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna snaadmin snadmod snamanag<BR>
Keywords          : snaadmin snamanager kbnetwork<BR>
Version           : 2.11 3.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
