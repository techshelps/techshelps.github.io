

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SNA Server and 2012 System Log Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134905">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/08/13">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When you use the SNA Server client named pipe interface to communicate with an SNA Server running on Windows NT Server 3.5, the following error may appear in the Windows NT system log:    Event ID: 2012   Source:   Srv   Description:  The server ha...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWO,QARL,QAUJ,QAAP,QAKP,QDL9,QBWQ,QBWN,QAB4,QAVZ,QBXS,QAA1,QDNL,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server and 2012 System Log Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134905</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.11
WINDOWS
<P>
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, and 2.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use the SNA Server client named pipe interface to communicate
with an SNA Server running on Windows NT Server 3.5, the following error
may appear in the Windows NT system log:
<P>
<PRE>  Event ID: 2012
  Source:   Srv
  Description:  The server has encountered a network error

</PRE>This error is logged by the Windows NT server service when an SNA Server
client named pipe session is lost unexpectedly. This error occurs more
readily with SNA Server named pipe-attached clients than it does with other
named pipe applications (such as SQL Server) because the SNA client
software always posts a named pipe read request against the server. If a
session error occurs with the read request outstanding, the Windows NT
server logs event 2012.
<P>
This error indicates that a client-server LAN session was lost, causing the
user to lose their SNA session. This article describes the most common
causes of this error.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Event 2012 commonly occurs when:

<UL><LI>You are using Windows for Workgroups 3.11 and have not installed update
   Windows for Workgroups files.
<P>
   There is named pipe disconnect problem in Windows for Workgroups 3.11.
   To correct this problem, upgrade to the Windows for Workgroups 3.11
   client files included on the Windows NT 3.5 or 3.51 CD-ROM.

<LI>Your client computer is running Windows NT 3.5 and you have not
   installed the fixed RDR.SYS file.
<P>
   When you use Windows NT 3.5 clients to communicate with SNA Server, a
   problem in the RDR.SYS file can cause the network session to be lost
   when exiting an SNA Server Windows NT client application. To correct
   this problem, upgrade to Windows NT 3.51, or install the latest U.S.
   Service Pack for Windows NT 3.5.
<P>
   For information on obtaining the Service Pack, query on the following
   word in the Microsoft Knowledge Base (without the spaces):
<P>
   S E R V P A C K
<P>
   For more information on this problem, please see the following article
   in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../SNA/Q126451.htm">Q126451</A></B>
<PRE></PRE>      TITLE     : SNA Server: Windows NT Client Loses Session To Server

</PRE><LI>You turn off client computers
<P>
   If you turn off a client computer while an SNA Server named pipe session
   is active, error 2012 may be logged.

<LI>You have underlying network problems.
<P>
   As with any client-server LAN session, the session can be lost if there
   are underlying network problems occurring in the LAN. Problems can occur
   if there is a bridge fault, router fault, or media failure.
<P>
   To troubleshoot this problem, create a general network sniffer trace or
   Microsoft Network Monitor trace to determine whether underlying LAN
   errors are occurring. If so, identify and correct the problems.

<LI>You have a shortage of Windows NT 3.5 Server Message Block (SMB) buffer
   space.
<P>
   When you connect over 100 - 150 SNA Server clients using the Microsoft N
   Networking (named pipe) client interface, you may run out of Windows NT
   3.5 SMB buffer space.
<P>
   The Windows NT 3.5 Server service supports up to 512 maxworkitems.
   Maxworkitems are a server resource used to support data exchange with
   clients, including named pipe applications such as SNA Server. Because
   the SNA Server client software may have more than one named pipe session
   open with the server, and a read request is always posted on each named
   pipe, the Windows NT 3.5 server can run out of resources required to
   process the SNA Server named pipe client traffic. This can lead to slow
   SNA client performance and lost client sessions.
<P>
   NOTE: The Windows NT 3.5 server service normally sets the maxworkitems
   resource to 512 (decimal), the recommended setting for SNA Server, when
   the Windows NT Server is configured to "maximize throughput for network
   applications." However, due to a problem with the "NET CONFIG SERVER"
   command, it is possible that your MaxWorkItems registry setting is set
   to a value lower than 512, causing an SMB buffer shortage to occur. For
   more information on this problem, please see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../WINNT/Q128167.htm">Q128167</A></B>
<PRE></PRE>      TITLE:      Server Service Configuration and Tuning

   If the Windows NT 3.5 MaxWorkItems setting is already set to 512
   decimal, either of the following two workarounds may help you resolve
   the problem:

    - Switch the SNA Server clients to use an interface other than
      named pipes (for example, TCP/IP sockets). The new interface should
      not use the Windows NT server and should bypasses the need for work
      items. However, this workaround requires the SNA client user perform
      an additional login to the Windows NT server during SNA client
      startup. This is necessary to enforce Windows NT security.

      NOTE: Although SNA Server 2.1 does provide some capability to
      automate the additional client login, this functionality has been
      further enhanced in SNA Server 2.11. For more information, please see
      the following article in the Microsoft Knowledge Base:

         ARTICLE-ID: <B><A HREF="../SNA/Q130854.htm">Q130854</A></B>
         TITLE:      Automating the SNA Server Win 3.x Client Login Process

    - To connect larger numbers of SNA Server clients and continue using
      the named pipe interface, upgrade to Windows NT 3.51 so you can
      increase MaxWorkItems setting:

      WARNING: Using Registry Editor incorrectly can cause serious, system-
      wide problems that may require you to reinstall Windows NT to correct
      them. Microsoft cannot guarantee that any problems resulting from the
      use of Registry Editor can be solved. Use this tool at your own risk.

      1. Upgrade to Windows NT 3.51.

      2. Run Registry Editor (REGEDT32.EXE).

      3. From the HKEY_LOCAL_MACHINE subtree, go to the following key:

            \SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters

      4. Set MaxWorkItems to 4096:

            MaxWorkItems: REG_DWORD: 4096 (decimal)

      In simulated client testing, over 1500 SNA Server named pipe
      clients were able to connect to a single SNA Server using this
      setting.

      This registry setting must be manually set when using SNA Server 2.1.
      If SNA Server 2.11 is installed on a server running Windows NT 3.51,
      SNA Server 2.11 Setup sets this parameter to 4096.

      NOTE: SNA Server 2.11 also includes optimizations that reduces the
      memory allocation for named pipe connections, which lessen the use
      of Windows NT Server SMB buffers. However, Microsoft recommends you
      upgrade to Windows NT 3.51 to connect large numbers of SNA Server
      clients if the named pipes interface is required.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: prodsna 2.00 2.10 2.11 3.50 3.51 event viewer<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
