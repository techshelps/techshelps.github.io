

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Use of the %0\..\ Syntax in SMSLS.BAT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121387">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1994/10/04">
<META NAME="Keywords" CONTENT="kbnetwork smsconfig smshowto">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  When programs are run from a logon script, and they are located in the NETLOGON share, the actual logon script does not know what drive or path from which to execute the program, and the NETLOGON share is not included in the DOS path statement. To ...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBVV,QAY2,QBWS,QAI5,QA3A,QAH4,QAV1,QAV0,QAVZ,QADK,QAFI,QDOL,QBW7,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Use of the %0\..\ Syntax in SMSLS.BAT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121387</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1 and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When programs are run from a logon script, and they are located in the
NETLOGON share, the actual logon script does not know what drive or path
from which to execute the program, and the NETLOGON share is not included
in the DOS path statement. To resolve this, Systems Management Server
utilizes a little known feature of DOS to "determine" the drive and path
the script is running from.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
During a logon and when the logon script is running, the LMSCRIPT.EXE
program runs its commands from the NETLOGON share. However, batch files
have no way of determining where they are running from, and the current
directory set by LMSCRIPT.EXE is not the NETLOGON share.
<P>
As a workaround, Systems Management Server uses the %0\..\ path to indicate
the argv[0] present when the batch file was run. The batch file can then
refer to this path and know its own location and look for other files
there.
<P>
An example of this can be found in the Slow Network detection portion of
the SMSLS.BAT logon script file:
<P>
<PRE>   REM SNET_DOS
   %0\..\netspeed
   if not errorlevel 1 goto NET_DOS
   if not errorlevel 2 goto END
   if errorlevel 2 %0\..\choice /T:Y,30 Slow network detected. Continue
   if not errorlevel 2 goto NET_DOS
   goto END

</PRE>Prior to use of this technique, Systems Management Server was forced to use
a hard coded drive letter of Z: to reference needed files. Now the drive
used during a NET LOGON can be arbitrary, and dynamically determined.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sms prodsms login<BR>
Keywords            : kbnetwork smsconfig smshowto<BR>
Version             : 1.0 1.1 1.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
