

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Systems Management Server Detects a Windows Client </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140781">
<META NAME="KBModify" CONTENT="1997/04/23">
<META NAME="KBCreate" CONTENT="1995/12/06">
<META NAME="Keywords" CONTENT="kbnetwork smssetup">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Because of the wide variety in client configurations, Systems Management Server must use several methods of detecting if Windows is installed on the client, and where that installation is located. An additional step of detecting the exact Windows v...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAA1,QDL9,QBWQ,QBWN,QDI2,QDIZ,QARL,QABH,QABI,QAYL,QAGQ,QBWI,QBVV,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Systems Management Server Detects a Windows Client</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140781</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.1 and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Because of the wide variety in client configurations, Systems Management
Server must use several methods of detecting if Windows is installed on the
client, and where that installation is located. An additional step of
detecting the exact Windows version is also necessary.
<P>
Once client setup has set the operating system(s) and network types, only
these types are used by the inventory agent when reporting machine
inventory. Related to this, the network type of the client is solely
determined by the network type of the Systems Management Server logon
server the client was installed from.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Systems Management Server Client Setup (CLI_DOS.EXE) uses the following
steps:

<OL><P><LI>If SMS.INI already exists, the LocalWindowsPath and WindowsPath keys are
   checked. SharedWindowsPath may also be examined, and if Windows is
   running, a call to GetWindowsDirectory() is issued. Most existing
   installs are resolved in this step.

<P><LI>Use the WINDIR environment variable created by Windows. If it does not
   exist, Windows is not running and another detection method must be used.
   If found, much time is saved by not having to walk the search PATH any
   more.

<P><LI>For a local install of Windows, Setup checks along the path for WIN.INI
   and for shared Windows Setup checks for WIN.COM. Setup should succeed
   here in most cases.
<P>
   NOTE: Shared Windows is currently not supported by Systems Management
   Server, but a best effort has been made to contend with it.

<P><LI>As a last measure, Setup assumes the path is truncated due to a DOS
   environment problem, and Setup then takes the contents of the SMS_P
   environment variable (set in the SMSLS and RUNSMS scripts) and adds this
   string back into the PATH environment variable. Setup then goes back to
   step 3 and checks along the path.

<P><LI>Once Setup locates the Windows directory, it ensures that SYSTEM.INI
   exists in that location as a verification.

<P><LI>Assuming Setup finds WIN.INI or WIN.COM, Setup attempts to obtain the
   exact Windows type (Win16 vs. Windows for Workgroups) by trying to find
   WINVER.EXE which is located in the Windows directory. If WINVER.EXE is
   found Setup runs it and five bytes are read from offset 0x200 in the
   file.
<P>
</OL>The version information is also language specific, and the following
signatures are used to identify whether Windows or Windows for Workgroups
is installed. Note that Setup uses the language specific data not to
determine a language setting, but only to distinguish Windows from Windows
for Workgroups.
<P>
From the five bytes read from WINVER.EXE, bytes 3 and 4 contain the major
and minor version data. Byte 1 contains the following used for Windows
versus Windows for Workgroups detection:
<P>
<PRE>Windows 3.1 =  0x44         // Almost all languages
               0x54         // Chinese
               0x64         // Korean

Workgroups 3.11 =  0x2B   // Almost all languages
                   0x24   // Finnish
                   0x2C   // French
                   0x2D   // Hungarian
                   0x32   // Spanish

</PRE></OL>If you think there are problems detecting the Windows directory, ensure
that WIN.COM, WIN.INI, and WINVER.EXE are all available along the path.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms<BR>
Keywords            : kbnetwork smssetup<BR>
Version             : 1.1 1.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
