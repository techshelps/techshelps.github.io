

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Inconsistent CRC or Checksum Values on Large Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151224">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1996/05/20">
<META NAME="Keywords" CONTENT="kbusage smsadmin smsdocerr smshowto">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Large application executable files can return different cyclic redundancy check (CRC) values due to unique product identification stamping that occurs when the application is installed. To avoid this inconsistent result, you must provide an offset ...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QAIH,QAUD,QAJQ,QAE5,QALG,QAJH,QAKC,QAKH,QAA1,QBWS,QDI2,QAYY,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Inconsistent CRC or Checksum Values on Large Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151224</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.1 and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Large application executable files can return different cyclic redundancy
check (CRC) values due to unique product identification stamping that
occurs when the application is installed. To avoid this inconsistent
result, you must provide an offset that starts the CRC calculation past
this unique data. This also applies to the calculation of Checksum values.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To calculate a CRC or Checksum with the SMS Administrator, do the
following:

<OL><P><LI>Create a new package and click the Inventory button.

<P><LI>Select "Add AND..." or "Add OR...".

<P><LI>In the File Properties window, click the ellipse button (...) to
   the right of File Name.

<P><LI>Browse to and select the file you want to calculate the CRC or Checksum
   of.

<P><LI>Choose "Checksum" or "CRC" from the Properties Available list and click
   Add&gt;.

<P><LI>Enter a value in the At Byte field. This is the data offset, or byte
   position, within the file where the algorithm will begin calculating the
   sum.

<P><LI>Enter a value for the Length field.  This is the total number of
   bytes that are summed.

<P><LI>Click the Retrieve button. The value displayed in the CRC-16 (or
   Checksum) field is your result.
<P>
</OL>The values calculated here can be used to customize your Audit.rul file.
For more information on Software auditing, see Chapter 6, page 217 of the
"SMS Administrator's Guide."
<P>
NOTE: This documentation mentions the Filetokn.exe utility which was not
included with SMS 1.1. Use the steps listed above to perform the same
functions.
<P>
Generally, an offset of 10,000 and a length of 10,000 to 50,000 will return
a consistent value for most large executable files. Don't forget to
consider that the larger the values for the length, the longer it will take
to calculate. To really be certain that the value you calculate does not
contain any unique data, calculate the CRC or Checksum on the executable
file installed from two installations of the same application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Large applications like Microsoft Word or even applications from other
software developers will often contain a unique product ID stamp at the
beginning and/or end of the file data.
<P>
For example, Microsoft Word 7.0 uses WINWORD.EXE which is 3,845,120 bytes
in size. This file contains unique data within the first 225 bytes of the
file and also in the last 245K of the file. In order to retrieve a
consistent CRC or Checksum value, use an offset or "At Byte" of at least
250 and a length of one to 3,500,000. This will return the same value for
every installation of Microsoft Word 7.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: CRC Checksum FILETOKN.EXE value prodsms<BR>
Keywords            : kbusage smsadmin smsdocerr smshowto<BR>
Version             : 1.1 1.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
