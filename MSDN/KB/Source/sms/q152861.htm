

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMS: Using Dosetup to Create Registry Entries for PGC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152861">
<META NAME="KBModify" CONTENT="1997/03/26">
<META NAME="KBCreate" CONTENT="1996/06/25">
<META NAME="Keywords" CONTENT="kbnetwork smspgc kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  If distributing a Shared Application without a package definition file (PDF), the administrator will need to specify the Registry Entry name and a Configuration Command Line, in order for SMS to correctly configure the application and record that i...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAH4,QDI2,QDIZ,QAJH,QBXS,QA5V,QBWS,QAJQ,QBBI,QAIJ,QAH6,QBXT,QAIB,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Using Dosetup to Create Registry Entries for PGC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152861</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.1 and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If distributing a Shared Application without a package definition file
(PDF), the administrator will need to specify the Registry Entry name and a
Configuration Command Line, in order for SMS to correctly configure the
application and record that in its registry. Use the "Dosetup.exe"
executable file to complete this task.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
DOSETUP.EXE can be used to run a user-specified setup program under
Program Group Control (PGC). This program would normally be specified as
the 'ConfigurationScript' entry within the [Program Item Properties i]
section of a PDF file. The command-line syntax is:
<P>
<PRE>   DOSETUP &lt;RegName&gt; &lt;CommandLine&gt;

</PRE>where RegName has the same value as the 'RegistryName' entry in the same
section of the PDF, and CommandLine is any valid command line.
<P>
For example, the following command will run the setup program for
the Microsoft Access 2.0 Service Pack:
<P>
<PRE>   DOSETUP acs2pak setup.exe

</PRE>This program does not handle all of the complexities of making an arbitrary
shared application fully SMS-compliant. It merely provides a mechanism for
running a setup program and for setting certain SMS registry status flags
required by PGC.
<P>
DOSETUP runs the specified command line and manages the status entry under
the program item's registry key
<P>
<PRE>   (HKEY_CLASSES_ROOT\SMS\APPLICATIONS\&lt;regName&gt;\Configuration\Status)

</PRE>The status entry must be set to UNFINISHED, FAIL or SUCCESS.
<P>
DOSETUP operates like SMSSETUP in most respects; it displays the SMS blue
setup screen, reports errors, and does postprocessing following any system
restart. The postprocessing sets an application's status flag to SUCCESS.
DOSETUP initially sets an application's status to FAIL, in case anything
goes wrong during its processing. To handle a possible system restart by an
installation program, DOSETUP sets the status to UNFINISHED immediately
before running the user's command line. When the installation program
terminates, or when PGC Start reruns DOSETUP following a system restart,
the status is reset to SUCCESS. There is currently no mechanism for an
installation program to pass an error message to DOSETUP.
<P>
DOSETUP will be installed into the MSTEST directory on the logon server so
that it will be available to users from any PDF.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms 1.10 1.20<BR>
Keywords            : kbnetwork smspgc kbnetwork<BR>
Version             : 1.10 1.20<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
