

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automatically Starting Shared Applications Under SMS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124800">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1995/01/12">
<META NAME="Keywords" CONTENT="kbenv kbnetwork ntconfig ntdomain nthowto smspgc">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Running Systems Management Server client component from the Program Manager startup group is not supported. This article explains how to configure an Systems Management Server client to start Systems Management Server shared applications when Windo...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIJ,QDIV,QBWS,QAJH,QA3A,QARL,QAGR,QBWP,QDIM,QABY,QAH4,QA0K,QABO,QBXT,QBVP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automatically Starting Shared Applications Under SMS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124800</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0 and 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Running Systems Management Server client component from the Program Manager
startup group is not supported. This article explains how to configure an
Systems Management Server client to start Systems Management Server shared
applications when Windows is started.
<P>
NOTE: The procedure described in this article is for informational use only
and is not supported by Microsoft.
<P>
You cannot run Systems Management Server client components from the Startup
group, because during an upgrade of the client, the SMSSVR component must
be able to overwrite program files. If the files are running, they cannot
be replaced. SMSRUN is assumed to be the single responsible component for
starting the Systems Management Server client applications. It is designed
this way to ensure that if upgrade is needed, it can skip loading the
applications and upgrade them.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For Systems Management Server to start a shared application, Program Group
Controller (PGC) must be running first. Since PGC requires time to
initialize, any Systems Management Server shared applications that are put
in the Startup Group usually fail to start. Shared applications are started
by APPSTART which is dependent on APPCTL&lt;xx&gt;.EXE (where &lt;xx&gt; is 16 or 32).
If APPSTART determines that APPCTL&lt;xx&gt;.EXE is not running, it fails to
start any applications.
<P>
When an SMS-configured Windows client is started, the LOAD= line, in the
WIN.INI file or the Windows NT Registry, starts the Systems Management
Server utility SMSRUN&lt;xx&gt;.EXE (where &lt;xx&gt; is 16 or 32). One of
SMSRUN&lt;xx&gt;.EXE's duties is to start APPCTL&lt;xx&gt;.EXE. This is done when
SMSRUN&lt;xx&gt;.EXE parses and executes the instructions in the
\MS\SMS\BIN\SMSRUN&lt;xx&gt;.INI (where &lt;xx&gt; is 16 or 32) file. This file tells
SMSRUN&lt;xx&gt;.EXE what to do and in what order.
<P>
By inserting a new line at the end of the [startup] section of the
SMSRUN&lt;xx&gt;.INI file, an Systems Management Server client can have
SMSRUN&lt;xx&gt;.EXE start other applications. To start a shared Systems
Management Server application, insert a line that contains APPSTART and the
Registry entry for that application. This should be a copy of the command
line for the program item in Program Manager. This will have SMSRUN&lt;xx&gt;.EXE
start PGC and allow it to initialize completely. After PGC initializes,
APPSTART will then be able to start an Systems Management Server shared
application.
<P>
NOTE: The Systems Management Server system itself may occasionally, using
CLI_&lt;os&gt;.EXE (where &lt;os&gt; is OS2, DOS, or Windows NT), modify this file
based on changes in the Systems Management Server site properties. If this
happens, you will need to reinsert any changes you made
to the SMSRUN&lt;xx&gt;.INI file.
<P>
<P><h2>EXAMPLE</h2>
 
<P>
The following is a sample SMSRUN16.INI file that will start a shared
version of Microsoft Excel:
<P>
[SMS Client]
Package Command Manager=D:\MS\SMS\bin\pcmwin16.exe
Program Group Control=D:\MS\SMS\bin\appctl16.exe
Remote Control=D:\MS\SMS\bin\wuser.exe
Help Desk Options=D:\MS\SMS\bin\editini.exe
MIF Entry=D:\MS\SMS\bin\mifwin.exe
SMS Client Help=D:\MS\SMS\bin\sm16.hlp
<P>
[startup]
load=D:\MS\SMS\bin\pcmwin16.exe
load=D:\MS\SMS\bin\appctl16.exe
load=D:\MS\SMS\bin\mifwin.exe /SMSLS
load=APPSTART.EXE msoffpro+excel
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms sms run program office auto<BR>
start<BR>
Keywords            : kbenv kbnetwork ntconfig ntdomain nthowto smspgc<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
