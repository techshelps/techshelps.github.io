

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Controlling LM and NT Logon Script Configurations with SMS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121388">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1994/10/04">
<META NAME="Keywords" CONTENT="kbnetwork smsadmin smssiteconfigman">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  This information applies to Microsoft LAN Manager and Windows NT products only. For information on NetWare script modifications, refer to other articles in the Microsoft Knowledge Base.  Selecting the Automatically Configure Logon Scripts option in...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAGR,QAIJ,QAH5,QAGU,QAI5,QDIZ,QBVV,QA5E,QAV1,QAV0,QAGI,QBWU,QBWP,QDJ2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Controlling LM and NT Logon Script Configurations with SMS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121388</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1 and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This information applies to Microsoft LAN Manager and Windows NT products
only. For information on NetWare script modifications, refer to other
articles in the Microsoft Knowledge Base.
<P>
Selecting the Automatically Configure Logon Scripts option in Systems
Management Server Administrator causes Systems Management Server to attempt
modifications to both user account profiles and existing logon scripts for
those users. To prevent these modifications from happening to selected
accounts, the administrator can alter the behavior of Systems Management
Server to accommodate the needs of network users.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>The Systems Management Server Site Configuration Manager will only
   attempt to modify a users profile if it is blank (no logon script
   specified), or if it already contains the SMSLS script name.
<P>
   If an existing script is detected that is not SMSLS, Systems Management
   Server then performs several operations:
<P>
   a. Systems Management Server first makes a copy of the script as it
<P><PRE>      exists in the REPL$\SCRIPTS directory using a temporary name. The
      temporary file will be opened and the following two (start and end)
      encapsulation comment strings will be looked for:
</PRE><P>
<P><PRE>       - Systems Management Server 1.0:
</PRE><P>
<PRE>            REM Microsoft Systems Management Server (start)

            REM SMS Build &lt;xxx&gt;
            if "%OS%" == "Windows_NT" call smsls
            if "%OS%" == "" call %0\..\smsls

            REM Microsoft Systems Management Server (end)

       - Systems Management Server 1.1:

            REM Microsoft Systems Management Server (start)

            REM SMS Build 692

            call %0\..\smsls

            REM Microsoft Systems Management Server (end)

   b. If the start and end strings are present, the file will not be
      modified (allowing the administrator to edit the changes between them
      and preserve them). If these strings are not present they will be
      added in, either at the top of the script or appended to the bottom
      of the script depending on the selections made in Systems Management
      Server Administrator (&lt;Site Properties&gt;&lt;Clients&gt;). The modified file
      will then replace the actual script file and the original script file
      will be saved with a sequentially numbered extension like "000".

</PRE><P><LI>If the script specified does not include either a .BAT or .CMD file
   extension, Systems Management Server will ignore this script and will
   not attempt items 1a or 1b above. This is by design for Systems
   Management Server version 1.0 to provide the administrator with the
   capability of bypassing certain user accounts from the Systems
   Management Server logon script automatic configuration. This feature is
   under review and will be considered for inclusion in a future release.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: smsadmin smssiteconfigman<BR>
Additional query words: config sms prodsms 1.00 1.10 1.20 login<BR>
Keywords            : kbnetwork smsadmin smssiteconfigman<BR>
Version             : 1.0 1.1 1.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
