

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving SMSVIEW Data Using MS Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153534">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1996/07/11">
<META NAME="Keywords" CONTENT="smsdatabase kbfaq kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  There are problems associated with Querying within SMS - SMS Query Results Display Only First Data Record. Another application is necessary to retrieve the correct data. For instance, Access can be used to retrieve drive information from the SMS Da...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2Q,QAG2,QBWS,QA1S,QDN9,QBFY,QADK,QAYY,QAZV,QAY2,QBM2,QBMW,QA9N,QA5V,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Retrieving SMSVIEW Data Using MS Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153534</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Systems Management Server, versions 1.0, 1.1 and 1.2
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are problems associated with Querying within SMS - SMS Query Results
Display Only First Data Record. Another application is necessary to
retrieve the correct data. For instance, Access can be used to retrieve
drive information from the SMS Database Views.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To retrieve drive information from SMS Databease Views using Access,
perform the following steps.

<OL><P><LI>Run SMSVIEW to create the views.

<P><LI>Confirm SQL connectivity using ODBC Manager.

<P><LI>Start Access and create a new database.

<P><LI>Select File, and then select Get External Data.

<P><LI>Select Import and in Files of Type select ODBC Databases.

<P><LI>Select your SMS data source and log in to SQL.

<P><LI>Select all the tables preceded by 'dbo.v' - the views.

<P><LI>Open the Tools / Relationships and Added dbo.vDisk and
    dbo_vIdentification.

<P><LI>In the first table, select dwMachineID. Drag and drop dwMachineID into
    the second table.

<P><LI>Open the Relationships window and  select Create.

<P><LI>In the Database window, select Queries and select New.

<P><LI>Use the Simple Query Wizard.

<P><LI>At the  first screen, select dbo.vIdentification and choose SMSID0 as
    the selected field. Select dbo.vDisk and choose Disk_Index0,
    Storage_Size_MByte_0, Storage_Used_MByte_0, Free_Storage_MByte_0,  and
    __Disk_Full0 as selected fields.

<P><LI>At the next screen  select Detail. At the Final screen give it a
    title and select Finish. At this point you should see all your SMSIDs
    and associated drives.

<P><LI>Select View and selct SQL. You should see a query similar to:
<P>
</OL>SELECT DISTINCTROW [dbo.vIdentification].[SMSID0],
[dbo.vDisk].[Disk_Index0], [dbo.vDisk].[Storage_Size__MByte_0],
[dbo.vDisk].[Storage_Used__MByte_0], [dbo.vDisk].[Free_Storage__MByte_0],
[dbo.vDisk].[__Disk_Full0]
FROM dbo.vDisk INNER JOIN dbo.vIdentification ON
dbo.vDisk].[dwMachineID]=[dbo.vIdentification].[dwMachineID];

<OL><P><LI>Modify this query to have the following as the final statement (note
<P><PRE>    the query ends with the semicolon(;), so remove it from the original
    query before adding the final line):
</PRE><P>
   WHERE (((dbo.vDisk.Disk_Index0)&gt;"B"));
<P>
</OL>Here is an example output:
<P>
<PRE>SMSID0   Disk_Index0 Storage_Size__MByte_0   Storage_Used__MByte_0
Free_Storage__MByte_0   __Disk_Full0
UUU01000     C     324         284         40          88
UUU01000     D     324         267         57          83
UUU02000     C     502         398         104         80
UUU02000     D     1545        1426        119         93
UUU02001     C     514         347         167         68
UUU01001     C     514         347         167         68
UUU01002     C     202         171         31          85
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: smsdatabase<BR>
Additional query words: 1.00 1.10 1.20 prodsms views smsview.exe report<BR>
Keywords          : smsdatabase kbfaq kbnetwork<BR>
Version           : 1.00 1.10 1.20<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
