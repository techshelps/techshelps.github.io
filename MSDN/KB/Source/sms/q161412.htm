

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMS: 'Too Many Parameters' Error When Running Smsls.bat </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161412">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1996/12/20">
<META NAME="Keywords" CONTENT="kbbug1.00 kbbug1.10 kbbug1.20 kbfix1.20.sp2 smsconfig smssetup kbfix1.20.sp3 kbenv kbfi">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  When you run the Smsls.bat file on a client computer running Windows 95, you may receive errors, and the command prompt window may display the following message:     Too Many Parameters    Bad Command or Filename    Bad Command or Filename    Too M...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QA50,QAFI,QBWS,QACI,QDNQ,QANE,QAAP,QDO3,QAKP,QDKW,QAIA,QBXS,QBVV,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: 'Too Many Parameters' Error When Running Smsls.bat</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161412</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server, versions 1.0, 1.1, and 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Smsls.bat file on a client computer running Windows 95,
you may receive errors, and the command prompt window may display the
following message:
<P>
<PRE>   Too Many Parameters
   Bad Command or Filename
   Bad Command or Filename
   Too Many Parameters

</PRE><h2>CAUSE</h2>
 
<P>
If there is a space in the directory name for the "path" environment
variable (such as "C:\Program Files"), and you run the Smsls.bat file on a
client computer running Windows 95, Systems Management Server does not
parse the path correctly.
<P>
This problem occurs when Smsls.bat sets the SMS_P=%PATH% environment
variable. SMS_P is then used in various places in the logon script that
contains the space, and causes that command-line to clock.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, add quotation marks around the path variable
in two (and only two) places in the Smsls.bat file.

<OL><P><LI>Place quotation marks around the %PATH% variable under :RUN_FROM.
<P>
   For example, change
<P>
<P><PRE>      if not "%OS%" == "Windows_NT" set PATH=%0\..;%0\..\%SMS_BIN%;%PATH%
</PRE><P>
   To:
<P>
<P><PRE>      if not "%OS%" == "Windows_NT" set
</OL></PRE>PATH=%0\..;%0\..\%SMS_BIN%;"%PATH%"

<OL><P><LI>Place quotation marks around SMS_P when it is reassigned to the path at
   the end of the script under :RESTORE.
<P>
   For example, change
<P>
<P><PRE>      PATH=%SMS_P%
</PRE><P>
   To:
<P>
<P><PRE>      PATH="%SMS_P%"
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
versions 1.0, 1.1, and 1.2. This problem was corrected in the latest
Microsoft Systems Management Server version 1.2 U.S. Service Pack. For
information on obtaining the service pack, query on the following word in
the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms 1.00 1.10 1.20<BR>
Keywords          : kbbug1.00 kbbug1.10 kbbug1.20 kbfix1.20.sp2 smsconfig smssetup kbfix1.20.sp3 kbenv kbfixlist<BR>
Version           : 1.00 1.10 1.20<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
