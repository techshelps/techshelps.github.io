

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Unattended Installation of Windows NT 3.51 Service Pack 1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135584">
<META NAME="KBModify" CONTENT="1997/04/23">
<META NAME="KBCreate" CONTENT="1995/08/23">
<META NAME="Keywords" CONTENT="kbsetup ntsetup smsappscripts smsutil">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  The installation of the Windows NT 3.51 Service Pack 1 requires manual input. To perform an unattended installation of the Service Pack, you modify the Service Pack information (.INF) file.  NOTE: Do not perform the unattended installation of the S...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDO3,QAA1,QDI2,QAXB,QDIZ,QAIJ,QAC1,QA9N,QAMB,QDNL,QBD2,QASB,QAIB,QACK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unattended Installation of Windows NT 3.51 Service Pack 1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135584</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1 and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The installation of the Windows NT 3.51 Service Pack 1 requires manual
input. To perform an unattended installation of the Service Pack, you
modify the Service Pack information (.INF) file.
<P>
NOTE: Do not perform the unattended installation of the Service Pack from
the Package Command Manager Service (PCMSVC32) because the Service Pack
Setup program fails to restart the computer. Use the desktop Package
Command Manager (PCMWIN32) instead.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To perform an unattended installation of the Windows NT 3.51 Service
Pack 1, close all applications and do the following:
<P>
NOTE: Specific line changes to the files below are valid only for
Windows NT 3.51 Service Pack 1. The changes described in this article are
intended to be used as a starting point, and deal only with the initial and
final dialog messages. If other errors are encountered during the update
process, such as low disk space or incorrect Windows NT version,
additional dialog messages may appear.

<OL><P><LI>Copy all Service Pack files to a working directory accessible by the
   site server that will be used to send the package.

<P><LI>In the working directory, copy UPDATE.INF to a new file. For example:
<P>
<P><PRE>      COPY UPDATE.INF SP1QUIET.INF.
</PRE>
<P><LI>Using a text editor, edit the SP1QUIET.INF file. Comment out, by placing
   a semi-colon (;) in front of, the six lines that start at line 305
   (SHELL through ENDIF). This suppresses the initial dialog box that
   normally displays the following:
<P>
<P><PRE>      Setup is going to update your Windows NT system with the English
      version of the update program. If you wish to cancel the update
      process, please press Cancel or press OK to continue.
</PRE>
<P><LI>Comment out, with a semi-colon, three lines starting at line 473
   (UI START through UI POP). This suppresses the dialog box that prompts
   users to allow the system to be restarted. The system will reboot
   automatically.

<P><LI>Create an intermediate script file. For example, create a file called
   SP1.BAT with the following contents:
<P>
<P><PRE>      rem Supporting batch file to apply Windows NT 3.51 Service Pack 1
</PRE><P>
<P><PRE>      rem Create a safe place to store a local copy of the Service Pack
      rem so we can give SETUP.EXE an absolute path to the source
      rem directory.
</PRE><P>
<P><PRE>      md c:\nt351sp1
</PRE><P>
<P><PRE>      rem Copy the Service Pack files from the CDM set by PCM to the
      rem safe directory. Administrators should remove this using another
      rem (PCM) method later.
</PRE><P>
<P><PRE>      copy *.* c:\nt351sp1\*.*
</PRE><P>
<P><PRE>      rem Run Windows NT Setup
</PRE><P>
<P><PRE>      setup.exe /s c:\nt351sp1 /i c:\nt351sp1\sp1quiet.inf
</PRE>
<P><LI>Create a .PDF file (for example, SP1QUIET.PDF) containing the
   following:
<P>
   NOTE: If you want to configure additional inventory properties, place
   the in the PDF as well. However this single property should be
   sufficient.
<P>
<P><PRE>      [PDF]
      Version=1.0
</PRE><P>
<P><PRE>      [Unattended Setup]
      CommandLine=sp1.bat
      CommandName=Unattended NT 3.51 SP1 Installation
      UserInputRequired=FALSE
      SynchronousSystemExitRequired=TRUE
      SupportedPlatforms=Windows NT 3.1 (x86), Windows NT 3.1 (MIPS),
      Windows NT
</PRE><P>
<P><PRE>      3.1 (Alpha)
</PRE><P>
<P><PRE>      [Package Definition]
      Product=Windows NT
      Version=3.51
      Comment=NT 3.51 Service Pack 1 English
      SetupVariations=Unattended
</PRE><P>
<P><PRE>      [Setup Package for Inventory]
      InventoryThisPackage=TRUE
      Detection Rule Part 1=file 1
</PRE><P>
<P><PRE>      [file 1]
      FILE=NTOSKRNL.EXE
      COLLECT=FALSE
      Checksum=
      CRC=
      DATE=7, 27, 95
      SIZE=805264
      TIME=
      BYTE=
      WORD=
      LONG=
      TOKEN 1=
      TOKEN 2=
      TOKEN 3=
      TOKEN 4=
</PRE>
<P><LI>Import the .PDF file and point it to the subdirectory containing all
   the Service Pack 1 files (including the SP1QUIET.INF file). When you
   install this package on unattended servers, remember to make the package
   mandatory (check the mandatory time also), and send it only to systems
   running Windows NT version 3.51. You must also check the System
   (Background) Task in the package properties.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms sms<BR>
Keywords            : kbsetup ntsetup smsappscripts smsutil<BR>
Version             : 1.0 1.1 1.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
