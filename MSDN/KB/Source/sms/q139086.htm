

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Update Files in Use by Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139086">
<META NAME="KBModify" CONTENT="1997/04/23">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="kbsetup smssetup">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  If you attempt to update Windows client system files that are currently in use, the update fails and the files are not overwritten. This article outlines a procedure that you can use to ensure these files are updated when you restart the computer. ...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAC1,QBD2,QAEF,QBFY,QAB9,QDIR,QDL9,QBWQ,QBWO,QBWN,QA9N,QARL,QAA1,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Update Files in Use by Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139086</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1 and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you attempt to update Windows client system files that are currently in
use, the update fails and the files are not overwritten. This article
outlines a procedure that you can use to ensure these files are updated
when you restart the computer. The procedure is not supported and may be
used at your own risk. The SMSWORK component can change in future releases
of Systems Management Server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The C:\SMS.INI file can include a [SMS Work] section, and a PendingWork
key. For this key, you can create a comma separated list of commands for
the SMSWORK.EXE component of Systems Management Server. SMSWORK.EXE
executes these commands when AUTOEXEC.BAT calls the Systems Management
Server batch file, CLIENT.BAT.
<P>
For example, if you want to update the NETAPI.DLL file in the
C:\WINDOWS\SYSTEM directory, do the following:

<OL><P><LI>Use Microsoft Test or another method to update SMS.INI as follows:
<P>
<P><PRE>      [SMS Work]
      PendingWork=copy c:\temp\netapi.dll c:\windows\system\netapi.dll /y,
      del c:\temp\netapi.dll
</PRE><P>
   NOTE: SMS.INI is a critical file for the Systems Management Server
   client and great care should be taken when altering it. SMS.INI has the
   file attribute Hidden. Be sure to restore the Hidden file attribute
   after you remove it.

<P><LI>In the script you use, place the new version of NETAPI.DLL into the
   c:\TEMP directory and possibly notify the user that a reboot is needed.
<P>
</OL>In this example, when the client reboots, AUTOEXEC.BAT calls CLIENT.BAT,
which invokes SMSWORK.EXE. SMSWORK reads the items from PendingWork and
executes them as separate commands according to where you place the comma
starting with the left command first. SMSWORK then copies NETAPI.DLL over
the old one, and the next command deletes the temporary version of
NETAPI.DLL. Following each command, SMSWORK automatically removes the
executed command from the PendingWork key.
<P>
By design, SMSWORK is a helper component to the modules that perform
operating system upgrades and installs. SMSWORK helps these modules by
removing local temporary directories created during the operating system
setup or undoes other actions taken by these modules, when the system
reboots.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms<BR>
Keywords            : kbsetup smssetup<BR>
Version             : 1.0 1.1 1.2<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
