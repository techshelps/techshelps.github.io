

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMS FAQ: Checklist for Enabling SMS in Logon Scripts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123318">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/11/29">
<META NAME="Keywords" CONTENT="smsadmin smssiteconfigman kbnetwork kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT=" This article provides a checklist of what must be accomplished before Systems Management Server will install itself in the logon scripts for a Microsoft network domain (Windows NT or LAN Manager):  1. Configure and enable the Directory Replicator se...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QDIZ,QAGU,QAI5,QAH5,QAGR,QDJ3,QA63,QA9A,QBVX,QAPN,QAJP,QBW7,QBVV,QBW3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS FAQ: Checklist for Enabling SMS in Logon Scripts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123318</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1, and 1.2
</UL> 
<P>
This article provides a checklist of what must be accomplished before
Systems Management Server will install itself in the logon scripts
for a Microsoft network domain (Windows NT or LAN Manager):

<OL><P><LI>Configure and enable the Directory Replicator service for the domain
   being managed by Systems Management Server. Systems Management Server
   looks for a REPL$ share on the domain controller (DC). If it doesn't
   exist, the Site Configuration Manager will not be able to copy the
   proper Systems Management Server logon support files to the
   Export\Scripts directory.

<P><LI>Using Systems Management Server Administrator, configure the Systems
   Management Server Site properties as follows:
<P>
   a. In the Clients dialog box, select Automatically Configure Workstation
<P><PRE>      Logon Scripts.
</PRE><P>
   b. In the Domains dialog box, select Use All Detected Servers for each
<P><PRE>      domain that you want logon scripts enabled.
</PRE><P>
   NOTE: At this point, Systems Management Server has been properly
   configured. It will then configure the user logon scripts for each
   domain to include the Smsls.bat entry, and copy the proper Systems
   Management Server support files to the REPL$ share during the next Site
   Configuration Manager watchdog cycle. This occurs by default every 24
   hours, but can be forced immediately by using one of the two methods
   listed in step 3 below.

<P><LI>To force the watchdog cycle to occur immediately, use one of the
   following methods:
<P>
<P><PRE>    - Toggle the Systems Management Server site property for logon scripts,
      changing it from its current state to the other state. This will
      toggle the site control file line "PROPERTY &lt;Logon Scripts&gt;&lt;&gt;&lt;&gt;&lt;1&gt;"
      to 1 or 0. Site Configuration Manager will read this line and
      immediately configure the logon scripts appropriately. For example,
      if the Automatically Configure Workstation Logon Scripts site
      property in the Clients dialog box is clear, selecting it changes the
      flag from 0 to 1. This would then force Site Configuration Manager to
      configure logon scripts when it next reads the Sitectrl.ct1 file.
</PRE><P>
<P><PRE>    - Use the SENDCODE utility. It is located on the Systems Management
      Server CD, in the PSSTOOLS directory. At the Systems Management
      Server site server, go to a command prompt and type the following
      command:
</PRE><P>
<PRE>         sendcode sms_site_config_manager 196

      If the Hierarchy Manager has not yet taken the proposed changes made
      for logon script configuration and passed this information to the
      Site Configuration Manager, the only way to expedite the process is
      to stop and restart the Hierarchy Manager service. If you use
      SENDCODE to force Site Configuration Manager to wake up under the old
      configuration (because Hierarchy Manager has not done its work yet)
      the configuration does not include the recent changes, and is a
      useless operation.

      This forces Site Configuration Manager to perform its watchdog cycle
      immediately and configure the Systems Management Server logon scripts
      for all users in the domains that were enabled in step 2 above.

</PRE></OL>NOTE: When you configure logon scripts in a domain that contains more than
one site server, do not use the Detect All Servers option. Be sure to
specify each server that is to be managed in the site properties for the
site that exclusively manages the server; otherwise two sites may compete
for the same server.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: config sms prodsms siteconfigman<BR>
Keywords          : smsadmin smssiteconfigman kbnetwork kbfaq<BR>
Version           : WINNT:1.0 1.1 1.2<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
