

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMS: Windows NT Remote Control May Fail in Routed Environment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173120">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1997/08/26">
<META NAME="Keywords" CONTENT="kbbug1.20 smsremtshoot kbfix1.20.sp3">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAOE,QANN,QA7O,QAB5,QAMN,QBWS,QAKC,QARL,QBWD,QDNT,QAX1,QAPN,QABA,QAIA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Windows NT Remote Control May Fail in Routed Environment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173120</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server version 1.2
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using Systems Management Server to remote control a Windows NT client
computer in a routed environment, the remote control session may fail if
the router(s) drop too many of the packets.
<P>
Therefore, the stability of a remote control session is directly related to
the stability and performance of the network environment in which it is
being used.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Systems Management Server remote control uses IP Sockets as the default
transport method for Windows NT client computers. More specifically, the
remote control session relies on a stream of UDP frames (packets) between
the client and administrator console.
<P>
Because UDP frames are not guaranteed delivery (which is inherent to the
TCP/IP protocol suite), a busy router may drop UDP frames in favor of
higher priority traffic such as TCP frames. You can use Network Monitor to
see ICMP frames from the router indicating that the router is too busy to
process the packet (for example, ICMP Source Quench messages or ICMP
Redirect messages and so forth). If the router is a black hole router, (no
notification that it is dropping packets) you will not see any ICMP
messages returned.
<P>
If too many frames in a remote control session are lost, the session will
terminate without warning.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use a NetBIOS session for remote control rather than using IP sockets to
work around this problem. Even though it is much more reliable, it may
prove to be slower in some environments.
<P>
To test a remote control session over a NetBIOS session or Lana such as
NetBT, (NetBIOS encapsulated in TCP/IP) perform the following steps:
<P>
I. View the Lana numbers defined on the client computer running Windows NT.
<P>
<PRE>   1. Click Start, point to Settings, and then click Control Panel.

   2. Double-click the Network icon.

   3. On the Services tab, select NetBIOS Interface, and then click
      Properties.

      From the list of defined Lana numbers, you may see something like
      "NetBT -&gt; El90x -&gt; El90x1" defined for Lana 0. This can be
      interpreted as NetBIOS encapsulated in TCP/IP over the Ethernet
      adapter. This is normally the most desirable choice for a remote
      control session. As long as a name resolution method (such as WINS)
      is being used in the network environment, this is a reliable choice.

      NetBT   = NetBIOS encapsulated in TCP/IP
      NwlnkNB = NetBIOS encapsulated in IPX
      NBF     = NetBIOS encapsulated in NetBEUI

      For systems that use a dial-up connection as well, you may see other
      Lana numbers similar to "NetBT -&gt; NdisWan4".

</PRE>WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.
<P>
II. Configure the Remote Control agent to listen on a specific Lana number.
<P>
<PRE>   1. Start Registry Editor (Regedt32.exe) and find the following
      registry key:

         HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Client Services
         \Remote Control\Parameters

   2. Change the "CommandLine" value from "-IP" (IP Sockets) to "-L0"
      (Lana 0). To permanently override the site-wide setting, set the
      "Override Site CommandLine" value under the Remote Control key to
      a value of "1" as well. This ensures that the CommandLine value
      is not overwritten if the Systems Management Server client
      components are ever upgraded.

</PRE>If NetBT proves to be a reliable and functional alternative to IP sockets
in your environment, the site-wide setting for Windows NT Server Remote
Control can be changed via the Systems Management Server Administrator
utility. To change the setting, start the Administrator utility and use the
following steps:

<OL><P><LI>In the Site Properties window, click Clients, and then select
   Proposed Properties.

<P><LI>Click Options.

<P><LI>Click the "NetBIOS Lana Number" option button and enter the Lana number
   you want. This will most often be a zero.

<P><LI>Click OK until you have closed the Site Properties window.
<P>
</OL>After the site property changes have taken effect, each Systems Management
Server client running Windows NT will need to run Upgrade.bat from the
SMS_SHR share of a Systems Management Server logon server to be configured
to use the new remote control setting.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
version 1.2. This problem was corrected in the latest Microsoft Systems
Management Server 1.2 U.S. Service Pack. For information on obtaining the
service pack, query on the following word in the Microsoft Knowledge Base
<PRE>(without the spaces):    S E R V P A C K 



</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms<BR>
Keywords          : kbbug1.20 smsremtshoot kbfix1.20.sp3<BR>
Version           : WinNT:1.2<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
