

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Incorrect DOS Version Error When Using MS-DOS 6.22 PDF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134331">
<META NAME="KBModify" CONTENT="1997/04/23">
<META NAME="KBCreate" CONTENT="1995/08/03">
<META NAME="Keywords" CONTENT="kbbug1.00 kbbug1.10 kbfix1.20 kbinterop smsgeneral">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  When you upgrade a Windows for Workgroups client running on MS-DOS versions 5.0 through 6.21 to MS-DOS 6.22 using the supplied package definition file DOS622.PDF, the following error appears:     Incorrect DOS version  The error occurs after UPGRD6...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAA1,QAAP,QAFI,QAC1,QDI2,QBXB,QATJ,QAKP,QBV8,QAB9,QARL,QAK6,QAB4,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Incorrect DOS Version Error When Using MS-DOS 6.22 PDF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
- Microsoft Systems Management Server versions 1.0 and 1.1
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you upgrade a Windows for Workgroups client running on MS-DOS versions
5.0 through 6.21 to MS-DOS 6.22 using the supplied package definition file
DOS622.PDF, the following error appears:
<P>
<PRE>   Incorrect DOS version

</PRE>The error occurs after UPGRD622 or STPUP622 has copied the package source
files locally and shuts down Windows for Workgroups in order to start
MS-DOS Setup.
<P>
<P><h2>CAUSE</h2>
 
<P>
The error occurs when OUTSMART.EXE tries to spawn COMMAND.COM and finds the
uncompressed new COMMAND.COM from the MS-DOS 6.22 installation files
instead of the COMMAND.COM for the version of MS-DOS that is currently
installed.
<P>
NOTE:  OUTSMART.EXE is the MS-DOS-based utility used to start the MS-DOS
Setup program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The cause of the problem depends on which package command line is used for
the 'run command on workstation' job.
<P>
If you are using the following command lines, the problem occurs because
you are using the MS-DOS 6.22 Upgrade disks as the package source instead
of the MS-DOS 6.22 Step-Up disk.
<P>
<PRE>   Batch Step-Up Win/WFW Client
   Manual Step-Up Win/WFW Client

</PRE><P><LI>If you are using the following command lines, the problem is occurs
</OL>because OUTSMART.EXE not switching away from the current directory and
therefore finding the wrong copy of COMMAND.COM:
<P>
<PRE>   Batch Upgrade Win/WFW Client
   Manual Upgrade Win/WFW Client

</PRE></OL><h2>WORKAROUNDS</h2>
 
<P>
To work around this problem, create the source directory for the package
from the MS-DOS 6.22 Step-Up disks, or create the source directory for the
package with the actual MS-DOS 6.22 installation files one subdirectory
deep. For example, setup a directory called MSDOS.SRC with a subdirectory
called 622. Put the MS-DOS installation files in the MSDOS.SRC\622
directory. Create the package with the MSDOS.SRC directory as the source.
This prevents OUTSMART from finding the wrong version of COMMAND.COM
because it is no longer in the current directory.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
version 1.1. This problem has been corrected in Systems Management Server
version 1.2.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms<BR>
Keywords            : kbbug1.00 kbbug1.10 kbfix1.20 kbinterop smsgeneral<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
