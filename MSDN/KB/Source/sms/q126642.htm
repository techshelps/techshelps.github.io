

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMS: Troubleshooting Inventory Collection Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126642">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1995/02/27">
<META NAME="Keywords" CONTENT="nthowto smsadmin smshowto smsinv smsmaintman">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  This article describes several Systems Management Server inventory collection problems, and what you can do to resolve them.  MORE INFORMATION  The Client Stops Responding When You Run Inventory Agent  1. See if you have a Smssafe.tmp file. This fi...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QABH,QARL,QAGR,QBXB,QATJ,QAI5,QAKP,QBVV,QAFI,QBVX,QADK,QAAP,QAEF,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Troubleshooting Inventory Collection Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126642</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0 and 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes several Systems Management Server inventory
collection problems, and what you can do to resolve them.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>The Client Stops Responding When You Run Inventory Agent</h3>
 

<OL><P><LI>See if you have a Smssafe.tmp file. This file lists each test that
   was run. The last test listed indicates which test caused the client
   to stop responding. Inventory Agent deletes this file if it completes
   normally.
<P>
   NOTE: If you are running Systems Management Server 1.1, the Smssafe.tmp
   file is located in the Ms\Sms\Data directory.

<P><LI>Set the SMSLS=1 environment variable. This variable enables the
   Smsls.bat file's verbose mode, to help you determine where the Inventory
   Agent caused the client to stop responding. verbose mode echoes all
   output to the screen.

<P><LI>Once you determine where the Inventory Agent is stopping, remove or
   reconfigure the suspect component and run the inventory again. Once the
   problem has been narrowed down to a particular configuration, report the
   results to Microsoft Technical Support.
<P>
</OL>You Run Inventory Agent on a New Client but the Inventory Doesn't Appear
in the Database
 

<OL><P><LI>Look at the CurrentLogonServer entry in the hidden Sms.ini file, to
   determine what logon server Systems Management Server is reporting the
   inventory to.

<P><LI>For MS-DOS, Windows, Windows for Workgroups, and Windows NT clients,
   check the \\&lt;logon server&gt;\Sms_Shr\Inventry.box directory for a .raw
   file generated by the client. For Macintosh and OS/2 clients, check the
   \\&lt;logon server&gt;\Sms_Shr\Isvmif.box directory for a .mif file. If
   multiple files exist, look for one with a recent time stamp. Display the
   text contents of the file, and look for a Systems Management Server ID
   that matches the Systems Management Server Unique ID entry in the
   Sms.ini file. Confirm that the Inventory Agent did write this file.
<P>
   NOTE: The .raw file has a binary header and a text detail area. The .mif
   file is a text file. A first-time .mif file is about 40-60K in size.
   Delta .mif files are usually less than 5K in size.

<P><LI>If the .raw or .mif file does not exist, check for a permission or
   connection problem. The client's Inventory Agent may not be able to
   connect and write to this location.
<P>
   If this file does exist, then Inventory Agent is working properly. See
   the next section to determine if one of the Systems Management Server
   Site services is suspect.
<P>
</OL>Inventory Agent Runs Normally on the Client but the Hardware Inventory Is
Not Updated
 

<OL><P><LI>Confirm that the hardware inventory collection interval has expired for
   the client. Check the current LastHardwareScan value in the Sms.ini
   file, add the inventory collection interval configured for the Systems
   Management Server site, and compare the resulting date against the
   client's current system clock date. Systems Management Server uses this
   procedure to determine when it needs to collect hardware or software
   inventory.
<P>
   For more information on the inventory process, see Appendix C of the
   "SMS Administrator's Guide."

<P><LI>The Systems Management Server Maintenance Manager service is responsible
   for collecting the .raw and .mif files from the logon servers, and
   transferring them to the Systems Management Server Site server. These
   files are placed in the \Sms\Site.srv\Inventry.box or Isvmif.box
   directory, depending on the client type. If the files do not arrive
   during the Maintenance Manager watchdog cycle, check the
   Sms\Logs\Maintman.log file for errors that occurred while either
   attempting to connect to the logon server or transferring files to the
   site server.

<P><LI>After these files reach the site server, the Systems Management Server
   Inventory Data Processor service processes them and places the output in
   the Sms\Site.srv\Dataload.box\Deltamif.col directory. If the files are
   not removed from the source directories, or do not appear in the
   destination directory, check the Sms\Logs\Invproc.log file for errors.

<P><LI>After the output is written to the ...\Deltamif.col directory, the
   Systems Management Server Inventory Data Loader copies the data in these
   files to the SQL database. If the files are not removed from this
   directory, or the data does not appear in the SQL database, check the
   Sms\Logs\Datalodr.log file for errors.

<P><LI>Use the Systems Management Server Services Manager to stop the services
   while you troubleshoot this problem. After you examine a file at one
   point in the process, start the service that will process that file.
   This allows you (the administrator) time to look at the file before it
   is deleted, and the results are sent to the next point in the system.

<P><LI>Log file entries report both the Systems Management Server event ID and
   the Windows NT error code. Convert the Windows NT error code to text,
   using Error32, to determine what the actual error is.
<P>
   Error32 can be copied from the Psstools directory on the Systems
   Management Server compact disc.
<P>
</OL><h3>Inventory in the Database Is Corrupt or Incorrect</h3>
 

<OL><P><LI>Run Inventory Agent on the client and check the .raw or .mif file
   (at the locations mentioned above) generated by the client. Compare the
   inventory reported with the known configuration of the client. If the
   .raw or .mif file is correct on the logon server, check the file again
   after it is moved to the site server, and once again after the Systems
   Management Server Inventory Processor has created the delta .mif in the
   ...\Deltamif.col directory.

<P><LI>If corruption occurs in the .raw or .mif file on the logon server, it is
   usually caused by the Inventory Agent. If this happens, enable the
   Inventory Agent verbose mode, and watch the output, to determine where
   the problem occurs.

<P><LI>If the .raw or .mif files on the Systems Management Server Site server
   are corrupted, check the associated service log files for error or
   warning messages. These messages may indicate network or file system
   problems that are causing the corruption. The Systems Management Server
   Data Loader service does not usually parse the .mif file or put the file
   in the Datalodr.box\badmifs directory for the administrator to review.
<P>
</OL><h3>Software Inventory Is Not Collected or Updated</h3>
 

<OL><P><LI>Confirm that the software inventory collection interval has expired. Use
   the same procedure as above ("Inventory Agent Runs Normally on the
   Client but the Hardware Inventory Is Not Updated," step one), but use
   the value in LastSoftwareScan to confirm the software collection
   interval.

<P><LI>Confirm that a compiled software package rules file (Pkg_16.cfg) exists
   on the logon servers. This file specifies what software inventory is
   supposed to be collected from the Systems Management Server client by
   Inventory Agent. Check Appendix C of the "SMS Administrator's Guide" for
   details on how Pkg_16.cfg is created and placed on the logon servers.

<P><LI>Check the Package.rul file and confirm that it has the proper software
   package rules. This file is compiled to create the Pkg_16.cfg file.
   Refer to Appendix C for the location.

<P><LI>Check the resulting .raw or .mif file created by the Inventory Agent.
   Software inventory and collected files are appended to the end of the
   hardware inventory section.

<P><LI>Carefully check your Software Package inventory rule properties
   (created using Systems Management Server Administrator). Many software
   inventory problems occur due to a bad rules configuration.
<P>
</OL>Machine Inventory Appears to Change and Contains Entries from Another
System
 
<P>
This problem usually occurs when two clients have mistakenly been
configured with the same Systems Management Server ID. Check the machine
name, logon name, or other unique identifier. If any of these items change,
you should be able to track down which computers have the same Systems
Management Server ID.
<P>
To correct this problem, delete the Sms.ini file from one of the systems
and run Smsls.bat again on that system. This process assigns a new Systems
Management Server ID to the affected system, and creates a new entry in the
SQL database. If this problem occurs on several systems, check all the
\\&lt;logon server&gt;\Sms_shr\Smsid directories for the site, and confirm that
the current .uid file contains a unique ID to be assigned to the next new
Systems Management Server client configured by the system.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sms prodsms shoot trouble-shoot trouble shoot<BR>
tshoot tshoot shooting<BR>
Keywords            : nthowto smsadmin smshowto smsinv smsmaintman<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
