

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Err Msg: "Not Enough Memory" When Free Memory Sufficient </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99345 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/05/26">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you are using Microsoft Excel, you may receive the error message,  Not Enough Memory,  when you open a file or enter data into a sheet while other  large files are open. This error message may occur even when there appears  to be sufficient free...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QABN,QBW6,QAB4,QA5V,QBWS,QA6Z,QAJB,QAYY,QAKC,QDNZ,QBVV,QBC6,QA4F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Err Msg: "Not Enough Memory" When Free Memory Sufficient</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99345 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0, 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you are using Microsoft Excel, you may receive the error message, "Not
Enough Memory," when you open a file or enter data into a sheet while other 
large files are open. This error message may occur even when there appears 
to be sufficient free memory to open the additional file or enter
additional data. If this is the case, Microsoft Excel may be exceeding one 
of its internally set memory limits.
<P>
To check your available memory, click About Microsoft Excel on the Help 
menu in Microsoft Excel for Windows or on the Apple menu in Microsoft Excel 
for the Macintosh.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, there are two categories of internal memory limits: the 
cell table and the heap space. If you reach a limit for one of these
categories, you will receive the "Not Enough Memory" error message.
<P>
<P><h3>Cell Table</h3>
 
<P>
In this category, there are two internally set limits. The first is a
limit on the number of rows that can contain data in each instance of
Microsoft Excel. The second is a limit on the memory allocated to each
cell.
<P>
The cumulative number of rows on all open worksheets that can contain
data is approximately 37,120. For every 16 rows of data, there is one
selector allocated which essentially keeps track of those rows. For
each Microsoft Excel session, there is a limit of approximately 2,320
selectors which indicates a maximum of approximately 37,120 rows of
data.
<P>
For example, if you open two sheets that each contain 16,384 (the
maximum per sheet) rows of data, and you attempt to open a third sheet
with 5,000 rows of data, you will receive the "Not Enough Memory"
error message. If you close one of the sheets containing 16,384 rows
and then open the sheet containing 5,000 rows, it will open
successfully. Alternatively, you can keep the larger two sheets open
if you run a second instance of Microsoft Excel; you can then open the
sheet with 5,000 rows. (If you are using  Microsoft Excel for the
Macintosh, you can only run a second instance of Microsoft Excel if
you have two separate copies of the application on your hard drive.
You can then run each application once.)
<P>
The second internally set limit affects individual cells rather than
the length of the whole cell table. For each cell used in a worksheet,
an 8-byte memory block is allocated. If the information in a cell is
too complex to be contained in 8 bytes, the cell table contains a
pointer to a block in the second category of memory, the Heap Space.
<P>
<P><h3>Heap Space</h3>
 
<P>
In addition to containing more complex formulas, the heap space
contains information for the worksheet such as formatting, borders,
fonts, defined names, and other non-cell type data such as embedded
objects and pictures. Microsoft Excel can use up to 16 megabytes (MB)
of available memory for the heap space.
<P>
If your machine has more than 16 MB of available RAM, and if your open
worksheets contain a large number of complex formulas (thereby
exceeding the cell memory block limit), a large amount of formatting
and/or non-cell data such as graphic and embedded objects, you are
more likely to exhaust the 16 MB heap space allocation before you
reach the row limit. In this case, reduce the number of fonts used in
the worksheet, simplify formatting, reduce the number of graphic
or embedded objects, and use array formulas to fill similar formulas
into adjacent cells.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 4.00a 4.00 OOM out not internal
<P>

Keywords          : kberrmsg<BR>
Version           : WINDOWS:3.0,4.0,4.0a,5.0; MACINTOSH:3.0,4.0,5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
