

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Error Setting Macro Description or Selecting Options </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136312">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1995/09/06">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You may receive unexpected behavior when you perform certain actions in the Object Browser dialog box.     If you are using Microsoft Excel Windows 95    -------------------------------------------     The following error message may occur when you...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBMH,QDM0,QAB4,QAFF,QAH4,QAPN,QBXS,QDKW,QAWI,QAEF,QAKP,QDKA,QBWS,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Error Setting Macro Description or Selecting Options</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136312</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive unexpected behavior when you perform certain actions in the
Object Browser dialog box.
<P>
<PRE>   If you are using Microsoft Excel Windows 95
   -------------------------------------------

   The following error message may occur when you click Options:

      This program has performed an illegal operation and will be shut
      down. If the problem persists, contact the program vendor.

   When you close the dialog box, Microsoft Excel will be shut down.

   If you are using Microsoft Excel version 5.0 or 5.0c
   ----------------------------------------------------

   When you enter a description in the Macro Options dialog box and click
   OK, you may receive the following error message:

      An error has occurred in your application. If you choose Ignore, you
      should save you work in a new file. If you choose Close, your
      application will terminate.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when you attempt to set the macro options for a
subroutine that takes a user-defined data type as an argument.
Specifically, in Microsoft Excel version 7.0, this problem occurs when you
display the Object Browser, select the macro, and click Options. In
Microsoft Excel version 5.0, this problem occurs when you display the
Object Browser, select the macro, click Options, enter a description, and
click OK.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, remove the user-defined data type argument
from the procedure and enter the description for the subroutine.
<P>
<P><h3>Example</h3>
 
<P>
For example, if you press F2 to display the Object Browser and attempt to
set the macro options for subroutine "b" in the example below, one of the
error messages described above will be displayed.
<P>
Private Type MyDefinedType
i As Integer
s As String
End Type
<P>
<PRE>Sub b(My As MyDefinedType)
End Sub

</PRE>To work around this problem, remove the argument for subroutine b, as in
the following example:
<P>
<PRE>   Sub b()
   End Sub

</PRE>After the argument is removed, use the object browser to set the
description. Once that is completed, you can change the definition of the
subroutine back to include the user-defined data type argument, as in the
following example:
<P>
<PRE>   Sub b(My as MyDefinedType)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory: xlwin
<P>

Additional reference words: 7.00 5.00 5.00c hang crash gp fault general<BR>
protection page gpf custom
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
