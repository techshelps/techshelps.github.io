

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Link Broken Moving WorkSheet Linked to Function Procedure </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109186">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1993/12/23">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you move a worksheet that contains a link to a function procedure, and then move the module containing the function procedure to a new workbook, the worksheet cell containing the link to the function procedure may display the...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAB9,QBV8,QA9N,QACI,QANJ,QAEF,QBVP,QAUJ,QAE2,QDNM,QAH4,QBJZ,QAJZ,QBXA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Link Broken Moving WorkSheet Linked to Function Procedure</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109186</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you move a worksheet that contains a link to a
function procedure, and then move the module containing the function
procedure to a new workbook, the worksheet cell containing the link to the
function procedure may display the #NAME error value.
<P>
<P><h2>CAUSE</h2>
 
<P>
If you move a worksheet containing a link to a function procedure, and then
move the module containing the function procedure to a new workbook, the
link to the function procedure is lost. As long as the original worksheet
remains open, and you do not recalculate the cell containing the link, the
result of the function procedure is displayed in the cell that contains the
link. However, if you recalculate the cell containing the link, the #NAME
error value is displayed in the cell containing the link. For example, if
the workbook and module you move are the only sheets contained in the
workbook, the workbook closes when the last sheet is moved without saving
any changes and the link is lost.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To move a worksheet containing a link to a function procedure and the
module containing the function procedure to another workbook while
maintaining the link, move both sheets at the same time as follows:

<OL><P><LI>To select both the worksheet and the module sheet, click the worksheet
   tab, hold down the CTRL key, and click the module sheet tab.

<P><LI>From the Edit menu, choose Move or Copy Sheet. From the To Book box,
   select (new book) or the name of the workbook to which you want to move
   the sheets. Choose OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
When you enter a user-defined function in a worksheet, you can enter a
function contained in any open workbook. To enter a user-defined function
that is contained in the current workbook, you can use just the function
name, for example =Test(). However, to enter a user-defined function that
is contained in another workbook, you must include the workbook name, for
example =BOOK1.XLS!Test(). When you use the Function Wizard to insert a
function, the available functions are listed with the correct reference.
<P>
When you move a worksheet that contains a link to a user-defined function
that is contained in the same workbook, the link is broken if the reference
to the function is using the function name only. Even if the module
containing the function procedure is then moved to the workbook with the
worksheet containing the link, the function cannot be referenced using just
the function name. Once the module containing the function is moved, the
function must be referenced with the module name and the function name, for
example, =Module1.Test(). To insert the function with the correct reference
automatically, do the following:

<OL><P><LI>From the Insert menu, choose Function.

<P><LI>From the Function Category list, select User Defined.

<P><LI>From the Function Name list, select the desired function.
<P>
</OL>The Function Name list displays the correct reference to the function.
<P>
For more information about entering a user-defined function in a worksheet
or an overview of creating a user-defined function, choose the Search
button in Help and type the following:
<P>
<PRE>    user-defined functions
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 7.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
