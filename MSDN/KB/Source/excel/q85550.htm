

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Fetch Command with Joined Q+E File Returns Blanks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q85550 ">
<META NAME="KBModify" CONTENT="1994/11/04">
<META NAME="KBCreate" CONTENT="1992/06/14">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAEF,QAGB,QAUD,QAI4,QAC6,QDO5,QDIJ,QABH,QABI,QBWS,QDNZ,QAFO,QBV8,QAY4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Fetch Command with Joined Q+E File Returns Blanks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 4, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q85550 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



Summary:
<P>
When an Excel macro that fetches data from a Q+E Query file with a
one-to-many join, the query will show blanks instead of duplicate
records. These blanks will cause the empty cells to be formatted as
text when the data is placed into the Excel Worksheet.
<P>
This may pose problems when running an ISBLANK() Macro loop or
executing other Excel commands.
<P>
<P><h3>Workaround</h3>
 
<P>
Delete the blanks in the Excel file or modify the test in the loop to
check for empty quotes instead of ISBLANK().
<P>
More Information:
<P>
The fetch command actually writes "" or a NULL text value into the
cell and changes the status of the cell to not blank. In order to
change the status of this cell to empty, the cell must be cleared or
deleted.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
Run an Excel Macro to:

<OL><P><LI>Execute QE.
<P>
   chan=INITIATE("QE","System")

<P><LI>Open a file and join two files in a one-to-many relationship in Q+E,
   (leaving blank fields instead of a duplicate field). An example
   of the results of this join can be viewed on page 15 of the Q+E
   for Microsoft Excel User's Guide.
<P>
   =EXECUTE(chan,"[OPEN('SELECT DEPT_ID, DEPT_NAME, LOC_ID,
   MGR_ID, FIRST_NAME, LAST_NAME, EMP_ID, HIRE_DATE, SALARY,
   EXEMPT, INTERESTS FROM C:\EXCEL\QE\DEPT.DBF,
   C:\EXCEL\QE\EMP.DBF WHERE DEPT.DEPT_ID = EMP.DEPT')]")

<P><LI>Fetch the information into an Excel spreadsheet.
<P>
   =EXECUTE(chan,"[FETCH('EXCEL','SHEET1','R1:R100','ALL')]")
   =TERMINATE(chan)
   =RETURN()

<P><LI>Check the blank cells in the Excel spreadsheet by choosing
   CTRL+F2 or Window Show Info and selecting Value. The value
   will show as double quotes, indicating that the cell is not
   empty but simply blank.
<P>
</OL>Reference(s):
<P>
"Microsoft Excel Function Reference," version 3.0, pages 70, 130-131,
135
<P>
"Q+E for Microsoft Excel User's Guide," version 3.0, pages 82, 96
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 4, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
