

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cannot Use a Function as a Condition in a Q+E Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79268 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1991/12/17">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QA2Q,QAG2,QBWS,QAY5,QAJQ,QAY2,QAKD,QAGJ,QAB9,QBV8,QDI1,QBXS,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cannot Use a Function as a Condition in a Q+E Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79268 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



Summary:
<P>
The Select Add Condition command in Q+E is unable to process functions
such as DATE or LEFT for the value in its dialog box. If a function is
entered in the Value box, Q+E will try to interpret the text as the
literal value, which may or may not be a valid query. In most cases,
some type of invalid query warning will be displayed.
<P>
To use this type of function in a query, you must add it through the
Select SQL Query dialog box. For example:
<P>
<PRE>   SELECT Name, DateEntered, Amount FROM sales.dbf
   WHERE DateEntered = Date()

</PRE>More Information:
<P>
Q+E checks to see if the value entered in the Add Condition dialog box
is the same type or can be converted to the same type as the column
that it is testing against. If it can convert it, then it will use
that value; however, it will not calculate a formula entered there. So
the LEFT function would indicate to Q+E that it should display all the
records in which field is equal to the word "Left" followed by an open
and close parenthesis.
<P>
<P><h3>Example</h3>
 
<P>
A more complete example of how to use a function is as follows:
<P>
Suppose you want to select the names of all the employees in EMP.DBF
that were hired this month.
<P>
In Q+E, the function (DATE()-DAY(DATE())+1) will calculate the first
day of the current month.
<P>
For this example, change the hire dates for the following employees in
EMP.DBF to a day of the current month you are in:
<P>
<PRE>   Tyler Bennett
   John Rappl

</PRE><P><LI>Open EMP.DBF in Q+E.

<P><LI>Select all the fields except FIRST_NAME, LAST_NAME and HIRE_DATE.

<P><LI>From the Layout menu, choose Remove Field.

<P><LI>Select the field HIRE_DATE.

<P><LI>From the Select menu, choose Add Condition.

<P><LI>Select Greater or Equal.

<P><LI>Modify the Value Box in the Add Condition dialog box to:
<P>
<P><PRE>      DATE()-DAY(DATE())+1)
</PRE>
<P><LI>Choose OK.
<P>
</OL>You will get the Warning message: Missing separator in date field:
<P>
To create the proper query:

<OL><P><LI>Perform steps 1-3 above.

<P><LI>From the Select menu, choose SQL Query.

<P><LI>Modify the query to contain:
<P>
<P><PRE>      SELECT FIRST_NAME, LAST_NAME, HIRE_DATE FROM EMP.DBF
      WHERE HIRE_DATE &gt;= (DATE()-DAY(DATE())+1);
</PRE>
<P><LI>Choose OK.
<P>
</OL>The query will report all the employees who were hired from the first
day of the current month to the current date. The resulting query
window will show you something like the following:
<P>
<PRE>   Tyler     Bennett     12/1/91
   John     Rappl     12/13/91

</PRE></OL>Reference(s):
<P>
"Q+E for Microsoft Excel User's Guide," version 3.0, pages 12-14,
131-133
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
