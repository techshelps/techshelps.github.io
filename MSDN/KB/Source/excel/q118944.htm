

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: "No Documents" Menu Bar Displayed When Document Is Open </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118944">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/08/02">
<META NAME="Keywords" CONTENT="kbprog kbcode">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, when you run a Visual Basic, Applications Edition, macro that displays a dialog box while there are no documents in the application window, and if a control is assigned to the dialog box that opens, unhides, or adds ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QBJZ,QAH4,QBVP,QBS0,QBWS,QAGB,QAF0,QANS,QANX,QAPN,QDKW,QAK3,QAUD,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: "No Documents" Menu Bar Displayed When Document Is Open</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118944</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, when you run a Visual Basic, Applications
Edition, macro that displays a dialog box while there are no documents in
the application window, and if a control is assigned to the dialog box that
opens, unhides, or adds a workbook when the dialog box is dismissed or
hidden, you may experience the following problems:

<UL><LI>The "No Documents" menu bar is still displayed when the dialog box is
   dismissed (even though there may be a document in the application window
   once the dialog box is closed).
<P>
   -and-

<LI>If you attempt to exit Microsoft Excel in this state, you may receive a
   general protection (GP) fault, and receive the error message:
<P>
<P><PRE>      Excel caused a General Protection Fault in module EXCEL.EXE at
      0042:0CBE
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, create a macro that displays the dialog box
and, if OK is clicked, adds a new workbook after the dialog box is hidden.
When you assign macros to controls on a dialog sheet, the macro is run and
then the dialog box is hidden.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Example</h3>
 

<OL><P><LI>Close all open documents.

<P><LI>Create a new workbook by clicking New on the File menu.

<P><LI>On the Insert menu, click Macro, and then click Module to insert a
   new module in the workbook.

<P><LI>Type the following code on the module sheet:
<P>
<P><PRE>     Sub ShowDialogToAddWorkbook()
     Dim Response as Integer
<PRE></PRE>                 Response = Thisworkbook.DialogSheets(1).Show
          If Response then Workbooks.Add
     End Sub

</PRE><P><LI>On the Insert menu, click Macro, and then click Dialog to insert a
   dialog sheet in the workbook.

<P><LI>Hide this workbook by clicking Hide on the Window menu.
<P>
</OL>The application window should be empty (there are no documents visible).

<OL><P><LI>On the File menu, click Macro, select the ShowDialogToAddWorkbook
   macro, and click Run. When the dialog box is displayed, click OK.
<P>
</OL>A new workbook will appear in the window and the worksheet menu bar will be
displayed.
<P>
<P><h3>Alternate Workaround</h3>
 
<P>
Set the Visible property of the Workbook where your Dialogs(x).Show
statement is contained to True prior to executing the Dialogs(x).Show
statement. Return it to False after the dialog is dismissed.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Show method for dialog boxes will return a value of False (or 0) under
the following conditions:

<UL><LI>A dialog box button with the Cancel property is chosen.

<LI>The dialog box is closed by pressing the ESC key.

<LI>The dialog box is closed by choosing Close from the control menu in the
   upper-left corner of the dialog box.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory: kbcode
<P>

Additional reference words: 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
