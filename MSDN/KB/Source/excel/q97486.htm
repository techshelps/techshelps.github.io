

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Multiple Select List Boxes in a Custom Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97486 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/04/13">
<META NAME="Keywords" CONTENT="kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can use a standard list box to create a multiple selection list box in a custom dialog box. To select multiple contiguous items from the list box, hold down the SHIFT key. To make non-contiguous selections hold down CTRL in ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBVP,QA2Q,QA01,QAG2,QAUJ,QAE1,QBWS,QBXT,QA5V,QAM9,QALX,QAIB,QBXS,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Multiple Select List Boxes in a Custom Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97486 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a
<LI>Microsoft Excel for OS/2, version 3.0
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can use a standard list box to create a multiple
selection list box in a custom dialog box. To select multiple contiguous
items from the list box, hold down the SHIFT key. To make non-contiguous
selections hold down CTRL in Microsoft Excel for Windows or COMMAND in
Microsoft Excel for the Macintosh. The results of your choices will be
stored as an array.
<P>
To access more than one item from a list box, type a name in the
Init/Result column for the list box line (item number 15) in the dialog
definition. If the Init/Result column contains a name, the list box becomes
a multiple-selection list box.
<P>
NOTE: In versions of Microsoft Excel prior to 3.0 you can select only one
item from a custom list box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a multiple selection list box:

<OL><P><LI>From the File menu, choose New and select the Macro Sheet option.

<P><LI>Enter the following dialog definition table into the macro sheet:
<P>
<PRE>      B1:Item#  C1:X   D1:Y   E1:Width F1:Height G1:Text      H1:Result
      B2:       C2:    D2:    E2:298   F2:  154  G2:Food List H2:
      B3:15     C3:10  D3:6   E3:276   F3:  110  G3:list      H3:array
      B4:1      C4:200 D4:123 E4:88    F4:  28   G4:OK        H4:

   NOTE: If the name "array" (cell H3) has not been previously defined,
   Microsoft Excel creates the name when the dialog box is opened. The
   name must refer to a single number or a one-dimensional array of
   numbers (vertical or horizontal array) corresponding to the positions
   in the list of the initially selected values (such as, ={1,4,10}).

</PRE><P><LI>Select the range B2:H4, and choose Define Name from the Formula
   menu. In the Name box, type "dialog" (without the quotation marks)
   and choose the OK button.

<P><LI>Type the following items in the macro sheet:
<P>
<PRE>      J1: LIST            K1: YOU SELECTED:
      J2: apples
      J3: bananas
      J4: carrots

</PRE><P><LI>Select cells J2:J4 and choose Define Name from the Formula menu. In
   the name box, type "list" (without the quotation marks), and choose
   the OK button.

<P><LI>Type the following macro:
<P>
<P><PRE>      A1:=CLEAR(SELECT(K2:K4))
      A2 =DIALOG.BOX(dialog)
      A3:=FOR("counter",1,COUNT(array))
      A4:=INDEX(array,counter)
      A5:=FORMULA(OFFSET(J1,A4,0),OFFSET(K1,COUNTER,0))
      A6:=NEXT()
      A7:=RETURN()
</PRE><P>
   Note that in the above macro:
<P>
<P><PRE>    - Line 1 clears the previously selected items.
</PRE><P>
<P><PRE>    - Line 2 calls the dialog box.
</PRE><P>
<P><PRE>    - Line 3 starts a loop with the counter initially set to 1, and
      loops as many times as the number of items you chose.
</PRE><P>
<P><PRE>    - Line 4 uses the index and counter arguments to find the next
      choice.
</PRE><P>
<P><PRE>    - Line 5 uses the number returned in A3 to select the text
      equivalent in LIST, and then displays it in the YOU SELECTED box
      (in cell K1).
</PRE><P>
<P><PRE>    - Line 6 increments the FOR loop.
</PRE><P>
<P><PRE>    - Line 7 ends the macro.
</PRE><P>
</OL>When you run the macro, it will put the items you selected from the
multiple list box in cell K1 (under the cell cell titled "YOU SELECTED").
The selected items are stored under the defined name "array" (to see this
defined name, choose Define Name from the Formula menu--you should see
something similar to ={1,2,4} in the Refers To box, indicating that you
picked the first, second, and fourth items in the list).
<P>
Each time you run the dialog box, the items you selected the last time you
ran the dialog box will be displayed as the selected items. To set the
default for the selected items to the first item in the list, add the
following line to your macro before the =DIALOG.BOX(DIALOG) line:
<P>
<PRE>   =SET.NAME("array",1)

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"User's Guide 2," version 4.0, page 276-277
"User's Guide," version 3.0, page 636-637
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: HOWTO custom select 3.00 4.00 4.00a<BR>
Keywords          : kbfasttip<BR>
Version           : WINDOWS:3.0,4.0,4.0a; OS/2:3.0; MACINTOSH:3.0,4.0<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
