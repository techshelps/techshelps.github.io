

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: GP Fault After Sorting List That Contains Subtotals </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120005">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/08/30">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you sort a filtered list that contains subtotals, you receive a general protection (GP) fault when you then perform any other action in the application.  CAUSE =====  Normally, the Undo Sort command is not available after per...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBKN,QAB6,QAE1,QBJZ,QDN0,QBXS,QAGC,QAEF,QBST,QBV8,QAB9,QA5C,QAXC,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: GP Fault After Sorting List That Contains Subtotals</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you sort a filtered list that contains
subtotals, you receive a general protection (GP) fault when you
then perform any other action in the application.
<P>
<P><h2>CAUSE</h2>
 
<P>
Normally, the Undo Sort command is not available after performing a
sort on a list in Microsoft Excel. However, if you add subtotals to a
list of data, filter this list, and then sort the list, the Undo Sort
command is available on the Edit menu. When you chose this command,
or perform any other action in Microsoft Excel, such as opening
another workbook, or editing a cell, you receive a GP fault.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving a GP fault after you sort a filtered list that contains
subtotals, do either of the following:

<UL><LI>Add subtotals to your list AFTER you sort your list. Because the Sort
   removes the subtotals from your list, you do not lose any functionality,
   and this is the preferred workaround.
<P>
   -or-

<LI>Sort your list BEFORE you filter the list.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel version 5.0c for Windows.
<P>
In Microsoft Excel version 5.0c, under the above conditions, when you
display the Edit menu, the Can't Undo command is listed, and unavailable,
indicating that you cannot undo the Sort command.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you add subtotals to a list in Microsoft Excel, and you then use
the Sort command on the Data menu, you receive the following message:
<P>
<PRE>   This removes the subtotals and sorts again. If you want to sort the
   subtotaled groups, choose the Cancel button; then collapse the outline
   and try again.

</PRE>If you choose OK to continue with the Sort, and then choose Undo Sort
from the Edit menu, you receive the GP fault as described above.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For an Overview Of Sorting A List, choose the Search button in Help and
type:
<P>
<PRE>    sorting
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 gpf gray grey greyed
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
