

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Converting Decimal to Hex and Hex to Decimal </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q46518 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/07/06">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  To convert decimal integers into their hexadecimal equivalents as text, enter the following commands into a macro sheet:     A1:  ToHex    A2:  =ARGUMENT( x ,1)    A3:  =SET.NAME( n ,INT(LOG(x)/LOG(16)))    A4:  =SET.NAME( hex ,  )    A5:  =WHILE(n...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2F,QBE7,QBE6,QAH4,QBXS,QAUD,QANY,QAKC,QBWS,QA4Q,QATX,QAB9,QBVP,QAY5,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Converting Decimal to Hex and Hex to Decimal</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q46518 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 1.x, 2.2, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To convert decimal integers into their hexadecimal equivalents as
text, enter the following commands into a macro sheet:
<P>
<PRE>   A1:  ToHex
   A2:  =ARGUMENT("x",1)
   A3:  =SET.NAME("n",INT(LOG(x)/LOG(16)))
   A4:  =SET.NAME("hex","")
   A5:  =WHILE(n&gt;0)
   A6:  =SET.NAME("hex",hex&amp;CHAR(INT(x/16^n)+48+
           IF(INT(x/16^n)&gt;9,7,0)))
   A7:  =SET.NAME("x",MOD(x,16^n))
   A8:  =SET.NAME("n",n-1)
   A9:  =NEXT()
  A10:  =RETURN(hex&amp;CHAR(x+48+IF(x&gt;9,7,0)))

</PRE>To define the macro, do the following:

<OL><P><LI>Select the cell A1 (the cell containing "ToHex").

<P><LI>From the Formula menu, choose Define Name.

<P><LI>In the Macro box, select Function and click OK.
<P>
</OL>To convert hexadecimal strings into their decimal integer equivalents,
enter the following commands into a macro sheet:
<P>
<PRE>   B1:  ToDec
   B2:  =ARGUMENT("x",2)
   B3:  =SET.NAME("dec",0)
   B4:  =FOR("i",1,LEN(x),1)
   B5:  =SET.NAME("n",CODE(MID(x,i,1)))
   B6:  =SET.NAME("dec",dec*16+n-48-IF(n&gt;57,39,0))
   B7:  =NEXT()
   B8:  =RETURN(dec)

</PRE></OL>To define the macro, do the following:

<OL><P><LI>Select the cell B1 (the cell containing "ToDec").

<P><LI>From the Formula menu, choose Define Name.

<P><LI>In the Macro box, select Function and click OK.
<P>
</OL>To run the macros:

<OL><P><LI>Select a cell on the worksheet to contain the converted value.

<P><LI>From the Formula menu, choose Paste Function.

<P><LI>Choose the appropriate function from the list. For example, if your
   macro sheet is named "Macro1", the ToHex function macro appears as
   as "Macro1!ToHex" in the Paste Function dialog box and the ToDec
   macro appears as "Macro1!ToDec".

<P><LI>Click OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The ToHex macro's algorithm is as follows:

<OL><P><LI>Compute the largest power of 16 less than "x".

<P><LI>Initialize hex (the return string) to null.

<P><LI>Assume that x is greater than 15 (more than one hex digit remaining
   to process...).

<P><LI>Compute the current hex digit. The current hex digit is based on
   the current value of x divided by 16^n, so add this number to
   48 (ASCII of "0"). Then, if x is greater than 9, convert to A-F by
   adding 7 more. Finally, convert this integer to text using CHAR().

<P><LI>Subtract the current hex digit from x and decrement the power
   of 16 (contained in n).

<P><LI>End the loop.

<P><LI>Append the final hex digit (the case of n=0) onto the hex string.
<P>
</OL>The ToDec macro's algorithm is as follows:

<OL><P><LI>Initialize dec (the return integer) to zero.

<P><LI>Set up a loop to count each character in the text string.

<P><LI>Get the ASCII number of the current hex digit.

<P><LI>Multiply the current total by 16 and add the next hex digit (the
   IF() calculates the offset for A-F).

<P><LI>End the loop and return to dec.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 1.0 1.00 1.03 1.04 1.06 1.5 1.50 2.2<BR>
2.20 3.0 3.00
<P>

KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 1.50 2.20 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
