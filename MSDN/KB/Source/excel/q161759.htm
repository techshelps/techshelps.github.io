

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Query Is Not Executed in the Background </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161759">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1997/01/03">
<META NAME="Keywords" CONTENT="xlquery kbinterop kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you run a query in Microsoft Query, the query is not run in the background (asynchronously).  CAUSE =====  This problem occurs when one of the following conditions is true:   - The Open Database Connectivity (ODBC) driver you use to create the...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QACF,QAUR,QABH,QABI,QBWS,QDKS,QAU7,QA9E,QAYY,QAPW,QAUD,QAEF,QBVV,QAPN P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Query Is Not Executed in the Background</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161759</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a query in Microsoft Query, the query is not run in the
background (asynchronously).
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when one of the following conditions is true:

<UL><LI>The Open Database Connectivity (ODBC) driver you use to create the query
   does not support asynchronous queries.
<P>
<P><PRE>    -or-
</PRE>
<LI>You record or run a macro while the query is executing.
<P>
<P><PRE>    -or-
</PRE>
<LI>You do not save the query definition with the worksheet.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To run your query asynchronously, use the appropriate method:

<UL><LI>Ensure that the ODBC driver you use to create the query supports
   asynchronous queries.
<P>
   -or-
<P>
</UL>- Do not record or run a macro while the query is executing.
<P>
<PRE>   -or-

</PRE><LI>Save the query definition with the worksheet.
<P>
</UL>NOTE: When you create a new query in Microsoft Excel 97, the query is saved
with the worksheet by default. Clearing the Save Query Definition check box
in the "External Data Range Properties" dialog box permanently removes the
query definition from the workbook. If you do not save the query definition
with the worksheet, you cannot execute asynchronous queries.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Asynchronous Queries</h3>
 
<P>
Microsoft Excel 97 can execute a query in the background, or
asynchronously. Microsoft Excel 97 can execute a query and get data
asynchronously with ODBC drivers that support asynchronous behavior. All
Microsoft ODBC 3.0 drivers support asynchronous executions. Asynchronous
execution runs the query in the background so that control is returned to
Microsoft Excel while the external data is retrieved.
<P>
Earlier versions of Microsoft Excel use synchronous queries only. With
synchronous queries, you cannot run the query in the background, and the
query must be finished before control is returned to Microsoft Excel.
<P>
<P><h3>Saving Query Definitions and Enabling Background Refresh</h3>
 
<P>
After you select the option to return data to Microsoft Excel from
Microsoft Query or the Query Wizard, the "Returning External Data to
Microsoft Excel" dialog box appears. In this dialog box, click Properties.
The "External Data Range Properties" dialog box appears. To enable
background refresh, check both the Save Query Definition check box and the
Enable Background Refresh check box. (Both of these options are checked by
default.)
<P>
After the data is returned to Microsoft Excel, if you saved the query
definition with the worksheet, you may access the properties for the
external data range. To do this, use the following steps:

<OL><P><LI>Select a cell in the data range that contains the results of the query.

<P><LI>On the Data menu, point to Get External Data and click Data Range
   Properties.
<P>
</OL>Clearing the Save Query Definition check box after the query returns data
to the workbook permanently removes the query definition from the
worksheet, but the query results remain. If you clear the Save Query
Definition check box and click OK, you are unable to refresh the query or
change the data range properties.
<P>
For more information about executing background queries while a macro runs,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>     TITLE     : XL97: Background Queries Suspended While Macro Executes
     ARTICLE-ID: <B><A HREF="../vbapps/Q157090.htm">Q157090</A></B>

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about running background queries, click the Index tab
in Microsoft Excel Help, type the following text
<P>
<PRE>   queries, background

</PRE>and then double-click the selected text to go to the "Run a query in the
background or while you wait" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 async query asynch query msquery<BR>
Keywords          : xlquery kbinterop kbualink97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
