

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use Multiple OK Buttons in an Excel Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q40185 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/01/06">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you use multiple OK buttons in a user-defined dialog box in Microsoft Excel (dialog item numbers 1 and 3), your macro should check the DIALOG.BOX line to see what number was returned. If that cell returns a FALSE value, then a Cancel button was ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QA01,QAD7,QAKC,QAGC,QAGB,QA5D,QANX,QBC6,QAJD,QALW,QAG8,QBS0,QANS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use Multiple OK Buttons in an Excel Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q40185 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, versions 2.2, 2.21, and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you use multiple OK buttons in a user-defined dialog box in Microsoft
Excel (dialog item numbers 1 and 3), your macro should check the DIALOG.BOX
line to see what number was returned. If that cell returns a FALSE value,
then a Cancel button was chosen; otherwise, the cell returns an integer.
The number represents the position of the OK button in the dialog box
definition table, beginning with the second line in the table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you run the following example, a dialog box that contains three
buttons is displayed on the screen. If you choose the first one, cell A2
returns the number 1 because the first button is the second item in the
dialog box definition table. If you choose the second button, which is a
Cancel button, then cell A2 returns the value FALSE. If you click the third
button, then cell A2 returns the number 3.
<P>
A1: Button_Macro
A2: =DIALOG.BOX(B3:H5)
A3: =RETURN()
<P>
<PRE>B2: item C1:  x  D1:  y  E1: width F1: height G1:  text   H1:init/result
B3:  12  C2:  0  D2:  0  E2:  165  F2:  100   G2:            H2:
B4:   1  C3: 20  D3: 15  E3:  120  F3:  21    G3: Default OK H3:
B5:   2  C4: 20  D4: 40  E4:  120  F4:  21    G4: Cancel     H4:
B6:   3  C5: 20  D5: 65  E5:  120  F5:  21    G5: OK         H5:

</PRE>Note that in Microsoft Excel version 5.0, you can also use a Dialog sheet
to create a user-defined dialog box with multiple OK buttons. For more
information about dialog box controls in Microsoft Excel version 5.0, see
Chapter 11, "Controls and Dialog Boxes," in the "Microsoft Excel Visual
Basic User's Guide".
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: 2.00 2.01 2.10 2.21 2.20 3.00 4.00 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
