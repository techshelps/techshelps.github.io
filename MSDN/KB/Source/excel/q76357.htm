

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BREAK Command May Not Interrupt a Macro Loop in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76357 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/09/23">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKI,QAH4,QAHC,QAB9,QBVP,QADN,QAA7,QAPN,QAVX,QAVW,QAUD,QAHB,QBWS,QA2Q,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BREAK Command May Not Interrupt a Macro Loop in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76357 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The BREAK command is designed to interrupt a FOR-NEXT, FOR.CELL-NEXT,
or a WHILE-NEXT loop. However, BREAK does not interrupt a macro loop
if it is placed within a block IF statement.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Excel 3.0</h3>
 
<P>
There are two forms of the IF function (Form 1 and Form 2). Form 2 is
a block structure and can only be used on macro sheets. This form
allows you to execute more than one statement based on the outcome of
the IF statement's logical test.
<P>
If a BREAK statement is encountered within a loop, that loop is
terminated and the macro proceeds to the statement following the NEXT
statement. If the BREAK command is encountered within a Form 2 IF
function, the BREAK command will be ignored and the macro will enter
an infinite loop. The BREAK command executes properly if encountered
in a Form 1 (single-line) IF statement.
<P>
<P><h3>Workaround</h3>
 
<P>
Use a Form 1 IF command in place of the Form 2 IF command.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open a worksheet and enter the following:
<P>
<P><PRE>      A1:
<PRE></PRE>      A2:     10
      A3:     100

</PRE><P><LI>Open a macro sheet and enter the following:
<P>
<PRE>      A1:     =WHILE(ACTIVE.CELL()&lt;&gt;100)
      A2:     =IF(ACTIVE.CELL()&lt;&gt;"")
      A3:     =BREAK()
      A4:     =ELSE()
      A5:     =SELECT("r[1]c")
      A6:     =END.IF()
      A7:     =NEXT()
      A8:     =RETURN()

   Define the macro by selecting cell A1 and choosing Define Name from
   the Formula menu. Type "Test" (without the quotation marks) in the
   Name box, select Command and choose OK.

</PRE><P><LI>Select cell A1 on the worksheet as the active cell and run the
   macro by choosing Run from the Macro menu and selecting Test.
<P>
</OL>The macro enters an infinite loop and can only be halted by pressing the
ESC key on the keyboard.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 3.0, pages 22, 125-127
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
