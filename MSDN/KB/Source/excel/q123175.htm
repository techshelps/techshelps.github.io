

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: SOLVER.OK Only Uses Last Cell Range for Changing Cells </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123175">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/11/22">
<META NAME="Keywords" CONTENT="kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you turn on the macro recorder, and use the Solver Add-in, if you enter a range of cells in the By Changing Cells box, the recorded macro includes only the last range of cells.  Additionally, if you use the SOLVER.OK functi...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAML,QBVP,QAH4,QBS0,QDNZ,QAD7,QAY5,QALQ,QA5V,QANX,QDMR,QAPN,QAHE,QAB9,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: SOLVER.OK Only Uses Last Cell Range for Changing Cells</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123175</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you turn on the macro recorder, and use the
Solver Add-in, if you enter a range of cells in the By Changing Cells
box, the recorded macro includes only the last range of cells.
<P>
Additionally, if you use the SOLVER.OK function in either a Visual
Basic module, or a version 4.0 macro, only the value of the last cell
in the by_changing argument is changed when you run the procedure.
<P>
<P><h2>CAUSE</h2>
 
<P>
The SOLVER.OK function uses only the last cell in the by_changing
argument. This behavior occurs when you use the Solver Add-in in a
recorded macro, or when you use the SOLVER.OK function in a macro.
This behavior occurs when you use both the Visual Basic language, and the
version 4.0 macro language.
<P>
The following is an example of the code that is recorded if you use
the Solver Add-in, and you enter cells A1 and C1 in the By Changing
Cells box while recording a macro:
<P>
<P><h3>Visual Basic</h3>
 
<P>
<PRE>   Application.ExecuteExcel4Macro String:= _
      "[SOLVER.XLA]SOLVER!SOLVER.OK(!R3C1,3,4,(!R1C3))"
   Application.ExecuteExcel4Macro String:= _
      "[SOLVER.XLA]SOLVER!SOLVER.SOLVE()"

</PRE><h3>Version 4.0 Macro</h3>
 
<P>
<PRE>   =SOLVER.OK(!$A$3,3,4,(!$C$1))
   =SOLVER.SOLVE()

</PRE>Only the cell C1 reference is recorded (!R1C3 or !$C$1) even though
you entered both A1 and C1 in the By Changing Cells box. If you add a
cell reference to the by_changing arguments in either of the above
examples, only the value of the last cell referenced in the
by_changing argument is changed when you run the macro.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft
products listed at the beginning of this article. This problem was
corrected in Microsoft Excel version 5.0c.
<P>
Note that this is not a problem in Microsoft Excel for the Macintosh,
version 5.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For an Overview Of Working With Microsoft Excel Solver, choose the
Search button in Help and type:
<P>
<PRE>   Solver

</PRE>For more information about SOLVER.OK, choose the Search button in
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>   SOLVER.OK function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbtool<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 addins addin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
