

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Using Workgroup Extensions for Microsoft Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101363">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1993/07/12">
<META NAME="Keywords" CONTENT="kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following macro demonstrates the steps necessary to send electronic mail from a Microsoft Excel macro using Workgroup Extensions for Microsoft Excel. The purpose of this macro is to send a mail message to a person with the email alias  JillDoe ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAYC,QBXT,QA5V,QAIB,QBV0,QAH4,QBXS,QA9A,QAOG,QBCF,QDMO,QAEV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Using Workgroup Extensions for Microsoft Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101363</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.00a
WINDOWS
kbmacro
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0 and 4.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following macro demonstrates the steps necessary to send
electronic mail from a Microsoft Excel macro using Workgroup
Extensions for Microsoft Excel. The purpose of this macro is to send a
mail message to a person with the email alias "JillDoe" and to attach
the ARCHES.BMP file.
<P>
NOTE: Before you run the macro, you must load the file XLMAPI.XLL.
<P>
The macro is as follows
<P>
<PRE>          A
   1  auto_email
   2  =MAIL.LOGON(,"CoolPass",FALSE)
   3  =MAIL.NEW.MESSAGE()
   4  =SET.MAIL.MESSAGE(7,"JillDoe"))
   5  =SET.MAIL.MESSAGE(1,"My Test Message")
   6  =SET.MAIL.MESSAGE(8,"c:\windows\arches.bmp")
   7  =SET.MAIL.RECIPIENT(GET.MAIL.MESSAGE(9)+1,"JoUser",,2)
   8  =MAIL.SEND.MESSAGE()
   9  =MAIL.LOGOFF()
   10 =RETURN()

</PRE>where:

<UL><LI>Line 2 of the macro connects to mail using the password CoolPass.
   Note here that you MUST use the MAIL.LOGON() command even if you are
   currently logged into mail. MAIL.LOGON() establishes a mail session
   for this instance of Microsoft Excel only.

<LI>Line 3 creates a new, blank mail message.

<LI>Lines 4-6 use the SET.MAIL.MESSAGE() command to fill in the header
   information for the mail message. In each line, the first argument
   specifies which part of the mail header you are modifying (7 is
   recipient; 1 is subject text; 8 is attachment path and filename).

<LI>Line 7 uses the GET.MAIL.RECIPIENT() command to add JoUser to the
   cc (carbon copy) line of the mail message. The GET.MAIL.MESSAGE()
   command is used to get the total number of recipients and adding 1
   to it (which creates "room" for the person being added to the cc
   line).

<LI>Line 9 sends the email message.

<LI>Line 11 disconnects mail for this instance of Microsoft Excel.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
For more information on Workgroup Extensions for Microsoft Excel, or
to obtain the XLMAPI.XLL file, download the file MAPIDEMO.EXE from the
Microsoft Download Service at (425) 936-MSDL.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Workgroup Extensions for Microsoft Excel
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbmacro<BR>
KBSubcategory:
<P>

Additional reference words: 4.X 4.00 4.00a xl emailing electronic<BR>
WAKIT<BR>
Keywords          : kbmacro<BR>
Version           : 4.00 4.00a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
