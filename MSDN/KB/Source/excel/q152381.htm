

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Creating a Chart with Stacked and Unstacked Columns </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152381">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1996/06/12">
<META NAME="Keywords" CONTENT="xlchart kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, columns of data plotted to the same Value (Y) axis will be stacked in a single column when the stacked column subtype is selected. To achieve a combination of stacked and unstacked columns that appear side by side, both data man...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QAE1,QBWS,QBVP,QAIX,QAA7,QDMN,QA2Q,QAEF,QDNX,QAKD,QAG2,QBOM,QDIU,QBDZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Creating a Chart with Stacked and Unstacked Columns</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152381</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, columns of data plotted to the same Value (Y) axis will
be stacked in a single column when the stacked column subtype is selected.
To achieve a combination of stacked and unstacked columns that appear side
by side, both data manipulation and the use of a second Value (Y) axis is
required.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To achieve the desired result, the data to be stacked must be separated on
the worksheet from the unstacked data by blank columns. The number of blank
columns is determined by multiplying the number of unstacked data columns
by 2.
<P>
For example, 1 column of unstacked data * 2 = 2 blank columns, and 4
columns of unstacked data * 2 = 8 blank columns.
<P>
<P><h3>Sample Data Where Columns D and E Are Completely Blank</h3>
 

<OL><P><LI>Type the following into a worksheet:
<P>
<PRE>       A1:       B1: 1991     C1: 1992     D1:     E1:     F1: 1993
       A2: a     B2: 0.24     C2: 0        D2:     E2:     F2: 0.74
       A3: b     B3: 0.16     C3: 0.34     D3:     E3:     F3: 0.67
       A4: c     B4: 0.81     C4: 0.72     D4:     E4:     F4: 0.5
       A5: d     B5: 0.17     C5: 0.21     D5:     E5:     F5: 0.68
       A6: e     B6: 0.84     C6: 0.58     D6:     E6:     F6: 0.67

</PRE><P><LI>Highlight all of the data including the blank columns. On the Insert
    menu, click Chart, and then click As New Sheet. (To create an embedded
    chart click On This Sheet, instead.) In the Chart Wizard Step 2 of 5,
    choose Combination as the chart type and click Next. In Step 3 of
    5, click Next. In Step 4 of 5, choose Columns under Data Series In: and
    click Finish. Initially, the chart will have 2 unstacked columns and
    one line.

<P><LI>Because the primary (Y) axis should contain only the stacked data, the
    blank columns need to be plotted on the secondary (Y) axis. To change
    the Value axis of a blank series, select a visible series by clicking
    a data marker once. Do not double-click. The last argument in the
    series formula shown in the formula bar is the plot order number. The
    following is an example of a series formula for series 2 of a chart:
<P>
       =SERIES(Sheet1!$B$1,Sheet1!$A$2:$A$8,Sheet1!$B$2:$B$8,2)

<P><LI>Use the UP ARROW key on the keyboard to cycle through the series until
    the first blank series is selected. In the example, this is series 3 in
    column D.
<P>
    NOTE: You will not be able to select series 4 in column E, the second
    blank column. With the data used in the example, this, and all
    following series, are already plotted on the secondary value axis. By
    default, when creating a combination chart, Microsoft Excel will plot
    the first half of the data series to the primary value axis and the
    second half to the secondary value axis. If there is an odd number of
    data series, the extra series will be plotted to the primary value
    axis. Also, if the first series on the secondary value axis is empty,
    you will not be able to select this series.

<P><LI>On the Format menu, click Series. On the Axis tab, in the section
    marked Plot Series On, click Secondary Axis. This needs to be repeated
    for all blank columns not already plotted on the Secondary Value (Y)
    axis.
<P>
    NOTE: There are no other series on the primary axis in this example.

<P><LI>Because the desired chart has only columns, the line group needs to be
    changed to a column group. On the Format menu, click Line Group from
    the bottom of the list.

<P><LI>In the Format Line Group dialog box, click the Chart Type button.
    Change the chart type to Column, and then click Options. On the Options
    tab, change the Gap Width to 0, and then click OK.

<P><LI>The data to be stacked needs to be changed to the chart subtype of
    Stacked Column. To do this, click Column Group (not Column Group 2)
    on the Format menu. On the Subtype tab, select the stacked bar (the
    middle option), select the Options tab, and set the Gap Width to 200.
    Click OK.

<P><LI>Because it is not obvious which column is attached to which scale, both
    of the Value (Y) axes need to be set to the same scale. To do this,
    take note of the maximum value of the larger of the two axes, select
    the smaller of the two axes, and then click Selected Axis on the Format
    menu. On the Scale tab, change the maximum to match the larger axis,
    and then click OK.

<P><LI>To remove the secondary axis from the display, select the secondary
    axis and click Selected Axis on the Format Menu. On the Patterns Tab,
    select None in each of the four option boxes, and then click OK.
<P>
    NOTE: You must perform Step 9, regardless of whether the secondary axis
    is removed from the display.

<P><LI>To remove the blank series from the Legend, click the legend keys that
    have no corresponding labels. You must be sure to select the entire
    entry: label and marker. This can be verified by checking the name box
    on the far left of the formula bar. If the legend entry is properly
    selected, the name box will display "Legend Entry #" (without the
    quotation marks). If only the marker is selected, it will read "Legend
    Key #" (without the quotation marks). Click the Delete Key to remove
    the entry.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"User's Guide," version 5.0, Part 3, "Creating Charts from Worksheet Data,"
Chapters 15 - 19
<P>
For more information about chart creation, click Answer Wizard on the Help
menu and type:
<P>
<PRE>  Charts, Creating
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: overlay<BR>
Keywords          : xlchart kbtool<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
