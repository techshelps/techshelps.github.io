

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL7: MS Query Doesn't Work After Installing Visual Basic 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170680">
<META NAME="KBModify" CONTENT="1997/06/27">
<META NAME="KBCreate" CONTENT="1997/06/26">
<META NAME="Keywords" CONTENT="kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 7.0, if you click either Get External Data or  Refresh Data on the Data menu,  you may receive the following error messages:     Error Starting Program    A required .DLL file, MSO97RT.DLL, was not found.     -and-     Microsoft ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAA1,QBI0,QDI2,QDKX,QBVV,QA9N,QAEF,QAB4,QBJ2,QAYY,QAXB,QAH4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: MS Query Doesn't Work After Installing Visual Basic 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170680</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Query for Windows 95, version 2.0
<LI>Microsoft Visual Basic 5.0, Enterprise Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 7.0, if you click either Get External Data or "Refresh
Data on the Data menu," you may receive the following error messages:
<P>
<PRE>   Error Starting Program
   A required .DLL file, MSO97RT.DLL, was not found.

   -and-

   Microsoft Excel
   Cannot execute MSQRY32.EXE.

   -and-

   Microsoft Excel
   Couldn't restore connection to original database. Data not restored.

</PRE><h2>CAUSE</h2>
 
<P>
You receive these error messages if you install Microsoft Visual Basic 5.0,
Enterprise Edition, and Microsoft Excel 7.0 on the same computer.
<P>
Specifically, the problem occurs because Microsoft Visual Basic 5.0,
Enterprise Edition, includes new versions of the following Microsoft Query
files:
<P>
<PRE>   Msqry32.exe
   Qryint32.dll

</PRE>These new files are not compatible with Microsoft Excel 7.0.
<P>
Note that the problem does not occur if you install Microsoft Visual Basic
5.0, Professional Edition. Note also that the order in which you install
the programs does not matter.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, remove the new copies of Msqry32.exe and
Qryint32.dll, and then replace them with the Msqry32.exe and Qryint32.dll
files included with Microsoft Excel 7.0. To do this, use either of the
following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Copy the Msqry32.exe and Qryint32.dll files from a computer on which
Microsoft Excel 7.0 is installed to the following folder on your computer:
<P>
<PRE>   C:\Program Files\Common Files\Microsoft Shared\Msquery

</PRE>Replacing the newer versions of the files with the earlier versions should
eliminate the problem.
<P>
<P><h3>Method 2</h3>
 
<P>
To use this method, follow these steps:

<OL><P><LI>In Windows Explorer, open the Msquery folder on your computer.

<P><LI>Rename the existing copies of Msqry32.exe and Qryint32.dll.

<P><LI>On the Start menu, point to Settings, and click Control Panel.

<P><LI>Double-click Add/Remove Programs.

<P><LI>In the list of installed programs, click Microsoft Office Professional
   or Microsoft Office Standard. Then, click Add/Remove.

<P><LI>When it appears, click Reinstall.
<P>
</OL>When you reinstall Microsoft Office, new copies of the Msqry32.exe and
Qryint32.dll files are installed into the correct folder on your computer.
<P>
NOTE: If you do not rename the existing copies of the files first (see
steps 1 and 2), this process does not work.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 7.0, when you click Get External Data or Refresh Data on
the Data menu, Microsoft Excel invokes an instance of Microsoft Query,
which performs the process of querying and updating the data.
<P>
Because the Microsoft Query files included with Microsoft Visual Basic 5.0,
Enterprise Edition, are incompatible with Microsoft Excel 7.0, you may not
be able to perform new queries (Get External Data) or update existing
queries (Refresh Data) if you install both programs on the same computer.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL7 7.00a<BR>
Keywords            : kberrmsg kbusage<BR>
Version             : WINDOWS:2.0,7.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
