

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Incorrect Records Filtered or Extracted with TFE or AEE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98651 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/05/11">
<META NAME="Keywords" CONTENT="xllist">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use computed criteria to filter records in a list, or to extract records from a database, you may receive unexpected results if the Transition Formula Evaluation (TFE) (version 5.0 and later) or Alternate Expression Evaluation (AEE) is ena...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA5V,QA3P,QAPF,QBV8,QAB9,QAKR,QABH,QDMH,QAE5,QBWS P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Incorrect Records Filtered or Extracted with TFE or AEE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98651 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a and 5.0
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use computed criteria to filter records in a list, or to extract
records from a database, you may receive unexpected results if the
Transition Formula Evaluation (TFE) (version 5.0 and later) or Alternate
Expression Evaluation (AEE) is enabled (version 4.0). When this option is 
enabled, all records are extracted regardless of whether they match the 
specified criteria.
<P>
In the following example, the list or database is defined as A1:B4, the
computed criteria is the range D1:D2, and the extract range is D5:E5.
<P>
<PRE>   A1: One     B1: Two     D1:
   A2: 1       B2: 10      D2: =A2+B2=22
   A3: 2       B3: 20
   A4: 3       B4: 30
                           D5: One   E5: Two

</PRE>In Microsoft Excel version 5.0 and later, when you use the Advanced Filter 
to filter the records in the list above, the only record that should be 
returned is the record in A3:B3. However, if the Transition Formula 
Evaluation option is selected, all of the records are displayed.
<P>
In Microsoft Excel version 4.0, when you click Extract on the Data menu,
the only record that should be returned is the record in A3:B3. However, if
the Alternate Expression Evaluation option is selected, all of the records
are extracted.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To work around this problem, do one of the following:

<UL><LI>To receive the correct result when you are using both a computed
   criteria and TFE or AEE, use the field name of a field from the list or
   database as a Criteria heading. In the above example, you would change
   D1 to either One or Two.
<P>
<P><PRE>    -or-
</PRE>
<LI>Disable the TFE or AEE option by using the following steps.
<P>
   Microsoft Excel Version 5.0 and Later
   -------------------------------------
<P>
<P><PRE>      1. On the Tools menu, click Options (Preferences if you are using 
<PRE></PRE>         Microsoft Excel for the Macintosh.) 

      2. Click the Transition tab, and under Sheet Options, clear the
         Transition Formula Evaluation check box. Click OK.

   Microsoft Excel Version 4.0
   ---------------------------

      1. On the Options menu, click Calculation.

      2. In the Calculation Options dialog box, clear the Alternate
         Expression Evaluation check box. Click OK.

</PRE></UL><h2>MORE INFORMATION</h2>
 
<P>
Transition Formula Evaluation and Alternate Expression Evaluation are
designed to allow for differences between the way Microsoft Excel and Lotus
1-2-3 evaluate expressions. These options are automatically enabled when
you open a Lotus 1-2-3 worksheet in Microsoft Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 1," version 4.0, pages 57, 332-334
<P>
"Switching to Microsoft Excel from Lotus 1-2-3," version 4.0, pages
10-11
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.00a 5.00 AEE TFE<BR>
Keywords          : xllist<BR>
Version           : WINDOWS: 4.0, 4.0a, 5.0, 7.0, 97; MACINTOSH: 4.0, 5.0, 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
