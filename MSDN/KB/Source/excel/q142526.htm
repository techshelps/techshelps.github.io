

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: How to Determine Top/Bottom Used Cells in a Sparse Array </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142526">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1996/01/15">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article discusses how you can determine the beginning and end used rows of a range by using the IF, ISBLANK, MAX, MIN, and ROW functions. The results can provide information to other functions and can help you to determine variable ranges. Thi...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA5V,QAML,QDNZ,QDMR,QAUD,QAB9,QAKC,QBC6,QAH4,QAG8,QDL9,QBWO,QBWN,QAJB P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Determine Top/Bottom Used Cells in a Sparse Array</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142526</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses how you can determine the beginning and end used
rows of a range by using the IF, ISBLANK, MAX, MIN, and ROW functions.
The results can provide information to other functions and can help you
to determine variable ranges. This article provides formulas for finding
the first and last rows, plus an example of how you can select a variable
range using these formulas. The following example assumes that there is
at least one used cell. Complications caused by empty ranges are beyond
the scope of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>First Row</h3>
 
<P>
The formula to return the row number of the first used cell in a range is
as follows:
<P>
<PRE>   =MIN(IF(ISBLANK(A2:A400),17000,ROW(A2:A400)))

</PRE>As an alternative, to return the row of the first number, the formula is
as follows:
<P>
<PRE>   =MIN(IF(ISNUMBER(A2:A400),ROW(A2:A400),17000))

</PRE><h3>Last Row</h3>
 
<P>
The formula to return the row number of the last used cell in a range is
as follows:
<P>
<PRE>   =MAX(IF(ISBLANK(A2:A400),0,ROW(A2:A400)))

</PRE>As an alternative, to return the row of the last number, the formula is
as follows:
<P>
<PRE>   =MAX(IF(ISNUMBER(A2:A400),ROW(A2:A400),0))

</PRE><h3>How to use the results of these formulas</h3>
 
<P>
Because the answers returned by the formulas are the rows meeting the IF
condition statements, you can select the range from the top numerical
cell to the bottom numerical cell, excluding cells above and below that
used range. Note that unused cells can be inside the range and will not
be excluded by the example. The example looks for a number, therefore you
need to use the alternate formulas (that is, the formulas to find the row
of the first number and the row of the last number).
<P>
To determine the range, type all of the following into a single cell
outside the range A2:A400:
<P>
<PRE>   =SUM(OFFSET(A1,MIN(IF(ISNUMBER(A2:A400),ROW(A2:A400),17000)),0,
      MAX(IF(ISNUMBER(A2:A400),ROW(A2:A400),0))-
      MIN(IF(ISNUMBER(A2:A400),ROW(A2:A400),17000))+1,1))

</PRE>NOTE: There are no spaces in the above formula; multiple lines are used
only to fit the formula into this document. Do not include any spaces as
you type it into the cell.
<P>
All of the above are array formulas and may require the Array entry. If
you are using Microsoft Windows, press CTRL+SHIFT+ENTER. If you are using a
Macintosh computer, press COMMAND+RETURN.
<P>
If you use an array range in excess of 2,730 cells, you may receive an
error because array management is limited to one segment of memory (64K).
Some versions of Microsoft Excel may be able to use larger arrays,
depending on the internal length the code uses for number storage.
(Programs using 16-bit code can use larger arrays than programs using 32-
bit code.) This is by design in Microsoft Excel.
<P>
For additional information about this behavior in Microsoft Excel, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q137921.htm">Q137921</A></B>
   TITLE     : Error If Array Contains More Than 2730 Elements

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about Arrays in Microsoft Excel 7.0, click Answer
Wizard on the Help menu, and type:
<P>
<PRE>   What is an array?
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 7.00 8.00 97 XL97 98 XL98<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:5.0,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
