

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: 'Unable to Establish Connection' After Initial Login </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q61846 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1990/05/11">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If Continuous Connection is deselected when setting an external database, or Close Connection is selected, the Data Access macro will disconnect from the host computer but leave the external database commands available. Selecting one of these comma...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QBVP,QAI5,QDN1,QACF,QADN,QAA7,QAB7,QAFX,QAUD,QBG2,QBBI,QAIJ,QA5E,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: 'Unable to Establish Connection' After Initial Login</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q61846 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 2.2 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If Continuous Connection is deselected when setting an external
database, or Close Connection is selected, the Data Access macro will
disconnect from the host computer but leave the external database
commands available. Selecting one of these commands logs back into the
host to execute the command.
<P>
If the host computer is slow in disconnecting, selecting a menu
command immediately after selecting Close Connection or immediately
after Microsoft Excel has automatically closed the connection may
result in the error message "Unable to Establish Connection." Logging
back into the host at this point will generally succeed.
<P>
If this behavior is occurring, the "hosts.cl1" file can be modified to
cause Microsoft Excel to wait until the host is ready before
attempting to login.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Delaying login until the host computer is ready can be done one of
two ways:

<OL><P><LI>If the network has a prompt, [such as a greater than (&gt;) sign]
   Excel can be instructed to wait until it receives the prompt by
   entering a backslash followed by the letter "m" and the prompt.
   For example, to tell Excel to wait until it receives a greater-than
   prompt, enter \m&gt;.
<P>
   A typical start sequence in a "hosts.cl1" file might be
   \r\m&gt;\sconnect myvax. In this sequence, \r sends a return character,
   \m&gt; waits for a greater-than sign (up to the amount of time specified
   by connect2), and \s sends the text following it to the network (that
   is, the text "connect myvax").

<P><LI>If the network does not have a prompt, or if the prompt is unknown,
   instruct Microsoft Excel to wait a specified amount of time before
   logging into the host computer. To do this, enter a backslash
   followed by the letter "w" and a number to indicate how many seconds
   to wait. For example, \w5 will cause Microsoft Excel to wait five
   seconds after receiving the instruction to login before actually
   sending the login sequence.
<P>
   A typical start sequence in a "hosts.cl1" file might be
   \r\w5\sconnect myvax. In this sequence, \r sends a return character,
   \w5 waits for five seconds, and \s sends the text following it to
   the network (that is, the text "connect myvax"). Note that this
   method causes a delay of the specified amount before any attempt is
   made to connect to the host computer, even if the host computer is
   ready sooner than that. For this reason, the first method is
   preferred.
<P>
</OL>The general format for the login information in the "hosts.cl1" file
is as follows:
<P>
<PRE>   &lt;Connection Name&gt;:login:&lt;login attempts&gt;:&lt;logout sequence&gt;:
   &lt;Connect Delay 1&gt;:&lt;Connect Delay 2&gt;:&lt;Recovery sequence&gt;:
   &lt;Start Sequence&gt;:&lt;Connect Sequence&gt;

</PRE></OL>For more information on the configuration information, query on the
following words:
<P>
<PRE>   hosts.cl1 and configuration and login

</PRE>For more information on connecting to the host, query on the following
words:
<P>
<PRE>   close and connect and continuous and disconnect
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 2.2 2.20 3.0 3.00 paste fieldnames SQL<BR>
sequel extract mainframe CL1 DAL DAM
<P>

KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
