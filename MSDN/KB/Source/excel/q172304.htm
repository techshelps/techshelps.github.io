

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Cannot Use User-Defined Function in Demand-Loaded Add-in </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172304">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/08/01">
<META NAME="Keywords" CONTENT="xladdins kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you view the list of user-defined functions in the Function Wizard in Microsoft Excel 97, one or more function names may be missing. In addition, a function name may appear garbled.  CAUSE =====  This behavior occurs if the following condition...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QBJZ,QBS0,QAUR,QBWS,QBTI,QAVX,QAVW,QAY5,QAUJ,QAU7,QBQS,QDNE P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Cannot Use User-Defined Function in Demand-Loaded Add-in</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172304</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you view the list of user-defined functions in the Function Wizard in
Microsoft Excel 97, one or more function names may be missing. In addition,
a function name may appear garbled.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs if the following conditions are true:

<UL><LI>You save multiple user-defined functions in an add-in file.
<P>
<P><PRE>    -and-
</PRE>
<LI>You define the demand-loaded name, "__DemandLoad" (without the quotation
   marks) and set its value to "=TRUE" (without the quotation marks) in the
   add-in file.
<P>
<P><PRE>    -and-
</PRE>
<LI>You assign the user-defined functions to the User Defined category.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To resolve this problem, first obtain and install Microsoft Excel 97
Service Release 1 (SR-1). Then, if you saved the add-in in Microsoft Excel
97, perform the additional steps in "Add-ins Saved from Microsoft Excel 97"
section to resolve the problem.
<P>
<P><h3>Add-ins Saved from Microsoft Excel 97</h3>
 
<P>
<PRE>  1. On the File menu in Microsoft Excel 97 SR-1, click Open. In the
     Open dialog box, click the add-in file that you want to convert
     (for example, Test.xla), and then click Open.

  2. On the Tools menu, point to Macro, and then click Visual Basic
     Editor (or press ALT+F11).

     In the Project Explorer window in the Visual Basic Editor, entries
     similar to the following appear

        &lt;Project name&gt; (&lt;Add-in file name&gt;)

     where &lt;Project name&gt; is the name of the Visual Basic project, and
     &lt;Add-in file name&gt; is the name of an add-in file.

     For example, entries similar to the following appear:

        MyAddIn (Test)

  3. Click the plus sign (+) to the left of the entry for the add-in
     file.

  4. If you are prompted to type a password, type the password and click
     OK. Otherwise, skip to step 5.

     NOTE: If you do not know the password for the add-in file, you
     cannot convert it into a normal workbook. If you know who
     created the add-in file, ask the creator for the password.
     Otherwise, you cannot continue.

     Entries similar to the following appear in the Project Explorer
     window:

        MyAddIn (Test)
            Microsoft Excel Objects
            Modules

  5. Click the plus sign (+) to the left of "Microsoft Excel Objects."

     The tree should appear similar to the following:

        MyAddIn (Test)
            Microsoft Excel Objects
                Sheet1 (Sheet1)
                Sheet2 (Sheet2)
                Sheet3 (Sheet3)
                ThisWorkbook
            Modules

  6. Click ThisWorkbook.

  7. In the Properties window of the Visual Basic Editor, click IsAddin.
     In the box to the right of IsAddin, change the value from True to
     False.

  8. On the File menu, click "Close and Return to Microsoft Excel."

     The worksheets and chart sheets in the add-in file (if it contains
     any) should be visible.

  9. On the File menu, click Save As.

 10. In the Save As dialog box, click "Microsoft Excel Add-in" in the
     "Save as type" box. Type a new name for the add-in (for example,
     "Test.xla") in the file name box. Click Save to resave the add-in
     file.

 11. After you save the workbook, click Close on the File menu.

 12. Quit and restart Microsoft Excel 97.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97
for Windows. This problem was corrected in Microsoft Excel 97 SR-1.
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For additional information about creating an add-in from Excel 97, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q156942.htm">Q156942</A></B>
   TITLE     : XL97: How to Create an Add-in File in Microsoft Excel 97

</PRE>For additional information on creating Demand Loaded add-ins in previous
version of Microsoft Excel, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q120796.htm">Q120796</A></B>
   TITLE     : XL: How to Create a Demand-Loaded Add-in File
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 sr1<BR>
Keywords          : xladdins kbtool<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
