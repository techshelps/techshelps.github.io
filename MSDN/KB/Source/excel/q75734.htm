

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel Err Msg: Reference Is Not Valid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75734 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1991/09/02">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel 3.0 and 4.0 have a Consolidation feature that allows you to summarize large amounts of data from several worksheets. When specifying source areas, you can use the asterisk (*) and question mark (?) as wildcard characters in the file...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QBVV,QBD7,QAUJ,QAJZ,QDO5,QBFM,QAYY,QAHH,QAB3,QBTC,QDO9,QDMW,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel Err Msg: Reference Is Not Valid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75734 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0
<LI>Microsoft Excel for OS/2, version 3.0
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel 3.0 and 4.0 have a Consolidation feature that allows
you to summarize large amounts of data from several worksheets. When
specifying source areas, you can use the asterisk (*) and question
mark (?) as wildcard characters in the filename. However, using these
wildcard characters in conjunction with defined names may result in
the following error message:
<P>
<PRE>   Reference is not valid

</PRE><h2>MORE INFORMATION</h2>
 
<P>
There is a potential danger in using wildcards in conjunction with
defined names because there may be certain sheets that are not
intended to be part of the consolidation that DO satisfy the wildcard
but do NOT contain the defined name specified.
<P>
<P><h3>Example</h3>
 
<P>
Suppose your source sheets have labels which all start with SHEET and
each of these sheets has a range named "Data" defined on it. In the
Reference section of the Data Consolidate dialog box, you would enter
the following as your source:
<P>
<PRE>   SHEET*.XLS!Data (in Excel for Windows)
   SHEET*!Data (in Excel for the Macintosh)

</PRE>This entry will find any worksheet in the current directory beginning
with the letters "SHEET" and look for a defined name called "Data."
The problem occurs when the current directory contains a file that
satisfies the wildcard, such as SHEET4.XLS in Excel for Windows or
SHEET4 (without the extension) in Excel for the Macintosh. Excel won't
be able to find the defined name "Data" on that sheet and returns the
error message.
<P>
<P><h3>Solution</h3>
 
<P>
If you get the error message "Reference is not valid" when you are using
wildcards AND defined names at the same time, do one of the following:

<UL><LI>Verify that the current directory does not contain any files that
   match the wildcard from which you do not want to consolidate.
<P>
   -or-

<LI>Modify the wildcard so that no other files match the wildcard(s),
   except the ones from which you want to consolidate.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide 1," version 4.0, pages 381-382
<P>
"Microsoft Excel User's Guide," version 3.0, page 333
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kberrmsg<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
