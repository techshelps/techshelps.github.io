

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Query Hangs If Adding 256-Field Table from Excel Data Source </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150245">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1996/04/23">
<META NAME="Keywords" CONTENT="xlquery kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Query version 2.0 (32-bit for Windows 95), when you attempt to add a table containing 256 fields from a Microsoft Excel data source (that is, a Microsoft Excel spreadsheet that has been defined as a data source in Control Panel using t...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBI0,QDI1,QABM,QAK6,QBWS,QA7O,QAYY,QA7N,QBTX,QBTI,QBJZ,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Query Hangs If Adding 256-Field Table from Excel Data Source</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150245</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00
WINDOWS
kbtool kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Query, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Query version 2.0 (32-bit for Windows 95), when you attempt to
add a table containing 256 fields from a Microsoft Excel data source (that
is, a Microsoft Excel spreadsheet that has been defined as a data source in
Control Panel using the Microsoft Excel ODBC 3.0 driver) to the Query Table
window, Microsoft Query stops responding (hangs) while it attempts to add
the table to the query.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because the Microsoft Excel spreadsheet driver has a
limit of 255 fields. In Microsoft Query version 1.0 (16-bit for Windows
3.x), a table containing 256 fields can be added to the Query Table window,
but if you attempt to add all 256 fields to the data pane from the table,
you receive an error message.
<P>
For additional information about this problem in Microsoft Query version
1.0, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q123003.htm">Q123003</A></B>
   TITLE     : MSQUERY: Error Adding 256 Fields Using Excel Data Source

</PRE><h2>RESOLUTION</h2>
 
<P>
To avoid this problem, convert the Microsoft Excel data source to a dBASE
III or dBASE IV file by using the following steps:

<OL><P><LI>Open the Microsoft Excel file in Microsoft Excel 5.0 or 7.0.

<P><LI>Highlight the range of data (all 256 columns and as many rows as you
   want to include). On the Insert menu, point to Name, and then click
   Define.

<P><LI>Name the highlighted range Database.

<P><LI>On the File menu, click Save As. In the Save As Type dialog box, click
   either of the following
<P>
<P><PRE>      DBF 4 (dBASE IV) (.dbf)
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      DBF 3 (dBASE III)(.dbf)
</PRE><P>
   and then click Save. The file is saved with a .dbf file extension, which
   indicates a dBASE file.

<P><LI>In Windows 95, go to Control Panel, and double-click the 32bit ODBC
   icon.

<P><LI>In the Data Sources dialog box, click Add, and then click "Microsoft
   dBase Driver (*.dbf)" from the Installed ODBC Drivers list. Click OK.

<P><LI>In the ODBC dBase Setup dialog box, enter the new data source name and
   click dBase III or dBase IV from the version list. Click Select
   Directory and then click the directory where you saved the dBASE file.
   Click OK twice.

<P><LI>Make sure that the newly-defined data source is listed in the Data
   Sources dialog box, and then click Close.

<P><LI>Return to Query 2.0 and open a new query using the new dBASE
   data source.
<P>
</OL>The dBASE data source should allow you to add the table to the table pane,
and to add all 256 fields to the data pane.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in ODBC version 3.0 for
Windows 95 and Windows NT. We are researching this problem and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Query User's Guide," shipped with Microsoft Excel version 5.0
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprb<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 7.0 freeze
<P>

Keywords            : xlquery kbprb kbtool<BR>
Version             : 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
