

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: HYPERLINK Doesn't Work if Second Argument Returns Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158330">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/10/29">
<META NAME="Keywords" CONTENT="xlformula xlweb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you click a hyperlink in a Microsoft Excel worksheet, nothing happens.  CAUSE =====  This will occur if both of the following conditions are true:   - The hyperlink was created by a formula containing the HYPERLINK    worksheet function.      ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE2,QAUD,QAAP,QAB4,QBVP,QAKD,QAPN,QAHE,QAKP,QAB9,QAPF,QAUJ,QA3N,QAY5,QALW P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: HYPERLINK Doesn't Work if Second Argument Returns Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158330</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you click a hyperlink in a Microsoft Excel worksheet, nothing happens.
<P>
<P><h2>CAUSE</h2>
 
<P>
This will occur if both of the following conditions are true:

<UL><LI>The hyperlink was created by a formula containing the HYPERLINK
   worksheet function.
<P>
<P><PRE>    -and-
</PRE>
<LI>The second argument of the HYPERLINK function, friendly_name, equals
   an error value, such as #DIV/0!, #NAME?, or #VALUE!
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, make sure that your HYPERLINK
worksheet function does not contain an error value for the second argument.
<P>
For example, if your formula is
<P>
<PRE>   =HYPERLINK("<B><A HREF="http://msnbc.com">http://msnbc.com</A></B>",A1/B1)

</PRE>Since the expression A1/B1 can return an error value of #DIV/0! if B1 is
zero, you need to change the second argument so that it won't return an
error value. For example:
<P>
<PRE>   =HYPERLINK("<B><A HREF="http://msnbc.com">http://msnbc.com</A></B>",IF(B1=0,0,A1/B1))

</PRE>After you do this, the hyperlink should work correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, the HYPERLINK worksheet function allows you to
create a hyperlink within a worksheet cell. The HYPERLINK function accepts
two arguments:
<P>
<PRE>   Argument        Description
   -------------------------------------------------------------------

   link_location   the path and file name, or URL, you want to link to
   friendly_name   the text that should appear in the cell

</PRE>The friendly_name argument can be a text string, a defined name, or any
other expression that returns a value.
<P>
If the value of the friendly_name argument returns an error value, the
hyperlink will not work when you click it. Here are some example formulas
that demonstrate this problem.
<P>
<P><h3>Example 1: #VALUE! error</h3>
 
<P>
This hyperlink will fail because the expression 1+"Alpha" returns a #VALUE!
error:
<P>
<PRE>   =HYPERLINK("<B><A HREF="http://msnbc.com">http://msnbc.com</A></B>",1+"Alpha")

</PRE><h3>Example 2: #NAME? error</h3>
 
<P>
This hyperlink will fail if the defined name "Bravo" doesn't exist, because
it results in a #NAME? error:
<P>
<PRE>   =HYPERLINK("<B><A HREF="http://msnbc.com">http://msnbc.com</A></B>",Bravo)

</PRE><h3>Example 3: #DIV/0! error</h3>
 
<P>
This hyperlink will fail if the mathematical expression returns any type of
error, such as #DIV/0!:
<P>
<PRE>   =HYPERLINK("<B><A HREF="http://msnbc.com">http://msnbc.com</A></B>",A1/B1)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 XL97<BR>
Keywords          : xlformula xlweb<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
