

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL.QUER Returns #REF in Q+E </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74241 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/07/15">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QABM,QBWS,QA2Q,QBVV,QBVP,QAG2,QAB9,QAY2,QBV8,QDI1,QAZZ,QAPF,QALW,QBNS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SQL.QUER Returns #REF in Q+E</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74241 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The function SQL.QUERY is equivalent to the command Select SQL Query.
This option is not available unless a query window is open. If you use
the EXECUTE function to send the SQL.QUERY command using a DDE
channel, #REF will be returned unless there is an open Query in Q+E.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example will NOT work because there is not an open Query
in Q+E:
<P>
<PRE>   A1    chan=INITIATE("qe","system")
   A2    =EXECUTE(chan,"[sql.query('select * from dBASEfile |
          c:\excel\qe\emp.dbf WHERE ')]")
   A3    =TERMINATE(chan)
   A4    =RETURN()

</PRE>The next example WILL work because it sends commands to Q+E that open a
query window before attempting to modify the query:
<P>
<PRE>   A1   chan=INITIATE("qe","system")
   A2   =EXECUTE(chan,"[open('d:\excel\xl3\qe\emp.dbf')]")
   A3   =EXECUTE(chan,"[sql.query('select * from
         d:\excel\xl3\qe\addr.dbf where state=''NC''')]")
   A4   =TERMINATE(chan)
   A5   =RETURN()

</PRE>An alternative to opening a file before using SQL.QUERY is to use the
OPEN command to send your SQL statement:
<P>
<PRE>   A1   chan=INITIATE("qe","system")
   A2   =EXECUTE(chan,"[open('select * from
         d:\excel\xl3\qe\emp.dbf WHERE salary &gt; 30000')]")
   A3   =TERMINATE(chan)
   A4   =RETURN()

</PRE>The following are other reasons that the line in your macro containing
the EXECUTE and SQL.QUERY commands might fail even though the other
lines execute correctly:

<OL><P><LI>You are attempting to access a file or table that is not supported
   by the currently selected driver. An example would be sending the
   statement "Select * from EMP.XLS" when dBASEFile is set up as your
   default driver. This can be prevented by including the correct
   driver name in the Select statement. For example:
<P>
<P><PRE>      "Select * from ExcelFile | EMP.XLS".
</PRE>
<P><LI>You are attempting to access a file that is not in the current
   directory and you have not included the full path to the file.

<P><LI>You are extremely low on memory or system resources.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide," pages 70-71, 112
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
