

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Cell Reference Formats for an Excel Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51302 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/11/22">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2Q,QAB3,QAPF,QAG2,QDNZ,QAPN,QBVP,QAH4,QBWS,QBDA,QAB9,QANX,QBXV,QBFY,QAK5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Cell Reference Formats for an Excel Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51302 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
Before examining the different cell reference forms, it should be
noted that Microsoft Excel can operate with either A1 or R1C1 type of
cell references. The first part of this discussion focuses on the A1
type reference, followed by descriptions of the R1C1 type reference.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>$A$1</h3>
 
<P>
This is an absolute reference to a cell on the sheet that contains
this statement. For example, the following reference selects cell B3
on the macro sheet that contains the SELECT statement:
<P>
<PRE>   =SELECT($B$3)

</PRE><h3>A1</h3>
 
<P>
This is a relative reference to a cell on the sheet that contains this
statement. For example, the following reference selects the cell B3 on
the macro sheet that contains the statement, but maintains B3 as a
relative reference on the sheet where it appears [i.e., if the
=SELECT(B3) statement is in cell A1 and is copied to cell A2, Excel
changes the relative reference so that cell A2 contains =SELECT(B4)]:
<P>
<PRE>   =SELECT(B3)

</PRE><h3>!$A$1</h3>
 
<P>
This is an absolute reference to a cell on the active sheet. For
example, the following reference selects cell B2 on the worksheet
named "example":
<P>
<PRE>   =ACTIVATE("example")
   =SELECT(!$B$2)

</PRE><h3>!A1</h3>
 
<P>
This is a relative reference to a cell on the active sheet. For
example, the following reference selects cell B2 on worksheet
"example" and maintains B2 as a relative reference on the sheet where
it appears (see also "A1", above):
<P>
<PRE>   =ACTIVATE("example")
   =SELECT(!B2)

'Worksheet Name'!A1
</PRE> 
<P>
This is a relative reference to a cell on the specified worksheet.
<P>
******************************************************************
IMPORTANT: The following information assumes that the sheet is set
to R1C1 style references.
******************************************************************
<P>
<P><h3>R1C1</h3>
 
<P>
This is an absolute reference to a cell on the sheet that contains the
statement. For example, the following reference selects cell R3C2
(same cell as B3 when using the A1 type of reference) on the macro
sheet that contains the SELECT statement:
<P>
<PRE>   =SELECT(R3C2)

</PRE>R[#]C[#] (where "#" is a positive or negative integer)
 
<P>
This is a relative reference to a cell on the sheet that contains this
statement. For example, the following reference selects the cell (on
the macro sheet that contains the statement) that is three rows down
and two columns to the right of the cell that contains the SELECT
statement:
<P>
<PRE>   =SELECT(R[3]C[2])

</PRE><h3>!R1C1</h3>
 
<P>
This is an absolute reference to a cell on the active sheet. For
example, the following reference selects cell R2C2 on the worksheet
named "example":
<P>
<PRE>   =ACTIVATE("example")
   =SELECT(!R2C2)

</PRE>!R[#]C[#] (where # is a positive or negative integer)
 
<P>
This is a relative reference to a cell on the active sheet, but its
relativity is to the cell that contains the macro statement. For
example, the following reference selects the cell (on the active
worksheet) that is three rows down and two columns to the right of the
cell on the macro sheet that contains the SELECT statement:
<P>
<PRE>   =ACTIVATE("Worksheet1")
   =SELECT(!R[3]C[2])

</PRE>In the following example, the cell at row 7, column 4 is selected as a
result of running the macro on Macro1, which has the SELECT statement
in row 4, column 2:
<P>
<PRE>   =ACTIVATE("SalesQ1")
   =SELECT(!R[3]C[2])
   =RETURN()

</PRE>Note: This reference type can produce confusing results. Be sure you
understand its operation before using it in a macro.
<P>
<PRE>'Worksheet Name'!R1C1
</PRE> 
<P>
This is an absolute reference to a specific cell on a named sheet.
<P>
<PRE>'Example Sheet'!R[#]C[#] (where # is a positive or negative integer)
</PRE> 
<P>
This is a reference to a cell on the sheet named "Example Sheet" whose
position is determined relative to the cell on the macro sheet in
which the statement appears.
<P>
For additional information on references not parsed until execution,
query on the following words:
<P>
<PRE>   parsed and execution
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 1.00 1.01 1.03 1.04 1.06 1.50 2.20 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
