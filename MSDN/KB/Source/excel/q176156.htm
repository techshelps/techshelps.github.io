

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Error or Page Fault Linking to Workbook or Creating Formula </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176156">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1997/11/03">
<META NAME="Keywords" CONTENT="xlgpf xlweb kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you enter a formula to create a link from one workbook to another workbook in Microsoft Excel, you may receive one of the following error messages:  Microsoft Excel 97 for Windows     This program has performed an illegal operation and will be...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QAUR,QBWS,QAUD,QBJZ,QAKP,QAB9,QDNM,QBVV,QAU7,QAAP,QA6A,QAO4,QAE5 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Error or Page Fault Linking to Workbook or Creating Formula</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176156</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you enter a formula to create a link from one workbook to another
workbook in Microsoft Excel, you may receive one of the following error
messages:
<P>
<P><h3>Microsoft Excel 97 for Windows</h3>
 
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to the following
<P>
<PRE>      EXCEL caused an invalid page fault in module EXCEL.EXE at
      0137:30218701.

</PRE>and Microsoft Excel 97 quits.
<P>
<P><h3>Microsoft Excel 98 Macintosh Edition</h3>
 
<P>
<PRE>     '&lt;random characters&gt;' contains incomplete calculation.

</PRE>In the error message, &lt;random characters&gt; includes at signs (@), ampersands
(&amp;), less-than and greater-than signs (&lt; and &gt;), and other random
characters.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>The values in the workbook to which you are linking are not recalculated
   before you save the file, and this workbook is not open.
<P>
   NOTE: For information about how this situation can occur, see the "More
   Information" section in this article.
<P>
<P><PRE>    -and-
</PRE>
<LI>The workbook in which you are entering the formula is stored in a
   different folder from the folder that contains the workbook to which you
   are linking.
<P>
   As a result, when you enter the formula to link to the other workbook, a
   File Not Found or Cannot Find dialog box appears and you are prompted to
   select the correct workbook.
<P>
</UL>When you select the correct workbook and click OK or Copy, you receive the
error message in the "Symptoms" section in this article.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, include the complete path to the other
workbook when you enter the formula. For example, instead of this formula
<P>
<PRE>   =[Book2.xls]Sheet1!A1

</PRE>type this formula:
<P>
<PRE>   ='C:\Files\[Book2.xls]Sheet1'!A1

</PRE>NOTE: When you include the complete path and enter the formula, you receive
the following error message:
<P>
<PRE>   '&lt;Bookname&gt;' contains incomplete calculation.

</PRE>However, the problem described in the "Symptoms" section in this article
does not occur.
<P>
You can also prevent this problem from occurring by recalculating workbooks
before you save them.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, you may save a workbook in an uncalculated state if you
follow these steps:

<OL><P><LI>On the Tools menu, click Options or Preferences. Click the Calculation
   tab.

<P><LI>Click Manual, and click to clear the Recalculate Before Save check box.

<P><LI>Click OK.

<P><LI>Make a change to the workbook that would normally force calculation;
   for example, enter a formula in cell A1.

<P><LI>On the File menu, click Save, and then save the workbook.
<P>
</OL>If you enter a formula that links to this workbook, and then select the
workbook in the File Not Found or Cannot Find dialog box, the problem
described in this article may occur.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlgpf xlweb kberrmsg<BR>
Version           : WINDOWS:97; MACINTOSH:98<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
