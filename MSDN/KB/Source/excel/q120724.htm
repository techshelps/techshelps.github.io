

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: "Cannot Execute MSQUERY.EXE" Using External Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120724">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1994/09/19">
<META NAME="Keywords" CONTENT="xlmac xlquery kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the Get External Data command, or when you create a pivot table using an external data source, you receive the error message:     Cannot Execute MSQUERY.EXE  CAUSE =====  Microsoft Excel for the Macintosh  This erro...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBI0,QAB4,QDL9,QDKW,QBWO,QBWN,QDO9,QAWM,QAIJ,QBWS,QDIR,QBVU,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: "Cannot Execute MSQUERY.EXE" Using External Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120724</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, version 5.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the Get External Data command, or when you
create a pivot table using an external data source, you receive the error
message:
<P>
<PRE>   Cannot Execute MSQUERY.EXE

</PRE><h2>CAUSE</h2>
 
<P>
<P><h3>Microsoft Excel for the Macintosh</h3>
 
<P>
This error message occurs if any of the following are true:

<UL><LI>You have not run Microsoft Query on this machine before.
<P>
<P><PRE>    -or-
</PRE>
<LI>You are running a workstation installation of Microsoft Excel.
<P>
<P><PRE>    -or-
</PRE>
<LI>You are running the Macintosh version of Microsoft Excel (that is,
   you are not running the Power Macintosh version).
<P>
</UL><h3>Microsoft Excel for Windows</h3>
 
<P>
This error message may also occur when you use the Get External Data
command on a computer that is running Microsoft Windows 3.1 or Windows NT
if the following is true:

<UL><LI>The "Msquery=" line in the [Microsoft Query] section of the Win.ini file
   is not pointed to a valid location for Msquery.exe.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
<P><h3>Microsoft Excel for the Macintosh</h3>
 
<P>
To work around this situation, do the following:

<OL><P><LI>Quit Microsoft Excel.

<P><LI>In the folder to which you installed Microsoft Excel, start Microsoft
   Query by double-clicking the Query icon.

<P><LI>Quit Microsoft Query.
<P>
</OL>NOTE: You may need to start Microsoft Query by double-clicking the
Microsoft Query icon in the Microsoft folder, rather than by using the
alias.
<P>
These steps register Microsoft Query in the Macintosh operating system
Desktop file again, so that when the External Data commands attempt to
start Microsoft Query, the operating system knows where to locate the
program.
<P>
<P><h3>Microsoft Excel for Windows</h3>
 
<P>
To work around this problem, do the following:

<OL><P><LI>Quit Microsoft Excel and Microsoft Query.

<P><LI>Open the Win.ini file in Notepad.

<P><LI>Search for the [Microsoft Query] section.

<P><LI>Add the correct path to the Msquery.exe file after the "Msquery=" line.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.00 5.00<BR>
Keywords          : xlmac xlquery kberrmsg kbtool<BR>
Version           : WINDOWS:5.0; MACINTOSH:5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
