

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Advanced Filter Doesn't Return Any Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166759">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/04/10">
<META NAME="Keywords" CONTENT="xllist">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you filter data using Advanced Filter (point to Filter on the Data menu), Microsoft Excel fails to return data to the worksheet.  CAUSE =====  This problem occurs when the following conditions are true:   - The database is on a different works...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAPF,QA3P,QAM4,QAJQ,QBVP,QAUD,QAHH,QAE1,QACE,QATF,QAX6,QA7O,QA7N,QDMN P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Advanced Filter Doesn't Return Any Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166759</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you filter data using Advanced Filter (point to Filter on the Data
menu), Microsoft Excel fails to return data to the worksheet.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>The database is on a different worksheet than the criteria.
<P>
<P><PRE>    -and-
</PRE>
<LI>The criteria compares one or more records.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem use either of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Move the Criteria and Copy To (Extract) ranges to the worksheet that
contains the database.
<P>
<P><h3>Method 2</h3>
 
<P>
Instead of using a comparison function, use another operation in the
Criteria range.
<P>
Consider the following example formula in the Criteria range:
<P>
<PRE>   A1: Criteria
   A2: =Month(Sheet1!A2)=1

</PRE>When you use the formula that is in cell A2, it searches the database Date
field and finds each record that matches the month of January (the first
month).
<P>
As an alternative, use the following criteria in cells A1:B2:
<P>
<PRE>   A1: Date         B1: Date
   A2: &gt;=1/1/96     B2: &lt;=1/31/96

</PRE>NOTE: By typing both conditions on the same row, you create an AND
condition. For an explanation of the different conditions, see the "More
Information" section.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Criteria for an advanced filter can include multiple conditions applied in
a single column, multiple criteria applied to multiple columns, and
conditions created as the result of a formula.
<P>
<P><h3>Multiple Conditions in a Single Column</h3>
 
<P>
If there is more than one condition in a single criteria column, you create
a logical OR condition because you extract all records that apply to any of
the conditions.
<P>
The following example searches the Region field and extracts all records
that match South or West.
<P>
<PRE>   A1: Region
   A2: South
   A3: West

</PRE><h3>Two or More Columns</h3>
 
<P>
When the criteria includes more than one column with the same field name,
and the conditions are on the same row, you create a logical AND condition.
This condition implies that you want to extract all records that match each
condition for that field.
<P>
The following example searches the Date field and extracts all records with
dates in January 1996.
<P>
<PRE>   A1: Date         B1: Date
   A2: &gt;=1/1/96     B2: &lt;=1/31/96

</PRE>To find records that meet one of many conditions, type the condition in
separate rows.
<P>
The following example searches the Date field and extracts all records with
dates that are 1/1/96 or 1/31/96.
<P>
<PRE>   A1: Date         B1: Date
   A2: 1/1/96       B2:
   A3:              B3: 1/31/96

</PRE><h3>Condition as a Result of a Formula</h3>
 
<P>
Conditions that are the result of a formula are also called computed
criteria. You can use any formula that returns a result of True or False as
criteria. This is useful when you need to be more exclusive in the records
you are attempting to match.
<P>
The following example extracts all records in which column A equals
January, column B equals North, and column C is greater than 100:
<P>
<PRE>   A1: criteria
   A2: =AND(Month(A1)=1,B1="North",C1&gt;100)

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using advanced filters, click the Index tab in
Help, type the following text
<P>
<PRE>   advanced filters

</PRE>and then double-click the selected text to go to the "Examples of advanced
filter criteria" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xllist<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
