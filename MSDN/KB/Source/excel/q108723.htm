

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: DDE EXIT() Returns #VALUE! Error Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108723">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1993/12/16">
<META NAME="Keywords" CONTENT="xlquery kbother kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When a macro initiates a DDE channel to Microsoft Query and sends the EXIT() command from within the EXECUTE() function, the command will be evaluated to a #VALUE! error value.  When you have a query open in Microsoft Query, the application will no...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QBVP,QAKD,QAUD,QAGB,QAAP,QAB4,QAH4,QDL9,QBWS,QBWQ,QBWO,QBWN,QAZ2,QADK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: DDE EXIT() Returns #VALUE! Error Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108723</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS
kbother kbprb kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Query for WIndows 95, version 2.0
<LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a macro initiates a DDE channel to Microsoft Query and sends the
EXIT() command from within the EXECUTE() function, the command will be
evaluated to a #VALUE! error value.
<P>
When you have a query open in Microsoft Query, the application will not end
and will evaluate to a #REF! error value. Using the EXIT(TRUE) function
will always end Microsoft Query and evaluate to the #VALUE! error value.
EXIT() or EXIT(FALSE) will close Microsoft Query only if there are no open
queries that were opened on another channel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The errors are returned when you execute a command through a DDE channel
because Microsoft Query can only successfully return to Microsoft Excel
after it has executed the entire command successfully. Once the application
has terminated, it cannot return a response back to Microsoft Excel (at
which time a #VALUE! error value must be returned).
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 

<OL><P><LI>Run Microsoft Query

<P><LI>Switch to Program Manager and run Microsoft Excel 5.0

<P><LI>From the Insert menu, choose Macro, and then choose MS Excel 4.0 Macro
   sheet.

<P><LI>Enter the following macro:
<P>
<P><PRE>      A1: chan=INITIATE("MSQuery","system")
      A2: =EXECUTE(chan,"[EXIT()]")
      A3: =HALT()
</PRE>
<P><LI>Run and step through the macro.
<P>
</OL>A2 above evaluates to a #VALUE! error value. Note that Microsoft Query has
been closed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother kbprb kbtool<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 1.00 5.00 7.00<BR>
Keywords            : xlquery kbother kbprb kbtool<BR>
Version             : 1.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
