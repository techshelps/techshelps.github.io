

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Unexpected Behavior with Attached Toolbars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125847">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/02/07">
<META NAME="Keywords" CONTENT="xlloadsave xlui kbcode kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, custom toolbars can be attached to workbooks to allow the toolbar to be stored in the document, and these toolbars can be made available when the document is opened. However, the attached toolbar may not appear as expected when ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA39,QAF0,QANS,QABT,QBOG,QBS0,QBVV,QAUJ,QBWS P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Unexpected Behavior with Attached Toolbars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125847</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for the Macintosh, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, custom toolbars can be attached to workbooks to allow
the toolbar to be stored in the document, and these toolbars can be made
available when the document is opened. However, the attached toolbar may
not appear as expected when either of the following conditions is true:

<UL><LI>The attached toolbar is not loaded
<P>
<P><PRE>    -or-
</PRE>
<LI>The attached toolbar reverts to a previous version
<P>
</UL>For more information about these conditions, see the appropriate section in
the "More Information" section of this article.
<P>
To ensure that an attached toolbar is updated when the toolbar is modified,
you must choose Attach Toolbars from the Tools menu and re-copy the toolbar
to the worksheet each time you modify the toolbar.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Attached Toolbar Is Not Loaded</h3>
 
<P>
If a custom toolbar attached to a workbook has the same name as an existing
custom toolbar in the current Microsoft Excel session, the attached toolbar
will not replace the existing toolbar when the workbook is opened. Any
Visual Basic macro code that references the attached toolbar will instead
reference the pre-existing toolbar. For example, if a currently running
Microsoft Excel session has an existing toolbar named "My Toolbar," and you
open a file that has an attached toolbar also named "My Toolbar," Microsoft
Excel will not load "My Toolbar" from the file. If a Visual Basic macro
subsequently issues the command
<P>
<PRE>   Toolbars("My Toolbar").Visible=True

</PRE>the pre-existing toolbar in the Microsoft Excel session will be displayed
rather than the recently attached toolbar.
<P>
<P><h3>Attached Toolbar Reverts to Previous Version</h3>
 
<P>
If you attach a custom toolbar to a workbook, modify it, and then save the
workbook, the attached toolbar will not reflect any changes made after the
toolbar has been attached. You will not notice this behavior until you open
the workbook on a different computer. For example, you will notice this
problem if you do the following:

<OL><P><LI>Create a custom toolbar named "My Toolbar" that has two buttons.

<P><LI>Attach this toolbar to a workbook, and add a third button to it.

<P><LI>Save and close the workbook.
<P>
</OL>If you do not delete "My Toolbar" in the current session of Microsoft
Excel, and if you reopen the file, the attached toolbar will not be loaded
and three buttons will be seen on "My Toolbar." However, if you open the
workbook in a different installation of Microsoft Excel (on another
computer, for example) that does not contain a custom toolbar named "My
Toolbar," the attached toolbar will be loaded, and "My Toolbar" will
display the two buttons that were present at the time it was attached to
the worksheet.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide," version 5.0, page 638
"Microsoft Excel Visual Basic User's Guide," version 5.0, pages 262-264
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 5.00 8.0 8.00 xl97 xl7 commandbars
<P>

Keywords          : xlloadsave xlui kbcode kbprg kbtool<BR>
Version           : WINDOWS: 5.0, 5.0c, 7.0, 97; MACINTOSH: 5.0, 5.0a, 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
