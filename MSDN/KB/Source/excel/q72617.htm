

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calculating the Median of a Set of Values in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q72617 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/06/01">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIV,QAUD,QAY5,QAKD,QDMR,QA28,QATJ,QAH4,QBXS,QBVP,QAM9,QALX,QAB9,QDNZ,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Calculating the Median of a Set of Values in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q72617 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The MEDIAN function, which represents the middle value of a set of
values, is not a built-in function of Excel versions 2.1x. However,
MEDIAN can be implemented as a function macro. (Note that this feature
has been incorporated into Excel 3.0 as a built-in function.)
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If there is an odd number of values in the range, the middle value is
always returned by the MEDIAN function. However, there are two
accepted methods to calculate the median if there is an even number of
values in the range. The first returns the lesser of the two middle
values. The second returns the average of the two middle values.
(Excel 3.0 uses the average method to calculate the median. If the
first method is desired, create a function macro as described below,
making the necessary modifications for returning the lesser value.)
<P>
The following macro returns the middle value of an unsorted set of
values in a vertical array. If the number of values is even, it returns
the average of the two middle values. The values must be entered as a
vertical array for the macro to work correctly.
<P>
<PRE>   A1:  Median_Function
   A2:  =ARGUMENT("RANGE",64,B:B)
   A3:  =COUNT(RANGE)
   A4:  =IF(MOD(A3,2)=0,SET.NAME("COUNTER",(A3/2)-1),
        SET.NAME("COUNTER",(A3-1)/2))
   A5:  =WHILE(COUNTER&gt;0)
   A6:  =MAX(RANGE)
   A7:  =MATCH(A6,RANGE,0)
   A8:  =SET.VALUE(INDEX(RANGE,A7),MIN(RANGE))
   A9:  COUNTER=COUNTER-1
   A10: =NEXT()
   A11: VAR=(INDEX(RANGE,A7-1)+INDEX(RANGE,A7-2))/2
   A12: =IF(MOD(A3,2)=0,RETURN(VAR))
   A13: =RETURN(MAX(RANGE))

</PRE>To modify this function macro to return the lesser of the two middle
values when there is an even number of values in the range, remove
cells A11 and A12 from the macro above and change cell A4 to read:
<P>
<PRE>   A4:  =IF(MOD(A3,2)=0,SET.NAME("COUNTER",A3/2),
        SET.NAME("COUNTER",(A3-1)/2))

</PRE>To modify this macro to work with a horizontal array, make the
following changes:

<OL><P><LI> Change the range B:B in cell A2 to 15:15.

<P><LI> Change the INDEX portion of cell A8 to read INDEX(RANGE,,A7).

<P><LI> If you are using the first method of calculating the median,
<P><PRE>    change the INDEX portions of cell A11 to read INDEX(RANGE,,A7-1)
    and INDEX(RANGE,,A7-2), respectively.
</PRE><P>
</OL>To define this function macro, highlight cell A1 and choose Define
Name from the Formula menu. Median should be in the Name: box. =$A$1
should be in the Refers To: box. Choose the Function button at the
bottom to define the macro as a function macro.
<P>
To use this function macro, do the following:

<OL><P><LI>With your spreadsheet active and the macro sheet open, select the
   spreadsheet cell into which you want to place the function.

<P><LI>From the Formula menu, choose Paste Function and select the MEDIAN
   function, which should be at the bottom of the list. Choose OK.

<P><LI>Inside of the parentheses, enter the range from which you want to
   calculate the median and press ENTER.
<P>
</OL>Note that when you use custom function macros in a spreadsheet, the
macro sheet containing the macro must be open for the function to
return a value.
<P>
For more information on using the MEDIAN function in Excel 3.0, see
page 150 of the "Microsoft Excel Function Reference."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
