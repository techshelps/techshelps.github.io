

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Hiding Chart Toolbar with an XLM Macro Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99519 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/06/02">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed above, if you create or activate  a chart and then attempt to hide the chart toolbar in the same macro, the  command to hide the toolbar may be applied to the worksheet window rather  than the chart window....">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QDNX,QAH4,QAF0,QANS,QAQG,QBWS,QALW,QBBI,QAYZ,QBV8,QBVV,QAY5,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Hiding Chart Toolbar with an XLM Macro Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99519 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed above, if you create or activate 
a chart and then attempt to hide the chart toolbar in the same macro, the 
command to hide the toolbar may be applied to the worksheet window rather 
than the chart window. This results in the toolbar continuing to be 
displayed while the chart window is active. If you set the chart toolbar so 
that it would be displayed in a worksheet window, it will now be hidden.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Whenever a chart window is opened or activated in Microsoft Excel, the
chart toolbar is automatically displayed by default. To change this
default, you must disable the chart toolbar while a chart window is
active. Once this is done, when you open or activate a chart, the
toolbar will no longer be displayed.
<P>
If you have not changed this default and you run the following macro to
create a chart and hide the chart toolbar
<P>
<PRE>   Create_Chart
   =NEW("Chart")
   =SHOW.TOOLBAR(4,FALSE)
   =RETURN()

</PRE>the chart toolbar will continue to be displayed with the chart window
active and will be designated as hidden for the worksheet window.
<P>
The macro that creates the chart needs to return before the
SHOW.TOOLBAR(4,FALSE) command is executed. You can accomplish this by
using the ON.TIME() function. ON.TIME() runs a designated macro at a
specified time. It begins tracking the time when the macro return is
reached and Microsoft Excel is in Ready mode. In the following macro
sequence, the Hide_Toolbar macro will run 1 second after the
Create_Chart macro returns:
<P>
<PRE>   Create_Chart
   =NEW("Chart")
   =ON.TIME(NOW()+"00:00:01","Hide_Toolbar")
   =RETURN()

   Hide_Toolbar
   =SHOW.TOOLBAR(4,FALSE)
   =RETURN()

</PRE><h2>STATUS</h2>
 
<P>
This is by design of the versions of Microsoft Excel listed at the 
beginning of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you run a macro, some of the functions in Microsoft Excel are not
completed until after a specified wait state. In the example above,
Microsoft Excel will not recognize that the toolbar is open until the
macro that creates or activates the chart window is returned.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," pages 285-286, 305-306, 398
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.00a XL4 XL5<BR>
Version           : WINDOWS:4.0,4.0a,5.0; MACINTOSH:4.0,5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
