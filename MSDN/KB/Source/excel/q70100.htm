

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Computed Criteria on External Databases </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q70100 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1991/03/12">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="   Using computed criteria in Microsoft Excel between two separate sheets performs differently in Microsoft Excel version 2.1 than it does in later versions. If you are setting up computed criteria on a separate sheet from the database, you need to u...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA5V,QA3P,QAPF,QAZV,QAUJ,QAE5,QAA1,QBXS,QAY2,QAB9,QDI2,QDNZ,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Computed Criteria on External Databases</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q70100 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows versions 3.0, 4.0, 4.0a
<LI>Microsoft Excel for the Macintosh, version 4.0
</UL> 
<P>
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using computed criteria in Microsoft Excel between two separate sheets
performs differently in Microsoft Excel version 2.1 than it does in later
versions. If you are setting up computed criteria on a separate sheet from
the database, you need to use field names instead of cell references. This
was not the case in earlier versions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Excel and then open another new sheet. Now you should have
   two blank sheets open, Sheet1 and Sheet2.

<P><LI>On Sheet1, type the following data:
<P>
<PRE>      A1: Name   B1: Age
      A2: Andy   B2: 23
      A3: Joe    B3: 34
      A4: Bill   B4: 12

</PRE><P><LI>Select cells A1:B4 and choose Set Database from the Data
   menu.

<P><LI>On Sheet2, choose Define Name from the Formula menu and type the
   name Database in the Refers To: box. Type in Sheet1!database.

<P><LI>Remain on Sheet2 and type the following information:
<P>
<P><PRE>      A1: 34  B1:
<PRE></PRE>      A2:     B2:  =Sheet1!Age&lt;$A$1

   Note: The formula in cell B2 will give you a #NAME? error if Age
   hasn't been defined, but that is OK. Also, make sure that your
   reference to a cell outside of the database is absolute (that is,
   $A$1 not A1).

</PRE><P><LI>Select cells B1:B2 and choose Set Criteria from the Data menu.

<P><LI>Copy the field names Name and Age from Sheet1, and paste them into
   cells A4:B4 on Sheet2. While A4:B4 are still selected on Sheet2,
   choose Extract from the Data menu.
<P>
</OL>Notice that the records for Andy and Bill are extracted, which is correct.
This works properly for version 2.1 and 3.0. However, if you substitute a
cell reference for the word Age in the formula in cell B2 of Sheet2, your
extract will be correct in version 2.1 but will be incorrect in later
versions.
<P>
<P><h3>Example</h3>
 
<P>
If the formula in cell B2 of Sheet2 reads
<P>
<PRE>  =Sheet1!B2&lt;$A$1

</PRE></OL>where B2 refers to the first data cell in the field Age, the extract for
Microsoft Excel 2.1 will still correctly extract the records of Andy and
Bill; however, in later versions, all the records in the database will be
extracted.
<P>
In the case of versions 3.0 and 4.0, if your computed criteria formula
results in TRUE, all records of the database are extracted and if the
formula results in FALSE, none of the records are extracted. Microsoft
Excel evaluates the formula once for each record and selects the record if
the formula's result is TRUE or a number other than zero. In Microsoft
Excel versions 3.0 and 4.0, the relative reference doesn't change because
the formula is tested for each record; thus, it is necessary to use the
field name.
<P>
Note: If you are setting up your database, criteria, and extract all on a
single sheet in version 3.0 or 4.0, it is not necessary to use a field name
instead of a reference.
<P>
For more information on computed criteria, query on the
following keywords:
<P>
<PRE>   computed and criteria and references

</PRE><h2>REFERENCES</h2>
 
<P>
"User's Guide," version 4.0, pages 332-334
"User's Guide," version 3.0 for Windows, pages 374-378
"Microsoft Excel for Windows Reference Guide," version 2.1, pages 180-181
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 3.00 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
