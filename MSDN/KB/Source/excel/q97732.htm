

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Extract Range Not Cleared when Using External Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97732 ">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/04/20">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you extract data from an external database that is not a Microsoft Excel database (for example, a dBASE [.DBF] file or a Q+E query [.QEF] file), the cells under the extract range will not automatically be cleared.  Note: To access an external ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QBVP,QATF,QADR,QAJX,QAEF,QA5V,QAZV,QDMR,QDNZ,QBVV,QA2Q,QAH4,QAG2,QAWM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Extract Range Not Cleared when Using External Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97732 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you extract data from an external database that is not a
Microsoft Excel database (for example, a dBASE [.DBF] file or a Q+E
query [.QEF] file), the cells under the extract range will not
automatically be cleared.
<P>
Note: To access an external database that is not a Microsoft Excel
database, you must load the QE.XLA add-in macro.
<P>
<P><h3>Workaround</h3>
 
<P>
If are not using a macro to extract data, select the records that
are displayed beneath the extract range, and choose Clear from the Edit
menu before each extraction. This procedure will clear the contents of
the cells in your extract range.
<P>
If you are using a macro to extract the data, you can use the OFFSET()
function along with the DCOUNTA() and COLUMNS() functions to select
and clear the previously extracted data, as in the following sample
macro:
<P>
<PRE>   A1: Clear_Extract
   A2: =SELECT(OFFSET(!Extract,1,0,DCOUNTA(!Database,,!Criteria),
       COLUMNS(!Extract)))
   A3: =CLEAR(1)

</PRE>In the sample macro above, cell A1 contains the name of the macro. The
formula in cell A2 selects the extracted records in the extract range;
in this formula, the DCOUNTA() function finds the number of rows to
select and the COLUMNS() function determines the number of columns to
select. The formula in cell A3 clears the contents of the selected
cells.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you extract data from a Microsoft Excel database, the cells in
the extract range are cleared to the bottom of the spreadsheet (even
if no information is extracted into them). These cells are
automatically cleared if the database is located on same spreadsheet
as the extract range or if it is an external Microsoft Excel database.
<P>
However, if you are using a non-Microsoft Excel database, such as a
dBASE or Q+E database, the cells in the extract range are not cleared.
When you use these databases, the extracted records will overwrite
whatever is presently showing in the extract range, but the other
cells in the extract range will not be cleared. For example, if you
have previously extracted 20 records, and then perform another extract
that only contains 5 records, the first 5 records will be replaced
with the results from the second extract, but the previous 15 records
will remain in the extract range.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide 1," version 4.0, page 341
"Microsoft Excel User's Guide," version 3.0, page 282
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 4.00 3.00 remote
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
