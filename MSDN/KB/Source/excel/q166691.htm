

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Linked Formula May Return a Maximum of 255 Characters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166691">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/04/09">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, when you open a workbook (the dependent workbook) that contains formulas that link to cells in another workbook (the source workbook), the formulas return a maximum of 255 characters, even though the cells in the source workb...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBJZ,QBVP,QAB9,QAUR,QBWS,QALW,QDNM,QBE7,QBE6,QBJQ,QDNZ,QAWN,QAU7,QAK6 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Linked Formula May Return a Maximum of 255 Characters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166691</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, when you open a workbook (the dependent workbook)
that contains formulas that link to cells in another workbook (the source
workbook), the formulas return a maximum of 255 characters, even though the
cells in the source workbook contain more than 255 characters.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>You fail to open the source workbook.
<P>
<P><PRE>    -and-
</PRE>
<LI>Cells in the source workbook contain more than 255 characters.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, open the source workbook, either before or after
you open the dependent workbook. When you do this, the formulas in the
dependent workbook return the correct number of characters.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, worksheet cells may contain a maximum of 32,767
characters. This is different from earlier versions of Microsoft Excel, in
which worksheet cells may contain a maximum of 255 characters. Even though
cells may contain a very large number of characters, you may experience
problems when working with these cells.
<P>
<P><h3>Example</h3>
 
<P>
In the following example, the formulas in the dependent workbook return a
maximum of 255 characters:
<P>
<PRE>  1. In Microsoft Excel 97, create a new workbook.

  2. In cell A1 of Sheet1, enter the formula

        =REPT("x",5)

     Note that the formula returns five "x" characters ("xxxxx").

  3. On the File menu, click Save. Save the workbook as Book1.xls in the
     My Documents folder. On the File menu, click Close.

  4. Create a second new workbook.

  5. Enter the following formulas in Sheet1:

        A1: =[Book1.xls]Sheet1!A1
        A2: =LEN(A1)

     Note that the formula in cell A1 also returns five "x" characters,
     and the formula in cell A2 returns the value 5.

  6. On the File menu, click Save. Save the workbook as Book2.xls in the
     My Documents folder. On the File menu, click Close.

  7. Open Book1.xls. Change the formula in cell A1 to the following:

        =REPT("x",32767)

     Note that the formula returns 32,767 "x" characters.

  8. On the File menu, click Save. Then, click Close on the File menu.

  9. Open Book2.xls. When you are asked to update links, click Yes.

     The formula in cell A1 returns 255 "x" characters, not 32,767
     characters. Also, the formula in cell A2 returns the value 255.

 10. Open Book1.xls. Then, switch to Book2.xls.

</PRE>The formula in cell A1 returns 32,767 "x" characters, and the formula in
cell A2 returns the value 32767.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
