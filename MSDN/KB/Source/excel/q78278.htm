

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"Function Is Not Valid," "Error in Formula" with FLATFILE.XLA </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q78278 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1991/11/11">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBVV,QAB9,QATX,QBFM,QAB4,QAY5,QAEF,QA5E,QA2Q,QACI,QAHT,QAAP,QDNU,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>"Function Is Not Valid," "Error in Formula" with FLATFILE.XLA</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q78278 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
FLATFILE.XLA is an add-in macro included with Microsoft Excel 3.0 that
provides a parsing utility. When parsing a file in Excel, you will
receive the error message "Function is not Valid" or "Error in
Formula" if both of the following conditions are met:

<OL><P><LI>A line in the file begins with an @.

<P><LI>The option to remove extra blank spaces is selected from the Smart
   Parse dialog box.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The @ character has special significance in Lotus 1-2-3. It precedes
each formula, acting similarly to Excel's equal sign. If you attempt
to enter the @ character into the first position of a cell in Excel,
you will receive the message "Function is not Valid" unless the
character is followed by a valid Excel formula, in which case Excel
converts the @ character to an equal sign. For example, if you enter
<P>
<PRE>   @SUM(B1:B2)

</PRE></OL>it is converted to:
<P>
<PRE>   =SUM(B1:B2)

</PRE>This behavior is consistent whether Alternative Navigation Keys has
been selected or not.
<P>
To enter the @ character plus a string (other than a valid formula)
into a cell, you must use the format ="@string" so that Excel does not
attempt to evaluate the contents.
<P>
The parsing problems with FLATFILE.XLA (described above) occur when
attempting to parse strings that begin with the @ character. A
"Function is not Valid" message is returned if a text string follows
the @ character. An "Error in Formula" message occurs if the @
character is followed by a numeric value or a text string is preceded
by at least one space.
<P>
<P><h3>Workarounds</h3>
 

<OL><P><LI>The following steps will remove all occurrences of the @ character
   in the text file.
<P>
   a. Select the data to be parsed.
<P>
   b. From the Formula menu, choose Replace.
<P>
   c. Type @ in the Find What box, and leave the Replace With box blank.
<P>
   d. Select Replace All.
<P>
   -or-

<P><LI>Do not select the option to remove extra blank spaces from the
   Smart Parse dialog box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide," version 3.0, pages 116-135, 684
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
