

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: EDATE Function May Be Incorrect If Date Is in February </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179583">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1998/01/20">
<META NAME="Keywords" CONTENT="xladdins xlformula kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, if you use the EDATE function to return a date that is a specific number of months before or after another date, the function may return an incorrect result.  For example, ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QACE,QAB9,QBVP,QAY5,QAR4,QAAP,QALW,QBV8,QAPF,QAL3,QAIJ,QAKP,QBVV,QA6A P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: EDATE Function May Be Incorrect If Date Is in February</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179583</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article,
if you use the EDATE function to return a date that is a specific number of
months before or after another date, the function may return an incorrect
result.
<P>
For example, the EDATE function may incorrectly return 3/1/2100 (March 1,
2100) instead of 2/28/2100 (February 28, 2100).
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>The date that is returned by the function should be February 28th.
<P>
   -and-

<LI>The start date that is used by the function falls on the 29th, 30th, or
   31st of the month (for example, July 30th).
<P>
   -and-

<LI>The date that is returned by the function is in a century year that is
   not evenly divisible by 400, for example:
<P>
<P><PRE>      2100, 2200, 2300, 2500, 2600, 2700, 2900, 3000
</PRE><P>
</UL>NOTE: This problem does not occur if the date is in 1900 or 2000.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, manually modify the formulas that use the
EDATE function so that they return the correct result.
<P>
<P><h3>Example</h3>
 
<P>
Assume that you are using the following date and formula:
<P>
<PRE>   A1: 1/31/2100
   A2: =EDATE(A1,1)

</PRE>The formula in cell A2 returns 3/1/2100; however, the date you expect to
receive is 2/28/2100. You can correct the formula by adding "-1" (without
the quotation marks) to the end of the formula, as in the following
example:
<P>
<PRE>   A1: 1/31/2100
   A2: =EDATE(A1,1)-1

</PRE>The formula returns 2/28/2100, which is the correct result.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The EDATE function, which is included in the Analysis ToolPak, allows you
to return a date that is a specific number of months before or after
another date. For example, if you want to know the date six months from
today, you can use the following formula:
<P>
<PRE>   =EDATE(TODAY(),6)

</PRE>If today is 1/13/98, the function returns 7/13/98, the day that is six
months after today.
<P>
The problem described in this article occurs only when the EDATE function
returns a date in February of a century year that is not a leap year, for
example:
<P>
<PRE>   A1: 1/27/2100   B1: =EDATE(A1,1)
   A2: 1/28/2100   B2: =EDATE(A2,1)
   A3: 1/29/2100   B3: =EDATE(A3,1)
   A4: 1/30/2100   B4: =EDATE(A4,1)
   A5: 1/31/2100   B5: =EDATE(A5,1)

</PRE>The formulas in cells B1 and B2 return the correct results (dates 2/27/2100
and 2/28/2100), because the start date does not fall on the 29th, 30th, or
31st of the month.
<P>
The formulas in cells B3, B4, and B5 return the incorrect result, 3/1/2100,
instead of the correct result, 2/28/2100. The problem occurs because the
start dates fall on the 29th, 30th, and 31st of the month.
<P>
For more information about leap years, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q118923.htm">Q118923</A></B>
   TITLE     : XL: Method to Determine Whether a Year Is a Leap Year
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 y2k year2000<BR>
Keywords          : xladdins xlformula kbtool<BR>
Version           : WINDOWS:97; MACINTOSH:98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
