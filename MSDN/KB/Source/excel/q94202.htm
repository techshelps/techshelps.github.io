

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: #VALUE! Error When Concatenating Cells </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94202 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/12/29">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you concatenate cells, you receive a #VALUE! error if the Transition Formula Evaluation (TFE) option in version 5.0 or the Alternate Expression Evaluation (AEE) option in version 4.0 is enabled and one of the concatenated c...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB9,QBV8,QABI,QAKD,QABH,QBJZ,QDNZ,QDIU,QA6N,QAJX,QAEF,QADR,QAAP,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: #VALUE! Error When Concatenating Cells</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94202 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you concatenate cells, you receive a #VALUE! error
if the Transition Formula Evaluation (TFE) option in version 5.0 or the
Alternate Expression Evaluation (AEE) option in version 4.0 is enabled and
one of the concatenated cells is blank or contains a number.
<P>
This behavior also occurs with the INDIRECT function when you use 
concatenated cells. For example, the formula
<P>
<PRE>  =INDIRECT("A"&amp;B1)

</PRE>returns A6 if B1 has a value of six and TFE or AEE is not selected. The 
formula returns the #VALUE! error if TFE or AEE is selected.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving the #VALUE! error, do either of the following.

<UL><LI>Disable the TFE or AEE option. 
<P>
   NOTE: Make a backup copy of your worksheet. (If you disable alternate
   expression evaluation, the values calculated on your worksheet may
   change. If you have a backup copy of your worksheet, you can
   compare the earlier version of your worksheet with the updated
   version and make sure that your calculations are correct.)
<P>
   Microsoft Excel 98 Macintosh Edition
   ------------------------------------
<P>
   To disable the TFE or AEE option, follow these steps:
<P>
   1. On the Tools Menu, click Preferences and click the Transition tab.
<P>
   2. Under Sheet Options, clear the Transition Formula Evaluation check
<P><PRE>      box and click OK. 
</PRE>   
   Microsoft Excel Version 5.0
   ---------------------------
<P>
   To disable the TFE or AEE option, follow these steps:
<P>
   1. On the Tools menu, click Options and click the Transition tab.
<P>
   2. Under Sheet Options, clear the Transition Formula Evaluation check
<P><PRE>      box and click OK.
</PRE><P>
   Microsoft Excel Version 4.0
   ---------------------------
<P>
   To disable the TFE or AEE option, follow these steps:
<P>
   1. On the Options menu, click Calculation.
<P>
   2. Under Sheet Options, clear the Alternate Expression Evaluation check
<P><PRE>      box and click OK.
</PRE><P>
<P><PRE>    -or-
</PRE>
<LI>To concatenate cells while TFE or AEE is enabled, use the TEXT
   function in any concatenation formulas with cells that contain numeric
   values or are blank, as in the following example:
<P>
<P><PRE>      =A1&amp;TEXT(A2,IF(A2="","","0"))
</PRE><P>
</UL>The above formula combines the contents of cell A1 with the contents
of cell A2, and uses the TEXT function to ensure that the contents
of cell A2 are interpreted as text. The IF statement ensures that the
cell is formatted correctly based on whether cell A2 is blank or
contains a number.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If Transition Formula Evaluation or Alternate Expression Evaluation is
selected, the worksheet is calculated based on the Lotus 1-2-3 rules for
evaluating expressions instead of the Microsoft Excel rules. This option is 
automatically selected when you open a Lotus 1-2-3 worksheet in Microsoft 
Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 1," version 4.0, page 57
"User's Guide 2," version 4.0, page 237
"Function Reference," version 4.0, page 431
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.00a 5.00 7.00 indirect<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:4.0,4.0a,5.0,7.0; MACINTOSH:4.0,5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
