

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: Problems Adding dBASE Database in Microsoft Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179108">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1998/01/08">
<META NAME="Keywords" CONTENT="xlquery">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you try to query a database in Microsoft Query using the dBASE ODBC driver, one of the following problems occur:  Errors Adding a Table  One of the following error messages appear     The table name            was larger than    SQL_MAX_TABLE_...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QAZV,QBVV,QAB4,QAAP,QAUJ,QAIK,QAKP,QBXS,QAGU,QBWS,QDI1,QA9E,QACF,QADZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Problems Adding dBASE Database in Microsoft Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179108</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to query a database in Microsoft Query using the dBASE ODBC
driver, one of the following problems occur:
<P>
<P><h3>Errors Adding a Table</h3>
 
<P>
One of the following error messages appear
<P>
<PRE>   The table name &lt;database&gt; was larger than
   SQL_MAX_TABLE_NAME_LEN from SQLGetInfo(8).

</PRE>where &lt;database&gt; is the name of the file you are attempting to open
in Microsoft Query.
<P>
-or-
<P>
<PRE>   Field not found: &lt;fieldname&gt;

</PRE>where &lt;fieldname&gt; is a field in your database.
<P>
When you click OK, you are unable to add tables to your query.
<P>
<P><h3>Unable To See Database File</h3>
 
<P>
In Microsoft Query, when you attempt to add a table your dBASE database
file is not listed.
<P>
<P><h2>CAUSE</h2>
 
<P>
<P><h3>Errors Adding a Table</h3>
 
<P>
The SQL_MAX_TABLE_NAME_LEN error message occurs when you do the following:

<UL><LI>You create an ODBC User data source and you do not enable Long
   File Names in the ODBC Setup PPC.
<P>
   -and-

<LI>The database file you select contains a space in the name or the
   name is greater than eight characters.
<P>
   -and-

<LI>You use the Query Wizard in Microsoft Query.
<P>
</UL>The Field Not Found error occurs when you do the following:

<UL><LI>The database file you select contains a space in the name.
<P>
   -and-

<LI>You use the Query Wizard in Microsoft Query.
<P>
</UL><h3>Unable To See Database File</h3>
 
<P>
Your database file will not appear in the Add Tables dialog box when you
try to add a dBASE database that was created or saved in Excel.
<P>
NOTE: this problem does not occur when you use the Query Wizard. A file
saved with a .DBF file extension will be visible in the Query Wizard.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use the workaround appropriate to the specific problem you experience:
<P>
<P><h3>SQL_MAX_TABLE_NAME_LEN Error Adding a Table</h3>
 
<P>
If you receive this error adding a table to Microsoft Query, do not use
the Query Wizard when opening a database in Microsoft Query. This error
does not appear if you do not use the Query Wizard.
<P>
<PRE> -or-

</PRE>Create a User DSN and set the option to enable long file name support. The
Use Long Names option can be set in the Advanced tab when you click
Configure in the ODBC Data Source Administrator for your User DSN.
<P>
<P><h3>Field Not Found: &lt;fieldname&gt; Error Adding a Table</h3>
 
<P>
If you receive this error in the Query Wizard while adding columns, remove
the space character from the name of your database file. As an alternative
to a space use an underscore character (_).
<P>
<PRE> -or-

</PRE>Do not use the Query Wizard when opening a database in Microsoft Query.
This error does not appear if you do not use the Query Wizard.
<P>
<PRE> -or-

</PRE>Create a User DSN and set the option to enable long file names. The Use
Long Names option can be set in the Advanced tab when you click Configure
in the ODBC Data Source Administrator for your User DSN.
<P>
<P><h3>Unable to See Database File</h3>
 
<P>
If your database does not appear in the Add Tables dialog box, do the
following to correct this problem:
<P>
If you have not created a User DSN, do so. In the ODBC Data Source
Administrator, click your User DSN and click Configure. On the Mac File
Types tab, make the following changes:

<OL><P><LI>Set the File Creator Type to XCEL.

<P><LI>Set the Database File Type to BINA and click OK.
<P>
</OL>NOTE: the File Creator Type and Database File Type settings cannot be set
for a File DSN.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the products listed above.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 msquery<BR>
Keywords          : xlquery<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
