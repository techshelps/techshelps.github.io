

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: WordBasic Macro with FileExit Command Hangs Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94632 ">
<META NAME="KBModify" CONTENT="1997/01/03">
<META NAME="KBCreate" CONTENT="1993/01/11">
<META NAME="Keywords" CONTENT="kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel for Windows hangs when you run a WordBasic macro that contains a FileExit command. This problem occurs under the following conditions:   - Dynamic data exchange (DDE) is used to run a version 2.0 Microsoft    Word for Windows macro....">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAIH,QAH4,QAB4,QDL9,QBWQ,QBWO,QBWN,QAGB,QAB9,QBV8,QA5F,QBUG,QBUF,QDJO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: WordBasic Macro with FileExit Command Hangs Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94632 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel for Windows hangs when you run a WordBasic macro that
contains a FileExit command. This problem occurs under the following
conditions:

<UL><LI>Dynamic data exchange (DDE) is used to run a version 2.0 Microsoft
   Word for Windows macro.
<P>
   -and-

<LI>The FileExit command is used to exit the Word for Windows
   application.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
You can use DDE to run WordBasic macros from a Microsoft Excel macro.
When the WordBasic macro contains the FileExit command, Microsoft
Excel returns an error to the cell in the macro sheet containing the
Execute statement and temporarily hangs your computer. After 30
seconds to a minute, you will be able to use your computer; however,
the FileExit command will not successfully close Microsoft Word for
Windows (this command should close Microsoft Word). If you switch to
Word for Windows, you will receive the following error message:
<P>
<PRE>   Microsoft Word: This task is taking longer than expected.
   Do you want to continue waiting?

</PRE>If you choose the Yes button in the error message dialog box, Word for
Windows will not be closed and your computer will continue to hang. If
you choose the No button in the error message dialog box, you will
close Microsoft Word.
<P>
<P><h3>Workaround</h3>
 
<P>
To work around this problem, remove the FileExit command from the
WordBasic macro and instead use DDE to execute this command. A sample
macro follows:
<P>
<PRE>   A1: =INITIATE("winword","system")
   A2: =EXECUTE(A1,"[ToolsMacro.Name=""test"",.Run]")
   A3: =EXECUTE(A1,"[FileExit]")
   A4: =TERMINATE(A1)
   A5: =RETURN()

</PRE>The above macro initiates a DDE channel to Word for Windows and runs a
macro called Test. Once the macro is completed, Word for Windows will
quit and the channel is terminated.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide 2," version 4.0, pages 299-304
"Microsoft Excel User's Guide," version 3.0, pages 341-344
"Microsoft Excel Function Reference," version 4.0, pages 139-140
"Microsoft Excel Function Reference," version 3.0, pages 71-72
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 4.0 4.00 3.0 3.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
