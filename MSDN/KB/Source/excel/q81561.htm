

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Commands Added to Null Menu Don't Open Macro Sheets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81561 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1992/03/11">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" Summary:  A custom command added to Excel's null menu bar will not open a closed macro sheet to which the command is referenced. This affects only the null menu bar (the menu that is displayed when there is no active document window). On other menu ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAF0,QANS,QBV8,QAB9,QBWS,QAGB,QAB3,QBXV,QAI4,QAL3,QAB4,QAVI,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Commands Added to Null Menu Don't Open Macro Sheets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81561 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 3.0
<LI>Microsoft Excel for the Macintosh, version 3.0
</UL> 
<P>
Summary:
<P>
A custom command added to Excel's null menu bar will not open a closed
macro sheet to which the command is referenced. This affects only the
null menu bar (the menu that is displayed when there is no active
document window). On other menu bars, a command that references a
closed macro sheet causes Excel to open the macro sheet and execute
the macro (provided the macro sheet is in the current directory).
<P>
If the null menu is displayed, selecting a command referenced to a
closed macro sheet will either result in the following error message
or will be ignored:
<P>
<PRE>   Cannot find 'Hard Drive:Folder:ExternalMacroSheet!AssignedMacro'

</PRE>In Microsoft Excel for Windows, the custom command will be available
on the null menu, but nothing happens when it is chosen.
<P>
This problem was corrected in Microsoft Excel version 4.0. To obtain
an update, contact Microsoft Consumer Sales at (800) 426-9400.
<P>
<P><h3>Workaround for Excel 3.0</h3>
 
<P>
The workaround for this problem is to reference only macros on a macro
sheet that will be open (but hidden) when the command is executed from
the null menu bar. Create small macros that open the appropriate macro
sheet then execute the external macro. For example:
<P>
<PRE>   A1: OpenCommandMacro
   A2: =OPEN("ExternalMacroSheet")
   A3: =RUN("MacroSheet!CommandMacro")
   A4: =RETURN()

</PRE>In the example above, the command that eventually runs
MacroSheet!CommandMacro will reference the macro OpenCommandMacro.
<P>
Note: This approach will not work if all macro sheets are closed.
<P>
Reference(s):
<P>
"Microsoft Excel Function Reference," for the Macintosh, version 3.0,
pages 6-7
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
