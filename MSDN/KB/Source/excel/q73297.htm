

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Q+E UAE with % Search on Date column With SQLServer Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73297 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/06/21">
<META NAME="Keywords" CONTENT="hang wildcard SQLServer W_eXceL kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QABM,QACE,QA5V,QA2Q,QAB4,QAI5,QAE1,QAG2,QBWS,QBVP,QA28,QAU9,QATJ,QDMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Q+E UAE with % Search on Date column With SQLServer Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73297 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
Q+E version 3.0 will return an Unrecoverable Application Error (UAE)
when you make a query using the wildcard "%" on a column containing
DATETIME data with the SQL Server driver.
<P>
This occurs only with Q+E for Microsoft Excel for Windows version 3.0
dated 12-9-90.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Log on to the SQL database and select a table that contains a date
   field.

<P><LI>Select the date column.

<P><LI>Select Add Condition.

<P><LI>In the Value box, type "%/%/87" or "%%/%%/87" (without the
   quotation marks) to find all dates in 1987.

<P><LI>Choose OK.

<P><LI>You will receive a UAE message.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
A UAE will result whether you have the options DOS or SQL wildcards
selected. After the UAE, if you try to log on to the SQL Server again,
you will get another error message "Null DB process Encountered." You
must restart Windows.
<P>
<P><h3>Workaround</h3>
 
You can add any of the following WHERE clauses to your SQL query
to find those records with dates that meet your criteria.
<P>
Method #1:
<P>
<PRE>   WHERE DATECOL BETWEEN 1/1/1987 AND 12/31/1987

</PRE></OL>Records matching the WHERE clause criteria values are included in
the results.
<P>
Method #2:
<P>
<PRE>   WHERE SUBSTRING(CONVERT(CHAR(20),DATECOLUMN),8,4 = "1987"

</PRE>This function converts the DATE datatype to a 20 char text string and
then extracts 4 characters starting at char #8 to use for comparison
with "1987".
<P>
Method #3:
<P>
<PRE>   WHERE DATEPART(DATECOL,YY) = 1987

</PRE>YY can be substituted with MM,DD,YY,HH,MI or SS
<P>
The first option is probably easier to use and, if DATECOL is indexed,
it will use the index and be faster. The second method allows you more
flexibility for substituting the different date components, and will
use wildcards. The third method is probably the best "intended use" of
the features and can work with any of the DATETIME components.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
