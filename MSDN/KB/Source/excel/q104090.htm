

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Filtering/Extracting a Record That Contains a Text String </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104090">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/09/07">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can use computed criteria to filter or extract all records from a list or database where a particular text string is contained in a given column.  MORE INFORMATION  Use the following example data with the appropriate procedu...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QATX,QAPF,QA3P,QA5V,QAUJ,QAMB,QATF,QAE5,QAE1,QBWS,QDNZ,QARM,QA7O,QA7N P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Filtering/Extracting a Record That Contains a Text String</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104090</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 5.0, 5.0c
<LI>Microsoft Excel for OS/2, versions 2.2, 3.0
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.0, 4.0, 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can use computed criteria to filter or extract
all records from a list or database where a particular text string is
contained in a given column.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following example data with the appropriate procedure to filter or
extract all records where the Name column contains the text string "Jo"
(without the quotation marks).
<P>
<P><h3>Example Data</h3>
 
<P>
<PRE>   A1: Name      B1:       C1: Name
   A2: John      B2:
   A3: Sue
   A4: Mary Jo
   A5: Bill

</PRE><h3>Microsoft Excel Version 5.0 and Later</h3>
 
<P>
To use this method, follow these steps:

<OL><P><LI>To extract all records where a particular text string occurs in a
   column, enter the following computed criteria
<P>
<P><PRE>      B2: =SEARCH("Jo",A2)
</PRE><P>
   where "Jo" is the text string to search for, and A2 is the first
   cell (not including the field name) in the column where the text
   string may occur. If you want to your search to be case sensitive,
   use FIND("Jo",A2).
<P>
   To extract all records from a column that contain an exact match to
   a text string, enter the following computed criteria:
<P>
<P><PRE>      B2:  =A2="John"
</PRE><P>
   NOTE: The criteria name in the first row of the criteria range (cell
   B1) can be any name except the name of a database field; if you use
   the name of a database field, Microsoft Excel will interpret the
   criteria as comparison criteria. You may also leave the cell blank, as
   is shown here.

<P><LI>Select the list range A1:A5.

<P><LI>On the Data menu, point to Filter, and then click Advanced Filter.
   Click OK in the dialog box telling you that no headers are detected.

<P><LI>Under Action, select the Copy To Another Location option. In the
   Criteria Range box, type "B1:B2" (without the quotation marks). In the
   Copy To box, type "C1" (without the quotation marks) and click OK.
<P>
</OL>If you used the first computed criteria shown above, the names John and
Mary Jo appear in your filtered list. If you used the second computed
criteria, only the name John appears.
<P>
<P><h3>Microsoft Excel Versions 2.x, 3.0, and 4.0</h3>
 
<P>
To use this method, follow these steps:

<OL><P><LI>Select cells A1:A5 and click Set Database on the Data menu.

<P><LI>Select cells B1:B2 and click Set Criteria on the Data menu.
<P>
   NOTE: The criteria name in the first row of the criteria range (cell
   B1) can be any name except the name of a database field; if you use
   the name of a database field, Microsoft Excel will interpret the
   criteria as comparison criteria. You may also leave the cell blank, as
   is shown here.

<P><LI>Select cell C1 and click Set Extract on the Data menu (Microsoft Excel
   3.0 and 4.0 only).

<P><LI>To extract all records where a particular text string occurs in a
   column, enter the following computed criteria
<P>
<P><PRE>      B2: =SEARCH("Jo",A2)
</PRE><P>
   where "Jo" is the text string to search for, and A2 is the first
   cell (not including the field name) in the column where the text
   string may occur. If you want to your search to be case sensitive,
   use FIND("Jo",A2).
<P>
   To extract all records from a column that contain an exact match to
   a text string, enter the following computed criteria:
<P>
<P><PRE>      B2:  =A2="John"
</PRE>
<P><LI>Select cell C1. This step is required in Microsoft Excel 2.x; it is
   optional in Microsoft Excel 3.0 and 4.0.

<P><LI>Click Extract on the Data menu. Click OK in the dialog box that appears
   on your screen.
<P>
</OL>If you used the first computed criteria shown above, the names John and
Mary Jo appears in your extract range. If you used the second computed
criteria, only the name John appears.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.20 3.00 4.00 4.00a 5.00 5.00a 5.00c 7.00 7.00a 97<BR>
98 XL98 XL97 XL7 XL5 XL4 XL3<BR>
Version           : WINDOWS:2.0,3.0,4.0,5.0,5.0c,7.0,7.0a,97: MACINTOSH:2.0,3.0,4.0,5.0,98<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
