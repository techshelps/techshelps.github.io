

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: How to Rank Duplicate Values Sequentially </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152567">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1996/06/18">
<META NAME="Keywords" CONTENT="xlformula xllist">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If a row or column of cells contains duplicate values, the RANK function assigns the same rank value to every occurrence of the duplicate value.  This article describes a formula that you can use to assign a unique rank for all numbers in a range, ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKD,QAB9,QBCF,QAUD,QDNZ,QA5V,QAE1,QDMR,QBDO,QBCE,QA28,QATJ,QAM3,QAMN P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Rank Duplicate Values Sequentially</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152567</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If a row or column of cells contains duplicate values, the RANK function
assigns the same rank value to every occurrence of the duplicate value.
<P>
This article describes a formula that you can use to assign a unique rank
for all numbers in a range, even if the range includes duplicate values.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To assign a unique rank for all numbers in a range, use the following
formula:
<P>
<PRE>   =SUM(1*Cell&gt;=Range))-(SUM(1*(Cell=Range))-1)/2

</PRE>where "cell" is the relative address of the cell containing one of the
values to be ranked, and "range" is the absolute address of the range
containing all of the values. This formula assigns a unique rank to every
value in a range, in ascending order.
<P>
By modifying this formula, you can rank values which are listed in
ascending or descending order in a column or row.
<P>
<P><h3>Values in a Column, Ascending Order</h3>
 

<OL><P><LI>Type the following data in a worksheet:
<P>
<PRE>      A1: 100     B1:
      A2:  75     B2:
      A3: 100     B3:
      A4:  75     B4:
      A5:  50     B5:

</PRE><P><LI>In cell B1, type the following formula:
<P>
<P><PRE>      =SUM(1*(A1&gt;$A$1:$A$5))+1+IF(ROW(A1)-ROW($A$1)=0,0,
       SUM(1*(A1=OFFSET($A$1,0,0,INDEX(ROW(A1)-ROW($A$1)+1,1)-1,1))))
</PRE><P>
   NOTE: The formula must be entered as an array formula. To enter a
   formula as an array formula in Microsoft Excel for Windows, press
   CTRL+SHIFT+ENTER. In Microsoft Excel for the Macintosh, press
   COMMAND+ENTER.

<P><LI>With cell B1 selected, grab the fill handle and fill the formula down
   through cell B5.
<P>
</OL>The ranked values appear as follows:
<P>
<PRE>   A1: 100     B1: 4
   A2:  75     B2: 2
   A3: 100     B3: 5
   A4:  75     B4: 3
   A5:  50     B5: 1

</PRE></OL><h3>Values in a Column, Descending Order</h3>
 

<OL><P><LI>Type the following data in a worksheet:
<P>
<PRE>      A1: 100     B1:
      A2:  75     B2:
      A3: 100     B3:
      A4:  75     B4:
      A5:  50     B5:

</PRE><P><LI>In cell B1, type the following formula:
<P>
<P><PRE>      =SUM(1*(A1&lt;$A$1:$A$5))+1+IF(ROW(A1)-ROW($A$1)=0,0,
       SUM(1*(A1=OFFSET($A$1,0,0,INDEX(ROW(A1)-ROW($A$1)+1,1)-1,1))))
</PRE><P>
   NOTE: The formula must be entered as an array formula. To enter a
   formula as an array formula in Microsoft Excel for Windows, press
   CTRL+SHIFT+ENTER. In Microsoft Excel for the Macintosh, press
   COMMAND+ENTER.

<P><LI>With cell B1 selected, grab the fill handle and fill the formula
   down through cell B5.
<P>
</OL>The ranked values appear as follows:
<P>
<PRE>   A1: 100     B1: 1
   A2:  75     B2: 3
   A3: 100     B3: 2
   A4:  75     B4: 4
   A5:  50     B5: 5


</PRE></OL><h3>Values in a Row, Ascending Order</h3>
 

<OL><P><LI>Type the following data in a worksheet:
<P>
<P><PRE>      A1: 100  B1: 75  C1: 100  D1: 75  E1: 50
<PRE></PRE>      A2:      B2:     C2:      D2:     E2:

</PRE><P><LI>In cell A2, type the following formula:
<P>
<P><PRE>      =SUM(1*(A1&lt;$A$1:$E$1))+1+IF(COLUMN(A1)-COLUMN($A$1)=0,0,
       SUM(1*(A1=OFFSET($A$1,0,0,INDEX(COLUMN(A1)-COLUMN($A$1)+1,1)-1))))
</PRE><P>
   NOTE: The above formula must be entered as an array formula. To
   enter a formula as an array formula in Microsoft Excel for Windows,
   press CTRL+SHIFT+ENTER. In Microsoft Excel for the Macintosh, press
   COMMAND+ENTER.

<P><LI>With cell A2 selected, grab the fill handle and fill the formula
   right through cell E2.
<P>
</OL>The ranked values appear as follows:
<P>
<PRE>   A1: 100  B1: 75  C1: 100  D1: 75  E1: 50
   A2: 4    B2: 2   C2: 5    D2: 3   E2: 1

</PRE></OL><h3>Values in a Row, Descending Order</h3>
 

<OL><P><LI>Type the following data in a worksheet:
<P>
<P><PRE>      A1: 100  B1: 75  C1: 100  D1: 75  E1: 50
<PRE></PRE>      A2:      B2:     C2:      D2:     E2:

</PRE><P><LI>In cell A2, type the following formula:
<P>
<P><PRE>      =SUM(1*A1&lt;A1:E1))+1+IF(COLUMN(A1)-COLUMN(A1)=0,0,
       SUM(1*(A1=OFFSET(A1,0,0,1,INDEX(COLUMN(A1)-COLUMN(A1)+1,1)-1))))
</PRE><P>
   NOTE: The above formula must be entered as an array formula. To
   enter a formula as an array formula in Microsoft Excel for Windows,
   press CTRL+SHIFT+ENTER. In Microsoft Excel for the Macintosh, press
   COMMAND+ENTER.

<P><LI>With cell A2 selected, grab the fill handle and fill the formula
   right through cell E2.
<P>
</OL>The ranked values appear as follows:
<P>
<PRE>   A1: 100  B1: 75  C1: 100  D1: 75  E1: 50
   A2: 1    B2: 3   C2: 2    D2: 4   E2: 5
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 97 8.00 XL97 XL98<BR>
Keywords          : xlformula xllist<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97; MACINTOSH:5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
