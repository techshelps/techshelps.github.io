

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSQuery: Illegal Duplicate Key When Adding Character Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110603">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/01/25">
<META NAME="Keywords" CONTENT="kbusage kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you add records to a table, if an index field (whose type is defined as character) is left blank, and if Microsoft Query is instructed to add another new record, the following error message will appear:     Illegal Duplicate Key.  After a reco...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBI0,QAB4,QAFO,QA7O,QA7N,QAUD,QBXS,QAGB,QDMH,QAEF,QDI1,QDIJ,QBWS,QAO1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQuery: Illegal Duplicate Key When Adding Character Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110603</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Query, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you add records to a table, if an index field (whose type is defined
as character) is left blank, and if Microsoft Query is instructed to add
another new record, the following error message will appear:
<P>
<PRE>   Illegal Duplicate Key.

</PRE>After a record is entered, Microsoft Query adds an empty record below it,
ready for data input. The character field in the previously entered record
is also empty; therefore, when Microsoft Query adds a new, blank record,
the two character fields are duplicates of one another and Microsoft Query
reports the error described above.
<P>
When you receive this error message, acknowledge the message and return to
the just completed record to enter the correct value in the appropriate
field.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid the error message, entered data in the blank field.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>From the File menu, choose New Query.

<P><LI>From the Available Data Sources, select dBASE Files.

<P><LI>Choose Use, and then select a .DBF file.
<P>
</OL>NOTE: The .DBF file must be indexed (that is, sorted by dBASE).

<OL><P><LI>Choose Add, and then choose Close.

<P><LI>In the table pane, double-click the asterisk (*) to show all records.

<P><LI>From the Records menu, choose Allow Editing.

<P><LI>Note that a new blank record is added to the bottom of the query table.

<P><LI>Move to the bottom of the table and add information, leaving a character
   field empty.

<P><LI>Press the DOWN ARROW key to add the current record and create a new,
   empty record.
<P>
</OL>An alert box will appear with the message "Illegal duplicate key."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kberrmsg<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 5.00 datafield MS
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
