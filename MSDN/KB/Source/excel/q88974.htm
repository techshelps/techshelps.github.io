

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Building a SQL Query Longer than 255 Characters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88974 ">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1992/09/06">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" Summary:  Microsoft Excel for the Macintosh limits the number of characters that can be typed into a cell or assigned to a string to 255 characters. One result of this is that SQL statements which are greater than 255 characters in length must be cr...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QABM,QAPN,QAUR,QBRZ,QAU7,QAB9,QBW7,QAI5,QACF,QAH4,QA1S,QAHE,QANY,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Building a SQL Query Longer than 255 Characters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88974 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 3.0 and 4.0
</UL> 
<P>
Summary:
<P>
Microsoft Excel for the Macintosh limits the number of characters that
can be typed into a cell or assigned to a string to 255 characters.
One result of this is that SQL statements which are greater than 255
characters in length must be created and saved to a file before
accessing them through a macro SQL.QUERY() statement.
<P>
More Information:
<P>
The Database Access Macro allows accessing remote databases from
within Microsoft Excel, including the submission of SQL (Structured
Query Language) queries. In order to send a SQL statement longer than
255 characters within a macro statement, the query must be saved to a
file and accessed by a special form of the SQL.QUERY() macro function.
<P>
To save a SQL query as a text file:

<OL><P><LI>From the Data menu, choose SQL Query...

<P><LI>Type out the SQL statement in the Query Editor dialog box.

<P><LI>Click the Save button and save the query out to a filename.
<P>
</OL>The syntax for the macro function SQL.QUERY for accessing a SQL query
which has been saved to a file is:
<P>
<PRE>   =SQL.QUERY(3,"Hard Disk:QueryTextFile",1)

</PRE></OL>The first argument specifies the query type; 3 indicates that a text
file will be the source for the SQL statement. The second argument
contains the folder location and filename (QueryTextFile) of the SQL
query. The '1' in the function above specifies that the information
returned after processing the query should be returned to the current
selection. This argument can be changed to whatever is appropriate. A
fourth optional argument can also be included specifying a file name
to store the returned information.
<P>
Reference(s):
<P>
"Microsoft Excel Database Access User's Guide," versions 3.0 and 4.0,
pages 20 and 34
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.0 3.00 4.0 4.00 dam dal<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
