

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Determining Button Clicked in User-Defined Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q49265 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/09/28">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QA01,QAGC,QAOX,QBVP,QAUD,QAD7,QA5D,QANX,QAJD,QAPN,QAKD,QANS,QAK3,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Determining Button Clicked in User-Defined Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q49265 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
In a custom dialog box in Microsoft Excel, the DIALOG.BOX() function
returns a FALSE if the dialog box is canceled and the item number of
the OK button if OK is clicked.
<P>
To evaluate which OK button is chosen in a dialog box, or if the
dialog box is canceled, an IF() statement can be used. For example,
the following conditional in A1 will react as follows when the dialog
in B1:I4 is executed:
<P>
<PRE>   Button Clicked    Action
   --------------    ------

   Print             Executes the PRINT() command
   Edit              Runs the macro named "Edit"
   Cancel            Closes the active window


              A                           B  C  D  E  F     G
   1   =DIALOG.BOX(B1:I4)                                 Dialog Box
   2   =IF(A1=2,PRINT())                  1               Print
   3   =IF(A1=3,Edit())                   3               Edit
   4   =IF(A1=FALSE,CLOSE())              2               Cancel
   5   =RETURN()

</PRE><h2>MORE INFORMATION</h2>
 
<P>
In the above example, cell A1 will have a value of 2 if the Print
button is clicked, since it is a default OK button and appears as the
second item in the dialog box table. A1 will have a value of 3 if the
Edit button is clicked, since it is an OK button that appears as the
third item in the dialog table. Clicking the Cancel button will return
a FALSE to cell A1, and no changes made in the dialog box will be
recorded in the initial/result column.
<P>
Note that Excel considers any nonzero value to have a Boolean
equivalent of TRUE. Therefore, it is possible to nest the DIALOG.BOX()
statement in an IF statement such that it will do one action if any OK
button is clicked, and another if Cancel is clicked. For example, the
following macro will call the dialog box again if the Cancel button is
clicked and will continue when the OK button is clicked. Thus, it is
impossible to leave this dialog box by pressing ESC or clicking Cancel.
<P>
<PRE>              A                     B  C  D  E  F     G
   1   =DIALOG.BOX(B1:I3)                           Print Dialog Box
   2   =IF(A1,PRINT(),GOTO(A1))     1               OK
   3   =RETURN()                    2               Cancel
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 1.50 2.20 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
