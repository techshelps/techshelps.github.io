

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL7: PivotTable Calculated Data Source Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151692">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1996/05/28">
<META NAME="Keywords" CONTENT="xlpivot kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Under certain circumstances, you may receive incorrect values in the Subtotal and Grand Total cells in PivotTables that you create in Microsoft Excel 7.0 and 7.0a.  MORE INFORMATION  Only PivotTables that you create under the following circumstance...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVU,QBVP,QAAP,QA7O,QA7N,QAB4,QAY5,QAB9,QAK6,QBV8,QAYY,QAUD,QAKD,QA5V,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: PivotTable Calculated Data Source Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151692</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0, 7.0a
</UL> 
<P>
SYMPTOMS
 
<P>
Under certain circumstances, you may receive incorrect values in the
Subtotal and Grand Total cells in PivotTables that you create in Microsoft
Excel 7.0 and 7.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Only PivotTables that you create under the following circumstances are
affected. Note that all five conditions must be true in order for the error
to occur:

<OL><P><LI>You create the PivotTables in Microsoft Excel, version 7.0 or 7.0a
   Microsoft Excel 5.0 for Windows, and Microsoft Excel 5.0 for Macintosh
   are not affected.

<P><LI>You create the Pivot Table from source data that is stored in Microsoft
   Excel, as opposed to data drawn from an external source, such as a
   database.

<P><LI>The source data must include formulas or functions. This situation is
   most common when a field in the source data is calculated from other
   fields. For example, the field "% Profit" is calculated using the
   formula "=(Revenue-Cost)/Revenue", where Revenue and Cost are fields in
   the source data.

<P><LI>A formula or function in the source data must return an error value,
   such as #VALUE!, #NUM!, #NAME?, #DIV/0!, and so on.

<P><LI>The only operation that you use to summarize Pivot Table data fields is
   SUM. You do not select any other summary operation, such as COUNT or
   AVERAGE, in the PivotTable Field dialog box.
<P>
</OL><h2>WORKAROUNDS</h2>
 
<P>
There are several methods you can use to work around this behavior.
<P>
<P><h3>Method 1</h3>
 
<P>
Remove the error values from your source data. You can remove the error
values by correcting your data to remove the errors, or by using a function
that checks for error values. The following is an example of a function
that checks for error values.
<P>
Type the following function in every cell in your source data that could
return an error:
<P>
<PRE>   =IF(ISERROR(Your Function),"NA",Your Function)

</PRE></OL>where Your Function is the formula or function you are using in your source
data. For example, type the following formula in cell C2 for a formula
=A2/B2 located in cell C2:
<P>
<PRE>   =IF(ISERROR(A2/B2),"NA",A2/B2)

</PRE>If the formula is valid, the proper value will be returned. If the formula
results in an error, instead of returning an error message, the function
returns "NA." Note that "NA" is a placeholder message that you can change
to meet your needs.
<P>
<P><h3>Method 2</h3>
 
<P>
If you have only one Pivot Table field in one dimension (there is only 1
row field or only 1 column field in your table), using the right mouse
button (right-click), click that field and click the Pivot Table Field
command. In the Subtotals category of the dialog box, click to select
Count. This option will correct the error, and will not change the
appearance of your PivotTable.
<P>
<P><h3>Method 3</h3>
 
<P>
If you have multiple fields, right-click the innermost row field (the
field name that appears furthest to the right in the list of row fields),
and click the Pivot Table Field command. In the Subtotals category of the
dialog box, enable Count. This option will correct the error, and will add
several rows that display data counts for your data at the bottom of the
PivotTable. You can hide these rows prior to printing by using the Hide
Rows command.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 7.00a pvtpatch<BR>
Keywords            : xlpivot kbusage<BR>
Version             : 7.00 7.00a<BR>
Platform            : WINDOWS<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
