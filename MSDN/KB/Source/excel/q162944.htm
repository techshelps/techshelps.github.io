

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: How to Modify the Number of Undo Levels </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162944">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/01/30">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows 95 folder.   By default ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBXS,QAGC,QBWS,QAL0,QAKC,QBJZ,QBWP,QDL9,QBWO,QBWN,QAKD,QDIU,QBC6,QAG8 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: How to Modify the Number of Undo Levels</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162944</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows 95 folder.
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default Microsoft Excel 97 keeps track of 16 undo levels, which provide
an undo history for most actions you perform in Microsoft Excel. You can
change the number of undo levels by adding an entry in the Microsoft
Windows registry. Microsoft recommends that you do not increase the number
of undo levels beyond 100 levels.
<P>
NOTE: The more you increase the number of undo levels the more random
access memory (RAM) Microsoft Excel requires to store the undo history.
This affects the performance of Microsoft Excel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By default Microsoft Excel 97 allocates RAM for 16 undo levels. The
registry setting described in this article allows you to change the default
to a value you specify. If the undo history is set to zero, no memory is
allocated for undoing actions. The higher the undo history value the more
memory Microsoft Excel allocates for the history. This directly affects the
performance of your computer when you run Microsoft Excel.
<P>
NOTE: When you run a Visual Basic for Applications macro, Microsoft Excel
allocates no memory for undoing actions. This feature is disabled for
optimization and performance when you run a macro.
<P>
<P><h3>Windows 95 and Windows NT 4.0</h3>
 
<P>
To use the Registry Editor to change the number of undo levels under
Microsoft Windows 95 and Microsoft Windows NT 4.0, use the following steps:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95 or Windows NT. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry
Editor can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.

<OL><P><LI>Close any programs that are running.

<P><LI>On the Start menu, click Run. Type regedit and click OK.

<P><LI>In the Registry Editor, expand the following key:
<P>
<P><PRE>      HKey_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel
</PRE>
<P><LI>On the Edit menu, point to New and click DWORD Value. With "New Value
   #1" selected, type UndoHistory, and then press ENTER.

<P><LI>On the Edit menu, click Modify. In the Edit DWORD Value dialog box,
   click Decimal under Base. Type a value between 0 and 100 for Value.
   Click OK and quit the Registry Editor.

<P><LI>Start Microsoft Excel 97. Microsoft Excel stores an undo history for the
   number of actions you specify in step 5.
<P>
</OL><h3>Windows NT 3.51</h3>
 
<P>
To change the number of undo levels under Microsoft Windows NT 3.51 using
the Registry Editor, use the following steps:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows NT. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.

<OL><P><LI>Close any programs that are running.

<P><LI>Open Program Manager. On the File menu, click Run. Type regedt32 and
   click OK.

<P><LI>In the Registry Editor, switch to the window for HKey_Current_User.

<P><LI>Expand the following key:
<P>
<P><PRE>      HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel
</PRE>
<P><LI>On the Edit menu, click Add Value. In the Add Value dialog box, type
   UndoHistory in the Name box. In the Data Type list click Reg_Dword and
   click OK.

<P><LI>In the DWord Editor dialog box, click Decimal for Radix. Type a
   value between 0 and 100 for Data. Click OK and quit the Registry Editor.

<P><LI>Start Microsoft Excel 97. Microsoft Excel stores an undo history for the
   number of actions you specify in step 5.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about undoing an action, click the Index tab in
Microsoft Excel Help, type the following text
<P>
<PRE>   undo

</PRE></OL>and then double-click the selected text to go to the "undoing, actions"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 multiple levels<BR>
Keywords          : kbui<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
