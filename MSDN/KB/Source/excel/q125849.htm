

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Access ODBC Driver Returns Date of 12/30/1899 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125849">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1995/02/07">
<META NAME="Keywords" CONTENT="kbinterop xlquery">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you retrieve Microsoft Access data from Microsoft Query, if a date/time field contains a time without a date, the data in that field will be returned with a date of 12/30/1899. This presents a problem when the data is retur...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QACE,QBI0,QA1S,QA7O,QA7N,QAUD,QAU3,QAMR,QAFH,QDN9,QDO0,QALW,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Access ODBC Driver Returns Date of 12/30/1899</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125849</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you retrieve Microsoft Access data from
Microsoft Query, if a date/time field contains a time without a date, the
data in that field will be returned with a date of 12/30/1899. This
presents a problem when the data is returned to Microsoft Excel because
Microsoft Excel does not recognize dates earlier than 1900. Microsoft Excel
interprets the data as text rather than Date/Time values, and you cannot
successfully apply a date or time number format to the data in Microsoft
Excel.
<P>
<P><h2>CAUSE</h2>
 
<P>
These results are by design. When you create a time or date format in
Microsoft Access, the program internally stores both the date and time.
However, Microsoft Access masks the date or the time depending on the
format you choose. So, in a Time format, it must store some date--the date
it uses as a "dummy" date is '1899-12-30'.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use either of the following methods.
<P>
Method 1: In Microsoft Query, change the date from 12/30/1899 to 1/1/1900,
<PRE>          which is a valid date in Microsoft Excel.

          To change the field definition in MSQuery to an expression that
          is the field name + 2, use the following steps:

          1. Add the field to the data pane.

          2. Double-click the field heading in the data pane.

          3. In the Field box, type "+2" (without the quotation marks)
             after the field name.

          4. Click OK.

          When field names are returned to Microsoft Excel, the expression
          "&lt;fieldname&gt;+2" or "Expr1001" may be displayed. To remedy this,
          do the following in MS Query:

          1. Click the SQL button.

          2. Find the section that reads "&lt;fieldname&gt;+2."

          3. After the 2, enter the following text

               " As &lt;alias&gt; " (note leading and trailing space)

          where &lt;alias&gt; is what you want to appear as a field name when
          data is returned to Microsoft Excel.

</PRE>Method 2: In Microsoft Excel, convert the values to valid Date/Time values
<PRE>          once the data has been retrieved to Microsoft Excel. For example,
          you could do the following to convert the returned values to
          dates by using the Replace command to replace the date 12/30/1899
          with a valid date:

          1. In Microsoft Excel, select the data to convert to valid dates.

          2. On the Edit menu, click the Replace command.

          3. In the Find What box, type "1899-12-30" and in the Replace
             With box, type "1994-12-30," and then choose the Replace All
             button.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 5.00 5.00c MSQuery 7.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
