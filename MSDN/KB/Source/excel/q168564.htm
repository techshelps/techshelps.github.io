

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Errors After Copying Worksheet with Auditing Arrows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168564">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="xlgpf xlloadsave xlui kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, the following problems may occur:   - When you delete a worksheet, you receive the following error message:        This program has performed an illegal operation and will be shut       down. If the problem persists, contact ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QAO2,QAEF,QA9N,QBQU,QBJZ,QAU5,QAUR,QDNM,QASB,QBWS,QAJD,QANJ,QAKP P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Errors After Copying Worksheet with Auditing Arrows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168564</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, the following problems may occur:

<UL><LI>When you delete a worksheet, you receive the following error message:
<P>
<P><PRE>      This program has performed an illegal operation and will be shut
      down. If the problem persists, contact the program vendor.
</PRE><P>
   If you click Details, you receive an error message similar to any of
   the following:
<P>
<P><PRE>      EXCEL caused an invalid page fault in module KERNEL32.DLL at
      0137:bff798fc.
</PRE><P>
<P><PRE>      EXCEL caused an invalid page fault in module EXCEL.EXE at
      0137:3028c56f.
</PRE><P>
<P><PRE>      EXCEL caused an invalid page fault in module &lt;unknown&gt; at
      0000:7c651f00.
</PRE><P>
   When you click Close, Microsoft Excel 97 quits.

<LI>If you click the Tools menu, point to Auditing, and click Remove All
   Arrows, you receive an error message in the previous symptom.

<LI>If you click an auditing arrow, you may receive the Illegal Operation
   error message described in this article.
<P>
   If you click Details, you receive the following error message:
<P>
<P><PRE>      EXCEL caused an invalid page fault in module MSO97.DLL at
      0137:306f3fed.
</PRE>
<LI>When you save a workbook, you receive the following error message:
<P>
<P><PRE>      This workbook contains features that are not supported by the file
      format that you selected. To avoid the possible loss of formatting
      or information, be sure to save a copy in the most recent Microsoft
      Excel Workbook format.
</PRE><P>
   Note that you receive this message even if you are saving the workbook
   in the Microsoft Excel Workbook format.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems occur when the following conditions are true:

<UL><LI>You copy a worksheet that contains auditing arrows in the same workbook
   or move this worksheet to another workbook.
<P>
<P><PRE>    -and-
</PRE>
<LI>You attempt to delete the new worksheet, to remove auditing arrows from
   the new worksheet, to select an auditing arrow, or to save the workbook
   that contains the worksheet.
<P>
</UL>Auditing arrows in Microsoft Excel 97 are not designed to be copied. As a
result, if you copy a worksheet that contains auditing arrows, the arrows
on the new worksheet may become unstable. This may cause problems if you
attempt to delete the new worksheet, save the workbook, select an auditing
arrow, or remove the auditing arrows from the new worksheet.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent these problems from occurring, remove all auditing arrows in the
worksheet before you copy it. To remove the arrows, do the following:

<OL><P><LI>Click the worksheet that contains the auditing arrows.

<P><LI>On the Tools menu, point to Auditing, and then click Remove All Arrows.
<P>
</OL>After you copy the worksheet, you can make the auditing arrows available.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, you can use auditing arrows to trace dependents,
precedents, and errors. To use auditing arrows, do the following:

<OL><P><LI>Select the cell you want to audit.

<P><LI>On the Tools menu, point to Auditing, and then click Trace
   Precedents, Trace Dependents, or Trace Error, as appropriate.
<P>
</OL>If you click Show Auditing Toolbar, you can use the tools on the Auditing
toolbar to audit cells.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlgpf xlloadsave xlui kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
