

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: Values Incorrect When Formulas Saved in WK3 or WK4 Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176802">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1997/11/14">
<META NAME="Keywords" CONTENT="xl123quattro xlformula xlloadsave">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 98 Macintosh Edition, if you save a workbook in the Lotus 1-2-3 WK3 or WK4 file format, natural language formulas in the workbook are converted into values. This is correct behavior and occurs by design of Microsoft Excel.  Howev...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUR,QBVP,QAKD,QAU7,QBTI,QBJZ,QDO8,QAB9,QDNZ,QBWS,QBVV,QAKC,QAAP,QAKP,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Values Incorrect When Formulas Saved in WK3 or WK4 Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176802</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, if you save a workbook in the
Lotus 1-2-3 WK3 or WK4 file format, natural language formulas in the
workbook are converted into values. This is correct behavior and occurs by
design of Microsoft Excel.
<P>
However, under certain circumstances, the natural language formulas may be
converted into values that are not correct given the original formula.
Because the formula no longer exists, you may not notice that the value is
incorrect.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>In the workbook, you create a natural language formula that refers to a
   range that contains six or more cells, for example:
<P>
<P><PRE>      A1: Revenue
      A2: 129
      A3: 130
      A4: 131
      A5: 132
      A6: 133
      A7: 134
      A8: =SUM(Revenue)
</PRE><P>
<P><PRE>    Note that the =SUM(Revenue) formula refers to at least six cells.
</PRE><P>
   -and-

<LI>The range contains at least five different, unique values, for example:
<P>
<PRE>      129   130   131   132   133   134

      -or-

      129   129   131   132   133   134

   -and-

</PRE><LI>All of the cells in the range contain values with absolute values that
   are greater than 128.
<P>
   For example, the following numbers have absolute values that are greater
   then 128:
<P>
<PRE>      129   130   200   -129   -130   -200

   -and-

</PRE><LI>You save the workbook in the Lotus 1-2-3 WK3 or WK4 file format.
<P>
</UL>When you close and reopen the WK3 or WK4 file, the cells that contain the
natural language formulas contain values that are different from the
original values. For an example that demonstrates this problem, see the
"More Information" section in this article.
<P>
NOTE: This problem does not occur when you save a workbook in the Lotus
1-2-3 WK3 or WK4 file format in Microsoft Excel 97 for Windows.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, save the workbook in the Microsoft Excel
5.0/95 Workbook format before you save it in the WK3(1-2-3) or WK4(1-2-3)
format. To do this, follow these steps:

<OL><P><LI>Switch to the workbook.

<P><LI>On the File menu, click Save As.

<P><LI>In the "Save File as Type" list, click "Microsoft Excel 5.0/95
   Workbook." Change the file name in the Save As box to a new name and
   click Save.

<P><LI>After you save the workbook, click Close on the File menu. If you are
   prompted, do not save changes.

<P><LI>Reopen the workbook you saved in step 3.

<P><LI>On the File menu, click Save As. In the "Save File as Type" list,
   select the appropriate Lotus 1-2-3 file format. Change the file name
   in the Save As box if you want. Then, click Save.
<P>
</OL>When you save the workbook in the Microsoft Excel 5.0/95 Workbook format,
the natural language formulas are converted into normal formulas. Then,
when you save the workbook in the Lotus 1-2-3 file format, the problem does
not occur.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97 for Windows and Microsoft Excel 98 Macintosh Edition,
natural language formulas allow you to make references to a range of cells
without having to define names. For example, if you have a worksheet that
contains the following data
<P>
<PRE>               B1: Charlie   C1: Echo
   A2: Alpha   B2: 1         C2: 3
   A3: Bravo   B3: 2         C3: 4

</PRE></OL>you can sum the values in the Alpha row by using the following formula
<P>
<PRE>   =SUM(Alpha)

</PRE>and you can find the value at the intersection of Bravo and Echo by using
the following formula:
<P>
<PRE>   =Bravo Echo

</PRE><h3>Example</h3>
 
<P>
You can reproduce the problem described in this article by following these
steps:

<OL><P><LI>In Microsoft Excel 98 Macintosh Edition, create a new workbook. In
   Sheet1, enter the following values and formulas:
<P>
<PRE>      A1: Revenue1         B1: Revenue2         C1: Revenue3
      A2: 129              B2: 128              C2: 129
      A3: 130              B3: 129              C3: 129
      A4: 131              B4: 130              C4: 129
      A5: 132              B5: 131              C5: 129
      A6: 133              B6: 132              C6: 129
      A7: 134              B7: 133              C7: 129
      A8: =SUM(Revenue1)   B8: =SUM(Revenue2)   C8: =SUM(Revenue3)

   Note that the values returned by the formulas are 789, 783, and 774.

</PRE><P><LI>On the File menu, click Save As.

<P><LI>In the Save File As Type list, click "WK4 (1-2-3)." In the Save
   As box, type "NLFTest" (without the quotation marks). Then, click
   Save.

<P><LI>When you receive the following error message
<P>
<P><PRE>      A formula in a cell (Cell:A:A8) could not be converted because it
      contains a function that is not available in the file format to
      which you are saving. If you continue the save, the formula and
      result will be saved, but the function itself will be converted to
      an error value.
</PRE><P>
   click No.

<P><LI>When you receive the following error message
<P>
<P><PRE>      Microsoft Excel cannot convert some of the cells. The total number
      of errors found is 3.
</PRE><P>
   click OK.

<P><LI>On the File menu, click Close, and then click Don't Save.

<P><LI>Reopen the NLFTest workbook.
<P>
</OL>Note the following:

<UL><LI>The value in cell A8 is 1013; it should be 789. The problem occurs in
   this cell because all of the conditions that are listed in the "Cause"
   section are true for the formula in this cell.

<LI>The value in cell B8 is 783, the correct value. The problem does not
   occur because the cell range that is referenced by the formula in
   cell B8 contains a value that was less than or equal to 128 (cell B2).

<LI>The value in cell C8 is 774, the correct value. The problem does not
   occur because the cell range that is referenced by the formula in cell
   B9 does not contain at least five different, unique values (all of the
   values are 129).
<P>
</UL>When the value in a cell changes because of this problem, the amount of the
change is always a multiple of 16. In this example, the value 789 was
changed to 1013. The difference is 224, which is a multiple of 16.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 english language formulas elf elfs nlf nlfs<BR>
256 384 128 768 Converted<BR>
Keywords          : xl123quattro xlformula xlloadsave<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
