

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Curve Fitting with Excel Using the TREND Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q34315 ">
<META NAME="KBModify" CONTENT="1995/08/20">
<META NAME="KBCreate" CONTENT="1988/08/15">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following information describes how to perform polynomial curve fitting with the TREND function.  An Explanation of Curve Fitting  Curve fitting is useful for making projections beyond a data range (extrapolation) or for making estimates betwee...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBE6,QBE7,QAUD,QAB9,QAEM,QAY5,QAK8,QBC9,QBC8,QANO,QALD,QACI,QBV8,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Curve Fitting with Excel Using the TREND Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q34315 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.x, 4.x, 5.0,
   5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following information describes how to perform polynomial curve
fitting with the TREND function.
<P>
<P><h3>An Explanation of Curve Fitting</h3>
 
<P>
Curve fitting is useful for making projections beyond a data range
(extrapolation) or for making estimates between acquired data points
(interpolation). For example, suppose a scientist has collected data,
such as voltage versus resulting current, as follows:
<P>
<PRE>   Voltage   Resulting Current
   ----------------------------

         1       1.5
         2       3.7
         3       5.0
         4      13
         5      16
         6      30
         7      35
         8      50

</PRE>This data is nonlinear; therefore, the corresponding graph is not a
straight line (the actual formula used here was  y=x^2-2*x+3 with the
values adjusted at random to represent real laboratory data). An
approximating formula for a curve that would best fit the known data
points is necessary.
<P>
<P><h3>Using the TREND Function for Curve Fitting</h3>
 
<P>
The following steps use the TREND function to fit a curve to the data
points from the above sample data.

<OL><P><LI>Enter the following data on a worksheet with the name "Sheet1":
<P>
   a. Enter the x-data (1, 2, 3,...8) in cells D1 through D8. Also,
<P><PRE>      enter 9 in cell D9.
</PRE><P>
   b. Enter the corresponding measured y-data (1.5, 3.7, 5, 13, 16,
<P><PRE>      30, 35, and 50) in cells E1 through E8.
</PRE><P>
   c. Enter the increasing powers of x to regress against your
<P><PRE>      y-values to achieve a polynomial fit. In cell C1, enter the
      formula "=D1^2" (without quotation marks) and select the range
      C1 through C9. From the Edit menu, choose Fill Down.
</PRE><P>
   d. Repeat step c in column B with the formula "=D1^3" (without
<P><PRE>      quotation marks), and in column A with the formula "=D1^4"
      (without the quotation marks).
</PRE><P>
   e. Enter the TREND function as an array formula in cells F1 through
<P><PRE>      F8. Select this range and enter the following formula in cell
      F1 (do not press ENTER yet):
</PRE><P>
<PRE>         =TREND(E1:E8,A1:D8)

</PRE><P><LI>Press CTRL+SHIFT+ENTER to enter this formula as an array formula.
   The curve-fitted values will now appear in cells F1 through F8.
   These values can be plotted along with the known y-values versus
   the known x-values to achieve a graphical representation of the
   quality of the initial y-measurements.

<P><LI>To extrapolate a value at x=9, position the cursor in cell F9 of
   Sheet1. Type the formula
<P>
<P><PRE>      =TREND(E1:E8,A1:D8,A9:D9)
</PRE><P>
   and press the ENTER key. Note that when you specify the range of
   new x-values, the equivalent higher powers of these x-values must
   also be calculated and specified in the new x range (that is, the
   new x-values must have the same format as the known x-values).
<P>
</OL>NOTE: The goal in curve fitting is to find a polynomial that
approximates the function (or set of known x-values and y-values) in
question. For instance, suppose we start with the function y=sin(x).
Most computer languages have the SINE function built in, but the
computer must go through extensive calculations to arrive at an
answer. If this function were nested in a loop, it could slow the
operation of the computer considerably.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using a Simpler Formula in Place of SINE</h3>
 
<P>
A quicker approach, if absolute accuracy is not necessary, is to
substitute a different formula in place of the SINE function that
approximates the original function in a predefined interval on the
x-axis. This formula is  simpler and therefore faster for the computer
to calculate.
<P>
Assume you are interested in the interval from x=0 to x=1. An
approximating polynomial for y=sin(x) of degree 0 might be y=1, of
degree 1 might be y=x, and of degree 3 might be y=x+(x^3)/6. The
degree of the polynomial refers to the highest power of x used.
<P>
If you understand Taylor polynomials, you know why you skipped the
polynomial of Degree 2, and how you arrived at the other polynomials.
If you are not familiar with Taylor polynomials, do not worry about it
because Microsoft Excel will handle the details. The following is an
example:
<P>
<PRE>                       DEGREE
                0        1        3

   x-value   y=sin(x) | y=1    y=x      y=x-(x^3)/6
   -------------------------------------------------

    0.000     0.000    1.000    0.000    0.000
    0.200     0.199    1.000    0.200    0.199
    0.400     0.389    1.000    0.400    0.389
    0.600     0.565    1.000    0.600    0.564
    0.800     0.717    1.000    0.800    0.715
    1.000     0.841    1.000    1.000    0.833

</PRE></OL>The higher the degree of the approximating polynomial, the higher the
accuracy. Higher degree polynomials require more calculations, so
there is a point of diminishing returns. Also, high
degree-approximating polynomials may produce inaccurate, highly
fluctuating results (a good rule to follow is to use polynomials of
degree no higher than 5).
<P>
<P><h3>Microsoft Excel version 5.0</h3>
 
<P>
Microsoft Excel version 5.0 has the built-in capability to insert a
polynomial curve into your existing x-y scatter chart. To insert this type
of curve, follow these steps:

<OL><P><LI>On the chart, select the series for which you want the polynomial curve.

<P><LI>From the Insert menu choose Trendline.

<P><LI>From the Type tab, choose Polynomial with Order 2.
<P>
</OL>The polynomial curve is now added to your chart.
<P>
For information about another curve fitting technique, query on the
following word in the Microsoft Knowledge Base:
<P>
<PRE>   newton
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 7.00 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21 3.0<BR>
3.00 4.0 4.00 4.0a 4.00a 5.0 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 20, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
