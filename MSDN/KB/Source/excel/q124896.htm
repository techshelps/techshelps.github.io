

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"TDS Buffer Length Too Large" Error Connecting to SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124896">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1995/01/16">
<META NAME="Keywords" CONTENT="kbtool kberrmsg xlquery">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use Microsoft Query, when you try to connect to an SQL Server database, you may receive an error message similar to the following:     Connection Failed    SQLState S1000    SQL Error 65528    TDS buffer length too large.  CAUSE =====  If ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QABM,QBWP,QAXB,QARL,QAI5,QDL9,QBWQ,QBWN,QAC1,QBD2,QBI0,QAVZ,QAB4,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>"TDS Buffer Length Too Large" Error Connecting to SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124896</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use Microsoft Query, when you try to connect to an SQL Server
database, you may receive an error message similar to the following:
<P>
<PRE>   Connection Failed
   SQLState S1000
   SQL Error 65528
   TDS buffer length too large.

</PRE><h2>CAUSE</h2>
 
<P>
If the client workstation is running Microsoft Windows for Workgroups
version 3.11 client (WFW 3.11) and the SQL Server is on a Microsoft Windows
NT version 3.5 server, you may have a feature called "direct hosting"
enabled. Direct hosting allows the virtual redirector on the client side
and the network server on the server side to communicate directly with the
underlying NWLink transport, bypassing NetBIOS, which provides faster
performance. However, direct hosting can prevent existing WFW 3.11 clients
from reliably connecting to the NT SQL Server.
<P>
This problem may occur after you upgrade the operating system on which SQL
Server runs from Windows NT 3.1 to version 3.5. The typical symptom of this
problem is that WFW 3.11 SQL Server clients are unable to connect to SQL
Server on Windows NT 3.5 using named pipes over NWLink.
<P>
<P><h2>RESOLUTIONS</h2>
 
<P>
To correct this connection problem, you can use either of the methods
below.
<P>
<PRE>   NOTE: Although either of the following methods should work, the method 1
   is preferred because it provides a general maintenance upgrade along
   with a number of fixes and improvements.

</PRE>Method 1: Update your Windows for Workgroups 3.11 files:
<P>
<PRE>          There are six updated Windows for Workgroups 3.11 system files
          that include a new version of the Windows for Workgroups
          redirector and other network support files that provide improved
          performance. These files are distributed on the Windows NT Server
          version 3.5 CD, in the CLIENTS\WFW\UPDATE directory. These
          updated files are the following:

             NDIS.386
             NET.EXE
             NETAPI.DLL
             NWNBLINK.386
             VNETSUP.386
             VREDIR.386

          These files should be used only for WFW 3.11. They will allow
          named pipe connections to work properly to Microsoft SQL Server
          over direct host IPX.

          To install these new files on a computer running WFW 3.11:

          1. Copy all the files from the CLIENTS\WFW\UPDATE directory on
             the Windows  NT Server CD into the local C:\WINDOWS\SYSTEM
             directory of the Windows for Workgroups 3.11-based client.

             NOTE: Remember to use the Windows NT Server CD. The Microsoft
             SQL Server CD does not contain these files.

          2. On the Windows for Workgroups 3.11-based client, move the
             NET.EXE file from C:\WINDOWS\SYSTEM to C:\WINDOWS.

          3. Restart the WFW 3.11 workstation.

</PRE>Method 2: Modify the SYSTEM.INI Setting:
<P>
<PRE>          If you prefer not to apply the updated WFW 3.11 files as
          described above, you can avoid the named pipes connection problem
          by updating the SYSTEM.INI file on the WFW 3.11 clients.

          Using any text editor, edit the SYSTEM.INI file to set
          DirectHost=off in the [network] section as shown below:

             [network]  DirectHost=off

          You need to reboot your client workstation after this
          modification.

</PRE>For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q121258.htm">Q121258</A></B>
   TITLE     : PRB: Connect to SQL on NT 3.5 from WFW 3.11 via Named Pipes
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kberrmsg<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 4.2 4.21 4.21a 1.00 wfw
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
