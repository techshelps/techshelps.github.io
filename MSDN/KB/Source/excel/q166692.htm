

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Running Multiple Versions of Microsoft Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166692">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/04/09">
<META NAME="Keywords" CONTENT="kbhowto xlui xlvbainfo kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Although Microsoft does not recommend installing more than one version of Microsoft Excel on a computer, it is possible to install and use more than one version. For example, you can install and use both Microsoft Excel 97 and Microsoft Excel 7.0 o...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBWS,QAA1 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Running Multiple Versions of Microsoft Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166692</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although Microsoft does not recommend installing more than one version of
Microsoft Excel on a computer, it is possible to install and use more than
one version. For example, you can install and use both Microsoft Excel 97
and Microsoft Excel 7.0 on the same computer.
<P>
This article describes the problems you may encounter when you install more
than one version and offers advice about preventing the versions of
Microsoft Excel from conflicting with each other.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Order of Installation</h3>
 
<P>
To install and use more than one version of Microsoft Excel on a single
computer, install earlier versions of Microsoft Excel first.
<P>
For example, if you want to use both Microsoft Excel 5.0 and Microsoft
Excel 97 on the same computer, you must install Microsoft Excel 5.0 FIRST.
This is necessary because of the way registry keys, shared programs, and
other settings are managed for each version of Microsoft Excel.
<P>
NOTE: The following sections assume that you installed the versions of
Microsoft Excel in ascending order.
<P>
<P><h3>Running Multiple Versions of Microsoft Excel Simultaneously</h3>
 
<P>
Although it is possible to run more than one version of Microsoft Excel
simultaneously on the same computer, Microsoft strongly recommends that you
avoid doing this. For example, if you want to start Microsoft Excel 5.0,
first quit all other versions of Microsoft Excel that may be running.
<P>
<P><h3>Double-Clicking Files in the Windows Explorer</h3>
 
<P>
When you double-click a Microsoft Excel workbook (.xls) file, chart (.xlc)
file, or add-in (.xla) file in Windows Explorer, the following rules apply:

<UL><LI>If a version of Microsoft Excel is already running, the file is opened
   in the running version of Microsoft Excel.

<LI>If no version of Microsoft Excel is running, the file is opened in
   Microsoft Excel 5.0 if it is installed on your computer; if Microsoft
   Excel 5.0 is not installed, the file is opened in the version of
   Microsoft Excel that you most recently installed on your computer.
<P>
   See the "Reassociating Microsoft Excel Files" section for more
   information about this behavior.
<P>
</UL>NOTE: If you double-click a file that is not supported by the version of
Microsoft Excel that is running or that is automatically started, you
receive the following error message:
<P>
<PRE>   &lt;Filename&gt;: file format is not valid.

</PRE>If you receive this error message, start the later version of Microsoft
Excel. Then, open the file by double-clicking it or by using the Open
dialog box (click Open on the File menu).
<P>
<P><h3>Reassociating Microsoft Excel Files</h3>
 
<P>
When you start Microsoft Excel 5.0, Microsoft Excel files (.xls, .xlc, and
.xla files) are automatically associated with it.
<P>
When you start them, Microsoft Excel 7.0 and Microsoft Excel 97 are not
automatically associated Microsoft Excel files; they perform this task only
when you install these programs.
<P>
Because of this difference in behavior, if you start Microsoft Excel 5.0, a
Microsoft Excel file that you double-click is always opened in Microsoft
Excel 5.0, unless another version of Microsoft Excel is already running.
<P>
If you want to double-click a file and open it in a newer version of
Microsoft Excel, you can associate Microsoft Excel files with Microsoft
Excel 7.0 or 97 by using either of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Run Microsoft Excel Setup or Microsoft Office Setup with the /y switch.
Using /y instructs the Setup program to register all of the registry keys
that are used by Microsoft Excel and to associate Microsoft Excel files
with the version of Microsoft Excel that you are installing.
<P>
<P><h3>Method 2</h3>
 
<P>
Use the File Types tab in the Options dialog box to associate Microsoft
Excel files with Microsoft Excel 7.0 or 97. To do this, use the following
steps:

<OL><P><LI>Double-click My Computer.

<P><LI>On the View menu, click Options. Then, click the File Types tab.

<P><LI>In the list of registered file types, scroll down and click Microsoft
   Excel Worksheet. Then, click Edit.

<P><LI>In the list of Actions, click Open. Then, click Edit.

<P><LI>In the "Application used to perform action" box, change the path to the
   Microsoft Excel program file (Excel.exe) so that it refers to the
   Excel.exe file for Microsoft Excel 7.0 or Microsoft Excel 97.
<P>
   If you are unsure of the location for Excel.exe, click Browse to search
   for the file.

<P><LI>Click OK. Then, click Close, and then click Close again to close the
   Options dialog box.
<P>
</OL>NOTE: If you use one of these methods and you start Microsoft Excel 5.0,
Microsoft Excel files are automatically reassociated with Microsoft Excel
5.0. There is no way to prevent this behavior from occurring. If you want
to ensure that a Microsoft Excel file is opened in a specific version of
Microsoft Excel, start that version of Microsoft Excel BEFORE you open the
file, or use the Open dialog box to open files.
<P>
<P><h3>Inserting Microsoft Excel Objects into Other Programs</h3>
 
<P>
If you install multiple versions of Microsoft Excel on a single computer
and you insert a Microsoft Excel Worksheet object into another program (for
example, Microsoft Word), the latest version of Microsoft Excel is used
when you insert the worksheet object.
<P>
For example, if you install the following programs on your computer
<P>
<PRE>   Microsoft Word for Windows, version 6.0
   Microsoft Excel for Windows, version 5.0
   Microsoft Excel 97

</PRE></OL>and then insert a Microsoft Excel Worksheet object into Microsoft Word, a
Microsoft Excel 97 worksheet is added.
<P>
<P><h3>Using Automation to Control Microsoft Excel</h3>
 
<P>
If you install multiple versions of Microsoft Excel on a computer, you may
experience difficulty when you attempt to use Automation to control a
specific version of Microsoft Excel.
<P>
For example, if you run the following Visual Basic for Applications
subroutine in Microsoft Word 97
<P>
<PRE>   Sub AutomationTest()
       Dim xlApp As Object
       Set xlApp = CreateObject("Excel.Application")
       MsgBox xlApp.Version
       xlApp.Quit
       Set xlApp = Nothing
   End Sub

</PRE>the subroutine always creates an Automation session in the version of
Microsoft Excel that you most recently installed. So, if you install both
Microsoft Excel 5.0 and Microsoft Excel 97 on the same computer, the
message box in the example displays 8.0, the version number of Microsoft
Excel 97.
<P>
If you want to control a specific version of Microsoft Excel using
Automation, you use the class names that are listed in the following table.
<P>
<PRE>   Version of
   Microsoft Excel   Class Name
   -------------------------------------

   97                Excel.Application.8
   7.0               Excel.Application.5
   5.0               Excel.Application.5

</PRE>NOTE: Microsoft Excel 5.0 and 7.0 both use the same class name,
Excel.Application.5. Therefore, if Microsoft Excel 5.0 and 7.0 are both
installed on the same computer, Excel.Application.5 always applies to
Microsoft Excel 7.0. There is no way to prevent this behavior. Because
Microsoft Excel 5.0 and 7.0 both use the same file format and offer similar
features, you should be able to use Microsoft Excel 7.0 instead of
Microsoft Excel 5.0.
<P>
<P><h3>Shared Programs</h3>
 
<P>
You should not experience any problems when you use shared programs, such
as Microsoft Equation Editor and Clip Gallery, with any version of
Microsoft Excel. Note that the Object dialog box may display more than one
entry for each shared program; this behavior occurs because there may be
multiple versions of the shared program on the computer.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 XL7 XL5 ole automation<BR>
Keywords          : kbhowto xlui xlvbainfo kbprg<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
