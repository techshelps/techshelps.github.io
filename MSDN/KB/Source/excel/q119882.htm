

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Calling a Microsoft Excel Macro from a Lotus 1-2-3 Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119882">
<META NAME="KBModify" CONTENT="1996/12/17">
<META NAME="KBCreate" CONTENT="1994/08/28">
<META NAME="Keywords" CONTENT="kbprg kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  A macro written for Lotus 1-2-3 may be modified to run a Microsoft Excel macro in order to perform specific functions. In order to use the existing Lotus 1-2-3 macro and incorporate the Microsoft Excel macro, modify the Lotus 1-2-3 macro to include...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAJC,QABM,QAGI,QAUD,QAY2 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Calling a Microsoft Excel Macro from a Lotus 1-2-3 Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119882</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A macro written for Lotus 1-2-3 may be modified to run a Microsoft Excel
macro in order to perform specific functions. In order to use the existing
Lotus 1-2-3 macro and incorporate the Microsoft Excel macro, modify the
Lotus 1-2-3 macro to include the Lotus 1-2-3 macro command XLCALL or
XLBRANCH.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Two Lotus 1-2-3 macro commands, XLCALL and XLBRANCH allow the you to run a
Microsoft Excel macro from a Lotus 1-2-3 macro. The format of the commands
are {XLCALL xl_macro_name} or {XLBRANCH xl_macro_name}. The XLCALL command
will call the macro (xl_macro_name), then return control to the Lotus 1-2-3
macro that called it. The XLBRANCH command will call the macro
(xl_macro_name) but will not return control to the originating macro.
<P>
NOTE: In Microsoft Excel 97, the syntax to run a Microsoft Excel macro
is {XLCALL ThisWorkbook.macroname}.
<P>
The {XLCALL} and {XLBRANCH} commands are not available to versions of
Microsoft Excel earlier than version 4.0 because these products did not use
the Microsoft Excel macro interpreter.
<P>
For example, if you created a macro named PagePrint to set your headers and
footers on a macro sheet named PRINT.XLM and you want to call the macro
from within one of your 1-2-3 macros, you can do this by inserting the
command {XLCALL PRINT.XLM!PagePrint} within your 1-2-3 macro. Using a
Visual Basic, Applications Edition, macro, the 1-2-3 macro would be written
{XLCALL module1.PagePrint}. As with any subroutine, after the Microsoft
Excel macro runs, control of the macro returns to the 1-2-3 macro. With
XLBRANCH, you branch to Microsoft Excel and do not return to the 1-2-3
macro.
<P>
NOTE: A Lotus 1-2-3 macro cannot be run from a Microsoft Excel macro.
<P>
Lotus and 1-2-3 are registered trademarks of Lotus Development Corporation.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Users Guide", version 5.0, page 38
"Switching to Microsoft Excel from Lotus 1-2-3," version 5.0, page 34
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kb3rdparty<BR>
KBSubcategory: xl123Quattro xlvbainfo<BR>
Additional reference words: XL97 97 7.00 4.00 4.00a 5.00 xl5
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
