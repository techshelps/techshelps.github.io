

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Using INDEX and MATCH Against Multiple Criteria </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q59482 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1990/03/09">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article includes sample data and formulas that retrieve values  based on multiple criteria. These examples use multiple criteria to  retrieve a part price.  MORE INFORMATION  The following examples use the INDEX and MATCH worksheet functions t...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QATJ,QA28,QAB9,QAH4,QAHH,QAUD,QBE7,QBE6,QAEN,QAPF,QBCF,QAYY,QALW,QBXN P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using INDEX and MATCH Against Multiple Criteria</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q59482 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.x, 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article includes sample data and formulas that retrieve values 
based on multiple criteria. These examples use multiple criteria to 
retrieve a part price.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples use the INDEX and MATCH worksheet functions to 
find a value based on multiple conditions.
<P>
<P><h3>Data Arranged in Columns</h3>
 
<P>
Assume you are using the following data:
<P>
<PRE>   A1: Part   B1:  Code   C1:  Price   D1:  Find Part  E1:  Find Code
   A2: x      B2:  11     C2:  5.00    D2:  y          E2:  12
   A3: x      B3:  12     C3:  6.00    D3:  y          E3:  11
   A4: y      B4:  11     C4:  7.00    D4:  x          E4:  12
   A5: y      B5:  12     C5:  8.00    D5:  x          E5:  11

</PRE>Suppose that you want to retrieve the price for part y with code 12. 
(The input cells are D2 and E2.) To retrieve the price for this part, 
type the following formula in cell F2:
<P>
<PRE>   =INDEX($C$2:$C$5,MATCH(D2,IF($B$2:$B$5=E2,$A$2:$A$5),0))

</PRE>The formula returns the value 8.00.
<P>
You must enter this formula as an array formula by pressing
CTRL+SHIFT+ENTER (in Microsoft Excel for Windows and OS/2) or
COMMAND+RETURN (in Microsoft Excel for the Macintosh).
<P>
You can then fill the formula by using the fill handle for cell F2 to 
retrieve the price for each part and code combination.
<P>
A second method yields the same results but uses concatenation 
instead. The following sample formula may be better for matching data 
against multiple criteria (more than two) because it does not require 
nested IF statements:
<P>
<PRE>   =INDEX($C$2:$C$5,MATCH(D2&amp;E2,$A$2:$A$5&amp;$B$2:$B$5,0))

</PRE>You must also enter this formula as an array formula. For more 
information about the concatenation operator, see the "Text, operators 
in formulas" topic in the index of "User's Guide 1."
<P>
<P><h3>Data Arranged in Rows</h3>
 
<P>
Assume you are using the following data:
<P>
<PRE>   A1: Part        B1: x      C1: x     D1: y       E1: y
   A2: Code        B2: 11     C2: 12    D2: 11      E2: 12
   A3: Price       B3: 5.00   C3: 6.00  D3: 7.00    E3: 8.00
   A4: Find Part   B4: y      C4: y     D4: x       E4: x
   A5: Find Code   B5: 12     C5: 11    D5: 12      E5: 11

</PRE>Suppose that you want to retrieve the price for part y with a code of 
12, for example, with input cells B4 and B5. Type the following 
formula in cell B6 to retrieve the price for this part:
<P>
<PRE>   =INDEX($B$3:$E$3,MATCH(B4,IF($B$2:$E$2=B5,$B$1:$E$1),0))

</PRE>The formula returns the value 8.00.
<P>
You must enter this formula as an array formula by pressing 
CTRL+SHIFT+ENTER (in Microsoft Excel for Windows and OS/2) or 
COMMAND+RETURN (in Microsoft Excel for the Macintosh).
<P>
You can then fill the formula to the right by using the fill handle for 
cell B6 to retrieve the price for each part and code combination.
<P>
A second method yields the same results but uses concatenation 
instead. The following sample formula may be better for matching data 
against multiple criteria (more than two) because it does not require 
nested IF statements:
<P>
<PRE>   =INDEX($B$3:$E$3,MATCH(B4&amp;B5,$B$1:$E$1&amp;$B$2:$E$2,0))

</PRE>You must also enter this formula as an array formula. For more 
information about the concatenation operator, see "Text, operators in 
formulas" in the index of "User's Guide 1."
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A HREF="../EXCEL/Q77114.htm">Q77114</A></B>
   TITLE     : Performing a Lookup with Unsorted Data in Excel

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using lookup functions, click the Index tab 
in Microsoft Excel 97 Help, type the following text
<P>
<PRE>   lookup functions

</PRE>and then double-click the selected text to go to the "About lookup and
reference functions" topic.
<P>
"User's Guide 1," version 4.0, pages 132, 138
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 XL97 XL7 XL5 XL4 XL3 index-match<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:2.0,3.0,4.0,5.0,5.0c,7.0,97; MACINTOSH:2.0,3.0,4.0,5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
