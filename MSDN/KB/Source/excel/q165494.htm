

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Problems Setting Column Headings in ListBox Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165494">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/03/20">
<META NAME="Keywords" CONTENT="xlcode xlvbainfo kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you set the RowSource property of a ListBox control to a range of cells on a worksheet, the column headings in the list box may not be the values in the first row of your data. For example, the column headings in the ListBox control may be  Colu...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAMB,QAHP,QAMN,QA7O,QAOE,QAB5,QAC2,QBS0,QBXS,QAPN,QAE1,QBWS,QBJZ,QDMN P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Problems Setting Column Headings in ListBox Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165494</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you set the RowSource property of a ListBox control to a range of cells
on a worksheet, the column headings in the list box may not be the values
in the first row of your data. For example, the column headings in the
ListBox control may be "Column A" and "Column B" (without the quotation
marks).
<P>
<P><h2>CAUSE</h2>
 
<P>
You may experience this behavior if all of the following are true:

<UL><LI>The range of cells you are using has labels in the first row.
<P>
<P><PRE>    -and-
</PRE>
<LI>You set the RowSource property of the ListBox control to the entire
   range of your data, including the row with the labels.
<P>
<P><PRE>    -and-
</PRE>
<LI>You set the ColumnHeads property of the ListBox control to True.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To have the labels appear as column labels in a ListBox control, set the
RowSource property of the ListBox to the range of cells that is beneath the
labels. Please see the "More Information" section for a sample UserForm
that demonstrates this behavior.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps demonstrate how to set the properties of a ListBox
control so that the first row of data is used for the column labels in the
ListBox.

<OL><P><LI>Close and save any open workbooks, and then open a new workbook.

<P><LI>Enter the following in Sheet1:
<P>
<PRE>   A1: Name   B1: Amount
   A2: Bob    B2: 1
   A3: Sue    B3: 2
   A4: Tom    B4: 3
   A5: Pat    B5: 4

</PRE><P><LI>Start the Visual Basic Editor (press ALT+F11).

<P><LI>In the Visual Basic Editor, click UserForm on the Insert menu.

<P><LI>If the Toolbox is not visible, click Toolbox on the View menu. Click
   the ListBox control in the Toolbox, and then draw a ListBox on the
   UserForm.

<P><LI>Using the Properties window, set the following properties for the
   ListBox control:
<P>
<PRE>   Property       Value
   --------------------------

   ColumnHeads    True
   ColumnCount    2
   RowSource      Sheet1!A2:B5

</PRE><P><LI>Run the UserForm. To do this, activate the UserForm, and click Run
   Sub/UserForm on the Run menu.
<P>
</OL>The labels in A1 and B1 will be the column labels in the ListBox, and the
first row of selectable data will be from A2 and B2.
<P>
NOTE: If you set the RowSource property to "Sheet1!A1:B5" (without the
quotation marks), and then run the UserForm, the data in A1 and B1 will be
a selectable row in the ListBox and the column headings will be "Column A"
and "Column B", respectively.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the ListBox control, click the Index tab in
Microsoft Visual Basic for Applications Help, type the following text
<P>
<PRE>   listbox control

</PRE></OL>and then double-click the selected text to go to the "Things you can do
with a multicolumn ListBox or ComboBox" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 list box row source<BR>
Keywords          : xlcode xlvbainfo kbprg kbbuglist<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
