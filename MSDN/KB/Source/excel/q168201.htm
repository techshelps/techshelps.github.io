

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Error Messages Appear Clicking Options on Tools Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168201">
<META NAME="KBModify" CONTENT="1998/03/06">
<META NAME="KBCreate" CONTENT="1997/05/07">
<META NAME="Keywords" CONTENT="kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you click Options on the Tools menu in Microsoft Excel 97, you may receive the following error message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contact the program vendor.  If you ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAB4,QABA,QAFI,QBWS,QAH4,QBBI,QABI,QANX,QAKP,QBV8,QDO5,QAR6,QAO4 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error Messages Appear Clicking Options on Tools Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168201</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you click Options on the Tools menu in Microsoft Excel 97, you may
receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to either of the
following:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at
   014f:300ce93a.

   EXCEL caused an invalid page fault in module &lt;unknown&gt; at
   0000:00780078.

</PRE>Also, when you click OK in the Options dialog box, you may receive an error
message similar to any of the following:
<P>
<PRE>   EXCEL caused a stack fault in module EXCEL.EXE at 014f:300cc4c7.

   EXCEL caused an invalid page fault in module &lt;unknown&gt; at
   0000:00000078.

   EXCEL caused an invalid page fault in module EXCEL.EXE at
   014f:300cc4c7.

   EXCEL caused an exception 01H in module EXCEL.EXE at 014f:300c0001.

</PRE><h2>CAUSE</h2>
 
<P>
These problems occur if you click Options on the Tools menu, click the
General tab, and then specify a path that exceeds 53 characters in the
Default File Location box.
<P>
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, make sure that the path does not exceed 53
characters when you type a path in the Default File Location box.
<P>
If you already specified a path that exceeds 53 characters in the Default
File Location box, do the following:

<OL><P><LI>If Microsoft Excel 97 is running, quit the program.

<P><LI>Using Windows Explorer, locate the folder that you specified in the
   Default File Location box. Click the folder to select it.

<P><LI>Right-click the folder and click Rename on the shortcut menu. Change the
   folder name, and then press ENTER.

<P><LI>Start Microsoft Excel 97. On the Tools menu, click Options.
<P>
   NOTE: If the problem still occurs, you may have renamed the wrong
   folder. Repeat steps 1-4 and use a different folder.

<P><LI>Click the General tab.
<P>
</OL>The path in the Default File Location box should be "C:\My Documents"
(without the quotation marks). You can specify any folder in the Default
File Location box, however, make sure that the length of the path does not
exceed 53 characters.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, you can set the default file location for Microsoft
Excel files by doing the following:

<OL><P><LI>On the Tools menu, click Options. Click the General tab.

<P><LI>In the Default File Location box, type the path that you want
   Microsoft Excel 97 to use, for example:
<P>
<P><PRE>      C:\My Documents\Workbooks
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      \\Server\Share\CJUser\MyWorkbooks
</PRE>
<P><LI>When you are done, click OK.
<P>
</OL>When you display the Open or Save As dialog box, Microsoft Excel 97 uses
the path you specified by default in the Default File Location box.
<P>
Note that the problems described in this article do not occur when you open
or save a workbook; they occur only when you use the Options dialog box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kberrmsg kbusage<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kberrmsg<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
