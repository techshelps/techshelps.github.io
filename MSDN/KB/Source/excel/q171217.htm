

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: "System Error &amp;H80070057" Message Opening Add-In </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171217">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/07/09">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you open an add-in that was created in an earlier version of Microsoft Excel, you may receive the following error message:     Microsoft Visual Basic    System Error *H80070057 (-2147024809). The parameter is incorrect.  I...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAH0,QBS0,QAUJ,QAB4,QAKP,QAEF,QDO3,QAY2,QAO4,QAAP,QBVV,QA9N,QARM P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: "System Error &amp;H80070057" Message Opening Add-In</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171217</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you open an add-in that was created in an earlier
version of Microsoft Excel, you may receive the following error message:
<P>
<PRE>   Microsoft Visual Basic
   System Error &amp;H80070057 (-2147024809). The parameter is incorrect.

</PRE>If you click OK, and then switch to the Visual Basic Editor, you may be
able to view the project of the add-in, including all of the Visual Basic
modules it contains. As a result, code within the add-in is not secure;
that is, it can be viewed by other users.
<P>
<P><h2>CAUSE</h2>
 
<P>
These problems may occur if the following conditions are true:

<UL><LI>You name one or more of the modules in the source workbook with a name
   that includes extended characters, for example an "e" with an acute or
   grave accent, before you create the add-in.
<P>
<P><PRE>    -and-
</PRE>
<LI>You remove the extended characters from the names of the modules.
<P>
<P><PRE>    -and-
</PRE>
<LI>You create the add-in after you remove the extended characters from the
   names of the modules.
<P>
</UL>For example, if a module in the source workbook is named "Cartier", with an
acute accent over the "e," and then is renamed to "Cartier" without an
accent, the problem occurs if you then create the add-in and open it in
Microsoft Excel 97.
<P>
NOTE: The problem does not occur if the names of the modules contain the
extended characters when you create the add-in. For the problem to occur,
the extended characters must be removed from the names of the modules.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, do not use extended characters in module names in
Microsoft Excel. You can also resolve the second problem by installing
Microsoft Excel 97 Service Release 1 (SR-1).
<P>
If the problem is already occurring, you may be able to prevent it by
recreating the add-in. To do this, you must have access to the source
workbook from which the add-in was created. After you open the source
workbook, copy the code from any modules with names with extended
characters, paste the code into new modules, and delete the original
modules. Note that if you rename one of the new modules to use the same
name as the deleted modules, the problem may still occur.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article.
<P>
The first problem described in the "Symptoms" section occurs in both
Microsoft Excel 97 and Microsoft Excel 97 Service Release 1 (SR-1).
<P>
The second problem was corrected in Microsoft Excel 97 SR-1.
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When you create an add-in in earlier versions of Microsoft Excel, the
project in the add-in is automatically locked and protected from view. This
prevents others from viewing the code in the add-in.
<P>
However, if the names of any of the modules in the add-in contained
extended characters before the add-in was created, you may receive the
error message described in this article, and the project in the add-in may
be visible in the Visual Basic Editor.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sr1 XL97 grave acute aigu cedilla umlaut circumflex<BR>
Keywords          : kberrmsg kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
