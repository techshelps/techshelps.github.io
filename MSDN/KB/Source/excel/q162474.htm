

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: DFunctions Return Errors When Database Has Too Many Rows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162474">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/01/22">
<META NAME="Keywords" CONTENT="xlformula kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, when you type a formula that contains any of the worksheet database functions (also known as DFunctions), the formula returns either an error value or an incorrect value, instead of the correct value.  CAUSE =====  This probl...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJQ,QAZV,QAAP,QA5V,QAUD,QAPF,QAKD,QAB4,QAI4,QAKP,QAB9,QAY5,QDMR,QDL9 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: DFunctions Return Errors When Database Has Too Many Rows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162474</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, when you type a formula that contains any of the
worksheet database functions (also known as DFunctions), the formula
returns either an error value or an incorrect value, instead of the correct
value.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if the Database argument of a DFunction refers to a
range that contains more than 32,768 rows. For example, if the defined
names "Database" and "DataRange" refer to ranges that contain more than
32,768 rows, the following sample formulas do not work correctly:
<P>
<PRE>   =DSUM(A1:B33000,"Field",Criteria)

   =DCOUNTA(A1:G65536,"Field2",Criteria2)

   =DAVERAGE(Database,"Field",Criteria)

   =DCOUNT(DataRange,"Salary",Criteria2)

</PRE>NOTE: Because you cannot use more than 16,384 rows in a worksheet in
earlier versions of Microsoft Excel, this problem does not occur in these
versions.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97 for
Windows. This problem was corrected in Microsoft Excel 97 for Windows,
Service Release 1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following table lists the errors that are returned.
<P>
<PRE>   DFunction     Error Value
   -------------------------
   DAVERAGE          #DIV/0!
   DCOUNT                  0
   DCOUNTA                 0
   DGET              #VALUE!
   DMAX                    0
   DMIN                    0
   DPRODUCT                0
   DSTDEV            #DIV/0!
   DSTDEVP           #DIV/0!
   DSUM                    0
   DVAR              #DIV/0!
   DVARP             #DIV/0!

</PRE>In Microsoft Excel, you can use DFunctions to perform criteria- dependent
calculations using data stored in a range in a worksheet. For example, you
can use the DSUM function to sum values that match specific criteria in a
column of records in a database.
<P>
All DFunctions use the following common syntax:
<P>
<PRE>   =DFunction(Database,Field,Criteria)

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about DFunctions in Microsoft Excel 97, click the
Index tab in Microsoft Excel Help, type the following text:
<P>
<PRE>   database functions

</PRE>Double-click the selected text to view the "About database functions"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97 32768 32769 32,768 32,769<BR>
Keywords          : xlformula kbualink97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
