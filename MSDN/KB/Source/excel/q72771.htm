

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Q+E Err Msg: Incompatible Datatypes in Expression </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q72771 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/06/07">
<META NAME="Keywords" CONTENT="index define dBASE kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QA7O,QA7N,QDI1,QBJZ,QAB4,QBXS,QABM,QAJQ,QAB9,QBVP,QAY2,QAY4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Q+E Err Msg: Incompatible Datatypes in Expression</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q72771 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



Summary :
<P>
When using the dBASE driver in Q+E for Microsoft Excel version 3.0,
you will receive the error message "Incompatible Datatypes in
Expression" when attempting to create an index on multiple fields that
are not of the same defined type.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When creating an index with multiple fields, the fields must be of the
same defined type, or must be converted into a compatible type using a
supported dBASE function. This is identical to the way dBASE creates
index files.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Activate Q+E.

<P><LI>From the File menu, choose Define.

<P><LI>Choose dBaseFile as the source and EMP.DBF from the File List.
   EMP.DBF is an example file that is automatically installed into
   the QE subdirectory of the directory where you installed Excel.

<P><LI>Choose OK.

<P><LI>Select the HIRE_DATE and the LAST_NAME fields from the Define
   window.

<P><LI>From the File menu, choose Define Index.

<P><LI>Type TEST.NDX as the filename. HIRE_DATE + LAST_NAME will be listed
   in the Expression Box.

<P><LI>Choose OK.
<P>
</OL>The error message "Incompatible Datatypes in Expression"  will appear.
<P>
To properly create the index, edit the Expression Box and use the
dBASE function DTOS around the HIRE_DATE field.
<P>
For example, the following will convert the DATE field into a
character string and the index will be created:
<P>
<PRE>   DTOS(HIRE_DATE)+LAST_NAME

</PRE></OL>Numeric and logical fields should also be converted when being used
with character fields.
<P>
Reference(s)
<P>
"Q+E for Microsoft Excel's User's Guide." Version 3.0, pages 120-121,
131-132.
<P>
"dBASE III Plus," Douglas Hergert, page 215.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
