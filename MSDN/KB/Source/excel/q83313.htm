

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Blank Seed Argument in RANDOM() Results in Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83313 ">
<META NAME="KBModify" CONTENT="1994/11/22">
<META NAME="KBCreate" CONTENT="1992/04/09">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel version 4.0 includes an add-in function, RANDOM(), that generates a set of random numbers. When you use this function in a macro, if you leave the seed argument blank, the macro stops execution and Microsoft Excel displays the error...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKC,QAND,QBC6,QAH4,QAY5,QAKJ,QBXS,QAPN,QAG8,QBV8,QAB9,QAHE,QAB4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Blank Seed Argument in RANDOM() Results in Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 22, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83313 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0 and 4.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel version 4.0 includes an add-in function, RANDOM(),
that generates a set of random numbers. When you use this function in a
macro, if you leave the seed argument blank, the macro stops execution
and Microsoft Excel displays the error message, "An error has occurred
locating a support file or processing data for an  add-in procedure."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The RANDOM() macro function is parallel to choosing Analysis Tools
from the Options menu and selecting Random Number Generation from the
Analysis Tools list. Using the Options menu method, it is not
necessary to place a seed value in the Random Seed box. Microsoft
Excel still generates random numbers.
<P>
Although the "Microsoft Excel Function Reference" lists the seed
argument as optional when using the RANDOM() macro function, omitting
it generates the error mentioned above. To avoid the error, use any
integer value between 0 (zero) and 32767 in the seed argument.
<P>
Note, however, that if you use a constant number other than 0,
RANDOM() will generate the same set of numbers each time your macro
runs. To generate different numbers, use 0 or INT(RAND()*&lt;range&gt;) as
the seed argument, where &lt;range&gt; represents the upper limit of the
numbers you want to use for seed values. For example, to generate seed
values between 0 and 9, use 10 as your range value, for seed values
between 0 and 99 use 100, and so on.
<P>
<P><h3>Example</h3>
 
<P>
The following sample macro demonstrates the use of the function
RANDOM().

<OL><P><LI>Enter the following into a macro sheet:
<P>
   A1: Test
   A2: =RANDOM(OFFSET(ACTIVE.CELL(),0,0,5,2),2,5,1,5,10,20)
   A3: =RANDOM(OFFSET(ACTIVE.CELL(),6,0,5,2),2,5,1,
<PRE>        INT(RAND()*10),10,20)
   A4: =RETURN()

</PRE></OL>NOTE: The formula in cell A3 should be entered as one single line, such
that the INT() function follows the "1," argument of the OFFSET() function.

<OL><P><LI>Select cell A1 and choose Define Name from the Formula menu. The
   word "Test" will show in the Name box and the Refers To box will
   show $A$1. Select the Command option in the Macro section and
   choose OK.

<P><LI>From the File menu, choose New. Select Worksheet and choose OK.

<P><LI>With cell A1 selected, choose Run from the Macro menu. Select the
   Test macro and choose OK. The macro will generate two groups of
   random numbers.

<P><LI>Select cell D1 on the worksheet and repeat Step 4.
<P>
</OL>Note that the numbers in the top group in both cases are the same
while the numbers in the bottom group are different. This is a result
of using 0 or the RAND() function as the seed argument as opposed to
using a constant number.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, pages 345-346
<P>
"Microsoft Excel User's Guide 2," version 4.0, pages 38-40
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory:
<P>

Additional reference words: 4.0 4.00 4.0a 4.00a Analysis Tool Pack<BR>
ToolPak Pak<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 22, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
