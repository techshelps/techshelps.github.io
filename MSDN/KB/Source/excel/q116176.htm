

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL Err Msg: File Error, Cannot Find XLODBC.DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116176">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1994/06/13">
<META NAME="Keywords" CONTENT="xlquery kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you are using a workstation installation of Microsoft Excel, and you choose the Add-ins command to add the ODBC add-in, you may receive any of the following error messages.     Windows 3.x or Windows 95    -------------------------     File Erro...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QAFI,QBHQ,QDKW,QAY2,QDL9,QBWQ,QBWO,QBWN,QA9N,QBWS,QASB P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL Err Msg: File Error, Cannot Find XLODBC.DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116176</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, version 5.0, 5.0a
<LI>Microsoft Query, version 1.0
<LI>Microsoft Query for Windows 95, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you are using a workstation installation of Microsoft Excel, and you
choose the Add-ins command to add the ODBC add-in, you may receive any of
the following error messages.
<P>
<PRE>   Windows 3.x or Windows 95
   -------------------------

   File Error
   Cannot find XLODBC.DLL.

   -or-

   Attempt to register XLODBC.XLA failed.

   -or-

   Unable to copy add-in to library.

   Macintosh
   ---------

   Attempt to register XLODBC code resource failed.


</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs because the add-in manager places the XLODBC.XLA file
in a folder (directory) that is different from the folder where the
XLODBC.DLL is located. XLODBC.XLA is located in two places on your hard
disk, and the add-in manager is attempting to access the file from the
wrong location.
<P>
The XLODBC.XLA must be located in the same folder as the XLODBC.DLL file
for the add-in to work with ODBC functionality. The Add-in Manager is using
the copied XLODBC.XLA file located in the EXCEL\LIBRARY folder (the Macro
Library:MS Query folder on the Macintosh) and cannot find XLODBC.DLL (which
is located in the MSQUERY folder).
<P>
The Add-in Manager in Microsoft Excel does not recognize the MSQUERY
folder as an add-in folder. Therefore, when you select the ODBC
Add-in, the Microsoft Excel Add-in Manager attempts to copy the XLODBC.XLA
file to the wrong folder.
<P>
NOTE: The file XLODBC.DLL is replaced with the file XLODBC32.DLL in 
Micorsoft Excel 97.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use the following appropriate procedure.
<P>
NOTE: Once you complete the appropriate workaround, you may want to change
the rights for the server that the workstation is accessing such that the
server is read-only. If the server is made read-only, the Add-in manager
will be unable to copy the XLODBC.XLA file to the incorrect location.
<P>
<P><h3>Microsoft Excel for Windows</h3>
 
<P>
To work around this problem in Microsoft Excel for Windows, follow these 
steps:

<OL><P><LI>Delete the XLODBC.XLA file from the EXCEL\LIBRARY folder.
<P>
   NOTE: It is not necessary to delete any files in Microsoft Excel 97.

<P><LI>Click Add-ins from the Tools menu.

<P><LI>Click Browse, in the Add-ins dialog box, click the XLODBC.XLA file
   from EXCEL\LIBRARY\MSQUERY, and click OK.
<P>
   -or-
<P>
   In Microsoft Excel 97, click Browse and click XLODBC.XLA from 
   &lt;Office folder&gt;\OFFICE\LIBRARY\MSQUERY, and click OK.

<P><LI>Click NO when you receive the following message:
<P>
<P><PRE>      Copy XLODBC.XLA to Microsoft Excel Add-in Library?
</PRE><P>
   You do not want to copy the file. The proper location of XLODBC.XLA and
   XLODBC.DLL on the shared network location will be retained.

<P><LI>Confirm the proper reference of the XLODBC.XLA Add-in in your
   EXCEL5.INI for Microsoft Excel 5.0, located in the Windows folder on
   your local workstation. If the Add-in reference still points to 
   EXCEL\LIBRARY, change this line to EXCEL\LIBRARY\MSQUERY, and save the 
   EXCEL5.INI file.
<P>
   NOTE: Make this change after you quit Microsoft Excel.
<P>
</OL><h3>Microsoft Excel for the Macintosh</h3>
 
<P>
To work around this problem in Microsoft Excel for the Macintosh, follow 
these steps:

<OL><P><LI>Delete the XLODBC.XLA file from the Microsoft Excel 5:Macro Library
   folder.

<P><LI>From the Tools menu, choose Add-ins.

<P><LI>In the Add-ins dialog box, choose Browse, select the XLODBC.XLA file
   from the Microsoft Excel 5:Macro Library:MS Query folder, and
   choose OK.

<P><LI>Choose No when you receive the following message:
<P>
<P><PRE>      Copy XLODBC.XLA to Microsoft Excel Add-in Library?
</PRE><P>
   You do not want to copy the file. The proper location of XLODBC.XLA
   (Microsoft Excel 5:Macro Library:MSQuery) will be retained.
<P>
</OL>If you continue to have trouble using the ODBC add-in commands, quit
Microsoft Excel and drag the Excel Settings (5) file from the Preferences
folder to the Trash. Restart Microsoft Excel, and then repeat steps 1-4.
Note that if you do this, all your custom settings will be reset to the
default settings.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00 addin connection path not found<BR>
5.00a<BR>
Keywords          : xlquery kberrmsg kbtool<BR>
Version           : MACINTOSH:5.00,5.00a; WINDOWS:5.00,5.00c,7.00 97<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
