

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Using Server Page Fields in PivotTables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157488">
<META NAME="KBModify" CONTENT="1998/01/27">
<META NAME="KBCreate" CONTENT="1996/10/11">
<META NAME="Keywords" CONTENT="xlpivot kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, you can use server page fields to reduce the amount of data returned from an external data source into a PivotTable. This is useful when creating PivotTables from very large databases.  MORE INFORMATION  When you create a Piv...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA7N,QA7O,QBVU,QBWS,QA5V,QAYY,QBWA,QAWM,QA01,QAK6,QASR,QAUD,QALW,QAKJ P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Using Server Page Fields in PivotTables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157488</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel 97, you can use server page fields to reduce the amount
of data returned from an external data source into a PivotTable. This is
useful when creating PivotTables from very large databases.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you create a PivotTable using an external data source, Microsoft Excel
has to process all data records returned to it from the external data
source. If your database contains millions of records, this could take a
very long time to complete.
<P>
However, you can use server page fields to "filter" data before it is
returned to the PivotTable in Microsoft Excel -- reducing the amount of
time required to create the PivotTable. For example, you can use a server
page field to return only records where the Country field is equal to
"USA."
<P>
Using server page fields also helps reduce the amount of memory required to
cache information used by the PivotTable.
<P>
To use server page fields in a PivotTable, follow these steps:

<OL><P><LI>On the Data menu, click PivotTable Report.

<P><LI>In the Step 1 of 4 dialog box, click "External data source," and then
   click Next.

<P><LI>In the Step 2 of 4 dialog box, click Get Data. Use Microsoft Query
   to attach to your external database, select tables, and so on. Once the
   data fields have been retrieved, click Next.

<P><LI>In the Step 3 of 4 dialog box, drag field names into the Column,
   Row, Data, and Page areas of the diagram. You MUST add at least one
   field name into the Page area; this is the field for which server
   page fields will be created.

<P><LI>In the Page area of the diagram, double-click the field name for
   which you want to create server page fields.

<P><LI>In the PivotTable Field dialog box, click Advanced.

<P><LI>In the Page Field Options, click "Query external data source." Click OK
   twice.

<P><LI>In the Step 3 of 4 dialog box, click Next.

<P><LI>In the Step 4 of 4 dialog box, select a destination for the
   PivotTable, and then click Finish.
<P>
</OL>After your PivotTable has been created, you can click the drop-down list in
the Page field to retrieve data for the selected item. Each time you do
this, Microsoft Excel performs the following steps:

<OL><P><LI>Microsoft Excel queries the external data source again and retrieves
   the appropriate data for the selected Page field.

<P><LI>The PivotTable memory cache is cleared and filled with new records.

<P><LI>The PivotTable is refreshed and redisplayed using the newly retrieved
   records.
<P>
</OL>Because of the way in which server page fields work, the "(All)" item is
removed from the drop-down list. This is because only a subset of the data
in the external data source is being returned to Microsoft Excel. If you
want to show all records:

<OL><P><LI>Double-click the field name in the Page field.

<P><LI>In the PivotTable Field dialog box, click Advanced.

<P><LI>In the Page Field Options, click "Retrieve external data for all."
   Click OK twice.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about PivotTables in Microsoft Excel, click the Index
tab in Microsoft Excel Help, type the following text
<P>
<PRE>   PivotTables, overview

</PRE></OL>click Display, click "PivotTables: Analyzing data interactively", and then
click Display.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 XL97 pivot tables server-based server<BR>
based<BR>
Keywords          : xlpivot kbtool<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
