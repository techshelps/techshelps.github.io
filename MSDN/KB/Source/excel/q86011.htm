

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Worksheet Formula to Beep and Display an Alert Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86011 ">
<META NAME="KBModify" CONTENT="1996/07/12">
<META NAME="KBCreate" CONTENT="1992/06/28">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following formulas, when entered on a spreadsheet, will produce a beep and display an alert box if the specified condition occurs.     16-bit versions of Microsoft Excel (3.x, 4.x, 5.x for Windows)    -------------------------------------------...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAGI,QAMB,QDL9,QBWO,QBWN,QATX,QBWP,QAB4,QAIF,QBWQ,QAEV,QAB9,QBTM,QBS0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Worksheet Formula to Beep and Display an Alert Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86011 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows NT, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following formulas, when entered on a spreadsheet, will produce a
beep and display an alert box if the specified condition occurs.
<P>
<PRE>   16-bit versions of Microsoft Excel (3.x, 4.x, 5.x for Windows)
   --------------------------------------------------------------
   =IF(CONDITION,TEXT(CALL("USER.EXE","MessageBeep","&gt;H",0)+CALL("USER
   .EXE","MessageBox","HHCCH",0,"MESSAGE","TITLE",),""),"")

   32-bit versions of Microsoft Excel (5.0 for Windows NT, 7.0)
   ------------------------------------------------------------
   =IF(CONDITION,TEXT(CALL("USER32","MessageBeep","&gt;H",0)+CALL("USER32",
   "MessageBoxA","HHCCH",0,"MESSAGE","TITLE",),""),"")

</PRE>Where:

<UL><LI>CONDITION is a valid conditional statement, such as A1&gt;5.

<LI>"MESSAGE" is a text string which will appear inside the alert box
   that will be displayed when the condition is met.

<LI>"TITLE" is a text string which will appear inside the title bar of
   the alert box that will be displayed when the condition is met.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The CALL statements call routines are part of the Windows DLL files
USER.EXE (16-bit) and USER32.DLL (32-bit). Because the CALL statement can
be used in this form on a Microsoft Excel worksheet it is not necessary to
use a macro sheet or Visual Basic module.
<P>
The message in the alert box may contain multiple lines by typing the
first line of MESSAGE text and then pressing ENTER while holding down
the ALT key.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 3.0, pages 24-25,
125-126 and 234-235
<P>
"Microsoft Excel Function Reference," version 4.0, pages 42-43,
225-226 and 431-432
<P>
Microsoft Windows Software Developers Kit
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00 4.0 4.00 sdk 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
