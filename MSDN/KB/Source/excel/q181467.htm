

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: Defined Names Saved Incorrectly in Lotus 1-2-3 Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181467">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1998/02/19">
<META NAME="Keywords" CONTENT="xl123quattro xlloadsave kbdta">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 98 Macintosh Edition, when you save a file in the Lotus 1-2-3 WK4, WK3, or WK1 file format, the following problems may occur:   - When you reopen the file in Microsoft Excel, defined names in the    workbook refer to incorrect ra...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUJ,QAUR,QABM,QAJC,QAU7,QA5V,QDNZ,QAB4,QAAP,QAKP,QDO9,QBWS,QARM,QDNG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Defined Names Saved Incorrectly in Lotus 1-2-3 Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181467</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, when you save a file in the Lotus
1-2-3 WK4, WK3, or WK1 file format, the following problems may occur:

<UL><LI>When you reopen the file in Microsoft Excel, defined names in the
   workbook refer to incorrect ranges. However, the workbook functions
   correctly in other respects.

<LI>When you open the file in Lotus 1-2-3, you receive the following error
   message:
<P>
<P><PRE>      Error reading file
</PRE><P>
   Although you can open the file, much (or all) of the data is missing.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems occur when either of the following conditions is true:

<UL><LI>A defined name in the workbook refers to an entire column, or to
   multiple columns of cells.
<P>
   For example, the defined name refers to the following cells:
<P>
<P><PRE>      =Sheet1!$A:$A
      =Sheet1!$D:$K
</PRE><P>
<P><PRE>    -or-
</PRE>
<LI>A defined name in the workbook refers to a cell (or cells) beyond row
   8,192.
<P>
   For example, the defined name refers to the following cells:
<P>
<P><PRE>      =Sheet1!$A$8195
      =Sheet1!$D$65536
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around these problems, verify that defined names in the workbook do
not refer to entire columns of cells or to cells beyond row 8,192 before
you save the workbook in the Lotus 1-2-3 WK4, WK3, or WK1 format.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, worksheets may contain up to
65,536 rows. However, in the Lotus 1-2-3 WK4, WK3, and WK1 file formats,
worksheets may contain up to 8,192 rows. Because of this difference, you
may experience problems when you open files that are saved in a Lotus 1-2-3
file format from Microsoft Excel 98 Macintosh Edition. In particular,
defined names may be affected by the process.
<P>
In Microsoft Excel 98 Macintosh Edition, when you reopen a Lotus 1-2-3 file
that you have saved from Microsoft Excel 98 Macintosh Edition, defined
names are affected as follows:
<P>
<PRE>   If a defined name refers to a cell (or to cells) after row 8,192, the
   row numbers of the cells are decremented in units of 8,192 until the row
   numbers are less than or equal to 8,192.

   Examples of row numbers that are changed are listed in the following
   table.

      Original range used            Range used after reopening
      ---------------------------------------------------------

      =Sheet1!$A$1:$A$8195           =Sheet1!$A$1:$A$3
      =Sheet1!$A$8193:$A$8200        =Sheet1!$A$1:$A$8
      =Sheet1!$A$8190:$A$8195        =Sheet1!$A$3:$A$8190
      =Sheet1!$A:$A                  =Sheet1!$A$1:$A$8192
      =Sheet1!$K:$X                  =Sheet1!$K$1:$X$8192
      =Sheet1!$M$65536               =Sheet1!$M$8192

</PRE>If you attempt to open a Lotus 1-2-3 WK4, WK3, or WK1 file that you saved
with this kind of defined name in an earlier version of Microsoft Excel,
you cannot open the file. However, the defined names still refer to
incorrect ranges.
<P>
If you attempt to open a Lotus 1-2-3 WK4, WK3, or WK1 file that you saved
with this kind of defined name in Lotus 1-2-3, you may receive the error
message in this article. If this problem occurs, close the file without
saving changes. You can then reopen the file in Microsoft Excel and correct
the problem with the defined names.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 .wk4 .wk3 .wk1<BR>
Keywords          : xl123quattro xlloadsave kbdta<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
