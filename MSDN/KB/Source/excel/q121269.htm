

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Can't Use Visual Basic Procedure to Reference Project </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121269">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1994/09/30">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you cannot use a Visual Basic procedure to establish a reference to a project or to an object library. For example, if you turn on the Macro Recorder, and you use the References dialog box in a Visual Basic module to establish a...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVP,QDL9,QBWO,QBWN,QAFI,QAB3,QBXB,QATJ,QBJZ,QAJN,QAH4,QAB9,QAPN,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Can't Use Visual Basic Procedure to Reference Project</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121269</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, you cannot use a Visual Basic procedure to establish a
reference to a project or to an object library. For example, if you turn on
the Macro Recorder, and you use the References dialog box in a Visual Basic
module to establish a reference to a project or an object library, nothing
is recorded.
<P>
NOTE: A project is any file that contains a Visual Basic for Applications
module, such as an .XLS or .XLA file.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To establish a reference in a Visual Basic module to a project, when you
will be copying the module to another computer, do either of the following:

<UL><LI>In the module that you want to copy to a different computer, use the
   References dialog box (Tools menu) to reference the project before you
   copy the module to a different computer. Then copy the workbook that
   contains this module, and the referenced project to the same directory
   on the second computer. When you use this method, Microsoft Excel finds
   the referenced project and establishes the reference again when you run
   the procedure.
<P>
   You can also copy the referenced project to the Microsoft Excel
   directory, the Microsoft Windows directory, the Microsoft Windows SYSTEM
   subdirectory, or any directory that is in the MS-DOS path statement.
<P>
   -or-

<LI>You can call a Visual Basic procedure that is located in another project
   by first opening the project file, and then using the Run method of the
   Application object, and specifying the name of the referenced project
   and the name of the procedure as in the following example:
<P>
</UL>Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. This Visual
Basic procedure is provided 'as is' and Microsoft does not guarantee
that it can be used in all situations. Microsoft does not support
modifications of this procedure to suit customer requirements for a
particular purpose.
<P>
<PRE>   Workbooks.Open("BOOK1.XLS")
   Application.Run "BOOK1.XLS!Macro1"

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q110755.htm">Q110755</A></B>
   TITLE     : XL: Deleted Project or Library Listed Twice In References

</PRE>When you open a Visual Basic module that references a project,
Microsoft Excel searches for the referenced project file in the
following directories:
<P>
<PRE>   1. The directory that contained the project file when you first
      established the reference.

   2. The directory in which the file that contains the reference is
      located.

   3. The directory in which Microsoft Excel is installed.

   4. The directory in which Microsoft Windows is installed.

   5. The SYSTEM subdirectory of the Microsoft Windows directory.

   6. Any directory that is located in the path statement in the
      AUTOEXEC.BAT file.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the References Command (Tools Menu),
choose the Search button in Help and type:
<P>
<PRE>   References command (Tools Menu)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory:
<P>

Additional reference words: 7.00 1.00 5.00 5.00c<BR>
Keywords            : kbprg<BR>
Version             : 5.00 5.00c 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
