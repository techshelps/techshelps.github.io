

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Error or Chart Disappears When You Open a Lotus WK4 File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172461">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/08/06">
<META NAME="Keywords" CONTENT="xl123quattro xlchart xlgpf xlloadsave kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you open a Lotus 1-2-3 WK4 file in Microsoft Excel 97, you may receive the following error message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contact the program vendor.  If you clic...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDO3,QAB4,QAUR,QDKW,QDNX,QBWS,QAKP,QDNE,QAJC,QABM,QAU7,QAO4,QAQG,QDNM P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error or Chart Disappears When You Open a Lotus WK4 File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172461</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 97 for Windows, Service Release 1 (SR-1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a Lotus 1-2-3 WK4 file in Microsoft Excel 97, you may receive
the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to the
following:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at
   0137:30499502.

</PRE>NOTE: When you open the same Lotus 1-2-3 WK4 file in Microsoft Excel 97
SR-1 all of the embedded charts in the workbook may disappear.
<P>
<P><h2>CAUSE</h2>
 
<P>
These problems occur if all of the following conditions are true:

<UL><LI>You save the file as a Microsoft Excel workbook.
<P>
<P><PRE>    -and-
</PRE>
<LI>You save the file in the Lotus 1-2-3 WK4 file format.
<P>
<P><PRE>    -and-
</PRE>
<LI>There are one or more embedded charts in a worksheet in the file.
<P>
<P><PRE>     -and-
</PRE>
<LI>When you open the file, the worksheet that contains the chart is not the
   active worksheet.
<P>
   For example, a file called Test.wk4 contains an embedded chart in
   Sheet2, but Sheet1 is the active worksheet when you open the file. If
   Sheet1 contains an embedded chart or if Sheet2 is the active worksheet,
   the problem does not occur.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
<P><h3>Microsoft Excel 97</h3>
 
<P>
If this problem occurs in Microsoft Excel 97, do not open the WK4 file in
Microsoft Excel 97. To work around this problem, use either of the
following methods:

<UL><LI>Open the WK4 file in Lotus 1-2-3, change the active worksheet to a
   worksheet that contains an embedded chart, and then resave the file.
   After you do this, you can open the file in Microsoft Excel 97.

<LI>Obtain Microsoft Excel 97 SR-1. The illegal operation and invalid page
   fault do not occur in Microsoft Excel 97 SR-1. However, you must use the
   workaround in the "Microsoft Excel 97 SR-1" section in this article.
<P>
   For additional information about SR-1, please see the following article
   in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../OFFICE/Q172475.htm">Q172475</A></B>
<PRE></PRE>      TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE></UL><h3>Microsoft Excel 97 SR-1</h3>
 
<P>
If this problem occurs in Microsoft Excel 97 SR-1, you can open the WK4
file. To work around the problem in which embedded charts disappear, open
the WK4 file in Lotus 1-2-3, change the active worksheet to a worksheet
that contains an embedded chart, and then resave the file.
<P>
NOTE: You may also recreate the charts. If you do this, make sure that
the active worksheet contains an embedded chart if you save the file in the
WK4 file format.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 ipf sr1<BR>
Keywords          : xl123quattro xlchart xlgpf xlloadsave kberrmsg<BR>
Version           : WINDOWS:97,97SR1<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
