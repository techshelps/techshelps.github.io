

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Join Related Database Tables in an Excel Spreadsheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74150 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1991/07/14">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The QE.XLA add-in macro supplied with Microsoft Excel will enable you to extract information from multiple external database tables.  This article explains the rules for using combined criteria, as explained in the  Microsoft Excel User's Guide,  w...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QBVP,QA3P,QA5V,QBXS,QA4H,QAY2,QAGU,QDI1,QAZZ,QBJZ,QATF,QAZV,QAKC,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Join Related Database Tables in an Excel Spreadsheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74150 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions  3.0, 4.0
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The QE.XLA add-in macro supplied with Microsoft Excel will enable you
to extract information from multiple external database tables.
<P>
This article explains the rules for using combined criteria, as
explained in the "Microsoft Excel User's Guide," with the rules for
joining tables, as explained in the "Q+E for Microsoft Excel User's
Guide."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For example, you might want to extract information from the Employee
database on all managers listed in the Department database. These
managers have an ID number that is identical in both databases. We can
use this ID to establish a relationship between these two database
tables.
<P>
(See EMP.DBF and DEPT.DBF. These files are used in many examples
throughout the "Q+E for Microsoft Excel User's Guide.")
<P>
In addition, we could add criteria to find only the records for all
managers who are located in L31 or L04, have a salary of $48,000 or
more, and were hired after January 1, 1985.
<P>
Four examples show how these things can be done:

<UL><LI>Example 1 shows how to use criteria to join two database tables.
<LI>Example 2 shows how to set criteria using the AND relation.
<LI>Example 3 shows how to set criteria using the OR relation.
<LI>Example 4 combines examples 1, 2, and 3.
<P>
</UL><h3>Setting Up the Worksheet to Use with the Examples</h3>
 
<P>
To demonstrate joining tables and setting criteria, a worksheet needs
to be created that has proper external database definitions and a row
of pasted field names. This can be accomplished by following these
steps:

<OL><P><LI>Load QE.XLA.

<P><LI>On a blank worksheet, choose Set Database from the Data menu and
   check the External Database check box.

<P><LI>Specify DEPT.DBF and EMP.DBF as your sources.

<P><LI>From the Data menu, choose Paste Fieldnames and choose the Paste
   All button.

<P><LI>With the field names still highlighted, choose Set Extract from the
   Data menu.
<P>
</OL><h3>Example 1: How to Join Two Database Tables</h3>
 
<P>
EMP.DBF and DEPT.DBF both contain employee data. Each file uses a
different field to hold the employee data. In EMP.DBF, this field
is called EMP_ID; in DEPT.DBF, this field is called MGR_ID. To
join information from these two tables, you MUST specify this
relationship.
<P>
Cells N1 and N2 should contain the following:
<P>
<PRE>   __|______N______|
   1 | dept.MGR_ID |
   2 | emp.EMP_ID  |

</PRE></OL>This criterion can be translated as follows:
<P>
For every manager ID number in DEPT.DBF, find the corresponding ID
number and record in EMP.DBF.
<P>
<P><h3>Extracting the Joined Records</h3>
 

<OL><P><LI>Highlight N1:N2 and choose Set Criteria from the Data menu.

<P><LI>From the Data menu, choose Extract.

<P><LI>After Microsoft Excel reports that four records are found, choose
   Paste from the Edit menu.
<P>
</OL>Example 2: How to Set Criteria Using the AND Relation
 
<P>
To extract joined records using the AND relation, any number of
additional criteria can be specified in additional columns on the same
row:
<P>
<PRE>     |______N______|______O______|______P_____|_______Q_______|
   1 | dept.MGR_ID | dept.LOC_ID | emp.SALARY | emp.HIRE_DATE |
   2 | emp.EMP_ID  | L31         | &gt;48000     | &gt;31048        |

</PRE></OL>The criteria above can be translated as follows:
<P>
<PRE>   For all managers whose ID numbers occur in DEPT.DBF, find the
   corresponding ID number and record it in EMP.DBF for all managers
   who are located in L31 AND have a salary of $48,000 or more AND
   were hired after January 1, 1985.

</PRE>To extract data based on these criteria:

<OL><P><LI>Delete all previously extracted data.

<P><LI>Create the criteria as shown above.

<P><LI>Select cells N1:Q2 and choose Set Criteria from the Data menu.

<P><LI>From the Data menu, choose Extract.

<P><LI>After Microsoft Excel reports that one record is found, choose
   Paste from the Edit menu.
<P>
</OL><h3>Example 3: How to Set Criteria Using the OR Relation</h3>
 
<P>
To extract joined records using the OR relation, any number of
additional criteria can be specified in additional rows:
<P>
<PRE>     |______N______|______O______|
   1 | dept.MGR_ID | dept.LOC_ID |
   2 | emp.EMP_ID  | L31         |
   3 | emp.EMP_ID  | L04         |

</PRE></OL>The criteria above can be translated as follows:
<P>
<PRE>   For all managers whose ID numbers occur in DEPT.DBF, find the
   corresponding ID number and record it in EMP.DBF for all managers
   who are located in L31 OR in L04.

</PRE>To extract data based on these criteria:

<OL><P><LI>Delete all previously extracted data.

<P><LI>Create the criteria as shown above.

<P><LI>Select cells N1:O2 and choose Set Criteria from the Data menu.

<P><LI>From the Data menu, choose Extract.

<P><LI>After Microsoft Excel reports that three records are found, choose
   Paste from the Edit menu.
<P>
</OL><h3>Example 4: Combining Criteria Using Both AND and OR Relations</h3>
 
<P>
To extract joined records using both the AND and the OR relation,
any number of additional criteria can be specified in additional rows
and columns.
<P>
Note that cells P2 and Q2 contain criteria as well, even though they
did not in the previous two examples. The reason is that the criteria
for emp.SALARY and emp.HIRE_DATE have to apply to ALL records that
satisfy the dept.LOC_ID criteria, not just the ones for which
dept.LOC_ID equals L31.
<P>
<PRE>     |______N______|______O______|______P_____|_______Q_______|
   1 | dept.MGR_ID | dept.LOC_ID | emp.SALARY | emp.HIRE_DATE |
   2 | emp.EMP_ID  | L31         | &gt;48000     | &gt;31048        |
   3 | emp.EMP_ID  | L04         | &gt;48000     | &gt;31048        |

</PRE></OL>To extract data based on these criteria:

<OL><P><LI>Delete all previously extracted data.

<P><LI>Create the criteria as shown above.

<P><LI>Select cells N1:Q3 and choose Set Criteria from the Data menu.

<P><LI>From the Data menu, choose Extract.

<P><LI>After Microsoft Excel reports that three records are found, choose
   Paste from the Edit menu.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide," pages 15-18, 56-66
<P>
"Microsoft Excel User's Guide," pages 371-377
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 3.00 3.0 4.00 4.0 relational combine<BR>
extract multiple<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
