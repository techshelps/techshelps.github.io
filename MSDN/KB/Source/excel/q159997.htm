

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Illegal Operation Closing File When VBE Is Visible </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159997">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/11/26">
<META NAME="Keywords" CONTENT="xlui xlvbainfo xlweb kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you close Microsoft Internet Explorer 3.x while a Microsoft Excel  workbook is open, you may receive the following error message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contact th...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRJ,QBV9,QBS0,QBVP,QAB4,QAGB,QA5F,QA01,QAL0,QAAW,QAH4,QAMA,QAKR,QAHE,QAKP P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Illegal Operation Closing File When VBE Is Visible</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159997</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Internet Explorer, versions 3.0, 3.01, 3.02
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you close Microsoft Internet Explorer 3.x while a Microsoft Excel 
workbook is open, you may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive one of the following error messages:
<P>
<PRE>   EXCEL caused an invalid page fault in module VBA332.DLL at
   014f:651b5ef6.

   -or-

   EXCEL caused an invalid page fault in module USER32.DLL at
   014f:bff64e46.

   -or-

   EXCEL caused an invalid page fault in module KERNEL32.DLL at
   014f:bff780a4.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when all of the following conditions are true:

<UL><LI>You view a Microsoft Excel workbook in Microsoft Internet Explorer.
<P>
<P><PRE>    -and-
</PRE>
<LI>You display the Visual Basic Editor, display any dialog box (for
   example, the References dialog box), and leave the dialog box visible on
   the screen.
<P>
<P><PRE>    -and-
</PRE>
<LI>You switch back to Microsoft Internet Explorer and close the workbook,
   by clicking Close on the File menu or by clicking the Close button in
   the upper-right corner of the window.
<P>
</UL>When you display the Visual Basic Editor, display a dialog box in the
Visual Basic Editor, and then close the workbook in the Internet Explorer,
the displayed dialog box prevents the Visual Basic Editor quitting. As a
result, you receive one or more of the error messages that are described in
this article.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent this problem from occurring, close any visible dialog boxes in
the Visual Basic Editor before you switch back to Microsoft Internet
Explorer 3.x.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A new features that is supported by Microsoft Internet Explorer 3.x is the 
ability to view and edit Microsoft Excel workbooks directly in Microsoft 
Internet Explorer. When you do this, you can use almost all of the features
in Microsoft Excel 97, including programming in the Visual Basic Editor.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 gpf ipf crash<BR>
Keywords          : xlui xlvbainfo xlweb kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
