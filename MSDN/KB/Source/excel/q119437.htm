

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Error Choosing Button After Assigning Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119437">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/08/16">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you use a Visual Basic procedure to assign a macro to a custom toolbar button, you receive the following error message when you choose the button     Cannot find macro ''C:\EXCEL\          '!                '  where          ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA5D,QBS0,QBVP,QBXS,QANS,QAUJ,QBJZ,QBWS,QAF0,QAJD,QAB4,QAAP,QAB9,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Error Choosing Button After Assigning Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119437</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you use a Visual Basic procedure to assign a
macro to a custom toolbar button, you receive the following error
message when you choose the button
<P>
<PRE>   Cannot find macro ''C:\EXCEL\&lt;BOOK.XLS&gt;'!&lt;Assigned_Macro&gt;'

</PRE>where &lt;Assigned_Macro&gt; is the name of the macro you assigned to the
button, and &lt;BOOK.XLS&gt; is the name of an open workbook that contains a
macro, but does not contain Assigned_Macro.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when you use a procedure contained in one workbook to
assign a macro contained in the active workbook to a toolbar button. In
this case, the name of the workbook from which you run the procedure to
assign the macro is incorrectly added to the macro name that is assigned to
the button.
<P>
For example, if you use a procedure in BOOK.XLS to assign the macro
Assigned_Macro contained in MACRO.XLS to a toolbar button, and MACRO.XLS is
the active workbook, the following macro name is assigned to the button:
<P>
<PRE>   BOOK.XLS!Assigned_Macro

</PRE>This behavior occurs only when you use the xlDialogAssignToTool named
constant to display the Assign Macro dialog box as in the following
example:
<P>
<PRE>   Application.Dialogs(xlDialogAssignToTool).Show arg1:="Toolbar1", arg2:=1

</PRE><h2>WORKAROUNDS</h2>
 
<P>
To avoid this behavior, do either of the following:

<UL><LI>Assign the macro to the toolbar button using the Assign Macro dialog box
   by using the following steps:
<P>
   1. From the View menu, choose Toolbars. Choose the Customize button.
<P>
   2. Choose the custom button (on the toolbar) to which you want to assign
<P><PRE>      the macro.
</PRE><P>
   3. From the Tools menu, choose Assign Macro. From the Macro
<P><PRE>      Name/Reference list, select the macro you want to assign, and choose
      OK.
</PRE><P>
   4. Close the Customize dialog box.
<P>
   -or-

<LI>Use the OnAction method of the ToolbarButtons object to assign the macro
   as in the following example:
<P>
   Microsoft provides examples of Visual Basic procedures for illustration
   only, without warranty either expressed or implied, including but not
   limited to the implied warranties of merchantability and/or fitness for
   a particular purpose. This Visual Basic procedure is provided 'as is'
   and Microsoft does not guarantee that it can be used in all situations.
   Microsoft does not support modifications of this procedure to suit
   customer requirements for a particular purpose.
<P>
<PRE>      Sub Assign_To_Button()
         ' The following line assigns the macro Assigned_Macro
         ' to the first button on the toolbar named Toolbar1
         Toolbars("Toolbar1").ToolbarButtons(1).OnAction = "Assigned_Macro"
      End Sub

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in a
later version of Microsoft Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Assigning A Macro To A Custom Button On A
Toolbar, choose the Search button in Help and type:
<P>
<PRE>   assigning macros
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory:
<P>

Additional reference words: 1.00 5.00 err msg
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
