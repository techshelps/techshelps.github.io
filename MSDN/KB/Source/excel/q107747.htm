

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Q+E: DDE or SQL Error Message Extracting Oracle Dates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107747">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/11/29">
<META NAME="Keywords" CONTENT="ENDUSER">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you set an external database to an Oracle table and extract dates, you may receive a DDE or SQL error message.  STATUS ======  Microsoft has confirmed this to be a problem with the Q+E add-in macro. We are researching this problem and will pos...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBXS,QBWS,QABM,QA3P,QAB4,QAG2,QA2Q,QAPN,QA94,QA9N,QA7O,QA7N,QAY2,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Q+E: DDE or SQL Error Message Extracting Oracle Dates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107747</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Q+E for Microsoft Excel for Windows, versions 3.0, 3.0a
<LI>Q+E for Microsoft Excel for OS/2, versions 3.0
<LI>Microsoft Excel for Windows, versions 3.0 and 4.0
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you set an external database to an Oracle table and extract dates, you
may receive a DDE or SQL error message.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem with the Q+E add-in macro. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To work around this problem, do either of the following.
<P>
<P><h3>Workaround 1</h3>
 
<P>
The following procedure should produce the same results you get when you
choose Extract from the Data menu. (You can automate this procedure with a
macro by recording steps 2-5 with the Macro Recorder.)

<OL><P><LI>In Q+E, open the Oracle Table, choose Select Add Condition and run your
   Query on the Date field. Save the Query as DATE.QEF.

<P><LI>Start Microsoft Excel.

<P><LI>From the Data menu, choose SQL Query.

<P><LI>Open the DATE.QEF file and choose the Run button.

<P><LI>Paste the records as unlinked.
<P>
</OL><h3>Workaround 2</h3>
 
<P>
Because this problem is the result of a syntax error in the SQL statement,
you can correct it by correcting the SQL statement. To view the SQL query
statement and correct it in Microsoft Excel, do the following:

<OL><P><LI>In Q+E, open the Oracle Table, choose Select Add Condition and run your
   Query on the Date field.

<P><LI>Select the SQL query (the SQL statement is already highlighted) and
   press CTL+INS to copy the query.

<P><LI>In Microsoft Excel, paste the SQL statement into an empty portion of the
   spreadsheet. It should resemble the following:
<P>
<P><PRE>      (where Table name = Datephoner Date Field = DATED. SELECT DATED,
      NAME, NUMBERED, PHONERFROM DATEPHONERWHERE DATED &gt; TO_DATE('1992-12-
      04 00:00:00', 'YYYY-MM-DD HH24:MI:SS'
</PRE>
<P><LI>From the Data menu, choose Set Database, select the External option and
   choose OK.

<P><LI>In the External Database dialog box, in the Source box, choose the
   Sources button, log on to Oracle, and select your table.

<P><LI>In cell A1, use a substitute field name for your criteria date field.
   For example, use "Fred" instead of "Date." For the criteria in cell A2,
   use a portion of the SQL statement that was pasted from Q+E. Select and
   copy everything after the "where" statement in the above example and
   paste this into cell A2. Your data should resemble the following
   example:
<P>
<P><PRE>      A1: Fred A2: DATED &gt; TO_DATE('1992-12-00:00','YYYY-MM-DD HH24:MI:SS'
</PRE>
<P><LI>Select cells A1:A2 and choose Set Criteria from the Data menu.

<P><LI>Paste the field names, set the extract range and choose Extract from the
   Data menu.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide," version 3.0a, included with
Microsoft Excel version 3.0
"Q+E for Microsoft Excel User's Guide," version 3.0a, included with
Microsoft Excel version 4.0
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kb3rdparty<BR>
KBSubcategory:
<P>

Additional reference words: 3.00 4.00 QE 4 4.00a W_EXCEL
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
