

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL3/XL4: Including or Excluding a List of Records in Extract </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103708">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/08/27">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you extract records from a database in Microsoft Excel, you specify criteria that you want the extracted records to meet. In cases where you have a list of matches that you want to include or exclude in your final extract, use the MATCH() func...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHH,QBXN,QA3P,QBVP,QAUJ,QAPF,QAHG,QA5V,QA7O,QA7N,QAE1,QAY5,QATF,QAH8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL3/XL4: Including or Excluding a List of Records in Extract</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103708</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0, 4.0a
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you extract records from a database in Microsoft Excel, you
specify criteria that you want the extracted records to meet. In cases
where you have a list of matches that you want to include or exclude
in your final extract, use the MATCH() function as a computed
criterion.
<P>
To include a list of matches, use the following formula:
<P>
<PRE>   =MATCH(firstcell,matchlist,0)

</PRE>To exclude a list of matches, use the following formula
<P>
<PRE>   =ISNA(MATCH(firstcell,matchlist,0))

</PRE>where firstcell is the first cell in the field of your database that
you want to match.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you have only a few matches for a given field, you can set up an
"and" relationship using comparison criteria by entering an instance
of the field name for each match you want to make. For example, if one
of the fields in your database is a Name field and you want to find or
extract a specific list of names, the criteria range (F1:H2) might
appear as follows:
<P>
<PRE>   F1: Name   G1: Name   H1: Name
   F2: Ann    G2: Fred   H2: Bob

</PRE>Or, you can use the AND() function as a computed criterion as follows
<P>
<PRE>   F1: CompCrit
   F2: =AND(A2="Ann",A2="Fred",A2="Bob")

</PRE>where column A contains the Name field in your database, cell A2
contains the first name in the field, and the criteria range is
defined as F1:F2.
<P>
Note that when you specify a computed criterion, the cell above the
formula cannot contain the actual field name; it must either be blank
or contain a different text string.
<P>
If, however, you have several names that you want to match, you can
list them in a vertical cell range as follows:
<P>
<PRE>   H1: Ann
   H2: Fred
   H3: Bob
   H4: Kristi
   H5: Nikki

</PRE>You can then use the MATCH() function as a computed criterion, as in
the following example (where cells F1:F2 are the criteria range):
<P>
<PRE>   F1:
   F2: =MATCH(A2,$H$1:$H$5,0)

</PRE>NOTE: Your matchlist must be an absolute reference or a defined name.
<P>
To extract all of the records EXCEPT those in H1:H5, nest the MATCH()
function within the ISNA() function.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 1," version 4.0, pages 330-337
"Function Reference," version 4.0, pages 248, 267
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 4.00 4.00a howto exclusionary exception <BR>
exceptional XL4 XL3<BR>
Version           : WINDOWS:3.0,4.0,4.0a; OS/2:3.0; MACINTOSH:3.0,4.0<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
