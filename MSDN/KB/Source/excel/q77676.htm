

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Using a Logical AND or OR in a SUM+IF Statement in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77676 ">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1991/10/23">
<META NAME="Keywords" CONTENT="kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, attempting to use the logical functions AND and/or OR inside a SUM+IF statement to test a range for more than one condition does not work properly. A nested IF statement gives this functionality. However, this article discusses ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAVW,QAVX,QAPN,QAB9,QAE5,QDMR,QBE7,QBE6,QAMV,QAKD,QAH6,QAKC,QAG8,QDNZ P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using a Logical AND or OR in a SUM+IF Statement in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77676 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.x, 4.x, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, attempting to use the logical functions AND and/or
OR inside a SUM+IF statement to test a range for more than one
condition does not work properly. A nested IF statement gives this
functionality. However, this article discusses a second easier method
that uses the following formula:
<P>
<PRE>   {=SUM(IF(Test1*Test2*...*Testn))}

</PRE><h2>MORE INFORMATION</h2>
 
<P>
A SUM+IF statement is used to count the number of cells in a range
that pass a given test OR to sum those values in a range for which
corresponding values in another (or the same) range meet the specified
criteria. This acts similarly to Microsoft Excel DSUM function.
<P>
<P><h3>Example</h3>
 
<P>
This example counts the number of values in the range A1:A10 that fall
between 1 and 10, inclusively.
<P>
This can be accomplished by using the following nested IF statement:
<P>
<PRE>   {=SUM(IF(A1:A10&gt;=1,IF(A1:A10&lt;=10,1,0)))}

</PRE>The following method also works and is much easier to read if multiple
tests are to be conducted:
<P>
<PRE>   {=SUM(IF((A1:A10&gt;=1)*(A1:A10&lt;=10),1,0))}

</PRE>NOTE: Both formulas should be entered as array formulas by pressing
CTRL+SHIFT+ENTER simultaneously.
<P>
With this method, you are multiplying the results of one logical test by
another logical test to return TRUEs and FALSEs to our SUM function. These
can be equated to:
<P>
<PRE>   TRUE*TRUE=1
   TRUE*FALSE=0
   FALSE*TRUE=0
   FALSE*FALSE=0

</PRE>The method shown above counts the number of cells in the range A1:A10
for which both tests evaluate to TRUE. To sum values in corresponding
cells (for example, B1:B10), modify the formula as shown below:
<P>
<PRE>   {=SUM(IF((A1:A10&gt;=1)*(A1:A10&lt;=10),B1:B10,0))}

</PRE>You can implement an OR in a SUM+IF statement similarly. To do this,
modify the formula shown above by replacing the multiplication sign (*)
with a plus sign (+). This gives the following generic formula:
<P>
<PRE>   {=SUM(IF((Test1)+(Test2)+...+(Testn),1,0))}

</PRE><h2>REFERENCES</h2>
 
<P>
"User's Guide," version 4.0, pages 153-157
<P>
"User's Guide," version 3.0, pages 119-120
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 7.00 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21 3.0<BR>
3.00 4.0 4.00 4.0a 4.00a 5.0 5.00 97 boolean conditional<BR>
Keywords          : kbualink97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
