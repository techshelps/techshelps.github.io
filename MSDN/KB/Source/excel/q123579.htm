

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GP Fault When Using INDIRECT in a Formula for a Defined Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123579">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/12/05">
<META NAME="Keywords" CONTENT="kbusage kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when ALL of the conditions listed in the  Cause  section of this article are true, you may receive the following general protection (GP) fault:       Excel caused a General Protection Fault in module EXCEL.EXE at      00EE:22CA....">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUJ,QBKN,QAVX,QAVW,QARM,QAB9,QAM5,QAAP,QBWD,QDL9,QBWQ,QBWO,QBWN,QAJ6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>GP Fault When Using INDIRECT in a Formula for a Defined Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123579</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when ALL of the conditions listed in the "Cause"
section of this article are true, you may receive the following general
protection (GP) fault:
<P>
<PRE>     Excel caused a General Protection Fault in module EXCEL.EXE at
     00EE:22CA.

</PRE><h2>CAUSE</h2>
 
<P>
This error will occur if ALL of the following conditions are true:

<UL><LI>A defined name in the workbook has a formula using the INDIRECT
   function.
<P>
   -and-

<LI>A cell in the workbook contains a formula referring to the defined name.
<P>
   -and-

<LI>The defined name used in the worksheet formula is prefaced with the
   worksheet name.
<P>
</UL>For example, assume you have a name "test" defined on a worksheet (Sheet1),
and assume that it has the formula =INDIRECT($A$1). If you then refer to
that defined name with the formula =Sheet1!test, in a cell in the workbook,
a GP fault will occur. This behavior is incorrect. Under these
circumstances, Microsoft Excel should return the #REF! error value because
the reference to the globally defined name is invalid.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To refer to the defined name, define the name as a local sheet name
(Sheet1!test) instead of as a global book name (test). Once you do this,
the reference to the name will be valid.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel version
5.0 for Windows. This problem was corrected in Microsoft Excel version 5.0c
for Windows.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on creating names, choose the Search button in Help
and type either of the following:
<P>
<PRE>   names, creating

   -or-

   names, overview
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 5.0a link gpf xlwin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
