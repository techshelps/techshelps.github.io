

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Incorrect Reg.dat Entries After Automatic Registration </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117849">
<META NAME="KBModify" CONTENT="1997/03/28">
<META NAME="KBCreate" CONTENT="1994/07/11">
<META NAME="Keywords" CONTENT="kbole xlwin kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you rename the Microsoft Excel program file, Excel.exe, to a different file name, or if you rename the Reg.dat file, or if you move the Microsoft Excel program files to a different drive or directory, the Reg.dat file contains incorrect entries....">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAAP,QAH4,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Incorrect Reg.dat Entries After Automatic Registration</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117849</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you rename the Microsoft Excel program file, Excel.exe, to a different
file name, or if you rename the Reg.dat file, or if you move the Microsoft
Excel program files to a different drive or directory, the Reg.dat file
contains incorrect entries.
<P>
The behavior of Microsoft Excel should not be affected by these incorrect
entries; however, the behavior of a Microsoft Excel object in another
program may be affected. The specific effect that these incorrect entries
have on the behavior of a Microsoft Excel object in another program is
unknown. The following are symptoms you may encounter:

<UL><LI>Another program may stop responding or generate a general protection
   fault when you paste information from Microsoft Excel.

<LI>You may be unable to complete certain actions with a Microsoft Excel
   chart object in another program.

<LI>You may receive incorrect results when you edit a Microsoft Excel
   worksheet object in another program.
<P>
</UL><h2>CAUSE</h2>
 
<P>
When you install Microsoft Excel, the program is registered correctly in
the Reg.dat file. If you merge the Excel5.reg file into the Reg.dat file,
the program is registered correctly in the Reg.dat file.
<P>
The incorrect entries are written to the Reg.dat file only if Microsoft
Excel must automatically register itself in the Reg.dat file. This occurs
when Microsoft Excel is not already registered in the Reg.dat file.
Automatic registration occurs only when you run Microsoft Excel and one of
the following conditions is true:

<UL><LI>You rename the Microsoft Excel program file.
<P>
   -or-

<LI>You rename the Reg.dat file and start Microsoft Windows again.
<P>
   -or-

<LI>You move the Microsoft Excel program files to a different drive or
   directory.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To register Microsoft Excel again in the Reg.dat file after any of the
above conditions is true, run the Microsoft Excel Setup program and either
click Reinstall All (to repeat the previous installation) or click
Remove/Add to remove Microsoft Excel, and then run Setup to reinstall it.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The entries in Reg.dat that are listed in this section are incorrect when
the registration information for Microsoft Excel is automatically
generated.
<P>
NOTE: These entries are shown as they appear when you run Regedit.exe using
the verbose switch (/v). The complete path for each entry is the following:
<P>
<PRE>   HKEY_CLASSES_ROOT\CLSID\{00020810-0000-0000-C000-000000000046}

</PRE><h3>Dataformats</h3>
 
<P>
The incorrect entries are as follows:
<P>
<PRE>   - DataFormats
      - DefaultFile = Biff5
         - GetSet
            - 1 = 1,1,1
            - 2 = 1,16,1
            - 3 = 1,32,1

</PRE>The correct entries should have four parameters, for example, as in the
following:
<P>
<PRE>   - DataFormats
      - DefaultFile = Biff5
         - GetSet
            - 2 = 1,1,1,1
            - 1 = 2,1,16,1
            - 0 = 3,1,32,1

</PRE>The first parameter (missing in the automatically registered entries) is a
Clipboard format identifier.
<P>
<P><h3>Conversion</h3>
 
<P>
The incorrect entries appear as follows:
<P>
<PRE>   - Conversion
      - Readwritable
         - Main=Biff5
      - Readable
         - Main=Biff5,ExcelWorksheet

</PRE>The correct entries should not have the readwritable entry, for example, as
in the following:
<P>
<PRE>   - Conversion
      - Readable
         - Main=Biff5,ExcelWorksheet

</PRE>The readwritable entry should list only foreign formats that can be edited
in place in Microsoft Excel.
<P>
<P><h3>MiscStatus</h3>
 
<P>
The incorrect MiscStatus entries for Microsoft Excel (for ExcelWorksheet
and ExcelChart) are as follows:
<P>
<PRE>   - MiscStatus

</PRE>The correct entries should be set to zero, for example, as in the
following:
<P>
<PRE>   - MiscStatus = 0
     (for ExcelWorksheet)

   - MiscStatus = 1
     (for ExcelChart)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: crash ole linking embedding<BR>
Keywords            : kbole xlwin kbprb<BR>
Version             : 5.0 5.0c<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
