

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Using Relative R1C1 References in Macros </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q46514 ">
<META NAME="KBModify" CONTENT="1994/11/29">
<META NAME="KBCreate" CONTENT="1989/07/06">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you write a Microsoft Excel macro in R1C1 mode, relative references to the worksheet refer to cells on the worksheet relative to the cell containing the reference on the macro sheet. This behavior is often encountered when using the FORMULA co...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAB3,QAB9,QBDA,QBE7,QBE6,QDNZ,QAY5,QBFY,QAY2,QATX,QAMB,QBV8,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Using Relative R1C1 References in Macros</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 29, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q46514 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 1.x, 2.x, 3.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you write a Microsoft Excel macro in R1C1 mode, relative
references to the worksheet refer to cells on the worksheet relative
to the cell containing the reference on the macro sheet. This behavior
is often encountered when using the FORMULA command function, which
places the formula text in the cell on the indicated worksheet, offset
from the cell containing the FORMULA command on the macro sheet. The
following is an example:
<P>
<PRE>   R10C1   =FORMULA("text",Worksheet1!R[3]C)

</PRE>The above statement in R10C1 places "text" in cell R13C1 of
Worksheet1, regardless of which cell is currently selected in
Worksheet1. R13C1 is three rows and no columns (R[3]C) offset from
R10C1 in the macro sheet.
<P>
This information is true for any relative references while in R1C1
notation and should be kept in mind whenever you write macros that
reference other worksheets. The only time a reference will be relative
to the worksheet is if it is an R1C1 style reference passed as text,
such as SELECT("R[3]C1") or FORMULA("=SUM(RC:R[10]C)").
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This feature is by design and is consistent with A1 style references.
When a relative reference is placed in a cell, that reference is
always relative to the cell containing the formula. In R1C1 notation,
an expression of a reference such as R[X]C is treated as an offset
from the active cell's row number by X rows. Therefore, the formula
used with this notation in a macro sheet modifies the cell in the
worksheet that is an offset from the cell containing the formula in
the macro sheet. This is true when you use a column offset, such as
RC[X], as well, where the reference is offset by X columns.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, page 167-169
<P>
"Microsoft Excel Function Reference," version 3.0, pages 89-90
<P>
"Microsoft Excel Functions and Macros," version 2.2, pages 224-225
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: 1.0 1.00 1.03 1.04 1.06 1.5 1.50 2.2<BR>
2.20 3.0 3.00 4.0 4.00 macrosheet<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 29, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
