

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using SQL Server COMPUTE, COMPUTE BY Clauses from Within Q+E </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q69304 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/02/12">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE5,QAPN,QAUD,QAEN,QABM,QAY2,QAL3,QAB4,QAP2,QALW,QAWH,QBVP,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using SQL Server COMPUTE, COMPUTE BY Clauses from Within Q+E</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q69304 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
Q+E supports the use of the SQL Server COMPUTE clause, but not the
COMPUTE BY clause. Attempting to use the COMPUTE BY clause from the
SQL query box will result in the following error message being
displayed:
<P>
<PRE>   Q+E Warning:  Extra token at end of clause: BY

</PRE>If Q+E is used to execute stored procedures on the SQL Server that
return results generated by either the COMPUTE or COMPUTE BY clauses,
the results will be returned. However, all total fields returned will
contain the value zero.
<P>
The above restrictions can be explained by the fact that the COMPUTE
BY clause and the ability to create stored procedures are Transact SQL
enhancements (not standard SQL). Because Q+E was designed as a
front-end for a number of relational database management systems,
which may or may not include these enhancements, support for the BY
clause was not added to the current version.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SQL Server COMPUTE clause is designed to generate grand totals,
grand counts, and so on. An example of using the COMPUTE statement is
listed below:
<P>
<PRE>   select type, pub_id, price
   from titles
   where type = "psychology"
   compute sum(price)

</PRE>When using Q+E, issuing this query from the SQL query box returns
the correct results. These results are listed below:
<P>
<PRE>   type           pub_id      price
   --------------------------------

   psychology     0736         7.00
   psychology     0736         7.99
   psychology     0736        10.95
   psychology     0736        19.99
   psychology     0877        21.59
                            --------
                              67.52

</PRE>However, as noted above, if this query is contained within a stored
procedure on the server and is executed from Q+E, the computed sum
will return the value zero. An example of the results that would be
returned in this case are as follows:
<P>
<PRE>   type           pub_id      price
   --------------------------------

   psychology     0736         7.00
   psychology     0736         7.99
   psychology     0736        10.95
   psychology     0736        19.99
   psychology     0877        21.59

                                  0

</PRE>The SQL Server COMPUTE BY clause breaks a column into subgroups and
applies the specified row aggregate function to each group. A sample
COMPUTE BY statement is listed below:
<P>
<PRE>   select type, pub_id, price
   from titles
   where type = "psychology" or type = "mod_cook"
   compute sum(price) BY type

</PRE>When using SAF or ISQL to issue this query, the following results are
returned:
<P>
<PRE>   type           pub_id      price
   --------------------------------

    mod_cook       0877         2.99
    mod_cook       0877        19.99
                         sum
                         -----------
                               22.98

    psychology     0736         7.00
    psychology     0736         7.99
    psychology     0736        10.95
    psychology     0736        19.99
    psychology     0877        21.59
                         sum
                         -----------
                               67.52

</PRE>As noted above, the query that contains the COMPUTE BY clause will
generate an error message if an attempt is made to send it from the
SQL query box in Q+E. However, executing from Q+E a stored procedure
on the server that contains this query returns the following results:
<P>
<PRE>   type           pub_id      price
   --------------------------------

   mod_cook       0877         2.99
   mod_cook       0877        19.99

                                  0

   psychology     0736         7.00
   psychology     0736         7.99
   psychology     0736        10.95
   psychology     0736        19.99
   psychology     0877        21.59

                                  0

</PRE>As in the case of the COMPUTE clause, the totals are returned as zero.
However, if you intend to import this data into an Excel worksheet,
the subtotals can be added at a later date.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide." Version 3.00, page 127.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
