

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: GP Fault or Strange Results Using CHOOSE Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120408">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/09/11">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the CHOOSE function, if the first value argument contains an operator, such as the plus sign (+), one or more of the following symptoms occur:   - The #NAME? error value is returned, formatted with a different color...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QBVP,QBXS,QAKD,QAY5,QAPN,QAHE,QBQS,QAB9,QAB4,QAUD,QBWS,QAAP,QAYV,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: GP Fault or Strange Results Using CHOOSE Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120408</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the CHOOSE function, if the first
value argument contains an operator, such as the plus sign (+), one
or more of the following symptoms occur:

<UL><LI>The #NAME? error value is returned, formatted with a different color
   font.

<LI>The formula bar contains a lot of extended characters.

<LI>The screen elements, such as the column and row headings change colors.

<LI>The #VALUE! error value is returned.

<LI>You receive the "Cannot Resolve Circular References" error message.

<LI>You receive a general protection (GP) fault.
<P>
</UL><h2>CAUSE</h2>
 
<P>
This problem occurs if the first value argument in the CHOOSE
function contains an operator, such as the plus sign (+), and you
include a space between the index_num argument, and this first value
argument.
<P>
For example, when you enter the following formula on a MS Excel 4.0
macro sheet, you receive a GP fault:
<P>
<PRE>   =CHOOSE(1, 2+3)

</PRE>Note that there is a space following the comma.
<P>
If you enter the above formula on a worksheet, the #VALUE! error
value is returned, and the formula bar contains extended characters.
Additionally, when you exit Microsoft Excel, you may receive a GP
fault.
<P>
This behavior also occurs if you use a defined name in the formula,
as in the following example
<P>
<PRE>   =CHOOSE(i, i+1)

</PRE><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving a GP fault when you use the CHOOSE function, do
the following:

<UL><LI>Do not include a space between the index_num argument and the first
   value argument, as in the following example:
<P>
<P><PRE>      =CHOOSE(1,2+3)
</PRE><P>
   -or-

<LI>Use parentheses around the first value argument if it contains an
   operator as in the following example:
<P>
<P><PRE>      =CHOOSE(1, (2+3))
</PRE><P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel version 5.0c for Windows.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about CHOOSE, choose the Search button in Help and
type:
<P>
<P>
<PRE>    CHOOSE function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 gpf garbage 004F:2FC8 module excel.exe
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
