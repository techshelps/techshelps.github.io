

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Creating a Two-Dimensional Lookup Table in Microsoft Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76428 ">
<META NAME="KBModify" CONTENT="1995/10/16">
<META NAME="KBCreate" CONTENT="1991/09/24">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  A two-dimensional lookup table is one in which the desired value depends on two different variables. The following formula finds a value in a table, based on two lookup values:     =INDEX(Data_Table,MATCH(Row_Val,Row_Headers),MATCH(Col_Val,Col_Head...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAHH,QAKD,QA28,QATJ,QAKC,QBXN,QAE1,QA5V,QAB9,QAHG,QDMN,QAY5,QAUD,QAEN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Creating a Two-Dimensional Lookup Table in Microsoft Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76428 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for OS/2, versions 2.2, 2.21, 3.0
<LI>Microsoft Excel for the Macintosh version 2.x, 3.0, 4.0, 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A two-dimensional lookup table is one in which the desired value depends on
two different variables. The following formula finds a value in a table,
based on two lookup values:
<P>
<PRE>   =INDEX(Data_Table,MATCH(Row_Val,Row_Headers),MATCH(Col_Val,Col_Headers))

</PRE>This formula works well in cases where using the Intersection operator
(space) will not work (for example, when lookup values are numbers or
do not match row and/or column headings exactly).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<PRE>   This variable  Should be substituted with this range or value
   -------------------------------------------------------------

   Data_Table     The range containing the entire source table,
                  including column and row headers.

   Row_Val        The value to look up in the row headers.

   Row_Headers    The row headers; this should be the left column of
                  Data_Table.

   Col_Val        The value to look up in the column headers.

   Col_Headers    The column headers; this should be the top row of
                  Data_Table.

</PRE>NOTE: Both column and row headers must be sorted in ascending order to use
this formula. Note also that either the column or row headers can specify a
range of values, rather than a single value. However, to specify a range,
the header must use the minimum number in that column (for example, the
header for a column that specifies the range 137-142 should be 137).
<P>
<P><h3>Example</h3>
 
<P>
The following is a two-dimensional table that displays the cost per
unit of several products. The cost per unit varies, depending on the
number of items ordered. Column A contains the Product Name. Row 1
contains the minimum number of items that must be purchased to obtain
the purchase price in that particular column:
<P>
<PRE>   A1:             B1: 1           C1: 10          D1: 100
   A2: MS Excel    B2: $395        C2: $350        D2: $300
   A3: Mouse       B3: $99         C3: $89         D3: $79
   A4: MS Project  B4: $695        C4: $610        D4: $500
   A5: Word        B5: $495        C5: $425        D5: $350

</PRE>Assume you want to find the unit price if you purchase 15 units of
MS Project. If you enter "MS Project" (without the quotation marks) into
cell A7 and the number 15 in cell A8, you can return the unit price by
entering the following formula:
<P>
<PRE>   =INDEX(A1:D5,MATCH(A7,A1:A5),MATCH(A8,A1:D1))

</PRE>This formula returns $610.
<P>
<P><h3>Example 2</h3>
 
<P>
To use the values in A8 and B8 to indicate the two values to be
cross-referenced on the table
<P>
<PRE>    A1:     B1:  1   C1:  2    D1:  3   E1:  4   F1:  5
    A2: 1   B2:  1   C2:  2    D2:  3   E2:  4   F2:  5
    A3: 2   B3:  2   C3:  4    D3:  6   E3:  8   F3: 10
    A4: 3   B4:  3   C4:  6    D4:  9   E4: 12   F4: 15
    A5: 4   B5:  4   C5:  8    D5: 12   E5: 16   F5: 20
    A6: 5   B6:  5   C6: 10    D6: 15   E6: 20   F6: 25
    A7:     B7:      C7:       D7:      E7:      F7:
    A8: 4   B8:  5   C8:       D8:      E8:      F8:

</PRE>use the following formula:
<P>
<PRE>   =INDEX(B2:F6,MATCH(A8,B1:F1,0),MATCH(B8,A2:A6,0))

</PRE>The result of this formula is 20.
<P>
If you want to look for the largest value less than or equal to the values
searched for (useful for a commission table, tax table, and so on), change
the zeros in the MATCH functions to ones.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the MATCH() and INDEX() functions, click the
Index tab in Microsoft Excel version 7.0 Help, type the following text
<P>
<PRE>   lookup functions

</PRE>click Display, and then double-click the "Lookup &amp; Reference Functions"
topic to go to that topic.
<P>
"Function Reference," version 4.0, pages 236-237, 267
"Microsoft Excel Function Reference," version 3.0, pages 127-128, 148
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21 3.0 3.00<BR>
4.0 4.00 5.00 7.00 Cross-Reference multiplication table commission sheet
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
