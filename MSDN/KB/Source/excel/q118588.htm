

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Explanation of ODBC Btrieve Data Source Settings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118588">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/07/25">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you install the Btrieve ODBC driver, the following section, named [btrieve], is added to your WIN.INI file:     [btrieve]    options=/m:64 /p:4096 /b:16 /f:20 /l:40 /n:40 /n:12    /t:c:\access\BTRIEVE.TRN  NOTE: The above line will be entered ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFS,QAB4,QA9E,QAAP,QABA,QBV8,QAU9,QAI5,QDL9,QBWQ,QBWO,QBWN,QBAO,QBWC,QA0B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Explanation of ODBC Btrieve Data Source Settings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118588</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you install the Btrieve ODBC driver, the following section, named
[btrieve], is added to your WIN.INI file:
<P>
<PRE>   [btrieve]
   options=/m:64 /p:4096 /b:16 /f:20 /l:40 /n:40 /n:12
   /t:c:\access\BTRIEVE.TRN

</PRE>NOTE: The above line will be entered as a single complete line of text.
<P>
The line in this section has several parameters, which are explained below.
<P>
<P><h3>Paramerter  What parameter specifies  Default value for parameter</h3>
 
<P>
<PRE>/m:         Memory size               32K (but it can range from 14K to
                                      64K)

/p:         Page size                 Maximum size is 4096 bytes

/b:         Pre-image buffer size     16K (but it can range from 1 to
                                      64)

/f:         Number of open files      20 (maximum is 255)

/l:         Number of multiple locks  20 (maximum is 255)

/n:         Number of files in a      12 (but it can range from 0 to 18)
            transaction

/t:         Location of the
            transaction filename

</PRE>When trying to connect to a BTRIEVE database, using MSQUERY, the following
error message may occur "Error in WIN.INI settings".
<P>
When presumably connected to the file, no table names show in the Add
Tables box.
<P>
These symptoms are usually caused by improper or missing parameters in the
[btrieve] section of the WIN.INI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you connect to a btrieve file using ODBC drivers in MSQUERY, the
following section is added to the WIN.INI file in your Windows directory:
<P>
[btrieve]
options=/m:64 /p:4096 /b:16 /f:20 /l:40 /n:12 /t:C:\BTRIEVE.TRN
<P>
Although these are the default option settings, you can change these
options using the following table as a guide. If the option you want to set
is not on the "options=" line, add the option and desired setting at the
end. The order in which the options are placed is not important.
<P>
When MSQUERY ODBC Drivers to connect to btrieve files, keep the following
considerations in mind:
<P>
- Btrieve data files must be in version 5.1x format.
<P>
- You must have the data definition files FILE.DDF and FIELD.DDF, which
<PRE>  tell MSQUERY the structure of your tables.  These files are created by
  Xtrieve or another .DDF file-building program.

</PRE>- You must have the Btrieve for Windows dynamic-link library WBTRCALL.DLL,
<PRE>  which isn't provided with Microsoft ODBC Drivers. This file is available
  with Novell Btrieve for Windows, Novell NetWare SQL, and some other
  products for Windows that use Btrieve.

</PRE>- If you're using Btrieve in a multiuser environment, you must use the same
<PRE>  transaction file (BTRIEVE.TRN) as other users on the network. To do this,
  set the transaction file name option (/t) in the [btrieve] section of
  your WIN.INI to point to the network location of BTRIEVE.TRN.

</PRE>Note that if the [Btrieve] section of the WIN.INI file is missing,
incorrect or incomplete you may receive one of the errors listed below.
<P>
When using the Microsoft ODBC 1.0 Btrieve driver, the error may read:
<P>
<PRE>   Win.ini [Btrieve] options wrong.

</PRE>When using the Microsoft ODBC 2.0 Btrieve Driver, the error may read:
<P>
<PRE>   Error encountered while using the Btrieve DLL.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 5.00 msquery
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
