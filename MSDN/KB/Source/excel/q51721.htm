

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting PARSE to Guess in an Excel Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51721 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/12/07">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel 2.x and 3.0  The Data Parse command has a guess feature that, when activated, makes an intelligent guess as to where the breaks should be made in the parse data. The macro-equivalent command, PARSE, has no such option. The following...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDNU,QAH4,QA63,QBV8,QAY5,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Getting PARSE to Guess in an Excel Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51721 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, versions 2.2, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h3>Microsoft Excel 2.x and 3.0</h3>
 
<P>
The Data Parse command has a guess feature that, when activated, makes an
intelligent guess as to where the breaks should be made in the parse data.
The macro-equivalent command, PARSE, has no such option. The following
macro code segment takes the active cell or cells and parses them using
Excel's guess feature:
<P>
<PRE>   =SEND.KEYS("%(g)~")
   =PARSE?()

</PRE>The PARSE? command can be used to bring up the standard Data Parse dialog
box. Using the SEND.KEYS("%(g)~") command places the key sequence ALT+G,
ENTER into the Windows keyboard buffer. When PARSE? is executed, the
keyboard buffer is polled for the next available piece of information.
Because the ALT+G, ENTER sequence is already in the keyboard buffer, no
dialog box is displayed, but the guess feature is executed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Excel 4.0</h3>
 
<P>
Microsoft Excel version 4.0 has the ability to guess built-in, so the
SEND.KEYS workaround is not needed in an Microsoft Excel version 4.0 macro.
<P>
To say that this problem has been fixed in version 4.0 is somewhat
misleading. You cannot force the Parse function to guess again once you
have used it. In other words, once you use the function it will attempt to
revert to the guess it made when it was first used, for all subsequent
uses. You cannot force it to make a new guess in the same session, even if
you leave the parse_text (delimiter) argument blank.
<P>
It is true that when you leave the parse_text (delimiter) argument blank,
it forces Microsoft Excel to guess. However, that in itself is not what the
guess button does. When you do a Data Parse manually, Microsoft Excel will
always guess on the first parse. The guess button is only used on
subsequent parses in the same session, when the delimiter has changed and
you need Microsoft Excel to render a new guess. The Guess button is really
a "Guess Again" button. Unfortunately, the Parse function has no argument
to force Microsoft Excel to guess again, so you still must use this
workaround.
<P>
<P><h3>Microsoft Excel 5.0</h3>
 
<P>
The information above also applies to Microsoft Excel version 5.0 only when
using version 4.0 macro language. The preferred method, however, is to use
the text-to-columns function.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, page 314
"Microsoft Excel Function Reference," version 3.0, page 175
"Microsoft Excel Functions and Macros," version 2.x, page 327
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21<BR>
3.0 3.00 4.0 4.00 5.0 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
