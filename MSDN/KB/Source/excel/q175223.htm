

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Visual Basic Procedure Halts on Workbooks.Open </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175223">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/10/16">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you run a Visual Basic for Applications Sub procedure that opens a workbook, the procedure may halt before all the code in the Sub procedure is executed.  NOTE: When the Sub procedure halts, Microsoft Excel is in  design mo...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAQT,QBVP,QA4B,QBWS,QBS0,QAMN,QBQU,QBJZ,QACI,QAGS,QAMR,QAGC,QAGB,QAB9 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Visual Basic Procedure Halts on Workbooks.Open</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175223</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you run a Visual Basic for Applications Sub
procedure that opens a workbook, the procedure may halt before all the code
in the Sub procedure is executed.
<P>
NOTE: When the Sub procedure halts, Microsoft Excel is in "design mode."
All code in the macro before the code that opens the workbook is executed.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when the following conditions are true:

<UL><LI>You assign a shortcut key to the macro.
<P>
<P><PRE>    -and-
</PRE>
<LI>You press the shortcut key to run the macro.
<P>
<P><PRE>    -and-
</PRE>
<LI>The SHIFT key is part of the shortcut key (for example, CTRL+SHIFT+A).
<P>
<P><PRE>    -and-
</PRE>
<LI>The macro code opens a workbook by using the Open method (for example,
   Workbooks.Open).
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, remove SHIFT from the macro shortcut key
combination when the code includes Workbooks.Open. To change the shortcut
key for a macro, follow these steps:

<OL><P><LI>Start Microsoft Excel and open the workbook that contains the macro.

<P><LI>Point to Macro on the Tools menu, and then click Macros.

<P><LI>Click the macro name in the list and click Options.

<P><LI>In the Shortcut Key box, type a letter without holding down SHIFT.

<P><LI>Click OK, and then click Cancel.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the products listed above.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P>
To assign a shortcut key to a macro, follow these steps:

<OL><P><LI>On the Tools menu, point to Macro, and then click Macros.

<P><LI>In the Macro name box, enter the name of the macro you want to assign
   to a shortcut key.

<P><LI>Click Options.

<P><LI>To run the macro by pressing a shortcut key, type a letter in the
   Shortcut Key box.
<P>
   You can use CTRL+&lt;letter&gt; or CTRL+SHIFT+&lt;letter&gt; where &lt;letter&gt; is any
   letter key on the keyboard. The shortcut key overrides any default
   Microsoft Excel shortcut key assignments while the workbook that
   contains the macro is open.

<P><LI>Click OK, and then click Cancel.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbwontfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
