

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Custom Data Form from a Macro in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73387 ">
<META NAME="KBModify" CONTENT="1994/11/04">
<META NAME="KBCreate" CONTENT="1991/06/24">
<META NAME="Keywords" CONTENT="kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The custom data form in Microsoft Excel is limited to two types of dialog items: static text and edit boxes.  If you want to include other types of items, such as list boxes or option buttons, you must create a macro to duplicate the function of th...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAZV,QBVP,QA5V,QAB9,QA01,QAY2,QAYY,QAUJ,QAUD,QASR,QBWS,QBXS,QAE1,QAHP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Creating a Custom Data Form from a Macro in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 4, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73387 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0
<LI>Microsoft Excel for OS/2, versions 2.2 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The custom data form in Microsoft Excel is limited to two types of
dialog items: static text and edit boxes.
<P>
If you want to include other types of items, such as list boxes or
option buttons, you must create a macro to duplicate the function of
the data form. This article describes a basic macro that allows you to
add records to an existing database using a custom dialog box, which
acts as a custom data form. To use this macro, you must have a working
knowledge of creating and using dialog boxes and have a worksheet with
a defined database on it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The macro is listed below with an explanation of each step following.
<P>
Warning: Read through this article before attempting to type this
macro because the macro will need to be adjusted to fit your
individual needs.
<P>
<P><h3>Sample Macro</h3>
 
<P>
A1:  Custom_Form
A2:  =IF(ISERR(GET.NAME("!Database")),ALERT("Database not defined",3))
A3:  =IF(ISERR(GET.NAME("!Database")),GOTO(A8))
A4:  =DIALOG.BOX(dialog_ref)
A5:  =IF(A4=FALSE,GOTO(A8))
A6:  =FORMULA(initresult,OFFSET(!Database,ROWS(!Database),N,1,1))
.
.     (similar FORMULA statements)
.
A7:  =DEFINE.NAME("Database",OFFSET(!Database,0,0,ROWS(!Database)+1,
<PRE>       COLUMNS(!Database)))
</PRE>A8:  =RETURN()
<P>
<P><h3>Explanation</h3>
 

<OL><P><LI>Steps A2 and A3 check to see whether or not there is a database
   defined on the active worksheet. If there is not, an alert message
   is displayed and the macro is halted.

<P><LI>Step A4 displays the dialog box or custom data form, and allows
   you to enter information for a new record for the database. The
   name "dialog_ref" refers to the seven-column dialog definition
   table on your macro sheet.

<P><LI>Step A5 tests to see whether the Cancel button was chosen in the
   dialog box. If so, the macro is halted.

<P><LI>Step A6, and all Formula statements following it, enter your new
   record into the defined Database on your worksheet. You should have
   as many Formula statements as you have field names in your
   database. "Initresult" is a reference (for example, J12) and refers
   to the first item in the Init/Result column of "dialog_ref" that
   you want placed in the database. "N" represents the column number
   in your database (beginning with zero) in which you want each item
   placed. For example, if "N" is replaced with 1 in the FORMULA
   function above, the item will be placed in the second column of
   your database.

<P><LI>Step A7 renames your database to include the new record.
<P>
</OL>After creating the macro, select cell A1 (or the first cell of your
macro), choose Define Name from the Formula menu and choose the
Command button. Choose OK. You need to run this macro from the
worksheet. You can run the macro by choosing Run from the Macro menu
and selecting the macro from the list, or by using a hot key that you
have assigned to the macro (see the dialog box that appears when you
choose Define Name from the Formula menu).
<P>
Another option for using your custom data form is to modify the Data
Form command in Microsoft Excel so that it runs your Custom Data Form
macro. To do this, you should create and define the name "Auto_open"
on your worksheet so that it refers to a macro similar to the
following:
<P>
<PRE>   A13:  =DELETE.COMMAND(1,"Data","Form...")
   A14:  =ADD.COMMAND(1,"Data",A17:B17,1)
   A15:  =RETURN()

   A17:  Custom_Form                          B17:  R1C1

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide," for Windows and OS/2, version 3.0,
pages 348-368, 624-640
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbmacro<BR>
KBSubcategory:
<P>

Additional reference words: 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21 3.0<BR>
3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 4, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
