

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: "Error in Parameter 1" When Working with PivotTable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181287">
<META NAME="KBModify" CONTENT="1998/02/18">
<META NAME="KBCreate" CONTENT="1998/02/17">
<META NAME="Keywords" CONTENT="xlpivot xlquery">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you work with a PivotTable in Microsoft Excel 98 Macintosh Edition, you may receive the following error messages:     [INTERSOLV][ODBC dBase driver]Database does not allow negative scale    values. Error in parameter 1.      -and-     Problems...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QBWS,QAB4,QBVU,QBVP,QBVV,QAKP,QDI1,QABM,QAYY,QAPF,QAAP,QBWA,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: "Error in Parameter 1" When Working with PivotTable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181287</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you work with a PivotTable in Microsoft Excel 98 Macintosh Edition,
you may receive the following error messages:
<P>
<PRE>   [INTERSOLV][ODBC dBase driver]Database does not allow negative scale
   values. Error in parameter 1.

    -and-

   Problems obtaining data.

    -and-

   PivotTable is not valid.

</PRE>When these messages appear, the PivotTable is corrupted or damaged.
<P>
To see an example of this problem, see the "More Information" section in
this article.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when the following conditions are true:

<UL><LI>You create a PivotTable that uses external data that is stored in a
   dBASE table.
<P>
<P><PRE>    -and-
</PRE>
<LI>The PivotTable contains one or more page fields.
<P>
<P><PRE>    -and-
</PRE>
<LI>One or more of the page fields refer to numeric fields in the dBASE
   table.
<P>
<P><PRE>    -and-
</PRE>
<LI>You have set the page fields as server page fields.
<P>
</UL>Specifically, these problems occur because the dBASE ODBC driver included
with Microsoft Excel 98 Macintosh Edition does not support the use of
parameterized queries of numeric fields in dBASE tables under certain
circumstances.
<P>
When you use a server page field, Microsoft Excel uses a parameterized
query to query the external database and retrieve the proper data; because
the dBASE ODBC driver does not always support this functionality, the
operation fails, and you receive the error messages described in this
article.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, remove and recreate the PivotTable; it is not
possible to repair the damaged PivotTable.
<P>
To prevent this problem from occurring, use the workaround in the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q179700.htm">Q179700</A></B>
   TITLE     : XL98: "Out of Range" Error Running Parameter Query in MS
               Query

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem does NOT occur if the following is true:

<UL><LI>The external database is not a dBASE table.
<P>
<P><PRE>    -or-
</PRE>
<LI>The field in the table is not a numeric field.
<P>
   For example, the field is a text field.
<P>
<P><PRE>    -or-
</PRE>
<LI>You do not set the page field to act as a server page field.
<P>
</UL><h3>Example</h3>
 
<P>
To see an example of this problem, follow these steps:

<OL><P><LI>In Microsoft Excel 98 Macintosh Edition, create a new workbook. Select
   cell A1 in Sheet1.

<P><LI>On the Data menu, click PivotTable Report.

<P><LI>In the Step 1 dialog box, click External Data Source and click Next.

<P><LI>In the Step 2 dialog box, click Get Data.
<P>
<P><PRE>    a. In the Choose Data Source dialog box, click "&lt;New Data Source&gt;".
       Click OK.
</PRE><P>
<P><PRE>    b. In the first box, type "Test" (without the quotation marks). In the
       list box, click Microsoft 3.01 dBASE PPC. Click Connect.
</PRE><P>
<P><PRE>    c. Select the following folder:
</PRE><P>
<PRE>          Microsoft Office 98:Sample Files:Sample Databases

       Then, click the 'Select "Sample Databases"' button.

    d. Click OK. Click to select the Use The Query Wizard check box. Then,
       click OK again.

    e. In the list of tables and columns, click ORDERS. Click the "&gt;"
       button. Then, click Next.

    f. Click Next twice more. Then, click "Return Data to Microsoft
       Excel," and click Finish.

</PRE><P><LI>In the Step 2 dialog box, click Next.

<P><LI>In the Step 3 dialog box, drag the ORDER_AMT field to the PAGE area.
   Drag the CUSTOMER_ID field to the ROW area. Drag the EMPLOY_ID field
   to the DATA area. Then, click Next.

<P><LI>In the Step 4 dialog box, click Finish.
<P>
   The PivotTable appears in the worksheet.

<P><LI>Click the ORDER_AMT field in cell A1. On the PivotTable toolbar, point
   to the PivotTable menu and click Field. Click Advanced. Click Query
   External Data Source. Click OK twice.
<P>
</OL>You receive the following error message:
<P>
<PRE>   [INTERSOLV][ODBC dBase driver]Database does not allow negative scale
   values. Error in parameter 1.

</PRE></OL>When you click OK, you receive the following error message:
<P>
<PRE>   Problems obtaining data.

</PRE>If you select an item in the ORDER_AMT page field or if you perform any
other action in the PivotTable, you receive the following error message:
<P>
<PRE>   PivotTable is not valid.

</PRE>For more information about using server page fields in PivotTables, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q179297.htm">Q179297</A></B>
   TITLE     : XL98: Using Server Page Fields in PivotTables
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98<BR>
Keywords          : xlpivot xlquery<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
