

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Using NPV() or Solver to Find Guess for IRR() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100331">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/06/20">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if the IRR() function cannot find a solution that is accurate within .00001 percent after 20 iterations, a #NUM! error value is returned. If you specify a guess, the iterations start with that value; if the guess argument is omi...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAKD,QBVP,QAB9,QALE,QAY5,QAL3,QALA,QAK9,QAAP,QAPN,QBV8,QALW,QDNZ,QAV1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using NPV() or Solver to Find Guess for IRR()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, versions 2.x, 3.0
<LI>Microsoft Excel 98 Macintosh Edition 
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, if the IRR() function cannot find a solution that
is accurate within .00001 percent after 20 iterations, a #NUM! error
value is returned. If you specify a guess, the iterations start with
that value; if the guess argument is omitted, it is assumed to be 10
percent. If you receive a #NUM! error value and are unsure of what the
guess should be, you can use the NPV() function to determine at what
interest rate the formula result is closest to zero.
<P>
The following methods also work by using XIRR() and XNPV().
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The net present value and the internal rate of return for a given
investment are closely related calculations. The internal rate of
return is equal to the interest rate at which the net present value is
zero. The following formula shows how you can express the relationship
between these two calculations with the NPV() and IRR() functions:
<P>
<PRE>    NPV(IRR(array),array)=0

</PRE>In this formula, IRR() may return a #NUM! error value if your array
contains very large cash flows combined with cash flows that are very
small by comparison. IRR() takes two arguments: array (required) and
guess (optional). If IRR() returns a #NUM! error value, you must specify a 
guess. To narrow the range, you can either substitute random values or you 
can use NPV().
<P>
For example, if you have a table with the following cash flows and
IRR() formula
<P>
<PRE>   A1: ($100)
   A2:    $1
   A3:    $1
   A4:    $5
   A5:   $10
   A6: =IRR(A1:A5)

</PRE>without a guess, the formula in cell A6 returns a #NUM! error value.
To determine a close guess, use NPV() either by itself or in conjunction 
with Microsoft Solver.
<P>
NOTE: You can also use NPV() and Microsoft Solver to check the result
of your IRR() function if you think it is incorrect.
<P>
<P><h3>Using NPV()</h3>
 
<P>
The NPV() function takes an interest rate and an array argument. For
the array, use the cash flows the IRR() is based on (A1:A5) and for
the interest rate, use a range of guessed rates of return. Given the
data, it's reasonable to assume that the internal rate of return is
negative, so begin with the percentages in B1:B6. The Formula column
shows the formula to enter in C1:C6 and the Result column shows what
that formula returns.
<P>
<PRE>               Formula                   Result
   ----------------------------------------------

   B1: -50%    C1: =NPV(B1,$A$1:$A$5)    C1: $212
   B2: -40%    C2: =NPV(B2,$A$1:$A$5)    C2:   $8
   B3: -30%    C3: =NPV(B3,$A$1:$A$5)    C3: ($58)
   B4: -20%    C4: =NPV(B4,$A$1:$A$5)    C4: ($79)
   B5: -10%    C5: =NPV(B5,$A$1:$A$5)    C5: ($84)
   B6:   0%    C6: =NPV(B6,$A$1:$A$5)    C6: ($83)

</PRE>The NPV() goes to zero somewhere between C2 and C3 which use interest
rates of -40% and -30% respectively. Since the result in C2 is closer
to zero, enter -40% into the IRR() formula in cell A6 so that it
resembles the following example:
<P>
<PRE>   =IRR(A1:A5,-.40)

</PRE>The result of this formula is 39%.
<P>
<P><h3>Using NPV() and Microsoft Solver</h3>
 
<P>
Rather than enter a range of percentages to compute the NPV(), you can
also enter one guess percentage and the formula and then use Microsoft
Solver to calculate the result.
<P>
For example, use the following data:
<P>
<PRE>   B1: -50%    C1: =NPV(B1,$A$1:$A$5)

</PRE>To calculate NPV, follow these steps:

<OL><P><LI>On the Tools menu (Formula menu in versions 4.0 and earlier), click
   Solver.

<P><LI>In the Set Target Cell box, enter $C$1.

<P><LI>In the Equal To box, select the Value Option. In the Of box, enter 0.

<P><LI>In the By Changing Cells box, enter $B$1.

<P><LI>Click Solve.
<P>
</OL>As with the previous method, Microsoft Solver finds a solution at -39%. 
This value is displayed in cell B1. You are then given the option to keep 
or discard the solution.
<P>
<P><h3>Checking your Result with Solver</h3>
 
<P>
To check the result of your IRR() function, use NPV() with a blank
cell as your first argument and the data range you used for your IRR()
function as the second argument. For example if you use the following
sample data
<P>
<PRE>   A1: -100            B1:      C1: =NPV(B1,$A$1:$A$4)
   A2:   20
   A3:   30
   A4:   75
   A5: =IRR($A$1:$A$4)

</PRE></OL>the IRR() function returns 10%. To determine if this is correct,
click Solver on the Formula menu. In Set Target Cell, enter $C$1; in
Equal To, select Value and in Of, enter 0. In By Changing Cells, enter $B$1
and click Solve. Microsoft Solver returns 10% in cell B1. You can
then choose to keep or discard the solution.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," pages 247, 291-292
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.10 2.10c 2.10d 2.20 2.21 3.00 4.00 4.00a 5.00<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS: 2.0, 3.0, 4.0, 4.0a, 5.0; MACINTOSH: 2.0, 3.0, 4.0, 5.0, 98<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
