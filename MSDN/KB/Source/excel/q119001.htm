

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Run-time Error 1004 or 1006 Using ATP Worksheet Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119001">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/08/04">
<META NAME="Keywords" CONTENT="kbtool xlwin">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use one of the Analysis ToolPak worksheet functions, one of the following occurs:   - You receive either of the following error messages:        Run-time error '1004':       Run Method of Application class failed       ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAY5,QAAP,QBS0,QBVP,QA5F,QAMA,QBV8,QAB9,QAUD,QAKD,QAH0,QAKP,QBVV,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Run-time Error 1004 or 1006 Using ATP Worksheet Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119001</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use one of the Analysis ToolPak worksheet
functions, one of the following occurs:

<UL><LI>You receive either of the following error messages:
<P>
<P><PRE>      Run-time error '1004':
      Run Method of Application class failed
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      Run-time error '1006':
      Unable to get the ThisWorkbook property of the Application class
</PRE><P>
   -or-

<LI>The function returns the #VALUE! error value.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These symptoms occur if the workbook that contains the function also
contains a module sheet that references the Analysis ToolPak -- Visual
Basic for Applications add-in file, ATPVBAEN.XLA.
<P>
The error messages occur when you use one of the following worksheet
functions:
<P>
<PRE>   EDATE()
   EOMONTH()
   IMSUM()
   NOMINAL()
   TBILLEQ()
   TBILLPRICE()
   TBILLYIELD()

</PRE>You receive the run-time error '1004' if the Analysis ToolPak-Visual Basic
for Applications add-in is also loaded (selected in the Add-ins dialog
box). If the Analysis ToolPak-Visual Basic for Applications is not loaded,
you receive the run-time error '1006.'
<P>
Note that the functions IMSUM() and NOMINAL() return the #VALUE! error
value if the Analysis ToolPak--VBA add-in is not loaded.
<P>
The following functions return the #VALUE! error value whether the Analysis
ToolPak-Visual Basic for Applications add-in is loaded or not:
<P>
<PRE>   GCD()
   LCM()
   MULTINOMIAL()
   IMPRODUCT()
   CUMIPMT()
   CUMPRINC()

</PRE>Note that this behavior also occurs if you use the FunctionWizard to
insert the function.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid receiving these error messages when you use one of the
Analysis ToolPak worksheet functions, include the reference to the
add-in file with the function name as in the following examples:
<P>
<PRE>   =ANALYSF.XLA!EDATE("1/1/94",5)

   =ANALYSF.XLA!NOMINAL("1/1/94",5)

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q118797.htm">Q118797</A></B>
   TITLE     : "Cannot Find" Using Analysis ToolPak Visual Basic Function

   ARTICLE-ID: <B><A HREF="../EXCEL/Q118799.htm">Q118799</A></B>
   TITLE     : XL5: "Argument Not Optional" Using Visual Basic ATP
               Functions

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory: xlwin
<P>

Additional reference words: 5.00 addins atp err msg toolpack
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
