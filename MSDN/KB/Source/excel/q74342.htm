

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Changing the Default Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74342 ">
<META NAME="KBModify" CONTENT="1995/08/25">
<META NAME="KBCreate" CONTENT="1991/07/16">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, there are various methods to change the default directory in which Microsoft Excel starts. Microsoft Excel will normally start up with the directory to which you installed Microsoft Excel as the active directory, but you may wan...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAFI,QBXB,QATJ,QAH4,QBJZ,QBXS,QBWS,QAUD,QAY2,QABA,QAPN,QAG2,QAGU,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Changing the Default Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74342 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, there are various methods to change the default
directory in which Microsoft Excel starts. Microsoft Excel will normally
start up with the directory to which you installed Microsoft Excel as the
active directory, but you may want to change this default to a specified
directory. You can check the current default directory by choosing Open
from the File menu after starting the Microsoft Excel program. The current
directory is listed after "Directory is..."
<P>
<P><h3>Microsoft Excel Version 3.0</h3>
 
<P>
Modify Program Icon Properties:

<OL><P><LI>Verify that the directory containing EXCEL.EXE is in the path
   statement of your AUTOEXEC.BAT file.

<P><LI>From the Program Manager, select the Microsoft Excel icon and
   choose Properties from the File menu.

<P><LI>Type the path of the desired directory in the Command Line text box,
   followed by "\excel.exe" (without the quotation marks).
<P>
   For example, type the following:
<P>
<P><PRE>      c:\user\excel.exe
</PRE>
<P><LI>The error message "The specified path is invalid" will appear.
   Choose OK to bypass this message.
<P>
</OL>Microsoft Excel will now start with the specified directory as the default
drive and directory. This method changes the icon from the standard
Microsoft Excel icon to a MS-DOS icon. To correct this, do the following:

<OL><P><LI>Select the icon once again in the Program Manager. From the File
   menu, choose Properties.

<P><LI>Choose the Change Icon button.

<P><LI>Type the correct path for the EXCEL.EXE file (for example,
   c:\excel\excel.exe) and press the ENTER key.
<P>
</OL>You will see the message "The specified path is invalid" once again.
However, you can ignore it at this point and everything will still
work properly.
<P>
If you are using Windows 3.1, you can change the Working Directory from
within Program Manager. From the File menu, choose Properties and type the
path in the Working Directory field box.
<P>
<P><h3>Microsoft Excel Versions 3.0 and 4.0 Only</h3>
 
<P>
Create An Add-In:
<P>
<PRE>   A1: DEFAULT_DIR
   A2: =DIRECTORY("C:\USER")
   A3: =RETURN()

</PRE><P><LI>Enter the above macro into a macro sheet. Select cell A1. Define
   this macro as an Auto_Open macro by choosing Define Name from the
   Formula menu, entering "auto_open" (without the quotation marks)
   in the Name box, and selecting the Command button. Choose OK.

<P><LI>Save the macro as an add-in macro in the XLSTART directory by
   choosing Save As from the File menu, choosing Options, and
   selecting Add-In from the list. Choose OK. For the filename, enter
   the path to the XLSTART directory, followed by the filename (for
   example, c:\excel\xlstart\defltdir.xla).
<P>
</OL>Documents that are saved in the XLSTART directory are automatically opened
when the Microsoft Excel program is started. Because this macro sheet is
saved as an add-in macro, it will open as hidden. You are unable to view
it, even by choosing the Window Unhide command. However, the macro will run
because it has been saved as an Auto_Open macro.
<P>
<P><h3>Microsoft Excel Versions 2.x, 3.x, and 4.x</h3>
 
<P>
Create an Auto_Open Macro:

<OL><P><LI>Open a new macro sheet. Choose Save As from the File menu and enter
   "c:\changedi.xlm" (or any valid path and filename, without the
   quotation marks) in the File Name box. Choose OK.

<P><LI>Enter the following macro into the macro sheet:
<P>
<P><PRE>      A1: Auto_Open
      A2: =DIRECTORY("C:\USER")
      A3: =NEW()
      A4: =RETURN()
</PRE><P>
   The =DIRECTORY statement will set the current drive to the path
   described in the pathname. The =NEW command will open up a blank
   worksheet.

<P><LI>Define the macro as an Auto_Open macro by doing the following:
<P>
   a. Select cell A1.
   b. From the Formula menu, choose Define Name.
   c. Choose the Command button.
   d. Choose OK.

<P><LI>In Notepad (or another text editor), open the EXCEL.INI file (version
   3.0) or the EXCEL4.INI file (version 4.0). This file is located in the
   WINDOWS directory. Scroll down to the [Microsoft Excel] heading and add
   the following line below the heading:
<P>
<P><PRE>      open=c:\changedr.xlm
</PRE><P>
</OL>This causes CHANGEDR.XLM to open every time Microsoft Excel is started.
<P>
Use /p Startup Switch:
<P>
You can specify a default working directory by using the "/p" startup
switch. For more information, refer to the "User's Guide."
<P>
<P><h3>Microsoft Excel Version 4.x Only</h3>
 
<P>
You can add an OPEN= statement in the [Microsoft Excel] section of your
EXCEL4.INI file and use the /p option. This option specifies a directory to
be used as the default directory from which documents are opened and to
which documents are saved. Enter this option to the right of the equal sign
in the OPEN= statement.
<P>
<P><h3>Microsoft Excel Version 4.0a Only</h3>
 
<P>
You can add the line "OpenDir=&lt;path&gt;" to the EXCEL4.INI to set the working
directory. This option overrides the icon properties working directory
information and command line switches.
<P>
<P><h3>Microsoft Excel Version 5.0</h3>
 
<P>
For information about changing the working directory in Microsoft Excel
version 5.0, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q110209.htm">Q110209</A></B>
   TITLE     : XL5: Hierarchy of Methods to Change the Working Directory

</PRE></OL><h3>Microsoft Excel Version 7.0</h3>
 
<P>
For information about setting the default file location in Microsoft Excel
version 7.0, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q135474.htm">Q135474</A></B>
   TITLE     : XL7: Starting Microsoft Excel with a Different Working
               Folder

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Windows User's Guide," version 3.1, pages 79-81
"Microsoft Windows User's Guide," version 3.0, pages 89-91
"Microsoft Excel User's Guide 1," version 4.0, pages 79-80, 292
"Microsoft Excel User's Guide," version 3.0, pages 553, 651
"Microsoft Excel Reference Guide," version 2.1, pages 209-211
"Microsoft Excel Functions and Macros," version 2.1, pages 270, 353
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory: xlwin
<P>

Additional reference words: 2.00 2.01 2.10 2.20 2.21 3.00 4.00 4.00a<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 25, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
