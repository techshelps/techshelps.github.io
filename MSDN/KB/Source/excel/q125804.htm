

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MXL5: Run-Time Error '1004' or '1006' Using ATP Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125804">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/02/06">
<META NAME="Keywords" CONTENT="xlmac kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use one of the Analysis ToolPak worksheet functions, you may receive one of the following error messages:     Run-time error '1004':    Run Method of Application class failed     -or-     Run-time error '1006':    Unabl...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBVP,QBJZ,QAY5,QA5F,QAMA,QABI,QAAP,QABH,QBWS,QBV8,QAB9,QAPN,QAEF,QAJX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MXL5: Run-Time Error '1004' or '1006' Using ATP Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125804</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use one of the Analysis ToolPak worksheet
functions, you may receive one of the following error messages:
<P>
<PRE>   Run-time error '1004':
   Run Method of Application class failed

   -or-

   Run-time error '1006':
   Unable to get the ThisWorkbook property of the Application class

</PRE><h2>CAUSE</h2>
 
<P>
These symptoms occur if the workbook that contains the function also
contains a module sheet that references the Analysis ToolPak-Visual Basic
for Applications add-in file.
<P>
The error messages occur when you use one of the following worksheet
functions:
<P>
<PRE>   EDATE()
   EOMONTH()
   IMSUM()
   NOMINAL()
   TBILLEQ()
   TBILLPRICE()
   TBILLYIELD()
   GCD()
   LCM()
   MULTINOMIAL()
   IMPRODUCT()
   CUMIPMT()
   CUMPRINC()
   BESSELI()
   BESSELJ()
   BESSELK()
   BESSELY()

</PRE>You receive the run-time error '1004' if the Analysis ToolPak-Visual Basic
for Applications add-in is also loaded (selected in the Add-ins dialog
box). If the Analysis ToolPak-Visual Basic for Applications is not loaded,
you receive the run-time error '1006.'
<P>
Note that this behavior also occurs if you use the FunctionWizard to insert
the function.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid receiving these error messages when you use one of the Analysis
ToolPak worksheet functions, use either of the following methods:
<P>
<P><h3>Method 1</h3>
 
<P>
Move the Visual Basic module that references the Analysis ToolPak-Visual
Basic for Applications file to another workbook that does not contain a
worksheet that uses an Analysis ToolPak worksheet function.
<P>
<P><h3>Method 2</h3>
 
<P>
Clear the Analysis ToolPak check box in the Add-Ins dialog box and restart
Microsoft Excel. To do this, use the following steps:

<OL><P><LI>On the Tools menu, click Add-Ins, and clear the Analysis ToolPak check
   box.

<P><LI>Verify that the Analysis ToolPak--VBA check box is selected, and click
   OK.

<P><LI>Save your work if necessary, click Quit on the File menu, and restart
   Microsoft Excel.
<P>
</OL>NOTE: In order to successfully use the Analysis ToolPak function in the
worksheet, you must also click the module sheet,click References on the
Tools menu, select Analysis ToolPak--VBA and click OK.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 addins atp err msg toolpack<BR>
Keywords          : xlmac kbtool<BR>
Version           : MACINTOSH: 5.0, 5.0a<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
