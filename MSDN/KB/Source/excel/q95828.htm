

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Q+E: Excel Err Msg: SQL Statement Is Not Valid or DDE Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95828 ">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/02/25">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you try to execute an SQL query statement to extract data from an external database using the QE.XLA add-in macro in Microsoft Excel, the error message  SQL Statement Is Not Valid or DDE Error  may be generated if the external data type differ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QABM,QAP2,QAB4,QAPN,QA3P,QAAP,QBVV,QAZV,QAY2,QAYY,QAWM,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Q+E: Excel Err Msg: SQL Statement Is Not Valid or DDE Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95828 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Q+E for Microsoft Excel for Windows, version 3.0, 3.0a
<LI>Q+E for Microsoft Excel for OS/2, version 3.0
<LI>Microsoft Excel for Windows, versions 3.0 and 4.0
<LI>Microsoft Excel for OS/2, versions 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you try to execute an SQL query statement to extract data from an
external database using the QE.XLA add-in macro in Microsoft Excel,
the error message "SQL Statement Is Not Valid or DDE Error" may be
generated if the external data type differs from the default data type
set in Q+E.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With the QE.XLA add-in macro loaded, SQL query statements can be used
to extract data from external databases into a Microsoft Excel
worksheet. Activating the Query Editor by choosing the SQL Query
command on the Data menu allows SQL queries to be entered, executed,
and saved as query files (.QEF) in Microsoft Excel.
<P>
The error "SQL Statement Is Not Valid or DDE Error" may occur if the
SQL query or saved query file (.QEF) attempts to extract data from an
external database that is of a different type than the default data
type set in Q+E.
<P>
<P><h3>Workarounds</h3>
 

<UL><LI>Modify the SQL query to include the external database type followed
   by a pipe character (|). For example:
<P>
<P><PRE>      SELECT FIRST_NAME, LAST_NAME FROM dBASEFile|C:\EXCEL\QE\ADDR.DBF
</PRE>
<LI>Change the default data type in Q+E to match the database type in
   your SQL query statement. To do this, modify the [Q+E] section of
   the QE.INI file to include the initialization parameter
   CONNECT=&lt;File Type&gt;. For example:
<P>
<P><PRE>      CONNECT=dBASEFile
</PRE><P>
   You can also change the default data type in Q+E by rerunning the
   Q+E portion of the Microsoft Excel Setup program.
<P>
   Note: Versions of Q+E for Microsoft Excel for Windows prior to
   3.0a, dated 6/12/91, use the [Q+E] section of the WIN.INI file for
   initialization parameters, not the QE.INI file. The QE.INI file for
   Q+E for Microsoft Excel for OS/2 is saved as a binary file and
   cannot be modified.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide," version 3.0a, included with
Microsoft Excel version 3.0, pages 35-36, 66-67
<P>
"Q+E for Microsoft Excel User's Guide," version 3.0a, included with
Microsoft Excel version 4.0, pages 35-36, 66-67
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kberrmsg<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00 4.0 QE 4 4.0a 4.00a
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
