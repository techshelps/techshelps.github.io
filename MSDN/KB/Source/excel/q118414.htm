

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Macro Error Using GET.DOCUMENT(1) with Text File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118414">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/07/18">
<META NAME="Keywords" CONTENT="kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="   In Microsoft Excel, if you use the GET.DOCUMENT(1) function in a macro to return the name of the active document, for example to parse or process information in the file, you may receive a macro error if the file is in the Text, CSV, SYLK, or PRN ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QAUJ,QAY5,QAH4,QAXC,QBRZ,QAKJ,QBV8,QAAP,QAB9,QARM,QAJQ,QAB4,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Macro Error Using GET.DOCUMENT(1) with Text File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118414</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you use the GET.DOCUMENT(1) function in a
macro to return the name of the active document, for example to parse
or process information in the file, you may receive a macro error if
the file is in the Text, CSV, SYLK, or PRN file format.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you open a file in one of these formats, the worksheet name is
Sheet1, instead of the name of the document without the extension.
This may cause a macro that uses the name returned by the
GET.DOCUMENT(1) function to return a macro error.
<P>
The GET.DOCUMENT(1) function returns the name of the active sheet as
text, for example, "[Book1]Sheet1." However, when the worksheet has
the same name as the workbook, (minus the workbook file extension),
the GET.DOCUMENT(1) function returns the name of the file, such as
BOOK1.XLS. This behavior is equivalent to the behavior of the
GET.DOCUMENT(1) function in Microsoft Excel version 4.0.
<P>
Note that when you open a Microsoft Excel version 4.0 Worksheet file,
a Lotus 1-2-3 file, or a QuattroPro/DOS file, the worksheet has the
same name as the workbook file, and therefore the GET.DOCUMENT(1)
function returns the name of the file.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid receiving a macro error when you use the GET.DOCUMENT(1)
function in a macro to return the name of the document, do either of
the following:

<UL><LI>Rename the worksheet "Sheet1" to the name of the file, without the file
   extension. (Note that this must be done each time you open the file
   because the worksheet is given the name "Sheet1" each time you open the
   file)
<P>
   -or-

<LI>Use the GET.DOCUMENT(88) function to return the name of the document
   instead of the name of the worksheet.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about GET.DOCUMENT, choose the Search button in
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>   GET.DOCUMENT function

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 comma separated value print ascii<BR>
symbolic link sheet name
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
