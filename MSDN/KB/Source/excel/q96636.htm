

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel Err Msg: "Error Locating Support File..." with RANDOM() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96636 ">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/03/24">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can use the RANDOM() function (available in the Analysis ToolPak add-in macro), to generate a set of random numbers. When you use this function in a macro, if you leave any of the optional arguments (variables, points, or se...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKC,QAND,QBC6,QAKJ,QAG8,QBVP,QAH4,QBXS,QAPN,QAG2,QAHE,QBWS,QDMR,QAY5,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel Err Msg: "Error Locating Support File..." with RANDOM()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96636 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can use the RANDOM() function (available in
the Analysis ToolPak add-in macro), to generate a set of random
numbers. When you use this function in a macro, if you leave any of
the optional arguments (variables, points, or seed) blank, you will
receive the following error message:
<P>
<PRE>   An error has occurred locating a support file or processing data
   for an add-in procedure.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Using the RANDOM() function in a macro produces the same results as
choosing Analysis Tools from the Options menu and selecting Random
Number Generation from the list of available tools. Using the Options
menu method, it is not necessary to specify a value in the Random Seed
box. Microsoft Excel still generates a set of random numbers.
<P>
In the RANDOM() function, the variables argument specifies the number
of columns in the output range, the points argument specifies the
number of rows in the output range, and the seed argument specifies an
offset value used in determining which random numbers to retrieve. You
must specify a value for each of these arguments when you use RANDOM()
in a macro.
<P>
<P><h3>Workaround</h3>
 
<P>
To work around this problem, specify the three following arguments for
the RANDOM() function:
<P>
<PRE>   For this argument Use this value
   -----------------------------------------

   Variables      COLUMNS(range)
   Points      ROWS(range)
   Seed     INT(RAND()*number) or any positive integer.

</PRE>The resulting formula will be
<P>
<PRE>   =RANDOM(cell,COLUMNS(range),ROWS(range),1,INT(RAND()*number),10,20)

</PRE>where "cell" is the upper left cell in the output range, range is the
reference or defined name of the area on the worksheet where you want
to place the random numbers, and number is the largest possible number
you want to use as a seed value.
<P>
Note: Using this formula, or a seed of 0, produces a different set of
numbers each time you run the macro; using a constant such as 10
produces the same set of numbers each time you run the macro.
<P>
The following sample macro demonstrates the use of the RANDOM()
function using 5 and INT(RAND()*10) for the seed argument:

<OL><P><LI>Enter the following information in your macro sheet:
<P>
   A1: Test
   A2: =RANDOM(OFFSET(ACTIVE.CELL(),0,0,5,2),2,5,1,5,10,20)
   A3: =RANDOM(OFFSET(ACTIVE.CELL(),6,0,5,2),2,5,1,
<PRE>        INT(RAND()*10),10,20)
   A4: =RETURN()

</PRE><P><LI>Select cell A1 and choose Define Name from the Formula menu. The
   word "Test" will appear in the Name box, and $A$1 will appear in
   the the Refers to box. Select the Command option in the Macro
   section, and choose the OK button.

<P><LI>From the File menu, choose New. Select Worksheet, and choose the
   OK button.

<P><LI>With cell A1 selected, choose Run from the Macro menu. Select the
   Test macro and choose the OK button. The macro will generate two
   groups of random numbers.

<P><LI>Select cell D1 on the worksheet and repeat Step 4.
<P>
</OL>Notice that the numbers in the top group in both cases are the same
while the numbers in the bottom group are different. This is a result
of using a constant versus a 0 or the RAND() function as the Seed
argument.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Online Help," version 5.0
"Function Reference," version 4.0, pages 345-346
"User's Guide 2," version 4.0, pages 38-40
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kberrmsg<BR>
KBSubcategory:
<P>

Additional reference words: 4.00 4.00a 5.00 optional argument error random<BR>
analysis tool pack pak
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
