

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Solver Err Msg: Filename Is Not Valid, Cannot Find Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q70650 ">
<META NAME="KBModify" CONTENT="1995/08/08">
<META NAME="KBCreate" CONTENT="1991/03/26">
<META NAME="Keywords" CONTENT="kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you may receive the following error message when you run the Solver add-in:  Microsoft Excel version 5.0     Filename is not valid  Microsoft Excel version 4.0     Cannot find macro    ''C:\EXCEL\LIBRARY\SOLVER\SOLVER.XLA'!Stub'...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Solver Err Msg: Filename Is Not Valid, Cannot Find Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q70650 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 5.0
<LI>Microsoft Excel for the Macintosh, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, you may receive the following error message when you
run the Solver add-in:
<P>
<P><h3>Microsoft Excel version 5.0</h3>
 
<P>
<PRE>   Filename is not valid

</PRE><h3>Microsoft Excel version 4.0</h3>
 
<P>
<PRE>   Cannot find macro
   ''C:\EXCEL\LIBRARY\SOLVER\SOLVER.XLA'!Stub'

</PRE><h3>Microsoft Excel version 3.0</h3>
 
<P>
<PRE>   Filename is not valid

   Cannot find macro
   ''C:\EXCEL\XLSTART\SOLVER\SOLVER.XLA'!Stub'

</PRE>Note that the Solver command is located on the Tools menu in version 5.0,
and the Formula menu in versions 3.0 and 4.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
You receive this error message when your EXCEL5.INI (Microsoft Excel
version 5.0) EXCEL4.INI (Microsoft Excel version 4.0) or EXCEL.INI
(Microsoft Excel version 3.0) file contains incorrect path information for
the Solver add-in.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To load the Solver add-in macro, choose Open from the File menu and choose
the SOLVER.XLA file from the \excel\library\solver (Microsoft Excel
versions 4.0 and 5.0) subdirectory or from the \excel\xlstart\solver
(Microsoft Excel version 3.0) subdirectory.
<P>
To correct the path information for Solver in the EXCEL.INI, EXCEL4.INI or
EXCEL5.INI file, do the following:

<OL><P><LI>Close Microsoft Excel. Open the Microsoft Excel initialization file
   (EXCEL.INI, EXCEL4.INI, or EXCEL5.INI) in a text editor such as Notepad.

<P><LI>Locate the Solver setting in the [Init Commands] section. The line
   should appear as follows:
<P>
   [Init Commands]
   Solver=1,formula,sol&amp;ver..,'c:\excel\xlstart\solver\solver.xla!'stub'

<P><LI>Change this line to represent the correct path to the SOLVER.XLA
   add-in file.

<P><LI>Save the changes to the Microsoft Excel initialization file, and start
   Microsoft Excel again.
<P>
</OL>In Microsoft Excel for the Macintosh, remove the Excel Settings or Excel
Settings (4) file from the PREFERENCES FOLDER if you are using System 7.0
(or the SYSTEM FOLDER if you are using System 6.x).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbfasttip<BR>
KBSubcategory:
<P>

Additional Reference Words: 3.0 3.00 4.0 4.00 5.00 stub  addins<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
