

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using DB.SQL.QUERY with Type 2 Requires Double Single Quotes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q70067 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1991/03/09">
<META NAME="Keywords" CONTENT="qe.xla query fails qe kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA50,QAHH,QBVP,QA5V,QAFO,QA4F,QAUD,QAPF,QAP2,QDOR,QBBI,QATX,QBXS,QAMB,QBM2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using DB.SQL.QUERY with Type 2 Requires Double Single Quotes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q70067 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The command DB.SQL.QUERY(), provided by the add-in QE.XLA, allows you
to send SQL queries to Q+E. The query is executed by Q+E and the
results are returned to Excel.
<P>
When sending a query that contains a text comparison criteria, it is
necessary to place the criteria inside double single quotation marks.
(for example, ``NC''). Without the double single quotation marks, the
command will return #REF.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>DB.SQL.QUERY(type,query,destination,filename,linked)</h3>
 
<P>
The first argument, "type", is a number from 1 to 3 indicating
the type of query to be executed.

<UL><LI>Type 1 specifies that the previous query is to be executed.
<LI>Type 2 executes the text string specified by the argument "query".
<LI>Type 3 executes a query contained in the file specified by
   "filename".
<P>
</UL>If "type" is 2 and you use a WHERE clause to limit your extract to
only records that match certain criteria in the form of text, you must
enclose the text value in two sets of single quotation marks or two
sets of double quotation marks.
<P>
The following example:

<UL><LI>Initiates a DDE channel with Q+E
<LI>Activates Sheet1 in Excel
<LI>Selects all records in ADDR.DBF where the state is equal to "NC"
<LI>Pastes those records into Sheet1, starting with the active cell
<P>
</UL>For this macro to work correctly, you must:

<OL><P><LI>In A3, change the path to the actual location of ADDR.DBF.

<P><LI>Change A2 to indicate an open worksheet.

<P><LI>The add-in QE.XLA must be loaded.

<P><LI>The third line should all be entered into the same cell.
   It is split into two lines here for readability.

<P><LI>Place two single quotation marks to the left of "NC" and two
   single quotation marks to the right, followed by a double quotation
   mark that matches the double quotation mark before "select".

<P><LI>You may also use two sets of double quotation marks instead of
   two sets of single quotation marks.
<P>
</OL><h3>Example</h3>
 
<P>
A1 =INITIATE("qe","system")
A2 =ACTIVATE("sheet1")
A3 =DB.SQL.QUERY(2,"select * from dBASEfile | d:\excel\xl3\qe\addr.dbf
<PRE>    where STATE=''NC''",1)
</PRE></OL>A4 =RETURN()
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Q+E for Excel User's Guide." Version 3.00, pages 68-71.
"README.TXT", Microsoft Excel version 3.00, Section 3.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: qpluse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
