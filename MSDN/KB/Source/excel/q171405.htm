

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Error Closing Workbooks That Contain DDE Links </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171405">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/07/15">
<META NAME="Keywords" CONTENT="xlwin kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you close a workbook that contains Dynamic Data Exchange (DDE) links to another program, you may receive the following error message:     This program has performed an illegal operation    and will be shut down.  If you click Details, a messag...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAGB,QAH4,QAZ2,QAE2,QAB4,QBXA,QAJQ,QDKX,QBUG,QBUF,QAKP,QAAW,QDO3,QAAP P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error Closing Workbooks That Contain DDE Links</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171405</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you close a workbook that contains Dynamic Data Exchange (DDE) links
to another program, you may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation
   and will be shut down.

</PRE>If you click Details, a message similar to the following appears:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE
   at 0137:3027eae5.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when you do the following:

<UL><LI>You open several workbooks that each contain one or more DDE links to
   the same program.
<P>
<P><PRE>    -and-
</PRE>
<LI>You close all of the workbooks containing DDE links, or quit Microsoft
   Excel.
<P>
</UL>NOTE: This problem does not occur if you link to other Microsoft Office
programs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, install Microsoft Excel 97 Service Release 1
(SR-1).
<P>
To work around this problem, quit the program that the workbooks link to
before closing the workbooks containing the DDE links.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97 for
Windows. This problem was corrected in Microsoft Excel 97 SR-1.
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For each workbook you open that contain links to the same program, Excel
creates a new DDE link to that program. However, when you close each
workbook, Excel keeps each link to the other program open, instead of
closing the link. When you close all the workbooks linked to the program,
Excel will stop responding, and display the error message described in the
"Symptoms" section of this article.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating links using DDE, click the Index tab in
Microsoft Excel Help, type the following text
<P>
<PRE>   DDE

</PRE>and then double-click the selected text to go to the "About using a formula
to link data from programs not on your computer" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 ipf gpf crash sr1<BR>
Keywords          : xlwin kberrmsg kbinterop<BR>
Technology        : kbole<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
