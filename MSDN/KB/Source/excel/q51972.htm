

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Controlling Iteration by Seeding Values in Circular Ref </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51972 ">
<META NAME="KBModify" CONTENT="1995/07/10">
<META NAME="KBCreate" CONTENT="1989/12/15">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You can use circular references with iteration to compute such things as simultaneous equations and complex recursive formulas. In computing these circular references, it is sometimes necessary to  seed  the iteration with a starting value to preve...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKD,QAE5,QDNZ,QAKC,QAUD,QAY1,QAYZ,QAX0,QAB9,QANX,QBE7,QBE6,QAAP,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Controlling Iteration by Seeding Values in Circular Ref</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51972 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.x, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 1.x, 2.x, 3.0, 4.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use circular references with iteration to compute such things as
simultaneous equations and complex recursive formulas. In computing these
circular references, it is sometimes necessary to "seed" the iteration with
a starting value to prevent calculation errors (such as #DIV/0!) from
occurring based on initial values of the cells.
<P>
To seed the calculation, do the following:

<OL><P><LI>Replace one of the formulas with a value.

<P><LI>Perform a Calculate Now (if calculation is set to Manual) to force the
   other cell to calculate to a number other than the original value.

<P><LI>Re-enter the formula that was replaced.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
For example, to compute the value X, where X=1+6/X:

<OL><P><LI>In cell A1, type "=A2" (without the quotation marks).

<P><LI>In cell A2, type "=1+6/A1" (without the quotation marks).
<P>
</OL>This creates a circular reference. To calculate, calculation must be set
with iterations. However, at this time, cell A1 has the value 0 in it, and
cell A2 has the error #DIV/0!. To correct this problem:

<OL><P><LI>In cell A1, type "2" (without the quotation marks--replace the formula
   with this entry).

<P><LI>If calculation is set to Manual, click the Calc Now button (on the
   Calculation tab of the Options dialog box). (Or if you are using a
   version of Microsoft Excel earlier than version 5.0, choose Calculate
   Now from the Options menu.)
<P>
   The value 4 will now be in cell A2.

<P><LI>Re-enter the formula "=A2" in cell A1.
<P>
</OL>Microsoft Excel uses the starting value of 4 rather than 0 (zero), and
the formula is calculated correctly.
<P>
When you seed values for iterations, you should understand the order in
which Microsoft Excel performs calculations. After the last value in a
circular reference is entered, Microsoft Excel calculates the values by
searching through the worksheet (beginning at cell A1 and proceeding
through the worksheet left to right, top to bottom) for dependent cells.
<P>
If, searching in this manner, Microsoft Excel encounters other cells
that are dependent on the cell you just entered before it encounters
the newly entered cell, it recalculates that dependent cell as if the
value of the newly entered cell is 0. Once Microsoft Excel reaches the
newly entered cell, it calculates the value of the newly entered cell
based on the new value of the dependent cell.
<P>
The following is an example of this calculation process:
<P>
Using the scenario above, you seed the formula by setting a value to
cell A1 and then changing A1 back to a formula to complete the
circular reference. This works because A1 is the first cell Microsoft
Excel encounters in recalculating the iteration; thus, it uses the
existing values for the other cells in the circular reference. If,
however, you place the formula =A1 in cell A2 and =1+6/A2 in cell A1
and then try to seed A2 with the number 2, you again encounter the
#DIV/0! error because Microsoft Excel calculates as follows:
<P>
<PRE>   When you place the number 2 in cell A2, Microsoft Excel calculates
   cell A1 and return 4 (as before). However, when you then change A2
   to the formula =A1, Microsoft Excel starts at the beginning of the
   worksheet and first find cell A1. To calculate the value of A1,
   Microsoft Excel takes the current value of A2 which, in this case,
   is 0, not 4 (because the formula in A2 has been entered but not yet
   calculated). This yields a #DIV/0! error in cell A1 which, of
   course, is then carried into cell A2, leaving you again in an
   error loop.

</PRE></OL>Thus, it is important to seed the value for the iteration in the first
cell Microsoft Excel calculates (that is, the first one encountered
searching left to right, top to bottom).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: 1.00 1.03 1.04 1.06 1.50 2.20 3.00 4.00 5.00 5.00a 5.00c<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
