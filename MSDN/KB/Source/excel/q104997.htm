

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Macro to Save Data as Tab-Delimited File without Quotes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104997">
<META NAME="KBModify" CONTENT="1997/06/30">
<META NAME="KBCreate" CONTENT="1993/10/05">
<META NAME="Keywords" CONTENT="kbmacro kbprb kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, to save a selection of data as a tab-delimited text file, select the Text file format in the Save File As Type box in the Save As dialog box. When you save a file in this format, if any of the cells in the spreadsheet contain co...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QAH4,QBVP,QAUR,QBXS,QA50,QA2Q,QBWS,QA62,QAU7,QAUJ,QAG2,QDNZ,QA8T,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Macro to Save Data as Tab-Delimited File without Quotes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104997</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a
<LI>Microsoft Excel for OS/2, versions 2.2, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, to save a selection of data as a tab-delimited
text file, select the Text file format in the Save File As Type box in
the Save As dialog box. When you save a file in this format, if any of
the cells in the spreadsheet contain commas, quotation marks, or other
characters that could be misinterpreted when you reopen the file,
Microsoft Excel encloses those values in quotation marks.
<P>
If you want to create a tab-delimited text file and you do not want
these additional quotation marks to be added, you must use a macro to
save the data to a text file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides macro examples for illustration only, without
warranty either expressed or implied, including but not limited to the
implied warranties of merchantability and/or fitness for a particular
purpose. This macro is provided as is and Microsoft in no way
guaranties that the following code can be used in all situations and
will not support modifications of the code to suit specific customer
requirements.
<P>
To create a tab-delimited text file without enclosing text strings in
quotation marks:

<OL><P><LI>In a new macro sheet, type the following:
<P>
<P><PRE>      A1: TextFile Macro
      A2: =SET.NAME("nextcol",0)
      A3: getname=FOPEN(INPUT("Filename:",2),3)
      A4: =SET.NAME("colcount",COLUMNS(SELECTION()))
      A5: =FOR.CELL("current",SELECTION())
      A6: =IF(AND(ISNUMBER(current),GET.CELL(7,current)&lt;&gt;"General"))
      A7: =FWRITE(getname,TEXT(current,GET.CELL(7,current)))
      A8: =ELSE()
      A9: =FWRITE(getname,current)
      A10: =END.IF()
      A11: =SET.NAME("nextcol",nextcol+1)
      A12: =IF(nextcol=colcount)
      A13: =FWRITE(getname,CHAR(13)&amp;CHAR(10))
      A14: =SET.NAME("nextcol",0)
      A15: =ELSE()
      A16: =FWRITE(getname,CHAR(9))
      A17: =END.IF()
      A18: =NEXT()
      A19: =FCLOSE(getname)
      A20: =RETURN()
</PRE>
<P><LI>Select cell A1.

<P><LI>From the Formula menu, choose the Define Name command. Verify that
   TextFile Macro appears in the Name box, and A1 appears in the Refers
   To box.

<P><LI>Under Type, select the Command option and choose OK.

<P><LI>Switch to the sheet that contains the range that you want to
   export and select that range.

<P><LI>From the Macro menu, choose Run. In the Macro dialog box, select
   the TextFile macro and choose OK.
<P>
</OL>A dialog box will prompt you for a filename, and the file will be
written to that name.
<P>
CAUTION: Any existing files with that same name will be overwritten
by the new text file.
<P>
<P><h3>Explanation of macro</h3>
 
<P>
A1: Macro name
A2: Initialize a variable "nextcol" equal to zero
A3: Open a sequential file for write access using user-provided name
<PRE>    stored in "getname"
</PRE></OL>A4: Initialize a variable "colcount" to number of columns in the
<PRE>    selected range
</PRE>A5: Begin a FOR.CELL loop through the selected range
A6: Check to see if current cell contains a number not formatted to
<PRE>    General
</PRE>A7: If the current cell meets above criteria, write current cell
<PRE>    contents to file with formatting
</PRE>A8: Otherwise
A9: Write current cell contents to file without formatting
A10: End If clause
A11: Increment "nextcol"
A12: Check to see if end of current row in selection
A13: Write return and line feed to file
A14: Reset "nextcol" to zero
A15: Otherwise
A16: Write a tab character to file
A17: End If clause
A18: Go to next loop iteration
A19: Close file on completion
A20: End macro
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.0a 4.00a<BR>
Keywords            : kbmacro kbprb kbprg kbprb<BR>
Version             : 2.X 3.00 4.00 4.00a | 2.2 3.00<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
