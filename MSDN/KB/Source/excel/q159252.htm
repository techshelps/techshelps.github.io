

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Description and Examples of Data Validation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159252">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/11/11">
<META NAME="Keywords" CONTENT="xlformat xlformula kbtool kbualink97 kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Data validation is a new feature available in Microsoft Excel 97. It allows you to do the following:   - Make a list of the entries that restricts the values allowed in a cell.   - Create a prompt message explaining the kind of data allowed in a ce...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAUD,QAEV,QBWS,QDNZ,QABI,QAKD,QBV4,QAGB,QA2Q,QAYC,QAYY,QA50,QANX,QBVP P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Description and Examples of Data Validation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159252</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Data validation is a new feature available in Microsoft Excel 97. It allows
you to do the following:

<UL><LI>Make a list of the entries that restricts the values allowed in a cell.

<LI>Create a prompt message explaining the kind of data allowed in a cell.

<LI>Create messages that appear when incorrect data has been entered.

<LI>Check for incorrect entries by using the Auditing toolbar.

<LI>Set a range of numeric values that can be entered in a cell.

<LI>Determine if an entry is valid based on calculation in another cell.
<P>
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This article describes some of the ways to use the new data validation
feature in Microsoft Excel 97 as well as examples to illustrate how to
implement this feature.
<P>
NOTE: The examples below assume you are working with a new Microsoft Excel
97 workbook and that you start with the first example and continue through
the examples in the order in which they are presented.
<P>
<P><h3>Make a List of Entries Allowed in the Cell</h3>
 
<P>
You can make a list of the entries you will accept for a cell on a
worksheet. You can then restrict the cell to accept only entries taken from
the list by using the data validation feature.
<P>
To create a drop-down list and restrict values in the cell to these
entries, do the following:

<OL><P><LI>Select cell A1.

<P><LI>On the Data menu, click Validation.

<P><LI>On the Settings tab, click List in the Allow drop-down list.

<P><LI>By default, the Ignore Blank and In-cell Dropdown check boxes are
   selected. Do not change them.

<P><LI>In the Source edit box, enter "a,b,c" (without quotation marks).
<P>
   NOTE: You can also enter a named range or cell reference if it contains
   a list of values. Both must be preceded by an equal sign.

<P><LI>Click OK.
<P>
   Cell A1 now has a drop-down list next to it and you can use this list
   to select the value to enter in the cell.

<P><LI>Click the drop-down list and then click any item it contains.
<P>
</OL>This value will be entered in the cell.
<P>
NOTE: You can manually enter "a", "b", or "c", (without quotation marks) in
the cell; you do not have to select these from the list. If you try to
manually enter anything other these values, a stop message appears and you
are unable to keep the value in this cell. Your only options are Retry or
Cancel.
<P>
<P><h3>Create a Prompt Message Explaining the Type of Data Allowed in  a Cell</h3>
 
<P>
You can create a message that explains the type of data that can be entered
in a cell. When you select the cell, the message appears near the cell. You
can move this message, if necessary, and it remains until you move to
another cell or press the Escape key. If the Office Assistant is visible,
the message appears in a balloon above the Office Assistant.
<P>
Continuing with the previous example, do the following:

<OL><P><LI>Select cell A1.

<P><LI>On the Data menu, click Validation and then click the Input Message tab.
<P>
   NOTE: Make sure the "Show input message when cell is selected" check
   box is selected.

<P><LI>In the Title edit box, enter "List for cell A1" (without quotation
   marks).
<P>
   This is the title for the message box that appears. It is in
   bold text.

<P><LI>In the Input Message edit box, enter "Please select either a, b or c
   from the drop-down list" (without quotation marks).
<P>
   This is the body of the message that appears.

<P><LI>Click OK.
<P>
   The message appears because cell A1 is selected.

<P><LI>Select cell A10.
<P>
   The drop-down list next to cell A1 and the message for cell A1 both
   disappear.

<P><LI>Select cell A1.
<P>
   Both the drop-down list and the prompt message appear next to cell A1.
<P>
   NOTE: If the Office Assistant is visible, the prompt message appears
   in a balloon above the Office Assistant.

<P><LI>Move the message to another location in the worksheet.
<P>
   When you select another cell and then select cell A1 again, the message
   appears in its new location.
<P>
   NOTE: There is no way to change the formatting for this message.
<P>
<P>
</OL><h3>Create a Message That Appears When Incorrect Data is Entered</h3>
 
<P>
The style of the error message Microsoft Excel displays when you type
incorrect data determines whether the restrictions are enforced. You can
display a message that stops you from entering data values except those
specified. You can also display explanatory and warning messages that let
you to enter out-of-range data, or you can set limits on the data but not
display any messages.
<P>
Continuing with the previous example, do the following:

<OL><P><LI> Select cell A1.

<P><LI> On the Data menu, click Validation and then click the Error Alert tab.
<P>
<P><PRE>    NOTE: Make sure the "Show error alert after invalid data is entered"
    check box is selected.
</PRE><P>
<P><PRE>    Create a Stop Alert Message
    ---------------------------
</PRE><P>
<P><PRE>    If you create a Stop Alert message and enter invalid data in the cell,
    your only options are Retry or Cancel; you are Not allowed to enter
    invalid data in the cell.
</PRE><P>
<P><PRE>    a. In the Style list, click Stop.
</PRE><P>
<P><PRE>    b. In the Title edit box, enter "Warning for cell A1" (without
       quotation marks). This is the title for the message box that
       appears.
</PRE><P>
<P><PRE>    c. In the Error Message edit box, enter "The only allowable values for
       cell A1 are a, b, or c", (without quotation marks). This is the body
       of the message that appears and is limited to 225 characters.
</PRE><P>
<P><PRE>    d. Click OK.
</PRE>
<P><LI> Manually enter "t" (without quotation marks), in cell A1.
<P>
<P><PRE>    The Stop Alert message you created appears and your only options are
    Retry or Cancel.
</PRE>
<P><LI> Click Cancel on the Stop Alert message box.

<P><LI> Select cell A1.

<P><LI> On the Data menu, click Validation and then click the Error Alert tab.
<P>
<P><PRE>    NOTE: Make sure the "Show error alert after invalid data is entered"
    check box is selected.
</PRE><P>
<P><PRE>    Create a Warning Alert Message
    ------------------------------
</PRE><P>
<P><PRE>    If you create a Warning message and enter invalid data in the cell,
    your options are a little more flexible than for a Stop Alert message.
    A Warning Alert message has three options: Yes, to allow entry of the
    invalid data; No, to give you a chance to enter valid data; and Cancel,
    to remove the invalid entry.
</PRE><P>
<P><PRE>    a. In the Style list, click Warning.
</PRE><P>
<P><PRE>    b. In the Title edit box, enter "Warning for cell A1" (without
       quotation marks). This is the title for the message box that
       appears.
</PRE><P>
<P><PRE>    c. In the Error Message edit box, enter "The only allowable values for
       cell A1 are a, b, or c" (without quotation marks). This is the body
       of the message that appears and is limited to 225 characters.
</PRE><P>
<P><PRE>    d. Click OK.
</PRE>
<P><LI> Manually enter "j" (without quotation marks) in cell A1.
<P>
<P><PRE>    The Warning message you created appears asking if you want to Continue.
</PRE>
<P><LI> Click Yes.
<P>
<P><PRE>    The invalid value of "j" is entered in cell A1.
</PRE>
<P><LI> Select cell A1.

<P><LI>On the Data menu, click Validation and then click the Error Alert tab.
<P>
<P><PRE>    NOTE: Make sure the "Show error alert after invalid data is entered"
    check box is selected.
</PRE><P>
<P><PRE>    Create an Information Alert Message
    -----------------------------------
</PRE><P>
<P><PRE>    If you create an Information message and enter invalid data in the
    cell, your options are the most flexible. When an Information Alert
    message appears, you can click OK to accept the invalid value or you
    can click Cancel to reject it.
</PRE><P>
<P><PRE>    a. In the Style list, click Information.
</PRE><P>
<P><PRE>    b. In the Title edit box, enter "Warning for cell A1", (without
       quotation marks). This is the title for the message box that
       appears.
</PRE><P>
<P><PRE>    c. In the "Error message" edit box, enter "The only allowable value for
       cell A1 are a, b, or c" (without quotation marks). This is the body
       of the message that appears and is limited to 225 characters.
</PRE><P>
<P><PRE>    d. Click OK.
</PRE>
<P><LI>Manually enter "p", (without quotation marks), in cell A1.
<P>
<P><PRE>    The Information Alert message you created appears asking if you want
    to accept or reject the value you entered.
</PRE>
<P><LI>Click OK.
<P>
<P><PRE>    The invalid value of "p" is entered in cell A1.
</PRE><P>
</OL><h3>Check for Incorrect Entries Using the Auditing Toolbar</h3>
 
<P>
After your data is entered, you can look for entries that are outside the
limits you set. When you click Circle Invalid Data on the Auditing toolbar,
circles appear around cells that contain incorrect entries. If you correct
an invalid entry, the circle disappears.
<P>
Continuing with the previous example, do the following:

<OL><P><LI>On the Tools menu, click Customize.

<P><LI>In the Customize dialog box, click the Toolbars tab.

<P><LI>In the list of Toolbars, select the Auditing check box (if it's not
   already selected) and then click Close.

<P><LI>On the Auditing toolbar, click the Circle Invalid Data control. Cell
   A1 is circled.

<P><LI>Select cell A1.

<P><LI>Click the drop-down arrow next to cell A1 and then click one of the
   entries in the list. The circle disappears.
<P>
</OL><h3>Set a Range of Numeric Values That Can Be Entered in a Cell</h3>
 
<P>
You can place limits on the data that can be entered in a cell, you can set
minimums and maximums or check for the effect an entry might have on
another cell.

<OL><P><LI> Select cell A5.

<P><LI> On the Data menu, click Validation and click the Settings tab.

<P><LI> In the Allow list, click Whole number.

<P><LI> In the Data list, click between.

<P><LI> In the Minimum box enter 1.

<P><LI> In the Maximum box enter 10.
<P>
<P><PRE>    NOTE: You can use cell references for Steps 5 and 6 to specify cells
    that contain the minimum and maximum values.
</PRE>
<P><LI> Click OK.

<P><LI> Enter the value 3 in cell A5. The value is entered without error.

<P><LI> Enter the value 33 in cell A5.
<P>
<P><PRE>    Since the data validation settings you created for cell A1 (an
    Information Alert) do not apply to those for cell A5, you receive a
    Stop Alert message (which is the default value) and your only options
    are to click Retry or Cancel.
</PRE>
<P><LI>Click Cancel. The value of 3 appears in the cell.
<P>
</OL><h3>Determine If Entry Is Valid Based on Calculation in Another Cell</h3>
 
<P>
In the data validation dialog box you can use a formula, an expression or a
reference to a calculation in another cell to determine if the entry you
make is valid.

<OL><P><LI>Enter the value 1 in cell B10.

<P><LI>Select cell A10.

<P><LI>On the Data menu, click Validation and click the Settings tab.

<P><LI>In the Allow list, click Custom.

<P><LI>In the Formula box enter the following formula:
<P>
   =IF(A10&gt;B10,TRUE,FALSE)
<P>
   NOTE: The formula you enter must begin with an equal sign and it must
   evaluate to either true or false. It is not limited to the IF function.

<P><LI>Click OK.

<P><LI>Enter the value -1 in cell A10.
<P>
   You receive a Stop Alert message stating the value is invalid.

<P><LI>Click Retry.

<P><LI>Enter the value 3 in cell A10.
<P>
   You do not receive any error message since this value is greater than
   the value you entered in cell B10.
<P>
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about data validation, click the Index tab in
Microsoft Excel 97 Help, type the following text
<P>
<PRE>   data validation, preventing incorrect entry

</PRE></OL>and then double-click the selected text to go to the "Prevent entry of
incorrect data in a cell" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 97 XL97<BR>
Keywords          : xlformat xlformula kbtool kbualink97 kbfaq<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
