

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining Display Metrics in an Excel Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51139 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/11/20">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  IMPORTANT: The CALL and REGISTER functions are provided for advanced users only. If you use these functions incorrectly you could accidentally cause errors in your system's operation.  The following macro allows you to determine the metrics of your...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAY5,QAUD,QAH4,QAIF,QBVP,QBV8,QAB9,QDNZ,QAGU,QAB5,QALW,QAFR,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Determining Display Metrics in an Excel Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51139 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
IMPORTANT: The CALL and REGISTER functions are provided for advanced users
only. If you use these functions incorrectly you could accidentally cause
errors in your system's operation.
<P>
The following macro allows you to determine the metrics of your video
display (that is, horizontal resolution, vertical resolution, number of
colors) by using a macro. This information may be helpful in creating
macros that create variable-sized custom dialog boxes based on display size
or take into account the effect of display resolution on printed output.
<P>
<PRE>   A2 : =REGISTER("USER","GetActiveWindow","H")
   A3 : =REGISTER("GDI","GetDeviceCaps","HHH")
   A4 : =REGISTER("USER","GetDC","HH")
   A5 : =CALL(A2)                                  hWnd
   A6 : =CALL(A4,A5)                               hDC
   A7 : =CALL(A3,A6,8)                             HORZRES
   A8 : =CALL(A3,A6,10)                            VERTRES
   A9 : =CALL(A3,A6,14)                            PLANES
   A10: =CALL(A3,A6,12)                            BITSPIXEL
   A11: =RETURN()

</PRE>This macro returns the horizontal display resolution in pixels in cell A7
(HORZRES), the vertical resolution in cell A8 (VERTRES), the number of
planes in cell A9 (PLANES), and the bits per pixel in cell A10 (BITSPIXEL).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The instructions in this macro do the following:

<OL><P><LI>Cell A2 uses REGISTER to obtain a text value to be used by the CALL
   function to activate the GetActiveWindow function in the Windows USER
   module. This function takes no argument and returns a handle to
   the current window (hWnd), which is Excel.

<P><LI>Cell A3 uses REGISTER to obtain a text value to be used by CALL to
   activate the GetDeviceCaps function in the Windows GDI (graphics
   device interface) module. GetDeviceCaps accepts two parameters, a
   handle to the device context (hDC), obtained from the GetDC
   function, and a numeric parameter denoting the type of information
   requested, which is returned as an integer.

<P><LI>Cell A4 uses REGISTER again to obtain a text value to be used by
   CALL to activate the GetDC function in the Windows USER module. This
   function takes a window handle (hWnd) as an argument (obtained from
   GetActiveWindow), and returns a handle to the device context (hDC).

<P><LI>Cell A5 calls the GetActiveWindow function to return the handle to
   the current window (hWnd).

<P><LI>Cell A6 calls the GetDC function, using the value returned in cell
   A5 (hWnd) to obtain a handle to the device context (hDC).

<P><LI>Cells A7 through A10 call the GetDeviceCaps function using the
   handle to the device context (hDC) from cell A6, as well as
   integers denoting the type of information required, to obtain the
   display capabilities.
<P>
</OL>Note: the information above also applies to version 5.0 only when using
version 4.0 macro language.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: display resolution high res mapping dialog box<BR>
screen driver worksheet formatting hi res position 2.0 2.00 2.1 2.10 3.0<BR>
3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
