

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Advantages and Uses of the OFFSET Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q63962 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1990/07/18">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  There are two basic methods of calculating a reference relative to another reference in a Microsoft Excel macro.  1. Use relative R1C1-style notation as text (and perhaps the text    operator and functions that deal with text).  2. Use the OFFSET f...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKD,QAY5,QAB3,QATX,QAB9,QAMB,QBV8,QAKC,QAUD,QAH4,QASR,QAPN,QABH,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Advantages and Uses of the OFFSET Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q63962 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.1 and 3.0
<LI>Microsoft Excel for the Macintosh, versions 2.2 and 3.0
<LI>Microsoft Excel for OS/2, versions 2.2 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are two basic methods of calculating a reference relative to
another reference in a Microsoft Excel macro.

<OL><P><LI>Use relative R1C1-style notation as text (and perhaps the text
   operator and functions that deal with text).

<P><LI>Use the OFFSET function.
<P>
</OL><h3>BENEFITS OF USING THE OFFSET FUNCTION</h3>
 
<P>
<P><h3>Structure</h3>
 
<P>
OFFSET is a function with a structured syntax. Syntax errors are
automatically recognized by Microsoft Excel. The methods are
controlled by the function syntax.
<P>
<P><h3>Clarity</h3>
 
<P>
With OFFSET, relative R1C1 text notation can be entirely avoided. This
can eliminate confusion associated with R1C1-style references if
A1-style references are preferred. Also, text references (such as
R1C1) evaluate at run time, whereas reference values (such as A1 and
OFFSET) evaluate when they are entered into a macro sheet.
<P>
<P><h3>Speed</h3>
 
<P>
Complicated text reference notation takes longer to evaluate to a
reference value than does the OFFSET function.
<P>
<P><h3>Simplicity</h3>
 
<P>
The same operations take fewer steps with OFFSET than with R1C1
references as text.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The syntax of OFFSET is as follows:
<P>
<PRE>   =OFFSET(ref,rows,cols,height,width)

</PRE></OL>OFFSET is a value-returning macro function that returns a reference
value offset by "rows" and "cols" from the reference value "ref." The
optional arguments "height" and "width" are used to calculate a
reference that is in a different shape than "ref."
<P>
You cannot display a reference value in a cell. When values are
displayed on a macro sheet, the contents of the upper-left cell of the
reference returned by OFFSET will be displayed. However, it is
important to understand that the reference value desired is returned
implicitly by the OFFSET function.
<P>
You may want to show the reference value returned by OFFSET when
testing the macro. Following are two convenient methods to show the
reference value:
<P>
<P><h3>Method 1</h3>
 
<P>
Step through the formula in the Single Step dialog box:

<OL><P><LI>Insert the STEP function in the macro to display the Single Step
   dialog box when the macro is run.

<P><LI>When the statement that uses OFFSET is displayed, hold down the
   SHIFT key and click the Step button or press ENTER until the OFFSET
   function is evaluated.
<P>
   The Single Step dialog box will show the reference returned by
   OFFSET.
<P>
</OL><h3>Method 2</h3>
 
<P>
Use REFTEXT to display the reference as text:

<OL><P><LI>If you want to check the reference returned by OFFSET without
   running the macro, insert REFTEXT around the OFFSET function in the
   formula bar.

<P><LI>Select the entire REFTEXT function and its arguments in the formula
   bar and choose Calculate Now from the Options menu. Be sure to
   click the Cancel box, or press COMMAND+PERIOD (in Windows and OS/2
   Excel, press ESC) so that the original formula is retained.
<P>
</OL>Examples of OFFSET
 
<P>
Below is a comparison between specifying a relative reference with
text notation and using OFFSET. Although text value notation is
shorter in certain special cases, it usually takes slightly longer to
evaluate and is certainly less structured. Note the structure and
repetition of a few basic techniques when using OFFSET.
<P>
The format for these examples is as follows:
<P>
#. Desired result:
<P>
<PRE>   Text Value Notation
   Reference Value Notation

</PRE><P><LI>A cell one row down from the active cell:
<P>
   "r[1]c"
   OFFSET(ACTIVE.CELL(),1,0)

<P><LI>A range from the active cell to a cell three rows down, two columns
   to the right:
<P>
   "rc:r[3]c[2]"
   ACTIVE.CELL():OFFSET(ACTIVE.CELL(),3,2)

<P><LI>Same selection shape, five columns to the right of the current
   selection:
<P>
   "rc[5]:r["&amp;ROWS(SELECTION())-1&amp;"]c["&amp;COLUMNS(SELECTION())-1+5&amp;"]"
   OFFSET(SELECTION(),0,5)

<P><LI>Variable number of rows and columns from the active cell (where
   "numofrows" and "numofcols" are defined names representing the
<P><PRE>    number of rows desired and the number of columns desired,
    respectively):
</PRE><P>
   "r["&amp;numofrows&amp;"]c["&amp;numofcols&amp;"]"
   OFFSET(ACTIVE.CELL(),numofrows,numofcols)
<P>
</OL>Also note that the text value notation for the third and fourth
examples would be even more unwieldy if they didn't take advantage of
the ability of Microsoft Excel to coerce number values into text
values during string concatenation.
<P>
For more information on using OFFSET, STEP, and REFTEXT with Excel for
the Macintosh, see pages 163-164, 227, and 192-193, respectively, in
the "Microsoft Excel Function Reference" version 3.0 manual. If you
are using Excel 2.2, see pages 251-252, 286, and 266, respectively, in
the "Microsoft Excel Functions and Macros" version 2.2 manual.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory:<BR>
KBSubcategory:
<P>

Additional reference words: 2.1 2.10 2.2 2.20 2.21 3.0 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
