

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Errors Appear When Using an ODBC Text Data Source (DSN) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168097">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1997/05/06">
<META NAME="Keywords" CONTENT="kbtool kbusage xlpivot xlquery">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you work with a file data source name (DSN) that uses a text Open Database Connectivity (ODBC) driver, either of the following symptoms occur:   - When you attempt to add a table, the following error message appears        Can't access table  ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBRZ,QA9E,QBVU,QA1S,QAMB,QA5E,QATX,QBVP,QAHT,QDN9,QAYY,QA5V,QAU9,QAH4 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Errors Appear When Using an ODBC Text Data Source (DSN)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168097</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Office 97 for Windows
<LI>Microsoft Query 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you work with a file data source name (DSN) that uses a text Open
Database Connectivity (ODBC) driver, either of the following symptoms
occur:

<UL><LI>When you attempt to add a table, the following error message appears
<P>
<P><PRE>      Can't access table &lt;name&gt;
</PRE><P>
   where &lt;name&gt; is the name of the database.

<LI>When you create a PivotTable, one of the following error messages
   appear:
<P>
<P><PRE>    - Problems obtaining data
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - PivotTable is not valid
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
<P><h3>Can't Access Table</h3>
 
<P>
This error message appears when the following conditions are true:

<UL><LI>You attempt to add a table to a query.
<P>
   -and-

<LI>That text file is open in another Office program.
<P>
</UL><h3>Problems Obtaining Data or PivotTable Is Not Valid</h3>
 
<P>
These error messages appear when you attempt to create a server-based page
field in a PivotTable when the source data is from an external text
file.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
<P><h3>Can't Access Table</h3>
 
<P>
To work around this problem, close the text file in the other program
before you add it to the query.
<P>
<P><h3>Problems Obtaining Data or PivotTable Is Not Valid</h3>
 
<P>
When you use a File DSN that uses a text ODBC driver, you cannot create a
server-based page field. Update the PivotTable to reset the PivotTable
field settings.
<P>
If you want to use a server-based page field in a PivotTable, import
the text database into another program, for example, Microsoft Access. For
more information about importing data into Microsoft Access, refer to
Microsoft Access Help.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Unlike other types of ODBC drivers, the Text ODBC driver uses file locking
instead of record locking. This means that records are not available to
more than one program at a time. When you open the text file in one
program, and then attempt to open the same file in another program, it is
an access violation. You cannot use any driver that uses file locking
instead of record locking to create a PivotTable with server-based page
fields. Other ODBC drivers do not exhibit this problem.
<P>
For additional information on creating DSNs, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A HREF="../vbapps/Q165866.htm">Q165866</A></B>
   TITLE     : XL97: How to Use File DSNs and DSN-less Connections

   Article-ID: <B><A HREF="../vbapps/Q159557.htm">Q159557</A></B>
   TITLE     : XL97: Using System, User, and File Data Sources
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords            : kbtool kbusage xlpivot xlquery<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
