

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Caller Does Not Return Hierarchical Menu Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118796">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/07/31">
<META NAME="Keywords" CONTENT="kbprg fixlist5.00c">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the Caller function, or the Caller property, and the macro currently running was started by choosing a menu command, the array of values returned does not include information about whether the command that ran the m...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBVP,QAVI,QAF0,QBV8,QAB9,QACI,QAH4,QBWS,QALW,QBXS,QAY5,QBRD,QBJZ,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Caller Does Not Return Hierarchical Menu Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118796</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the Caller function, or the Caller
property, and the macro currently running was started by choosing a
menu command, the array of values returned does not include
information about whether the command that ran the macro was located
on a top level menu or on a submenu.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Caller function, and the Caller property return information about
the object that called the macro that is currently running. For example,
if you run a macro by choosing a command on a menu, Caller returns
an array of values specifying the position, the menu number, and the
menu bar number of the command that you chose. Caller does not,
however, return information about whether the command was located on a
main menu, such as the File menu, or on a sub menu.
<P>
The information returned about the position of the command is the position
of the command on the menu, regardless of whether it was a main menu, or a
submenu. Therefore, Caller returns the same values for the first command
located on a main menu, as for the first command located on a submenu of a
menu item on that same menu.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected for the
Caller function in Microsoft Excel version 5.0c and Microsoft Excel for
Windows 95 version 7.0.
<P>
In Microsoft Excel versions 5.0c and 7.0, when you use the Caller function
in a macro that you run by choosing a menu command, a horizontal array of
four elements is returned. The additional element that is returned is the
position of the menu item (on the main menu) that contains the submenu item
that ran the macro.
<P>
For example, if you run the Caller function by choosing the second command
on the File menu, Two, and then choosing the first command, Item One, on
the submenu, the following horizontal array is returned:
<P>
<PRE>   1, 1, 10, 2

</PRE>where the position of the command (Item One) on the submenu is 1, the menu
(File) is 1, the bar number (Worksheet and Macro sheet) is 10, and the
position of the command on the main menu (Two) is 2. If the command that
runs the macro is not located on a submenu, the value returned as the
fourth element in the array is 0.
<P>
NOTE: This problem has not been corrected for the Caller property.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Caller, choose the Search button in the
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>   Caller function

</PRE>For more information about the Caller Property, choose the Search
button in the Visual Basic Reference and type:
<P>
<PRE>   Caller Property

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory:
<P>

Additional reference words: 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
