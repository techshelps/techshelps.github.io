

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Some Worksheet Properties not Preserved </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169106">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/05/27">
<META NAME="Keywords" CONTENT="xlloadsave xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you save, close, and then reopen a workbook in Microsoft Excel 97, some of the properties of worksheets in the workbook may not be saved. The following properties are affected:     EnableAutoFilter    EnableCalculation    EnableOutlining    Di...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAH4,QBWS,QBVV,QBVP,QAUR,QBSO,QDNM,QBWC,QAKE,QBXS,QA6A,QA5F,QAMA P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Some Worksheet Properties not Preserved</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169106</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you save, close, and then reopen a workbook in Microsoft Excel 97,
some of the properties of worksheets in the workbook may not be saved. The
following properties are affected:
<P>
<PRE>   EnableAutoFilter
   EnableCalculation
   EnableOutlining
   DisplayPageBreaks
   EnablePivotTable
   EnableSelection

</PRE><h2>CAUSE</h2>
 
<P>
These worksheet properties are not designed to be saved when you close a
workbook.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
If you want to set the properties of a worksheet to specific values when
you open a workbook, use a Visual Basic for Applications macro to set the
properties when the workbook that contains the worksheet is opened. The
following example macro demonstrates one way to do this:
<P>
<PRE>   ' Auto_Open macros run automatically when you open the workbook.

   Sub Auto_Open()

       With ThisWorkbook.Worksheets("Sheet1")

           ' Set as many as these properties as you need.
           .EnableSelection = xlNoSelection
           .EnablePivotTable = True
           .EnableOutlining = True
           .EnableAutoFilter = True
           .DisplayPageBreaks = True
           .EnableCalculation = False

       End With

   End Sub

</PRE>If you insert this code into a module in the workbook, the macro sets the
properties for worksheet Sheet1 whenever you open the workbook manually.
<P>
NOTE: If you use a macro to open the workbook, you must use the
RunAutoMacros method to run the Auto_Open macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The properties listed in this article are not preserved when you close a
workbook. When you reopen the workbook, the properties for each worksheet
revert to their default values, which are listed in the following table.
<P>
<PRE>   Property            Default Value
   ----------------------------------------

   EnableSelection     0 - xlNoRestrictions
   EnableOutlining     False
   EnableAutoFilter    False
   EnablePivotTable    False
   EnableCalculation   True
   DisplayPageBreaks   False

</PRE>You can set these properties programmatically, as in the "Workaround"
section in this article, or you can use the Properties window in the Visual
Basic Editor to set them. To do this, use the following steps:

<OL><P><LI>Switch to the Visual Basic Editor by pressing ALT+F11.

<P><LI>In the Project window, click the worksheet with the properties you want
   to change.

<P><LI>If the Properties window is not visible, click Properties Window on the
   View menu.

<P><LI>In the Properties window, double-click the property you want to change,
   type the new value, and then press ENTER.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about properties listed in this article, click the
Office Assistant in the Visual Basic Editor, type "EnableSelection," click
Search, and then click to view "EnableSelection Property."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Visual Basic Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 xlunlockedcells<BR>
Keywords          : xlloadsave xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
