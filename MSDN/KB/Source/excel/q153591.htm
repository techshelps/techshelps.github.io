

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: VLOOKUP &amp; HLOOKUP May Return #N/A Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153591">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1996/07/11">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you use a text string as the lookup value in a VLOOKUP worksheet function, you may receive the #N/A error value. This error will also occur with the HLOOKUP function.  CAUSE =====  The versions of Microsoft Excel mentioned above, do not automati...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QAAP,QA28,QATJ,QAHH,QAR4,QAMB,QAB9,QAH4,QAB4,QDKW,QAKP,QBXN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: VLOOKUP &amp; HLOOKUP May Return #N/A Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153591</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.x, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 4.x, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use a text string as the lookup value in a VLOOKUP worksheet
function, you may receive the #N/A error value. This error will also occur
with the HLOOKUP function.
<P>
<P><h2>CAUSE</h2>
 
<P>
The versions of Microsoft Excel mentioned above, do not automatically
detect headers from a lookup table and strip them out. Therefore, when you
specify the lookup range argument, do not include column headings in the
selection. Or, or use the INDEX and MATCH function, instead.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do not include the headers in the lookup range
argument as demonstrated below.
<P>
<P><h3>Example Using VLOOKUP</h3>
 

<OL><P><LI>Type the following information into a spreadsheet:
<P>
<PRE>      A1:  Code     B1: Amount     C1:
      A2:  a        B2: 100        C2:
      A3:  b        B3: 200        C3:

</PRE><P><LI>Type the following formulas in cells C2 and C3:
<P>
<P><PRE>      C2: =VLOOKUP("a",A2:B3,2)
      C3: =INDEX(A1:B3,MATCH("a",A1:A3,0),2)
</PRE><P>
   Both of these formulas return the correct answer of 100.
<P>
</OL><h3>Example Using HLOOKUP</h3>
 

<OL><P><LI>Type the following information into a spreadsheet:
<P>
<PRE>      A1: Code       B1: a       C1: b       D1:
      A2: Amount     B2: 100     C2: 200     D2:
      A3:            B3:         C3:         D3:

</PRE><P><LI>Type the following formulas in cells D2 and D3:
<P>
<P><PRE>      D2: =HLOOKUP("a",B1:C2,2)
      D3: =INDEX(A1:C2,2,MATCH("a",A1:C1,0),2)
</PRE><P>
   Both of these formulas return the correct answer of 100.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions Microsoft
Excel mentioned above. This problem has been corrected in Microsoft Excel
for Windows 95, version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q113261.htm">Q113261</A></B>
   TITLE     : Unexpected Results with Mixed Text and Numbers in Lookup
               Table

   ARTICLE-ID: <B><A HREF="../EXCEL/Q77114.htm">Q77114</A></B>
   TITLE     :Performing a Lookup with Unsorted Data in Excel
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.00a 5.00 5.00a 5.00c<BR>
Version           : WINDOWS:4.x,5.0,5.0c;MACINTOSH:4.x,5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
