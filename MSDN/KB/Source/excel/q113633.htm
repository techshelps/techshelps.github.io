

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Q+E: Query to Return Records That Don't Have Match in 2nd File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113633">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/04/11">
<META NAME="Keywords" CONTENT="kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Q+E, you can construct a query that will create a new file containing all the records from one file that do not have matching records in a second file. This type of query is called a subtract query.  MORE INFORMATION  Overview of Subtract Query ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBPJ,QDNB,QBWS,QBVP,QA5V,QAG2,QA2Q,QBXS,QAY2,QAHH,QAEF,QDI1,QA7O,QA7N,QAZZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Q+E: Query to Return Records That Don't Have Match in 2nd File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113633</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Q+E, versions 3.0, 4.0
<LI>Microsoft Excel for Windows, versions 3.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Q+E, you can construct a query that will create a new file containing
all the records from one file that do not have matching records in a second
file. This type of query is called a subtract query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Overview of Subtract Query Procedure</h3>
 
<P>
To perform the subtract query, use the Outer Join command to join the two
files, then add a condition to the end of the resulting SQL query text.
Running this query results in a new file; the contents of the source and
destination files are left unchanged.
<P>
NOTE: The "Q+E User's Guide" uses the terms "source" and "destination" to
refer to the two files being joined. The destination file is the file whose
window is active when you choose the Outer Join command. In this procedure,
the destination file is the file that contains the unmatched records.
<P>
The example below uses the sample files that ship with Microsoft Excel
version 4.0. The default location for these files is EXCEL\QE. If these
files are not installed on your system, you must run a custom setup and
reinstall Q+E.
<P>
<P><h3>Example of Subtract Query Procedure</h3>
 
<P>
WARNING: Your use or modification of the SQL statement provided in this
article is at your own risk. Microsoft provides this SQL statement "as is"
without warranty of any kind, either expressed or implied, including but
not limited to the implied warranties of merchantability and/or fitness for
a particular purpose. Microsoft does not support modifications of the SQL
statement to suit specific customer requirements.

<OL><P><LI>In Q+E, open the source and destination files. For this example, open
   ADDR.DBF and EMP.DBF.
<P>
   To Arrange these files side by side, choose the Arrange All command from
   the Window menu.

<P><LI>Select the EMP_ID field in ADDR.DBF to match on, and select the EMP_ID
   field in EMP.DBF.

<P><LI>With the EMP.DBF (the destination file) window active, choose Outer Join
   from the Select menu.

<P><LI>From the Select menu, choose SQL Query.

<P><LI>Place the insertion point at the end of the query text and type a space.
   After the space, type "AND ADDR.EMP_ID IS NULL" (without the quotation
   marks).

<P><LI>Choose OK to run this query.
<P>
</OL>The resulting table should display the six records that are in EMP.DBF but
are not in ADDR.DBF.
<P>
Note that there are blank fields to the right, beginning with the INTERESTS
field. To remove these fields, do either of the following:

<UL><LI>Select a column, then choose Remove Column from the Layout menu. Repeat
   this procedure for each column you want to remove.
<P>
   -or-

<LI>From the Select menu, choose SQL Query, remove the undesired field names
   from the query text, and then choose OK. (NOTE: The field names appear
   between the SQL key words SELECT and FROM.)
<P>
</UL>The queried data can now be pasted into Microsoft Excel or saved as a query
or a table.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide," version 3.0, Chapter 2
<P>
For more information about Outer Join, choose Index from the Help menu, and
select the Select Commands Menu topic. Select the Outer Join topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 3.00 4.00 howto
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
