

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: SQL Statement Not Recorded in Macro If Query Returns Null </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136872">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="xlquery kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you record a macro from Microsoft Excel to run Microsoft Query and return data back to Microsoft Excel, if the query that is run does not return any data, then an SQL statement will not be recorded.  For example, if you run a query that looks ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBI0,QAUD,QA5V,QBJZ,QABM,QAPN,QAH4,QBWS,QAA1,QAB9,QALW,QDI2,QBVV,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: SQL Statement Not Recorded in Macro If Query Returns Null</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136872</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00
WINDOWS
kbtool xlquery
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows NT, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you record a macro from Microsoft Excel to run Microsoft Query and
return data back to Microsoft Excel, if the query that is run does not
return any data, then an SQL statement will not be recorded.
<P>
For example, if you run a query that looks in a particular field for all
records that contain a value greater than 500 and there are no records that
meet this criterion, then the recorder will not create the SQL statement to
run the query.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use the following steps to set up your query
manually and then copy it into your macro code:

<OL><P><LI>Record a macro that will return a data set to Microsoft Excel.
<P>
   This will give you the basic syntax for executing a query via macro.

<P><LI>To generate a query that will produce the desired result, start
   Microsoft Query. Select the correct Data Source for your scenario and
   click Use. Add the tables that your query will reference. Click Close
   when you've finished adding tables. Set up the query with your criteria.
   For more information on using Microsoft Query, see the "More
   Information" section later in this article.

<P><LI>To copy the SQL statement from Microsoft Query, click SQL on the View
   menu. Select the SQL statement and press CTRL+C. Close Microsoft Query.
<P>
   The statement in the dialog box is the SQL statement that should replace
   the one in your macro.
<P>
   NOTE: To close Microsoft Query without returning data to Microsoft
   Excel, click Close Query on the File menu and don't save the changes.
   Then, on the File menu, click Return Data to Microsoft Excel. Because
   there is no query open, Microsoft Query will ask you to verify that you
   do not want to return any data. Click Yes.

<P><LI>Paste the SQL statement from the clipboard into Microsoft Excel. Go back
   to the macro that you recorded in Step 1. Replace the statement that
   starts with SELECT in the above macro with the SQL statement from Step 3
   (Select everything between the quotation marks and click Paste on the
   Edit menu).
<P>
</OL>You may notice that your macro will consist of two or more "QueryGetData"
lines, Microsoft Excel will divide the SQL statement into several different
lines to make the query easier for you to read.
<P>
<P>
NOTE: If this workaround does not produce the desired effect, set up your
database so that it will return data under the conditions you are trying to
use and then record the macro.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel. Microsoft Excel assumes that
the query definition was incorrect.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information about a specific XLODBC.XLA function, choose the
Search button in Visual Basic Reference help, type the appropriate function
name, and choose the Show Topics button.
<P>
If you have an SQL statement that is longer than 255 characters, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q114992.htm">Q114992</A></B>
   TITLE     : GP Fault in XLODBC.DLL Using SQLExecQuery or SQLRequest

</PRE></OL>For additional information on using SQL functions and the ODBC drivers,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q125898.htm">Q125898</A></B>
   TITLE     : ODBC Examples from NT Help File Using NWind Data Source

</PRE><h2>REFERENCES</h2>
 
<P>
"User's Guide," version 5.0, chapter 23
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 5.00 5.00c 7.00<BR>
Keywords            : xlquery kbtool<BR>
Version             : 5.00 5.00c 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
