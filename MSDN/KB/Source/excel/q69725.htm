

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Reading the MS-DOS Environment String </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q69725 ">
<META NAME="KBModify" CONTENT="1996/02/21">
<META NAME="KBCreate" CONTENT="1991/02/27">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" IMPORTANT: The CALL() and REGISTER() functions are provided for advanced users only. If you use these functions incorrectly you could accidentally cause errors in your system's operation.   It is possible to retrieve a set of characters from the MS-...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATX,QBVP,QAY5,QAX1,QAUD,QAGI,QBV8,QAB9,QALG,QDOX,QDIJ,QALW,QDL9,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Reading the MS-DOS Environment String</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q69725 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Excel for Windows, versions 2.x, 3.0, 4.0, 5.0
</UL> 
<P>
IMPORTANT:
The CALL() and REGISTER() functions are provided for advanced users only.
If you use these functions incorrectly you could accidentally cause errors
in your system's operation.
<P>
<P><h2>SUMMARY</h2>
 
<P>
It is possible to retrieve a set of characters from the MS-DOS environment
string from Microsoft Excel if you are running under Microsoft Windows 3.0.
This is done using the CALL and REGISTER functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DOS environment is an area of memory that MS-DOS sets aside to store a
series of ASCII strings. Each string in the environment is terminated by a
byte of zero. The final string is terminated by two bytes of zero.
<P>
The following Microsoft Excel macro function will return the first N number
of characters (starting with the second character) from the DOS environment
string, including the zero bytes separating strings. This occurs as long as
the first character in your environment string has the ASCII decimal value
of N.
<P>
<PRE>   A1      Get_Environment
   A2      =REGISTER("KERNEL","GetMS-DOSEnvironment","D")
   A3      =CALL(A2)
   A4      =RETURN()

</PRE>Note: The CALL function can also be used on a standard worksheet in
Microsoft Excel version 3.0.
<P>
Using a return parameter of "D" in the REGISTER function tells Microsoft
Excel to interpret the value returned from the DLL function call as a
string with the first byte containing the number of bytes to follow in the
string. In this case, the first byte in the string returned will be the
first ASCII character in your environment string. If this character has a
decimal value of N, the following N characters will be returned.
<P>
<P><h3>Example</h3>
 
<P>
If the first string in your environment is "~USERNAME=BOB", cell A3 returns
126 characters of your environment string, starting with
<P>
<PRE>   USERNAME=BOB{null}

</PRE>where {null} indicates the zero byte terminating the string. This is
because the ASCII tilde character "~" has a decimal value of 126. You can
then search this string for particular environment variables.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Online Help," version 5.0
"Function Reference," version 4.0, pages 42-43, 350-352, 475-480
"Function Reference," version 3.0, pages 24, 193-194, 253-258
"Functions and Macros," version 2.1x, pages 255-256 and 337-340
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 2.1 2.10 3.0 3.00 4.0 4.00 5.0 5.00 environment<BR>
variable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 21, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
