

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Replacing Text May Change Text to Numbers or Dates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178606">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1997/12/29">
<META NAME="Keywords" CONTENT="xlformat xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, if you replace characters in a worksheet by clicking Replace on the Edit menu, the formatting of some cells in the worksheet may unexpectedly be changed. For example:     W...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAMB,QATX,QBWS,QBV4,QAKC,QDNZ,QAHP,QACI,QBC6,QA2Q,QBB2,QAG8,QAL2 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Replacing Text May Change Text to Numbers or Dates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178606</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article,
if you replace characters in a worksheet by clicking Replace on the Edit
menu, the formatting of some cells in the worksheet may unexpectedly be
changed. For example:
<P>
<PRE>   What Should Appear      What Actually Appears
   -----------------------------------------------------

   2:30:00 (as text)       2:30:00 (as a time)
   3/8 (as text)           8-Mar or 3-Aug (as a date)
   9e5 (as text)           9.00E+05 (scientific notation)

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur when text is being replaced in a cell and the
contents of the cell resembles a number, date, or time. If the contents of
a cell resembles a number, date, or time, Microsoft Excel automatically
applies an appropriate number format to the cell, even if the cell was
previously formatted to display text.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft Excel will not automatically reformat cells if the Transition
Formula Entry (TFE) option is turned on. To turn on this option, follow
these steps:

<OL><P><LI>On the Tools menu, click Options. Select the Transition tab.

<P><LI>Click to select the Transition Formula Entry check box. Click OK.

<P><LI>On the Edit menu, click Replace. Use the Replace dialog box to replace
   text as needed in the worksheet. Click Close when you are finished.

<P><LI>On the Tools menu, click Options. Select the Transition tab.

<P><LI>Click to clear the Transition Formula Entry check box. Click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates the problem described in the "Symptoms"
section.

<OL><P><LI>In Microsoft Excel, create a new workbook.

<P><LI>In Sheet1, select cells A1:A5. On the Format menu, click Cells. Select
   the Number tab. In the Category list, select Text. Then, click OK.
<P>
   Cells A1:A5 are now formatted to display text.

<P><LI>Enter the following values:
<P>
<P><PRE>      A1: 3/8"
      A2: 2:30"
      A3: 6e5"
</PRE><P>
<P><PRE>      A5: 95
</PRE>
<P><LI>On the Edit menu, click Replace.

<P><LI>In the Find What edit box, enter a single quotation mark ("). Do not
   enter any text in the Replace With edit box. Then, click Replace All.
<P>
   The contents and formatting of the cells are changed as follows
<P>
<P><PRE>      A1: 8-Mar (or 3-Aug, depending on your regional settings)
      A2: 2:30
      A3: 6.00E+05
</PRE><P>
   even though the cells were originally formatted to display text. Cell A1
   was changed from 3/8" to 3/8. Because 3/8 resembles a date, Microsoft
   Excel automatically applies a date format to the cell. The same rule
   applies to cell A2, which resembles a time, and cell A3, which resembles
   a number entered using scientific notation.

<P><LI>Select cell A5.

<P><LI>On the Edit menu, click Replace.

<P><LI>In the Find What edit box, enter the number 9. In the Replace With
   edit box, type "9e" (without the quotation marks). Then, click Replace.
<P>
   Cell A5 displays 9.00E+05, rather than 9e5, even though cell A5 was
   originally formatted to display text.

<P><LI>Click Close.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL5 XL7 XL97<BR>
Keywords          : xlformat xlformula<BR>
Version           : MACINTOSH:5.0,5.0a,98; WINDOWS:5.0,5.0c,7.0,7.0a,97<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
