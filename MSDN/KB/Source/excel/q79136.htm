

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Operation Performs on One Cell Only in a FOR.CELL Loop </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79136 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1991/12/12">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  A FOR.CELL loop repeats instructions over a range of cells, one cell at a time. However, the active cell does not move during the loop's execution. This may cause problems if you have instructions within the body of the loop that operate on the act...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAA7,QDNZ,QAB9,QAY5,QAPN,QA62,QAUD,QAHE,QAD7,QBV8,QAB3,QAPF,QBJ1,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Operation Performs on One Cell Only in a FOR.CELL Loop</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79136 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A FOR.CELL loop repeats instructions over a range of cells, one cell
at a time. However, the active cell does not move during the loop's
execution. This may cause problems if you have instructions within the
body of the loop that operate on the active cell.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The first argument to the FOR.CELL command is ref_name. This is a name
in the form of text that refers to the n-th cell in the selection upon
the n-th pass through the loop. The example shown below will replace
the contents of the active cell with the cubed root of the current
value of the active cell:
<P>
<PRE>   A1: CubeRoot
   A2: =FOR.CELL("CurrentCell")
   A3: =FORMULA(CurrentCell^(1/3))
   A4: =NEXT()
   A5: =RETURN()

</PRE>Because the reference argument is omitted from the FORMULA function,
it defaults to the active cell. However, because the active cell is
not moved in a FOR.CELL loop, the only cell that gets operated on is
the cell that is active before the loop is executed.
<P>
To cause a FOR.CELL loop's operation to be applied to each cell in the
selection, you must either use a SELECT statement to change the active
cell, or specify a reference if the operation to be applied will
accept a reference as an argument.
<P>
<P><h3>Example</h3>
 
<P>
In the example shown below, the FORMULA function is given the name
CurrentCell as its reference argument. This works properly.
<P>
<PRE>   A1: CubeRoot
   A2: =FOR.CELL("CurrentCell")
   A3: =FORMULA(CurrentCell^(1/3),CurrentCell)
   A4: =NEXT()
   A5: =RETURN()

</PRE>If a command such as FORMAT.FONT is used within the body of the loop,
you must first execute a SELECT statement because FORMAT.FONT doesn't
accept a reference as an argument. For example:
<P>
<PRE>   A1: =FOR.CELL("Current")
   A2: =SELECT(Current)
   A3: =FORMAT.FONT(2)
   A4: =NEXT()
   A5: =RETURN()

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Functions Reference," version 3.0, page 80
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 3.00  docerr command format font for<BR>
cell 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
