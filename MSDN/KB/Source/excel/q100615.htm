

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Using the /F Switch to Load Add-in Macros </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100615">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/06/23">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  An OPEN= statement in your Microsoft Excel settings file (EXCEL4.INI in version 4.0 for Windows, EXCEL5.INI in version 5.0 for Windows, or Excel Settings (4) on the Macintosh) will open the specified document automatically at startup. In addition, ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QAKR,QAHE,QBAO,QAY5,QAH4,QABA,QBWS,QDL9,QBWO,QBWN,QAB9,QBV8,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using the /F Switch to Load Add-in Macros</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100615</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0
<LI>Microsoft Excel for the Macintosh, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An OPEN= statement in your Microsoft Excel settings file (EXCEL4.INI in
version 4.0 for Windows, EXCEL5.INI in version 5.0 for Windows, or Excel
Settings (4) on the Macintosh) will open the specified document
automatically at startup. In addition, you can use one or both of the
following switches to control how this document is opened:
<P>
<PRE>   /R causes the document to be opened read only

   -and-

   /F causes the document to be fast loaded.

</PRE>"Fast load" means that a document is setup for use in Microsoft Excel; its
added functionality is available in dialog boxes, but the file itself is
not actually loaded until this functionality is selected.
<P>
When you use this switch to open an add-in macro, /F lists all of your add-
in's custom function macros in the Paste Function dialog box. However, to
get the "fast load" functionality, the add-in macro must also contain the
defined name __DemandLoad. With the combined /F switch on the OPEN= line
and the __DemandLoad defined name, the actual add-in is not loaded until
you enter or recalculate one of its custom functions.
<P>
NOTE: The actual definition of __DemandLoad is not important; you can use
the Boolean value of TRUE, for example.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The /F switch behaves as follows depending on the type of document you
are loading on the OPEN= line:

<UL><LI>Template: the template is placed in the New dialog box (from the
   File menu, choose new).

<LI>Macro Sheet: All custom functions on that macro sheet are placed in
   the Paste Function dialog box; the macro sheet is opened when one
   of those functions is used.

<LI>Add-in Macro Sheet: All custom functions are placed in the Paste
   Function dialog box. The add-in file will load when you use one of
   its custom functions ONLY when the name __DemandLoad is ALSO
   defined on the add-in sheet. Unless you have both components, /F in
   the settings file and __DemandLoad on the add-in sheet, the add-in
   will not load on demand but instead will be fully loaded when you
   start Microsoft Excel.
<P>
</UL>The easiest method for adding an OPEN= statement to your settings file
automatically is to use the Add-ins command (located on the Options
menu). In the Add-in Manager, when you select an add-in to add to the
startup list, the Add-in Manager writes an OPEN= line in the settings
file for you. If the add-in you're adding contains the __DemandLoad
defined name, the Add-in Manager includes the /F switch on the OPEN=
line.
<P>
Alternatively, you can directly edit the settings files. In the Microsoft
Windows operating environment, you can use a text editor to add OPEN=
statements, as well as other settings, to the EXCEL4.INI file (version 4.0
for Windows) or the EXCEL5.INI file (version 5.0 for Windows). See the
EXCEL4INI.TXT file for additional information. If you are using Microsoft
Excel for the Macintosh, the counterpart to the EXCEL4.INI file is the
Excel Settings (4) file. To make modifications to the Excel Settings (4)
file, you must use the ResEdit utility. ResEdit is available through
Macintosh user groups, or the Apple Programmers and Developers Association
(APDA).
<P>
<P><h2>REFERENCES</h2>
 
<P>
"EXCELINI.TXT"
"SDK User's Guide," page 441
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.0 4.00 4.0a 4.00a 5.0 5.00<BR>
Version           : WINDOWS: 4.0,4.0a,5.0; MACINTOSH: 4.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
