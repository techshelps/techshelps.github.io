

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using SEND.KEYS() to Change Paper Source in Printer Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q69614 ">
<META NAME="KBModify" CONTENT="1995/09/13">
<META NAME="KBCreate" CONTENT="1991/02/22">
<META NAME="Keywords" CONTENT="kbprint kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following macro will change the paper source to  lower tray  on the Helwett-Packard (HP) LaserJet IIP:     A1: =SEND.KEYS( %(S)~%(S){PGUP}{DOWN}~~ )    A2: =PRINTER.SETUP?()    A3: =RETURN()  This macro sends keystrokes to the Printer Setup dia...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYT,QBVP,QACT,QAA1,QAK6,QBXS,QDI2,QDIZ,QA2Q,QBVH,QBJZ,QAOX,QAXW,QABL,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using SEND.KEYS() to Change Paper Source in Printer Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q69614 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following macro will change the paper source to "lower tray" on
the Helwett-Packard (HP) LaserJet IIP:
<P>
<PRE>   A1: =SEND.KEYS("%(S)~%(S){PGUP}{DOWN}~~")
   A2: =PRINTER.SETUP?()
   A3: =RETURN()

</PRE>This macro sends keystrokes to the Printer Setup dialog box. The
following is an explanation of the string used in the SEND.KEYS()
function:
<P>
<PRE>   Command        Description
   -------        -----------

   %(S)           Chooses Setup
   ~              Chooses OK (Excel 3.00 only, see below **)
   %(S)           Selects "paper source"
   {PGUP}         Moves selection to the top to choose "upper tray"
   {DOWN}         Moves selection down one time to choose "lower tray"
   ~~             Chooses OK twice to enter the changes.

</PRE>** This is only needed in Microsoft Excel version 3.0 with printers
<PRE>   that support extended printer attributes accessible in Page Setup
   from the File menu. Epson printer drivers, for example, do not
   support these attributes; therefore, the tilde is not necessary.
   If you are not sure if your printer has these attributes, you can
   manually choose Printer Setup from the File menu and choose the
   setup button. If a dialog box is displayed with the following
   message, you need the tilde:

      This command controls default printer settings for all documents
      and all applications. Use File Page Setup to set Orientation,
      Paper Size, and Scaling for individual documents.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
In the Printer Setup dialog box, there is no accelerator key combination
that will directly select a paper source such as "lower tray." Instead,
the arrow keys should be used to select from the list of sources
available. On the HP LaserJet IIP, for example, there are four possible
choices for the paper source:

<UL><LI>Upper tray
<LI>Lower tray
<LI>Manual feed
<LI>Envelope
<P>
</UL>The problem is that the current selection is unknown. The following may
be the easiest way to select the right choice from the paper source
list:

<OL><P><LI>Assume that the current selection is not known. To change that
   assumption, select the first source ("upper tray"). PGUP will
   guarantee that "upper tray" is selected.
<P>
   Use "{PGUP}" (without the quotation marks) in the SEND.KEYS string.

<P><LI>Note how many times you want to use the {DOWN} string. The
   following is an example:
<P>
<PRE>      none                 for "Upper tray"
      {DOWN}               for "Lower tray"
      (DOWN){DOWN)         for "Manual feed"
      {DOWN}{DOWN}{DOWN}   for "Envelope"

</PRE></OL><h3>Notes</h3>
 

<OL><P><LI>The number of {DOWN} entries equals the choice number in the list
   box, minus one (that is, number of {DOWN} entries = [choice number
   in list box] - 1).

<P><LI>It is assumed that the right printer is selected.

<P><LI>Do not use the STEP() function before this macro or the keys sent
   will not work.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, page 385
"Microsoft Excel Function Reference," version 3.0, pages 214-215.
<P>
"Microsoft Excel for Windows Functions and Macros," version 2.1x, pages
353-254, 373-375
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kbmacro<BR>
KBSubcategory:
<P>

Additional reference words: 2.0 2.00 2.01 2.1 2.10 3.0 3.00 4.0 4.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
