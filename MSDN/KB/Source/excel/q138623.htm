

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: "Cannot Print to LPT1" Running Lotus Print Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138623">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1995/10/24">
<META NAME="Keywords" CONTENT="xlprint xlwin kberrmsg kbnetwork kbprint">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you run a Lotus 1-2-3 macro that performs a print command across a Novell network, you receive the following error messages     Macro error at cell:                 where                is the address of the macro's print sta...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBVP,QDJP,QAH4,QDL9,QBWO,QBWN,QBS0,QA1O,QAB4,QAKG,QAPN,QAB9,QAJC,QABM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "Cannot Print to LPT1" Running Lotus Print Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138623</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c
WINDOWS
kbnetwork kbprint kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you run a Lotus 1-2-3 macro that performs a print
command across a Novell network, you receive the following error messages
<P>
<PRE>   Macro error at cell: &lt;cell address&gt;

</PRE>where &lt;cell address&gt; is the address of the macro's print statement followed
by the error:
<P>
<PRE>   Error printing to LPT1

</PRE><h2>CAUSE</h2>
 
<P>
In order to print to a Novell Netware print queue, the LPT port must be
redirected (captured) to the appropriate server and print queue. Lotus 1-2-
3 requires the printer port be captured. Microsoft Windows, by default,
does not capture LPT ports. This capture must be done either at the MS-DOS
level or through your Novell login script.
<P>
For additional information on this error under Microsoft Windows 95, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A HREF="../EXCEL/Q152217.htm">Q152217</A></B>
   TITLE     : XL: Error Printing to LPT1 with 1-2-3 Print Macro in Win95

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use either of the following methods.
<P>
Method 1: Use the Novell Capture command at the MS-DOS prompt before you
<PRE>          enter Microsoft Windows to redirect or capture a printer port to
          a network server.

          For example, the following capture statement redirects LPT1 to
          the server named SERVER1 and the printer queue named QUEUE1. It
          also turns off form-feed, banners, and disables time-outs.

             capture L=1 s=SERVER1 q=QUEUE1 nff nt nb ti=0

          Once you have restarted Windows, go to the Printers dialog box in
          Control Panel and connect your default printer to the port used
          in the capture statement.

</PRE>Method 2: In place of the Lotus 1-2-3 print macro, use the XLCALL function.
<P>
<PRE>          Example
          -------

          The following Lotus macro prints the selected range:

             /ppr~agq

          Use the following in place of the above macro statement. The
          following runs a Microsoft Excel macro called Print_Macro to
          print the selected range.

             {XLCALL Print_Macro}

</PRE>Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<PRE>          Microsoft Excel Visual Basic macro example
          ------------------------------------------

          Sub Print_Macro
             Selection.PrintOut Copies:=1
          End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Novell Netware Capture command redirects workstation printer output to
a network print queue or file. The Capture command uses the following
syntax
<P>
<PRE>   capture L=x s=sss q=qqq nff nt nb ti=tt

</PRE>where:
<P>
<PRE>   L refers to the LPT port
   x = LPT port number (1, 2, or 3)
   s refers to the server
   sss = server name
   q refers to the server print queue
   qqq = printer queue name
   nff = no formfeed
   nt = no tab
   nb = no banner page
   ti refers to the retry Timeouts
   tt = time value (default is 10, 0 disables timeouts)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbprint kberrmsg<BR>
KBSubcategory: xlwin xlprint<BR>
Additional reference words: 5.00 5.00c<BR>
Keywords            : xlprint xlwin kberrmsg kbnetwork kbprint<BR>
Version             : 5.00 5.00c<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
