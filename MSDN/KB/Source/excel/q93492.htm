

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: GET.TOOLBAR(9) Function Returns Incomplete Array of IDs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q93492 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1992/12/13">
<META NAME="Keywords" CONTENT="kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you start Microsoft Excel, the docked tool bars are loaded before the floating tool bars. The way these tool bars are loaded may present a problem if you are using an Auto_Open macro that uses the GET.TOOLBAR(9) function. Since the Auto_Open m...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QAH4,QAIJ,QANS,QAF0,QAY5,QBWS,QDL9,QDIV,QBWQ,QBWO,QBWN,QBV8,QA2S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: GET.TOOLBAR(9) Function Returns Incomplete Array of IDs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q93492 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you start Microsoft Excel, the docked tool bars are loaded before the
floating tool bars. The way these tool bars are loaded may present a
problem if you are using an Auto_Open macro that uses the GET.TOOLBAR(9)
function. Since the Auto_Open macro may be run before the floating tool
bars are loaded, the GET.TOOLBAR(9) function will return an incomplete
array of tool bar IDs.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The GET.TOOLBAR() function is used to return information about one
tool bar or all tool bars. GET.TOOLBAR(9) returns an array of tool bar
IDs for all visible tool bars.
<P>
The GET.TOOLBAR() function may not return a complete array of tool bar
IDs if you use it in an Auto_Open macro (a macro that loads
automatically when you start Microsoft Excel). The following
situations will cause the macro to run before the floating tool bars
are loaded, which will result in an incomplete array of tool bar IDs.
<P>
<P><h3>Microsoft Excel for the Macintosh and Microsoft Excel for Windows</h3>
 

<UL><LI>Placing the sheet containing the Auto_Open macro in the XLSTART
   subdirectory in Microsoft Excel for Windows or placing it in the
   Startup Folder in Microsoft Excel for the Macintosh.
<P>
</UL><h3>Microsoft Excel for Windows</h3>
 

<UL><LI>Using an "open=" entry in the EXCEL4.INI (version 4.0) or EXCEL5.INI
   (version 5.0) to automatically open the sheet containing the Auto_Open
   macro when you start Microsoft Excel.
<P>
   -or-

<LI>Using an icon command line of "C:\Excel\Excel.exe\filename.xls"
   Where filename.xls is the file containing the reference to the
   Auto_Open macro.
<P>
</UL><h3>Workaround for Microsoft Excel for Windows</h3>
 
<P>
To load the floating tool bars before the macro is started, use one of
the following methods to start Microsoft Excel:

<UL><LI>Create an icon for Microsoft Excel with a command line of
   "filename.xls", where filename.xls is the file containing the
   reference to the Auto_Open macro.

<LI>From the File menu in Windows File Manager, choose the Run command
   to start "filename.xls", where filename.xls is the file containing
   the reference to the Auto_Open macro.
<P>
</UL>There is no workaround for Microsoft Excel for the Macintosh.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Online Help," version 5.0
"Function Reference," version 4.0, pages 206-207
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 4.0 4.00 4.0a 4.00a 5.0 5.00<BR>
float tool bar<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
