

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Run-Time Error 9 When Using a Macro to Remove Page Break </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170635">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/06/25">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you run a Visual Basic for Applications macro that attempts to remove a vertical or horizontal page break from a worksheet, you may receive the following error message:     Run-time error '9':    Subscript out of range  CA...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKS,QAEF,QAH4,QBVP,QBS0,QDKD P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Run-Time Error 9 When Using a Macro to Remove Page Break</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170635</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you run a Visual Basic for Applications macro
that attempts to remove a vertical or horizontal page break from a
worksheet, you may receive the following error message:
<P>
<PRE>   Run-time error '9':
   Subscript out of range

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if the following conditions are true:

<UL><LI>If the page break is a vertical page break, the problem occurs if no
   data is located to the right of the page break.
<P>
<P><PRE>    -or-
</PRE>
<LI>If the page break is a horizontal page break, the problem occurs if no
   data is located below the page break.
<P>
<P><PRE>    -and-
</PRE>
<LI>The macro uses either VPageBreaks(x).Delete or HPageBreaks(x).Delete
   to delete a page break. For example, either of these lines of code may
   fail:
<P>
<P><PRE>      ActiveSheet.VPageBreaks(1).Delete
</PRE><P>
<P><PRE>      ActiveSheet.HPageBreaks(2).Delete
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
If you know which column is immediately to the right of a vertical page
break, or which row is immediately beneath a horizontal page break, you can
remove the page break by setting the PageBreak property of the column or
row to xlNone.
<P>
For example, to remove a vertical page break to the left of column H, use a
line of code similar to the following:
<P>
<PRE>   ActiveSheet.Columns("H").PageBreak = xlNone

</PRE>To remove a horizontal page break below row 17, use the following code:
<P>
<PRE>   ActiveSheet.Rows(17).PageBreak = xlNone

</PRE>You can also prevent the problem from occurring by entering data either to
the right of or below manual page breaks in worksheets.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, you can use the Delete method of the VPageBreaks and
HPageBreaks collections to delete page breaks from worksheets. To use this
method, it is not necessary to know the exact location of the page break in
a worksheet; it is necessary to know only the page break you want to delete
(for example, the first, the second, and so on). For example, to delete the
sixth vertical page break from the active worksheet, you could use the
following line of code:
<P>
<PRE>   ActiveSheet.VPageBreaks(6).Delete

</PRE>Note that this method does not work if no data exists to the right of the
page break. Although deleting (or not deleting) such a page break has no
effect when you print the worksheet, you may want to delete extra page
breaks to keep the worksheets neat in appearance.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
