

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Problems Using SEND.KEYS Function in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q59432 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1990/03/08">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In some situations, the Microsoft Excel SEND.KEYS function may not work as desired. For example, if you have several sequences of keys that you would like to send to Microsoft Excel, and each must be completed before the next can be sent, SEND.KEYS...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH6,QAY5,QAMR,QBV8,QAB9,QAH4,QBC9,QBC8,QANO,QDKW,QA3W V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Problems Using SEND.KEYS Function in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q59432 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, versions 2.2 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In some situations, the Microsoft Excel SEND.KEYS function may
not work as desired. For example, if you have several sequences of
keys that you would like to send to Microsoft Excel, and each must
be completed before the next can be sent, SEND.KEYS may not
work as anticipated.
<P>
This problem occurs because of the way Microsoft Excel processes
the SEND.KEYS function. When Microsoft Excel is the active
application, the wait_log is assumed to be FALSE, even if you set
it to TRUE.
<P>
<P><h3>Workaround</h3>
 
<P>
To work around this problem, you must temporarily halt the macro to
process the keys and resume at the next line after an appropriate time
delay.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When this situation occurs, use the ON.TIME function in conjunction
with the HALT function to force Microsoft Excel to process each text
string before moving on to the next. For example, if String1 must be
processed before String2, use the following format:
<P>
<PRE>   A1:  Macro1
   A2:  =SEND.KEYS(String1)
   A3:  =ON.TIME(NOW()+0.000001,"Macro1.xlm!R5C1")
   A4:  =HALT()
   A5:  =SEND.KEYS(String2)
   A6:  =RETURN()

</PRE>In the above example, the ON.TIME function tells Microsoft Excel to
wait for about one second and then resume execution at the point
designated (Macro1.xlm!R5C1). The effect is that the macro
temporarily halts, allowing the first sequence of keys sent to Microsoft
Excel to be processed. After allowing Microsoft Excel enough time to
process those keys (in this case, one second), the macro starts back
up at the point designated and sends the second string.
<P>
Note: the information above also applies to version 5.0 only when using
version 4.0 macro language.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 3.0, page 168
"Functions and Macros," version 2.x, page 354
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21 3.0 3.00<BR>
4.0 4.00 4.0a 4.00a 5.0 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
