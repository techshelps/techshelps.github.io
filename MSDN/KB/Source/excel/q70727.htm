

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recalculation Problems Running Function Macros in Excel 3.00 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q70727 ">
<META NAME="KBModify" CONTENT="1994/11/04">
<META NAME="KBCreate" CONTENT="1991/03/28">
<META NAME="Keywords" CONTENT="kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  There are recalculation problems with function macros in the versions of Microsoft Excel listed above that are not present in Microsoft Excel version 2.1.  MORE INFORMATION  The Microsoft Excel versions above have problems recalculating function ma...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAKC,QBC6,QAXB,QAM9,QALX,QAKP,QDNZ,QAG8,QAY5,QAUD,QAC1,QBVV,QBD2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Recalculation Problems Running Function Macros in Excel 3.00</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 4, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q70727 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are recalculation problems with function macros in the versions of
Microsoft Excel listed above that are not present in Microsoft Excel
version 2.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Excel versions above have problems recalculating function
macros arranged in a columnar fashion.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open a new macro sheet and a new worksheet.

<P><LI>With the macro sheet active choose Define Name from the Formula
   menu. Set "z" (without the quotation marks) to zero.

<P><LI>On the macro sheet, type the following:
<P>
<P><PRE>      A1: =ARGUMENT("y",1)
      A2: z=z+y
      A3: =RETURN(z)
</PRE>
<P><LI>Select cell A1 on the macro sheet and define the macro as a
   function macro and with the name "counter" (without the quotation
   marks).

<P><LI>On the Worksheet, type the following data:
<P>
<PRE>      A1: 0                  B1: =MOD(A1,2)   C1: =Macro1!counter(B1)
      A2: 0
      A3: =MOD(A2,2)
      A4: =Macro1!counter(A3)

</PRE><P><LI>Cells A4 and C1 are counters. They display how many times cells A3
   and B1 have equaled zero. Both should show zero at this time.

<P><LI>Put the number 1 in cell A1; notice C1 equals 1. Again, reenter
   the number 1 in cell A1. Now, C1 equals 2. This is working correctly.

<P><LI>In cell A2, type the number 1. Cell A4 updates correctly to 3.

<P><LI>Reenter the number 1 into cell A2, cell A4 does not update. This is
   the problem.
<P>
</OL>Notice that if you reenter the number 1 into cell A1, C1 does update to the
number 4. The problem only occurs when the data is aligned in columns.
Excel notices that the number in cell A3 does not need to change, and
therefore cell A4 is not updated.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post more information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbmacro<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00 4.0 4.00 5.0 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 4, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
