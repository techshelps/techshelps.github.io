

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Custom AutoFilter Won't Filter Numbers Formatted as Text </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119257">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1994/08/11">
<META NAME="Keywords" CONTENT="kbualink97 kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the Custom AutoFilter dialog box to filter number values that have been entered as text, and you select the    comparison operator, all of the numbers are displayed, even if they are equal to the comparison value.  ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKC,QBC6,QAG8,QBT6,QBV4,QAKD,QBLS,QBWS,QATX,QAMB,QBVP,QA50,QAHP,QAG7,QAWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Custom AutoFilter Won't Filter Numbers Formatted as Text</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119257</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00
WINDOWS
kbother
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the Custom AutoFilter dialog box to filter
number values that have been entered as text, and you select the &lt;&gt;
comparison operator, all of the numbers are displayed, even if they are
equal to the comparison value.
<P>
<P><h2>CAUSE</h2>
 
<P>
The &lt;&gt; comparison operator is designed to filter records that are not equal
to the value that you use with the comparison criteria. However, this
criteria does not work to filter number values that are formatted as text.
<P>
This behavior affects numbers that meet the following conditions:

<UL><LI>Numbers in an imported database file when the numbers are contained in a
   column defined as a text field

<LI>Numbers that are entered in cells that are previously formatted as text

<LI>Numbers preceded by the apostrophe (') character
<P>
</UL>NOTE: When you select the = comparison operator, the numbers are correctly
filtered.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use one of the following methods:
<P>
<P><h3>Method 1</h3>
 
<P>
Enter the numbers first, format the numbers as text, and then filter the
numbers.
<P>
NOTE: Use Method 3 if the data you want to filter contains a zero value
that is formatted as text, such as "00."
<P>
<P><h3>Method 2</h3>
 
<P>
If you format the cells as text prior to entering the numbers, or if you
import data from another program and the numbers are formatted as text,
use the following steps to convert the text format to the number format:

<OL><P><LI>In a blank cell on the worksheet that contains the imported data, type
   the number 1.

<P><LI>Select the 1, and then click Copy on the Edit menu.

<P><LI>Select the range of imported numbers.

<P><LI>On the Edit menu, click Paste Special.

<P><LI>In the Paste Special dialog box, click Multiply, and then click OK.
<P>
</OL>NOTE: When you use this method, a zero value that is formatted as text,
such as "00" or "000" (without the quotation marks), is converted to the
number zero, "0" (without the quotation marks). Use Method 3 if the data
you are filtering contains a zero value that you do not want to convert to
the number zero.
<P>
<P><h3>Method 3</h3>
 
<P>
To filter records that are not equal to a number, use the &lt;&gt; comparison
operator and set the comparison criteria to the number followed by the * or
?. For example, to filter records that are not equal to the value 43, use
the comparison operator &lt;&gt; and the comparison criteria 43*.
<P>
The asterisk (*) wildcard character represents any series of characters,
while the question mark (?) represents any single character.
<P>
To use a wildcard character, follow these steps:

<OL><P><LI>Click in the column that contains the number values.

<P><LI>On the Data menu, click Filter, and then click AutoFilter. (AutoFilter
   should now have a check mark next to it.)

<P><LI>Click the drop-down arrow in the first cell in the range of number
   values that you want to filter, and click (Custom).

<P><LI>In the Custom AutoFilter dialog box, in the list of comparison operators
   (the first drop-down list), click &lt;&gt;.

<P><LI>In the text box to the right of the first drop-down box, type the number
   you are filtering, followed by an asterisk (*).

<P><LI>Click OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
When you filter zero values that are formatted as text, use the question
mark (?) wildcard to filter a specific zero value. For example, to search
for "00," type "0?" (without the quotation marks) in the text box. To
search for "000," type "0??" (without the quotation marks) in the text box.
<P>
Use the asterisk (*) wildcard to filter all other zero values except for
"0." For example, to search for "00," "000," "0000," and so on, type "0*"
(without the quotation marks) in the text box.
<P>
To exclude all zero values including "0", use the following steps:

<OL><P><LI>Click in the column that contains the number values.

<P><LI>On the Data menu, click Filter, and then click AutoFilter. (AutoFilter
   should now have a check mark next to it.)

<P><LI>Click the arrow in the first column in the range of number values that
   you want to filter, and click (Custom).

<P><LI>In the Custom AutoFilter dialog box, in the list of comparison operators
   (the first drop-down list), click &lt;&gt;.

<P><LI>In the text box to the right of the first drop-down box, type "0*"
   (without the quotation marks).

<P><LI>Click the And option.

<P><LI>Click the lower drop-down arrow, and click &lt;&gt;.

<P><LI>In the text box to the right, type "0" (without the quotation marks).

<P><LI>Click OK.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Custom AutoFilter Dialog Box, choose
the Search button in Help and type:
<P>
<PRE>   Custom AutoFilter dialog box
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:<BR>
Additional reference words: 5.00 5.00c 7.00 auto filter<BR>
Keywords            : kbualink97 kbother<BR>
Version             : 5.00 5.00c 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
