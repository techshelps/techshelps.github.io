

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: GP Fault Using PATTERNS Formula with Cell Selected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119571">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/08/18">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, if you run a MS Excel 4.0 macro that contains the PATTERNS formula, you receive a general protection (GP) fault if a cell on a worksheet or macro sheet is selected.  CAUSE =====  This behavior only occurs if you use ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QBVP,QAPF,QAB7,QALD,QAH4,QA2Q,QAB9,QAPN,QAG2,QAZM,QAZL,QAW6,QDNZ,QBJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: GP Fault Using PATTERNS Formula with Cell Selected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119571</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, if you run a MS Excel 4.0 macro that
contains the PATTERNS formula, you receive a general protection (GP)
fault if a cell on a worksheet or macro sheet is selected.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior only occurs if you use one of the syntax forms of the
PATTERNS formula for a chart item, or object, while a cell is
selected on a worksheet or macro sheet. The problem occurs because
the syntax forms of the PATTERNS formula for a chart item or object
contain up to 12 arguments, while the syntax form for a cell contains
only 4 arguments. If you use one of the syntax forms of the PATTERNS
formula that contain more than 4 arguments, while a cell is selected, you
receive a GP fault.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving a GP fault when you use the PATTERNS formula, do
either of the following:

<UL><LI>Select the chart item or object that you want to apply the pattern to
   before you use the macro that contains the PATTERNS formula.
<P>
   -or-

<LI>Activate the chart item or object that you want to format within the
   macro that contains the PATTERNS formula. In the following example, the
   plot area on Chart1 is selected, and then the PATTERNS formula is used:
<P>
</UL>Microsoft provides macro examples for illustration only, without
warranty either expressed or implied, including but not limited to
the implied warranties of merchantability and/or fitness for a
particular purpose. This macro is provided as is and Microsoft in no
way guaranties that the following code can be used in all situations
and will not support modifications of the code to suit specific
customer requirements.
<P>
<PRE>   A1: =WORKBOOK.SELECT("Chart1","Chart1")
   A2: =SELECT("Plot")
   A3: =PATTERNS(0,1,8,3,FALSE,0,1,2,2,FALSE,FALSE,FALSE)
   A4: =RETURN()

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in a
later version of Microsoft Excel.
<P>
In Microsoft Excel version 5.0c, if you use the incorrect syntax form of
the PATTERNS formula while a cell is selected, you receive a macro error
instead of a GP fault.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about PATTERNS, choose the Search button in
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>    PATTERNS function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 gpf
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
