

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Incorrect Usage of the TEXTREF Function May Return #REF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q72948 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/06/14">
<META NAME="Keywords" CONTENT="macrosheet kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QAY5,QAB9,QAB3,QBV8,QALW,QAWM,QAD2,QDO5,QBBI,QAH4,QAAP,QDKW,QDNZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Incorrect Usage of the TEXTREF Function May Return #REF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q72948 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The TEXTREF function was improved in Microsoft Excel version 3.0 to
allow the text argument to be specified as a general reference rather
than as a full external reference. In versions prior to 3.0, the text
argument in the TEXTREF function was required to be stated as a full
external reference when it referred to cells off the macro sheet.
Therefore, in versions prior to 3.0, referring to cell locations
located anywhere other than on the macro sheet that the TEXTREF
function is resident on without specifying the worksheet name in the
reference will cause the error #REF.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For example, if the TEXTREF function is being used to return the value
in cell B2 of the active worksheet, where B2 equals 5, the following
is true:

<OL><P><LI>In all versions of Excel up to and including version 3.0, the
   formula TEXTREF("'Sheet1'!r2c2",FALSE) would return the number 5.
   However, since this formula uses a full external reference, Excel
   will look only at cell B2 on Sheet1. To work around this
   limitation, you can use TEXTREF("'"&amp;GET.DOCUMENT(1)&amp;"'!r2c2",FALSE),
   where GET.DOCUMENT returns the name of the currently active
   document.

<P><LI>In Excel 3.0, the formula TEXTREF("!r2c2",FALSE) would also return
   5. However, since this formula is entered as a general reference,
   Excel will look at cell B2 on the active worksheet. In versions
   prior to 3.0, this formula would return #REF and therefore require
   the complete external reference as in 1 above.
<P>
</OL>Note: To use A1 style notation instead of R1C1 style notation in the
above examples, change every occurrence of "r2c2" to "B2" and "FALSE"
to "TRUE".
<P>
For more information on the TEXTREF function, see pages 235-236 of the
"Microsoft Excel Function Reference" version 3.0 manual or page 288 of
the "Microsoft Excel Functions and Macros" version 2.2 manual.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
