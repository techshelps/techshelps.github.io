

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSQuery: ErrorText Item Not Returned Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121598">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1994/10/11">
<META NAME="Keywords" CONTENT="kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use dynamic data exchange (DDE) to access data in Microsoft Query, the ErrorText item does not return any errors that have occurred if you have requested any of the following items:     DataSourceName    Logon    UserName  CAUSE =====  Thi...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QAGI,QBUG,QBUF,QBS0,QAZ2,QABM,QAI5,QAB9,QBVV,QAPN,QAUD,QAO4,QAB4,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQuery: ErrorText Item Not Returned Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121598</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Query for Windows 95, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use dynamic data exchange (DDE) to access data in Microsoft Query,
the ErrorText item does not return any errors that have occurred if you
have requested any of the following items:
<P>
<PRE>   DataSourceName
   Logon
   UserName

</PRE><h2>CAUSE</h2>
 
<P>
This behavior occurs if you request one of the items above in a DDE
conversation with Microsoft Query, and you then request the ErrorText
item.
<P>
For example, if an error occurs when you execute an SQL statement using
DDE, and you request the Logon item after this error occurs, the text of
the error from the SQL statement is not returned if the command that
requests the ErrorText item follows the command that requests the Logon
item.
<P>
This is by design of Microsoft Query. This behavior occurs because the
requests listed above contain ODBC calls, and the ErrorText item is reset
depending on the outcome of these ODBC calls.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, request the ErrorText item immediately
after you run an SQL statement that you want to check for errors.
Request the DataSourceName, Logon, or UserName items for a query
channel or active query on a system channel either before you run an
SQL statement, or after you request the ErrorText item.
<P>
The following is an example using a Visual Basic module in Microsoft
Excel version 5.0 that demonstrates returning the ErrorText item
using DDE statements:
<P>
<PRE>Sub Run_Query()

   ' Dimension variables used
   Dim chan As Integer, sql As String
   Dim dde_err As Variant, log_on As Variant

   ' Define sql statement
   sql = "[open('SELECT customer.CUSTMR_ID FROM c:data\customer.dbf')]"
   ' Establish DDE channel with Microsoft Query
   chan = DDEInitiate("MSQUERY", "System")

   ' Logon using dBase4 data source
   DDEExecute chan, "[Logon('dBase4')]"

   ' Request Logon item
   log_on = DDERequest(chan, "Logon")

   ' Run SQL statement
   DDEExecute chan, sql

   ' Request ErrorText item
   dde_err = DDERequest(chan, "ErrorText")
   ' Display ErrorText item in a message box
   MsgBox dde_err(1)

   ' Terminate DDE channel
   DDETerminate chan

End Sub

</PRE>Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DataSourceName item is available when you open a DDE channel with
Microsoft Query using the System topic. The Logon and UserName items are
available when you open a DDE channel with Microsoft Query using the window
name in Microsoft Query as the topic.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Query User's Guide," Chapter 9, "Using Dynamic Data
Exchange with Microsoft Query"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprg kbcode<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 1.00 2.00 5.00 5.00c 6.00 6.00a 6.00c 7.00<BR>
officeinterop empty null blank
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
