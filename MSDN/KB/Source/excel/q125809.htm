

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Specifying Smart Parse Column Delimiter from a Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125809">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1995/02/06">
<META NAME="Keywords" CONTENT="kbprg kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  To specify a particular character to be used as the column delimiter when you run the Smart Parse command from a user-defined macro, you can use the SEND.KEYS() command to specify the appropriate settings in the Smart Parse dialog box.  MORE INFORM...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVP,QARZ,QBWS,QDNU,QAE1,QBBI,QAH6,QDMN,QAG2,QAB9,QA2Q,QAY2,QAYM,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Specifying Smart Parse Column Delimiter from a Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125809</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To specify a particular character to be used as the column delimiter when
you run the Smart Parse command from a user-defined macro, you can use the
SEND.KEYS() command to specify the appropriate settings in the Smart Parse
dialog box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By default, the Smart Parse command (on the Data menu) uses a space as the
column-delimiter. If you want to run Smart Parse from a user-defined macro
and specify another character (a semicolon, for example) as the column
delimiter, use a macro similar to the following.
<P>
<P><h3>Sample Macro</h3>
 
<P>
Microsoft provides macro examples for illustration only, without
warranty either expressed or implied, including but not limited to
the implied warranties of merchantability and/or fitness for a
particular purpose. This macro is provided as is and Microsoft in no
way guaranties that the following code can be used in all situations
and will not support modifications of the code to suit specific
customer requirements.
<P>
This macro opens FLATFILE.XLA and performs a Smart Parse on the range
A1:A100. The data is parsed using semicolons for the column delimiters.
<P>
A1:  My_Smart_Parse
A2:  =ERROR(FALSE)+OPEN("C:\EXCEL\LIBRARY\FLATFILE.XLA")+ERROR(TRUE)
A3:  =RUN("FLATFILE.XLA!Auto_Open")
A4:  =SELECT(!A1:A100)
A5:  =SEND.KEYS("o{TAB}{;}~")
A6:  =RUN("FLATFILE.XLA!mcp05.SmartParse")
A7:  =ALERT("Finished.")
A8:  =RETURN()
<P>
To use a different character as the column delimiter, change the semicolon
inside the braces {} in line A5 to the character of your choice (for
example, you could use a comma, space, pound sign, and so on).
<P>
If you want to select the Remove Extra Blank Spaces check box, modify line
A5 to read as follows:
<P>
<PRE>   A5: =SEND.KEYS("o{TAB}{;}%{r}~")

</PRE><h3>Description of macro code above</h3>
 
<P>
A1: Macro name
<P>
A2: Turns off error-checking prior to opening FLATFILE.XLA (thus avoiding
<PRE>    the "Revert to saved 'FLATFILE.XLA'?" message that may appear), and
    then turns error-checking back on. If Microsoft Excel is not installed
    in C:\EXCEL, you need to modify the path in the OPEN statement
    accordingly.

</PRE>A3: Runs the FLATFILE.XLA Auto_Open routine (required for Smart Parse to
<PRE>    run properly).

</PRE>A4: Selects the data to parse.
<P>
A5: Places keystrokes in the buffer which, upon execution of the next
<PRE>    macro statement, will cause the 'Other' Column Delimiter field in the
    Smart Parse dialog box to be set to a semicolon (;). The last character
    inside the quotation marks command is a tilde.

</PRE>A6: Performs a Smart Parse on the selected data.
<P>
A7: Displays a message in an alert box, indicating that the macro has
<PRE>    finished.

</PRE>A8: Ends the macro.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, pages 314-315, 385
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbmacro<BR>
KBSubcategory:
<P>

Additional reference words: 4.00a 4.00 text textfile
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
