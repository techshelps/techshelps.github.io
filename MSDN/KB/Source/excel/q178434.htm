

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: Value Returned by Format Function May be Different </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178434">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1997/12/22">
<META NAME="Keywords" CONTENT="xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you run a Microsoft Visual Basic for Applications macro that uses the Format function to return a value using a specific format, the function may return a slightly different value, depending on what version of Microsoft Excel you are using.  C...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKD,QDNG,QAY5,QAK2,QACI,QAB9,QA01,QAKC,QBV8,QBS0,QAUD,QAJQ,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Value Returned by Format Function May be Different</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178434</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Microsoft Visual Basic for Applications macro that uses the
Format function to return a value using a specific format, the function may
return a slightly different value, depending on what version of Microsoft
Excel you are using.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when the following conditions are true:

<UL><LI>The format expression specified in the Format function uses fewer
   decimal places than the value being passed to the function. As a
   result, the value is rounded by the Format function.
<P>
   -and-

<LI>The value being passed to the Format function ends in the digit 5. For
   example:
<P>
<P><PRE>      1.15
      0.075
      8.885
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
There are two methods you can use to prevent this problem from occurring:

<UL><LI>Use the Round method of the Application object to round the value to
   the same number of decimal places as the format expression used by the
   Format function.
<P>
   For example, instead of the following:
<P>
<P><PRE>      X = Format(0.075, "$#.##")
</PRE><P>
   use this:
<P>
<P><PRE>      X = Format(Application.Round(0.075, 2), "$#.##")
</PRE><P>
   The Round method accepts two arguments; the value to be rounded (in
   this case, 0.075), and the number of decimal places to which you want
   the value to be rounded (in this case, 2).

<LI>Increase the number of decimal places used by the Format function.
<P>
   Example:
<P>
<P><PRE>      X = Format(0.075, "$#.###")
</PRE><P>
   Because the value and the format expression both use three decimal
   places, the problem will not occur.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design in Microsoft Excel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can demonstrate this problem by running Visual Basic code that
includes the following line:
<P>
<PRE>   MsgBox Format(0.075, "$#.##")

</PRE>In Microsoft Excel 5.x for Windows, the message box displays the value
$.08. In Microsoft Excel for the Macintosh, version 5.x, and Microsoft
Excel 98 Macintosh Edition, the message box displays the value $.07.
<P>
Note that the format expression ("$#.##") in this example uses two decimal
places, and that the value being passed to the function (0.075) uses three
decimal places. Because of this, the Format function rounds the value to
two decimal places before applying the format to the value, and the problem
may occur.
<P>
If you change the format expression to "$#.###", or if you first round the
value (0.075) to two decimal places, the message box displays the same
value in all versions of Microsoft Excel. The problem only occurs when the
value uses more decimal places than the format expression.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 XL5 IEEE<BR>
Keywords          : xlvbainfo<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
