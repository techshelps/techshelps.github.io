

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: "Illegal Operation" Opening a Non-Microsoft Excel File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159679">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/11/19">
<META NAME="Keywords" CONTENT="xlloadsave kberrmsg kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you open a file that does not use the Microsoft Excel file format, you may receive the following error message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contact the program vendor. ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAYS,QBWS,QAPN,QDNG,QA9N,QAB4,QAE2,QDNM,QAB2,QDNX,QDNZ,QAH4,QAKP,QDKW P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: "Illegal Operation" Opening a Non-Microsoft Excel File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159679</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a file that does not use the Microsoft Excel file format, you
may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to the
following:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at
   0137:304a7815.

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur when both of the following conditions are true:

<UL><LI>In an open workbook, you use either the Camera tool or the Paste
   Picture Link feature to create a picture that is linked to a range of
   cells.
<P>
<P><PRE>    -and-
</PRE>
<LI>You attempt to open a file that is in a format other than the Microsoft
   Excel file format.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use either of the following methods.
<P>
Method 1: Open the file that is not in Microsoft Excel file format before
<PRE>          you open the workbook that contains the picture.

</PRE>Method 2: If you open a workbook that contains a picture that is linked to
<PRE>          a range of cells, do not open any files other than Microsoft
          Excel files

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97 for
Windows. This problem was corrected in Microsoft Excel 97 for Windows,
Service Release 1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can create pictures of worksheet data, charts, and other objects and
use them as illustrations in a worksheet or a document that you create in
another program. You can resize, move, and edit a picture like a drawing
object.
<P>
To update a picture of worksheet cells after the original data changes,
link the picture to the source worksheet. For example, if you add numbers
to the original cells you copied, the linked picture is automatically
updated to include the new numbers.
<P>
You cannot link a picture of a chart. To create a chart that reflect
changes in its source data automatically, copy the chart and paste a linked
chart object in the destination file.
<P>
You can copy a picture in the picture or bitmap format. The picture format
uses less memory and disk space than the bitmap format, and allows
Microsoft Excel to display the picture more quickly. Images you save in the
picture format are displayed well at any resolution and work well when you
want to produce a high-quality printout or online presentation, such as a
chart for a presentation.
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating linked pictures to cell ranges, click
the Index tab in Microsoft Excel Help, type the following text
<P>
<PRE>   linked objects, captured

</PRE>and then double-click the selected text to go to the "Create pictures of
cells, charts, and other objects" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlloadsave kberrmsg kbualink97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
