

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Counting the Number of Characters in a Text Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95628 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/02/18">
<META NAME="Keywords" CONTENT="kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can count the number of characters in a text box by using the TEXT.BOX function in a macro.  MORE INFORMATION  An undocumented feature of the TEXT.BOX function is that it returns the number of characters in the text box. Car...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QBVP,QAKC,QAUD,QBC6,QAG8,QATX,QAMB,QAWN,QAY5,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Counting the Number of Characters in a Text Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95628 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, versions 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can count the number of characters in a text
box by using the TEXT.BOX function in a macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An undocumented feature of the TEXT.BOX function is that it returns
the number of characters in the text box. Carriage returns are also
counted as characters. The following macro will display the number of
characters in a selected text box in an Alert dialog box.
<P>
The macro is as follows (starting in cell A2 of the macro sheet):
<P>
<PRE>   A2: =SELECTION()
   A3: =TEXT.BOX("",A2,11000)
   A4: =ALERT("There are "&amp;A3&amp;" characters in "&amp;A2)
   A5: =RETURN()

</PRE>NOTE: There is no space between the quotation marks in line A3.
<P>
The formula in cell A2 above, returns the name of the selected text
box to cell A2 on the macro sheet.
<P>
Cell A3 uses the TEXT.BOX function to add a null after the last
character in your text box. Nothing gets added to the text box;
however, the number of characters in the text box will be returned to
cell A3. The number 11000 can be changed to any large number as long
as it is larger than the total number of characters that will be in
the text box. The maximum size allowed for a text box is 10,240
characters so 11000 is used because this number will always be larger
than the number of characters in the text box.
<P>
The formula in cell A4 uses the ALERT Function to display a dialog box
that displays how many characters are in the selected text box.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide 1," version 4.0, pages 282-283
"Microsoft Excel Function Reference," version 4.0, page 432
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 3.00 4.00 4.00a  limit<BR>
Keywords          : kbmacro<BR>
Version           : WINDOWS: 3.0, 4.0, 4.0a, 5.0; MACINTOSH: 3.0, 4.0, 5.0<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
