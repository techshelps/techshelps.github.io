

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Calculating Linear Regression </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51026 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/11/10">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="| 1 | Year | Quantity Sold | Predicted | (Yest-Yavg)^2 | (Y-Yavg)^2 | | 2 |   1  |     1250      |  1528.00  |  1546292.25   | 2314962.25 | | 3 |   2  |     1540      |  1883.29  |   788924.62   | 1516592.25 | | 4 |   3  |     1798      |  2238.57  |...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QAUD,QBVP,QAY2,QAKD,QBXS,QAB9,QBWS,QAG2,QA9N,QA5V,QA2Q,QAYZ,QAJN,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Calculating Linear Regression</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51026 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel can be very useful when you need to make predictions
of future data based on historical data. One of the most common
techniques used for making such predictions is that of linear
regression.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For example, assume you have accumulated eight years' worth of sales
figures for a company. These figures are as follows:
<P>
<PRE>     |   A  |       B
   ------------------------
   1 | Year | Quantity Sold
   2 |   1  |     1250
   3 |   2  |     1540
   4 |   3  |     1798
   5 |   4  |     3300
   6 |   5  |     4000
   7 |   6  |     3700
   8 |   7  |     3100
   9 |   8  |     3484

</PRE>From these numbers, you want to predict the sales for the next years
(years 9, 10, and 11). To accomplish this, use the Excel TREND()
function. The TREND() function accepts arrays of known y's and known
x's, and returns a linear trend of values along the best fit line for
these x's and y's. (Note: The cells in column C are formatted as
"0.00".)
<P>
<PRE>      |   A  |        B      |     C
    -------------------------------------
    1 | Year | Quantity Sold | Predicted
    2 |   1  |      1250     |  1528.00
    3 |   2  |      1540     |  1883.29
    4 |   3  |      1798     |  2238.57
    5 |   4  |      3300     |  2593.86
    6 |   5  |      4000     |  2949.14
    7 |   6  |      3700     |  3304.43
    8 |   7  |      3100     |  3659.71
    9 |   8  |      3484     |  4015.00
   10 |   9  |               |  4370.29
   11 |  10  |               |  4725.57
   12 |  11  |               |  5080.86

</PRE>In cells C2:C12, enter the formula =TREND(B2:B9,A2:A9,A2:A12) as an
array (by selecting C2:C12, typing the formula, and pressing
COMMAND+ENTER). In this formula, cells B2:B9 are the known y's, A2:A9
are the known x's, and A2:A12 are the new x's (the points on the line
for which we want to have y values returned).
<P>
You can now chart the data to view your results. If you're using Excel
2.20, do the following:

<OL><P><LI>Select the area A1:C12.

<P><LI>From the Edit menu, choose Copy to copy this area to the Clipboard.

<P><LI>From the File menu, choose New, select Chart, and click OK.

<P><LI>From the Edit menu, choose Paste Special (Values in Columns, Series
   Names in First Row, Categories in First Column).

<P><LI>From the Gallery menu, choose Line.
<P>
</OL>If you're using Excel version 1.00, 1.03, 1.04, 1.06, or 1.50, do the
following:

<OL><P><LI>Select the area C1:C12.

<P><LI>From the Edit menu, choose Copy to copy this area to the Clipboard.

<P><LI>From the File menu, choose New, select Chart, and click OK.

<P><LI>From the Edit menu, choose Paste.

<P><LI>Use the Gallery menu to make a line chart.

<P><LI>Using the Window menu, activate your worksheet.

<P><LI>Select the area B1:B9.

<P><LI>From the Edit menu, choose Copy.

<P><LI>Using the Window menu, activate the chart you created in Step 3.

<P><LI>From the Edit menu, choose Paste.
<P>
</OL>The chart created should look similar to the following (without the
labels):
<P>
<PRE>  6000.00|
         |
         |
  5000.00|     Predicted ==&gt; !
         |              ___ /
         |             /  /\  % &lt;== Actual
  4000.00|            / /   \/
         |           |/
         |          /|
  3000.00|        / /
         |      /  |
         |    /   /
  2000.00|  /   _/
         |/  _/
         ! /
  1000.00%
         |
         |
     0.00|
         ----------------------
         1 2 3 4 5 6 7 8 9 10 11

</PRE></OL>After predicting the values, you need to determine how accurately the
predicted line reflects the actual data. To do this, calculate the
coefficient of determination, or the "R squared" value, as follows:
<P>
<PRE>   r2=sum(Yest-Yavg)2/sum(Y-Yavg)2

</PRE>To begin with, calculate the average for the y's (Quantity Sold). In
cell B15, enter the formula =AVERAGE(B2:B9) and receive the result of
2771.50. The worksheet now looks like the following:
<P>
<PRE>      |   A  |       B       |       C
    --------------------------------------
    1 | Year | Quantity Sold |  Predicted
    2 |   1  |     1250      |   1528.00
    3 |   2  |     1540      |   1883.29
    4 |   3  |     1798      |   2238.57
    5 |   4  |     3300      |   2593.86
    6 |   5  |     4000      |   2949.14
    7 |   6  |     3700      |   3304.43
    8 |   7  |     3100      |   3659.71
    9 |   8  |     3484      |   4015.00
   10 |   9  |               |   4370.29
   11 |  10  |               |   4725.57
   12 |  11  |               |   5080.86
   13 |      |               |
   14 |      |               |
   15 | Yavg |               |   2771.5

</PRE>Next, establish two columns to represent the two parts of your
equation. In column D, enter the formula for (Yest-Yavg)2, and in
column E, enter the formula for (Y-Yavg)2. In cell D2, enter the
formula =(C2-$B$15)^2 and then fill the formula through cell D9. In
cell E2, enter the formula =(B2-$B$15)^2 and then fill this formula
down through cell E9. Now, calculate the coefficient of determination
in cell E15 by entering the formula =SUM(D2:D9)/SUM(E2:E9). (Note:
Columns C, D, and E are formatted as "0.00", and cell E15 is formatted
as "General".)
<P>
 
<PRE>|   |   A  |       B       |     C     |       D       |      E     |
</PRE> 
<PRE>| 1 | Year | Quantity Sold | Predicted | (Yest-Yavg)^2 | (Y-Yavg)^2 |
| 2 |   1  |     1250      |  1528.00  |  1546292.25   | 2314962.25 |
| 3 |   2  |     1540      |  1883.29  |   788924.62   | 1516592.25 |
| 4 |   3  |     1798      |  2238.57  |   284012.86   |  947702.25 |
| 5 |   4  |     3300      |  2593.86  |    31556.98   |  279312.25 |
| 6 |   5  |     4000      |  2949.14  |    31556.98   | 1509212.25 |
| 7 |   6  |     3700      |  3304.43  |   284012.86   |  862112.25 |
| 8 |   7  |     3100      |  3659.71  |   788924.62   |  107912.25 |
| 9 |   8  |     3484      |  4015.00  |  1546292.25   |  507656.25 |
|10 |   9  |               |  4370.29  |               |            |
|11 |  10  |               |  4725.57  |               |            |
|12 |  11  |               |  5080.86  |               |            |
|13 |      |               |           |               |            |
|14 |      |               |           |               |            |
|15 | Yavg |     2771.5    |           |               | 0.658952019|
</PRE> 
<P>
The closer the R squared value comes to 1, the better the fit of data
points to the predicted values. In this case, the R squared value
returned is .65895, which represents a fairly good fit, but also
indicates that our predicted values are not very reliable.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 1.00 1.03 1.04 1.06 1.50 2.20<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
