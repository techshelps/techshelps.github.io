

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: New Database Query File Format for MS Query 8.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180272">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1998/01/30">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Query 8.0 for Microsoft Excel 98 Macintosh Edition uses a new database query file format. This article discusses the new format and how to use it with earlier versions of Microsoft Query.  MORE INFORMATION  The database query format is th...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QBVP,QAUR,QACF,QATX,QAMB,QAZV,QBVV,QAU7,QDNG,QBRZ,QBJ2,QAPF,QAHE,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: New Database Query File Format for MS Query 8.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180272</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Query 8.0 for Microsoft Excel 98 Macintosh Edition uses a new
database query file format. This article discusses the new format and how
to use it with earlier versions of Microsoft Query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The database query format is the default file format that is used when you
use the Save command in Microsoft Query 8.0. For backward compatibility,
Microsoft Query 8.0 continues to support Microsoft Query version 1.0 files
when you save and open these files. When you open a query file and edit it
in Microsoft Query 8.0, features that cannot be represented in the query
file format are not available. For example, parameterized query
functionality is not available because this feature is not available in
earlier versions of Microsoft Query. Also, if you create a query in
Microsoft Query 8.0 and use features that are not supported in
earlier versions, you cannot save the query file as a version 1.0 file
until you remove the new functionality.
<P>
The database query format is designed to be small, simple, and efficient.
Note that most of the presentation information that can be saved in version
1.0 files is not retained in the database query. Defaults are substituted
for some items, such as window, table, and document positions. When you
perform a new query, version 1.0 files are not supported by the Microsoft
Excel Run Query command or by the Queries tab in the Choose Data Source
dialog box.
<P>
When you save a query in Microsoft Query 8.0, Microsoft Query saves a text
file that consists of at least four lines of text that are each separated
by carriage returns and line feed characters. Note that these characters
typically do not appear in a text editor.
<P>
The format of the Database Query file is as follows:
<P>
<PRE>   XLODBC
   1
   &lt;DSN Name &gt;
   &lt;SQL String&gt;
   &lt;Parameter names&gt;
   &lt;Parameter data types&gt;
   &lt;Column Names&gt;

</PRE>Note that XLODBC is the type, 1 refers to Microsoft Query 8.0, and the
&lt;Parameter names&gt;, &lt;Parameter data types&gt;, and &lt;Column names&gt; lines are
tab delimited.
<P>
<P><h3>Sample Database Query File</h3>
 
<P>
In the following example, text is wrapped to allow you to view it easily.
In an actual query text file, the SQL string text is not wrapped. The
following is a sample query file in Microsoft Query 8.0:
<P>
<PRE>   XLODBC
   1
   DSN=MydBASE
   SELECT CUSTOMER.CUSTMR_ID, CUSTOMER.COMPANY, CUSTOMER.CONTACT,
   CUSTOMER.CON_TITLE, CUSTOMER.ADDRESS, CUSTOMER.CITY,
   CUSTOMER.REGION, CUSTOMER.ZIP_CODE, CUSTOMER.COUNTRY,
   CUSTOMER.PHONE, CUSTOMER.FAX FROM 'HD:Microsoft Office
   98:Sample Files:Sample Databases':'CUSTOMER.DBF' CUSTOMER


   CUSTMR_ID   COMPANY   CONTACT   CON_TITLE   ADDRESS   CITY
   REGION   ZIP_CODE   COUNTRY   PHONE   FAX

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using database query files, click the
Index button in Microsoft Query Help, type the following text
<P>
<PRE>   saving queries

</PRE>and then double-click the selected text to go to the "Save a query" topic.
<P>
For more information about creating a parameter query from Microsoft Excel,
click the Index button in Microsoft Excel Help, type the following text
<P>
<PRE>   parameter query

</PRE>and then double-click the selected text to go to the "Create a new query"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.0 XL98 dqy qry<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
