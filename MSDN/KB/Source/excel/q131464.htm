

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: "Filename Is Not Valid" Error Saving or Opening File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131464">
<META NAME="KBModify" CONTENT="1997/04/14">
<META NAME="KBCreate" CONTENT="1995/06/12">
<META NAME="Keywords" CONTENT="xlloadsave xlwin kberrmsg kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you open or save a file in Microsoft Excel, you may receive one of the following error messages:     Filename is not valid     -or-     The file could not be accessed.     -or-     The path you entered, '          ', is too long. Enter a short...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QAUR,QABN,QAFI,QAUJ,QA2S,QDL9,QBWO,QBWN,QAU7,QAWN,QAKE,QBVV,QAR6 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "Filename Is Not Valid" Error Saving or Opening File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131464</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open or save a file in Microsoft Excel, you may receive one of the
following error messages:
<P>
<PRE>   Filename is not valid

   -or-

   The file could not be accessed.

   -or-

   The path you entered, '&lt;filename&gt;', is too long. Enter a shorter path.

</PRE><h2>CAUSE</h2>
 
<P>
This error message occurs when you save or open a file if the path to the
file (including the filename) exceeds 219 characters. This limitation
includes three characters for the drive, the characters in folder names,
the backslash character between folders, and the filename itself.
<P>
This behavior is based on a 256-character limitation for creating links to
another file. This limit is by design in Microsoft Excel because of the way
that Microsoft Excel uses the filename internally. This behavior limits the
path name to 219 characters. This limit of 219 characters for the path name
is based on the following:

<UL><LI>Up to 31 characters in a sheet name

<LI>Apostrophes and brackets used to denote the workbook name

<LI>An exclamation point

<LI>A cell reference
<P>
</UL>For example, the path for a file in Microsoft Excel for Windows might be:
<P>
<PRE>   'c:\excel\personal\...\[my workbook.xls]up_to_31_char_sheetname'!$A$1

</PRE><h2>RESOLUTION</h2>
 
<P>
To avoid receiving this error message when you open or save a file in
Microsoft Excel, make sure that the path to the file contains fewer than
219 characters. You can do this by doing any of the following:

<UL><LI>Rename the file so that it has a shorter name.
<P>
   -or-

<LI>Rename the folder(s) that contain the file so that they have shorter
   names.
<P>
   -or-

<LI>Move the file to a folder with a shorter path name.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Excel</h3>
 
<P>
Note that in the File Name box in the Save As dialog box, you can type up
to 255 characters. However, when you click OK to save the file, you receive
the following error message
<P>
<PRE>   The path '&lt;filename&gt;' exceeds 255 characters.

</PRE>and you cannot save the file. When you save a file in Microsoft Excel, if
the number of characters in the file path exceeds 255, the Microsoft
Windows limit, then you receive the "path exceeds 255 characters" error
message instead of the "filename is not valid" error message.
<P>
<P><h3>Windows 95</h3>
 
<P>
In Microsoft Windows version 95, the limitation for the path name for a
file is 255 characters. When you rename a file in Explorer or My Computer,
you are unable to type more characters when you reach the 255 character
limit for the path to the file.
<P>
If you move a file to a subfolder where the path would exceed 255
characters, you receive the following error message:
<P>
<PRE>   Cannot move &lt;filename&gt;: the filename you specified is invalid or too
   long. Specify a different filename.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 8.00 97 XL97 218<BR>
Keywords            : xlloadsave xlwin kberrmsg kbother<BR>
Version             : 7.00 97<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
