

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Null Fields Returned with Values Using SQL Functions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125184">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1995/01/22">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the SQLRetrieve function or the SQLRequest function to return data from an external database, a field in the database that does not contain data may be returned with a value.  CAUSE =====  This behavior occurs when ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBVP,QAY5,QBS0,QAVX,QAVW,QAB9,QAYY,QBV8,QALW,QAZV,QAG9,QA1S,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Null Fields Returned with Values Using SQL Functions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125184</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the SQLRetrieve function or the SQLRequest
function to return data from an external database, a field in the database
that does not contain data may be returned with a value.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when you use the SQLRetrieve function or the
SQLRequest function available in the ODBC Add-in file, XLODBC.XLA, to
return data from an external database. When the database contains a column
of number data type values, and one of the fields in this column is empty
(null), the value in the previous field in the database is returned for
this field when the data is returned to a worksheet in Microsoft Excel.
<P>
For example, if you use the SQLRetrieve function to return the following
data to a worksheet
<P>
<PRE>   Name    Number
   Blue         3
   Yellow
   Red          4

</PRE>the following data is returned to the worksheet:
<P>
<PRE>   Name    Number
   Blue         3
   Yellow  Yellow
   Red          4

</PRE>This problem has been reported using the following data sources:
<P>
<PRE>   Microsoft Access 2.0
   DEC 1.10
   Oracle 6
   Oracle 7
   SAS

</PRE>Note that this problem does not occur with columns of text data type.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, use the functions in the Microsoft
Query add-in, the XLQUERY.XLA file to return data from an external
database to a worksheet in Microsoft Excel. The following example
returns a query from the table "test" in the DB1.MDB database using a
Microsoft Access 2.0 data source. The data is returned to cell A1 on
Sheet1 in BOOK1.XLS:
<P>
<PRE>   Sub ReturnData()
      QueryGetData "DSN=Access 2.0;DBQ=DB1.MDB;DefaultDir=C:\ACCESS;", _
         "SELECT test.Name, test.Number FROM test test", _
        True, True, False, Range("[BOOK1.XLS]Sheet1!$A$1")
   End Sub

</PRE>Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft
products listed at the beginning of this article. This problem was
corrected in Microsoft Excel version 5.0c.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the SQLRetrieve Function, choose the
Search button in the Visual Basic Reference and type:
<P>
<PRE>    SQLRetrieve Function

</PRE>For more information about the QueryGetData Function, choose the
Search button in the Visual Basic Reference and type:
<P>
<PRE>    QueryGetData Function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory: xlwin
<P>

Additional reference words: 5.00 5.00a oracle
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
