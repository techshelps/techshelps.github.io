

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: VLOOKUP()/HLOOKUP() Return Incorrect Value with TFE or AEE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87442 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/07/30">
<META NAME="Keywords" CONTENT="kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the VLOOKUP and HLOOKUP functions, the incorrect value or #VALUE error message is returned if Transition Formula Evaluation (TFE) (Excel version 5.0 or later) or Alternate Expression  Evaluation (AEE) is selected (E...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QA28,QAKD,QATJ,QAB9,QBV8,QAAP,QAY5,QAKR,QAG9,QABH,QALW P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: VLOOKUP()/HLOOKUP() Return Incorrect Value with TFE or AEE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87442 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the VLOOKUP and HLOOKUP functions, the
incorrect value or #VALUE error message is returned if Transition Formula
Evaluation (TFE) (Excel version 5.0 or later) or Alternate Expression 
Evaluation (AEE) is selected (Excel version 4.0).
<P>
<P><h2>CAUSE</h2>
 
<P>
VLOOKUP and HLOOKUP return the index in the lookup array instead of the
value at that index if TFE or AEE is selected and the col_index_num
(row_index_num for HLOOKUP()) argument is set to 1.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To return the correct value when you use the VLOOKUP or HLOOKUP function,
disable TFE or AEE by using one of the following methods.
<P>
<P><h3>Microsoft Excel Versions 5.0 and Later</h3>
 
<P>
To disable Transition Formula Evaluation, follow these steps:

<OL><P><LI>On the Tools menu, click Options (or Preferences). Click the Transition
   tab.

<P><LI>Under Sheet Options, clear the Transition Formula Evaluation check box,
   and click OK.
<P>
</OL><h3>Microsoft Excel Version 4.0</h3>
 
<P>
To disable Alternate Expression Evaluation, follow these steps:

<OL><P><LI>On the Options menu, click Calculation.

<P><LI>Under Sheet Options, clear the Alternate Expression Evaluation check
   box and click OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Transition Formula Evaluation and Alternate Expression Evaluation are
options designed to allow for differences between the way Microsoft Excel
and Lotus 1-2-3 evaluate expressions. This option is automatically enabled
when you open a Lotus 1-2-3 worksheet in Microsoft Excel.
<P>
The VLOOKUP and HLOOKUP functions search the first column of an array
(top row with HLOOKUP) for a particular value and return the value in the
cell indicated by the index argument. However, these functions may return
the incorrect value if TFE or AEE is enabled.
<P>
<P><h3>Example</h3>
 
<P>
To use this example, enter the following data:
<P>
<PRE>   A1: Blue   B1: 10
   A2: Green  B2: 20
   A3: Red    B3: 30

</PRE></OL>The formula =VLOOKUP("Blue",A1:B3,1) returns the value 0 (array index to
cell A1) if TFE or AEE is enabled and the value "Blue" if TFE or AEE is not
enabled.
<P>
NOTE: Array indexes start with 0 so the index to A1 is 0, A2 is 1, and
so on.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide 1," version 4.0, page 57
<P>
"Switching to Microsoft Excel from Lotus 1-2-3," version 4.0, pages
10-11
<P>
"Microsoft Excel Function Reference," version 4.0, pages 221-222, 450-
451
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.0 4.00 5.00 5.00a 5.00c 7.00 7.00a 97 98 XL98 <BR>
XL97 XL7 XL5 XL4<BR>
Keywords          : kb3rdparty<BR>
Version           : WINDOWS:4.0,4.0a,5.0,5.0c,7.0,7.0a,97; MACINTOSH:4.0,5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
