

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: Cannot Use External References with Data Validation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179859">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1998/01/26">
<META NAME="Keywords" CONTENT="xlformula xlui kbui">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you type a cell reference to a cell in the Source or Formula box in the Data Validation dialog box, and then click OK, the following message appears:     You may not use references to other worksheets or workbooks    for Data Validation criter...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKR,QDNZ,QBWS,QAYY,QAPF,QANX,QBVP,QAP2,QAKD,QBJZ,QAKC,QAJQ,QAWM,QAK9,QAD7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Cannot Use External References with Data Validation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179859</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you type a cell reference to a cell in the Source or Formula box in
the Data Validation dialog box, and then click OK, the following message
appears:
<P>
<PRE>   You may not use references to other worksheets or workbooks
   for Data Validation criteria.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>You select the cells to which you want to apply data validation, and
   click Validation on the Data menu.
<P>
   -and-

<LI>You click the Settings tab, and click Settings (or Custom) in the Allow
   list.
<P>
   -and-

<LI>You specify a cell reference to a cell in another worksheet or workbook
   in the Source (or Formula) box.
<P>
</UL>The Validation command allows you to place restrictions on data that
is typed into specific cells. However, the cells that contain the data
criteria can refer only to cells within the same worksheet as the cells
that are restricted.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use a local cell to refer to the criteria
cell. To do this, use one of the following methods.
<P>
<P><h3>Method 1: Use a Local Cell that Refers to the External Cell</h3>
 

<OL><P><LI>On the File menu, click New, click Workbook, and then click OK.

<P><LI>Select cell A1.

<P><LI>On the Data menu, click Validation and click the Settings tab.

<P><LI>In the Allow box, click Whole number.

<P><LI>In the Data box, click Equal To.

<P><LI>In the Value box, type a reference to a cell on the worksheet, for
   example, type "=$B$1" (without the quotation marks).

<P><LI>Click OK.

<P><LI>In the cell you referenced in step 6, type a formula that refers to the
   external criteria cell. For example, in cell B1, type the following
   formula:
<P>
<P><PRE>      =Sheet2!$C$1
</PRE>
<P><LI>In the external cell, type the criteria value you want to use for data
   validation. For example, in cell C1 of Sheet2, type the number 5.
<P>
   You can type only the data validation criteria (for example 5) in cell
   A1 of Sheet1.
<P>
</OL><h3>Method 2: Use INDIRECT to Return a Value in the External Cell</h3>
 

<OL><P><LI>On the File menu, click New, click Workbook, and then click OK.

<P><LI>Select cell A1.

<P><LI>On the Data menu, click Validation and click the Settings tab.

<P><LI>In the Allow box, click Whole number.

<P><LI>In the Data box, click Equal To.

<P><LI>In the Value box, type the following formula:
<P>
<P><PRE>      =Indirect("Sheet2!$C$1")
</PRE>
<P><LI>Click OK.

<P><LI>In cell C1 of Sheet2, type the number 10.
<P>
</OL>You can type only the data validation criteria (for example 10) in cell A1
of Sheet1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel 98 Macintosh Edition allows you to specify what data is
valid for individual cells or for cell ranges in a worksheet. This is
called data validation. To use data validation, click Validation on the
Data menu.
<P>
Restrictions include values, dates, times, or lists of text or values, and
can be limited to exact matches or ranges of cells. You can type the valid
values in the Data Validation dialog box or you can store them in worksheet
cells. These validating cells must be on the same worksheet as the cells
want to restrict.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about data validation, click the Index button in
Microsoft Excel Help, and type the following text:
<P>
<PRE>   data validation, overview

</PRE></OL>and then double-click the selected text to go to the "About defining the
valid entries for a cell" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 8.00<BR>
Keywords          : xlformula xlui kbui<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>
Solution Type     : kbnofix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
