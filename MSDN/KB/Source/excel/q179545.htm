

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: EOMONTH Function May Be Incorrect If Date Is in February </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179545">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1998/01/19">
<META NAME="Keywords" CONTENT="xladdins">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed above, if you use the EOMONTH function to return the last day of a month, the function may return the first day of the next month instead.  For example, the EOMONTH function may incorrectly return 3/1/2100 ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QACE,QBVP,QAY5,QAML,QAB9,QALW,QAAP,QBV8,QAGJ,QBVV,QAR4,QAPF,QAKP,QA6A P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: EOMONTH Function May Be Incorrect If Date Is in February</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179545</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed above, if you use the EOMONTH
function to return the last day of a month, the function may return the
first day of the next month instead.
<P>
For example, the EOMONTH function may incorrectly return 3/1/2100 (March 1,
2100) instead of 2/28/2100 (February 28, 2100).
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the date returned by the EOMONTH function meets
the following conditions:

<UL><LI>The date is in February.
<P>
   -and-

<LI>The date is in a century year that is not evenly divisible by 400, for
   example:
<P>
<P><PRE>      2100, 2200, 2300, 2500, 2600, 2700, 2900, 3000
</PRE><P>
</UL>NOTE: This problem does not occur if the date is in year 1900 or 2000.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Because the EOMONTH function should always return a date at the end of the
month, you can modify the formulas so that they subtract one from the date
returned by the EOMONTH function if the date is not at the end of the
month. This forces the function to return the correct date, for example:
<P>
<PRE>   A1: 1/1/2100
   A2: =EOMONTH(A1,1)

</PRE>The formula in cell A2 returns 3/1/2100, an incorrect date. However, if you
change the formula:
<P>
<PRE>   A1: 1/1/2100
   A2: =IF(DAY(EOMONTH(A1,1))=1,EOMONTH(A1,1)-1,EOMONTH(A1,1))

</PRE>The formula returns the correct date (2/28/2100) even though the date falls
in February of a century year that is not evenly divisible by 400.
<P>
This is how the formula works:
<P>
<PRE>   If the day of the end of the month is 1, recalculate the end of the
   month, subtract one, and return the date. Otherwise, recalculate the
   end of the month and return the date.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The EOMONTH function, which is included in the Analysis ToolPak, allows you
to return the date of the last day in a month. For example, if you want to
determine the last day of the month six months from today's date, use the
following formula:
<P>
<PRE>   =EOMONTH(TODAY(),6)

</PRE>If today is 1/13/98, the function returns 7/31/98: the last day of the
month six months from today.
<P>
The problem described in this article occurs only when the EOMONTH function
returns a date in February of a century year that is not a leap year, for
example:
<P>
<PRE>   A1: 1/1/2000   B1: =EOMONTH(A1,1)
   A2: 1/1/2100   B2: =EOMONTH(A2,1)
   A3: 1/1/2200   B3: =EOMONTH(A3,1)
   A4: 1/1/2300   B4: =EOMONTH(A4,1)
   A5: 1/1/2400   B5: =EOMONTH(A5,1)

</PRE>The formulas in cells B1 and B5 return the correct results (2/29/2000 and
2/29/2400) because the dates are in century years that are evenly divisible
by 400.
<P>
The formulas in cells B2, B3, and B4 return incorrect results (3/1/2100,
3/1/2200, 3/1/2300) because the dates are in century years that are not
evenly divisible by 400.
<P>
For more information about leap years, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q118923.htm">Q118923</A></B>
   TITLE     : XL: Method to Determine Whether a Year Is a Leap Year
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 y2k year2000<BR>
Keywords          : xladdins<BR>
Version           : WINDOWS:97; MACINTOSH:98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
