

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: "File Not Found" Error Using References Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120404">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1994/09/11">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the Windows 95 registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   In ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QBWS,QBS0,QDL9,QBWO,QBWN,QBQU,QBJ4,QBWP,QBWQ,QAB4,QAH4,QAF0,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: "File Not Found" Error Using References Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120404</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the Windows 95
registry. Before you edit the registry, you should first make a backup copy
of the registry files (System.dat and User.dat). Both are hidden files in
the Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a Visual Basic module, if you click References on the Tools menu, you
may receive the following error message:
<P>
<PRE>   File Not Found

</PRE>In addition, when you attempt to open a workbook that contains a module
sheet, you may receive the message:
<P>
<PRE>   Error 48: Error in loading DLL

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>You perform a workstation installation of Microsoft Excel.
<P>
   -and-

<LI> In a Visual Basic module, you click References on the Tools menu.
<P>
</UL>When you perform a workstation installation of Microsoft Excel 5.0, most of
the program files are run from the server, including Xlen50.olb and
Vbaen.olb, the Microsoft Excel and Visual Basic for Applications, object
library files. By default, these files are listed in the References dialog
box as available object libraries. However, when you use the References
dialog box in a Visual Basic module as described in this section, and the
server uses the universal naming convention (UNC), Microsoft Excel cannot
locate these files.
<P>
Note that this error may also occur if Microsoft Excel cannot locate the
Stdole.tlb file.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, copy the Xlen50.olb and Vbaen.olb files to the
appropriate location on your computer. For example, copy these files to the
following locations.
<P>
<PRE>   File           Folder
   -----------------------------

   Xlen50.olb     Excel
   Vbaen.olb      Windows\System

</PRE>After you copy the files locally, use the appropriate following procedure.
<P>
Microsoft Excel 5.0 Under Windows 3.1:
<P>
To edit the Reg.dat file to point to new locations, use the following
steps:

<OL><P><LI>In Program Manager, click Run on the File menu.

<P><LI>In the command line box, type "regedit /v" (without the quotation
   marks).

<P><LI>On the Search menu, click Find Key. In the Find What box, type
   "win16" (without the quotation marks), and click Find Next.

<P><LI>On the Search menu, click Find Next until you locate the following
   entry
<P>
<P><PRE>      WIN16=\\&lt;EXCEL&gt;\XLEN50.OLB.
</PRE><P>
   where &lt;EXCEL&gt; is the network server directory from which you are
   running Microsoft Excel.

<P><LI>Select the entry and edit the text in the Value box to reflect
   the new location of Xlen50.olb, for example:
<P>
<P><PRE>      C:\Files\Xlen50.olb.
</PRE>
<P><LI>On the File menu, click Exit. Click Yes to save the changes.

<P><LI>Repeat steps 1-7 to move Vbaen.olb (and Stdole.tlb) and to modify the
   Reg.dat file to point to its new location.

<P><LI>Restart Microsoft Windows.
<P>
</OL>Microsoft Excel 5.0 Under Windows NT 3.51:
<P>
To edit the registry to point to new locations, use the following steps:

<OL><P><LI>In Program Manager, click Run on the File menu.

<P><LI>In the command line box, type "regedit /v" (without the quotation
   marks). Click OK.

<P><LI>On the Search menu, click Find Key.

<P><LI>Type the following in the Find What box
<P>
<P><PRE>      \TypeLib\{000204F3-0000-0000-C000-000000000046}\1.0\9\Win16
</PRE><P>
   and then click Find Key.

<P><LI>Modify the value of this key to use the new path of Vbaen.olb (the value
   box is at the top of the window below the menu bar) and press ENTER.

<P><LI>On the Search menu, click Find Key.

<P><LI>Type the following in the Find What box
<P>
<P><PRE>      \TypeLib\{00020813-0000-0000-C000-000000000046}\1.0\9\Win16
</PRE><P>
   and click Find Key.

<P><LI>Modify the value of this key to use the new path of Xlen50.olb (the
   value box is at the top of the window below the menu bar) and press
   ENTER.

<P><LI>On the File menu, click Exit. Click Yes to save changes.

<P><LI>Restart Windows.
<P>
</OL>Microsoft Excel 5.0 Under Windows 95 or Windows NT 4.0:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
To edit the registry to point to new locations, use the following steps:

<OL><P><LI>On the Start menu, click Run.

<P><LI>Type "regedit" (without the quotation marks), and click OK.

<P><LI>In the Registry window, click the plus sign (+) to the left of the
    following keys, in order
<P>
       HKEY_CLASSES_ROOT
       TypeLib
       {000204F3-0000-0000-C000-000000000046}
       1.0
       9
<P>
    to open the following registry key:
<P>
       My Computer\HKEY_CLASSES_ROOT\TypeLib\{000204F3-0000-0000-C000-
       000000000046}\1.0\9
<P>
    Then, click the folder to the left of Win16. The following key appears
    in the status bar:
<P>
       My Computer\HKEY_CLASSES_ROOT\TypeLib\{000204F3-0000-0000-C000-
       000000000046}\1.0\9\Win16

<P><LI>Click the entry for Vbaen.olb.

<P><LI>On the Edit menu, click Modify.

<P><LI>Change the Value Data to the new path for Vbaen.olb and click OK.

<P><LI>In the Registry window, click the plus sign (+) to the left of the
    following keys, in order
<P>
       HKEY_CLASSES_ROOT
       TypeLib
       {00020813-0000-0000-C000-000000000046}
       1.0
       9
<P>
    to open the following registry key:
<P>
       My Computer\HKEY_CLASSES_ROOT\TypeLib\{00020813-0000-0000-C000-
       000000000046}\1.0\9
<P>
    Then, click the folder to the left of Win16. The following key
    appears in the status bar:
<P>
       My Computer\HKEY_CLASSES_ROOT\TypeLib\{00020813-0000-0000-C000-
       000000000046}\1.0\9\Win16

<P><LI>Click the entry for Xlen50.olb.

<P><LI>On the Edit menu, click Modify.

<P><LI>Change the Value Data to the new path for Xlen50.olb and click OK.

<P><LI>Repeat steps 3–10 using the following registry keys:
<P>
       HKEY_LOCAL_MACHINE\SOFTWARE\Classes\TypeLib\{000204F3-0000-0000-
       C000-000000000046}\1.0\9
<P>
       HKEY_LOCAL_MACHINE\SOFTWARE\Classes\TypeLib\{00020813-0000-0000-
       C000-000000000046}\1.0\9

<P><LI>On the Registry menu, click Exit.

<P><LI>Restart Windows.
<P>
</OL>Microsoft Excel 5.0 for Windows NT:
<P>
Use the method that corresponds with the version of Windows that you are
running and use the criteria in the following table.
<P>
<PRE>   Replace This file   With This File
   ----------------------------------

   Win16               Win32
   Xlen50.olb          Xlen32.olb
   Vbaen.olb           Vbaen32.olb

</PRE></OL>If you are a network administrator, you may want to perform this workaround
with a batch procedure. For more information, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q129422.htm">Q129422</A></B>
   TITLE     : XL5: Network Admin Method for Updating Registration Database

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, you can use the References dialog box to create a link
to another project (for example, a workbook that contains a Visual Basic
module) from the active project. When you reference another project, you
can call any Sub or Function procedure within that project without opening
the workbook or using the name of the module that contains the Sub or
Function.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about a referenced projects, click the Search button
in the Visual Basic Reference and type:
<P>
<PRE>   referenced project
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: network lanman novell<BR>
Keywords            : kberrmsg kbprg<BR>
Version             : 5.0 5.0c<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
