

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Cannot Use External References with Data Validation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157034">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/10/04">
<META NAME="Keywords" CONTENT="xlformula xlui">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you type a cell reference to a cell in the Source or Formula box in the Data Validation dialog box, and then click OK, the following message appears:     You may not use references to other worksheets or workbooks    for Data Validation criter...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKR,QBWS,QDNZ,QBVP,QAYY,QAPF,QANX,QAP2,QAK9,QAWM,QAKD,QBJZ,QAKC,QAJQ,QA2Q P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Cannot Use External References with Data Validation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157034</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you type a cell reference to a cell in the Source or Formula box in
the Data Validation dialog box, and then click OK, the following message
appears:
<P>
<PRE>   You may not use references to other worksheets or workbooks
   for Data Validation criteria.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>You select the cells to which you want to apply Data Validation, and
   click Validation on the Data menu.
<P>
<P><PRE>    -and-
</PRE>
<LI>You click the Settings tab, and click Settings (or Custom) in the Allow
   list.
<P>
<P><PRE>    -and-
</PRE>
<LI>You specify a cell reference to a cell in another worksheet or workbook
   in the Source (or Formula) box.
<P>
</UL>The Data Validation command allows you to place restrictions on data that
is typed into specific cells. However, the cells that contain the data
criteria can refer only to cells within the same worksheet as the cells
that are restricted.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can specify a cell that is in an external worksheet as Data Validation
criteria if a local cell refers to the criteria cell using one of the two
methods below:
<P>
Method 1: Using a Local Cell that Refers to the External Cell
<P>
<PRE>          a. On the File menu, click New, click Workbook, and then click
             OK.

          b. Select cell A1.

          c. On the Data menu, click Validation and click the Settings tab.

          d. In the Allow box, click Whole number.

          e. In the Data box, click Equal to.

          f. In the Value box, type a reference to a cell on the
             worksheet, for example, type "=$B$1" (without the quotation
             marks).

          g. Click OK.

          h. In the cell you referenced in step f, type a formula that
             refers to the external criteria cell. For example, in cell B1,
             type the following formula:

                =Sheet2!$C$1

          i. In the external cell, type the criteria value you want to use
             for Data Validation. For example, in cell C1 of Sheet2, type
             the number 5.

             You may now type only the Data Validation criteria (for
             example 5) in cell A1 of Sheet1.

</PRE>Method 2: Using INDIRECT to return a Value in the External Cell
<P>
<PRE>          a. On the File menu, click New, click Workbook, and then click
             OK.

          b. Select cell A1.

          c. On the Data menu, click Validation and click the Settings tab.

          d. In the Allow box, click Whole number.

          e. In the Data box, click "Equal to."

          f. In the Value box, type the following formula:

                =Indirect("Sheet2!$C$1")

          g. Click OK.

          h. In cell C1 of Sheet2, type the number 10.

             You may now type only the Data Validation criteria (for
             example 10) in cell A1 of Sheet1.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel 97 includes a tool that allows you to specify what data is
valid for individual cells or cell ranges in a worksheet. This tool is
called Data Validation. To access the tool, click Validation on the Data
menu.
<P>
Restrictions include values, dates, times, or lists of text or values, and
can be limited to exact matches or ranges of cells. You can type the
validating values in the Data Validation dialog box or you can store them
in worksheet cells. These validating cells must be on the same worksheet as
the cells being restricted.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Data Validation, click the Index tab in
Microsoft Excel Help, type the following text:
<P>
<PRE>   data validation, overview

</PRE>and then double-click the selected text to go to the "Types of data
restrictions" topic.
<P>
Or, click the Index tab in Microsoft Excel Help, type the following text:
<P>
<PRE>   data validation, drop-down list

</PRE>Then, double-click the selected text to go to the "Restrict cell entries to
the data from a list" topic, and read the third bulleted item under "Tips".
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00<BR>
Keywords          : xlformula xlui<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
