

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: "Unable to Write to Database" Error with Template Wizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171579">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/07/17">
<META NAME="Keywords" CONTENT="xladdins xlwiz kberrmsg kbinterop kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you use a template created by the Template Wizard to create a new record in a database, you may receive the following error message:     Unable to write to database. Make sure database is not protected and    has valid field data-types.  CAUSE =...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBVP,QA36,QA7O,QA7N,QAIK,QBC6,QAKC,QAZV,QAB4,QA1S,QAMA,QAKE,QAUR,QAG4 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "Unable to Write to Database" Error with Template Wizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171579</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use a template created by the Template Wizard to create a new record
in a database, you may receive the following error message:
<P>
<PRE>   Unable to write to database. Make sure database is not protected and
   has valid field data-types.

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur if all of the following conditions are true:

<UL><LI>You are using a Microsoft Access database.
<P>
<P><PRE>    -and-
</PRE>
<LI>The table in which you save the records has a primary field.
<P>
<P><PRE>    -and-
</PRE>
<LI>The data type for the primary field is set to Number instead of the
   AutoNumber default type.
<P>
   NOTE: The data type for the primary field is set to number if you
   created the database in Microsoft Access.
<P>
<P><PRE>    -and-
</PRE>
<LI>In the Template Wizard, you do not link the primary field to any cells
   on the worksheet.
<P>
</UL>When you use a template created by the Template Wizard to create new
records in the table, any fields of the Number type that are not explicitly
linked to worksheet cells receive a value of zero each time you save a new
record. Therefore, if the primary key is set to the Number data type and
you try to save the second record to the table, you receive the error
message described in this article. This behavior occurs because the primary
key cannot have the same value (in this case zero) in multiple records in
the same table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, change the data type of the primary field to
AutoNumber. After you do this, Microsoft Access generates a unique number
for this field for each record in the table.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design of the Template Wizard in Microsoft Excel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Template Wizard with Data Tracking add-in creates a template that links
selected cells in a workbook to fields in a database. When you base a new
workbook on the template and enter data in the linked cells, Microsoft
Excel creates a new record in the database and copies the data to the
corresponding data fields.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Template Wizard, click the Office Assistant,
type "template wizard," click Search, and then click to view " What is the
Template Wizard with Data Tracking?"
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xladdins xlwiz kberrmsg kbinterop kbtool<BR>
Version           : WINDOWS:7.0,7.0a,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
