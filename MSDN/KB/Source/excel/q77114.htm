

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Performing a Lookup with Unsorted Data in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77114 ">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1991/10/08">
<META NAME="Keywords" CONTENT="kbhowto xlformulas">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, the VLOOKUP function searches the leftmost column of an array for a particular value and returns the corresponding value from a cell in another column, indicated by the col_index_num.  VLOOKUP requires that the first column of t...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAHH,QAUD,QBXN,QAY5,QAHG,QAB9,QAE1,QBV8,QDMN,QALW,QAKD,QBE7,QBE6,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Performing a Lookup with Unsorted Data in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77114 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x
<LI>Microsoft Excel for OS/2, versions 2.2, 2.21, 3.0
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.x, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, the VLOOKUP function searches the leftmost column of an
array for a particular value and returns the corresponding value from a
cell in another column, indicated by the col_index_num.
<P>
VLOOKUP requires that the first column of the lookup table is sorted in
ascending order. The following information describes different formulas
that you can use to return the same information returned by VLOOKUP
without requiring that the first column of the table be sorted.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using INDEX and MATCH</h3>
 
<P>
The following formula return the same information that a VLOOKUP returns
without requiring the first column of the table to be sorted
<P>
<PRE>   =INDEX(Table_Array,MATCH(Lookup_Value,Lookup_Array,0),Col_Index_Num)

</PRE>where:
<P>
<PRE>   Table_Array    = The entire lookup table

   Lookup_Value   = the value to be found in the first column of
                    "table_array"

   Lookup_Array   = the range of cells containing possible
                    lookup values

   Col_Index_Num  = the column number in "table_array" for which
                    the matching value should be returned

</PRE>If none of the cells in Lookup_Array match Lookup_Value, this formula
will return #N/A.
<P>
<P><h3>Using OFFSET and MATCH</h3>
 
<P>
The OFFSET function can be used if you are unsure of the entire address of
"table_array" because it uses the MATCH function to locate the position of
"lookup_value" within "lookup_array." In the following function, the
"offset_col" argument uses the upper left most cell of the table as
"top_cell" and returns the desired value as determined by the MATCH (offset
row) and offset column:
<P>
<PRE>   =OFFSET("top_cell",MATCH("lookup_value","lookup_array",0),"offset_col")

</PRE><h3>Example</h3>
 
<P>
<PRE>   A1: Name        B1: Dept        C1: Age
   A2: Henry       B2: 501         C2: 28
   A3: Stan        B3: 201         C3: 19
   A4: Mary        B4: 101         C4: 22
   A5: Larry       B5: 301         C5: 29

</PRE>Because the "Name" range is not sorted, using VLOOKUP to find the age of
Mary returns 28, the age of Henry. To find the age of Mary, use the
following:
<P>
<PRE>   =OFFSET(A1,MATCH("Mary",A2:A5,0),2)

</PRE>The function returns 22.
<P>
NOTE: In Microsoft Excel 5.0, the first column of a lookup table does not
have to be sorted to use the VLOOKUP and HLOOKUP functions if you are
looking for an exact match. To look for an exact match, specify
the fourth argument of VLOOKUP or HLOOKUP as FALSE. If you omit the fourth
argument, or specify the argument as TRUE, you must sort the first column
of the table. The OFFSET function described above also works in Microsoft
Excel versions 5.0, but is not necessary.
<P>
For additional information about using the VLOOKUP function to find an
exact match in Microsoft Excel version 5.0, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A HREF="../EXCEL/Q108639.htm">Q108639</A></B>
   TITLE     : XL: Range_Lookup Argument in VLOOKUP Finds Exact Match

</PRE><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, pages 267-268, 299-300
<P>
"Function Reference," version 3.0, pages 148-149, 163-164
<P>
"Functions and Macros," version 2.1, pages 78, 320
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.00 2.01 2.10 2.20 2.21 3.00 4.00 hlookup<BR>
exact<BR>
Keywords          : kbhowto xlformulas<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
