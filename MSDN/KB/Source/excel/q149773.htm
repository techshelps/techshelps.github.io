

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSQUERY: Application Error With Microsoft Access ODBC Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149773">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1996/04/10">
<META NAME="Keywords" CONTENT="kbtool kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you use DDERequest to retrieve a list of tables from a Microsoft Access database, you may receive one of the following error messages, depending on which version of Microsoft Excel and Microsoft Query you are using:  Microsoft Excel version 5.0 ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QA1S,QBVP,QDN9,QBBI,QAYL,QA9E,QAU9,QAUJ,QAZV,QAB4,QAGU,QBUG,QBUF,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQUERY: Application Error With Microsoft Access ODBC Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149773</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Query for Windows 95, version 2.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use DDERequest to retrieve a list of tables from a Microsoft Access
database, you may receive one of the following error messages, depending on
which version of Microsoft Excel and Microsoft Query you are using:
<P>
<P><h3>Microsoft Excel version 5.0 or 5.0c and Microsoft Query version 1.0</h3>
 
<P>
<PRE>   MSQUERY caused a general protection fault in module MSQUERY.EXE
   at 0017:00003537

</PRE><h3>Microsoft Excel version 7.0 and 7.0a and Microsoft Query version 2.0</h3>
 
<P>
<PRE>   MSQRY32 caused an invalid page fault in module MSQRY32.EXE
   at 0137:0047e661

</PRE><h2>CAUSE</h2>
 
<P>
You may experience this behavior, if the following is true:

<UL><LI>You are using the DDE request statement:
<P>
<P><PRE>      &lt;Table Array&gt; = DDERequest(&lt;Channel&gt;, _
      "Tables/&lt;DataSourceName&gt;/&lt;User&gt;/&lt;Database&gt;)"
</PRE><P>
   Where &lt;Table Array&gt; is the name of the variable assigned to hold the
   returned value, &lt;Channel&gt; is the DDE to Microsoft Query channel
   variable, &lt;DataSourceName&gt; is the specified Data Source Name, &lt;User&gt; is
   the specified User Name, and &lt;Database&gt; is the specified Database Name.
<P>
   -and-

<LI>If at least one of the following is true:
<P>
<P><PRE>    - You are using the Microsoft Access 2.0 ODBC Driver from the ODBC 2.0
      Driver Kit, the ODBC 3.0 Driver Kit, or the ODBC Drivers supplied
      with Microsoft Access 7.0.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - You are using the Microsoft Access 7.0 ODBC Driver from the ODBC 3.0
      Driver Kit or the ODBC Drivers supplied with Microsoft Access 7.0.
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
You can avoid the error symptoms by leaving the User argument blank. The
Table data will be returned based upon the currently connected User:
<P>
<PRE>   &lt;Table Array&gt; DDERequest(&lt;Channel&gt;, _
      "Tables/&lt;DataSourceName&gt;//&lt;Database&gt;"

</PRE>where &lt;Table Array&gt; is the name of the variable assigned to hold the
returned value, &lt;Channel&gt; is the DDE to Microsoft Query channel variable,
&lt;DataSourceName&gt; is the specified Data Source Name, and &lt;Database&gt; is the
specified Database Name.
<P>
If you use a Table Array variable of TableArray, a Data Source Name of
"Access 7.0 NWind", and a Database Name (location) of
C:\Msoffice\Access\Samples\Northwind, then the DDERequest statement would
look similar to the following:
<P>
<PRE>   TableArray = DDERequest("Access 7.0 NWind"// _
      &amp; "C:\MSOFFICE\ACCESS\SAMPLES\NORTHWIND")
</PRE><h2>REFERENCES</h2>
 
<P>
For additional information about the syntax of this DDERequest statement,
see the "Microsoft Query 1.0 User's Guide," Chapter 9, "Using Dynamic Data
Exchange with Microsoft Query."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kberrmsg<BR>
KBSubcategory: xlquery
<P>

Additional reference words: XL5 XL7 5.00 5.00a 5.00c 7.00 7.00a
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
