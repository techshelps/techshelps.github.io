

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel Macro to Join More Than Two Files in Q+E for Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73306 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/06/21">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The JOIN macro command is equivalent to the JOIN command from the Select menu in a Query window. It is possible to use the JOIN macro to join more than two files in Q+E, but in sets of two at a time only.  MORE INFORMATION  The following macro uses...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJQ,QAH4,QA2Q,QBWS,QDI1,QAZZ,QAG2,QA4F,QAL3,QDO5,QAFY,QBFY,QAE1,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel Macro to Join More Than Two Files in Q+E for Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73306 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 3.0
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The JOIN macro command is equivalent to the JOIN command from the
Select menu in a Query window. It is possible to use the JOIN macro to
join more than two files in Q+E, but in sets of two at a time only.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following macro uses example files located in the QE subdirectory
of your EXCEL directory.
<P>
The macro opens EMP.DBF, selects the column DEPT, opens DEPT.DBF,
selects the column DEPT_ID, and then performs the join. The macro then
opens a third dBASE file, ADDR.DBF, selects the matching column in
that database, and performs another join resulting in a query
containing information from all three databases.
<P>
Particular attention should be given to the punctuation of the macro,
especially the path structure to the files opened and the
capitalization to the field headings. A #REF! error will result if the
macro cannot find the files and/or recognize the field names displayed
in the query window.
<P>
A1:  =WORKSPACE(,,,,,,,FALSE)
A2:  chan=INITIATE("qe","system")
A3:  =EXECUTE(chan,"[open('c:\excel\qe\emp.dbf','dbasefile')]")
A4:  =EXECUTE(chan,"[select.column('DEPT')]")
A5:  =EXECUTE(chan,"[open('c:\excel\qe\dept.dbf','dbasefile')]")
A6:  =EXECUTE(chan,"[select.column('DEPT_ID')]")
A7:  =EXECUTE(chan,"[join()]")
A8:  =EXECUTE(chan,"[open('c:\excel\qe\addr.dbf','dbasefile')]")
A9:  =EXECUTE(chan,"[select.column('LAST_NAME')]")
A10: =EXECUTE(chan,"[activate('query2')]")
A11: =EXECUTE(chan,"[select.column('LAST_NAME')]")
A12: =EXECUTE(chan,"[join()]")
A13: =EXECUTE(chan,"[save.query.as(myfile.qef)]")
A14: =TERMINATE(chan)
A15: =RETURN()
<P>
NOTE: The order in which the files are selected affects the outcome of
the join.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Q+E For Microsoft Excel User's Guide," version 3.0, chapters 10
and 11
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
