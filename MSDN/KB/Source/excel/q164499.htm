

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Data Associated with Blank Cells May Be Excluded from Subtotals </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164499">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/03/03">
<META NAME="Keywords" CONTENT="xllist kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 5.0 or 7.0, when create a list of data that contains empty cells, and you use the Subtotals command on the Data menu, the summary values for the data may be incorrect.  CAUSE =====  This problem occurs when the following conditio...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QBVP,QADP,QDN0,QDMW,QAGF,QBWS,QAEF,QAYY,QABI,QABH,QAE5,QBFY,QAJX,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Data Associated with Blank Cells May Be Excluded from Subtotals</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164499</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 5.0 or 7.0, when create a list of data that contains
empty cells, and you use the Subtotals command on the Data menu, the
summary values for the data may be incorrect.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>You click a cell in a list that contains blank cells and click
   Subtotals on the Data menu.
<P>
<P><PRE>    -and-
</PRE>
<LI>In the "At each change in" box in the Subtotal dialog box, you specify
   a column that contains blank cells.
<P>
<P><PRE>    -and-
</PRE>
<LI>You select Sum in the Use Function list, clear the Summary Below Data
   check box, and click OK.
<P>
</UL>When you do not clear the Summary Below Data check box, Microsoft Excel
5.0 and 7.0 includes data for the blank cells in the summary function. The
value that Microsoft Excel associates with a blank cell is the value for
the preceding cell that is not blank.
<P>
NOTE: The correct behavior is for Microsoft Excel to ignore the values for
blank cells when you use the Subtotals command regardless of whether you
select the Summary Below Data check box.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this behavior, type values in the blank cells.
<P>
For example, if you are using the following data
<P>
<PRE>   A1: Name   B1: Amount
   A2: a      B2: 1
   A3:        B3: 1
   A4:        B4: 1
   A5: b      B5: 1
   A6:        B6: 1
   A7: c      B7: 1

</PRE>type values for cells A3, A4, and A6 as follows:
<P>
<PRE>   A1: Name   B1: Amount
   A2: a      B2: 1
   A3: a      B3: 1
   A4: a      B4: 1
   A5: b      B5: 1
   A6: b      B6: 1
   A7: c      B7: 1

</PRE>When you click A1 and click Subtotal on the Data menu, Microsoft Excel
calculates the following totals:
<P>
<PRE>   A1:  Name        B1:  Amount
   A2:  a           B2:  1
   A3:  a           B3:  1
   A4:  a           B4:  1
   A5:  a Total     B5:  3
   A6:  b           B6:  1
   A7:  b           B7:  1
   A8:  b Total     B8:  2
   A9:  c           B9:  1
   A10: c Total     B10: 1
   A11: Grand Total B11: 6

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel versions
5.0 and 7.0 for Windows. This problem was corrected in Microsoft Excel 97
for Windows.
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Behavior in Microsoft Excel 5.0 and 7.0</h3>
 
<P>
In the Subtotal dialog box, if the field you are selecting in the "At each
change in" list contains empty cells, Microsoft Excel ignores the rows
that contain the empty cells when you clear the Summary Below Data check
box.
Example:
<P>
To see this behavior, use the following steps:

<OL><P><LI>Type the following data in a new worksheet:
<P>
<PRE>   A1: Name   B1: Amount
   A2: a      B2: 1
   A3:        B3: 1
   A4:        B4: 1
   A5: b      B5: 1
   A6:        B6: 1
   A7: c      B7: 1

</PRE><P><LI>Select cell A1 and click Subtotals on the Data menu.

<P><LI>In the Subtotals dialog box, click Name in the "At each change in"
   list, click Sum in the Use Function list, and then click Amount in the
   Add Subtotal To list.

<P><LI>Click OK.
<P>
   The data appears as follows:
<P>
<PRE>      A1:  Name         B1:  Amount
      A2:  a            B2:  1
      A3:               B3:  1
      A4:               B4:  1
      A5:  a Total      B5:  3
      A6:  b            B6:  1
      A7:               B7:  1
      A8:  b Total      B8:  2
      A9:  c            B9:  1
      A10: c Total      B10: 1
      A11: Grand Total  B11: 6

   NOTE: The blank cells in column A are associated with the value for the
   preceding nonblank cell in the column.

</PRE><P><LI>Select cell A1 and click Subtotals on the Data menu.

<P><LI>In the Subtotal dialog box, click to clear the Summary Below Data check
   box, and then click OK.
<P>
   The data appears as follows:
<P>
<PRE>      A1: Name         B1: Amount
      A2: Grand Total  B2:  6
      A3: a Total      B3:  1
      A4: a            B4:  1
      A5:  Total       B5:  3
      A6:              B6:  1
      A7:              B7:  1
      A8:  b           B8:  1
      A9:   Total      B9:  2
      A10:             B10: 1
      A11: c           B11: 1
   
</PRE></OL>NOTE: The blank cells are not associated with cells that contain values in
column A.
<P>
<P><h3>Behavior in Microsoft Excel 97 for Windows</h3>
 
<P>
In Microsoft Excel 97, in the Subtotal dialog box, if the field you are
selecting in the "At each change in" list contains empty cells, the
behavior is the same regardless of whether you clear the Summary Below
Data check box.
Example:
<P>
To see this behavior, use the following steps:

<OL><P><LI>Type the following data in a new worksheet:
<P>
<PRE>      A1: Name   B1: Amount
      A2: a      B2: 1
      A3:        B3: 1
      A4:        B4: 1
      A5: b      B5: 1
      A6:        B6: 1
      A7: c      B7: 1

</PRE><P><LI>Select cell A1 and click Subtotals on the Data menu.

<P><LI>In the Subtotals dialog box, click Name in the "At each change in"
   list, click Sum in the Use Function list, and then click Amount in the
   Add Subtotal To list.

<P><LI>Click OK.
<P>
   The data appears as follows:
<P>
<PRE>      A1:  Name        B1:  Amount
      A2:  a           B2:  1
      A3:  a Total     B3:  1
      A4:              B4:  1
      A5:              B5:  1
      A6:  b           B6:  1
      A7:  b Total     B7:  1
      A8:              B8:  1
      A9:  c           B9:  1
      A10: c Total     B10: 1
      A11: Grand Total B11: 6

</PRE><P><LI>Select cell A1 and click Subtotals on the Data menu.

<P><LI>In the Subtotal dialog box, click to clear the Summary Below Data check
   box, and then click OK.
<P>
   The data appears as follows:
<P>
<PRE>      A1:  Name        B1:  Amount
      A2:  Grand Total B2:  6
      A3:  a Total     B3:  1
      A4:  a           B4:  1
      A5:              B5:  1
      A6:              B6:  1
      A7:  b Total     B7:  1
      A8:  b           B8:  1
      A9:              B9:  1
      A10: c Total     B10: 1
      A11: c           B11: 1

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about subtotals, click the Index tab in
Microsoft Excel Help, type the following text
<P>
<PRE>   Subtotals, data summary

</PRE>and then double-click the selected text to go to the "Summarize data by
using subtotals and outlines" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 sub total<BR>
Keywords          : xllist kbtool<BR>
Version           : WINDOWS:5.0,7.0,97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
