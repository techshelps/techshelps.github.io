

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: Opening or Saving Earlier Version Files with External Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180311">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1998/02/02">
<META NAME="Keywords" CONTENT="xlquery kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The  More Information  section in this article contains information about migrating from an earlier version of Microsoft Excel or saving to an earlier version of Excel when the file contains a saved query that retrieves external data.  MORE INFORMA...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUJ,QATX,QAUR,QAYY,QBI0,QDMR,QAU7,QAI5,QA5V,QAWM,QAK6,QARM,QBG2,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Opening or Saving Earlier Version Files with External Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180311</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "More Information" section in this article contains information about
migrating from an earlier version of Microsoft Excel or saving to an
earlier version of Excel when the file contains a saved query that
retrieves external data.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Forward Compatibility</h3>
 
<P>
When a Microsoft Excel 5.0 workbook that contains external data is opened
in Microsoft Excel 98 Macintosh Edition, the query ranges are converted to
QueryTables, and an unhidden defined name that references the external data
range is created.
<P>
NOTE: The data source name (DSN) connection information is also preserved
with the workbook so that the query range can be saved in the Microsoft
Excel 5.0 file format.
<P>
When you refresh or update external data, Microsoft Excel may be unable to
locate the data source. This behavior may occur when you open an earlier
version of a file that contains a data source name, and the data source
name is not found on the computer. This problem may also occur when the
appropriate driver that is referenced in the data source information is not
found. When this happens, an error message similar to the following
appears:
<P>
<PRE>   [INTERSOLV][Macintosh ODBC Driver Manager]
   Data source name not found and no default
   driver specified

</PRE>For additional information about this problem, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q179124.htm">Q179124</A></B>
   TITLE     : XL98: "INTERSOLV" Error Refreshing or Editing Saved Query


</PRE><h3>Backwards Compatibility</h3>
 
<P>
When you save a Excel 98 file that contains a saved query that uses
external data in the Excel 5.0 file format, all of the external data ranges
(QueryTables) are converted to Excel 5.0 query ranges that are compatible
with the Microsoft Query add-in, Xlquery.xla. The query range definitions
are stored as a series of hidden, local, sheet names. The following table
lists the defined names that are created when this conversion occurs.
<P>
NOTE: The defined names that are created depend on the ODBC driver that you
are using. Not all the defined names in the table are created when the
workbook is saved in the earlier version format of Excel.
<P>
<PRE>   Hidden name               Description
   ------------------------------------------------------------------------

   Query1.query_range        The cell range that the query table definition
                             covers (as a range).

   Query1.query_source       An array of strings that contain the Data
                             Source Name. This value is not in a connection
                             string format; instead, it is in the DSN name
                             as the DSN appears in the ODBC control panel,
                             for example, "Excel ODBCobjects:Raid4."

   Query1.query_connection   An array of string that contains the complete
                             ODBC connection string in the connection
                             string syntax, for example,
                             "DSN=BigIron:DATA001;UID=Edison;APP=Microsoft
                             Query;WSID=USERX;Language=us_english;
                             DATABASE=ODBC2."

   Query1.query_definition   The Structured Query Language (SQL) statement
                             for the query as an array of strings with
                             Microsoft Query syntax additions, including
                             items such as column title aliases.

   Query1.query_options      A two element array of two rows by one column
                             that contains Boolean operators. The first row
                             is the setting for the Include Field Names
                             check box in the Query Options dialog box. The
                             second row is the setting for the Include Row
                             Numbers check box.

   Query1.query_statement    Similar to query_definition except that
                             query_statement is raw SQL text with no
                             Microsoft Query-specific items, for example
                             no column title definitions are included.

   Query1.user_name          The user's name that is used to log on to
                             ODBC. The name is stored as a string value
                             not as an array of strings. This value is
                             duplicated in the query_connection string.

   Query1.keep_password      A single Boolean value (not an array)
                             that indicates whether the password is to be
                             retained for use when refreshing or editing
                             the query range. If TRUE, the password
                             connection string record is stored in
                             the query_connection name. If FALSE, the
                             password connection string record is stripped
                             from the query_connection name.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 msquery<BR>
Keywords          : xlquery kbtool<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
