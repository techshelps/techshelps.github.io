

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error Using WORKBOOK.ADD() without First Argument </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84172 ">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1992/05/03">
<META NAME="Keywords" CONTENT="kbmacro kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel requires a worksheet name for the first argument in the WORKBOOK.ADD() function. If you use this macro function without the first argument, you receive a macro error when you run the macro that contains this function.  In Microsoft ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAPN,QAY5,QAHE,QBV8,QAB9,QBKN,QAH4,QDNM,QACI,QA9N,QAEF,QAAP,QAB4,QANJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Using WORKBOOK.ADD() without First Argument</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84172 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Excel requires a worksheet name for the first argument in the
WORKBOOK.ADD() function. If you use this macro function without the first
argument, you receive a macro error when you run the macro that contains
this function.
<P>
In Microsoft Excel version 5.0, if you use this function in a Microsoft
Excel version 4.0 macro sheet without the first argument, you receive a
general protection (GP) fault.
<P>
<P><h2>CAUSE</h2>
 
<P>
You can use the WORKBOOK.ADD function to add one or more documents to a
workbook in Microsoft Excel version 4.0. If the worksheet argument is left
out in most functions, the active sheet is assumed. This is not the case
for the WORKBOOK.ADD function.
<P>
The WORKBOOK.ADD function requires a first argument and will halt on a
macro error if no argument is given. This also applies to the
WORKBOOK.COPY() and WORKBOOK.MOVE() functions.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
<P><h3>Microsoft Excel version 5.0</h3>
 
<P>
To avoid receiving a GP fault in Microsoft Excel version 5.0, use either of
the following methods:
<P>
Method 1: Use the WORKBOOK.MOVE function instead of the WORKBOOK.ADD
<PRE>          function. You  can use the WORKBOOK.MOVE function without the
          first argument to move  the active sheet to the specified
          workbook, unless the active sheet is  the only sheet contained in
          the workbook.

</PRE>Method 2: Use the Move method of the Sheets object to move the active sheet
<PRE>          to  another workbook. The following example moves the active
          sheet to BOOK1:

             ActiveSheet.Move Workbooks("Book1").Sheets(1)

          Note that the sheet is inserted before Sheet1 in BOOK1.


</PRE><h3>Microsoft Excel version 4.0</h3>
 
<P>
To avoid receiving a macro error in Microsoft Excel version 4.0, use
GET.DOCUMENT(1) for the first argument. This returns the name of the active
sheet.
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, page 461
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.0 5.00 work book gpf<BR>
Keywords            : kbmacro kbprg<BR>
Version             : 4.00 5.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
