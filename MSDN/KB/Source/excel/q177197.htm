

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Readme.txt for Date Migration Wizard for MS Excel 97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177197">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1997/11/21">
<META NAME="Keywords" CONTENT="kbfile">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article contains the text of the Readme.txt file that is included with the Microsoft Date Migration Wizard for Microsoft Excel 97.  For more information about the Date Migration Wizard, please see the following article in the Microsoft Knowled...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QACE,QAY5,QAIK,QAB9,QBV8,QBWS,QBXN,QAH3,QAL3,QAKP,QA2Q,QATX,QAMB,QBVV P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Readme.txt for Date Migration Wizard for MS Excel 97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177197</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains the text of the Readme.txt file that is included with
the Microsoft Date Migration Wizard for Microsoft Excel 97.
<P>
For more information about the Date Migration Wizard, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q176943.htm">Q176943</A></B>
   TITLE     : XL97: Using the Date Migration Wizard in Microsoft Excel
               97

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<PRE>                 ----------------------------------------
                 MICROSOFT EXCEL 97 DATE MIGRATION WIZARD
                               December 1997
                 ----------------------------------------
                      (c) Microsoft Corporation, 1997

</PRE>The Date Migration Wizard is an add-in program for Microsoft Excel 97 that
you can use to scan workbooks for worksheet functions that accept date
arguments. Dates entered as text may produce different results than they
did in previous versions. The unexpected results that may occur are due to
a change in the date algorithm in Excel 97.
<P>
In Excel, you can enter dates more quickly by typing two digits for the
year. When you enter a two-digit year, Excel interprets the century the
date belongs to according to a date algorithm. Because many people enter
dates that are 30 years in the future, Microsoft changed the date algorithm
in Excel 97 to more accurately interpret dates through the year 2029.
<P>
While text dates are acceptable in date-related functions, they are
uncommon. A "text date" is either a date that has been entered within
quotation marks ( " " ) as an argument within a function or any text string
that Excel can recognize as a date. For example, if you format a cell as
text and then type in a date, the result is a text date. (If you type a
date into a blank cell with no existing number format, the result is a
numeric-value date.) Excel stores most dates as numeric values, so they are
not impacted by issues affecting text dates. In some cases -- for example,
data imported from other sources, such as mainframe databases -- dates may
be imported as text.
<P>
For more information about how Excel works with dates, see the following
Excel Help topics:
<P>
<PRE>     How Microsoft Excel performs date and time calculations

     Tips on entering dates and times

</PRE>For more information about converting text-formatted dates to general
formatted dates, see the following Excel Help topic
<P>
<PRE>     Troubleshoot formatting numbers, dates, and times

</PRE>and then click:
<P>
<PRE>     Numbers aren't displayed or calculated as numeric values

</PRE> 
<P><h3>CONTENTS</h3>
 
<P>
Background
Affected functions
Additional notes
Instructions
Additional information about the Interactive Scan option
Problem categories
<P>
 
<P><h3>BACKGROUND</h3>
 
<P>
Functions that use text dates with a two-digit year between 20 and 29 are
interpreted differently in Microsoft Excel 97 than in previous versions.
The following algorithm is used to interpret these dates in Excel 95 and
earlier:
<P>
<PRE>   Two-digit year   Century assumed   Example   Result
   --------------   ---------------   -------   ------
   &lt;= 19            2000              1/1/15    January 1, 2015
   &gt; 19             1900              1/1/20    January 1, 1920

</PRE>In Excel 97, the algorithm was changed to:
<P>
<PRE>   Two-digit year   Century assumed   Example   Result
   --------------   ---------------   -------   ---------------
   &lt;= 29            2000              1/1/20    January 1, 2020
   &gt; 29             1900              1/1/30    January 1, 1930

</PRE>The Date Migration Wizard scans your workbooks for worksheet functions that
accept text dates as arguments. The wizard reports the functions it
encounters so that you can validate the accuracy of the results of these
functions under the new algorithm in Excel 97.
<P>
 
<P><h3>AFFECTED FUNCTIONS</h3>
 
<P>
The following worksheet functions accept text dates in one or more of their
arguments. These functions are potentially affected by date migration
issues.
<P>
<PRE>   ACCRINT        ACCRINTM       AMORDEGRC      AMORLINC
   COUPDAYBS      COUPDAYS       COUPDAYSNC     COUPNCD
   COUPNUM        COUPPCD        DATEVALUE      DAY
   DAYS360        DISC           DURATION       EDATE
   EOMONTH        INTRATE        MDURATION      NETWORKDAYS
   ODDFPRICE      ODDFYIELD      ODDLPRICE      ODDLYIELD
   PRICE          PRICEDISC      PRICEMAT       RECEIVED
   TBILLEQ        TBILLPRICE     TBILLYIELD     WEEKDAY
   WEEKNUM        WORKDAY        XIRR           XNPV
   YEAR           YEARFRAC       YIELD          YIELDDISC
   YIELDMAT

</PRE>The Date Migration Wizard locates all instances of these functions,
examines each one, and reports the functions that contain two-digit years
within the range 20 through 29. If you want the wizard to report all
instances of these functions, select the Display All Date Functions option.
The wizard ignores any instances that contains four-digit years.
<P>
Note: The wizard does not locate or examine the following date functions:
DATE, DAY, MONTH, NOW, and TODAY. These functions are unaffected by the
change in the date algorithm in Excel 97.
<P>
 
<P><h3>ADDITIONAL NOTES</h3>
 

<UL><LI>To determine if the functions within the workbooks are calculating
   correctly, the best person to perform the scan is the author of the
   worksheets or workbooks.

<LI>To save time when you have several workbooks to scan, you can create a
   detailed report of all of the workbooks with the "All Microsoft Excel
   files in a folder" option in Step 3 of the wizard. Once the report is
   complete, you will know which workbooks to check further for possible
   problem functions.

<LI>Your formulas may contain functions that use data that is imported from
   other sources. To ensure that these functions calculate correctly each
   time you update the data, run the Date Migration Wizard after each
   update. For example, a function refers to a date that contains a two-
   digit year that is outside of the problem range, which is reported as
   "Not currently a problem." However, if the referred-to date is then
   changed to a date within the problem range, you have the possibility of
   an improper calculation the next time you update.
<P>
</UL> 
<P><h3>INSTRUCTIONS</h3>
 
<P>
After you download DateMig1.exe from the Microsoft Software Library and
double-click it to extract DateScan.xla, the Date Migration Wizard, you
must copy the wizard and the ReadMe.txt file to the proper folder, and
then load the wizard before you can run it.
<P>
<P><h3>To copy and load the wizard</h3>
 

<OL><P><LI>Copy DateScan.xla and ReadMe.txt to the \Office\Library subfolder of
   the Microsoft Office folder (by default, C:\Program Files\
   Microsoft Office).

<P><LI>Start Excel.

<P><LI>On the Tools menu, click Add-Ins.

<P><LI>Select the Date Migration Wizard For Windows check box.
<P>
</OL><h3>To run the wizard</h3>
 
<P>
NOTE: For performance reasons, do not switch to another program while the
Date Migration Wizard is running. You must leave Microsoft Excel running in
the foreground until the wizard is finished.

<OL><P><LI>On the Tools menu, point to Date Migration, and then click Date
   Migration Wizard.

<P><LI>In step 2 of the wizard, you can have the wizard identify all instances
   of the functions listed in the "Affected Functions" section earlier in
   this readme, even if the functions do not calculate differently between
   Excel versions. To have the wizard identify all instances of these
   functions, select Display All Date Functions.

<P><LI>In step 3 of the wizard, select the workbooks to be scanned.
<P>
<P><PRE>    - Select "Currently open workbook" to scan a workbook you have open.
</PRE><P>
<P><PRE>    - Select "All Microsoft Excel files in a folder" to scan multiple
      workbooks that are not open but are stored in the same location.
</PRE>
<P><LI>Do one of the following:
<P>
<P><PRE>    - If you selected "All Microsoft Excel files in a folder," click Next
      and then click Finish to create a detailed report listing all files
      in the folder. The report gives the number of known and potential
      problems in each workbook within the folder (and, optionally, its
      subfolders).
</PRE><P>
<P><PRE>      NOTE: The length of time it takes to create a report depends on the
      size of the workbooks and the number of workbooks within a folder.
</PRE><P>
<P><PRE>    - If you selected Currently Open Workbook, there are two types of scans
      available:
</PRE><P>
<PRE>         - To create a report listing all date migration issues that the
           wizard locates, select Create Detailed Report, click Next, and
           then click Finish.

           NOTE: The length of time it takes to create a detailed report
           varies depending on the size of the workbook.

         - To manually scan the workbook, cell by cell, for date migration
           issues, select Interactive Scan. You can also select a starting
           point for the scan. The default starting location is cell A1 on
           the currently active worksheet. To select a different cell or
           worksheet, click the button next to the edit box, select the
           starting cell, and then click OK. Click Next and then click
           Finish to perform an interactive scan.

    - See the section "Additional Information About the Interactive Scan
      Option" below for information about using the Date Migration
      toolbar.

</PRE></OL> 
ADDITIONAL INFORMATION ABOUT
THE INTERACTIVE SCAN OPTION
 
<P>
The Interactive Scan option requires that the open workbook, and all
worksheets within it, be unhidden and unprotected. When you select the
Interactive Scan option, the wizard tries to unhide all worksheets and
remove all protections. If the workbook or any worksheets are password
protected, the wizard asks you to supply a password. If you cannot supply
the correct password, the interactive scan will end. All hidden states
and/or protection settings modified by the wizard are restored when the
interactive scan ends.
<P>
NOTE: Some of the functions listed in the "Affected Functions" list earlier
in this readme are part of the Analysis ToolPak. If formulas in your
worksheet display the #NAME! error, the Analysis ToolPak may not be
installed. To learn more about installing the Analysis ToolPak, see the
Excel Help topic "Install and use the Analysis ToolPak."
<P>
The Date Migration toolbar appears when the scan begins. Use this toolbar
to do the following:

<UL><LI>To run the interactive scan, click Next Date Function. The wizard
   searches the current workbook and stops at each formula that contains a
   date migration issue. You can then modify the formula or its arguments
   to remove the date migration problem.

<LI>To recheck a selected cell to see what affect your changes had, click
   Check Current Cell.

<LI>To display information about the problem that was located, click
   Information From Last Cell Scanned.

<LI>To stop the Interactive Scan before the wizard finishes, click Stop
   Scan.
<P>
</UL> 
<P><h3>PROBLEM CATEGORIES</h3>
 
<P>
The Date Migration Wizard reports problems by using the following messages
in the Category column in a report of the workbook that is currently open,
and during an interactive scan.
<P>
<PRE>   Message               Description
   ------------------------------------------------------------------

   Known problem         The cell contains a function from the
                         "Affected Functions" list earlier in this
                         readme that contains a two-digit year in the
                         range 20 to 29 (inclusive).

   Potential problem     The cell contains nested functions or
                         formulas with multiple date functions. These
                         are always considered potential problems.

   Not currently a       The function in the formula is not a problem.
   problem               If the function in the formula contains a
                         four-digit year or the two-digit year is not
                         within the affected range of dates, then the
                         function is not a problem.

   Multiple matches      The cell contains more than one date function
                         from the "Affected Functions" list earlier in
                         this readme.

</PRE>In a Folder Scan report, the following columns are displayed.
<P>
<PRE>   Column                Description
   ---------------------------------------------------------------

   Known                 The number of cells that contain formulas
                         with date problems

   Might                 The number of cells that contain date
                         formulas that pose potential problems

   Don't                 The number of cells that contain date
                         formulas that are not a problem
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 2019 2020 2029 2030 1919 1920 1929 1930 2000<BR>
year 2000<BR>
Keywords          : kbfile<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbreadme kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
