

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Can't Use Open, Save, or Print Commands but Toolbar Tools Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86515 ">
<META NAME="KBModify" CONTENT="1996/08/19">
<META NAME="KBCreate" CONTENT="1992/07/08">
<META NAME="Keywords" CONTENT="kbinterop kb3rdparty xlquery">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you may experience problems opening, dragging, saving, or printing files, if you have an outdated version of or more than one copy of the SHELL.DLL or Common Dialog Box Dynamic Link Library (COMMDLG.DLL) file. You may experience...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBVP,QDL9,QBWQ,QBWO,QBWN,QAA1,QBXB,QATJ,QAFI,QDI2,QAUR,QDNN,QBVV,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Can't Use Open, Save, or Print Commands but Toolbar Tools Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 19, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86515 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0
<LI>Microsoft Project for Windows, versions 3.0, 4.0
<LI>Microsoft Query for Windows, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, you may experience problems opening, dragging, saving,
or printing files, if you have an outdated version of or more than one copy
of the SHELL.DLL or Common Dialog Box Dynamic Link Library (COMMDLG.DLL)
file. You may experience the following problems:

<UL><LI>You receive the "File name is not valid" error message in the Open
   dialog box.

<LI>You receive the "Cannot find &lt;FILENAME&gt;.DLL, Please insert in drive
   A:" error message.

<LI>You are able to save two documents with the same filename without
   receiving an error message.

<LI>You receive an unrecoverable application error (UAE).

<LI>You experience a general protection (GP) fault.

<LI>You receive the "File not found" error message.
<P>
</UL>These symptoms are not always consistent and may not be easy to reproduce.
For more information, see the "Troubleshooting" section later in this
document.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Make sure the COMMDLG.DLL and SHELL.DLL files are located in the
WINDOWS\SYSTEM directory and have a file date of March 10, 1992, or later.
If the .DLL files are not in the WINDOWS\SYSTEM directory, or if they have
earlier dates, copy the most recent version of the files to the
WINDOWS\SYSTEM directory, and delete all earlier versions from your hard
disk drive. Do not leave multiple copies of these files on your hard disk
drive.
<P>
The COMMDLG.DLL and SHELL.DLL files are used by many applications to
provide a consistent interface for common tasks. These dialog boxes include
the Open, Save, Print, and Font dialog boxes.
<P>
The Microsoft Excel 4.0 installation program checks for an existing
COMMDLG.DLL in the WINDOWS\SYSTEM directory and replaces it if the file is
outdated. However, because it does not look in other directories for this
file, multiple or older versions of the file may remain on your hard disk
drive or network directory.
<P>
<P><h3>Troubleshooting</h3>
 
<P>
Use the toolbar to print or change fonts. If you can perform this operation
when you use the toolbar, but are unable to perform it when you use menu
commands and dialog boxes, this points to a .DLL conflict. (The toolbar
tools offer a quick fix for printing and font selection until the .DLL can
be updated.)
<P>
Use File Manager to open a file, or, if you are in an application, you
should be able to open a file from the most recent file list at the
bottom of the File menu.
<P>
<P><h3>Networks</h3>
 
<P>
During a Network Installation, the Setup program for the application you
are using may copy its version of the COMMDLG.DLL and SHELL.DLL files to
the network installation directory. On subsequent workstation
installations, Setup writes the .DLL files to the WINDOWS\SYSTEM directory.
If the WINDOWS\SYSTEM directory is set to read-only status, these files
will not be written to the appropriate directory.
<P>
<P><h3>Third-Party Applications</h3>
 
<P>
The following table contains the names of third-party applications that
have been reported to install the COMMDLG.DLL file. The "May Install
COMMDLG.DLL here" column lists directories where this file may be installed
(note, however, that you should check your entire hard disk drive for
multiple copies of this file).
<P>
<PRE>   This third-party application   May Install COMMDLG.DLL here
   ===========================================================
   BizPlan Builder
   ----------------------------------------------------------
   Faxgrabber versions
   1.0 and 2.0 for Windows
   ----------------------------------------------------------
   Free Lance Graphics
   ----------------------------------------------------------
   Free Lance Info
   ----------------------------------------------------------
   Grammatik 5.0                  \GMKW
   ----------------------------------------------------------
   LANtastic
   ----------------------------------------------------------
   Lotus cc:Mail
   ----------------------------------------------------------
   Lotus Sound (the OLE server
   that ships with AudioPort)
   ----------------------------------------------------------
   MathCad for Windows
   ----------------------------------------------------------
   Norton Desktop
   ----------------------------------------------------------
   Real Data
   ----------------------------------------------------------
   Reflections 2.0
   ----------------------------------------------------------
   SAART network database         \SAART
   ----------------------------------------------------------
   WinFax
   ----------------------------------------------------------
   Xerox 7033 Lan Fax release
   2.01
   ----------------------------------------------------------

</PRE>For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q102946.htm">Q102946</A></B>
   TITLE     : "Excel Err Msg: Common Dialog Reported an Error While..."

</PRE><h2>REFERENCES</h2>
 
<P>
NETWORK.TXT file, Microsoft Excel version 4.0 for Windows
"User's Guide 1," version 4.0, page 55
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kb3rdparty<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 3.00 4.00 5.00 filename GPF cc mail software<BR>
international rsi delrina artisoft
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 19, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
