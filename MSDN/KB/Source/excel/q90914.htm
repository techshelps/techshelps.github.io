

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Exporting Data to Text Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90914 ">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1992/10/26">
<META NAME="Keywords" CONTENT="kbhowto xladdin xlloadsave kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel versions 3.0 and 4.0 provide an add-in macro called Flatfile.xla. You can use this macro to export all or part of a worksheet to a text file in the  flat file  format. To create a flat file in Microsoft Excel versions 5.0 and later,...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA3P,QBRZ,QBTI,QBWS,QAFI,QDNG,QAE1,QAYY,QAEB,QAKC,QBJZ,QADF,QBC6,QATX P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Exporting Data to Text Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90914 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0, 5.0, 5.0a
<LI>Microsoft Excel for the Power Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for OS/2, versions 3.0
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel versions 3.0 and 4.0 provide an add-in macro called
Flatfile.xla. You can use this macro to export all or part of a worksheet
to a text file in the "flat file" format. To create a flat file in
Microsoft Excel versions 5.0 and later, click Save As on the File menu, and
then click Formatted Text (Space Delimited).
<P>
When data is stored in the flat file format, the data is stored in fixed-
width columns that are separated by spaces instead of commas or tabs.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The flat file format is used to create text files that you can open in
other computer programs that work only with text data. For example, this
format is typically required by mainframe programs and is often necessary
for government reporting. To create a flat text file, use the following
method that is appropriate for your version of Microsoft Excel.
<P>
<P><h3>Creating a Flat Text File in Excel 5.0 and Later</h3>
 
<P>
To create the file, follow these steps:

<OL><P><LI>Open the file that you want to save as a flat file.

<P><LI>On the File menu, click Save As.

<P><LI>In the Save As Type list, click Formatted Text (Space Delimited).

<P><LI>In Microsoft Excel version 5.0 for Windows, click OK. In other versions
   of Microsoft Excel, click Save.
<P>
</OL><h3>Creating a Flat Text File in Excel Versions 3.0, and 4.0 with Flatfile.xla</h3>
 
<P>
To create the file, follow these steps:

<OL><P><LI>In Microsoft Excel for Windows, open Flatfile.xla (located in
   the Library directory in the directory in which you installed
   Microsoft Excel).
<P>
   In Microsoft Excel for the Macintosh, open Flat File (located in
   the Macro Library folder in the folder in which you installed
   Microsoft Excel).

<P><LI>Open the worksheet from which you want to export data.

<P><LI>Select the cells containing the data you want to export or select the
   entire worksheet if you want to export everything in it.

<P><LI>On the Data menu, click Export.

<P><LI>In the Export dialog box, type the name you want to give your text
   file in the To filename box.
<P>
   NOTE: In Microsoft Excel for Windows, if you want to use a file name
   extension (such as .txt) with your file name, you must include it in the
   file name you type, for example, Sales.Txt.

<P><LI>If you want to retain the alignment and number formats of your
   exported data, click the Retain Cell Formats check box in the
   Export dialog box.
<P>
   NOTE: If you click the Retain Cell Formats check box, one extra
   space is inserted between columns.

<P><LI>In the Export dialog box, click the Export button.
<P>
</OL>Microsoft Excel creates your text file in the currently directory. To
determine the current directory, click Open on the File menu and note the
open directory in the directory list of the File Open dialog box. In
Microsoft Excel for the Macintosh, the active folder name is displayed just
above the document list in the Open Document dialog box.
<P>
<P><h3>Issues with Flatfile.xla</h3>
 
<P>
The following sections contain information about the alignment and number
formatting, column widths, and fonts in the exported data.
<P>
Issue 1: Alignment and Number Formatting with Flatfile.xla:
<P>
When you use the Export command to export data from your worksheet,
you have the option to keep the alignment and number formatting of the
cells you are exporting. You also have the option to use General alignment
and number formatting for all data. When you use General alignment and
number formatting, text data is aligned to the left, and numeric data is
aligned to the right. Formatting, such as currency or custom number
formatting, is not saved.
<P>
NOTE: The Fill, Justify, and Center Across Selection formats, may cause
problems when you export by using Flatfile.xla. Microsoft recommends that
you remove these formats from the cells before you export the data. For
additional information, query on the following words in the Microsoft
Knowledge Base:
<P>
<PRE>   Excel: Cell Alignment Formats Cause Flatfile Export to Fail

</PRE></OL>Issue 2: Column Widths with Flatfile.xla:
<P>
The column width in your text file is equal to the whole number
portion of the column width for the selected cells. For example, if
the column width is 12.45, the column in the text file will be 12
characters wide. Any characters beyond the twelfth character in a cell
are not included in the text file. Before you export data, make sure
that the columns in the worksheet are wide enough to accommodate all of
the characters in the cells you want to export.
<P>
Issue 3: Fonts with Flatfile.xla:
<P>
If your worksheet is formatted with proportional fonts (for example, Times
New Roman or MS Sans Serif), you may need to increase the width of the
columns to insure that all of the data is exported properly. With
proportional fonts, some characters are narrower than others; therefore,
more characters may be in a cell than the number that is indicated by the
column width. As a result, these characters are cut off when you export the
data (see "Issue 2: Column Widths with Flatfile.xla").
<P>
To insure that all of the data is exported properly, format all of
the data with a monospace (non-proportional) font, such as Courier, or
experiment with various column widths until all of the data is exported.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide," version 3.0, pages 683-684
<P>
"Microsoft Excel User's Guide 2," version 4.0, page 152
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.0 3.00 4.0 4.00 XLA fixed length xl font export<BR>
flatfile space delimited<BR>
Keywords          : kbhowto xladdin xlloadsave kbother<BR>
Version           : WINDOWS:3.0,4.0,5.0,5.0c,7.0,97; MACINTOSH:3.0,4.0,5.0,98<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
