

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Cannot Modify or Delete Custom Menus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157087">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/10/07">
<META NAME="Keywords" CONTENT="xlui">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you customize a menu in Microsoft Excel 97, the menu changes may not be saved when you save, close and reopen the workbook.  CAUSE =====  Your customizations to a menu in Microsoft Excel 97 may not be saved with your workbook if the following co...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAF0,QAVI,QBWS,QA9N,QARW,QAGB,QBWR,QANS,QAEF,QAYZ,QABA,QACI,QAUR P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Cannot Modify or Delete Custom Menus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157087</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you customize a menu in Microsoft Excel 97, the menu changes may not be
saved when you save, close and reopen the workbook.
<P>
<P><h2>CAUSE</h2>
 
<P>
Your customizations to a menu in Microsoft Excel 97 may not be saved with
your workbook if the following conditions are true:

<UL><LI>The workbook was originally created in either Microsoft Excel version
   5.0 or 7.0.
<P>
<P><PRE>    -and-
</PRE>
<LI>You created custom menus in this workbook using the Menu Editor in
   either Microsoft Excel version 5.0 or 7.0.
<P>
<P><PRE>    -and-
</PRE>
<LI>You have saved your workbook in the Microsoft Excel 97 format.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
You cannot save modifications (made in Microsoft Excel 97) to custom menus
you create in earlier versions of Microsoft Excel. If you want to remove
custom menus created in earlier versions of Microsoft Excel, copy the
contents of your workbook to a new Microsoft Excel 97 workbook. Use the
Move or Copy Sheet command from the Edit menu to copy the sheets. The
Custom menus are not copied to the new workbook.
<P>
<P><h3>Steps to Copy All Sheets to a New Workbook</h3>
 
1. Close all open workbooks and open the workbook that contains the
<PRE>   undesired custom menu.

</PRE><P><LI>Right-click a sheet tab, and then click Select All Sheets.

<P><LI>From the Edit menu click Move or Copy Sheet. From the To book:
   drop-down list, click (new book). Select the Create a copy option
   and click OK. This will copy all sheets to a new workbook and
   activate the new workbook.

<P><LI>If there are not any macros in the original workbook continue with
   step 10, otherwise activate the original workbook that contains the
   macros. Click the workbook name from the Window menu to accomplish
   this.

<P><LI>On the Tools menu, point to Macro, and then click Visual Basic Editor.

<P><LI>On the View menu, click Project Explorer.

<P><LI>In the Project Explorer, drag each module from the Modules folder of
   the original workbook to the new workbook created in step 3.

<P><LI>On the File menu, click Close and Return to Microsoft Excel.

<P><LI>Click Close from the File menu to close the original workbook.

<P><LI>Save the new workbook. This workbook will now allow you to modify the
<P><PRE>    menu.
</PRE><P>
<P>
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, you do not use the Menu Editor the same as you did
in earlier versions of Microsoft Excel. To work with menus in Microsoft
Excel 97, read each of the sections listed below.
<P>
<P><h3>Customize Existing Menus</h3>
 
<P>
This example will customize the Window menu on the Worksheet menu bar.

<OL><P><LI>On the Tools menu, click Customize.
<P>
</OL>You will now be able to customize the menus in Microsoft Excel 97.

<OL><P><LI>When the Customize dialog box appears, click Window on the Worksheet
   Menu Bar.

<P><LI>Right click Split and then click Delete on the shortcut menu.

<P><LI>Click Close on the Customize dialog box.
<P>
</OL>If you click Window, the Split menu item is not on the menu.

<OL><P><LI>On the Tools menu click Customize.

<P><LI>When the Customize dialog box appears, right click Window on the
   Worksheet Menu Bar.

<P><LI>Click Reset on the shortcut menu that appears.

<P><LI>Click Close on the Customize dialog box.
<P>
</OL>If you click Window, the Split menu item is back on the menu.
<P>
<P>
<P><h3>Creating a New Custom Menu</h3>
 

<OL><P><LI>On the Tools menu click Customize.

<P><LI>In the Customize dialog box click the Commands tab.

<P><LI>In the Categories list box, scroll down to the bottom of the list and
   click New Menu.
<P>
</OL>On the right side of the Commands tab, New Menu is listed under Commands:.

<OL><P><LI>Drag New Menu to the Worksheet Menu Bar and place it to the right
   of the Help menu.
<P>
</OL>Note: When you move "New Menu" up to the Worksheet Menu Bar, an insertion
line becomes visible to assist you in locating your new menu.

<OL><P><LI>In the Categories list box, click Macros.
<P>
</OL>On the right side of the Commands tab, you now see Custom Menu Item and
Custom Button under Commands:.

<OL><P><LI>Drag Custom Button and place it (do not drop it yet) on top of New
   Menu that now appears on the Worksheet Menu bar.

<P><LI>A small empty menu appears below New Menu. Drop Custom Button on
   this small empty menu.
<P>
</OL>Note" The insertion marker should be in the empty menu that appears below
New Menu in order for Custom Button to become a menu item on New Menu.

<OL><P><LI>Right click Custom Button, which is now a menu item on New Menu.
<P>
</OL>A shortcut menu appears with a list of all the changes you can make to this
menu item. The following is a partial list of the things you can do:

<UL><LI>change the name to something other than Custom Button

<LI>change the button image on this menu item

<LI>assign a macro to this menu item

<LI>delete the menu item

</UL><OL><P><LI>Click Close on the Customize dialog box to finish customizing your
   menus.
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Customizing Menus, click the Index tab in
Microsoft Excel 97 Help, type the following text
<P>
<PRE>   menus, setting defaults for commands

</PRE></OL>and then double-click the selected text to go to the "Restore original
settings for a built-in toolbar button or menu command" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlui<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
