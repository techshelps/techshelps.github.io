

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL98: "Not Enough Memory" Error Using Linking Formulas </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181465">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1998/02/19">
<META NAME="Keywords" CONTENT="xlloadsave">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 98 Macintosh Edition, when you do any of the following   - You open a workbook that contains formulas that are linked to cells in    other workbooks.      -or-   - You enter a formula that links to a cell (or cells) in another wo...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAB9,QDNM,QAE2,QDNZ,QBVV,QBJQ,QBVP,QABN,QAK6,QANY,QAUD,QAPF,QAHT,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: "Not Enough Memory" Error Using Linking Formulas</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181465</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, when you do any of the following

<UL><LI>You open a workbook that contains formulas that are linked to cells in
   other workbooks.
<P>
<P><PRE>    -or-
</PRE>
<LI>You enter a formula that links to a cell (or cells) in another workbook
   (or workbooks).
<P>
<P><PRE>    -or-
</PRE>
<LI>You close a workbook.
<P>
</UL>you may receive the following error message:
<P>
<PRE>   Not enough memory.

</PRE>In addition, cells that contain formulas that are linked to other workbooks
may return the #REF! error value.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if formulas in your workbook are linked to more than
16,375 unique cells in any one worksheet in a closed workbook. For a more
detailed description of this limitation, see the "More Information" section
in this article.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use one of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Open the workbook that contains the cells to which the formulas are linked
(the source workbook). The limitation described in this article does not
apply when the formulas are linked to cells in an open workbook.
<P>
<P><h3>Method 2</h3>
 
<P>
Split the data in the source workbook into multiple worksheets, and then
modify the formulas in the dependent workbook to account for the change in
worksheet names. This method works because the limitation applies to each
worksheet to which the formulas are linked. The limitation does not apply
to the entire workbook.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example Assumptions</h3>
 
<P>
For the following example and information, assume that you are using the
following three workbooks:
<P>
<PRE>   Book1 (source workbook)
   Book2 (source workbook)
   Book3 (dependent workbook)

</PRE>Each workbook contains three worksheets, Sheet1, Sheet2, and Sheet3.
Book1 and Book2 contain values in A1:A17000 on each worksheet (cells are
not blank). Book1 and Book2 are both closed.
<P>
When you use a workbook with formulas that link to other workbooks
in Microsoft Excel 98 Macintosh Edition, the following rules apply:

<UL><LI>In a workbook, the total of all of the formulas in the workbook must
   refer to less than 16,375 unique cells in any worksheet in any other
   closed workbook.
<P>
   For example, formulas in Book3 can link to 16,375 different cells in
   each worksheet in Book1 and 16,375 different cells in each worksheet
   in Book2.

<LI>After a formula successfully links to a cell in the source workbook,
   other formulas in the same dependent workbook can link to that cell.

<LI>Formulas that are linked to blank cells are not counted toward the
   linking limit. However, formulas that are linked to cells that contain
   the value 0 (zero) are counted toward the limit.

<LI>If the source workbook is open, the limitation does not apply. However,
   if the dependent workbook is still open, you may receive a "Not enough
   memory" message when you close the source workbook.
<P>
</UL><h3>Examples</h3>
 
<P>
To see an example of the behavior, do the following:

<OL><P><LI>Given a workbook (Book1) that contain values in A1:A17000 on each of
   three worksheets, enter the following formulas in cells A1 and A2 on
   Sheet1 of the dependent workbook (Book3) while Book1 is closed:
<P>
<P><PRE>      A1: =SUM([Book1]Sheet1!A1:A16000)
      A2: =SUM([Book1]Sheet1!A16001:A17000)
</PRE><P>
   When you enter the second formula, you receive the "Not enough memory"
   error message because Book3 contains links to more than 16,375 different
   cells in [Book1]Sheet1.

<P><LI>Change the formula in cell A2 to the following:
<P>
<P><PRE>      A2: =SUM([Book1]Sheet2!A16001:A17000)
</PRE><P>
   The error message does not appear because there are links to only 16,000
   different cells in Sheet 1 of Book1 and 1,000 different cells on Sheet2
   of Book1.
<P>
<P><PRE>    -or-
</PRE><P>
   Change the formula in cell A1 to the following:
<P>
<P><PRE>      A1: =SUM([Book1]Sheet1!A1:A16000,[Book1]Sheet3!A1:A16000)
</PRE><P>
   This formula works because the number of links to different cells in any
   one worksheet in Book1 is less than 16,375.
<P>
</OL>Note that if you enter the following formula on Sheet1 of Book3
<P>
<PRE>   D1: =[Book2]Sheet1!A1

</PRE></OL>and then fill the formula down to row 16,376, you receive the error message
because Book3 contains links to more than 16,375 different cells on Sheet1
of Book2.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 16376 16375 16384<BR>
Keywords          : xlloadsave<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
