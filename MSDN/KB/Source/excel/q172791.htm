

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Formula References Incorrect After Pressing CTRL+ENTER </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172791">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/08/15">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you enter a formula in a range of cells by selecting the cells, typing the formula, and pressing CTRL+ENTER, cell references in the formulas may be switched to absolute instead of relative referencing or vice versa. Also, in ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAAP,QAR4,QDNZ,QAB9,QAE5,QAUD,QAKR,QAHE,QAB3,QAGF,QDMR,QBDA,QAG3,QANX P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Formula References Incorrect After Pressing CTRL+ENTER</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172791</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you enter a formula in a range of cells by
selecting the cells, typing the formula, and pressing CTRL+ENTER, cell
references in the formulas may be switched to absolute instead of relative
referencing or vice versa. Also, in a cell reference, designations for two
cells may switch rows or columns (for example, the range B7:D5 may appear
as B5:D7).
<P>
This may cause problems if you then fill the formulas or if you insert or
delete rows or columns in a worksheet.
<P>
<P><h2>CAUSE</h2>
 
<P>
These problems may occur when you apply the formula to all of the
cells and the formula contains a "backward" reference to a range of cells.
A backward reference is one in which the second cell in the reference is
either above or to the left of the first cell.
<P>
NOTE: If you are not using the same combination of absolute and relative
cell referencing for both cells in the formula, the problem becomes
apparent when you fill the formulas or enter them in a range of cells by
pressing CTRL+ENTER.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use the same combination of absolute and
relative referencing for both cells that are referenced in the formula.
<P>
For example, the following combinations of absolute and relative
referencing do not cause the problem to occur:
<P>
<PRE>   $B$5:$B$10
   B5:B10
   B$5:B$10
   $B5:$B10

</PRE>Any other combinations that use a mixture of absolute and relative
referencing (for example, B5:$B$10) may cause the problem to occur.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples demonstrate the problems described in the "Symptoms"
section.
<P>
<P><h3>Example 1</h3>
 
<P>
In a new worksheet, select the range A1:A2, type the following formula
<P>
<PRE>   =SUM(B1:$B$1)

</PRE>and then press CTRL+ENTER.
<P>
Note the information about cells A1 and A2 that is listed in the following
table.
<P>
<PRE>                                             Referencing
          Expected        Formula that       correct or
   Cell   formula         actually appears   incorrect
   ----------------------------------------------------

   A1     =SUM(B1:$B$1)   =SUM(B1:$B$1)      Correct
   A2     =SUM(B2:$B$1)   =SUM(B$1:$B2)      Incorrect

</PRE>When the formula is applied to cell A2, the second cell, B1, is above the
first cell, B2. When Microsoft Excel switches the two cells, it incorrectly
applies absolute and relative referencing to the formula. However, the
formula does refer to the correct cells.
<P>
Note that if you enter the following formula instead
<P>
<PRE>   =SUM($B$1:B1)

</PRE>both of the formulas in cells A1 and A2 are correct.
<P>
<P><h3>Example 2</h3>
 
<P>
In a new worksheet, select the range A1:C3, type the following formula
<P>
<PRE>   =SUM(E3:$F$4)

</PRE>and then press CTRL+ENTER.
<P>
Note the information about cells A1:C3 that is listed in the following
table.
<P>
<PRE>                                             Referencing
          Expected        Formula that       correct or
   Cell   formula         actually appears   incorrect
   ----------------------------------------------------

   A1     =SUM(E3:$F$4)   =SUM(E3:$F$4)      Correct
   A2     =SUM(E4:$F$4)   =SUM(E4:$F$4)      Correct
   B1     =SUM(F3:$F$4)   =SUM(F3:$F$4)      Correct
   B2     =SUM(F4:$F$4)   =SUM(F4:$F$4)      Correct
   C3     =SUM(G5:$F$4)   =SUM($F$4:G5)      Correct

   B3     =SUM(F5:$F$4)   =SUM(F$4:$F5)      Incorrect
   C2     =SUM(G4:$F$4)   =SUM($F4:G$4)      Incorrect
   A3     =SUM(E5:$F$4)   =SUM(E$4:$F5)      Incorrect
   C1     =SUM(G3:$F$4)   =SUM($F3:G$4)      Incorrect

</PRE>When the formula is applied to cells A3, B3, C1, C2, and C3, the second
cell in each reference is above or to the left of the first cell. When
Microsoft Excel switches the cells, it incorrectly applies absolute and
relative referencing to the formula.
<P>
Note that cells in the formulas in cells A3 and C1 have also switched
row numbers; instead of cell F4, the formulas in A3 and C1 refer to cells
F5 and F3. The ranges that are referenced by the formulas are correct even
though the row numbers are switched.
<P>
Note also that the formula in cell C3 appears correctly even though the
second cell, F4, is both above and to the left of the first cell, G5.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:97,7.0,5.0; MACINTOSH:5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
