

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Using Defined Names to Automatically Update Chart Range </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104185">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/09/09">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" To set up a chart that is automatically updated as you add new information to an existing chart range, use either of the following methods.  Method 1: Use OFFSET() with a defined name  To use this method, follow these steps:   1. In a new worksheet,...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDMF,QAUJ,QBXS,QBVP,QAB9,QAY2,QDNX,QBWS,QAZV,QAXB,QANX,QA50,QA5V,QBJZ,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using Defined Names to Automatically Update Chart Range</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104185</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a
<LI>Microsoft Excel for OS/2, version 2.2, 3.0
<LI>Microsoft Excel for the Macintosh, version 2.x, 3.0, 4.0
</UL> 
<P>
To set up a chart that is automatically updated as you add new information
to an existing chart range, use either of the following methods.
<P>
<P><h3>Method 1: Use OFFSET() with a defined name</h3>
 
<P>
To use this method, follow these steps:

<OL><P><LI>In a new worksheet, type the following data:
<P>
<PRE>       A1:  Month    B1:  Sales
       A2:  Jan      B2:  10
       A3:  Feb      B3:  20
       A4:  Mar      B4:  30

</PRE><P><LI>Choose Define Name from the Formula menu.

<P><LI>In the Name box, type "Date" (without the quotation marks).

<P><LI>In the Refers To box, type:
<P>
       =OFFSET($A$2,0,0,COUNTA($A$2:$A$200),1)

<P><LI>Choose Add.

<P><LI>In the Name box, type "Sales" (without the quotation marks).

<P><LI>In the Refers To box, type:
<P>
       =OFFSET($B$2,0,0,COUNT($B$2:$B$200),1)

<P><LI>Clear cell B2, and type the following formula:
<P>
       =RAND()*0+10
<P>
    NOTE: The above formula, using the volatile function "RAND()",
    is needed to automatically update the OFFSET() formula used in
    the defined name "Sales" when new data is entered into column
    B. The value "10", used in this formula is the original value
    of cell B2.

<P><LI>To create a new chart, select the data, choose New from the
    File menu and select the Chart option.

<P><LI>From the Chart menu, choose Edit Series.

<P><LI>Choose "Sales" as the series to edit.

<P><LI>In the formula in the X Labels box, replace the cell reference
    with the defined name Date. For example, the formula might
    read, =FILENAME.XLS!Date.

<P><LI>In the formula in the Y Values box, replace the cell reference
    with the defined name Company. For example, the formula might
    read, =FILENAME.XLS!Sales.
<P>
</OL><h3>Method 2: Use a database, OFFSET(), and defined names</h3>
 
<P>
You can also define your data as a database and create defined names for
each chart data series. To do this, follow these steps:

<OL><P><LI>In a new worksheet, type the following data:
<P>
<PRE>       A1:  Month    B1:  Sales
       A2:  Jan      B2:  10
       A3:  Feb      B3:  20
       A4:  Mar      B4:  30

</PRE><P><LI>Select the range from A1 to B4 and choose Set Database from the Data
    menu.

<P><LI>From the Formula menu, choose Define Name.

<P><LI>In the Name box, type "Date" (without the quotation marks).

<P><LI>In the Refers To box, type:
<P>
       =OFFSET(Database,1,0,ROWS(Database)-1,1)

<P><LI>Choose Add.

<P><LI>In the Name box, type "Sales" (without the quotation marks).

<P><LI>In the Refers To box, type:
<P>
       =OFFSET(Database,1,1,ROWS(Database)-1,1)

<P><LI>Select the range A1:B4, and create a chart by choosing New from the
    File menu, and then selecting Chart from the list.

<P><LI>From the Chart menu, choose Edit Series.

<P><LI>Choose "Sales" as the series to edit.

<P><LI>In the formula in the X Labels box, replace the cell reference with the
    defined name Date. For example, this formula might read,
    =FILENAME.XLS!Date.

<P><LI>In the formula in the Y Values box, replace the Cell Reference with the
    defined name Company. For example, this formula might read,
    =FILENAME.XLS!Sales.
<P>
</OL>As long as the data that you want to appear in your chart is defined as a
database, the chart will be updated automatically as you add new data.
<P>
NOTE: If you are creating a series chart that plots every value in a
contiguous block of cells in single column starting from row 1, you can use
either of the following formulas in the refers to portion of the defined
name:
<P>
<PRE>   =INDIRECT("Sheet1!$a$1:$a"&amp;COUNT(Sheet1!$A:$A))

      -or-

   =Sheet1!$A$1:OFFSET(Sheet1!$A$1,COUNT(Sheet1!$A:$A),0)

</PRE></OL>To start on a row other than one, reference that row in the first cell
reference and add the starting row number to the count to find the last row
number. To plot contiguous non-numeric entries (such as labels), use
COUNTA() instead of COUNT().
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 1," version 4.0, pages 306-325, 434-451
"Function Reference Guide," version 4.0, pages 68, 69, 299
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.00 2.0x 3.00 4.00 4.00a database counta count<BR>
dynamic<BR>
Version           : WINDOWS: 2.0,3.0,4.0,4.0a; MACINTOSH: 2.0,3.0,4.0<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
