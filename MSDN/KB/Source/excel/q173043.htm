

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSQuery: "Invalid Bracketing" Error Adding Field to MS Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173043">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/08/22">
<META NAME="Keywords" CONTENT="xlquery kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Query 97 for Windows, if you attempt to add a field to the data pane by double-clicking a field in the list of fields, you may receive the following error message:     Microsoft Query    Invalid bracketing of name '           .        ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QA7N,QA7O,QAUJ,QABI,QBWS,QACF,QBPM,QBJ2,QALY,QAIK,QAKP,QAYY,QAB4,QA01 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQuery: "Invalid Bracketing" Error Adding Field to MS Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Query 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Query 97 for Windows, if you attempt to add a field to the
data pane by double-clicking a field in the list of fields, you may receive
the following error message:
<P>
<PRE>   Microsoft Query
   Invalid bracketing of name '&lt;TableName&gt;.&lt;FieldName&gt;'.

</PRE>When you click OK, all data and criteria may disappear from Microsoft
Query.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when the field name in the list of fields includes a
period. For example, double-clicking the following field names may cause
the problem to occur:
<P>
<PRE>   Customers.CompanyName
   Shippers.CompanyName

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use the Query Wizard to add such fields to the
data pane. To do this when you create a new query, follow these steps:

<OL><P><LI>In Microsoft Query 97, click New on the File menu.

<P><LI>In the Choose Data Source dialog box, click the data source you want
   to use. Make sure that the "Use the Query Wizard to create/edit
   queries" check box is checked. Then, click OK.

<P><LI>In the "Query Wizard - Choose Columns" dialog box, click the tables
   and columns that you want to include in the query and add them to
   the query by clicking the "&gt;" button. When you are done, click Next.

<P><LI>In the "Query Wizard - Filter Data" dialog box, apply any filters you
   want to use. Then, click Next.

<P><LI>In the "Query Wizard - Sort Order" dialog box, apply any sort order you
   want. Then, click Finish.
<P>
   NOTE: If you are returning external data into Microsoft Excel 97,
   click Next. Then, click "View data or edit query in Microsoft Query,"
   and click Finish.
<P>
</OL>It is not possible to add a field with a name that contains a period to an
existing query even if you manually modify the Structured Query Language
(SQL) statement used to create the query.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem occurs because of a problem in how Microsoft Query 97 parses
the SQL statement that is used to create a query. Normally, the reference
to a table and field in an SQL statement resembles the following:
<P>
<PRE>   &lt;TableName&gt;.&lt;FieldName&gt;
   Invoices.Address
   Invoices.City

</PRE></OL>However, if the field name contains a period, the reference in the SQL
statement resembles the following:
<P>
<PRE>   &lt;TableName&gt;.&lt;FieldName&gt;.&lt;SecondPartOfFieldName&gt;
   Invoices.Customers.CompanyName
   Invoices.Shippers.CompanyName

</PRE>Microsoft Query 97 can handle a field name that contains a period only if
you add the field to the data pane by using the Query Wizard.
<P>
Note that it is rare for a field name to contain a period. However, the
Northwind database included with Microsoft Office 97 includes a table that
contains two fields with names that include periods.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 invoices access<BR>
Keywords          : xlquery kbtool<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
