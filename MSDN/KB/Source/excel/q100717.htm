

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Links Return #REF Error Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100717">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/06/27">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when a cell being referenced within a link is moved to another worksheet, Microsoft Excel does not see that the reference has been moved. The link behaves as if the cell were deleted and returns a #REF! error value. But, if the ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDNZ,QAEF,QAUD,QA9N,QAB3,QAKD,QAB4,QAAP,QAC1,QBE7,QBE6,QAY5,QBQC,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Links Return #REF Error Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100717</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 2.2 , 3.0 ,4.0, 5.0,
   5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when a cell being referenced within a link is moved to
another worksheet, Microsoft Excel does not see that the reference has been
moved. The link behaves as if the cell were deleted and returns a #REF!
error value. But, if the cell is moved within the same worksheet, the
reference will be updated as expected.
<P>
This behavior will also occur if you move cells on top of the cells being
referenced by dragging the new cells over the referenced cells or by using
the Cut and Paste commands.
<P>
This situation also applies to workbooks in Microsoft Excel, version
4.0.
<P>
This feature is by design of Microsoft Excel.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid receiving a #REF! error value when dragging or pasting cells
on top of externally referenced cells, use the INDIRECT() function or
the OFFSET() function to reference the cell indirectly. For example,
to reference cell A1 in Sheet1, use one of the following formulas in cell
A2 of Sheet1.
<P>
<P><h3>Microsoft Excel versions 5.0, 7.0</h3>
 
<P>
<PRE>   =INDIRECT("Sheet1!A1")

   -or-

   =OFFSET(Sheet1!A2,-1,0)

</PRE><h3>Microsoft Excel versions 2.x, 3.0, 4.0</h3>
 
<P>
<PRE>   =INDIRECT("Worksheet1!A1")

   -or-

   =OFFSET(worksheet1.xls!A2,-1,0)

</PRE>Note, neither of these two functions, if used to reference cell A1, will
return the #REF! error, but they also will not update the cell reference
within the formula. So, in this example, if cell A1 is cut and pasted into
another worksheet, cell A2 will still reference cell A1 and will show a
value of 0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 1," version 4.0, page 192
"User's Guide," version 3.0, page 160
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 2.00 2.01 2.10 2.10c 2.10d 4.00 4.00a 3.00<BR>
Version           : WINDOWS: 2.0,3.0,4.0,5.0,5.0c,7.0; MACINTOSH: 2.2,3.0,4.0,5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
