

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Incorrect Results/GP Fault Double-Clicking Toolbar Area </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121400">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/10/04">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you use the OnDoubleClick property in a Visual Basic procedure, or the ON.DOUBLECLICK function in a version 4.0 macro to assign a macro to run when you double-click on a worksheet or chart, one of the following occurs when yo...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBKN,QBWS,QBS0,QAH4,QAF0,QANS,QAVX,QAVW,QAY5,QAPN,QAB9,QBV8,QBXS,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Incorrect Results/GP Fault Double-Clicking Toolbar Area</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121400</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you use the OnDoubleClick property in a Visual Basic
procedure, or the ON.DOUBLECLICK function in a version 4.0 macro to assign
a macro to run when you double-click on a worksheet or chart, one of the
following occurs when you double-click on the toolbars area:

<UL><LI>The macro that you assigned is run
<P>
   -or-

<LI>You receive a general protection (GP) fault
<P>
</UL><h2>CAUSE</h2>
 
<P>
This behavior occurs when you use the following in a Visual Basic procedure
<P>
<PRE>   Workbooks("BOOK1.XLS).Worksheets("Sheet1").OnDoubleClick = "Test"

</PRE>or the following in a version 4.0 Macro
<P>
<PRE>   =ON.DOUBLECLICK("[Book1]Sheet1", "Macro1!Test")

</PRE>to assign the macro TEST to run when you double-click on Sheet1 in
BOOK1.XLS, and you then double-click on the toolbars area.
<P>
If BOOK1.XLS is open when you double-click on the toolbars area, the
macro TEST runs. If you close BOOK1.XLS, and then double-click on the
toolbars area in the same session of Microsoft Excel, you receive a
GP fault.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving a GP fault, when you have used either the OnDoubleClick
property or the ON.DOUBLECLICK function in the current session of Microsoft
Excel, do not double-click on the toolbars area. Instead, do either of the
following:

<UL><LI>From the View menu, choose the Toolbars command to display the Toolbars
   dialog box.
<P>
   -or-

<LI>Close Microsoft Excel.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel version 5.0c.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the OnDoubleClick property or the ON.DOUBLECLICK function to
set the name of a macro to run whenever you double-click anywhere on the
specified chart or sheet. When you run the procedure that contains this
property, or the macro that contains this function, the assigned macro
should not run when you double-click in the toolbar area. Instead, the
toolbars dialog box should be displayed.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the OnDoubleClick Property, choose the
Search button in the Visual Basic Reference and type:
<P>
<PRE>   OnDoubleClick Property

</PRE>For more information about ON.DOUBLECLICK, choose the Search button
in Microsoft Excel Macro Functions Help and type:
<P>
<PRE>   ON.DOUBLECLICK function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 gpf
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
