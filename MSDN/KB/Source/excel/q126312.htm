

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Err Msg: "Invalid File Format" Attempting to Save </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126312">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1995/02/20">
<META NAME="Keywords" CONTENT="kbole kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you save a file in Microsoft Excel, you may receive one of the following error messages:     Invalid file format     -or-     Cannot Access f:\Data\Excel     (where f:\Data\Excel is the drive and directory from which you opened    the file)   ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUR,QAB4,QAU7,QBF0,QBMR,QA9Q,QAYV,QAY2,QBWS,QA1S,QBXB,QA5E,QATJ,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Err Msg: "Invalid File Format" Attempting to Save</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126312</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you save a file in Microsoft Excel, you may receive one of the
following error messages:
<P>
<PRE>   Invalid file format

   -or-

   Cannot Access f:\Data\Excel

   (where f:\Data\Excel is the drive and directory from which you opened
   the file)

   -or-

   Unable to write to disk

   -or-

   Document not saved

</PRE><h2>CAUSE</h2>
 
<P>
Microsoft Excel 5.0 creates links between the open file and two temporary
working files with .TMP extensions. When you open a file, the temporary
files are stored in either the TEMP directory or the drive from which the
file was opened. (The location of your TEMP directory is determined by the
SET TEMP statement in your AUTOEXEC.BAT file.)
<P>
In Microsoft Excel version 5.0, and other Microsoft Office applications
such as Microsoft Word 6.0, workbook document files are not stored entirely
in memory. Some elements of the document are stored on the disk your file
is stored on. This is due to a new Docfile format in object linking and
embedding (OLE) version 2.0.
<P>
If the link between the open document and the temp files is broken, the
document can no longer be saved, and you may receive one of the error
messages listed above. This problem may occur, for example, if you open a
file from a network drive. If the network connection is broken while you
are making changes to the file, you may receive one or more of the error
messages listed above when you attempt to save the file.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To maintain the links between the open document and the temporary files and
to avoid this problem, do not disconnect from the network or remove the
floppy disk from which the file was opened.
<P>
If an error occurs when you save a workbook file, copy or drag the sheet(s)
to a new workbook (to create a new .TMP file in the TEMP directory) and
save the new document.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q114440.htm">Q114440</A></B>
   TITLE     : XL5: Error Editing/Saving File When Can't Access File on
               Disk
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbole kberrmsg<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 temp link ole2 ole2.0
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
