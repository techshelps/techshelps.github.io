

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Directories Function Returns an Error in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71255 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1991/04/10">
<META NAME="Keywords" CONTENT="kbother kbdocerr docerr">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The  Microsoft Excel User's Guide,  version 3.0, incorrectly states that the add-in FILEFNS.XLA DIRECTORIES macro will return a list of the subdirectories in the current directory when the argument is omitted. The  User's Guide  shows the following...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAFI,QBXB,QATJ,QAUD,QAY5,QAB9,QBV8,QAC1,QAAP,QALW,QA62,QAPF,QA50 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Directories Function Returns an Error in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71255 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 3.0
<LI>Microsoft Excel for the Macintosh, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The "Microsoft Excel User's Guide," version 3.0, incorrectly states that
the add-in FILEFNS.XLA DIRECTORIES macro will return a list of the
subdirectories in the current directory when the argument is omitted. The
"User's Guide" shows the following macro formula:
<P>
<PRE>   =DIRECTORIES()

</PRE>If you enter the function this way, the #VALUE! error is returned.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To return a list of the subdirectories in the current directory, use the
DIRECTORY function to provide the current directory name for the
DIRECTORIES function as in the following example:
<P>
<PRE>   =DIRECTORIES(DIRECTORY())

</PRE>You can also use the DIRECTORIES function with any directory as a string
argument, or with an empty string such as the following
<P>
<PRE>   =DIRECTORIES("")

</PRE>This example correctly returns an array of all subdirectories in the root
directory of the current drive.
<P>
<P><h2>STATUS</h2>
 
<P>
This problem has been corrected in Microsoft Excel version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel version 4.0, you can use the DIRECTORIES function
without the quotation marks to return the subdirectories in the current
directory. However, the Microsoft Excel version 4.0 "Function Reference"
shows an incorrect example using quotation marks, and states that this
method will return a list of the subdirectories in the current directory.
Instead, when you use the function as in the following example
<P>
<PRE>   =DIRECTORIES("")

</PRE>a list of the subdirectories in the root directory of the current drive is
returned.
<P>
Note that the File Functions add-in is not included in Microsoft Excel
version 5.0. However, if you install Microsoft Excel version 5.0 to the
directory that contains Microsoft Excel version 3.0 or 4.0, you can open or
load the file FILEFNS.XLA and use the functions contained in the add-in. \*
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, page 114
<P>
"Microsoft Excel User's Guide," version 3.0, Appendix B, page 680
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother kbdocerr<BR>
KBSubcategory:
<P>

Additional reference words: 2.00 2.0 2.01 2.1 2.10 2.2 2.21 2.20 3.00<BR>
3.0 docerr addins<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
