

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using FORMULA.CONVERT() to Change Relative/Absolute References </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q70096 ">
<META NAME="KBModify" CONTENT="1996/08/23">
<META NAME="KBCreate" CONTENT="1991/03/12">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You can use the FORMULA function with the FORMULA.CONVERT function to change every reference in a selected area from relative to absolute reference. You can do this by using the FORMULA.CONVERT function to calculate the first argument, formula_text...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QAY5,QBVP,QAB3,QBV8,QAPN,QAHE,QAH4,QAG3,QBDA,QA2Q,QAUD,QBS0,QABI,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using FORMULA.CONVERT() to Change Relative/Absolute References</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q70096 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use the FORMULA function with the FORMULA.CONVERT function to
change every reference in a selected area from relative to absolute
reference. You can do this by using the FORMULA.CONVERT function to
calculate the first argument, formula_text, of the FORMULA function.
<P>
However, because the FORMULA function will fail if you attempt to use
A1-style references, you need to make sure that the FORMULA.CONVERT
function is returning an R1C1-style formula and not an A1-style
formula.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The third argument of the FORMULA.CONVERT function, To_a1, determines
whether an A1-Style or R1C1-style reference is returned.
<P>
<P><h3>Example</h3>
 
<P>
The following macro is a short example that will convert all the
references in the currently selected area into absolute
references.
<P>
NOTE: This macro assumes that the references in the selected area are
currently in A1-style. If you want to select an area that contains
relative references in R1C1-style, change the second argument of the
FORMULA.CONVERT function from TRUE to FALSE.
<P>
<PRE>   A1: =FOR.CELL("curcell",,TRUE)
   A2: =FORMULA(FORMULA.CONVERT(GET.CELL
        (6,curcell),TRUE,FALSE,1,curcell),curcell)
   A3: =NEXT()
   A4: =RETURN()

</PRE><P><LI>The FOR.CELL function starts a For.Cell-Next loop that will loop
   through the currently selected area. "curcell" is just the ref_name
   given to the new cell through each loop.

<P><LI>The second line converts each reference in the selected range to an
   absolute references in R1C1-style, and then places it back into the
   current cell of the selection. If you wanted the macro to change
   absolute references to relative references, you would replace the
   fourth argument of the FORMULA.CONVERT function from 1 to 4. You
   must also include curcell as noted above otherwise, it will convert
   references based directly on the macro sheet rather than the
   worksheet cells.
<P>
</OL>NOTE: The third argument of the FORMULA.CONVERT function must be FALSE to
use the FORMULA.CONVERT function to return the formula_text argument to the
FORMULA function. If this third argument is TRUE, or if the formula_text
argument uses A1 style references and this third argument is omitted, you
will receive a macro error.
<P>
For an example of how to perform this function using a Visual Basic for
Applications macro, see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q116028.htm">Q116028</A></B>
   TITLE     : XL: VB Macro to Change Between Relative/Absolute References

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, pages 168-171
<P>
"Microsoft Excel Function Reference," version 3.0, pages 89-91
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory:
<P>

Additional reference words: 7.00 3.0 3.00 4.0 4.00 5.00 sort<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 23, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
