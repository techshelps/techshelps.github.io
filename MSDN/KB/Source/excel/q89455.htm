

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Cell Alignment Formats Cause Flatfile Export to Fail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89455 ">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1992/09/22">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, exporting data from your spreadsheet to a text file with the Flatfile add-in macro (Flat File on the Macintosh) may fail if the selected range contains cells formatted with any of the following alignment formats: Fill, Justify, ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QBVP,QAEB,QBJZ,QDNG,QBRZ,QAY2,QAIV,QBXS,QBS9,QBCF,QBWS,QDKW,QA9N,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Cell Alignment Formats Cause Flatfile Export to Fail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89455 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, exporting data from your spreadsheet to a text file
with the Flatfile add-in macro (Flat File on the Macintosh) may fail if the
selected range contains cells formatted with any of the following alignment
formats: Fill, Justify, or Center Across Selection.
<P>
Typically, one of the following symptoms results:

<UL><LI>Some or all of your data is missing in the text file.
<P>
   -or-

<LI>You receive the error message "Error writing to disk."
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The Flatfile add-in macro provides a means for exporting worksheet data to
a text file using flat file format. Flat file format is a text format in
which the data is separated by spaces rather than commas or tabs. You can
also choose to retain the cell formatting of the exported data.
<P>
Flatfile exports data using a fixed-width field. This means that any data
that extends beyond the borders of the cell that contains it, is cut off at
the whole number width of the cell. For example, from a cell with a column
width of 12.5, only the first 12 characters are exported.
<P>
Workarounds:
<P>
<P><h3>Workaround 1</h3>
 
<P>
The easiest way to work around this limitation is to export from a copy of
your spreadsheet that doesn't contain these alignment formats.
<P>
To create a copy to export from:

<OL><P><LI>Select your spreadsheet, or the range of data you want to export.

<P><LI>From the Edit menu, choose Copy.

<P><LI>From the File menu, choose New.

<P><LI>Select Worksheet from the list, and then choose the OK button.

<P><LI>From the Edit menu, choose Paste Special.

<P><LI>In the Paste Special dialog box, select the Formulas option and
   then choose OK.
<P>
   Excel pastes your data to the new worksheet without any formats.

<P><LI>Format your new worksheet using Number, Date, Currency and Time
   formats with Right, Left and Center alignment formats only.
<P>
   Use the resulting formatted worksheet to export your data with
   Flatfile.
<P>
</OL><h3>Workaround 2</h3>
 
<P>
You can modify the add-in macro file to make it compatible with the
Fill, Justify and Center Across Selection alignment formats.
<P>
To modify Flatfile to export without error:

<OL><P><LI>Open FLATFILE.XLA (Flat File on the Macintosh) while holding
   down the SHIFT key.
<P>
   Note: Holding down the SHIFT key causes Microsoft Excel to open
   the add-in file for editing.

<P><LI>Unhide FLATFILE.XLA (Flat File on Macintosh) by choosing Unhide
   from the Window menu and selecting Flatfile from the list of hidden
   documents.

<P><LI>Make the following change in cell B86 of FLATFILE.XLA (Flat File on
   Macintosh):
<P>
   Change:
<P>
   B86: =IF(GET.CELL(8,mcp01r.Cell)=1,
<PRE>          IF(ISNUMBER(mcp01r.Cell),3,1),GET.CELL(8,mcp01r.Cell)-1)

   To:

   B86: =(IF(OR(GET.CELL(8,mcp01r.Cell)=1,GET.CELL(8,mcp01r.Cell)&gt;4),
          IF(ISNUMBER(mcp01r.Cell),3,1),GET.CELL(8,mcp01r.Cell)-1))

</PRE></OL>This modification causes Flatfile to treat Fill, Justify or Center Across
Selection alignment formats as General alignment.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 2," version 4.0, page 152
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.0 3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
