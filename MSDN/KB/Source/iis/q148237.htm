

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDC: Error Performing Query Connecting to SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148237">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1996/03/07">
<META NAME="Keywords" CONTENT="iisscript kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you execute an IDC script that connects to a remote SQL Server, one of the following error messages appear from the web browser:     Error Performing Query     *   [State=01000][Error=1385][Microsoft][ODBC SQL Server        Driver][dbnmpntw]Co...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QABM,QA9A,QAI5,QAVZ,QAB4,QBW3,QAAP,QAGU,QBG2,QA7A,QA69,QBVX,QAYY,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>IDC: Error Performing Query Connecting to SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148237</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server versions 1.0, 2.0, 3.0, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you execute an IDC script that connects to a remote SQL Server, one of the following error messages appear from the web browser:
<P>
<PRE>   Error Performing Query

   *   [State=01000][Error=1385][Microsoft][ODBC SQL Server
       Driver][dbnmpntw]ConnectionOpen (CreateFile()).
   *   [State=08001][Error=1385][Microsoft][ODBC SQL Server Driver]Unable
       to connect to data source

   -or-

   *   [State=01000][Error=1326][Microsoft][ODBC SQL Server
       Driver][dbnmpntw]ConnectionOpen (CreateFile()).
   *   [State=08001][Error=1326][Microsoft][ODBC SQL Server Driver]Unable
       to connect to data source

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs because of one or all of the following:

<UL><LI>The user account IUSR_&lt;Server Name&gt; (where &lt;Server Name&gt; is the name 
   of your Internet Information Server) does not have the "Access this
   computer from the network" user right configured on the SQL Server.

<LI>The Internet Information Server and the SQL Server are on different
   domains and the IUSR_&lt;Server Name&gt; account does not exist in the SQL
   Server’s local user database or domain.

<LI>The Internet Information Server and SQL Server are on the same domain;
   however, the Internet Information Server is installed on a Server 
   (non-domain controller) and the SQL Server is installed on a Domain
   Controller. The IUSR_&lt;Server Name&gt; account does not exist on the
   domain.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To correct this problem, do one or all of the following:

<UL><LI>Grant the IUSR_&lt;Server Name&gt; the "Access this computer from network"
   user right on the SQL Server.

<LI>If there is a trust established between the domains, whereas the
   Internet Information Server in the Resource domain, then you can set
   the "Username:" value under "Anonymous Logon" to be
   MASTERDOMAIN\username (where username is a user account that was
   created on the Master Domain).
<P>
   If there is not a trust relationship involved, you must create an
   IUSR_&lt;Server Name&gt; account on the remote domain and give it the
   appropriate rights. (See first resolution above)
<P>
   Note: If there is no trust, the username and password in one domain
   must match the username and password on the other domain.

<LI>Modify the "Username:" value under "Anonymous Logon" in the Microsoft
   Internet Service Manager to use the following format:
<P>
<P><PRE>      DOMAIN\IUSR_&lt;Server Name&gt;.
</PRE><P>
   If the IUSR_&lt;Server Name&gt; does not exist on the domain, then create 
   the account using User Manager for Domains.

<LI>See <B><A HREF="../SQLSERVER/Q141086.htm">Q141086</A></B> in the SQL Server Knowledge Base for information on fixing
   a bug in the SQL Server 2.5 ODBC driver.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The Internet Information Server accesses the SQL Server by first connecting to the IPC$ share of the SQL Server. It uses the user name and password specified for Anonymous Logon (entry is in the Service tab of Internet Service Manager).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodiis<BR>
Keywords          : iisscript kbnetwork<BR>
Version           : WINNT: 1.0,2.0,3.0,4.0<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
