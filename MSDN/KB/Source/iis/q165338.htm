

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IIS Does Not Allow its TCP Port to Be Same as SSL Port </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165338">
<META NAME="KBModify" CONTENT="1997/11/06">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="iiswww kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you install a Secure Sockets Layer (SSL) Certificate and commit the changes, and you stop and restart the WWW service, you may get  the following error message:     Winsock Error: Address already in use  NOTE: This error message will also appe...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKG,QDJP,QABG,QAB4,QAJQ,QABI,QAVZ,QBVV,QACK,QABH,QAAP,QAAD,QBWP,QAA1,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>IIS Does Not Allow its TCP Port to Be Same as SSL Port</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165338</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to: 

<UL><LI>Microsoft Internet Information Server versions 2.0 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you install a Secure Sockets Layer (SSL) Certificate and commit
the changes, and you stop and restart the WWW service, you may get 
the following error message:
<P>
<PRE>   Winsock Error: Address already in use

</PRE>NOTE: This error message will also appear when you run the QBIK Wingate 
Engine (as Service). This service is similar to Dialup Networking.
<P>
<P><h2>CAUSE</h2>
 
<P>
Because the SSL binding is the newly installed key to port 443 and does not 
allow anything else to use that specific port, the TCP port on IIS cannot 
use the same port as the SSL port. 
<P>
Notes: 

<UL><LI>Some other Web Servers do allow a shared port, for example, Netscape 
   Enterprise Server 2.0.

<LI>443 is only an example port.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them. 
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
Use the following steps to check to see if the ports are the same:

<OL><P><LI>In Internet Service Manager, go to WWW Properties and check TCP 
   port value. 

<P><LI>Open Regedit or Regedt32 and go to following location:
<P>
   HKEY_LOCAL_MACHINE\CurrentControlSet\Services\W3SVC\Parameters

<P><LI>Select the SecurePort key and get value in parenthesis 
   (for example, 443).

<P><LI>Check the two numbers (IIS TCP port and SecurePort) and verify that 
   they are not the same. If they are duplicated, change the TCP port 
   value in Internet Service Manager to port 90 or any other port that 
   is not in use.
<P>
   This will correct this Winsock error and should allow IIS to be
   restarted again.
<P>
</OL>NOTE: To do this you must first make a backup of your key and then remove 
it from key manager. IIS will not restart until this has been done cause 
<P><h2>SSL still has control of the port so the port value cannot be changed.</h2>
 
<PRE>Keywords          : iiswww kberrmsg
Version           : Winnt:2.0,3.0
Platform          : winnt
Hardware          : ALPHA x86
Issue type        : kberrmsg
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
