

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Internet Information Server Security .CMD /.BAT Patch </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148188">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1996/03/06">
<META NAME="Keywords" CONTENT="iisconfig iissecurity kbbug1.00 kbenv kbfix3.51 kbnetwork NTSrv">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  On Sunday, February 25, 1996, Microsoft was alerted to a newsgroup posting regarding a Internet Information Server (IIS) security exposure. This  .CMD /.BAT Bug  allows a complicated string of commands sent from a web browser to an IIS server to be...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QBWP,QBWS,QAA1,QDI2,QBJZ,QAVZ,QBXS,QDNQ,QAY2,QBVX,QAKP,QAAD,QBW9,QAL0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Internet Information Server Security .CMD /.BAT Patch</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148188</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
On Sunday, February 25, 1996, Microsoft was alerted to a newsgroup posting
regarding a Internet Information Server (IIS) security exposure. This ".CMD
/.BAT Bug" allows a complicated string of commands sent from a web browser
to an IIS server to be executed on that server.
<P>
Malicious internet users can use this capability to tamper with an IIS
installation (it is highly unlikely that accidental modification to your
IIS installation can happen as a result of this bug).
<P>
This problem is not unique to IIS -- similar problems exist with other
Windows NT Web servers. As a result, the Microsoft Developer Relations
group is in the process of notifying these vendors about the problem and
providing guidance so that they can address it where appropriate.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has developed a fix which provides a permanent solution to this
problem. This fix is available now for you to download. It is important to
note that you should always follow the safety guidelines outlined in the
IIS Installation Guide regarding the securing of IIS against intruders, in
order to minimize exposure to security problems. Regardless of whether or
not you have followed these instructions, we recommend you download and
install the .CMD /.BAT Patch on all IIS installations.
<P>
All versions of IIS downloaded from our online distribution sites after
March 5, 1996 contains this fix.
<P>
This patch is available for each of the Windows NT platforms in the
following locations:
<P>
<PRE>   Microsoft's WWW server at the following URL:
   <B><A HREF="http://www.microsoft.com/infoserv/iisenhance.htm">http://www.microsoft.com/infoserv/iisenhance.htm</A></B>

   Microsoft's FTP server at the following URL:
   <B><A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/IIS/fixes/cmdbat/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/IIS/fixes/cmdbat/</A></B>

</PRE>To install the patch, download the executable for your platform. The
executable automatically installs the fix when executed by an administrator
on the IIS system.
<P>
To verify the installation of the .CMD /.BAT IIS patch, the system
administrator should check the file properties on the file W3SVC.DLL (found
in the server sub-directory of your IIS installation tree). The version ID
for this file should be 1.0a (Security Update).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft strongly recommends installing this IIS .CMD /.BAT patch,
however, if you are unable to download and install this patch in a timely
manner, you can implement the following workaround until you are able to
install the patch.
<P>
This workaround disables the ability to map either MS-DOS Batch files or
Windows NT CMD files to the Windows NT Command Interpreter. If you have any
CMD or BAT files active as scripts on your IIS installation, this
workaround will disable them.
<P>
You should take note of the registry keys that are deleted in case you
decide to re-enable them at a later date, after the IIS patch has been
installed.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
To disable MS-DOS batch and CMD scripts from your server:

<OL><P><LI>From the Windows NT File Manager File Menu, choose RUN

<P><LI>In the RUN dialog box, type REGEDT32, and choose OK

<P><LI>From the Window menu in Registry Editor (started in the previous step),
   select the "HKEY_LOCAL_MACHINE on Local Machine" window

<P><LI>The following steps will take you to the Script Mapping key for the Web
   Server:
<P>
<P><PRE>      a. Double click on SYSTEM
</PRE><P>
<P><PRE>      b. Double click on CurrentControlSet
</PRE><P>
<P><PRE>      c. Double click on Services
</PRE><P>
<P><PRE>      d. Double click on W3SVC
</PRE><P>
<P><PRE>      e. Double click on Parameters
</PRE><P>
<P><PRE>      f. Select the Script Map key
</PRE>
<P><LI>Select the entry in the Registry Editor right hand pane that starts
   with ".BAT"

<P><LI>From the Edit menu choose Delete

<P><LI>Choose YES to confirm the deletion

<P><LI>Select the entry in the Registry Editors right hand pane that starts
   with ".CMD"

<P><LI>From the Edit menu choose Delete

<P><LI>Choose YES to confirm the deletion

<P><LI>Exit the Registry Editor

<P><LI>Stop and Restart the Internet Information Server
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Internet Information Server
version 1.0. This problem was corrected in the latest Windows NT 3.51 U.S.
Service Pack. For information on obtaining the Service Pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodiis<BR>
Keywords            : iisconfig iissecurity kbbug1.00 kbenv kbfix3.51 kbnetwork NTSrv<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
