

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How IIS 3.0 Handles Client Language </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177749">
<META NAME="KBModify" CONTENT="1998/01/23">
<META NAME="KBCreate" CONTENT="1997/12/05">
<META NAME="Keywords" CONTENT="iisvirtual kbusage">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  This article explains:   - How Internet Information Server (IIS) handles the HTTP  Accept-Language     field   - Why the client may be unable to access to the IIS Web Site if its    language setting matches the name of an IIS virtual directory.  MO...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBWA,QBWI,QARL,QBXB,QBFH,QATJ,QBVX,QAFI,QAUD,QAWP,QAHD,QDH9,QAXC,QAAQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How IIS 3.0 Handles Client Language</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177749</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains:

<UL><LI>How Internet Information Server (IIS) handles the HTTP "Accept-Language"
   field

<LI>Why the client may be unable to access to the IIS Web Site if its
   language setting matches the name of an IIS virtual directory.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The Accept-Language http field allows the client browser to specify the
list of "preferred" languages. For instance if you select Danish with the
Regional Settings Control Panel tool, for each HTTP request Internet
Explorer will add "Accept-Language = da in the HHTP packet. This allows the
Web Server to customize the response based on the client language.
<P>
When IIS receives the request Accept-Language field, IIS tries to see if
the "Accept-Language" virtual directory exist. If yes, then IIS modifies
the query and adds the language to the URL.
<P>
A sample is shown below. In this sample, the IIS Web Server has two
directories defined:

<UL><LI>Home -&gt; C:\Inetpub\WWWROOT
<LI>Virtual directory named da -&gt; C:\Danish
<P>
</UL><h3>First Request</h3>
 
<P>
Client language: Danish
<P>
Client request: GET /yyyy.htm Accept-Language = da

<OL><P><LI>IIS receives the request : GET /yyyy.htm Accept-Language = da

<P><LI>IIS processes the language and checks if a virtual directory named "da"
   exists.

<P><LI>The "da" virtual directory exists. So IIS modifies the request from GET
   /yyyy.htm to GET /da/yyyy.htm.

<P><LI>IIS tries to return the /da/yyyy.htm page. If c:\Danish\yyyy.htm does
   not exist, an error message is returned to the client.
<P>
</OL><h3>Second Request</h3>
 
<P>
Client language: Italian.
<P>
Client request: GET /yyyy.htm Accept-Language = it

<OL><P><LI>IIS receives the request : GET /yyyy.htm Accept-Language = it

<P><LI>IIS processes the language and checks if a virtual directory named "it"
<P><PRE>    exists
</PRE>
<P><LI>In this case the "it" virtual directory DOES NOT exist. IIS does not
   modify the request.

<P><LI>IIS tries to return the /yyyy.htm page.
<P>
</OL>This feature allows IIS to return "localized" pages to the client. The
drawback is that all pages must be duplicated for each language virtual
directory.
 
<PRE>Keywords          : iisvirtual kbusage
Version           : WinNT:3.0
Platform          : winnt</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
