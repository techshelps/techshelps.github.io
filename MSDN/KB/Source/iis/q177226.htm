

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Memory Usage Increases When Querying Access 97 DB w/ ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177226">
<META NAME="KBModify" CONTENT="1998/01/22">
<META NAME="KBCreate" CONTENT="1997/11/24">
<META NAME="Keywords" CONTENT="iishowto iisodbc kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you use Active Server Pages (ASP) to connect to an Access 97 Datasource, memory usage may increase and ASP pages may take a long time to complete requests.  The memory usage level may return to normal after the number of connections to the ASP...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA26,QBTX,QDN9,QAM4,QBWS,QABA,QAKD,QAHE,QDNQ,QA9E,QA6V,QDIZ,QA01,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Memory Usage Increases When Querying Access 97 DB w/ ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 22, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177226</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server versions 2.0 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use Active Server Pages (ASP) to connect to an Access 97
Datasource, memory usage may increase and ASP pages may take a long time to
complete requests.
<P>
The memory usage level may return to normal after the number of connections
to the ASP pages decreases.
<P>
<P><h2>CAUSE</h2>
 
<P>
By default, an Access 97 Datasource has two parameters that affect system
performance: MaxBufferSize and  Threads. The default value for the
MaxBufferSize parameter is 512 and the default value for Threads parameter
is 3.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To improve performance and minimize memory usage, configure these
parameters as follows:

<OL><P><LI>Open the Control Panel (click Start, point to Settings and then click
   Control Panel.

<P><LI>Click the ODBC Control Panel tool.

<P><LI>In the ODBC Datasource Administrator, click the "System DSN" tab.

<P><LI>Select an Access 97 DSN and click Configure.

<P><LI>In the ODBC Microsoft Access 97 Setup dialog box, click Advanced on the
   right of the screen.

<P><LI>In the Set Advanced Options dialog box, select the MaxBufferSize
   parameter. In the Value of MaxBufferSize box, enter 8192.

<P><LI>Select the Threads parameter. In the Value of Threads box, enter 20.

<P><LI>Click OK to commit the changes and close the Set Advanced Options
   dialog box.  Click OK to exit the ODBC Microsoft Access 97 Setup dialog
   box.

<P><LI>Quit the ODBC Datasource Administrator.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The recommended values of MaxBufferSize and Threads (8192 and 20) are
resource dependent and should work in most cases. If the symptoms do not
improve under high load, increase the value of these settings to utilize
available resources.
<P>
 
<PRE>Keywords          : iishowto iisodbc kbnetwork
Version           : WINNT:2.0,3.0
Platform          : winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 22, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
