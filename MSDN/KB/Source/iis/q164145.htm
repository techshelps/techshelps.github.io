

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cannot Open File Accessing Visual FoxPro Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164145">
<META NAME="KBModify" CONTENT="1997/11/06">
<META NAME="KBCreate" CONTENT="1997/02/24">
<META NAME="Keywords" CONTENT="iisodbc kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you perform an Internet Database Connector (IDC) query from an IIS  2.0 server to a Microsoft Visual FoxPro database on a different server,  you may get the following error message on the client browser:     Error Performing Query     [State=S...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QBWS,QA2Q,QAJQ,QA56,QA55,QAB4,QAG2,QBTX,QAAP,QA5C,QAY2,QBW7,QAI5,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cannot Open File Accessing Visual FoxPro Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164145</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you perform an Internet Database Connector (IDC) query from an IIS 
2.0 server to a Microsoft Visual FoxPro database on a different server, 
you may get the following error message on the client browser:
<P>
<PRE>   Error Performing Query

   [State=S1000][Error=171][Microsoft][ODBC Visual FoxPro Driver]Cannot 
   open file {filename}.DBF

</PRE>If the FoxPro database is on the same computer as the IIS server, the 
query returns data properly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, perform the following steps:

<OL><P><LI>In Control Panel, click the ODBC icon.

<P><LI>Select the System DSN option; then select the Visual FoxPro DSN 
   used by the IDC file. Click the Setup or the Configure button.

<P><LI>Select the Options button, and clear the Fetch Data in Background
   check box.

<P><LI>Select OK. Then select Close to apply these changes.
<P>
</OL>The query should work correctly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In looking at a trace from the problem, a different User ID is used to 
Open the .DBC file and other files. However, when the .DBF file is 
accessed a blank or different user name is sent from the IIS server to 
the Microsoft Windows NT Server where the database is located. However, 
if Fetch Data in Background is not selected, the same User ID is used 
to access all files in the database.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: uncheck<BR>
Keywords          : iisodbc kberrmsg kbprb<BR>
Version           : 2.00<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
