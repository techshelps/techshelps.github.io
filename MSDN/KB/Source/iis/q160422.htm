

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How IIS Launches a CGI Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160422">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/12/04">
<META NAME="Keywords" CONTENT="iisapi kbusage">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you access an HTML page, and the anonymous account does not have access to the file, the Internet Information Server (IIS) internally reports an error message then sends the authentication method selected by the Web Administrator (Basic or Win...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXP,QAB4,QBWP,QBWS,QAI5,QBWA,QBG2,QAH6,QAGU,QBVV,QA5F,QAMA,QAJH,QBW7,QAK7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How IIS Launches a CGI Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160422</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server versions 1.0 and 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you access an HTML page, and the anonymous account does not have
access to the file, the Internet Information Server (IIS) internally
reports an error message then sends the authentication method selected by
the Web Administrator (Basic or Windows NT Challenge).
<P>
However, CGI/ISAPI works differently. If Allow Anonymous user
authentication is enabled, and you go to a URL that is protected by a
Windows NT (NTFS) partition, the server will first try to run the
application using the Anonymous account. If the account is allowed to run
the application via NTFS, then the application will run, and the server
will send the output to you.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem occurs when the Anonymous account does not have rights to the
CGI. When you try to launch the CGI application, IIS uses the Anonymous
user. Because the account does not have rights to the file, the process
fails to run and an error message is returned via STDOUT.
<P>
However, to IIS the process appears to launch and terminate normally.
Because the Access Denied error message is placed in STDOUT, IIS has no way
of knowing that the process failed. Therefore, it does not try any other
authentication methods because the Anonymous account was able to launch the
process. IIS uses the createprocessasuser API call to launch the CGI
application. Createprocessasuser will terminate normally if the user does
not have NTFS rights to that CGI/ISAPI application.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use one of the following methods:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<UL><LI>Modify the registry to run all applications as the system.
<P>
   Under the W3SVC/Parameters, place the value CreateProcessAsUser
   as a REG_DWORD and give it a value of 0. This causes the CGI to
   be ran with the CreateProcess API and run in the system context.
   This has serious security implications because CGI scripts will
   have much greater access to the system than they normally would.
<P>
   NOTE: All users would be able to launch CGI no matter what user
   they are authenticated as.

<LI>You can also run the CGI/ISAPI from a secured web page. If you
   run it from a secured web page, you will have to either be
   authenticated by Basic or NT Challenge. When you click the URL
   for the CGI/ISAPI, it will pass the REMOTE_USER environment
   variable, and the CreateProcessAsUser API will use that user to
   run the CGI. Anonymous will not be used in that instance because
   a user account has already being passed to the server.

<LI>Turn off Anonymous access to the server, and use only Basic or NT
   Challenge.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: iis<BR>
Keywords          : iisapi kbusage<BR>
Version           : WINNT: 1.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
