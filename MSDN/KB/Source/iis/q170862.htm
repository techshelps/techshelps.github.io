

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Virtual Servers and HOST Name Resolution </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170862">
<META NAME="KBModify" CONTENT="1997/11/13">
<META NAME="KBCreate" CONTENT="1997/07/01">
<META NAME="Keywords" CONTENT="iisvirtual kbbug3.00 buglist3.0">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  Internet Information Server (IIS) configured with multiple virtual  servers can cause problems with applications that are running on a  computer that performs a lookup of its own HOST name.   On a computer running Microsoft Windows NT Server with m...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAVZ,QAUJ,QAJQ,QAC2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Virtual Servers and HOST Name Resolution</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170862</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to: 

<UL><LI>Microsoft Internet Information Server version 3.0
</UL> 
<P>
SYMPTOMS
 
<P>
Internet Information Server (IIS) configured with multiple virtual 
servers can cause problems with applications that are running on a 
computer that performs a lookup of its own HOST name. 
<P>
On a computer running Microsoft Windows NT Server with multiple IP 
addresses assigned to the same network interface card, resolving the 
computer's HOST or NetBIOS name will return the last IP 
address listed in the Network Control Panel Advanced TCP/IP 
Properties, rather than the first address listed. All other 
computers on the network that resolve this name will correctly 
get the first IP address listed.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you are using DNS for name resolution, you can add an additional 
record for the same computer with a different name. For example, 
if your computer name is listed in DNS as WEBSERVER, you may also 
want to add an entry in DNS for WWW that refers to the same IP 
address. 
<P>
In this case, when you type "PING WWW," the name is not resolved 
locally, but rather at the DNS server, and the correct IP address 
will be indicated in the reply.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows NT
version 4.0. This problem was corrected in the latest Microsoft 
Windows NT 4.0 U.S. Service Pack. For information on obtaining the 
service pack, query on the following word in the Microsoft Knowledge 
Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following is an example of this configuration:
<P>
<PRE>   HOST name = MACHINE1
   Assigned IP Addresses #1= 192.168.1.1
   Assigned IP Addresses #2= 192.168.1.2
   Assigned IP Addresses #3= 192.168.1.3

</PRE>If you are at MACHINE1, and you type "PING MACHINE1," your reply 
will indicate the 192.168.1.3 address.
<P>
If you are at another computer on the network, and you type 
"PING MACHINE1," your reply will indicate the 192.168.1.1 address.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: iis <BR>
Keywords          : iisvirtual kbbug3.00 buglist3.0<BR>
Version           : WinNT:3.0<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
