

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDC: Error Performing Query, Not Defined as a Valid User </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149425">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1996/04/02">
<META NAME="Keywords" CONTENT="iishowto kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  When you access an IDC script, you may receive the following error message:     Error Performing Query    *[State=3700][Error=18450][Microsoft][ODBC SQL Driver][SQL Server]    Login failed- User: _ Reason: Not defined as a valid user of a    truste...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB4,QAH6,QAGU,QBVV,QAH7,QAD7,QAJQ,QDNQ,QAVZ,QAAP,QAA1,QAI5,QBFM,QAK7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>IDC: Error Performing Query, Not Defined as a Valid User</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149425</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you access an IDC script, you may receive the following error message:
<P>
<PRE>   Error Performing Query
   *[State=3700][Error=18450][Microsoft][ODBC SQL Driver][SQL Server]
   Login failed- User: _ Reason: Not defined as a valid user of a
   trusted SQL Server Connection.

</PRE><h2>CAUSE</h2>
 
<P>
The error message above may occur in the following conditions:

<UL><LI>Your SQL Server is not the same computer as your Internet Information
   Server (IIS).

<LI>You are using Microsoft Windows NT Challenge/Response authentication
   on IIS.

<LI>You are using Integrated or Mixed Security on the Microsoft SQL Server.

<LI>You are not are not providing the Username: or Password: values in your
   IDC Script.
<P>
</UL><h2>WORKAROUNDS</h2>
 
<P>
There are two possible workarounds:

<UL><LI>Install SQL Server on the same computer as the Internet Information
   Server and set up your ODBC System DSN to be Local Server instead or
   a remote computer name.
<P>
</UL>-or-

<UL><LI>Use Basic Authentication instead of Windows NT Challenge/Response
   (for example, the user will be prompted to login using a dialog box)
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
When the client executes the IDC script, IIS must determine whether the
datasource is local or remote. If the datasource defined as Local System,
the query is passed to the SQL Server on the same computer. If the
datasource is remote, IIS must make a network connection to SQL Server.
When it does, it does not pass the credentials of user logged on to the
client computer; instead, it passes a blank username and password.
<P>
The SQL Server tries to validate a user without a username; it fails, and
it returns the following message to IIS:
<P>
<PRE>   Login failed- User: _ Reason: Not defined as a
    valid user of a trusted SQL Server Connection

</PRE>The Internet Information Server then passes the results of the query to the
client web browser.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodiis winnt<BR>
Keywords            : iishowto kbnetwork<BR>
Version             : 1.0 3.51<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
