

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cache ISAPI Application Option Causes ASP to Return Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182059">
<META NAME="KBModify" CONTENT="1998/03/06">
<META NAME="KBCreate" CONTENT="1998/03/04">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; iis">
<META NAME="Description" CONTENT="  It is possible to configure the way that Microsoft Internet Information Server (IIS) 4.0 caches Internet Server Application Programming Interface (ISAPI) applications. Changing the default selection from caching ISAPI application to not caching ISA...">
<META NAME="Product" CONTENT="Internet Information Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAJH,QAUD,QAY2,QAPN,QBVX,QBF0,QAO4,QAVZ,QDIZ,QAAP,QAB4,QBCF,QAKJ,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cache ISAPI Application Option Causes ASP to Return Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182059</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
It is possible to configure the way that Microsoft Internet Information
Server (IIS) 4.0 caches Internet Server Application Programming Interface
(ISAPI) applications. Changing the default selection from caching ISAPI
application to not caching ISAPI application causes IIS 4.0 to return the
following error to the browser when an Active Server Page (ASP) is executed
on the server:
<P>
<PRE>   The requested resource is in use

</PRE><h2>CAUSE</h2>
 
<P>
This setting can be changed from the Web Site properties by selecting
Configuration on the Home Directory tab. In Application Mappings there is a
checkbox for the Cache ISAPI Applications option. Changing this selection
modifies the default behavior of IIS 4.0. This option is for non-production
testing only.
<P>
If the Cache ISAPI Applications option is deselected, IIS 4.0 does not
cache ISAPI applications. All ISAPI applications are loaded and unloaded
from IIS 4.0 memory immediately after the ISAPI application is executed on
the server, including ASP. ASP sets up application and session state object
and variable that must be gracefully unloaded from memory. ASP returns the
error when it is being unloaded from memory and an ASP page is attempting
to execute. When ASP is loaded and unloaded from memory, an event is logged
in the Windows NT Application event log. Event ID of Event 3 "Service
started" and Event 4 "Service stopped" will be logged every time ASP is
loaded or unloaded from memory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior is by design. Microsoft welcomes suggestions or comments
about changes in functionality and product design. You are invited to
submit suggestions by filling out the form at the following Microsoft Web
site:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/regwiz/regwiz.asp">http://www.microsoft.com/regwiz/regwiz.asp</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: iis<BR>
Version           : WINDOWS:4.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
