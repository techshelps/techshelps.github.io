

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: DefType Statements Change If Workbook Used on New Platform </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134412">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/08/07">
<META NAME="Keywords" CONTENT="kbenv kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed above, when you transfer a  Microsoft Excel workbook from the Windows platform to the Macintosh  platform, or vice versa, any DefType statements that are contained within a  Visual Basic module in the workb...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAPN,QDL9,QBWQ,QBWO,QBWN,QAH4,QAB9,QDO9,QA4B,QAMB,QBS0,QAJG,QAY2,QASP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: DefType Statements Change If Workbook Used on New Platform</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134412</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed above, when you transfer a 
Microsoft Excel workbook from the Windows platform to the Macintosh 
platform, or vice versa, any DefType statements that are contained within a 
Visual Basic module in the workbook may be changed arbitrarily or may 
disappear completely.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid this problem, use apostrophes to comment out any DefType
statements in your code before you transfer the workbook to a different
platform (Windows or Macintosh). Once the file has been transferred, you
can remove the apostrophes from the DefType statements, and your code
should behave as expected.
<P>
For more information about comments in Visual Basic Code,
click the Index tab in Microsoft Excel Help, type the following text
<P>
<PRE>   Comments, Visual

</PRE>double-click the selected text, and then click Colors And Capitalization.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products 
listed at the beginning of this article. This problem was corrected in 
Microsoft Excel 97 for Windows and Microsoft Excel 98 Macintosh Edition. 
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel includes the following DefType statements:
<P>
<PRE>   DefBool   DefInt    DefLng   DefCur   DefSng
   DefDbl    DefDate   DefStr   DefObj   DefVar

</PRE>DefType statements are used to declare that all variables whose names begin
with a certain letter (or letters) are of a certain type. For example, this
statement
<P>
<PRE>   DefBool A

</PRE>declares that all variables whose names begin with the letter "A" or "a"
are Boolean variables, unless they are explicitly declared otherwise.
<P>
If you transfer a workbook that contains such statements from the Windows
platform to the Macintosh platform, or vice versa, DefType statements
contained in the workbook may change arbitrarily or may disappear
completely. For example, if you create a workbook in Microsoft Excel for
Windows that contains the DefType statements shown in the left column of
the following table, and you then transfer that file to Microsoft Excel for
the Macintosh, the DefType statements will probably resemble those
statements shown in the right column of the table:
<P>
<PRE>   Original platform         New platform
   --------------------------------------

   DefBool A                 DefBool Q
   DefInt B                  DefInt R
   DefLng C                  DefLng S
   DefCur D                  DefCur T
   DefSng E                  DefSng U
   DefDbl F                  DefDbl V
   DefDate G                 DefDate W
   DefStr H                  DefStr X
   DefObj I                  DefObj Y
   DefVar J                  DebVar Z

   DefBool K
   DefInt L
   DefLng M
   DefCur N
   DefSng O
   DefDbl P

   DefDate Q                 DefDate A
   DefStr R                  DefStr B
   DefObj S                  DefObj C
   DefVar T                  DefVar D
   DefBool U                 DefBool E
   DefInt V                  DefInt F
   DefLng W                  DefLng G
   DefCur X                  DefCur H
   DefSng Y                  DefSng I
   DefDbl Z                  DefDbl J

</PRE>Some DefType statements are changed to refer to a different letter, while
others disappear completely. This may prevent code in your workbook from
being executed correctly.
<P>
The results are the same whether you transfer a workbook from the Windows
platform to the Macintosh platform or from the Macintosh platform to the
Windows platform.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 5.00 5.00a 5.00c 7.00 XL7 XL5 integer long<BR>
currency single double date string object variant arbitrary arbitrarily <BR>
copy<BR>
Keywords          : kbenv kbprg PgmOthr<BR>
Version           : WINDOWS:5.0,5.0c,7.0; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
