

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"Cannot Find VBAEN.OLB" Creating New Macro or Module Sheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124596">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1995/01/05">
<META NAME="Keywords" CONTENT="kbcode kbnetwork kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you insert a new module sheet or record a new macro using the Visual Basic language, (which also inserts a Module sheet) you may receive one of the following error messages:     VBA English/Standard (VBAEN.OLB) object libra...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDL9,QBWQ,QBWO,QBWN,QBVP,QDI2,QBXB,QATJ,QABI,QAFI,QAR4,QAAP,QAH4,QBS0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>"Cannot Find VBAEN.OLB" Creating New Macro or Module Sheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124596</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Programming System, Applications Edition,
   version 1.0
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Office for Windows, versions 4.2, 4.3
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you insert a new module sheet or record a new
macro using the Visual Basic language, (which also inserts a Module sheet)
you may receive one of the following error messages:
<P>
<PRE>   VBA English/Standard (VBAEN.OLB) object library not found

   -or-

   Object library not registered

</PRE>In Microsoft Project, you may experience the following problems if you are
using a network installation of Microsoft Project:

<UL><LI>When you attempt to view macros in the Macros dialog box, the list is
   empty
<P>
   -and-

<LI>When you attempt to create a macro, you receive the error message
   "Cannot Find VBAEN.OLB"
<P>
</UL><h2>CAUSE</h2>
 
<P>
By default, when the files VBAEN.OLB and STDOLE.TLB reside on a networked
drive, path information to these files is stored in the registration
database (REG.DAT) using Universal Naming Convention (UNC) names.
<P>
Some network configurations have difficulties providing correct UNC pathing
to the VBAEN.OLB and STDOLE.TLB files. When this occurs, the above symptoms
result.
<P>
This behavior also occurs if incorrect information is contained in the keys
in the REG.DAT file that Microsoft Excel and Microsoft Project use to
locate the file VBAEN.OLB. It is not known why this occurs. This usually
occurs in a networked environment. Some of the causes for the file
VBAEN.OLB not to be registered correctly when you start Microsoft Excel or
Microsoft Project include the following:

<UL><LI>Incorrect environment strings for the PATH statement in your
   AUTOEXEC.BAT file
<P>
   -or-

<LI>Incorrect environment strings for the WINDIR variable
<P>
   -or-

<LI>A network login script may be overwriting the PATH to the VBAEN.OLB
   file.
<P>
   -or-

<LI>A network administrative installation (setup /a) was performed while
   running a different copy of shared Windows than the workstation, or
   without full and exclusive rights.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To work around this problem, manually edit the registration database file,
REG.DAT, to add the correct reference using the following steps:

<OL><P><LI>From Program Manager, choose Run from the file menu. In the Command
   line box, type "REGEDIT /V" (without the quotation marks), and then
   choose OK.

<P><LI>From the Registration Info Editor Search menu, choose Find Key. In the
   Find What box, type "typelib" (without the quotation marks), and choose
   the Find Next button.
<P>
   This search process should take you to a location labeled
<P>
<P><PRE>      TypeLib = OLE (Part 4 of 5)
</PRE>
<P><LI>Locate the "1.0 = Visual Basic for Applications" line. Below this line
   there should be a line resembling the following:
<P>
<P><PRE>      win16 = \\Server\Share\Directory(s)\VBAEN.OLB
</PRE><P>
   NOTE: You may see a double backslash in the middle of the entry, for
   example Server\Share\\Directory\VBAEN.OLB. This is an indication that
   the system is not properly using the UNC name.

<P><LI>Modify the entry to resemble the following
<P>
<P><PRE>     win16 = &lt;drive&gt;\&lt;directory&gt;\VBAEN.OLB
</PRE><P>
   where &lt;drive&gt; is the drive on which your Windows directory is located,
   and &lt;directory&gt; is your Windows directory. For example, if your Windows
   directory is on drive Y, you would type the following:
<P>
<P><PRE>     win16 = Y:\Windows\VBAEN.OLB
</PRE>
<P><LI>Find the line that reads "1.0 = OLE Automation." Beneath this entry
   is a line that should resemble the following:
<P>
<P><PRE>     win16 = \\Server\Share\Directory(s)\STDOLE.TLB
</PRE>
<P><LI>Modify this entry to resemble the following:
<P>
<P><PRE>     win16 = &lt;drive&gt;\&lt;directory&gt;\STDOLE.TLB
</PRE><P>
   where &lt;drive&gt; is the drive on which you Windows directory is located
   and &lt;directory&gt; is your Windows directory. For example, if your Windows
   directory is on drive Y, you would type the following:
<P>
<P><PRE>     win16 = Y:\Windows\STDOLE.TLB
</PRE>
<P><LI>From the File menu, choose Save Changes.
<P>
</OL>If the above workaround does not correct this problem, use the following
troubleshooting steps to correct any miscellaneous pathing problems:

<OL><P><LI>Make sure the WINDIR environment variable is set correctly. For more
   information about how to check and correct the WINDIR environment
   variable value, please see the following article(s) in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../SETUP/Q100836.htm">Q100836</A></B>
<PRE>   TITLE     : Setup Error Message: "While Registering OLE Servers..."

</PRE><P><LI>Make sure that the PATH statement in your AUTOEXEC.BAT file contains
   the correct path information for Windows (such as "C:\WINDOWS"). See
   your MS-DOS documentation for more information.

<P><LI>When you perform an administrative installation (SETUP /A) of Microsoft
   Project or Microsoft Excel with a shared copy of Windows, make sure
   that you have full rights to the shared Windows directory and that no
   one else is using the network server.

<P><LI>If the file VBAEN.OLB exists from a previous installation, rename this
   file before performing another installation.

<P><LI>Make sure there are no batch files or network login scripts that will
   overwrite the correct Windows path in the PATH environment
   variable.

<P><LI>Copy the file TYPELIB.DLL to the \WINDOWS\SYSTEM directory.

<P><LI>After you finish the steps above, run Setup again.
<P>
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The information that is used to create the entry for VBAEN.OLB in the
REG.DAT file is located in the setup table file, SETUP.STF file. This entry
is written during Setup. Setup does not re-create the entry if the
VBAEN.OLB file exists in the \WINDOWS\SYSTEM directory from a previous
installation. Reinstalling Microsoft Project or Microsoft Excel will not
resolve this problem unless you rename the VBAEN.OLB file and resolve any
incorrect pathing issues prior to running Setup.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 5.00 5.00c netware<BR>
Keywords            : kbcode kbnetwork kbprg<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
