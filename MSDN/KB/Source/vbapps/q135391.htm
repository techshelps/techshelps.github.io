

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UNCONF: Out of Stack Space Error Calling QueryGetData </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135391">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1995/08/21">
<META NAME="Keywords" CONTENT="kbprg PgmOthr kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT=" ********************************************************************* **                           - WARNING -                           ** **     THE INFORMATION BELOW IS PRELIMINARY AND HAS NOT BEEN       ** **     CONFIRMED, EDITED, OR TESTED BY ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QAB9,QAH4,QBS0,QBJZ,QA5V,QAGI,QAFF,QBWS,QBOR,QA5D,QAY2,QAYY,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>UNCONF: Out of Stack Space Error Calling QueryGetData</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135391</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0c
</UL> 
<P>
*********************************************************************
<PRE>**                           - WARNING -                           **
**     THE INFORMATION BELOW IS PRELIMINARY AND HAS NOT BEEN       **
**     CONFIRMED, EDITED, OR TESTED BY MICROSOFT. USE ONLY         **
**     WITH DISCRETION.                                            **
</PRE>*********************************************************************
<P>
SYMPTOMS
 
<P>
Microsoft Excel for Windows version 5.0c, may produce the following error
message when calling a procedure that uses the xlquery.xla QueryGetData
function:
<P>
<PRE>   Run-time error '28':
   "Out of Stack Space"

</PRE><h2>CAUSE</h2>
 
<P>
Using the macro recorder, when you record clicking Get External Data on the
Data menu in Microsoft Excel for Windows version 5.0c, selecting a data
source in Microsoft Query, adding a table, performing a query and returning
your data to Microsoft Excel, the recorded code you end up with is a series
of application.run "QueryGetData" commands. This command is found in the
xlquery.xla add-in file which ships with Microsoft Excel.
<P>
If you create a Sub procedure which calls this recorded macro using the
application.run method and assign this sub procedure to a custom toolbar
button or a button on your worksheet, you will receive the above error
message when you click the button. You will also receive the error message
if you attempt to run your Sub procedure by placing the pointer cursor on
any line of the Sub procedure and clicking the built-in macro run toolbar
button found on the Visual Basic toolbar.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid the above error message do one of the following:

<OL><P><LI>Run your macro by clicking Macro on the Tools menu and selecting your
<PRE>   Sub procedure from the listing of available macros and pressing Run.

   -or-

</PRE><P><LI>Place the pointer on any line of your calling procedure and press the
   F5 key.
<P>
   -or-

<P><LI>Assign the Sub procedure to a custom menu option and run it from there.
<P>
</OL>Rather than using the QueryGetData command, use the SQLOpen, SQLExecQuery,
SQLRetrieve, and SQLClose methods for retrieving data from your external
data source.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior does not occur in Microsoft Excel version 5.0 for Windows or
Microsoft Excel version 5.0 for Macintosh.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about these commands, refer to Help in Microsoft
Excel. Choose Contents from the Help menu, choose Programming With Visual
Basic from the Contents screen and then choose search and type in SQL. This
will take you to a listing of all of the SQL commands available in
Microsoft Excels Visual Basic for Applications programming language.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.00 MSQuery VB<BR>
Keywords          : kbprg PgmOthr kberrmsg kbprg<BR>
Version           : 5.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
