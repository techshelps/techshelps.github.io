

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Code "Behind" Worksheet or Workbook may not Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157346">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1996/10/10">
<META NAME="Keywords" CONTENT="kbprg kbdta xlvbahowto xlvbainfo xlui kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, code that is contained  behind  a worksheet or workbook may not work correctly.  CAUSE =====  This will occur if both of the following conditions are true:   - The code in question is contained inside an automatically-running...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBS0,QBVP,QDNM,QBVV,QA5F,QAMA,QAFF,QABG,QA9N,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Code "Behind" Worksheet or Workbook may not Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157346</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, code that is contained "behind" a worksheet or
workbook may not work correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
This will occur if both of the following conditions are true:

<UL><LI>The code in question is contained inside an automatically-running
   subroutine, such as an Auto_Open or Auto_Close subroutine.
<P>
<P><PRE>    -and-
</PRE>
<LI>The code is not contained in a Visual Basic module, but "behind" a
   worksheet or the workbook (ThisWorkbook) itself.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
In order for automatically-running subroutines to work correctly in
Microsoft Excel 97, they must be contained within a Visual Basic module. To
insert a new module:

<OL><P><LI>In the Project Explorer in the Visual Basic Editor, activate the
   workbook that contains the code in question.

<P><LI>On the Insert menu, click Module.
<P>
</OL>Once the new module is inserted, cut the code from its original location
and paste it into the Visual Basic module. Then, save the workbook.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, Visual Basic for Applications code can be stored in
three different locations: in a Visual Basic module, in a Visual Basic
class module, and "behind" worksheets and workbooks.
<P>
To edit code "behind" a worksheet or a workbook:

<OL><P><LI>Activate the Visual Basic Editor by pressing ALT + F11 on your
   keyboard.

<P><LI>In the Project Explorer window, you will see entries similar to the
   following:
<P>
<P><PRE>      VBAProject (Book1)
<PRE></PRE>         Microsoft Excel Objects
            Sheet1 (Sheet1)
            Sheet2 (Sheet2)
            Sheet3 (Sheet3)
            ThisWorkbook
         Modules
            Module1

   If you double-click one of the worksheet names or ThisWorkbook, you
   can enter code in the code window. Such code not contained within a
   Visual Basic module is considered to be "behind" the worksheet or
   ThisWorkbook.

</PRE></OL>If an Auto_Open, Auto_Close, or other automatically-running subroutine is
stored "behind" a worksheet or ThisWorkbook, it may not function correctly
when you open or close your workbook, or when you perform an action that
should cause the subroutine to run.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 vbe auto open close<BR>
Keywords          : kbprg kbdta xlvbahowto xlvbainfo xlui kbfaq<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
