

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: How to Customize a Custom Toolbar Button </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161496">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/12/26">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto xlui">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article explains how to create a custom button on a toolbar and how to assign a macro to that custom button.  MORE INFORMATION  Microsoft provides programming examples for illustration only, without  warranty either expressed or implied, inclu...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBOG,QBS0,QANS,QBVP,QA5D,QBWS,QBJZ,QAF0,QAH4,QAJD,QA01,QARW,QAYZ,QBVR,QAVZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: How to Customize a Custom Toolbar Button</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161496</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to create a custom button on a toolbar and
how to assign a macro to that custom button.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>In order to make your custom toolbar button useful, you must first write
a Visual Basic for Applications procedure to attach to the button. Follow
these steps to create a simple Visual Basic procedure:

<OL><P><LI>Close and save any open workbooks, and then open a new workbook.

<P><LI>Start the Visual Basic Editor (press ALT+F11).

<P><LI>On the Insert menu, click Module.

<P><LI>In the module type the following code:
<P>
<PRE>      Sub HelloWorld()
         MsgBox "Hello, World!"
      End Sub

</PRE><P><LI>Click "Close and Return to Microsoft Excel" on the File menu.
<P>
</OL>Now that you have created a simple Visual Basic procedure, follow these
steps to create a custom toolbar button:

<OL><P><LI>Click Customize on the Tools menu.

<P><LI>Activate the Commands tab in the Customize dialog box.

<P><LI>Select Macros in the Categories list box.

<P><LI>In the Commands list box, drag the Custom Button item and drop it on
   any toolbar where you want the custom toolbar button to appear.
<P>
</OL>The button now appears on the toolbar. To assign the HelloWorld macro to
the button, follow these steps:

<OL><P><LI>Click Modify Selection in the Customize dialog box. A menu appears
   with different options for your custom toolbar button.

<P><LI>Click Assign Macro, click HelloWorld on the Macro Name list,
   and then click OK.
<P>
</OL>You may also want to change the ScreenTip that appears when you place the
insertion point over the button. To change the ScreenTip, follow these 
steps:

<OL><P><LI>Click Modify Selection in the Customize dialog box. 
<P>
   A menu appears with different options for your custom toolbar button.

<P><LI>In the Name box, type "Hello, World!" (without the quotation
   marks).
<P>
</OL>To modify the image displayed for your custom button, follow these steps:

<OL><P><LI>Click Modify Selection in the Customize dialog box. A menu appears
   with different options for your custom toolbar button.

<P><LI>On the menu, point to Change Button Image, and then click the image
   to display on the button.
<P>
</OL>Now click Close in the Customize dialog box. When you click the button
you just added to the toolbar, you will see a message box with the text
"Hello, World!" (without quotation marks).
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating custom toolbar buttons, click the
Index tab in Microsoft Excel Help, type the following text
<P>
<PRE>   buttons, toolbars

</PRE></OL>and then double-click the selected text to go to the "Add a button to a
toolbar" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97 vba<BR>
Keywords          : kbcode kbprg xlvbahowto xlui<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
