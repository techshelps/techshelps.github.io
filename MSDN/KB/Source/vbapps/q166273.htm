

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: "Can't Find Project or Library" When You Run a Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166273">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1997/04/02">
<META NAME="Keywords" CONTENT="kberrmsg xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 5.0 or 7.0, when you attempt to run a Visual Basic for Applications macro to insert a Visual Basic module into a workbook or to record a new macro, you may receive the following error message:     Can't find project or library  W...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAH4,QDKX,QAB3,QA5V,QAEF,QBWS,QDH6,QAB4,QBHQ,QA9N,QAUR,QAPN,QACI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "Can't Find Project or Library" When You Run a Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166273</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 5.0 or 7.0, when you attempt to run a Visual Basic for
Applications macro to insert a Visual Basic module into a workbook or to
record a new macro, you may receive the following error message:
<P>
<PRE>   Can't find project or library

</PRE>When you click OK, the References dialog box appears. One or both of the
following items are listed in the Available References list box:
<P>
<PRE>   MISSING: Microsoft Office 8.0 Object Library

   MISSING: OLE Automation

</PRE>NOTE: When you record a new Visual Basic macro, you may also receive the
following error message:
<P>
<PRE>   Unable to record.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when all of the following conditions are true:

<UL><LI>The workbook contains a reference either to the Microsoft Office 8.0
   Object Library or to the OLE Automation library.
<P>
   NOTE: If you create the workbook in Microsoft Excel 97 or if you use the
   References dialog box in Microsoft Excel 97 to create the reference, the
   workbook may contain such a reference.
<P>
<P><PRE>    -and-
</PRE>
<LI>In Microsoft Excel 97, you saved the workbook in the Microsoft Excel
   5.0/95 Workbook format.
<P>
<P><PRE>    -and-
</PRE>
<LI>You opened the workbook in Microsoft Excel 5.0 or 7.0 and attempted to
   run a macro, to insert a Visual Basic module into the workbook, or to
   record a new macro.
<P>
<P><PRE>    -and-
</PRE>
<LI>No Microsoft Office 97 program is installed on the computer on which you
   are running Microsoft Excel 5.0 or 7.0.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use either of the following methods.
<P>
<P><h3>Method 1: Disable Missing References in the References Dialog Box</h3>
 
<P>
If the References dialog box appears when you attempt to run a macro, to
insert a macro, or to record a new macro, use the following steps:

<OL><P><LI>In the list of Available References, clear any check boxes to the left
   of references that are labeled "MISSING."

<P><LI>After you clear all the missing references, click OK.

<P><LI>Run the macro, insert or record a new macro.
<P>
</OL>The References dialog box does not appear.
<P>
NOTE: Save the workbook before you close it. Otherwise, the change to the
References dialog box may not be saved. For more information, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../URJump.htm">Q114627</A></B>
   TITLE     : XL: No Prompt to Save Changes After Tools Reference Change

</PRE></OL><h3>Method 2: Remove References in Microsoft Excel 97</h3>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>You can prevent the References dialog box from appearing in Microsoft Excel
5.0 or 7.0 by removing references that are potentially missing from the
workbook while it is open in Microsoft Excel 97. The following sample macro
removes references:
<P>
<PRE>   Sub RemoveLibraryReferences()

       On Error Resume Next
       Dim xObject As Object

       Set xObject = ThisWorkbook.VBProject.References.Item("Office")
       ThisWorkbook.VBProject.References.Remove xObject

       Set xObject = ThisWorkbook.VBProject.References.Item("stdole")
       ThisWorkbook.VBProject.References.Remove xObject

   End Sub

</PRE>When you run the macro, it programmatically removes the reference to the
Microsoft Office 8.0 Object Library and OLE Automation from the workbook.
You can then save the workbook in the Microsoft Excel 5.0/95 Workbook
format. When you open the workbook in Microsoft Excel 5.0 or 7.0, and then
run a macro, insert a module, or record a new macro, the error message does
not appear.
<P>
NOTE: You cannot run this macro in Microsoft Excel 5.0 or 7.0. The macro
works ONLY in Microsoft Excel 97.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use a workbook that is saved in the Microsoft Excel 5.0/95
Workbook format in Microsoft Excel 5.0 and 7.0, this problem may occur when
the Microsoft Office 8.0 Object Library (Mso97.dll) or OLE Automation
(Stdole2.tlb) is unavailable. If you install any of the Microsoft Office 97
programs on your computer, the Mso97.dll and Stdole2.tlb files should be
available.
<P>
Note that this problem occurs only if the workbook contains a reference to
the Microsoft Office 8.0 Object Library or to OLE Automation. In Microsoft
Excel 97, you can view references by clicking References on the Tools menu
in the Visual Basic Editor. In Microsoft Excel 5.0 or 7.0, you can view
references by clicking References on the Tools menu when a Visual Basic
module is the active sheet.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information about getting help with Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 XL7 XL5 8.0<BR>
Keywords          : kberrmsg xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
