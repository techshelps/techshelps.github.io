

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRJ: How to Use the GanttBarFormat Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126943">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1995/03/07">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article discusses two ways you can use the GanttBarFormat method in a macro that loops through a set of tasks and formats them based on a particular set of criteria.  MORE INFORMATION  The GanttBarFormat method is used to change the format of ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBS0,QAPN,QAPF,QAG0,QAL4,QAUJ,QBVV,QAVX,QAVW,QAQ8,QAA7,QAFF,QA50,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRJ: How to Use the GanttBarFormat Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project 98 for Windows
<LI>Microsoft Project for Windows 95, versions 4.1, 4.1a
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Project for Macintosh, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses two ways you can use the GanttBarFormat method in a
macro that loops through a set of tasks and formats them based on a
particular set of criteria.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The GanttBarFormat method is used to change the format of the Gantt Bars
from the default styles that have been applied using the Bar Styles command
on the Format menu. By default, the GanttBarFormat method applies to all
selected tasks.
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
Below are two examples of macros that loop through tasks in the active
project and format those tasks that have a task name of "a" with a left
diagonal bar pattern and those that don't with a crossed line bar pattern.
<P>
To test these macros, create a project with three or four tasks with two of
the tasks having a task name of "a" (without the quotation mark s).
<P>
NOTE: The Gantt Chart View must be active when you run these macros or you
will receive a run-time error.
<P>
<P><h3>Sample Macro 1</h3>
 
<P>
Including the TaskID named argument with the GanttBarFormat method allows
the macro to cycle through the tasks in the active project without having
to manually select them using a "SelectCellDown" or other equivalent
command. The following macro demonstrates this procedure:
<P>
<PRE>   Sub Macro1()

      Dim t As Task

      For Each t In ActiveProject.Tasks

         'skip over blank rows
         If Not t is Nothing then
            If (t.Name = "a") Then
               GanttBarFormat TaskID:=t.ID, MiddlePattern:=5
            Else
               GanttBarFormat TaskID:=t.ID, MiddlePattern:=10
            End If
         End If
      Next t
   End Sub

</PRE><h3>Sample Macro 2</h3>
 
<P>
The following example selects each task in the active project (using the
SelectCellDown method), tests the name field, and then applies the Gantt
bar formatting. The macro stops when a blank task is encountered. This
macro is slower than Sample Macro 1 because of the additional work
associated with the selection process. It is also more error prone because
it depends on a certain table layout and assumes that the "ActiveCell" is
the name field.
<P>
NOTE: This macro assumes that there are no blank rows between real tasks.
<P>
<PRE>   Sub Macro2()

   SelectBeginning

      Do Until (ActiveCell = "")
         If ActiveCell.Task.Name = "a" Then
            GanttBarFormat MiddlePattern:=5
         Else
            GanttBarFormat MiddlePattern:=10
         End If
           SelectCellDown
      Loop

   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For more information on the GanttBarFormat method search on the word
"Gantt" (without the quotation marks) in the Visual Basic Reference Help.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : kbcode kbprg<BR>
Version           : 4.0 4.1 4.1a 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
