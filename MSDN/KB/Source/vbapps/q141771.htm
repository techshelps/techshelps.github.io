

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: How to Display Top 10 Records With a Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141771">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1995/12/24">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can use the AutoFilter feature to filter a list based on simple criteria. For example, if you have a list of salespeople that has a column of names and a column containing each person's total sales for the month, you can use...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE1,QBVP,QAH4,QA5V,QAPF,QBS0,QANY,QAKC,QBC6,QBWS,QAFF,QABA,QAG8,QAFR,QA7O P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Display Top 10 Records With a Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141771</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
SUMMARY
 
<P>
In Microsoft Excel, you can use the AutoFilter feature to filter a list
based on simple criteria. For example, if you have a list of salespeople
that has a column of names and a column containing each person's total
sales for the month, you can use the AutoFilter to show the records for the
top ten salespeople, based on their sales amounts for the month. The
ability to display the top ten items in a list is a new feature to the
AutoFilter in Microsoft Excel versions 7.0 and 97. It is added to the drop-
down lists that appear in all columns when you turn on the AutoFilter, but
it can only be used on columns that contain numeric values.
<P>
You can customize the Top Ten feature in AutoFilter to filter a different
number of top items in your list, such as the top 3 or top 100. This
feature can be modified to display between 1 and 500 records. To manually
change the number of items that appear in your AutoFilter top ten list to a
number less than or greater than ten (for example, if you want to show the
top five items), click the arrow in the column you want to filter, click
Top 10 in the drop-down list, and then change the number of items in the
Top Ten AutoFilter dialog box to the number of items you want to be
displayed.
<P>
This article provides several examples of Visual Basic for Applications
macro code that you can use to control the AutoFilter feature in Microsoft
Excel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following sample data for each of the sample macros given below:
<P>
<PRE>   A1: Name   B1: Zone   C1: Amount
   A2: Bob    B2: a      C2: 3
   A3: Sue    B3: c      C3: 2
   A4: Mary   B4: a      C4: 6
   A5: Pete   B5: b      C5: 1
   A6: Paul   B6: b      C6: 4

</PRE>Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. This Visual Basic procedure is provided 'as is'
and Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h3>Macro to Display the Top Ten Items</h3>
 
<P>
Because the sample list above has only five records total, this sample
macro will filter the top two items in the list based on the Amount field:
<P>
<PRE>Sub Top_Ten()

   Range("A1").AutoFilter Field:=3, Criteria1:="2", Operator:=xlTop10Items

End Sub

</PRE>If you run this macro from the sheet that contains the sample list, your
list will display rows 4 and 6 only.
<P>
NOTE: You can filter more (or fewer) than 10 items using the Top Ten
feature. To change the number of items that appear when you run this macro,
set the "Criteria1" argument to the desired amount.
<P>
<P><h3>Macro to Turn Off the AutoFilter</h3>
 
<P>
The following macro will turn off the AutoFilter, and all of the records in
the list will be displayed. Note, if the AutoFilter is not on when this
macro is run, it will be enabled, but because there is no criteria
specified, all records will be visible.
<P>
<PRE>Sub Clear_Filter()

   Range("A1").AutoFilter

End Sub

</PRE><h3>Macro to Display the Bottom Ten Items</h3>
 
<P>
When you click "Top 10" from the AutoFilter list, the default setting
is the top 10 items in the column. However, in the Top 10 AutoFilter dialog
box, you can choose to display the Bottom 10 items instead.
<P>
The following macro will filter the bottom two items from the list based on
the Amount field:
<P>
<PRE>Sub Bottom_Ten()

   Range("A1").AutoFilter Field:=3, Criteria1:="2", _
      Operator:=xlBottom10Items

End Sub

</PRE>If you run this macro from the sheet that contains the list, your list will
display rows 3 and 5 only.
<P>
NOTE: You can filter more (or fewer) than 10 items using the Top Ten
feature. To change the number of items that appear when you run this macro,
set the "Criteria1" argument to the desired amount.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the AutoFilter, click Answer Wizard on the Help
menu and type:
<P>
<PRE>   tell me about the AutoFilter
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 8.00 97<BR>
Keywords          : kbcode kbprg xlvbahowto<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
