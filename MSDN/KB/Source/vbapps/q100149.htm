

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Use the Quit Macro Action </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100149">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/06/16">
<META NAME="Keywords" CONTENT="AutoGnrl IntpDde kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates two methods to close Microsoft Access from a different application. The first method uses the Quit macro action to quit Microsoft Access over a dyn...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBVP,QAH4,QDN9,QAPN,QAGB,QBWS,QBUG,QBUF,QBJZ,QAJZ,QAAP,QAFF,QAB4,QAJH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use the Quit Macro Action</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100149</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.1, 2.0, 7.0, 97
<LI>Microsoft Excel version 4.0, 5.0, 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates two methods to close Microsoft Access from a
different application. The first method uses the Quit macro action to quit
Microsoft Access over a dynamic data exchange (DDE) channel. The second
method uses Automation and the Quit method.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Dynamic Data Exchange method</h3>
 
<P>
The syntax for the Quit action is:
<P>
<PRE>   Quit

</PRE>There are no parameters for the Quit action.
<P>
The following example shows a Microsoft Excel version 4.0 macro to
demonstrate the Quit macro action. The macro is valid for Microsoft
Excel versions 4.0, 5.0, and 7.0 and Microsoft Excel 97.
<P>
NOTE: This macro will not work with Microsoft Access version 1.0.

<OL><P><LI>Open a new macro sheet in Microsoft Excel. On the Insert menu,
   click Macro, and then click MS Excel 4.0 Macro. Enter the following
   macro:
<P>
<PRE>      Cell     Command
      ------------------------------------------------
      A1       QuitDDEExample
      A2
      A3       =APP.MINIMIZE()
      A4       =ERROR(FALSE)
      A5       =APP.ACTIVATE("Microsoft Access",FALSE)
      A6       chan=INITIATE("MSACCESS","system")
      A7       =APP.ACTIVATE("Microsoft Access",FALSE)
      A8       =EXECUTE(chan,"[QUIT]")
      A9       =TERMINATE(chan)
      A10      =APP.ACTIVATE(FALSE)
      A11      =RETURN()

</PRE><P><LI>Before running this macro, size your Microsoft Access and Microsoft
   Excel windows so that you can view both applications at the same time.

<P><LI>To run the macro, select cell A3. On the Tools menu, click Macro. In the
   Macro box, click Run.
<P>
</OL><h3>Automation Method</h3>
 
<P>
This method is exclusive for Microsoft Access 7.0 and Microsoft Access 97.
Earlier versions of Microsoft Access are not OLE Servers, and therefore you
can't manipulate them using Automation.

<OL><P><LI>Open Microsoft Access.

<P><LI>Open Microsoft Excel (or another OLE server) and create a new macro. On
   the Insert menu, click Macro, and then click Module. This will insert a
   new module in the current book.

<P><LI>Type the following Sub procedure:
<P>
<PRE>      Sub OleAccess()
         Dim appAccess as Object
         Set appAccess = GetObject(, "Access.Application")
         appAccess.Quit acSave
      End Sub

</PRE><P><LI>To run this code, click Start on the Run menu, or call the Sub procedure
   from another procedure. When it runs, the GetObject() function is
   executed, setting the appAccess variable to the first available open
   instance of Microsoft Access. At the end, it closes Microsoft Access
   with appAccess.Quit.
<P>
</OL>Note that you will get a run-time error if you don't have Microsoft
Access loaded in the background while you run the procedure. This error
can be trapped using On Error.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Quit method, search the Help Index for "Quit
method," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about using macro actions in DDE, please see the
following article here in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q97776.htm">Q97776</A></B>
   TITLE:      ACC: Running a MS Access Macro from Visual Basic Using DDE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ole/dde server<BR>
Keywords          : AutoGnrl IntpDde kbinterop IntpOleA<BR>
Version           : 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
