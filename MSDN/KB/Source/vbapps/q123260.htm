

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Visual Basic Module to Create Gantt Chart </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123260">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/11/28">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmOthr kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can create Gantt Charts that show task status for project planning and control. The example in this article shows the steps necessary to generate this type of charts using a Visual Basic, Applications Edition, procedure.  MO...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVP,QAH4,QAMB,QDNX,QA5F,QAMA,QAIB,QBWS,QAQ8,QBJZ,QAG2,QBXT,QA5V,QA2Q P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Visual Basic Module to Create Gantt Chart</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123260</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00 97
WINDOWS
kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can create Gantt Charts that show task status
for project planning and control. The example in this article shows the
steps necessary to generate this type of charts using a Visual Basic,
Applications Edition, procedure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following Visual Basic macro creates a Gantt Chart.
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose. Note that a line that is preceded by
an apostrophe introduces a comment in the code--comments are provided to
explain what the code is doing at a particular point in the procedure. Note
also that an underscore character (_) indicates that code continues from
one line to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line
continuation character. For more information about Visual Basic for
Applications programming style, see the "Programming Style in This Manual"
section in the "Document Conventions" section of the "Visual Basic User's
Guide."
<P>
Enter the following in a Visual Basic module:
<P>
<PRE>Sub gantt_chart()
    Dim rge As Variant
    Dim mn As Variant
    Dim shtname As Variant
    'defines the variables
         rge = Selection.Address()
        'get the cell address
        mn = Selection.Offset(1, 1)
        'return the min value for the scale
        Title = InputBox("Please enter the title")
        'Asks the user for title
        shtname = ActiveSheet.Name
        'retains the name of current sheet
        Application.ScreenUpdating=False
        'Turns screen updating off
        Charts.Add
        'Create a paper model chart
        ActiveChart.ChartWizard Source:=Sheets(shtname).Range(rge), _
            Gallery:=xlBar, Format:=3, PlotBy:=xlColumns, CategoryLabels _
            :=1, SeriesLabels:=1, HasLegend:=1, Title:=Title, _
            CategoryTitle:="", ValueTitle:="", _
            ExtraTitle:=""
        ' Basic chart definition
        ActiveChart.Legend.Delete
        'deletes the legend
        ActiveChart.SeriesCollection(1).Select
        'activates series 1
        With Selection.Border
            .Weight = xlThin
            .LineStyle = xlNone
        End With
        'definition for the border for series 1
        Selection.InvertIfNegative = False
        'turns Invert if negative to false
        Selection.Interior.ColorIndex = xlNone
        'indicates that the area is set to none
        ActiveChart.PlotArea.Select
        'select the chart plot area
        ActiveChart.Axes(xlCategory).Select
        'select axis(1)
        With ActiveChart.Axes(xlCategory)
            .ReversePlotOrder = True
            .TickLabelSpacing = 1
            .TickMarkSpacing = 1
            .AxisBetweenCategories = True
        End With
        'axis 1 definition
        ActiveChart.Axes(xlValue).Select
        'select axis(2)
        With ActiveChart.Axes(xlValue)
            .MinimumScale = mn
            .MaximumScaleIsAuto = True
            .MinorUnitIsAuto = True
            .MajorUnitIsAuto = True
            .Crosses = xlAutomatic
            .ReversePlotOrder = False
            .ScaleType = False
            .HasMajorGridlines = True
            .HasMinorGridlines = False
        End With
        ' Axis(2) definition
 End Sub

</PRE><h3>Example of How to Use The Macro</h3>
 

<OL><P><LI>Open a new worksheet and enter the following values:
<P>
<PRE>     A1:            B1: START        C1: DAYS          D1: DAYS
     A2: TASK       B2: DATE         C2: COMPLETED     D2: REMAINING
     A3: TASK-1     B3: 1/1/91       C3: 150           D3: 15
     A4: TASK-2     B4: 5/1/91       C4: 21            D4: 31
     A5: TASK-3     B5: 7/1/91       C5: 0             D5: 114
     A6: TASK-4     B6: 10/1/91      C6: 0             D6: 4
     A7: TASK-5     B7: 10/15/91     C7: 0             D7: 31
     A8: TASK-6     B8: 11/1/91      C8: 0             D8: 2

</PRE><P><LI>Select cell A2 and format it with the month/day/year date format you
   want to use on the chart.

<P><LI>Highlight A2:D8. To run the macro, choose Macro from the Tools
   menu, and select the gantt_chart macro. In version 97, click Macro on
   the Tools menu, then click Macro and select the gantt_chart macro.

<P><LI>Enter the chart title when prompted.
<P>
</OL>The Gantt chart should now be displayed on a new chart sheet. Additional
formatting can be added as needed.
<P>
For additional information on creating a Gantt, please see the following
article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q73281.htm">Q73281</A></B>
   TITLE     : Excel: Creating Gantt Charts


</PRE></OL><h2>REFERENCES</h2>
 
<P>
"User s Guide," version 5.0, chapters 15, 17, 18
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 97 7.00 5.00 gannt
<P>

Keywords          : kbprg PgmHowTo PgmOthr kbcode kbprg<BR>
Version           : 5.00 5.00c 7.00 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
