

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRJ: "User-Defined Type Not Defined" Error in Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145852">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1996/02/08">
<META NAME="Keywords" CONTENT="kbcode kbinterop kbprg kberrmsg kbinterop kbprg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you try to declare a variable of the type  Database  that is available with the data access object (DAO) library, you may receive the following error message:     User-defined type not defined  CAUSE =====  Microsoft Project can make use of th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAB4,QAAP,QAYL,QBVV,QAZV,QAP2,QA98,QAW6,QAPN,QBJZ,QAJN,QBVP,QBHQ,QACJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRJ: "User-Defined Type Not Defined" Error in Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145852</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project 98 for Windows
<LI>Microsoft Project for Windows 95, versions 4.1, 4.1a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to declare a variable of the type "Database" that is available
with the data access object (DAO) library, you may receive the following
error message:
<P>
<PRE>   User-defined type not defined

</PRE><h2>CAUSE</h2>
 
<P>
Microsoft Project can make use of the DAO Object Library that Microsoft
Excel and Microsoft Access install. The DAO Object Library defines a
variable of the type "Database." The error is generated because there is a
hidden module in Microsoft Project called "Database." This module name
conflicts with the built-in object type defined by DAO.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This error does not occur if you declare your variable type as "Variant"
instead of "Database." For example, instead of using the following
declaration:
<P>
<PRE>    Dim oData As Database

</PRE>Use the following:
<P>
<PRE>    Dim oData as Variant

</PRE>This error also does not occur if the macro that is being created is stored
in a project file (.mpp). To copy a macro from the default storage location
of the Global.mpt to a specific project file, use the Organizer within
Microsoft Project as follows:

<OL><P><LI>Open the project file that you want the macro to reside in.

<P><LI>On the View menu, click More Views.

<P><LI>Click the Organizer button.

<P><LI>Select the Modules tab.

<P><LI>Copy the Module that the macro resides in from the Global.mpt side
   of the Organizer to the project file side of the Organizer.
<P>
</OL>The macro will no longer cause the error.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.10<BR>
Keywords          : kbcode kbinterop kbprg kberrmsg kbinterop kbprg kbusage<BR>
Version           : 4.10 4.10a 98<BR>
Platform          : WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
