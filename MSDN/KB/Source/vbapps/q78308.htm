

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Running FLATFILE.XLA from a User-Defined Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q78308 ">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1991/11/11">
<META NAME="Keywords" CONTENT="PgmHowTo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, the FLATFILE.XLA add-in file supplies a macro that allows you to import data from a text file to a worksheet, and a second macro that allows you to export data from a worksheet to a text file. Normally these features are accesse...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QA3P,QAY2,QAB9,QAUD,QBRZ,QAMR,QDNM,QAYY,QAPN,QBWS,QAH6,QBJZ,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Running FLATFILE.XLA from a User-Defined Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q78308 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0 and 4.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, the FLATFILE.XLA add-in file supplies a macro that
allows you to import data from a text file to a worksheet, and a
second macro that allows you to export data from a worksheet to a text
file. Normally these features are accessed from menu options that the
add-in supplies. To run the data export macro from within a
user-defined macro sheet, you must make a slight modification.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To execute the Data Export command from a user-defined macro, the
following formula is used:
<P>
<PRE>   =FLATFILE.XLA!MCP01.FixedFieldExport()

</PRE>To execute the Data Smart Parse command from a user-defined macro, the
following formula is used:
<P>
<PRE>   =FLATFILE.XLA!MCP05.SmartParse()

</PRE>If you attempt to export data from a spreadsheet to a file by calling
the FLATFILE.XLA data export macro from within a user-defined macro,
the user-defined macro will halt. This is because the FLATFILE.XLA
data export macro ends with a HALT statement rather than a RETURN
statement. The HALT command prevents the data export macro from
returning control to the macro that called it.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The HALT statement is contained on a cell of FLATFILE.XLA. You can
replace it with a RETURN statement. Do the following:

<OL><P><LI>Hold the SHIFT key down as you open FLATFILE.XLA. This makes the
   file available for editing. If the file is hidden, choose Unhide
   from the Window menu and select it from the list.

<P><LI>Select the cell containing the HALT statement. This will be on cell
   B47 in version 3.0, B82 in versions 4.0 and 4.0a.

<P><LI>Replace "=HALT()" with "=RETURN()" (without the quotation marks).
<P>
</OL>You should make a backup of the original FLATFILE.XLA prior to making
any changes.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, pages 216, 363
<P>
"Microsoft Excel Function Reference," version 3.0, pages 120, 200
<P>
"Microsoft Excel User's Guide 2," version 4.0, pages 151, 152, 199
<P>
"Microsoft Excel User's Guide," version 3.0, page 683-684
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.0 3.00 4.0 4.00 4.0a 4.00a<BR>
Keywords          : PgmHowTo PgmOthr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
