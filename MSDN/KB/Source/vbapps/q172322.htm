

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Run-Time Error 40009 when you Run DAO Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172322">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/08/01">
<META NAME="Keywords" CONTENT="kbprg kbsetup xlvbainfo xldao">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you run a Visual Basic for Applications macro that uses Data Access Objects (DAO), you may receive the following error message:     Run-time error '40009':    No current row.  This error message occurs when the macro attem...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVP,QAA1,QBWS,QDI2,QA9N,QAH4,QDNE,QBIC,QDNN,QASB,QAB4,QABI,QDKR,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Run-Time Error 40009 when you Run DAO Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172322</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you run a Visual Basic for Applications macro
that uses Data Access Objects (DAO), you may receive the following error
message:
<P>
<PRE>   Run-time error '40009':
   No current row.

</PRE>This error message occurs when the macro attempts to copy the contents of a
recordset into the active worksheet.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if either of the following conditions are true:

<UL><LI>The recordset includes a field of type BIGINT.
<P>
<P><PRE>    -or-
</PRE>
<LI>You have installed Microsoft Visual Basic version 5.0 on the same
   computer.
<P>
   Visual Basic 5.0 replaces the Dao350.dll file that is included
   in Microsoft Office 97 or Excel 97 with a newer copy. Because this
   newer Dao350.dll file is not fully compatible with Excel 97, Visual
   Basic macros that use DAO may not work correctly.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use the following appropriate workaround.
<P>
<P><h3>Method 1: Field of Type BIGINT Is Included in Recordset</h3>
 
<P>
If the recordset contains a field of type BIGINT, you must change the type
of the field, and then try running the macro again. Or, exclude the field
from the recordset entirely.
<P>
<P><h3>Method 2: Microsoft Visual Basic 5.0 Is Installed on Your Computer</h3>
 
<P>
To work around this problem, remove or rename the Dao350.dll file that was
installed by Microsoft Visual Basic 5.0, and install a new copy of the file
that is included with Office 97 or Excel 97.
<P>
To rename or remove the existing file, follow these steps.

<OL><P><LI>Quit all running programs.

<P><LI>On the Start menu, point to Find, and then click Files Or Folders.

<P><LI>In the Named box, type "Dao350.dll" (without quotation marks). In
   the Look In box, select "(C:)". Click to select the Include Subfolders
   check box, and then click Find Now.
<P>
   One copy of Dao350.dll should be found in the following folder:
<P>
<P><PRE>      C:\Program Files\Common Files\Microsoft Shared\DAO
</PRE>
<P><LI>Right-click the Dao350.dll file. On the shortcut menu, click Rename.
   Change the name of the file to "xDao350.dll" (without quotation marks).
   Press ENTER.
<P>
   -or-
<P>
   Right-click the Dao350.dll file. On the shortcut menu, click Delete.
   Click Yes in the Confirm File Delete dialog box.

<P><LI>Click the Close button.
<P>
</OL>After you rename or remove the file, install a new copy of Dao350.dll. To
do this, use one of the following methods.
<P>
Method 1: Download the Revised Dao350.dll file
<P>
A revised Dao350.dll file is available. This file is fully compatible with
Microsoft Visual Basic for Applications macros that use DAO and is not
replaced by Microsoft Visual Basic version 5.0.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Newdao.exe">Newdao.exe</A> <I>(size: 255200 bytes)</I> 

</PRE></OL>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>The FTP location is <B><A HREF="ftp://ftp.microsoft.com/Softlib/MSLFILES/">ftp://ftp.microsoft.com/Softlib/MSLFILES/</A></B>
<P>
For additional information about this utility, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q182596.htm">Q182596</A></B>
   TITLE     : XL97: Revised Dao350.dll File for "No current row" Error

</PRE>Method 2: Run Setup Again
<P>
Run the Microsoft Office 97 or Microsoft Excel 97 Setup program and
click Reinstall. The Setup program reinstalls all missing files,
including the Dao350.dll file. When the Setup program is finished, open
Excel 97 and verify that the macros that use DAO work correctly.
<P>
Method 3: Replace the Dao350.dll File
<P>
Copy the Dao350.dll file from your Office 97 or Excel 97 compact disc (CD)
to the correct folder on your hard disk. To do this, follow these steps:

<OL><P><LI>Insert the Office 97 or Excel 97 CD into the CD-ROM drive.

<P><LI>Using Windows Explorer, open the following folder on the CD drive
<P>
<P><PRE>      &lt;R&gt;:\OS\MSAPPS\DAO
</PRE><P>
   where &lt;R&gt;: is the drive letter for the CD-ROM drive.

<P><LI>If Dao350.dll is not visible in Windows Explorer, follow these
   steps:
<P>
<P><PRE>    a. On the View menu, click Options. Click the View tab.
</PRE><P>
<P><PRE>    b. Click to select Show All Files.
</PRE><P>
<P><PRE>    c. Click OK.
</PRE>
<P><LI>Right-click the Dao350.dll file. On the shortcut menu, click Copy.

<P><LI>Using Windows Explorer, open the following folder on your hard disk:
<P>
<P><PRE>      C:\Program Files\Common Files\Microsoft Shared\DAO
</PRE>
<P><LI>On the Edit menu, click Paste.
<P>
</OL>After Windows Explorer copies Dao350.dll from the CD to the hard disk, open
Excel 97 and make sure that the macros that use DAO work correctly.
<P>
NOTE: If you reinstall Microsoft Visual Basic 5.0, the Dao350.dll file is
replaced again, and you need to perform these steps again. However, if you
have copied the revised Dao350.dll file that is available in the Microsoft
Software Library, the file is not replaced again.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel 97 and Microsoft Visual Basic 5.0 both include copies of
the Dao350.dll file. The version numbers of these files are listed in the
following table.
<P>
<PRE>   Product                      Version of Dao350.dll
   --------------------------------------------------

   Excel 97 or Office 97        3.50.3428.0
   Visual Basic 5.0             3.50.3602.0

</PRE></OL>When you install Visual Basic 5.0, the version number of its Dao350.dll
file is higher than the version of the file that is installed with Excel
97; therefore it replaces the Dao350.dll file that is included in Excel 97.
If you reinstall Excel 97 or Office 97, the older Dao350.dll file does not
replace the newer Dao350.dll file. This is why you cannot correct the
problem that is described in this article by simply reinstalling Excel 97
or Office 97.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 copyfromrecordset createworkspace fields<BR>
openrecordset openconnection<BR>
Keywords          : kbprg kbsetup xlvbainfo xldao<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
