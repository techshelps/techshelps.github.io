

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC95: RegisterDatabase Example in Help Causes Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156225">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/09/19">
<META NAME="Keywords" CONTENT="DcmHlp kberrmsg kbprg PgmOthr OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the Example code for the RegisterDatabase method in Microsoft Access for Windows 95 version 7.0 Help, you may receive the following error message:     Run-time error...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAU9,QA9E,QAPN,QA1S,QAB4,QAA1,QAAP,QDI2,QDN9,QAUJ,QAPF,QAH4,QBTX,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: RegisterDatabase Example in Help Causes Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156225</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the Example code for the RegisterDatabase method in Microsoft
Access for Windows 95 version 7.0 Help, you may receive the following error
message:
<P>
<PRE>   Run-time error '3146':

   ODBC--call failed.

</PRE><h2>CAUSE</h2>
 
<P>
In the Example code, the following string expression assigned to the
strAttribs variable is incomplete:
<P>
<PRE>   strAttribs = "Description=SQL Server on server PtLudlow" &amp; _
       Chr$(13) &amp; "OemToAnsi=No" &amp; Chr$(13) &amp; "Network=DBNMP3" &amp; _
       Chr$(13) &amp; "Address=\\PTLUDLOW\PIPE\SQL\QUERY" &amp; Chr$(13) &amp; _
       "Database=MySQLDb"

</PRE>Also, the string expression for the SQL Server driver argument of the
RegisterDatabase method is incorrect:
<P>
<PRE>   DBEngine.RegisterDatabase "PtLudlow", "SQL Server 32", True, strAttribs

</PRE><h2>RESOLUTION</h2>
 
<P>
To correct the RegisterDatabase Example code, add a Server attribute to the
strAttribs expression as follows:
<P>
<PRE>   strAttribs = "Description=SQL Server on server PtLudlow" &amp; _
       Chr$(13) &amp; "OemToAnsi=No" &amp; Chr$(13) &amp; "Network=DBNMP3" &amp; _
       Chr$(13) &amp; "Address=\\PTLUDLOW\PIPE\SQL\QUERY" &amp; Chr$(13) &amp; _
       "Database=MySQLDb" &amp; Chr$(13) &amp; "Server=PtLudlow"

</PRE>Then change "SQL Server 32" to "SQL Server" in the driver argument of the
RegisterDatabase method as follows:
<P>
<PRE>   DBEngine.RegisterDatabase "PtLudlow", "SQL Server", True, strAttribs

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The keyword "Server" is a required attribute for setting up the SQL Server
ODBC driver, which is what this example uses. "Server" may not be a
required attribute for other ODBC drivers.
<P>
The driver argument of the RegisterDatabase method is a string expression
that is the name of the ODBC driver. For the SQL Server ODBC driver, that
name should be "SQL Server" instead of "SQL Server 32." To find the name of
any ODBC driver available on your computer, click the ODBC icon in Control
Panel, and then click the Add button. The names of all installed ODBC
drivers appear in the Installed ODBC Drivers box.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the RegisterDatabase method, search for
"RegisterDatabase," using the Microsoft Access for Windows 95 Help Index.
<P>
 
<PRE>Keywords          : DcmHlp kberrmsg kbprg PgmOthr OdbcOthr
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbdocerr</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
