

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Macro On Workbook Is Not Defined Error While Updating Links </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117231">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1994/06/23">
<META NAME="Keywords" CONTENT="kberrmsg kbprg xlvbainfo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you open a Microsoft Excel workbook that contains an external link, and then re-establish links in the workbook, you may receive the following error message:                  on                 is not defined or is too complex  where          ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QBWS,QAE2,QAPN,QAW6,QAXB,QAH0,QDNM,QAGI,QBVV,QANE,QBXA,QAUJ,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Macro On Workbook Is Not Defined Error While Updating Links</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117231</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for the Macintosh, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a Microsoft Excel workbook that contains an external link,
and then re-establish links in the workbook, you may receive the following
error message:
<P>
<PRE>   &lt;Macro name&gt; on &lt;Workbook name&gt; is not defined or is too complex

</PRE>where &lt;Macro name&gt; is the name of a macro in an external workbook called
&lt;Workbook name&gt;.
<P>
<P><h2>CAUSE</h2>
 
<P>
<P><h3>Case 1: The Object Is Assigned to a Macro</h3>
 
<P>
This problem occurs when you open a workbook that contains an object that
is linked to a macro in another workbook, and you re-establish the links in
the workbook.
<P>
When you assign a macro to an object, and the macro is in a different
workbook, a link to the workbook that contains the macro appears in the
Links dialog box. If you update this link by clicking Update Now in the
Links dialog box, and the workbook that contains the macro is closed, the
error message appears because Microsoft Excel cannot update the link.
<P>
This behavior is by design of Microsoft Excel.
<P>
Note that this problem also occurs if you re-establish links in a workbook
that contains an object that is linked to a macro in another workbook, and
the workbook you open also contains a reference to a named range in the
workbook.
<P>
When you open this type of workbook, Microsoft Excel prompts you to re-
establish links in the workbook.
<P>
NOTE: When you open a workbook that contains an object that is linked to a
macro in another workbook, and the workbook you open does not contain any
other external links, Microsoft Excel should not prompt you to re-establish
the links when you open the workbook. Microsoft Excel prompts you to update
links if the "Ask to Update Automatic Links" check box is selected on the
Edit tab in the Options dialog box.
<P>
The message to re-establish links does not appear when either of the
following conditions are true:

<UL><LI>You open a workbook that contains a reference to a named range in the
   same workbook, and the workbook you open does not contain an external
   link or object that is linked to a macro in another workbook.
<P>
   -or-

<LI>You open a workbook that contains an object that is linked to a macro in
   another workbook, and the workbook does not contain an external link or
   reference to a named range in the same workbook.
<P>
</UL><h3>Case 2: Calling a Custom Function in an Add-In</h3>
 
<P>
This problem occurs when you open a workbook that contains a formula that
calls a custom function in an add-in, and then re-establish the links in
the workbook. This problem occurs when all of the following conditions are
true:

<UL><LI>When you open the workbook, the add-in is not open.
<P>
   -and-

<LI>You move the add-in after you create the formula that calls the custom
   function in the add-in.
<P>
   -and-

<LI>When you are prompted to re-establish links, you click Yes.
<P>
   -and-

<LI>When Microsoft Excel cannot find the add-in, you locate it (in the new
   location) in the File Not Found dialog box, and then click OK.
<P>
</UL><h2>WORKAROUNDS</h2>
 
<P>
<P><h3>Method 1: The Object Is Assigned to a Macro</h3>
 
<P>
To work around the problem when the object is assigned to a macro, do any
of the following:

<UL><LI>On the Tools menu, click Options, click the Edit tab, and clear the "Ask
   to Update Automatic Links" check box.
<P>
   Note that this setting affects all workbooks.
<P>
   -or-

<LI>Before you open the workbook that contains the object, open the workbook
   that contains the macro that is assigned to the object.
<P>
   -or-

<LI>When you are prompted to re-establish the links in the workbook that
   contains the object that is assigned to a macro in another
   workbook, click No.
<P>
   -or-

<LI>Use a cell reference instead of using a named reference in the workbook
   that contains the object that is assigned to a macro in another
   workbook.
<P>
   Note that this workaround applies only to references to cells within
   the workbook. It does not apply to external references.
<P>
</UL><h3>Method 2: Calling a Custom Function in an Add-In</h3>
 
<P>
To work around this problem when you open a workbook that calls a custom
function in an add-in, do the following:

<OL><P><LI>Quit Microsoft Excel.

<P><LI>Start Microsoft Excel, and then open the workbook that contains the
   link.

<P><LI>When you are prompted to re-establish links, click No.
<P>
   NOTE: Any formulas that call custom functions in a moved add-in display
   the full path to the previous location of the add-in.

<P><LI>On the Tools menu, click Add-Ins.

<P><LI>In the Add-Ins dialog box, click Browse. In the Browse dialog box,
   locate and select the add-in that you moved.

<P><LI>Click OK.

<P><LI>In the Add-Ins dialog box, make sure the add-in is selected and click
   OK.
<P>
   Formulas no longer display the incorrect path to the moved add-in;
   because the add-in is in random access memory (RAM), the formulas
   contain only the call to the custom function.

<P><LI>Save the workbook.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Excel 97</h3>
 
<P>
For more information about assigning a macro to a graphic object or to a
button on a sheet, click the Index tab in Microsoft Excel Help, type the
following text
<P>
<PRE>   macros, running

</PRE></OL>and then double-click the selected text to go to the "Run a macro from a
button or graphic control" topic.
<P>
<P><h3>Microsoft Excel 5.0</h3>
 
<P>
For more information about assigning a macro to a graphic object or to a 
button on a sheet, click the Search button in Help and type:
<P>
<PRE>   assigning macros
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 5.00 err msg<BR>
Keywords          : kberrmsg kbprg xlvbainfo PgmOthr<BR>
Version           : WINDOWS: 5.0,5.0c,7.0,7.0a; MACINTOSH: 5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
