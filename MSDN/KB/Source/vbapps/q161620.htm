

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Error Running Solver Macro with Non-Comma List Separators </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161620">
<META NAME="KBModify" CONTENT="1997/09/03">
<META NAME="KBCreate" CONTENT="1996/12/31">
<META NAME="Keywords" CONTENT="PgmOthr xlvbainfo xladdins kberrmsg kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In the programs listed at the beginning of this article, when you run a recorded Visual Basic for Applications macro that uses the Solver functions, you may receive the following error message:     Run Time Error '1004'    Error in Formula  CAUSE =...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBSU,QBTX,QABA,QBAO,QBWS,QBVP,QDL9,QBWQ,QBWO,QBWN,QAB4,QAY5,QAH4,QAAQ,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Error Running Solver Macro with Non-Comma List Separators</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161620</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the programs listed at the beginning of this article, when you run a
recorded Visual Basic for Applications macro that uses the Solver
functions, you may receive the following error message:
<P>
<PRE>   Run Time Error '1004'
   Error in Formula

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if you set the Regional Settings in the Control Panel
under Windows 95, or the International Settings in the Control Panel under
Windows 3.1 or 3.11, to anything other than "English (United States)".
<P>
The Solver functions use the comma (,) as a list separator to separate the
arguments of the function. Setting the Regional Settings to anything other
than "English (United States)" changes the list separator to something
other than a comma.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this behavior, set the Regional Settings in the Control Panel
under Windows 95, or the International Settings in the Control Panel under
Windows 3.1 or 3.11, to "English (United States)." To do this, use the
following appropriate steps:
<P>
<P><h3>Windows 95</h3>
 

<OL><P><LI>On the Start menu, point to Settings, and then click Control Panel.

<P><LI>Double-click the Regional Settings icon.

<P><LI>Click the Regional Settings tab.

<P><LI>In the setting box, click "English (United States)" and click OK.
<P>
</OL><h3>Windows 3.1, or 3.11</h3>
 

<OL><P><LI>In the Main group in Program Manager, double-click Control Panel.

<P><LI>Double-click the International icon.

<P><LI>In the Country list, click United States. In the Language, click
   "English (United States)" and click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about changing the regional settings, click the Index
tab in Windows 95 Help, type the following text
<P>
<PRE>   regional settings

</PRE></OL>and then double-click the selected text to go to the "regional settings,
changing" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00<BR>
Keywords          : PgmOthr xlvbainfo xladdins kberrmsg kbtool kbusage<BR>
Version           : 5.00 5.00c 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
