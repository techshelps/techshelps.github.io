

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Macro to Add Data Point Labels to a Chart in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77086 ">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1991/10/07">
<META NAME="Keywords" CONTENT="PgmHowTo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can place text labels on individual data points in a chart. You can replace existing labels or create new labels with text values from a worksheet either by manually editing the label in the formula bar in the chart, or you ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAC2,QBVP,QAH4,QBC9,QBC8,QANO,QBOM,QDNX,QAVS,QBXS,QAY2,QAD7,QBWS,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Macro to Add Data Point Labels to a Chart in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77086 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for the Macintosh, versions 3.x, 4.x, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can place text labels on individual data points in
a chart. You can replace existing labels or create new labels with text
values from a worksheet either by manually editing the label in the formula
bar in the chart, or you can write a macro. This article shows how to do
this from a macro, which is the desired method if the chart contains many
data points or if you update charts in this fashion often.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides macro examples for illustration only, without warranty
either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose. This
macro is provided 'as is' and Microsoft does not guarantee that the
following code can be used in all situations. Microsoft does not support
modifications of the code to suit customer requirements for a particular
purpose.
<P>
<P><h3>Example</h3>
 
<P>
The following example creates new, or replaces existing, data labels on a
chart for a single data series. Before following the steps below, you
should have an existing chart, and you should have a range of cells on your
worksheet containing the labels that you wish to have placed in your chart.
The number of labels on your worksheet should be equal to the number of
points per data series in your chart.

<OL><P><LI>Select the cells containing the labels in your worksheet. (For this
   example, the worksheet will be called "SHEET1.XLS".)

<P><LI>From the Formula menu, choose Define Name. Type "Labels" (without
   the quotation marks) in the Name box and choose the OK button.

<P><LI>Enter the following into a macro sheet:
<P>
<P><PRE>      A1: i=1
      A2: =FOR.CELL("CurrentCell",Sheet1.XLS!Labels)
      A3: =ATTACH.TEXT(4,1,i)
      A4: =FORMULA(CurrentCell)
      A5: i=i+1
      A6: =NEXT()
      A7: =RETURN()
</PRE><P>
   This macro uses a FOR.CELL loop. Each pass through the loop takes
   the text from the current cell in the range called "Labels" and
   places that text on the next data point. Incrementing the counter
   "i" allows the ATTACH.TEXT statement to refer to the next data
   point.

<P><LI>Select cell A1. From the Formula menu, choose Define Name. Type
   "Change" (without the quotation marks) in the Name box. Choose
   Command and choose the OK button.

<P><LI>Activate your chart and run the macro by choosing Run from the
   Macro menu, selecting Change from the list box, and then choosing
   the OK button.
<P>
</OL>If your chart has more than one data series, you will need to make
modifications to this macro.
<P>
NOTE: This works differently under 3-D charts.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 1," version 4.0, pages 455-456
"Function Reference," version 4.0, pages 29-30, 155-156
"Microsoft Excel User's Guide" for Windows, version 3.0, pages
475-476
"Microsoft Excel Function Reference" for Windows, version 3.0, pages
18-19, 80
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21 3.0<BR>
3.00 4.0 4.00 data marker 5.00<BR>
Keywords          : PgmHowTo PgmOthr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
