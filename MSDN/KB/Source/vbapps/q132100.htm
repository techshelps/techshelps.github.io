

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Delete Table Set in RecordSource When Form Closes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132100">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/06/28">
<META NAME="Keywords" CONTENT="kbusage PgmObj FmsEvnt">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how you can delete a table set in a form's RecordSource property when you close the form. This technique is useful if you need to set a form's RecordSou...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAGB,QDN9,QBS0,QAPN,QBXS,QA5F,QAMA,QAEF,QAI2,QAAW,QBJZ,QBCT,QAGC,QBV8 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Delete Table Set in RecordSource When Form Closes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132100</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how you can delete a table set in a form's
RecordSource property when you close the form. This technique is useful if
you need to set a form's RecordSource property to a temporary table at run
time and then delete the temporary table when the form closes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
The method described below runs a sample user-defined Visual Basic function
from a command button on a form based on one table. The sample function
sets the form's RecordSource property to an empty string (""), and then
deletes the table set in the form's RecordSource property when the form
closes.
<P>
To delete a table set in a form's RecordSource property when the form
closes, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in Microsoft
    Access 2.0).

<P><LI>Select the Customers table, and on the Edit menu, click Copy.

<P><LI>On the Edit menu click Paste.

<P><LI>In the Paste Table As dialog box, type Cust2 in the Table Name box.

<P><LI>Repeat steps 2 and 3 for the Customers form.

<P><LI>In the Paste As dialog box, type CustForm.

<P><LI>Create a module and type the following line in the Declarations
    section if it is not already there:
<P>
      Option Explicit

<P><LI>Type the following procedure:
<P>
    In Microsoft Access 7.0 and 97:
<P>
      Function CloseAndDelete ()
<PRE>        Forms!CustForm.RecordSource = ""
        DoCmd.Close acForm, "CustForm"
        DoCmd.DeleteObject acTable, "Cust2"
      End Function

    In Microsoft Access 2.0:

      Function CloseAndDelete ()
        Forms!CustForm.RecordSource = ""
        DoCmd Close A_FORM, "CustForm"
        DoCmd DeleteObject A_TABLE, "Cust2"
      End Function

</PRE><P><LI>Open the CustForm form in Design view and set the form's properties
    as follows:
<P>
      Caption: CustForm
      RecordSource: Cust2

<P><LI>Create a new command button in the CustForm form's detail section and
    set its properties as follows:
<P>
      Command Button:
<PRE>         Name: Button0
         Caption: Close Form
         OnClick: =CloseAndDelete()

</PRE><P><LI>Save the CustForm form, and then view the form in Form view.

<P><LI>Click the Close Form button. Note that the form closes, the Cust2 table
    is deleted from the form's RecordSource property, and the Cust2 table
    itself is deleted.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the DoCmd object, search for "DoCmd object"
using the Microsoft Access 97 Help Index.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: timing event code<BR>
Keywords          : kbusage PgmObj FmsEvnt<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
