

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: "Not Enough Memory" Opening a Workbook with a Chart </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172948">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1997/08/20">
<META NAME="Keywords" CONTENT="kberrmsg kbprg kbdta kbdtacode xlvbainfo xlloadsave xlchart">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you open a workbook in Microsoft Excel 97, the following problems may occur:   - You receive the following error message:        Not enough memory.  -and-    - In the active chart, text is missing from both the legend and the    chart title. A...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAY5,QBVP,QDNX,QAB9,QBV8,QBVV,QAQG,QAO4,QAKR,QAHE,QAC2,QDNM,QDKW,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: "Not Enough Memory" Opening a Workbook with a Chart</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172948</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a workbook in Microsoft Excel 97, the following problems may
occur:

<UL><LI>You receive the following error message:
<P>
<P><PRE>      Not enough memory.
</PRE><P>
</UL>-and-
<P>

<UL><LI>In the active chart, text is missing from both the legend and the
   chart title. Also, some or all of the chart series labels contain the
   text "0."
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems occur if all of the following conditions are true:

<UL><LI>When you open the workbook, a chart sheet is the active sheet.
<P>
<P><PRE>    -and-
</PRE>
<LI>The active chart sheet refers to cells in a worksheet that contain
   formulas that refer to one or more user-defined functions.
<P>
<P><PRE>    -and-
</PRE>
<LI>One of the user-defined functions uses the Volatile method by using the
   following line of code in the function:
<P>
<P><PRE>      Application.Volatile
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around these problems, use either of the following methods:

<UL><LI>Before you save the workbook, click a worksheet or chart sheet that does
   not refer to user-defined functions. When you do this, you ensure that
   the active sheet does not refer to a user-defined function.
<P>
<P><PRE>    -or-
</PRE>
<LI>Remove Application.Volatile from any user-defined functions that are
   referenced by the chart sheet.
<P>
</UL>If you cannot change the active sheet or modify the user-defined functions,
you can temporarily correct the chart by following these steps:

<OL><P><LI>Switch to the worksheet that is referenced by the chart sheet.

<P><LI>Press CTRL+ALT+F9.
<P>
</OL>This forces the entire worksheet to be recalculated. When you switch to the
chart sheet, the title, legend, and series labels appear correctly. Note
that when you close and reopen the workbook, the problems may occur again.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A volatile function must be recalculated whenever calculation occurs in any
cells on the worksheet. A nonvolatile function is recalculated only when
the input variables change.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kberrmsg kbprg kbdta kbdtacode xlvbainfo xlloadsave xlchart<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
