

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Editing a Chart SERIES Formula with a Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q67454 ">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1990/12/04">
<META NAME="Keywords" CONTENT="kbcode kbmacro kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  To manipulate a Microsoft Excel chart's SERIES formula with a macro, the GET.FORMULA(reference) command can be used to return the entire SERIES formula as text. The resultant text string can then be manipulated with Excel's text functions.  When th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBVP,QAKC,QAB9,QBC6,QAA7,QBC9,QBC8,QA5V,QANO,QAG8,QAH4,QALW,QATX,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Editing a Chart SERIES Formula with a Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q67454 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 2.x, 3.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To manipulate a Microsoft Excel chart's SERIES formula with a macro,
the GET.FORMULA(reference) command can be used to return the entire
SERIES formula as text. The resultant text string can then be
manipulated with Excel's text functions.
<P>
When the "reference" argument of the GET.FORMULA command is entered in
the form "S#P#" (Series#Point#), the SERIES formula for the specified
series and point number will be returned.
<P>
For example, if a chart is created from the values in cells A1:A5 on a
worksheet and information is added to cell A6, the following macro
will update the existing chart to include the new information:
<P>
<PRE>    A1: AddRow
    A2: =GET.FORMULA("S1P1")
    A3: =LEFT(A2,SEARCH(":",A2)+1)
    A4: =SEARCH(":",A2)+2
    A5: =SEARCH("C",A2,A4)
    A6: =A5-A4
    A7: =MID(A2,A4,A6)+1
    A8: =RIGHT(A2,LEN(A2)-(SEARCH(":",A2)+1+A6))
    A9: =A3&amp;A7&amp;A8
   A10: =SELECT("S1P1")
   A11: =FORMULA(A9)
   A12: =RETURN()

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<PRE> A1 = Macro name.
 A2 = Returns the SERIES formula as text from series 1, point 1 on
      the active chart.
 A3 = Returns the left side of the formula, up to the row number to
      be incremented.
 A4 = Returns the position of the row number to incremented. If the
      row number has more than one digit, returns the first digit.
 A5 = Returns the position of the character "C", which will follow
      the row number to be incremented.
 A6 = Returns the number of digits in the row number.
 A7 = Identifies the entire row number and adds one to it.
 A8 = Returns the right side of the formula, beginning at the first
      non-digit after the row number.
 A9 = Concatenates the left side of the formula, new row number, and
      right side of the formula.
</PRE>A10 = Selects series 1, point 1 on the active chart.
A11 = Enters the new formula into the formula bar, replacing the old
<PRE>      formula.
</PRE>A12 = Ends the macro.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on the GET.FORMULA command, see pages 199-200 of
the "Microsoft Excel Function Reference," version 4.0. If you are
using version 3.0, see page 110 of the "Microsoft Excel Function
Reference," version 3.0 manual. If you are using Excel 2.20, see page
238 of the "Microsoft Excel Functions and Macros" version 2.2 manual.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: noupd<BR>
Keywords          : kbcode kbmacro kbprg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
