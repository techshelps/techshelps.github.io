

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Programmatically Add Counter Field to Table Using DAO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113546">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/04/06">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo MdlDao TblModfy">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to add an AutoNumber field (or Counter field in version 2.0) to an existing table using data access objects (DAO).  This article assumes that you ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA7O,QA7N,QBS0,QBC6,QDN9,QAKC,QAM9,QALX,QAMA,QA5F,QAG8,QAUJ,QAAP,QAB4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Programmatically Add Counter Field to Table Using DAO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113546</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to add an AutoNumber field (or Counter field in
version 2.0) to an existing table using data access objects (DAO).
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To add an AutoNumber field to a table using DAO and Visual Basic, follow
these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).

<P><LI>Create the following new table called Counterless:
<P>
<P><PRE>      Table: Counterless
      -----------------------
      Field Name: MyText
<PRE></PRE>         Data Type: Text
      Field Name: MyNumber
         Data Type: Number
      Field Name: MyDate
         Data Type: Date/Time

</PRE><P><LI>Save the table, close it, and do not create a primary key.

<P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      '***************************************************************
      ' FUNCTION: AddCounter()
      '
      ' PURPOSE:  Programmatically adds an AutoNumber field to an
<PRE></PRE>      '           existing table.
      '
      ' ARGUMENTS:
      '
      '    TName: The name of the table.
      '    FName: The name of the new AutoNumber field.
      '
      ' RETURNS:  True (error was encountered) or
      '           False (no error) as an integer.
      '
      '***************************************************************
      Function AddCounter (TName As String, FName As String) As Integer
         Dim DB As Database, TDef As TableDef, Fld As Field

         ' Get the current database.
         Set DB = CurrentDb()
         ' Open the tabledef to which the counter field will be added.
         Set TDef = DB.TableDefs(TName)

         ' Create a new AutoNumber field of type LONG
         ' with the automatic increment attribute.
         Set Fld = TDef.CreateField(FName, dbLong)
         Fld.Attributes = dbAutoIncrField

         ' If you are using version 2.0, replace the
         ' two lines above with the following two lines.
         ' Set Fld = TDef.CreateField(FName, DB_LONG)
         ' Fld.Attributes = DB_AUTOINCRFIELD

         ' Trap for any errors.
         On Error Resume Next

         ' Append the new field to the tabledef.
         TDef.fields.Append Fld

         ' Check to see if an error occurred.
         If Err Then
            AddCounter = False
         Else
            AddCounter = True
         End If

         DB.Close

      End Function

</PRE><P><LI>Save the module as DAOAddCounter, and then close it.

<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       ?AddCounter("Counterless","NewID")
</PRE><P>
   Open the Counterless table and note the new NewID AutoNumber field.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the CreateField method, search for
"CreateField," and then "CreateField Method" using the Microsoft
Access 97 Help Index.
 
<PRE>Keywords          : kbusage PgmHowTo MdlDao TblModfy
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
