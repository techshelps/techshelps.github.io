

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Query to Find Unmatched Records Between Two Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114150">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/04/25">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article describes how to create a Subtract query that compares two tables and returns a result set that includes only those records from the first table that do not have matching records in the second table.  MORE INFORMATION  Overview of the ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBI0,QBXS,QBWS,QAG2,QBVP,QAPF,QA2Q,QAY2,QAK6,QAHH,QAGU,QBJZ,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Query to Find Unmatched Records Between Two Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114150</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Query for Windows 95, version 2.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to create a Subtract query that compares two
tables and returns a result set that includes only those records from the
first table that do not have matching records in the second table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Overview of the Subtract Query Procedure</h3>
 
<P>
To perform a Subtract query, create an outer join that joins the two
tables, and then add a condition to the query that filters out all of the
matching records.
<P>
<P><h3>Example of the Subtract Query Procedure</h3>
 
<P>
This example uses the sample files that ship with Microsoft Excel 5.0.
The default location for these files is WINDOWS\MSAPPS\MSQUERY. If these
file are not installed on your system, run Microsoft Excel 5.0 Setup and
install Microsoft Query again.
<P>
In this example, the source table (CUSTOMER.DBF) and the destination table
(EMPLOYEE.DBF) are the two files that you want to join. The destination
table is the table that contains the unmatched records. (Note that the
following query results in a new table. The contents of the source and
destination tables are left unchanged.)

<OL><P><LI>In Microsoft Query, choose New Query from the File menu. Add the source
   and destination tables to the query. (The procedure for doing this will
   depend on the data source).
<P>
   For example, in the Select Data Source dialog box, choose Other, select
   dBASE Files and then choose the Use button. Change the current directory
   to WINDOWS\MSAPPS\MSQUERY. Select the file CUSTOMER.DBF (the source
   file), and choose Add. Then, select EMPLOYEE.DBF, choose Add, and then
   choose Close.

<P><LI>From the Table menu, choose Joins. Choose a join type that specifies ALL
   records from the destination table and ONLY matching records from the
   source table.
<P>
   For example, from the Left drop-down box, select customer.CITY, and from
   the Right text box, select employee.CITY. Under Join Includes, select
   option 3 (the Select ALL Values From Employee and ONLY Records from
   Customer Where customer.CITY = Employee.CITY option). Choose Add, and
   then choose Close.

<P><LI>Add a criteria field to match on for both tables, and add the condition
   Is Null.
<P>
   For example, from the Criteria menu, choose Add Criteria, and make the
   following changes:
<P>
<P><PRE>    - In the Field box, select customer.CITY.
</PRE><P>
<P><PRE>    - In the Operator box, select Is Null.
</PRE><P>
   Choose Add, and then choose Close.

<P><LI>In the Data pane (below the Criteria pane), select the blank column
   heading, click the drop-down arrow, and select employee.CITY.
<P>
</OL>The Data pane will contain records that exist only in the destination
table, but not in the source table. In this example, the value Redmond
should appear in the column labeled "CITY." This is the only city listed in
the EMPLOYEE table that is not in the CUSTOMER table.
<P>
WARNING: Your use or modification of the SQL statement provided in
this article is at your own risk. Microsoft provides this SQL
statement "as is" without warranty of any kind, either expressed or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. Microsoft
does not support modifications of the SQL statement to suit specific
customer requirements.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Query User's Guide," version 1.0, Chapter 6, "What Join
Lines Are And How They're Created"
<P>
For more information about Joins, choose the Search button in Help and
type:
<P>
<PRE>   Join
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 1.00 query subtract match unmatched<BR>
Keywords          : kbprg PgmHowTo kbprg<BR>
Version           : 1.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
