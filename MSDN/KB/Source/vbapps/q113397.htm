

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRJ: TimeScaledData Method Example Run Time Error 91 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113397">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1994/04/04">
<META NAME="Keywords" CONTENT="kbcode kbprg kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The sample code for the TimeScaledData method in Visual Basic for Applications Help may produce a  Run Time Error 91  error message when you use it with projects that contain blank rows.  Under normal circumstances, this macro should run correctly ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAB4,QBWS,QBS0,QAAP,QBXS,QA5V,QAPF,QBJZ,QAPN,QAG2,QA9N,QAU3,QAMR,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRJ: TimeScaledData Method Example Run Time Error 91</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113397</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Project for the Macintosh, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The sample code for the TimeScaledData method in Visual Basic for
Applications Help may produce a "Run Time Error 91" error message when you
use it with projects that contain blank rows.
<P>
Under normal circumstances, this macro should run correctly and create a
.CSV file.
<P>
<P><h2>CAUSE</h2>
 
<P>
The sample code for this macro does not take blank rows into account;
therefore, the Run Time error is produced when the macro encounters a blank
task row.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, add additional commands to the macro code that
will trap the error situation. To trap the error, add "If Not (t is
Nothing) then . . . end if" around the For Next loop in the macro. When you
add this code, the error will be trapped and the example will run on files
with blank task rows. The resulting code example looks like this:
<P>
<PRE>Sub AssignmentsOverTime()
   Dim  t, r, temp

   Open "USAGE.CSV" For Output As #1

   For Each t In ActiveProject.Tasks
      If Not (t is Nothing) Then        'NEW LINE
         Print #1, t.Name
         For Each r In t.Resources
            temp = TimescaledData(t.ID, r.ID, ActiveProject.ProjectStart, _
                    ActiveProject.ProjectFinish, pjWork, pjTimescaleWeeks)
            Print #1, r.name &amp; ListSeparator &amp; temp
         Next r
      End If                            'NEW LINE
   Next t

   Close #1
End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create three tasks, and assign resource Joe to each task.

<P><LI>From the Help menu, choose Contents. In Help, choose the Visual Basic
   Reference.

<P><LI>Choose Methods, and then choose TimeScaledData, and click the Example
   for this method.

<P><LI>Click the Copy button, select the example, and then choose Copy.

<P><LI>From the Tools menu, choose Macros, and choose the New button. Paste the
   example into the new Visual Basic module.

<P><LI>From the Run menu, choose Start, and select the macro and choose Run.
<P>
   NOTE: The macro will execute with no errors

<P><LI>Insert a row between task 1 and 2.

<P><LI>Run the Macro again.
<P>
</OL>You will receive the "RunTime Error 91" error message when macro encounters
blank row.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : kbcode kbprg kbcode kbprg<BR>
Version           : 4.00 | 4.00<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
