

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL7: "Run-time error '1004'" Using SetBackgroundPicture Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131396">
<META NAME="KBModify" CONTENT="1997/09/03">
<META NAME="KBCreate" CONTENT="1995/06/11">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you run a Visual Basic macro that contains the SetBackgroundPicture method, you may receive the following error message     Run-time error '1004':     Cannot use that command on a protected sheet  even if you did not use th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAPN,QBS0,QBVP,QAH4,QAAP,QBVV,QAW6,QAB9,QDNH,QBFY,QA5F,QAPF,QAMA,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: "Run-time error '1004'" Using SetBackgroundPicture Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131396</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you run a Visual Basic macro that contains the
SetBackgroundPicture method, you may receive the following error message
<P>
<PRE>   Run-time error '1004':

   Cannot use that command on a protected sheet

</PRE>even if you did not use the command on a protected worksheet.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error message appears if you apply the SetBackgroundPicture method to
a DialogSheet in a Visual Basic macro, regardless of whether the sheet is
protected. For example, the error message described above appears when you
run a macro that contains the following command:
<P>
<PRE>   DialogSheets(1).SetBackgroundPicture ("")

</PRE>You can use the SetBackgroundPicture method to set the background graphic
for a worksheet or chart. Because the SetBackgroundPicture method applies
only to the Worksheet object and the Chart object, you should receive an
error message when you use the SetBackgroundPicture method with the
DialogSheet object. However, the error message that should appear in this
case (if the dialog sheet is not protected) is the following:
<P>
<PRE>   Run-time error '1001':

   DialogSheet does not have SetBackgroundPicture method

</PRE>Note that this error message correctly appears when you use the
SetBackgroundPicture method with a Module object.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid receiving either of the error messages described above when you
use the SetBackgroundPicture method in a Visual Basic macro, use any of the
following methods:
<P>
Method 1: Activate the worksheet or chart that you want to add the graphic
<PRE>          background to before the SetBackgroundPicture method command runs
          in the macro, as in the following examples:

             Worksheets(1).Select
             ActiveSheet.SetBackgroundPicture ("C:\Clipart\picture1.bmp")

             -or-

             Charts(1).Select
             ActiveSheet.SetBackgroundPicture ("C:\Clipart\picture2.bmp")

</PRE>Method 2: Apply the SetBackgroundPicture method to a Worksheet or Chart
<PRE>          object directly as in the following examples:

             Worksheets(1).SetBackgroundPicture ("C:\Clipart\picture1.bmp")

             -or-

             Charts(1).SetBackgroundPicture ("C:\Clipart\picture2.bmp")

</PRE>Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using the SetBackgroundPicture method in a
Visual Basic macro in Microsoft Excel, click the Index tab in Microsoft
Excel Help, and type the following text
<P>
<PRE>   setback

</PRE>and then double-click the selected text to go to the "SetBackgroundPicture
Method" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: <BR>
Keywords          : kbcode kbprg PgmHowTo<BR>
Version           : 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
