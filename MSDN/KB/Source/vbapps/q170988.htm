

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Create a Word 97 Merge Document Using Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170988">
<META NAME="KBModify" CONTENT="1997/11/13">
<META NAME="KBCreate" CONTENT="1997/07/02">
<META NAME="Keywords" CONTENT="IntpOlea kbcode kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to use Automation to create a Microsoft Word 97 mail merge document, to insert merge fields, and then to execute the merge.  This article assum...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QALI,QDME,QA1S,QDN9,QA2K,QDNE,QAUJ,QATX,QAPF,QAMB,QBS0,QBRG,QBWS,QDNJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create a Word 97 Merge Document Using Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170988</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to use Automation to create a Microsoft Word
97 mail merge document, to insert merge fields, and then to execute the
merge.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Access, you can use Automation to execute a mail merge in a
Microsoft Word 97 document. The sample procedure in this article uses the
OpenDataSource and Execute methods of the MailMerge object that is
available in Microsoft Word 97.
<P>
The following example creates a procedure called CreateMergeDoc, which
takes two arguments:
<P>
<PRE>   Argument      Value
   --------      ------------------------------------------------------
   UseDDE        True if you want to use DDE
                 False if you want to use ODBC

   PrintDoc      True if you want to print the result of the merge
                 False if you only want to view the result of the merge

</PRE>To create the sample procedure, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>On the Tools menu, click References.

<P><LI>In the References box, make sure the Microsoft Word 8.0 Object
   Library check box is selected, and then click OK.
<P>
   NOTE: If the Microsoft Word 8.0 Object Library does not appear
   in the Available References box, browse your hard drive for the file
   MsWord8.olb. If you cannot locate this file, you must run the
   Microsoft Word 97 Setup program to install it before you proceed
   with this example.

<P><LI>Type the following procedure:
<P>
<PRE>      Sub CreateMergeDoc(UseDDE As Boolean, PrintDoc As Boolean)
         Dim WordApp As Word.Application
         Dim WordDoc As Word.Document
         Dim strLetter As String
         Dim strConnect As String

         ' Create an instance of Microsoft Word 97.
         Set WordApp = CreateObject("Word.Application")

         ' Create a new, empty document.
         Set WordDoc = WordApp.Documents.Add
         With WordDoc.MailMerge
            If UseDDE Then
               strConnect = "TABLE Customers"
            Else
               ' Note that on your computer the path
               ' to Northwind.mdb may be different.
               ' You can set DSN=MS Access 97
               ' in Microsoft Access 7.0.
               strConnect = "DSN=MS Access 97 " _
               &amp; "Database;DBQ=C:\Program Files\Microsoft Office\" _
               &amp; "Office\Samples\Northwind.mdb;" _
               &amp; "FIL=MS Access;"
            End If
            ' Note that on your computer the path
            ' to Northwind.mdb may be different.
            .OpenDataSource _
                Name:="C:\Program Files\Microsoft Office\Office\" _
                &amp; "\Samples\Northwind.mdb", _
                ReadOnly:=True, LinkToSource:=True, _
                Connection:=strConnect, _
                SQLStatement:="SELECT * FROM [Customers]"

            ' Define the Merge fields in the document.
            With .Fields
               .Add Range:=WordApp.Selection.Range, Name:="CompanyName"
               WordApp.Selection.TypeParagraph
               .Add Range:=WordApp.Selection.Range, Name:="Address"
               WordApp.Selection.TypeParagraph
               .Add Range:=WordApp.Selection.Range, Name:="City"
               WordApp.Selection.TypeText Text:=", "
               .Add Range:=WordApp.Selection.Range, Name:="Region"
               WordApp.Selection.TypeText Text:="  "
               .Add Range:=WordApp.Selection.Range, Name:="PostalCode"
               WordApp.Selection.TypeParagraph
               .Add Range:=WordApp.Selection.Range, Name:="Country"
            End With
         End With

         ' Define the body of the letter in the merge document.
         strLetter = "Thank you for your business during the past year."
         With WordApp.Selection
            .TypeParagraph
            .TypeParagraph
            .TypeText Text:=strLetter
            .TypeParagraph
            .TypeParagraph
            .TypeText Text:="Sincerely,"
            .TypeParagraph
            .TypeParagraph
            .TypeText Text:="Northwind Traders"
         End With
         With WordDoc.MailMerge
            ' Only merge records 1-10 from the table.
            .DataSource.FirstRecord = 1
            .DataSource.LastRecord = 10

            ' Merge the data to a new document.
            .Destination = wdSendToNewDocument

            ' Execute the mail merge.
            .Execute

            ' If user specified to print the document, disable
            ' background printing, and then print the merged document.
            If PrintDoc Then
               .Application.Options.PrintBackground = False
               .Application.ActiveDocument.PrintOut
            End If
         End With

         ' Show the instance of Microsoft Word.
         WordApp.Visible = True
      End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>      CreateMergeDoc UseDDE:=False, PrintDoc:=False
</PRE><P>
   Note that Microsoft Word opens with a new mail merge document.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using Automation to open an existing Microsoft
Word 97 mail merge document, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q159328.htm">Q159328</A></B>
   TITLE     : ACC: Using Automation to Run Word 97 Mail Merge from MS
               Access

</PRE></OL>For information about using Automation to run a Microsoft Word 7.0 mail
merge from Microsoft Access 7.0, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q154571.htm">Q154571</A></B>
   TITLE     : ACC95: Running Word Mail Merge from Access Using OLE
               Automation
</PRE> 
<PRE>Keywords          : IntpOlea kbcode kbinterop
Technology        : kbole
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
