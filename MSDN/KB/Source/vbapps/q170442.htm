

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: ActiveX Controls May Not Display Formatted Numeric Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170442">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/06/20">
<META NAME="Keywords" CONTENT="kbcode kbprg kbtool xlvbainfo xldraw">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  TextBox, ComboBox, and ListBox controls do not display data in numeric Formats, for example:   - If you have the date 1/1/97 in cell A1, and you set the LinkedCell    property of a TextBox control to cell A1, the value 35431 appears in the    TextB...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAHP,QBV3,QBVR,QBS0,QAPN,QAHV,QBWS,QAH4,QBV4,QBVP,QBVV P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: ActiveX Controls May Not Display Formatted Numeric Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170442</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
TextBox, ComboBox, and ListBox controls do not display data in numeric
Formats, for example:

<UL><LI>If you have the date 1/1/97 in cell A1, and you set the LinkedCell
   property of a TextBox control to cell A1, the value 35431 appears in the
   TextBox. (This value is the serial value for the date 1/1/97.)

<LI>If you click an item in a ComboBox control that is a date, the ComboBox
   control displays the serial number for that date.

<LI>If you attach a click event macro to a ListBox control, and you click a
   date in the ListBox control, the value property of the ListBox control
   is the serial value for that date.
<P>
</UL><h2>CAUSE</h2>
 
<P>
<P><h3>TextBox Control</h3>
 
<P>
If you create a TextBox control on a worksheet and you set the LinkedCell
property to a cell with a number format, the number format is not used in
the TextBox control.
<P>
<P><h3>ComboBox Control</h3>
 
<P>
If you create a Combo Box control on a worksheet or a UserForm, and you set
the ListFillRange property (for a worksheet) or the RowSource property (for
a UserForm) to a range of cells, the drop-down list uses the number format
in that range, but the selected value does not.
<P>
<P><h3>ListBox Control</h3>
 
<P>
If you create a ListBox control on a UserForm, and you set the RowSource
property of the ListBox control to a range of cells, the items in the
ListBox control use the number formats in that range, but the value
property of the ListBox control does not.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>TextBox Control</h3>
 
<P>
To link a TextBox control to a worksheet cell, use a TextBox control from
the Drawing toolbar instead of the Control Toolbox toolbar.
<P>
ComboBox Control
 
<P>
To use a ComboBox control containing a range of cells on a worksheet, use a
ComboBox control from the Forms toolbar instead of the Control Toolbox
toolbar.
<P>
If you are using a ComboBox control on a UserForm, use a macro for the
Change event to set the Value property of the ComboBox control. The
following example uses a ComboBox control and a macro for the Change event:

<OL><P><LI>Save and close all open workbooks, and then open a new workbook.

<P><LI>On Sheet1, enter the following:
<P>
<P><PRE>      A1: 1/1/97
      A2: 5/1/97
      A3: 10/10/97
</PRE>
<P><LI>Start the Visual Basic Editor.

<P><LI>On the Insert menu, click UserForm.

<P><LI>Add a ComboBox control to the UserForm and set the RowSource property
   to Sheet1!A1:A3.

<P><LI>Double-click the ComboBox control to display the Visual Basic module
   behind the UserForm, and then enter the following code for the Change
   event for the ComboBox:
<P>
<P><PRE>      Private Sub ComboBox1_Change()
</PRE><P>
<PRE>         ComboBox1.Value = Format(ComboBox1.Value, "m/d/yy")

      End Sub

</PRE><P><LI>Run the UserForm and click the arrow on the ComboBox.

<P><LI>Select any date in the list.
<P>
</OL>The selected date is displayed as the current value of the ComboBox
control.
<P>
ListBox Control
 
<P>
If you have a ListBox control on either a UserForm or a worksheet, use a
macro similar to the one for the ComboBox control to display the selected
value for the ListBox control. For example, follow these steps:

<OL><P><LI>Save and close all open workbooks, and then open a new workbook.

<P><LI>On Sheet1, enter the following:
<P>
<P><PRE>      A1: 1/1/97
      A2: 5/1/97
      A3: 10/10/97
</PRE>
<P><LI>Start the Visual Basic Editor.

<P><LI>On the Insert menu, click UserForm.

<P><LI>Add a List Box control to the UserForm and set the RowSource property
   to Sheet1!A1:A3.

<P><LI>Double-click the ListBox control to display the module behind the
   UserForm, and enter the following code for the Click event for the
   ListBox control:
<P>
<P><PRE>      Private Sub ListBox1_Click()
      
<PRE></PRE>         x = Format(ListBox1.Value, "m/d/yy")
         MsgBox x
      
      End Sub

</PRE><P><LI>Run the UserForm and click any date in the ListBox control.
<P>
</OL>The selected date is displayed in a message box.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97 for
Windows. We are researching this problem and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about TextBox, ComboBox, and ListBox controls, click
the Office Assistant, type "controls," click Search, and then click to view
"Add buttons, check boxes, or other controls to a worksheet."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Excel Help is not installed on your
computer, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: XL97<BR>
Keywords          : kbcode kbprg kbtool xlvbainfo xldraw<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
