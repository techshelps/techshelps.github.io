

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Format Function Returns Incorrect Date or Number </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180927">
<META NAME="KBModify" CONTENT="1998/02/16">
<META NAME="KBCreate" CONTENT="1998/02/11">
<META NAME="Keywords" CONTENT="GnrlVB vbwin vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  An incorrect date is returned from the Format function.  CAUSE =====  This problem can occur when the Grouping Symbol in the Regional Settings is set to a period (.).  For example, if your Regional Setting is  German(Standard),  the following line ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNG,QBS0,QAY5,QABA,QAUD,QABB,QAH7,QAB9,QBV8,QDL9,QBXS,QBWQ,QBWO,QBWN,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Format Function Returns Incorrect Date or Number</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180927</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Basic for Applications version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An incorrect date is returned from the Format function.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem can occur when the Grouping Symbol in the Regional Settings is
set to a period (.).
<P>
For example, if your Regional Setting is "German(Standard)," the following
line of code returns 5.30.1985 instead of 1.31.1997 as expected when typed
into the debug window:
<P>
<PRE>   ?Format("31.1.97", "m.d.yyyy")

</PRE>This problem is caused by the way the Format function handles the period
character when formatting. In this case, the Format function simply ignores
the period characters in the value before formatting occurs. In other
words, Visual Basic converts the date 31.1.97 to the Long value 31197, so
you receive the same result as if you typed:
<P>
<PRE>   ?Format(31197, "m.d.yyyy")

</PRE><h2>RESOLUTION</h2>
 
<P>
This problem can be avoided by converting the date to be formatted to a
Date type before it is passed to the Format function. For example, if you
have this statement:
<P>
<PRE>   ?Format("31.1.97", "m.d.yyyy")

</PRE>change it to:
<P>
<PRE>   ?Format(CDate("31.1.97"), "m.d.yyyy")

</PRE>Because the Format function is capable of formatting several data types, it
is a good idea to always pass the value to be formatted as the specific
data type it represents to ensure there is no ambiguity.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Set the Regional Setting in Control Panel to "German(Standard) ."
   NOTE: If you are running Windows 95, you will need to reboot after
   making this change.

<P><LI>Create a new Standard EXE project. Form1 is created by default.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Private Sub Form_Click()
<PRE></PRE>          Debug.Print Format("31.1.97", "m.d.yyyy")
      End Sub

</PRE><P><LI>Run the project and click the form. Note that the incorrect value of
   "5.30.1985" is displayed in the debug window.
</OL> 
<PRE>Keywords          : GnrlVB vbwin vb5all
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
