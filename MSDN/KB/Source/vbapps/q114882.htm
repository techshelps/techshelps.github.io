

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: No Difference Between dbConsistent and dbInconsistent </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114882">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/05/15">
<META NAME="Keywords" CONTENT="kberrmsg kbprg SynFnc RltOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the dbConsistent and dbInconsistent (or DB_CONSISTENT and DB_INCONSISTENT in version 2.0) constants with the OpenRecordset method in code to create a recordset, it a...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAYV,QAKJ,QDN9,QAH4,QBS0,QA5F,QAMA,QBWS,QA7O,QA7N,QA4H,QBXS,QAY5,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: No Difference Between dbConsistent and dbInconsistent</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114882</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the dbConsistent and dbInconsistent (or DB_CONSISTENT and
DB_INCONSISTENT in version 2.0) constants with the OpenRecordset method in
code to create a recordset, it appears not to have any effect on the
editability of the recordset. That is, after creating a recordset using the
dbConsistent constant, you can change fields from the "one" side of a
one-to-many join.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
If you select Enforce Referential Integrity and Cascade Update Related
Fields in the Relationships window for the one-to-many relationship in
question, the difference between dbConsistent and dbInconsistent is
nullified.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you change the relationship so that referential integrity is not
enforced, you can see the difference between the two constants. The
following example demonstrates the difference using the one-to-many
relationship between the Customers and Orders tables in the sample
database Northwind.mdb (or NWIND.MDB in version 2.0). Those tables are
joined on the CustomerID field.
<P>
NOTE: In version 2.0, there is a space in the Customer ID field.
<P>
The following steps demonstrate the difference between the constants by
first opening a recordset using the dbInconsistent constant, changing the
CustomerID, opening the recordset again using the dbConsistent constant,
and then changing the CustomerID again:

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb
   (or NWIND.MDB in version 2.0).

<P><LI>Create a new query and add the Customers and Orders tables.

<P><LI>Drag the CustomerID field from both tables to the query grid. Save
   the query as ConsistentDemo.

<P><LI>Create a new module and enter the following code.
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>      Function ConsistentDemo ()
<PRE></PRE>         Dim rs As Recordset, db As Database
         Set db = CurrentDB()
         Set rs = db.OpenRecordset("ConsistentDemo", dbOpenDynaset,_
         dbInconsistent)
         rs.FindFirst "[Customers].[CustomerID]='ALFKI'"
         rs.Edit
            rs![Customers.CustomerID] = "ALFKJ"
         rs.Update
         rs.FindFirst "[Customers].[CustomerID]='ALFKJ'"
         rs.Edit
            rs![Customers.CustomerID] = "ALFKI"
         rs.Update
         Set rs = db.OpenRecordset("ConsistentDemo", dbOpenDynaset,_
          dbConsistent)
         rs.FindFirst "[Customers].[CustomerID]='ALFKI'"
         rs.Edit
            rs![Customers.CustomerID] = "ALFKJ"
         rs.Update
         rs.FindFirst "[Customers].[CustomerID]='ALFKJ'"
         rs.Edit
            rs![Customers.CustomerID] = "ALFKI"
         rs.Update
         rs.Close
         db.Close
         MsgBox "Test complete."
      End Function

   In Microsoft Access 2.0:

   NOTE: In the following sample code, an underscore (_) is used as a line-
   continuation character. Remove the underscore from the end of the line
   when re-creating this code in Access Basic.

      Function ConsistentDemo ()
         Dim rs As Recordset, db As Database
         Set db = CurrentDB()
         Set rs = db.OpenRecordset("ConsistentDemo", DB_OPEN_DYNASET,_
         DB_INCONSISTENT)
         rs.FindFirst "[Customers].[Customer ID]='ALFKI'"
         rs.Edit
            rs![Customers.Customer ID] = "ALFKJ"
         rs.Update
         rs.FindFirst "[Customers].[Customer ID]='ALFKJ'"
         rs.Edit
            rs![Customers.Customer ID] = "ALFKI"
         rs.Update
         Set rs = db.OpenRecordset("ConsistentDemo", DB_OPEN_DYNASET,_
          DB_CONSISTENT)
         rs.FindFirst "[Customers].[Customer ID]='ALFKI'"
         rs.Edit
            rs![Customers.Customer ID] = "ALFKJ"
         rs.Update
         rs.FindFirst "[Customers].[Customer ID]='ALFKJ'"
         rs.Edit
            rs![Customers.CustomerID] = "ALFKI"
         rs.Update
         rs.Close
         db.Close
         MsgBox "Test complete."
      End Function

</PRE><P><LI>Run the function by typing the following line in the Debug window
   (or Immediate window in version 2.0), and then pressing ENTER:
<P>
<P><PRE>      ? ConsistentDemo()
</PRE><P>
   Note that the code runs without any errors. You are able to change
   data whether the recordset is opened consistently or inconsistently.

<P><LI>Select the Database window, and then click Relationships on the Tools
   menu (or on the Edit menu in version 2.0).

<P><LI>Double-click the join line between the CustomerID fields in the
   Customers and Orders tables.

<P><LI>Click to clear the Enforce Referential Integrity check box, and then
   click OK.

<P><LI>Run the ConsistentDemo() function again by typing the following line
   in the Debug window and then pressing ENTER:
<P>
<P><PRE>      ? ConsistentDemo()
</PRE><P>
   Note that this time you receive the error message:
<P>
<P><PRE>      Field can't be updated
</PRE><P>
   Because referential integrity is not being enforced for the
   relationship, the dbInconsistent constant has the expected effect.
<P>
</OL>NOTE: When you reset the relationship between the Customers and Orders
tables, be sure to select the Cascade Update Related Fields check box in
addition to the Enforce Referential Integrity check box.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using constants with the OpenRecordset method,
search the Help Index for "OpenRecordset method."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: relationships programming<BR>
Keywords          : kberrmsg kbprg SynFnc RltOthr<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
