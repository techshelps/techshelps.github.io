

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Connecting to the First Available Network Drive (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138904">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/10/30">
<META NAME="Keywords" CONTENT="kbprg PgmApi PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  To make a network connection with the Windows application programming interface (API), you can use an unused logical drive letter or a Universal Naming Convention (UNC) name...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBS0,QAY5,QDN9,QAVZ,QAB9,QAI5,QBV8,QA59,QATX,QAC9,QAUD,QAAP,QAB4,QBWG P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Connecting to the First Available Network Drive (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138904</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
To make a network connection with the Windows application programming
interface (API), you can use an unused logical drive letter or a Universal
Naming Convention (UNC) name, such as \\Servername\Sharename. You can call
the Windows API function, GetDriveType(), from a Visual Basic for
Applications module to find the first available drive letter, and then make
a network connection to this available drive.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To find the first free drive and make a network connection, follow these
steps:

<OL><P><LI>Create a module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
      Declare Function GetDriveType Lib "kernel32" Alias "GetDriveTypeA" _
<PRE></PRE>          (ByVal nDrive As String) As Long
      Declare Function WNetAddConnection Lib "mpr.dll" Alias _
          "WNetAddConnectionA" (ByVal lpszNetPath As String, _
          ByVal lpszPassword As String, ByVal lpszLocalName _
          As String) As Long

</PRE><P><LI>Type the following procedure:
<P>
<P><PRE>      Public Function FreeDrive(MyShareName$, MyPWD$) As Integer
<PRE></PRE>         On Local Error GoTo FreeDrive_Err
         Dim DriveNum As Long, FirstFreeDrive As String
         Dim FirstDrive As Long, Results As Long
         DriveNum = 2
         Do
            DriveNum = DriveNum + 1
            FirstFreeDrive = Chr$(DriveNum + 65) + ":\"
            FirstDrive = GetDriveType(FirstFreeDrive)
         Loop Until FirstDrive = 1
         FirstFreeDrive = Left(FirstFreeDrive, 2)
         FreeDrive = WNetAddConnection(MyShareName$, MyPWD$, _
          FirstFreeDrive)
      FreeDrive_End:
         Exit Function
      FreeDrive_Err:
         FreeDrive = Err
         MsgBox Error$
         Resume FreeDrive_End
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER
<P>
<P><PRE>      ?FreeDrive(&lt;"\\servername\sharename"&gt;, &lt;"MyPwd"&gt;)
</PRE><P>
   where &lt;\\servername\sharename&gt; is a valid server and sharename in your
   network organization and &lt;MyPwd&gt; is your password that provides
   permission to the resource.
<P>
   NOTE: Some of the possible return values for the FreeDrive function
   include WN_SUCCESS, WN_NET_ERROR, and WN_BAD_PASSWORD. Other run-time
   errors could be returned from the function; therefore, error trapping
   should be implemented to handle any problems.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about declaring API functions, search for "Declare,"
and then "Declare Statement" using the Microsoft Access 97 Help Index.
<P>
For information about connecting to a network drive in Microsoft Access
1.x and 2.0, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q90861.htm">Q90861</A></B>
   TITLE     : ACC: Connecting to the First Available Network Drive
</PRE></OL> 
<PRE>Keywords          : kbprg PgmApi PgmHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
