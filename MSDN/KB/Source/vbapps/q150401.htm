

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Exporting Right-Aligned Fields to a Text File (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150401">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/04/29">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates two methods of creating a fixed-width text file that enables fields to be either left or right aligned (justified).  This article assumes that you are f...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA7N,QA7O,QA3P,QA1S,QBTI,QBWS,QAMB,QADF,QATX,QDN9,QAUR,QAY5,QBS0,QBJC P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Exporting Right-Aligned Fields to a Text File (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150401</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates two methods of creating a fixed-width text
file that enables fields to be either left or right aligned (justified).
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1</h3>
 
<P>
The following steps demonstrate how to use a query to create a fixed-width
text file using the Orders table in Northwind.mdb. The CustomerID field
will be left-justified while the OrderDate and Freight fields will be
right-justified.

<OL><P><LI>Open the sample database Northwind.mdb, and create a new query based on
   the Orders Table.

<P><LI>Create the following three fields in the query:
<P>
<P><PRE>      Field: CustomerID
</PRE><P>
<P><PRE>      Field: Expr1: Space(12-Len(Format([OrderDate],"Short Date"))) &amp;
<PRE></PRE>                                       Format([OrderDate],"Short Date")

      Field: Expr2: Space(15-Len(Format([Freight],"Currency"))) &amp;
                                        Format([Freight],"Currency")

   NOTE: The Space() function is used to pad spaces at the beginning of
   the field. The numbers 12 and 15 at the start of the Space() function
   indicate the desired total width of that field in the text file. These
   numbers will be used again in Step 10.

</PRE><P><LI>Run the query. Note that the fields may not appear to be right-
   justified unless you are using a fixed-width font such as Courier. You
   can ignore this because it does not affect the text file. Save the
   query as Right Justify Orders.

<P><LI>On the File menu, click Save As/Export. In the Save As box, click to
   select "To an external File or Database," and then click OK.

<P><LI>In the Save In box, under Save As Type box, Select "Text Files."
   Type "Orders.txt" (without the quotation marks) in the File Name box,
   and then click Export. This will invoke the Text Export Wizard.

<P><LI>Select "Fixed Width" and click Advanced. This displays the Export
   Specification dialog box.

<P><LI>In the Field information table of the Export Specification dialog box,
   type the Field Name, Start, and Width for each field as follows:
<P>
<PRE>      Field Name   Start   Width
      ----------   -----   -----
      CustomerID     1       10
      Expr1         11       12
      Expr2         23       15

</PRE><P><LI>Click Save As to save the specification as Right Justify Orders.

<P><LI>Click OK to return to the Text Export Wizard, and click Finish to
   create the text file. Open the Orders.txt file in NotePad. Note that
   the CustomerID field is left-justified while the OrderDate and Freight
   fields are right-justified.
<P>
</OL><h3>Method 2</h3>
 
<P>
The following sample function, CreateTextFile(), creates a fixed-width
text file using the Orders table in Northwind.mdb. The CustomerID field
will be left-justified while the OrderDate and Freight fields will be
right-justified.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a new module.

<P><LI>Type the following function:
<P>
<P><PRE>      Public Function CreateTextFile()
</PRE><P>
<P><PRE>      'This function creates a fixed-width text file using the Orders table
      'in Northwind.mdb. The CustomerID field will be left-justified
      'while the OrderDate and Freight fields will be right-justified.
</PRE><P>
<P><PRE>       Dim strCustomerId As String * 10 'specifies width of 10 characters
       Dim strOrderDate As String * 12  'specifies width of 12 characters
<PRE></PRE>       Dim strFreight As String * 15    'specifies width of 15 characters
       Dim mydb As Database,  myset As Recordset
       Dim intFile As Integer

       Set mydb = CurrentDb()
       Set myset = mydb.OpenRecordset("Orders", dbOpenTable)

       myset.Index = "PrimaryKey" 'Orders table must have primary key.
       intFile = FreeFile

       Open "C:\My Documents\Orders.txt" For Output As intFile

       'The following section is optional. Remove the comment (') from
       'these lines if you want to put field names in the first row of
       'the text file.

       'LSet strCustomerId = "CustomerID"
       'RSet strOrderDate = "OrderDate"
       'RSet strFreight = "Freight"
       'Print #intFile, strCustomerId &amp; strOrderDate &amp; strFreight

       'This section puts the records from the Orders table in the text
       'file.
        myset.MoveFirst
        Do Until myset.EOF
            LSet strCustomerId = myset![CustomerID] 'Field name in brackets
            RSet strOrderDate = Format(myset![OrderDate], "Short Date")
            RSet strFreight = Format(myset![Freight], "Currency")
            'Concatenate all of the variables together as in the following:
            Print #intFile, strCustomerId &amp; strOrderDate &amp; strFreight
            myset.MoveNext
        Loop

        Close intFile
        myset.Close
        mydb.Close

        MsgBox "Text file has been created!"

        End Function

</PRE><P><LI>Press CTRL+G to open the Debug window, type the following line, and
   then press ENTER to run the function:
<P>
<P><PRE>      ? CreateTextFile()
</PRE>
<P><LI>Open the Orders.txt file in NotePad. Note that the CustomerID field is
   left-justified while the OrderDate and Freight fields are right-
   justified.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For an example of this information for Microsoft Access versions 1.x and
2.0, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q148444.htm">Q148444</A></B>
   TITLE:      ACC: Exporting Right-Aligned Fields to a Text File(1.x,
               2.0)

</PRE></OL>For more information about programmatically writing data to files,
search the Help Index for "Open statement" or ask the Microsoft Access
97 Office Assistant.
<P>
For more information and an alternative solution to right-justify number
fields only, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q98663.htm">Q98663</A></B>
   TITLE     : ACC: Exporting to Fixed-Width Text File Left-Aligns
               Numbers
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: align right justify open statement<BR>
Keywords          : kbprg PgmHowTo PgmObj<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
