

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Procedure to Export Text File with Comma AND Quote Delimiter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123183">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/11/23">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto PgmFilem PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Microsoft Excel does not have a menu command to automatically export data  to a text file so that the text file is exported with both quotation marks  and commas as delimiters. For example, there is no command to automatically  create a text file t...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBRZ,QA3P,QAH4,QBS0,QBJZ,QBWS,QBQU,QAB9,QA50,QAOX,QBBL,QAVZ,QAPF,QAAP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Procedure to Export Text File with Comma AND Quote Delimiter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123183</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for the Macintosh, version 5.0
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel does not have a menu command to automatically export data 
to a text file so that the text file is exported with both quotation marks 
and commas as delimiters. For example, there is no command to automatically 
create a text file that contains the following:
<P>
<PRE>   "Text1","Text2","Text3"

</PRE>However, you can create this functionality in Microsoft Excel by using a 
Microsoft Visual Basic for Applications procedure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>You can use the Print # statement in a Visual Basic procedure similar to
the following to export a text file with both quotation marks and commas as
the delimiters. For the procedure to function properly, you must select the
cells that contain your data before you run it.
<P>
Before working with the example below, perform the following steps:

<OL><P><LI>Open a new workbook.

<P><LI>Insert a new module sheet. In Excel 97 and Excel 98, on the Tools menu,
   point to Macro, and then click Visual Basic Editor. In the Editor, on 
   the Insert menu, click Module. In Microsoft Excel versions 5.0 and 7.0,
   on the Insert menu, point to Macro, and click Module.

<P><LI>Type the example macro code into the module sheet:
<P>
<PRE>      Sub QuoteCommaExport()
         ' Dimension all variables.
         Dim DestFile As String
         Dim FileNum As Integer
         Dim ColumnCount As Integer
         Dim RowCount As Integer

         ' Prompt user for destination file name.
         DestFile = InputBox("Enter the destination filename" _
            &amp; Chr(10) &amp; "(with complete path):", "Quote-Comma Exporter")

         ' Obtain next free file handle number.
         FileNum = FreeFile()

         ' Turn error checking off.
         On Error Resume Next

         ' Attempt to open destination file for output.
         Open DestFile For Output As #FileNum

         ' If an error occurs report it and end.
         If Err &lt;&gt; 0 Then
            MsgBox "Cannot open filename " &amp; DestFile
            End
         End If

         ' Turn error checking on.
         On Error GoTo 0

         ' Loop for each row in selection.
         For RowCount = 1 To Selection.Rows.Count

            ' Loop for each column in selection.
            For ColumnCount = 1 To Selection.Columns.Count

               ' Write current cell's text to file with quotation marks.
               Print #FileNum, """" &amp; Selection.Cells(RowCount, _
                  ColumnCount).Text &amp; """";

               ' Check if cell is in last column.
               If ColumnCount = Selection.Columns.Count Then
                  ' If so, then write a blank line.
                  Print #FileNum,
               Else
                  ' Otherwise, write a comma.
                  Print #FileNum, ",";
               End If
            ' Start next iteration of ColumnCount loop.
            Next ColumnCount
         ' Start next iteration of RowCount loop.
         Next RowCount

         ' Close destination file.
         Close #FileNum
      End Sub

</PRE><P><LI>Before running the macro, select the data you want to export then run 
   the QuoteCommaExport subroutine.
<P>
</OL>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q103985.htm">Q103985</A></B>
   TITLE     : XL4: Macro to Export Text File with Comma AND Quote
               Delimiters
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 5.00 5.00c quotes csv save numbers<BR>
Keywords          : kbcode kbprg xlvbahowto PgmFilem PgmHowto<BR>
Version           : WINDOWS: 5.0, 5.0c, 7.0, 97; MACINTOSH: 5.0, 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
