

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WD: ErrMsg Using Mid$(), Left$() or Right$() Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110164">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1994/01/13">
<META NAME="Keywords" CONTENT="kberrmsg kbmacro winword macword word7 word95">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the Mid$(), Right$() or Left$() functions, you may receive the following error message:     WordBasic error #24  Bad parameter   CAUSE =====  WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft p...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAIH,QATX,QAB4,QAIJ,QAUD,QAIV,QAG8,QAH4,QAPF,QAFF,QAE8,QA01,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: ErrMsg Using Mid$(), Left$() or Right$() Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110164</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the Mid$(), Right$() or Left$() functions, you may receive
the following error message:
<P>
<PRE>   WordBasic error #24 "Bad parameter"

</PRE><h2>CAUSE</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code 'as is' without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
This problem occurs when the count or length parameter for the statement is
negative.
<P>
NOTE: In Word 2.0 for Windows, a negative value in the count parameter of
the Mid$(), Right$() or Left$() functions is ignored and does not generate
an error.
<P>
The Mid$() statement returns a portion of a text string starting at a given
character position. The syntax for the command is
<P>
<PRE>   Mid$(&lt;source$&gt;, &lt;start&gt; [, &lt;count&gt;])

</PRE>where &lt;source$&gt; is the text string, &lt;start&gt; is the character
position from which to start, and &lt;count&gt; is the number of characters to
return. If no &lt;count&gt; parameter is specified, or if there are fewer than
&lt;count&gt; characters in the text, the function returns all the characters
from the &lt;start&gt; position to the end of the string.
<P>
The following sample macro illustrates the error message described in the
"Symptoms" section of this article:
<P>
<PRE>   Sub MAIN
      ReturnText$ = Mid$("hello", 1, -1)
      MsgBox ReturnText$
   End Sub

</PRE>The following sample macro returns the error because the length of Test$
minus one is a negative number (0 - 1 = -1):
<P>
<PRE>   Sub MAIN
      Test$ = ""
      Rem Empty string, could be passed as an empty dialog variable for
      Rem example.
      ReturnText$ = Right$(Test$, Len(Test$) - 1)
   End Sub

</PRE>NOTE: Word version 2.0 for Windows ignores a -1 value for the &lt;count&gt;
parameter. So in Word 2.0 all the characters from the first character
position to the end of the string are displayed in the message box. In the
first example, the string "hello" is displayed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To keep this error from ocurring, first test the length of the string.
<P>
For example:
<P>
<PRE>   Sub Main
      ' Empty string, could be passed as an empty dialog
      ' variable, for example.
      Test$ = ""
      ' Test the length of the string to ensure
      ' that subtracting 1 from the length leaves
      ' at least 1 character.
      If Len(Test$) - 1 &gt; 0 then
         ReturnText$ = Mid$(Test$, Len(Test$) - 1)
      End If
   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
Word Developer's Kit, version 6.0, page 594
Word Developer's Kit, Third Edition, page 660
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: <BR>
Keywords          : kberrmsg kbmacro winword macword word7 word95<BR>
Version           : 2.x 6.0 6.0a 6.0c 7.0 7.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
