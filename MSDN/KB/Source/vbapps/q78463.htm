

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Removing Chart Links to a Worksheet in a Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q78463 ">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1991/11/18">
<META NAME="Keywords" CONTENT="kbmacro kbprg PgmHowTo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  A chart may be made independent of a worksheet by using a Microsoft Excel macro to convert any links to the worksheet to values.  MORE INFORMATION  To convert a series formula to values manually, activate the formula bar by pressing F2 and then pre...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAB9,QBWS,QAUD,QAH6,QBS0,QAA7,QBXS,QA2Q,QAKD,QDNX,QAG2,QAKJ,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Removing Chart Links to a Worksheet in a Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q78463 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows versions 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A chart may be made independent of a worksheet by using a Microsoft Excel
macro to convert any links to the worksheet to values.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To convert a series formula to values manually, activate the formula bar by
pressing F2 and then press F9 to convert the formula to values. To
accomplish this from a macro, use the SEND.KEYS command. This must be done
for each series formula in the chart.
<P>
Because keystrokes sent with the SEND.KEYS command are typically not
executed until a dialog box is displayed or a RETURN is executed,
attempting to send keystrokes in a looping structure does not work
properly. The following macro simulates a loop and works properly because
the RETURN statement is executed after each SEND.KEYS statement. Note that
the macro may not run properly if you attempt to step through it.
<P>
<P><h3>Example</h3>
 

<OL><P><LI>Enter the following into a macro sheet:
<P>
<P><PRE>      A1: ConvertLinks
      A2: i=0
      A3: i=i+1
      A4: =SELECT("S"&amp;i)
      A5: =SEND.KEYS("{F2}{F9}~")
      A6: =IF(i&lt;GET.DOCUMENT(11),ON.TIME(NOW()+"00:00:01","R3C1"))
      A7: =RETURN()
</PRE>
<P><LI>Define the macro by selecting cell A1 and choosing Define Name from
   the Formula menu. Select the Command option and choose OK.

<P><LI>To run the macro, activate any chart and choose Run from the Macro
   menu. Select ConvertLinks from the list of macros and choose OK.
<P>
</OL>The macro works by setting a counter "i" to zero. This counter is used
to select each individual series in the chart and is incremented each
time the macro is run. The SEND.KEYS command converts the links to
values. The IF statement tests to see whether all series formulas have
been converted by comparing the current value of "i" to the number of
series in the chart. If not, the current macro ends but is started
again in one second.
<P>
For more information on this topic, query on:
<P>
<PRE>   on.time and send.keys and excel

</PRE></OL>For an article that describes this same subject using Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q124232.htm">Q124232</A></B>
   TITLE     : XL5: Visual Basic Macro to Break Chart Links

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 3.0, pages 2, 64, 159, 217
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 3.0 4.0 4.00 5.0 5.00 break breaking<BR>
Keywords          : kbmacro kbprg PgmHowTo PgmOthr<BR>
Version           : 3.00 4.00 5.00 | 3.00<BR>
Platform          : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
