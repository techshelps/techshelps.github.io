

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SendKeys Statement Doesn't Affect NUM LOCK Key State </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133327">
<META NAME="KBModify" CONTENT="1997/07/29">
<META NAME="KBCreate" CONTENT="1995/07/30">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the SendKeys statement with the {NUMLOCK} key code in a Visual Basic, Applications Edition, procedure to send the NUM LOCK key, the NUM LOCK key state is not affected.  Note that when you use the SendKeys statement to send the NUM LOCK...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QABT,QALS,QAA8,QAB9,QAPN,QBJC,QAK7,QAJ6,QAL3,QAVX,QAVW,QAH4,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SendKeys Statement Doesn't Affect NUM LOCK Key State</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133327</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Programming System, Applications Edition,
   version 1.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Project for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SendKeys statement with the {NUMLOCK} key code in a Visual
Basic, Applications Edition, procedure to send the NUM LOCK key, the NUM
LOCK key state is not affected.
<P>
Note that when you use the SendKeys statement to send the NUM LOCK key,
while Microsoft Excel or Microsoft Project is the active application, the
word NUM on the status bar is toggled (either appears or disappears).
However, the NUM LOCK light on your keyboard (which indicates the state of
the NUM LOCK key) does not change.
<P>
The expected behavior is for the SendKeys command to turn NUM LOCK off at
the start of the SendKeys command, the {NUMLOCK} key code in the SendKeys
command to toggle the NUM LOCK state, and the NUM LOCK state to be restored
to its original state after the SendKeys command is finished.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In Microsoft Excel, you can use the SendKeys method to work around this
behavior, as in the following example:
<P>
<PRE>   Sub Test()
      Application.SendKeys "{NUMLOCK}This is a test of the NUM LOCK key"
   End Sub

</PRE>When you run this procedure while a worksheet is active in Microsoft
Excel, NUM LOCK is turned off (if it is currently on), the NUM LOCK state
in the application is toggled (although the NUM LOCK light does not
change), the text is entered on the worksheet, and NUM LOCK is returned to
its initial state.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When NUM LOCK is on, the numbers and mathematical symbols that appear on
the numeric keypad will be entered into the worksheet when you press the
keys. When NUM LOCK is off, the keypad is mapped to arrows (2,4,6,8)
arithmetic functions (=,/,*,-,+,), and the function keys HOME (7), END (1),
PgUp (9) , and PgDn (3).
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the SendKeys Statement or the SendKeys Method,
choose the Search button in the Visual Basic Reference and type:
<P>
<PRE>   SendKeys
</PRE> 
<PRE>Keywords          : kbcode kbprg
Version           : 1.00
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
