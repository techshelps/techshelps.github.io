

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Error Running Macro with Reference to XLODBC.XLA File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151544">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/05/24">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a procedure from a module that contains a reference to the Xlodbc.xla file, you may receive the following error message:       Attempt to register Xlodbc32.dll failed.  In Microsoft Excel 97, you may receive this error as soon as you o...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QBJZ,QAAP,QBWS,QBS0,QAB3,QAH4,QAJQ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Error Running Macro with Reference to XLODBC.XLA File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151544</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
SYMPTOMS
 
<P>
When you run a procedure from a module that contains a reference to the
Xlodbc.xla file, you may receive the following error message:
<P>
<PRE>     Attempt to register Xlodbc32.dll failed.

</PRE>In Microsoft Excel 97, you may receive this error as soon as you open the
workbook that contains a reference to Xlodbc.xla.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This error occurs when all of the following are true:

<UL><LI>Both Microsoft Excel version 5.0 and Microsoft Excel version 7.0 or
   97 are installed in separate folders on the same computer.
<P>
<P><PRE>    -and-
</PRE>
<LI>A file created in Microsoft Excel version 5.0 contains a Visual
   Basic for Applications procedure calling SQL functions from a module
   with a reference to the Microsoft Excel version 5.0 file Xlodbc.xla.
<P>
<P><PRE>    -and-
</PRE>
<LI>The procedure is being run from Microsoft Excel version 7.0 or
   Microsoft Excel 97 on the same computer where Microsoft Excel 5.0
   is installed.
<P>
</UL>The error message, "Attempt to register XLODBC.DLL failed." may also occur
if a procedure with a reference to Xlodbc.xla created in Microsoft Excel
version 7.0 or 97 is run from Microsoft Excel version 5.0 on the same
computer.
<P>
CAUSE
 
<P>
When you establish a reference to another workbook or library, Microsoft
Excel hard-codes the path of the file when the reference is established.
The error occurs because the path to the Xlodbc.xla file is still valid,
and Microsoft Excel attempts to open the incorrect Xlodbc.xla file.
<P>
The error does not occur if only one version of Microsoft Excel is
installed on the computer. Instead, if the file cannot be found, you may
receive the following error message:
<P>
<PRE>     Can't find project or library.

</PRE>See articles referenced later in this article for more information about
this error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Microsoft Excel 7.0</h3>
 
With your module sheet active, click References on the Tools menu, click to
clear the current reference, and use the Browse option to establish a new
reference to the correct Xlodbc.xla file. After establishing the correct
reference, save and close the file, and then restart Microsoft Excel.
<P>
<P><h3>Microsoft Excel 97</h3>
 
Press ALT+F11 to activate Visual Basic Editor. Click References on the
Tools menu, click to clear the current reference, and use the Browse option
to establish a new reference to the correct Xlodbc.xla file. Click Close
and Return to Microsoft Excel on the File menu. Save and close the file,
and then restart Microsoft Excel.
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q124277.htm">Q124277</A></B>
   TITLE     : XL5 Err Msg: "Can't Find Project or Library" Running
               Macro

   ARTICLE-ID: <B><A HREF="../vbapps/Q131298.htm">Q131298</A></B>
   TITLE     : XL5 How to Avoid the Error "Can't Find Project or
               Library"

</PRE>REFERENCES
 
<P>
"Visual Basic User's Guide," version 5.0, chapter 4, "Organizing Procedures
and Modules in Workbooks"
<P>
For more information about calling procedures in other workbooks, click
Microsoft Excel Help Topics on the Help Menu, click the Index tab and type:
<P>
<PRE>    Calling procedures
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a 8.00 97<BR>
Keywords          : kberrmsg kbprg<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
