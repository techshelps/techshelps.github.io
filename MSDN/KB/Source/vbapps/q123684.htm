

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Workbook File Size Increases While Editing Procedure </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123684">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/12/06">
<META NAME="Keywords" CONTENT="kbprg OptMemMgt OptPrfm PgmVbl">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you edit a Microsoft Visual Basic for Applications  procedure in a workbook and then save the workbook, the workbook file size  increases even if you delete code from the procedure.  Similarly, if you save a Visual Basic mo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVP,QBS0,QBRZ,QBJZ,QAUR,QA26,QA5F,QAMA,QAYL,QBXS,QAY2,QAB9,QAU7,QBCT P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Workbook File Size Increases While Editing Procedure</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123684</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for Windows 95. Versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you edit a Microsoft Visual Basic for Applications 
procedure in a workbook and then save the workbook, the workbook file size 
increases even if you delete code from the procedure.
<P>
Similarly, if you save a Visual Basic module sheet to the Basic Code (Text) 
file format, and you delete the original module sheet and then import the 
text file into a new module in the same workbook, the workbook decreases in 
file size when you save it.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs because the variables that you use in a procedure are 
stored in the module that contains the procedure. When you enter a variable 
name in a Visual Basic module, whether you use the Dim statement to 
dimension the variable or not, the name is stored in a name table. The disk 
space used for the variable in the name table is not freed until the module 
that contains the procedure is deleted. Because of this behavior, a 
workbook increases in file size when you add new variables to a procedure 
in the workbook, and does not decrease in file size when you delete 
variables from a procedure in the workbook.
<P>
A workbook also increases in file size when a procedure contained in the 
workbook is compiled.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q116392.htm">Q116392</A></B>
   TITLE     : Cannot Modify a Visual Basic Procedure in Break Mode

</PRE><h2>WORKAROUNDS</h2>
 
<P>
To work around this behavior, you can save your Visual Basic module to the 
Basic Code (Text) file format, delete the original module, and then insert 
the text file into a new module in your workbook by doing the following:

<OL><P><LI>Select the module sheet that contains the procedure that you have  been
   editing.

<P><LI>From the File Menu, choose Save As. In the File Name box, type "Test"
   (without the quotation marks). From the Save File As Type list, select
   Basic Code (Text) and choose OK.

<P><LI>Choose OK in the dialog box that appears with the message "Selected file
   type will save only the active sheet."

<P><LI>From the Edit menu, choose Delete Sheet. Choose Yes in the dialog box
   that appears telling you that the selected sheet will be permanently
   deleted.

<P><LI>From the Insert menu, choose Macro, and then choose Module to create a
   new module sheet.

<P><LI>From the Insert menu, choose File. From the File Name list, select the
   file that you saved in Step 2 above, TEST.TXT.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a clean dirty<BR>
Keywords          : kbprg OptMemMgt OptPrfm PgmVbl<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a; MACINTOSH:5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
