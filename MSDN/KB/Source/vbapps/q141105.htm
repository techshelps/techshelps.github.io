

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC95: Cannot Export Run-Time Font Style Changes to RTF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141105">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/11">
<META NAME="Keywords" CONTENT="IntpOthr kbinterop PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you conditionally set the font styles for a report's controls using a section's OnFormat property, the changes are lost when you choose the Save As/Export command to save th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTI,QDMF,QBJZ,QA3P,QBWS,QA7O,QAPN,QAUR,QANY,QAB5,QAMN,QBXS,QAOE,QA1S,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Cannot Export Run-Time Font Style Changes to RTF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141105</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you conditionally set the font styles for a report's controls using a
section's OnFormat property, the changes are lost when you choose the
Save As/Export command to save the report as a Rich Text Format (RFT) file.
For example, if you change a control's FontUnderline, FontItalics, or
FontWeight property at run time, the change does not appear when you output
the report to an RTF file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, you can use the following steps to stack two
bound controls (one with font styles and one without font styles) on each
other and set the Visible property to specify which control is displayed
at run time:

<OL><P><LI>Open the sample database Northwind.mdb, and make a copy of the Employee
   Sales By Country report. Name it Rtf_Fix.

<P><LI>Open the Rtf_Fix report in Design view. If the field list is not
   displayed, click Field List on the View menu. Drag the SaleAmount field
   from the field list so that it is on top of the existing SaleAmount
   control in the detail section. Change the Name property of the control
   to Rtf_Sale.

<P><LI>Delete the label associated with the Rtf_Sale control, and then set the
   following properties for the Rtf_Sale control:
<P>
<P><PRE>      Format: Currency
      BorderStyle: Transparent
      FontUnderline: Yes
</PRE><P>
   NOTE: This example sets only the FontUnderline property. To set the
   FontItalics or FontWeight property, you would need to set those
   properties also.

<P><LI>Set the detail section's OnFormat property to the following event
   procedure:
<P>
<P><PRE>      Private Sub Detail_Format (Cancel as Integer, FormatCount as _
<PRE></PRE>             Integer)
       If Me!SalespersonTotal &gt; 5000 Then
          Me!RTF_Sale.visible = True
          Me!SaleAmount.visible = False
       Else
          Me!RTF_Sale.visible = False
          Me!SaleAmount.visible = True
       End If
      End Sub

</PRE><P><LI>On the File menu, click Print Preview. When you are prompted for a
   beginning and ending date, enter 01/01/95 and 01/20/95, respectively.
   Note that the sales amounts for which the total sales is greater than
   $5,000 are underlined.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click to select "To an external File or
   Database," and then click OK.

<P><LI>In the Save Table dialog box, under Save As Type, select Rich Text
   Format (*.rtf), and then click Export.

<P><LI>Open the Rtf_Fix.Rtf file in a word processor (such as Microsoft Word
   for Windows) that supports the RTF format. Note that the sales amounts
   for which the total sales is greater than $5,000 are underlined.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
When Microsoft Access outputs data to an RTF file, it uses the first data
record to determine the format for that section. If a control in the first
record is underlined, that control is underlined for all subsequent records
in the RTF file. Microsoft Access ignores any format changes after the
first record.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Make a copy of the Employee Sales By Country report and name it
   Rtf_Test.

<P><LI>Open the Rtf_Test report in Design view.

<P><LI>Set the detail section's OnFormat property to the following event
   procedure:
<P>
<P><PRE>      Private Sub Detail_Format (Cancel as Integer, FormatCount as Integer)
      If Me!SalespersonTotal &gt;5000 Then
<PRE></PRE>        Me!SaleAmount.FontUnderline = True
      Else
        Me!SaleAmount.FontUnderline = False
      End If
      End Sub

</PRE><P><LI>On the File menu, click Print Preview. When you are prompted for a
   beginning and ending date, enter 01/01/95 and 01/20/95, respectively.
   Note that sales amounts for which the sales total is greater than
   $5,000 are underlined.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click to select "To an external File or
   Database," and then click OK.

<P><LI>In the Save Table dialog box, under Save As Type, select Rich Text
   Format (*.rtf), and then click Export.

<P><LI>Open Rtf_Test.RTF in a word processor (such as Microsoft Word for
   Windows) that supports the RTF format. Note that the sales amounts
   are not underlined.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Save As/Export option, search on the phrase
"exporting data to another file format" using the Microsoft Access 7.0
Help Index.
 
<PRE>Keywords          : IntpOthr kbinterop PgmHowTo
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
