

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Get the Unread Message Count from an Outlook Folder </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171603">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1997/07/17">
<META NAME="Keywords" CONTENT="vb5all vb5howto vbwin GnrlVb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The following code sample demonstrates how to determine the count of all unread messages on a per folder basis for all folders grouped under a specified Microsoft Outlook folder. The sample assumes that the Microsoft Outlook mail client is installe...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QAYC,QBS0,QAH4,QAFI,QBUP,QAPN,QAEV,QAFF,QAVX,QAMA,QAG8,QAGI,QBWS,QBQO P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Get the Unread Message Count from an Outlook Folder</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171603</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Outlook 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following code sample demonstrates how to determine the count of all
unread messages on a per folder basis for all folders grouped under a
specified Microsoft Outlook folder. The sample assumes that the Microsoft
Outlook mail client is installed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code below uses a recursive routine to iterate through a mail folder
to produce a list of all its sub-folders and a count of corresponding
unread messages. The data is then displayed in the Visual Basic Immediate
Window. The code takes advantage of the UnReadItemCount property of the
Outlook MAPIFolder object.

<OL><P><LI>Open a Standard EXE project in Visual Basic.

<P><LI>Select References and the Project menu. Select "Microsoft Outlook 8.0
   Object Library" (msoutl8.olb) and click OK.

<P><LI>Select Project1 Properties on the Project menu and set the Startup
   Object to "Sub Main".

<P><LI>Add a Module to the project.

<P><LI>Add the sample code below to Module1.
<P>
   NOTE: Modify the FOLDER_TO_OPEN constant as appropriate.

<P><LI>Run the program. The unread message count for the folder FOLDER_TO_OPEN
   is displayed in the Immediate Window.
<P>
</OL><h3>SAMPLE CODE</h3>
 
<P>
Option Explicit
<P>
<PRE>Private Sub Main()
   Dim olMAPI As Outlook.NameSpace
   Dim Folder As Outlook.MAPIFolder
   Const FOLDER_TO_OPEN = "Mailbox - John Doe"   'Modify as appropriate

   Set olMAPI = GetObject("", "Outlook.Application").GetNamespace("MAPI")
   Call PrintFolderNames(olMAPI.Folders(FOLDER_TO_OPEN), "-&gt;")
   Set olMAPI = Nothing
End Sub

Sub PrintFolderNames(tempfolder As Outlook.MAPIFolder, a$)
   Dim i As Integer
   If tempfolder.Folders.Count Then
      Debug.Print a$ &amp; " " &amp; tempfolder.Name &amp; "  ";
      Debug.Print tempfolder.UnReadItemCount
      For i = 1 To tempfolder.Folders.Count
        Call PrintFolderNames(tempfolder.Folders(i), a$ &amp; "-&gt;")
      Next i
   Else
      Debug.Print a$ &amp; " " &amp; tempfolder.Name &amp; "  ";
      Debug.Print tempfolder.UnReadItemCount
   End If
End Sub
</PRE></OL> 
<PRE>Keywords          : vb5all vb5howto vbwin GnrlVb kbprg
Technology        : kbvba
Version           : WINDOWS:5.0 97
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
