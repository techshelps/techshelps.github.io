

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Unable to Show UserForms in Other Projects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157313">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/10/09">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  There is no way to directly show a UserForm that is contained in another Visual Basic for Applications project.  RESOLUTION  If you want to show a UserForm that is contained in another project you must either:   - Import the UserForm from the other...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAJN,QBS0,QBJZ,QBWS,QAHT,QA3P,QABI,QAG0,QA2Q,QAUJ,QAGI,QAFF,QAG2,QBVP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Unable to Show UserForms in Other Projects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157313</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
There is no way to directly show a UserForm that is contained in another
Visual Basic for Applications project.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want to show a UserForm that is contained in another project you
must either:

<UL><LI>Import the UserForm from the other project.
<P>
   -or-

<LI>Reference the other project and call a subroutine (which shows the
   UserForm) in the other project.
<P>
</UL><h3>Importing a UserForm from another project</h3>
 

<OL><P><LI>In the Project Explorer window, select the Project containing the
   UserForm you want to export.

<P><LI>In the Project Explorer window, select the UserForm you are going to
   export.

<P><LI>If the name of your UserForm is the same as that of any UserForm in
   the project that is going to import your UserForm, change the name of
   your UserForm to something unique.

<P><LI>On the File menu, click Export File.

<P><LI>In the Export File dialog box, select a destination folder for the
   .frm file, give your file a name, and then click Save.

<P><LI>In the Project Explorer window, select the Project that is going to
   import the UserForm you saved in Step 5.

<P><LI>On the File menu, click Import File.

<P><LI>Locate and select the file you saved in Step 5, then click Open.
<P>
</OL>Now that the UserForm is part of the project, you are able to show it
without error.
<P>
NOTE: If you want any macro code that is associated with the UserForm to
also be imported with the UserForm, make sure this code is contained on the
UserForm's code module and not simply on a module sheet inserted into the
project.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Referencing Another Project</h3>
 
<P>
In this example, the two projects in question will be VBAProject1 and
VBAProject2. VBAProject1 is the project that contains your macro code from
which you want to display the UserForm in VBAProject2. With this
workaround, both UserForms can have the same name because the .Show method
will always show the UserForm in the current project.
<P>
NOTE: In order to create a reference from VBAProject1 to VBAProject2, the
file containing VBAProject2 must be a saved workbook.

<OL><P><LI>Make sure the name of each of the two projects in question have
   different names (as shown in the Properties window for each project).

<P><LI>In the Project Explorer window, select VBAProject1.

<P><LI>On the Tools menu, click References.

<P><LI>In the "References - VBAProject1" dialog box, click the checkbox for
   VBAProject2 and then click OK.

<P><LI>In a module sheet in VBAProject1, enter the following code:
<P>
<PRE>      Sub Test1()

          Test2 'call the subroutine in VBAProject2

      End Sub

</PRE><P><LI>In a module sheet in VBAProject2, enter the following code:
<P>
<PRE>      Sub Test2()

          UserForm1.Show

      End Sub

</PRE><P><LI>Run the "Test1" macro in VBAProject1.
<P>
</OL>The UserForm in VBAProject2 will be displayed.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Show Method for UserForms, do the following:

<OL><P><LI>Insert a UserForm into your project.

<P><LI>Click Code on the View menu.

<P><LI>On a blank line on the UserForm (code) window type "Show", without
   quotation marks.

<P><LI>Highlight the word "Show" you typed in Step 3 and press F1.
<P>
</OL>The Show Method of the Microsoft Visual Basic Reference will appear.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 vbe vba<BR>
Keywords          : kbcode kbprg xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
