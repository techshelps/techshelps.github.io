

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: "User-Defined Type Not Defined" Error Message Using DAO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145759">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/02/07">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a Microsoft Excel Visual Basic for Applications subroutine using data access objects (DAO), you may receive one of the following compile errors:     User-Defined Type Not Defined     -or-     Sub or Function Not Defined  CAUSE =====  Y...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QBJZ,QBVV,QBWS,QAPN,QAH4,QBHQ,QAW6,QAFF,QAB3,QBS0,QA2Q,QAD7,QBVR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "User-Defined Type Not Defined" Error Message Using DAO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145759</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Microsoft Excel Visual Basic for Applications subroutine
using data access objects (DAO), you may receive one of the following
compile errors:
<P>
<PRE>   User-Defined Type Not Defined

   -or-

   Sub or Function Not Defined

</PRE><h2>CAUSE</h2>
 
<P>
You may receive the error message when a subroutine contains code
that uses the Microsoft DAO Object Library, and the library is not
referenced.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In order to avoid the error message, perform the following steps.
<P>
<P><h3>Microsoft Excel 7.0</h3>
 

<OL><P><LI>Select a Module Sheet.

<P><LI>On the Tools menu, click References.
<P>
   NOTE: It is necessary to be on a Module Sheet before you select the
   Tools menu because References is not available on the Tools menu on
   a worksheet, a dialog sheet, or a chart sheet.

<P><LI>In the References dialog box, under Available References, click to
   select "Microsoft DAO 3.0 Object Library," and then click OK.
<P>
   If "Microsoft DAO 3.0 Object Library" is not listed in the list box
   under Available References, click Browse and look for the
   Dao3032.dll file. It should be located in:
<P>
<P><PRE>       \Program Files\Common Files\Microsoft Shared\Dao\Dao3032.dll
</PRE><P>
   Select the file and click OK. This returns you to the References
   dialog box. Click OK.
<P>
</OL><h3>Microsoft Excel 97</h3>
 

<OL><P><LI>In the Visual Basic Editor, click References on the Tools menu.

<P><LI>In the References dialog box, under Available References, select
   "Microsoft DAO 3.5 Object Library," and then click OK.
<P>
   If "Microsoft DAO 3.5 Object Library" is not listed in the list box
   under Available References, click Browse and look for the Dao350.dll
   file. It should be located in:
<P>
<P><PRE>       \Program Files\Common Files\Microsoft Shared\Dao\Dao350.dll
</PRE><P>
   Select the file and click OK. This returns you to the References
   dialog box. Click OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
When you run a subroutine using DAO, and the DAO Object Library is not
referenced, you receive one of the messages list above, depending on
what code is written. If your code declares variables, for example
<P>
<PRE>   Dim Db as Database
   Dim Rs as Recordset

</PRE></OL>you receive the "User-Defined Type Not Defined" message, and the
subroutine fails in the variable declaration section.
<P>
If you did not declare your variables, you receive the "Sub or Function
Not Defined" error message, and the subroutine fails at the first use
of a statement that requires the DAO Object Library. This line is
usually:
<P>
<PRE>   Set Db = Workspaces(0).OpenDatabase(Path, &lt;optional arguments&gt;)

</PRE>In this case, the subroutine fails when it encounters "Workspaces."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 8.00 97 XL97<BR>
Keywords          : kberrmsg kbprg<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
