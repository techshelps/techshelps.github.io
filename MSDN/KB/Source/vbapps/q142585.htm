

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: How to Use a Toolbar Button to Open a File Indirectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142585">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/01/16">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can indirectly associate a workbook with a custom button in another workbook by assigning a macro in the associated workbook  to the button.  For example, if you have a workbook named  My Workbook  that contains a button, yo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAH4,QBWS,QA5D,QANS,QBS0,QBQU,QBOG,QAF0,QAVX,QAVW,QARW,QAKE,QAJD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Use a Toolbar Button to Open a File Indirectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142585</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can indirectly associate a workbook with a custom
button in another workbook by assigning a macro in the associated workbook 
to the button.
<P>
For example, if you have a workbook named "My Workbook" that contains a
button, you can indirectly associate a second workbook called "Main
Workbook" with that button by assigning a Microsoft Visual Basic for 
Applications module in "Main Workbook" to the button. When you click the 
button in "My Workbook," the second workbook, "Main Workbook," is opened 
automatically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Excel 5.0 and 7.0</h3>
 
<P>
To associate a workbook with a custom button, do the following:

<OL><P><LI>In Microsoft Excel, create a new workbook.

<P><LI>Point to Macro on the Insert menu, and then click Module.

<P><LI>In the module sheet, type the following code:
<P>
<PRE>       Sub Test()
       End Sub

</PRE><P><LI>On the Edit menu, point to Sheet, and then click Hide. This hides the
    module sheet.

<P><LI>On the View menu, click Toolbars.

<P><LI>In the Toolbars dialog box, click Customize. Select "Custom" in the
    Categories list box.

<P><LI>To add the button to an existing toolbar, drag one of the custom
    toolbar buttons over the toolbar and release the mouse button. To
    create a new toolbar which contains the toolbar button, drag the
    custom toolbar button over an area in the workbook and release the
    mouse button.

<P><LI>Select the "Test" macro in the Assign Macro dialog, and click OK.
    This will assign the macro Test to the custom button.

<P><LI>In the Customize dialog box, click Close.

<P><LI>On the File menu, click Save.

<P><LI>On the File menu, Click Close.
<P>
</OL>When you click the custom button, your file is opened. (Note that because
the sample macro has no commands, it runs without performing any
actions).
<P>
<P><h3>Microsoft Excel 97 and Microsoft Excel 98</h3>
 
<P>
To associate a workbook with a custom button, do the following:

<OL><P><LI>In Microsoft Excel, create a new workbook.

<P><LI>Press ALT+F11 to activate the Visual Basic Editor. (Or, click the Tools
   menu, point to Macro, and then click Visual Basic Editor.)

<P><LI>Click Module on the Insert menu. In the Code window, type the
   following code:
<P>
<PRE>      Sub Test()
      End Sub

</PRE><P><LI>Click Close and Return to Microsoft Excel on the File menu to return
   to the workbook.

<P><LI>On the View menu, point to Toolbars and click Customize.

<P><LI>Click the Command tab in the Toolbars dialog box. Select Macros in
   the Categories list box.

<P><LI>Drag the Custom Button over a toolbar and release the mouse button.

<P><LI>Right-click the toolbar button and select Assign Macro. Select the
   "Test" macro in the Assign Macro dialog, and click OK. This will
   assign the macro Test to the custom button.

<P><LI>In the Customize dialog box, click Close.

<P><LI>On the File menu, click Save.

<P><LI>On the File menu, Click Close.
<P>
</OL>When you click the custom button, your file is opened; because the sample
macro has no commands, it runs without performing any actions.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Excel 97</h3>
 
<P>
For more information about customizing toolbars, click the Office
Assistant, type "customizing toolbars," click Search, and then click to
view the appropriate topic.
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on
the Standard toolbar. If Microsoft Excel Help is not installed on your
computer, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office Program or
               Component

</PRE></OL><h3>Microsoft Excel 7.0 for Windows 95</h3>
 
<P>
For more information about customizing toolbars, click Answer Wizard on
the Help menu, and type the following on the search line:
<P>
<PRE>   How do I create a custom toolbar?

</PRE>Click Search, and then double-click the "Create a custom toolbar" topic.
<P>
<P><h3>Microsoft Excel version 5.0</h3>
 
<P>
"Visual Basic User's Guide," version 5.0, Chapter 34, "Customizing Your
Workspace"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.0 5.0c 5.00 5.00a 5.00c 7.00 8.00 XL98 XL97 XL7 <BR>
XL5<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS:5.x,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
