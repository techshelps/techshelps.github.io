

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Using Solver.Ok from VBA Requires R1C1 Style Referencing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153442">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/07/09">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you call the Solver.Ok macro function from a Visual Basic for Applications procedure or macro, you need to use R1C1 notation when  referencing cell ranges on a worksheet. If you use A1 notation in  referencing cell ranges, you may receive the ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QBJZ,QBS0,QBWS,QAD7,QA5F,QAB9,QAVZ,QAG2,QDNZ,QDMR,QA2Q,QAY2,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using Solver.Ok from VBA Requires R1C1 Style Referencing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153442</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you call the Solver.Ok macro function from a Visual Basic for
Applications procedure or macro, you need to use R1C1 notation when 
referencing cell ranges on a worksheet. If you use A1 notation in 
referencing cell ranges, you may receive the following error message:
<P>
<PRE>   Run-Time Error 1004: Error in Formula

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>The Solver.Ok macro is a command macro that defines a basic Solver model,
equivalent to clicking Solver on the Tools menu and then specifying options
in the Solver Parameters dialog box.
<P>
Before you use this function, you need to load the Solver Add-In using the
Add-In manager. To load the Solver Add-In, follow these steps:

<OL><P><LI>On the Tools Menu, click Add-Ins and click to select the Solver Add-In
   check box.

<P><LI>If the Solver Add-In doesn't appear in the Add-Ins Available box, click
   the Browse button, select Solver.xla in the \Excel\Library\Solver
   folder, and then click OK.
<P>
</OL>NOTE: If you can't find Solver.xla, you may need to install the Solver Add-
In using the Microsoft Excel or Microsoft Office Setup program.
<P>
<P><h3>Sample Visual Basic Procedure</h3>
 
<P>
The following macro shows an example of how to call the Solver.Ok macro
using R1C1 notation:

<OL><P><LI>In a new Microsoft Excel Workbook, on the Insert menu, point to Macro,
   click Module, and then type the following macro code:
<P>
<PRE>      Sub SolverOkDemo()
       Sheets("Sheet1").Select
       Range("C1").Select
       ActiveCell.Formula = "=a1+b1"
       ' Solve.Ok Parameters
       Set_Cell = Range("C1").Address(True, True, xlR1C1, True)
       Max_Min_Val = 3
       Value_Of = 21
       By_Changing = Range("a1:b1").Address(True, True, xlR1C1, True)

       Application.ExecuteExcel4Macro
       String:="'[SOLVER.XLA]SOLVER'!SOLVER.OK(" _
          &amp; Set_Cell &amp; "," &amp; Max_Min_Val &amp; "," &amp; Value_Of &amp; "," &amp;
          By_Changing &amp; ")"
       Application.ExecuteExcel4Macro
       String:="'[SOLVER.XLA]SOLVER'!SOLVER.SOLVE()"
      End Sub

</PRE><P><LI>On the Tools Menu, click Macro, select the SolverOkDemo Macro from the
   list, and then click the Run Button to run the macro.
<P>
</OL>The macro will perform the following:

<OL><P><LI>Select sheet1.

<P><LI>Select cell C1.

<P><LI>Insert the formula =A1+B1 in cell C1.

<P><LI>Places the found solution in Cells A1 and B1.

<P><LI>Solver's dialog box will appear, indicating that it found a solution.
<P>
</OL>Click OK to dismiss Solver's dialog box.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about SolverOk in Microsoft Excel version 7.0, click
Answer Wizard on the Help menu and type:
<P>
<PRE>   SolverOk

</PRE></OL>For more information about Solver.OK in Microsoft Excel version 5.0, choose
Contents in help, Click Reference Information, and then choose the Search
button and type:
<P>
<PRE>   Solver.ok

</PRE>For additional information about getting help with Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 Solve Solver.Ok Error<BR>
Keywords          : kbcode kbprg PgmOthr<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97; MACINTOSH:5.0,5.0a,97<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
