

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Imported MS Excel Carriage Returns Become Vertical Bars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115576">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/05/31">
<META NAME="Keywords" CONTENT="kbinterop PgmHowTo PgmParse">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you import a Microsoft Excel spreadsheet into Microsoft Access, the carriage return (CR) character appears as a vertical bar or a small box, depending on your version of Mic...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA1S,QDN9,QAUD,QAMA,QBS0,QA5F,QAY5,QAYG,QBWS,QA5V,QBJZ,QBV8,QAB9,QBXT P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Imported MS Excel Carriage Returns Become Vertical Bars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115576</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel, versions 2.x, 3.x, 4.x, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you import a Microsoft Excel spreadsheet into Microsoft Access, the
carriage return (CR) character appears as a vertical bar or a small box,
depending on your version of Microsoft Excel and Microsoft Access. For
simplicity, this article refers to vertical bars to indicate either
vertical bars or small boxes.
<P>
For example, if you import a Microsoft Excel spreadsheet mailing list
with complete addresses stored in single cells formatted with carriage
returns, the addresses appear in Microsoft Access as single lines with
vertical bars between the address items.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The CR character used in Microsoft Excel (ALT+ENTER) differs from that
used in Microsoft Access (CTRL+ENTER). As a result, the CR characters
in Microsoft Excel spreadsheets are not parsed into carriage returns in
Microsoft Access, but into small vertical bars.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can use the following sample user-defined function to convert the CR
character used in Microsoft Excel to the CR character used in Microsoft
Access. To create the function, follow these steps:

<OL><P><LI>Start Microsoft Access and open any database.

<P><LI>Create a module and type the following line in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      Function ChangeStr (s As Variant, a As String, n As String,_
<PRE></PRE>                          c As Integer) As Variant
         ' This function changes all substrings "a" and string "s"
         ' to "n." The parameter "c" has the same function as in the
         ' InStr() function.
         Dim temp As String, pos As Integer
         temp = ""
         If IsNull(s) Then
            ChangeStr = Null
            Exit Function
         End If
         If a = "" Or s = "" Then
            ChangeStr = s
            Exit Function
         End If
         pos = InStr(1, s, a, c)
         While pos &gt; 0
            temp = temp &amp; Mid$(s, 1, pos - 1) &amp; n
            s = Right$(s, Len(s) - pos - Len(a) + 1)
            pos = InStr(1, s, a, c)
         Wend
         ChangeStr = temp &amp; s
      End Function

</PRE><P><LI>Create a new update query. Drag the field that you want converted to
   the query grid.

<P><LI>In the Update To row of the query grid, type the following expression:
<P>
<P><PRE>      ChangeStr([&lt;fieldname&gt;],Chr$(10),Chr$(13) &amp; Chr$(10),0)
</PRE><P>
   where &lt;fieldname&gt; is the name of the field that you want to convert.

<P><LI>Run the query. Note that text containing vertical bars is divided into
   separate lines with carriage returns.
<P>
</OL><h2>STATUS</h2>
 
<P>
This feature is being reviewed and will be considered for inclusion in a
future release of Microsoft Access.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Microsoft Excel, create a spreadsheet and type the following data
   into cell A1:
<P>
<P><PRE>      Fred Test
      111 Main
      Anytown, USA
</PRE><P>
   To insert a new line within a cell, press ALT+ENTER. Then type the
   following data into cell A2:
<P>
<P><PRE>      Joe Test
      222 Broadway
      Anytown, USA
</PRE>
<P><LI>Save the spreadsheet and quit Microsoft Excel.

<P><LI>Start Microsoft Access and open any database.

<P><LI>In Microsoft Access 7.0 and 97, on the File menu, point to Get
   External Data, and then click Import.
<P>
   In Microsoft Access 2.0, on the File menu, click Import.

<P><LI>In Microsoft Access 7.0 and 97, in the Import dialog box, select
   Microsoft Excel (*.xls) in the Files of type box.
<P>
   In Microsoft Access 2.0, in the Import dialog box, select Microsoft
   Excel 2.0, 4.0, or 5.0, depending on the version of Microsoft Excel
   you are using, and then click OK.

<P><LI>In all versions, select the Microsoft Excel file you created in
   step 1, and then click Import.

<P><LI>In Microsoft Access 7.0 and 97, in the Import Spreadsheet Wizard, note
   the vertical bars in the Sample data box. Click Cancel to return to the
   Database window.
<P>
   In Microsoft Access 2.0, click OK in the Import Spreadsheet Options
   dialog box. Close the Select File dialog box and open the new table.
   Note the vertical bars between the data elements of each field value.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about importing spreadsheet data, search for
"spreadsheets, importing or linking" using the Microsoft Access for
Windows 95 Help Index.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pipes if<BR>
Keywords          : kbinterop PgmHowTo PgmParse<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
