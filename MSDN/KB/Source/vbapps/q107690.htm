

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Continue Macro Execution While Playing a .WAV File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107690">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/11/24">
<META NAME="Keywords" CONTENT="IntpOthr kbprg kbprb kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The APPLICATION.SOUND.PLAY() or SOUNDNOTE.PLAY functions allow a macro to execute and play wave(.WAV) files. When you use these functions in a macro, Microsoft Excel must wait for the entire sound file to play before it can run the rest of the macr...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYS,QAHR,QAH4,QBVP,QBS0,QDL9,QBWO,QBWN,QAY5,QBXT,QA5V,QAIB,QAB9,QDL2,QA2B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Continue Macro Execution While Playing a .WAV File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107690</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The APPLICATION.SOUND.PLAY() or SOUNDNOTE.PLAY functions allow a
macro to execute and play wave(.WAV) files. When you use these
functions in a macro, Microsoft Excel must wait for the entire sound
file to play before it can run the rest of the macro.
<P>
You can use the following

<UL><LI>The Declare Functions,
<P>
   -and-

<LI>Microsoft Windows version 3.1(which includes MultiMedia Extensions),
<P>
   -and-

<LI>A sound card (such as the Windows Sound System or MediaVision's Pro
   Audio Spectrum),
<P>
</UL>to play the sound file with a macro. When you play the sound file in
this manner, the macro will not have to wait for the wave file to
finish playing. As soon as MultiMedia Extensions takes over playing
the sound file, Microsoft Excel continues to execute the rest of the
macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you play the .WAV file this way, the sound file continues to play
while the macro finishes executing, and it appears as if Microsoft
Excel is performing two tasks at once. To demonstrate this behavior,
play a .WAV file describing the contents of a dialog box and then
display the dialog box. The following sample macro can be used in
Microsoft Excel, version 5.0, for this purpose.
<P>
Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. This Visual Basic procedure
is provided 'as is' and Microsoft does not guarantee that it can be
used in all situations. Microsoft does not support modifications of
this procedure to suit customer requirements for a particular purpose.
Note that a line that is preceded by an apostrophe introduces a
comment in the code--comments are provided to explain what the code is
doing at a particular point in the procedure. Note also that an
underscore character (_) indicates that code continues from one line
to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line
continuation character. For more information about Visual Basic for
Applications programming style, see the "Programming Style in This
Manual" section in the "Document Conventions" section of the "Visual
Basic User's Guide."
<P>
WARNING: The Declare Function statements listed in the following
macro are very sensitive. If used incorrectly, these functions may
cause a general protection (GP) fault in Windows or cause serious
software problems.
<P>
<PRE>'The following two lines should be entered as a single line on a 'module
</PRE>sheet
<PRE>Declare Function sndPlaySound Lib "MMSYSTEM.DLL" (ByVal lpszSoundName
</PRE>As String,_ ByVal wFlags As Integer) As Integer
<P>
<PRE>Sub main()
   'Calls the sndPlaySound function and passes it the name of
   'the sound file to play
   Call sndPlaySound("c:\bat\wave\close.wav", 0)
End Sub

</PRE>You can replace c:\bat\wave\close.wav with the path to any valid .wav
file. This macro assumes the that you are using Microsoft Windows 3.1
and have a compatible sound card installed. Software sound drivers
such as SPEAK.EXE will not give the desired results (these drivers
must play the entire sound file before allowing Microsoft Excel to
continue execution of the macro).
<P>
For more complete information about the sndPlaySound function of the
MMSYSTEM.DLL, refer to the "Multimedia Programmer's Reference." This
manual is part of the Microsoft Windows operating system version 3.1,
Software Development Kit (SDK).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.0 blaster soundblaster wss creative labs<BR>
Keywords          : IntpOthr kbprg kbprb kbprb<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
