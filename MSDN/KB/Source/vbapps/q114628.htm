

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Date, Time, Currency Formats Different from International </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114628">
<META NAME="KBModify" CONTENT="1997/07/29">
<META NAME="KBCreate" CONTENT="1994/05/09">
<META NAME="Keywords" CONTENT="kbprg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a macro that formats a number with a date, time, currency, or standard number format in a Visual Basic, Applications Edition module, the format in the macro is different from the format displayed in the International dialog box of Cont...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXS,QDNG,QACE,QBTX,QANG,QABA,QDL9,QBWO,QBWN,QAWP,QBAO,QAH4,QBWS,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Date, Time, Currency Formats Different from International</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114628</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Programming System, Applications Edition,
   version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a macro that formats a number with a date, time, currency, or
standard number format in a Visual Basic, Applications Edition module, the
format in the macro is different from the format displayed in the
International dialog box of Control Panel.
<P>
This behavior occurs when your Country setting in the International dialog
box is set to one of the following: Austria, Canada (French), Hungary,
Slovak Republic, Croatia, Romania, Serbia, or Slovenia.
<P>
The following is a list of Country settings and the different date formats
displayed in the International dialog box of Control Panel and in a Visual
Basic module:
<P>
<PRE> Country              International                     Visual Basic
                      displays                          displays
 --------------------------------------------------------------------

 Austria              Short Date:  1994-5-6             1994-5-Friday

 Canada (French)      Short Date:  94/5/6               94-5-6

 Hungary              Long Date:   1994. May 6          1994 May 6.
                      Short Date:  1994.5.6             1994.5.6.

</PRE>When the following country settings are used
<P>
<PRE>   Croatia
   Romania
   Serbia
   Slovenia

</PRE>a macro in a Visual Basic module displays date, time, currency, and
numbers as United States formats.
<P>
<P><h2>CAUSE</h2>
 
<P>
<P><h3>Austria</h3>
 
<P>
This incorrect date format is caused by a problem in Microsoft Windows.
When you set the Country setting to Austria in the International dialog
box, the [intl] section of the WIN.INI file has the following incorrect
setting:
<P>
<PRE>   sShortDate=yyyy-MM-dddd

</PRE>This causes the date in Visual Basic modules to be formatted with
the full day name.
<P>
<P><h3>Canada(French)</h3>
 
<P>
This incorrect date format is caused by a problem in Microsoft Windows. The
[intl] section in the WIN.INI file has the following inconsistent settings:
<P>
<PRE>   sDate=/
   sShortDate=yy-mm-dd

</PRE>The date separators in these settings should be consistent. (The default
should be the hyphen (-) character.)
<P>
<P><h3>Hungary</h3>
 
<P>
This incorrect date format is also caused by a problem in Microsoft
Windows. In the [intl] section in the WIN.INI file, both the sShortDate and
the sLongDate settings correctly show a period at the end. The Visual Basic
module uses these correct settings to format a date. In this case, the
format of the dates in the International dialog box are incorrect.
<P>
<P><h3>Croatia, Romania, Serbia, and Slovenia</h3>
 
<P>
Visual Basic, Applications Edition does not recognize the Croatia, Romania,
Serbia, and Slovenia system locales. For languages that are not recognized,
date, time, currency, and number formats in Visual Basic modules use the
default United States/English International settings.
<P>
More information about this is available in the XLREADME.HLP file. To view
this file, do the following:

<OL><P><LI>In Microsoft Excel, press F1 to run Help.

<P><LI>From the File menu, choose Open. From the File Name list, select
   XLREADME.HLP and choose OK.

<P><LI>Select the Microsoft Excel Product Update topic.

<P><LI>Scroll down to the Unrecognized System Locales topic.
<P>
</OL><h3>WORKAROUND</h3>
 
<P>
<P><h3>Austria</h3>
 
<P>
To work around this problem and display the correct short date format in a
Visual Basic module, do the following:

<OL><P><LI>Run Windows Control Panel and choose the International icon.

<P><LI>Under Date Format, choose Change, then choose OK.

<P><LI>In the International dialog box, choose OK.
<P>
</OL><h3>Canada(French)</h3>
 
<P>
To correct this inconsistency, do the following:

<OL><P><LI>Run Windows Control Panel and choose the International icon.

<P><LI>Under Date Format, choose Change.

<P><LI>Under Short Date Format in the Separator box, type "/" (backslash) or
   "-" (hyphen) (without the quotation marks) to set the date separator you
   want to use. Choose OK.

<P><LI>In the International dialog box, choose OK.
</OL> 
<PRE>Keywords          : kbprg kbusage
Version           : 1.00
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
