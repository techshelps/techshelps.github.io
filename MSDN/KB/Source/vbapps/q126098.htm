

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SendKeys Statement Doesn't Send Keystrokes to Module in MS Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126098">
<META NAME="KBModify" CONTENT="1997/07/29">
<META NAME="KBCreate" CONTENT="1995/02/14">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  You cannot use the SendKeys statement to send keystrokes to a module window in Microsoft Excel. For example, if you run the following procedure while a module sheet is active in Microsoft Excel, Microsoft Excel is activated, but text is not entered...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QBS0,QAVX,QAVW,QAPN,QAFF,QBRZ,QAB9,QAH6,QDO5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SendKeys Statement Doesn't Send Keystrokes to Module in MS Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126098</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Programming System, Applications Edition,
   version 1.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You cannot use the SendKeys statement to send keystrokes to a module
window in Microsoft Excel. For example, if you run the following
procedure while a module sheet is active in Microsoft Excel,
Microsoft Excel is activated, but text is not entered in the module:
<P>
<PRE>   Sub To_Excel()
      AppActivate "Microsoft Excel"
      SendKeys "Sub Test"
   End Sub

</PRE>Note that the SendKeys command sends the keystrokes as expected if a
worksheet is active in Microsoft Excel when you run the above
procedure.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, for example if you want to use a macro in
Microsoft Project to enter code in a Visual Basic module in Microsoft
Excel, you can write the desired code to a text file, and then use
the Module.InsertFile method to insert the code in a Module in
Microsoft Excel. The following is an example of using this method:
<P>
<PRE>   Sub ToExcel()
      ' Dimension xl variable as Object type
      Dim xl As Object
      ' Set variable xl equal to the Excel Application object
      Set xl = Excel.Application

      With xl
         ' Open workbook in Excel
         ' Substitute your file name in the following line
         .Workbooks.Open ("c:\excel\files\test.xls")
         ' Insert text file that contains code
         ' Substitute your text file name in the following line
         .ActiveWorkbook.Modules("Module1").InsertFile "c:\code.txt"
         ' Close file, saving changes
         .ActiveWorkbook.Close True
         ' Quit application Excel
         .Quit
      End With

    End Sub

</PRE>Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Note that if you run the following procedure while the Module Editor
view is active in Microsoft Project, Microsoft Project is activated,
and the text "Sub Test" is entered in the active module:
<P>
<PRE>   Sub Test()
      AppActivate "Microsoft Project"
      SendKeys "Sub Test"
   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the SendKeys Statement or the SendKeys
Method, choose the Search button in the Visual Basic Reference and
type:
<P>
<PRE>    SendKeys
</PRE> 
<PRE>Keywords          : kbcode kbprg
Version           : 1.00
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
