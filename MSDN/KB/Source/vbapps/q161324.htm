

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Error Using "Mailto:" with FollowHyperlink Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161324">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="xlvbainfo offinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a Visual Basic for Applications macro in Microsoft Excel 97, you may receive one of the following error messages:     Run-time error '-2146697203 (800c000d)':    Method 'FollowHyperlink' of object '_Workbook' failed     -or-     Run-ti...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAYC,QAC2,QAH4,QBVP,QAR5,QAB4,QAHE,QAPF,QBS0,QBWD,QAVZ,QBWA,QBW4,QBVV P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error Using "Mailto:" with FollowHyperlink Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161324</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Visual Basic for Applications macro in Microsoft Excel 97,
you may receive one of the following error messages:
<P>
<PRE>   Run-time error '-2146697203 (800c000d)':
   Method 'FollowHyperlink' of object '_Workbook' failed

   -or-

   Run-time error '-2146697203 (800c000d)':
   The required Internet protocol is not installed on your computer, or
   the Internet address you requested may not be valid.

</PRE>and the macro halts.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when all of the following conditions are true:

<UL><LI>The macro contains a line of code that executes the FollowHyperlink
   method.
<P>
   -and-

<LI>The Address argument of the Hyperlink method refers to an electronic
   mail (e-mail) address by using "mailto:" (without the quotation marks)
   followed by the address. For example, you use the following code:
<P>
<P><PRE>      Address:="mailto:cmitchell@maas.com"
</PRE><P>
   -and-

<LI>You set the ExtraInfo argument of the Hyperlink method to any value.
   For example, you use the code:
<P>
<P><PRE>      ExtraInfo:="Here's some extra info."
</PRE><P>
   -and-

<LI>You set the Method argument of the Hyperlink method to the value
   "msoMethodPost" (without the quotation marks). For example, you use the
   following command:
<P>
<P><PRE>      Method:=msoMethodPost
</PRE><P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, do not set the value of the Method argument to
"msoMethodPost" when the Address argument contains a "mailto:" reference.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, you can use the FollowHyperlink method in a Visual
Basic macro when you want to view a document or Web page located either on
the Internet or on your local intranet. The Address argument of the
FollowHyperlink method allows you to specify what document to view. For
example, the following code:
<P>
<PRE>   ActiveWorkbook.FollowHyperlink Address:="<B><A HREF="http://msnbc.com/">http://msnbc.com/</A></B>"

</PRE>displays the MSNBC home Web page.
<P>
However, if the Address argument begins with "mailto:" followed by an
e-mail address, Microsoft Excel 97 starts your mail client (for example,
Microsoft Outlook 97, or Microsoft Exchange) and instructs your mail client
to compose a new mail message that is addressed to the specified e-mail
address. For example, running this line of code:
<P>
<PRE>   ActiveWorkbook.FollowHyperlink Address:="mailto:cmitchell@maas.com"

</PRE>causes your mail client to compose a new mail message that is addressed to
cmitchell@maas.com. Note that the new mail message is not sent
automatically. You must still click Send to send the message.
<P>
If the Address argument refers to an e-mail address, setting the Method
argument to msoMethodPost causes one of the error messages described in
this article to appear, and the macro halts. For example, the following
line of code does not work:
<P>
<PRE>   ActiveWorkbook.FollowHyperlink Address:="mailto:cmitchell@maas.com", _
       ExtraInfo:="Here's the data!", Method:=msoMethodPost
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlvbainfo offinterop<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
