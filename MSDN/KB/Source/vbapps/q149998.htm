

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Run VB for Apps Code from an MS Excel 4.0 Macro Sheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149998">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1996/04/17">
<META NAME="Keywords" CONTENT="PgmHowTo kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel versions 5.0 and 7.0, you are able to call a Microsoft Excel version 5.0 or 7.0 Visual Basic for Applications procedure from a Microsoft Excel version 4.0 macro.  MORE INFORMATION  Microsoft provides examples of Visual Basic for ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QBS0,QBWS,QAVX,QAVW,QBJZ,QAGI,QACI,QAY2,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Run VB for Apps Code from an MS Excel 4.0 Macro Sheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149998</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.x
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel versions 5.0 and 7.0, you are able to call a Microsoft
Excel version 5.0 or 7.0 Visual Basic for Applications procedure from a
Microsoft Excel version 4.0 macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
To call a Visual Basic for Applications macro from a Microsoft Excel
version 4.0 macro, do the following:

<OL><P><LI>Insert both a Module and a 4.0 Macro sheet in a Microsoft Excel version
   5.0 or 7.0 workbook.

<P><LI>Place the following code on the Module sheet:
<P>
<PRE>      Sub Test()
         Msgbox "This is a test"
      End Sub

</PRE><P><LI>Save the workbook as VBA_XLM.xls.

<P><LI>On the 4.0 Macro sheet, place the following code:
<P>
<P><PRE>      A1: Test1
      A2: =RUN(VBA_XLM.xls!test())
      A3: =RETURN()
</PRE>
<P><LI>On the 4.0 Macro sheet, place your cursor in cell A1, and do the
   following:
<P>
   a. On the Insert menu, point to Name, and then click Define.
<P>
   b. In the Define Name dialog box, click Test1 in the Names In Workbook
<P><PRE>      list.
</PRE><P>
   c. Under Macro, click Command.
<P>
<P><PRE>      The Category list defaults to User Defined.
</PRE><P>
   d. Click Add, and then click OK.

<P><LI>Save the workbook.

<P><LI>On the Tools menu, click Macro.

<P><LI>In the Macro dialog box, click Test1, and then click Run.
<P>
   You should receive a dialog box with the message "This is a test."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, pages 367-368
"Microsoft Excel User's Guide 2," version 4.0, pages 231-255
"Microsoft Excel Visual Basic User's Guide," version 5.0, chapters 1-4
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 5.00 5.0 5.0c 5.00c 7.00<BR>
Keywords          : PgmHowTo kbcode kbhowto kbprg<BR>
Version           : 5.x 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
