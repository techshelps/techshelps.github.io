

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL7: Error Using OLE Automation with Microsoft Word 7.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138289">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1995/10/16">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop kbole kbprg xlwin">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use OLE Automation between Microsoft Excel for Windows 95, version 7.0, and Microsoft Word for Windows 95, version 7.0, to create a mail merge document, you may receive either of the following error messages:     Run Time Error '51' Micros...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBVP,QBQU,QBFY,QAH4,QBTS,QALI,QDME,QA5V,QAUR,QAB4,QAUJ,QBDM,QAYY,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: Error Using OLE Automation with Microsoft Word 7.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138289</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use OLE Automation between Microsoft Excel for Windows 95, version
7.0, and Microsoft Word for Windows 95, version 7.0, to create a mail merge
document, you may receive either of the following error messages:
<P>
<PRE>   Run Time Error '51' Microsoft Word--This task is taking longer than
   expected. Do you want to continue waiting?

   (Note that the Continue button is unavailable.)

   -or-

   Microsoft Excel is waiting for another application to complete an
   OLE action

</PRE><h2>RESOLUTION</h2>
 
<P>
To work around this problem open the Microsoft Excel worksheet in
Microsoft Word, save it as a Microsoft Word document and use the new
Microsoft Word file as your source data. The following macro shows how this
can be done programmatically.
<P>
Microsoft provides macro examples for illustration only, without warranty
either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose. This
macro is provided as is and Microsoft in no way guaranties that the
following code can be used in all situations and will not support
modifications of the code to suit specific customer requirements.
<P>
<PRE>Sub Create_Mailing_Labels()
</PRE>Dim Word As Object
<P>
<PRE>  Set Word = CreateObject("word.basic") 'creates the Word object

  With Word
    .AppShow ' Makes Word Visible
    'Sends keystrokes to the Open Worksheet dialog
    SendKeys "{TAB}{TAB}{TAB}{ENTER}"

    'opens a the Microsoft Excel file
    'NOTE: This line needs to be changed to point to the data file
    '(i.e. "c:\data.xls")
    .FileOpen Name:="c:\&lt;path&gt;\&lt;filename&gt;"

    'NOTE: This line needs to be changed to point to a new name for
    'the file (i.e. "c:\data.doc")
    'saves the file as a Microsoft Word document
    .FileSaveAs Name:="c:\&lt;path&gt;\&lt;filename&gt;"

    .FileClose 'closes the file
    .FileNewDefault ' Opens up a new blank document

    'makes the active window a main document
    .MailMergeMainDocumentType 1

    ' opens up the data source
    'NOTE: This line needs to be changed to point to the new file
    '(i.e. "c:\data.doc")
    .MailMergeOpenDataSource Name:="c:\&lt;path&gt;\&lt;filename&gt;", LinkToSource:=0

    'THESE FIELDS WILL BE SPECIFIC TO THE DATA BEING USED
    'Sets up the fields to be used for the mail merge
    .ToolsCreateLabels LabelAutoText:="ToolsCreateLabels3",_
     LabelText:="&lt;&lt;CONTACT&gt;&gt;" + Chr$(13) + "&lt;&lt;ADDRESS&gt;&gt;" + Chr$(13) + _
    "&lt;&lt;CITY&gt;&gt;,  &lt;&lt;REGION&gt;&gt;  &lt;&lt;ZIP_CODE&gt;&gt;  &lt;&lt;COUNTRY&gt;&gt;"

    .MailMergeToDoc 'Merges data records with the main document

    ' saves the active document
    'NOTE: This line needs to be changed to point a new file name
    '(i.e. "c:\result.doc")
    .FileSaveAs Name:="c:\&lt;path&gt;\&lt;filename&gt;"

  End With
  Set word = Nothing 'clears the object variable

End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00<BR>
Keywords          : AutoGnrl kbinterop kbole kbprg xlwin<BR>
Version           : 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
