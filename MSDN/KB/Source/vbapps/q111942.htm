

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Can't Use Replace Command to Search for Blank Cells </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111942">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/02/27">
<META NAME="Keywords" CONTENT="kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you choose Replace from the Edit menu, and you leave the Find What box blank and choose Find Next, Replace, or Replace All to fill blank cells on a worksheet, you receive the following error message:     Search string must be...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QASR,QDNZ,QDO0,QAI4,QACI,QAPN,QBJZ,QANX,QBXS,QATX,QANE,QAB4,QAJP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Can't Use Replace Command to Search for Blank Cells</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111942</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you choose Replace from the Edit menu, and you leave
the Find What box blank and choose Find Next, Replace, or Replace All to
fill blank cells on a worksheet, you receive the following error message:
<P>
<PRE>   Search string must be specified

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use any of the following methods.
<P>
Method 1: The following method is presented on page 33 in "Microsoft Excel
<PRE>          Visual Basic for Applications Step by Step," a Microsoft Press
          book.

          1. Highlight the range

          2. From the Edit menu, choose Goto

          3. Choose Special

          4. Select the Blanks check box

          5. Choose OK

          All the blanks in the range are now highlighted. Enter the value
          that you want to replace the blanks with. Now press CTRL+ENTER.
          This places the data in all of the selected cells.

          Note that if the worksheet is completely blank, you will receive
          the error message "No Cells Found."

</PRE>Method 2: The following Visual Basic procedure prompts you for the text you
<PRE>          want to enter in blank cells, and replaces the contents of the
          blank cells in the selection with this text.

             Sub Replace_Blanks()
                ' Dimension variables
                Dim Blanks As Object
                Dim ReplaceWith As String
                Dim Cell As Object
                ' Prompt user for string to enter in blank cells
                ReplaceWith = _
                Application.InputBox("Replace blank cells with what?", _
                "Replace String")
                ' Select blank cells in selection
                Selection.SpecialCells(xlBlanks).Select
                ' Defined Blanks as selection
                Set Blanks = Application.Selection
                ' Fill each cell in selection with user input
                For Each cell In blanks
                   Cell.Activate
                   ActiveCell.Formula = replacewith
                Next cell
             End Sub

</PRE>Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel versions earlier than version 5.0, you can replace blank
cells with a value by using the Replace dialog box and leaving the Find
What box blank. However, in Microsoft Excel version 5.0, you cannot use
this method to replace blank cells because you cannot leave the Find What
box in the Replace dialog box blank.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Visual Basic for Applications Step by Step,"
Reed Jacobson, ISBN is 1-55615-589-1
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 err msg matching data<BR>
Keywords          : kbprg PgmOthr<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
