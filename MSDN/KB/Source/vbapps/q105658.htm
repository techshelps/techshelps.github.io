

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: "Syntax Error in String" Error Using DDE() and DDESend() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105658">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/10/22">
<META NAME="Keywords" CONTENT="IntpDde">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you enter either the DDE() or the DDESend() function in the ControlSource property of a text box on a form, you may receive the following error message:     In Microsof...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QA1S,QAHP,QDN9,QA6A,QAY5,QAJH,QAB4,QBS0,QAZ2,QATX,QAIH,QAMA,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "Syntax Error in String" Error Using DDE() and DDESend()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105658</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you enter either the DDE() or the DDESend() function in the
ControlSource property of a text box on a form, you may receive the
following error message:
<P>
<PRE>   In Microsoft Access for Windows 95 version 7.0:

      The expression you entered has an invalid string

   In Microsoft Access version 2.0:

      Syntax error in string

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications With Microsoft Access For Windows 95" manual.
<P>
NOTE: Visual Basic for Applications (used in Microsoft Access for Windows
95 version 7.0) is called Access Basic in version 2.0. For more information
about Access Basic, please refer to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
A reference to another control is being used for the application or topic
argument in the function. Note that you can successfully include a control
reference for the item or data argument.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following example demonstrates how to create and use the sample Visual
Basic for Applications or Access Basic functions newDDE() and newDDESend()
in place of the DDE() and DDESend() functions:

<OL><P><LI>Open a module and enter the following code:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Function newDDE (App, Topic, Item)
</PRE><P>
<PRE>         Dim chan
         On Error GoTo ErrnewDDE
         chan = DDEInitiate(App, Topic)
         newDDE = DDERequest(chan, Item)
         DDETerminate chan

      ByenewDDE:
         Exit Function

      ErrnewDDE:
         newDDE = "#DDEERROR"
         Resume ByenewDDE

      End Function

      Function newDDESend (App, Topic, Item, DataToSend)
         Dim chan
         On Error GoTo ErrnewDDESend
         chan = DDEInitiate(App, Topic)
         DDEPoke chan, Item, DataToSend
         DDETerminate chan
         newDDESend = True

      ByenewDDESend:
         Exit Function

      ErrnewDDESend:
         newDDESend = False
         Resume ByenewDDESend

      End Function

</PRE><P><LI>Start Microsoft Word for Windows, version 7.0. Save a new document
   as Test.

<P><LI>Type a few lines of text in the document, and then select the text.

<P><LI>Click Bookmark on the Edit menu. Type "MyBookMark" (without the
   quotation marks), and then press ENTER.

<P><LI>Switch to Microsoft Access (leave Word for Windows running).

<P><LI>Create a new form with the following controls and properties:
<P>
<P><PRE>      Text box:
<PRE></PRE>        Name: App
      Text box:
        Name: Topic
      Text box:
        Name: Item
      Text box:
        Name: Data
      Text box:
        Name: DDE
        ControlSource: =newDDE([App],[Topic],[Item])
      Text box:
        Name: DDESend
        ControlSource:
           =newDDESend([App],[Topic],[Item],[Data])
        Format: True/False

</PRE><P><LI>On the View menu, click Form. Note that "#DDEError" appears in the DDE
   text box, and "False" appears in the DDESend text box. These messages
   occur because there are not yet valid application, topic, and item
   arguments.

<P><LI>Create the following entries:
<P>
<P><PRE>      App: Winword
      Topic: Test
      Item: MyBookMark
      Data: Hello!
</PRE><P>
   Note that the DDESend box displays "True," and the text "Hello!" appears
   in the Word for Windows document.

<P><LI>With the insertion point in the DDE box, press F9 to force the function
   to refresh. Note that "Hello!" appears in the DDE box in place of
   "#DDEError."
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When the form is opened, Microsoft Access immediately establishes a DDE
channel to the other application. This link uses the application and topic
arguments in the function. The channel is kept open until the form is
closed. Because the channel is open, the arguments necessary for opening
the channel cannot be altered.
<P>
Microsoft Access does not open a new channel whenever it needs to call or
refresh the control with the DDE() or DDESend() function. Doing so would
impose significant overhead and could result in performance degradation.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a blank, unbound form.

<P><LI>Add a text box to the form.

<P><LI>Enter any of the following expressions in the text box's ControlSource
   property:
<P>
<P><PRE>      =DDE("winword",[topic],"my item")
</PRE><P>
<P><PRE>      =DDE([app],"MyDoc","my item")
</PRE><P>
<P><PRE>      =DDESend("winword",[topic],"my item, "my data")
</PRE><P>
<P><PRE>      =DDESend([app],"MyDoc","my item, "my data")
</PRE><P>
</OL>Note that you receive the error message mentioned earlier in this article.
Any reference to another control in the application or topic argument will
generate this error.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about sharing data between applications, search for
"dynamic data exchange (DDE)," and then "Overview" using the Microsoft
Access for Windows 95 Help Index.
<P>
Microsoft Access "User's Guide", version 2.0, pages 735, 740
<P>
Microsoft Access "Building Applications", version 2.0, pages 295-298
 
<PRE>Keywords          : IntpDde
Version           : 2.0 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbdocerr</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
