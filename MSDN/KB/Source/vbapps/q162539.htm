

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: #Num Appears in Linked Microsoft Excel Spreadsheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162539">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/01/23">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you link to a Microsoft Excel 7.0 or 97 spreadsheet from a Microsoft Access 7.0 or 97 database, and the fields in the spreadsheet contain both numbers and text, the fields t...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA1S,QDN9,QAE2,QBWS,QDMK,QA7O,QA7N,QA5V,QBJZ,QAYY,QDNZ,QDNM,QDNG,QAJQ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: #Num Appears in Linked Microsoft Excel Spreadsheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162539</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you link to a Microsoft Excel 7.0 or 97 spreadsheet from a Microsoft
Access 7.0 or 97 database, and the fields in the spreadsheet contain both
numbers and text, the fields that contain text appear as #Num! in the
linked table in Microsoft Access.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Access assigns the data type for each field based on the data in
the first row it links. For example, if a field that contains mostly text
values has a number in the first row, Microsoft Access assigns the Number
data type and then cannot link the rest of the records. Any format that you
apply to the fields in Microsoft Excel will be ignored by Microsoft Access
when the spreadsheet is linked.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Before you link to the spreadsheet in Microsoft Access, make sure that the
spreadsheet has the same type of data in each field (column) and the same
fields in every row.
<P>
-or-
<P>
Use the procedure below to format the cells in the spreadsheet so that they
will appear correctly in Microsoft Access.
<P>
<P><h3>Formatting the Cells in the Microsoft Excel Spreadsheet</h3>
 
<P>
To format the cells in the spreadsheet so that the linked table data
appears correctly in Microsoft Access, do the following:

<OL><P><LI>Open the spreadsheet in Microsoft Excel 7.0 or 97.

<P><LI>Format the cells in the spreadsheet that contain mixed data as Text.
   You should do this from the Format menu in Microsoft Excel.

<P><LI>Create a macro in Microsoft Excel that contains the following procedure:
<P>
<PRE>      Sub Addspace()

      For Each cell in Selection
        cell.value = " " &amp; cell.Value
        cell.value = Right(cell.Value, Len(cell.Value) - 1)

      Next
      End sub

</PRE><P><LI>Highlight the cells in the spreadsheet that contain the mixed data.

<P><LI>Run the macro and then save the spreadsheet.

<P><LI>Open your database in Microsoft Access 7.0 or 97.

<P><LI>Link to the spreadsheet that you created in Microsoft Excel. Note that
   your data is now in the correct format.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Excel and create a new spreadsheet.

<P><LI>Type the following in cells A1 through A5:
<P>
<P><PRE>      A1. 12345
      A2. 12345
      A3. 12345
      A4. 12345
      A5. 12345A
</PRE>
<P><LI>Save the spreadsheet as Book1, and then close Microsoft Excel.

<P><LI>Open the sample database Northwind.mdb in Microsoft Access.

<P><LI>On the File menu, point to Get External Data, and then click Link
   Tables.

<P><LI>In the Link box, click Microsoft Excel in the Files Of Type list, and
   then select the Book1 spreadsheet you created. Click Link.

<P><LI>In the Link Spreadsheet Wizard, click Next twice, accept Sheet1 for the
   Linked Table Name, and then click Finish.

<P><LI>Click OK in the Link Spreadsheet Wizard message box.

<P><LI>Open the linked table (Sheet1). Note the #Num! in the last record.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about linking data, search the Help Index for "linked
tables, linking table data" or ask the Microsoft Access 97 Office
Assistant.
 
<PRE>Keywords          : kbinterop
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
