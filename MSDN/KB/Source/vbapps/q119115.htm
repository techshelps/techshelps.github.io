

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Plus Sign (+) Operator Behaves Differently in VB 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119115">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1994/08/08">
<META NAME="Keywords" CONTENT="PrgOther VB4ALL VB4WIN vbwin GnrlVb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  With the introduction of Visual Basic for Applications as the language used in Microsoft Visual Basic version 4.0, the plus sign (+) operator has undergone a minor change in behavior.  CAUSE =====  The context rules used to determine whether to add...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAAP,QAB4,QBQS,QATX,QAKM,QAYZ,QA6N,QAMA,QDL9,QBWQ,QBWO,QBWN,QA5F,QA5B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Plus Sign (+) Operator Behaves Differently in VB 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119115</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0, and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With the introduction of Visual Basic for Applications as the language
used in Microsoft Visual Basic version 4.0, the plus sign (+) operator has
undergone a minor change in behavior.
<P>
<P><h2>CAUSE</h2>
 
<P>
The context rules used to determine whether to add or concatenate a mixture
of variant and non-variant variables are now different.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Always use the ampersand (&amp;) if you want to concatenate two strings.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The table listed below details the changes when adding or concatenating
variant and non-variant data types. The main change is that if there is a
numeric operand (rvalue) involved, Visual Basic will try to add the
operands as numerics, coercing strings into numerics if possible. In
previous versions of Visual Basic, the variant would be coerced into a
string and concatenation performed.
<P>
<P><h3>Example Scenario</h3>
 
<P>
In this example, the following variables are declared:
<P>
<PRE>   Dim n As Integer
   Dim s As String
   n = 4        ' numeric
   s = "xyz"    ' string
   vn = 3       ' variant containing a number
   vsn = "3"    ' variant containing a string that can be coerced
                ' into a number
   vss = "abc"  ' variant containing a string that cannot be coerced
                ' into a number

</PRE>Performing the following operations produces the following results:
<P>
<PRE>Operation         Old Result            New Result           Note*
</PRE> 
<PRE>n + "abc"         compile error         run-time error       1
n + "3"           compile error         7                    2
n + 3             7                     7
s + "abc"         xyzabc                xyzabc
s + "3"           xyz3                  xyz3
s + 3             compile error         run-time error       1
vn + "abc"        3abc                  run-time error       3
vn + "3"          33                    6                    3
vn + 3            6                     6
vss + "abc"       abcabc                abcabc
vss + "3"         abc3                  abc3
vss + 3           run-time error        run-time error
vsn + "abc"       3abc                  3abc
vsn + "3"         33                    33
vsn + 3           6                     6

</PRE>* Notes:
<P>
<PRE>   1. Run-time error instead of compile-time error.
   2. Now adds instead of returning compile-time error.
   3. Now adds (or tries to add) instead of concatenating. If you want to
      concatenate, use the ampersand (&amp;) operator.
</PRE> 
<PRE>Keywords          : PrgOther VB4ALL VB4WIN vbwin GnrlVb kbprg
Technology        : kbvba
Version           : WINDOWS:2.0 3.0 4.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
