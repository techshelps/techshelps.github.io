

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: OnSave Property Not Available in Object Browser </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157951">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/10/21">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT=" SYMPTOM  In Visual Basic Editor for Microsoft Excel 97, there is no reference to the OnSave property in the Object Browser.  NOTE: This behavior differs from functionality of the Object Browser used in earlier versions of Microsoft Excel.  STATUS ==...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUR,QAPN,QBS0,QAU7,QBMH,QAH4,QBWS,QDM0,QBVV,QAB9,QAPF,QAO4,QBTI,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: OnSave Property Not Available in Object Browser</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157951</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOM</h2>
 
<P>
In Visual Basic Editor for Microsoft Excel 97, there is no reference to the
OnSave property in the Object Browser.
<P>
NOTE: This behavior differs from functionality of the Object Browser used
in earlier versions of Microsoft Excel.
<P>
<P><h2>STATUS</h2>
 
<P>
This is by design in Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>The OnSave property has been replaced by the BeforeSave event in Microsoft
Excel 97.
<P>
The OnSave property was introduced in Microsoft Excel for Windows 95,
version 7.0, but still can be used in Microsoft Excel 97. The OnSave
property returns or sets the name of a Visual Basic procedure to run after
the user invokes either the Save or Save As command, but before the
workbook is actually saved. Consider the following items when you use the 
OnSave property:

<UL><LI>The procedure that is specified to run with the OnSave property must
   take one Boolean argument (see the example below).

<LI>Only Visual Basic procedures are supported by this property; Microsoft
   Excel version 4.0 Macro Language procedures are not supported.

<LI>The value of the OnSave property is not saved with the workbook; it must
   be reset each time the workbook is opened.

<LI>This event is not called if the workbook is saved when a macro or mail
   command runs, or when an embedded workbook is updated.
<P>
</UL><h3>Macro Example using the OnSave property</h3>
 
<P>
This example displays a message box after the user invokes either the Save
or Save As command, but before the workbook is actually saved:
<P>
<PRE>     'Specifies the procedure to run when the workbook is saved
     Sub SetSaveEvent()
         ActiveWorkbook.OnSave = "SaveProcedure"
     End Sub

     Sub SaveProcedure(s As Boolean)
         MsgBox "Microsoft Excel will now save your work."
     End Sub

</PRE>Run the SetSaveEvent macro. This will set an internal flag in Microsoft
Excel to run the SaveProcedure macro automatically when the active workbook
is saved.
<P>
<P><h3>Macro Example using the BeforeSave event</h3>
 
<P>
The BeforeSave event executes before a workbook is saved. This event is new
to Microsoft Excel 97.
<P>
This example prompts the user for either a yes or no response before saving
the workbook:

<OL><P><LI>In the Project Explorer window of Visual Basic Editor, double-click
   ThisWorkbook in the current project.
<P>
   This opens a module for code that runs "behind" the workbook.

<P><LI>In the Object drop-down of this module, click Workbook.

<P><LI>In the Procedure drop-down of this module, click BeforeSave.

<P><LI>Enter the code so the Workbook_BeforeSave procedure resembles
   the following:
<P>
<P><PRE>     Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, _
<PRE></PRE>         Cancel As Boolean)

         a = MsgBox("Do you really want to save this workbook?", vbYesNo)
         If a = vbNo Then Cancel = True

     End Sub

</PRE><P><LI>On the File menu, click "Close and Return to Microsoft Excel."

<P><LI>If you click Save on the File menu, you receive a message box with
   a prompt asking if you really want to save the file. If you click Yes,
   your file is saved. If you click No, your file is not saved.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the BeforeSave event, click the Index tab in
Microsoft Visual Basic Help, type the following text
<P>
<PRE>     BeforeSave

</PRE></OL>and then double-click the selected text to go to the "BeforeSave Event"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00<BR>
Keywords          : kbcode kbprg xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
