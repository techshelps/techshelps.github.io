

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Conditional Compilation Code Lost With 5.0/95 Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161959">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/08">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  If you save a Microsoft Excel 97 workbook in the Microsoft Excel 5.0/95 Workbook file format, you lose any Conditional Compilation directives in  your code.  NOTE: You are not warned about the loss of your code when saving your file  in the 5.0/95 ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAVX,QAVW,QBVP,QAUR,QA01,QBS0,QBWS,QAKJ,QAKD,QAU7,QADK,QBJZ,QAMB,QABH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Conditional Compilation Code Lost With 5.0/95 Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161959</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you save a Microsoft Excel 97 workbook in the Microsoft Excel 5.0/95
Workbook file format, you lose any Conditional Compilation directives in 
your code.
<P>
NOTE: You are not warned about the loss of your code when saving your file 
in the 5.0/95 file format.
<P>
<P><h2>CAUSE</h2>
 
<P>
Conditional Compilation directives are not used in earlier versions of
Visual Basic for Applications and Microsoft Excel.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you have already saved your file in the 5.0/95 file format, you must 
reenter your Conditional Compilation directives when you open your file in 
Microsoft Excel 97.
<P>
If you have not yet saved your file in the 5.0/95 file format and you
want to preserve your Conditional Compilation directives, either save
your module as a .bas file (you can import it into other projects) or
comment the Conditional Compilation directives, and then save your file in 
the 5.0/95 file format.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use conditional compilation, using #If ... Then ... #Else
directives, to run blocks of code selectively. This is typically used in
cross-platform sub procedures. The #If ... Then ... #Else directives
evaluate expressions containing conditional compiler constants to
determine what code to execute in the macro.
<P>
Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>The following macro provides an example of using conditional compilation:

<OL><P><LI>Save and close any open workbooks and then open a new workbook.

<P><LI>Start the Visual Basic Editor (press ALT+F11).

<P><LI>On the Insert menu click Module.

<P><LI>In the module, type the following code:
<P>
<P><PRE>      #Const test = 1
</PRE><P>
<PRE>      Sub Cond_Comp()

          #If test Then
              MsgBox "test evaluates to True"

          #Else
              MsgBox "test evaluates to False"

          #End If

      End Sub

</PRE><P><LI>Run the Cond_Comp macro.
<P>
</OL>Since the conditional compilation constant "test" has a value of 1, a
message box will display the message "test evaluates to True".

<OL><P><LI>Change the first line of code in the module to:
<P>
<P><PRE>      #Const test = 0
</PRE>
<P><LI>Run the Cond_Comp macro.
<P>
   A message box with "test evaluates to False" will be displayed.
<P>
</OL>Conditional compilation constants can also be specified in the Project
Properties dialog box instead of in a module. To utilize this technique
in the previous example, follow these steps:

<OL><P><LI>Comment the first line in the module so that it looks like the
   following:
<P>
<P><PRE>      '#Const test = 0
</PRE>
<P><LI>On the Tools menu, click VBAProject Properties and click the General
   tab.

<P><LI>In the Conditional Compilation Arguments box, type the following:
<P>
<P><PRE>      test = 1
</PRE>
<P><LI>Click OK.

<P><LI>Run the Cond_Comp macro.
<P>
</OL>Since the conditional compilation constant "test" has a value of 1, a
message box displays the message "test evaluates to True."
<P>
NOTE: If you want to specify more than one conditional compilation constant 
in the Conditional Compilation Arguments box, use a colon (:) as a 
separator. For example, you would type the following into the Conditional 
Compilation Arguments box:
<P>
<PRE>   first = 1 : second = 0

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about Conditional Compilation, click the Index tab in
Visual Basic for Applications Help, type the following text
<P>
<PRE>   conditional compiling

</PRE>and then double-click the selected text to go to the "Understanding
Conditional Compilation" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97<BR>
Keywords          : kbcode kbprg xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
