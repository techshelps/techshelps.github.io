

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: How to Use DAO in Excel Without Referencing DAO Library </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152400">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/06/13">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you attempt to use data access objects (DAO) without first referencing the Microsoft DAO 3.0 or 3.5 Object Library, you may receive an error message. This can cause difficulties when you are developing applications for distri...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBVP,QAW6,QBS0,QAH4,QAZV,QAPF,QBXS,QBHQ,QA9Q,QBMR,QA1S,QBVV,QANF,QAB3 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Use DAO in Excel Without Referencing DAO Library</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152400</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you attempt to use data access objects (DAO)
without first referencing the Microsoft DAO 3.0 or 3.5 Object Library,
you may receive an error message. This can cause difficulties when you
are developing applications for distribution.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Instead of referencing the Microsoft DAO 3.0 or 3.5 Object Library, you
can use object linking and embedding (OLE) to create a database engine 
object. You can then use the database engine object in references to the 
database. In this way, you do not have to create a reference to the 
Microsoft DAO 3.0 or 3.5 Object Library file.
<P>
This method does have a limitation. You can only declare your database
variables as the generic Object type. For example, the statement
<P>
<PRE>   Dim Db as Database

</PRE>would generate the "User-defined type not defined" error. However, the
following statement does not:
<P>
<PRE>   Dim Db as Object

</PRE><h3>Visual Basic Code Example</h3>
 
<P>
The following code example shows how to declare and use the database
engine. The example assumes you have the Northwind.mdb sample database
installed in c:\MSOffice\Access\Samples.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft AnswerPoint Engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<PRE>   Sub DaoWithoutReferences()

       'Declare variables.
       Dim dbEng As Object
       Dim Db As Object
       Dim Rs As Object

       'Set the dbEng object using OLE
       Set dbEng = CreateObject("DAO.DBEngine")

       'NOTE: In Microsoft Excel 97, use this line of code instead of the
       'above line of code:
       '
       '   Set dbEng = CreateObject("DAO.DBEngine.35")

       'Open a database. Note that the statement contains the dbEng object.
       Set Db = _
           dbEng.workspaces(0).opendatabase("c:\MSOffice\Access\" &amp; _
           "Samples\Northwind.mdb")

       'Open a recordset in the database.
       Set Rs = Db.openrecordset("Customers")

       'Perform a move last and find the number of records
       'in the database to test if the operation worked.
       Rs.movelast
       MsgBox Rs.recordcount

       Set Rs = Nothing
       Set Db = Nothing
       Set dbEng = Nothing

   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
"Developing Microsoft Excel 95 Solutions with Visual Basic for
Applications," Chapter 7, "Database Access and Messaging", page 489.
<P>
DAO Reference library, "DBEngine Object"
<P>
For more information about DAO, establish a reference to the "Microsoft DAO
3.0 Object Library". Then on the View menu, click Object Browser. Under
Libraries/Workbooks, select DAO, and under Objects/Modules, click DBEngine.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 97 XL97 XL7<BR>
Keywords          : kbprg<BR>
Version           : WINDOWS:7.0,7.0a,97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
