

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: "Cannot Open Add-In" Error When You Run a Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162407">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/21">
<META NAME="Keywords" CONTENT="kberrmsg xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a Visual Basic for Applications macro in Microsoft Excel 7.0 or Microsoft Excel 97, you may receive one of the following error messages:     Run-time error '1004':    Cannot open Microsoft Excel Add-In for editing. Please edit the sour...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAQT,QAH4,QBWS,QAMN,QACI,QAH0,QAB4,QBS0,QBJZ,QA4B,QABI,QAAP,QAKP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "Cannot Open Add-In" Error When You Run a Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162407</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Visual Basic for Applications macro in Microsoft Excel 7.0
or Microsoft Excel 97, you may receive one of the following error messages:
<P>
<PRE>   Run-time error '1004':
   Cannot open Microsoft Excel Add-In for editing. Please edit the source
   document instead.

   -or-

   Run-time error '1004':
   Cannot open Microsoft Excel 97 Add-In for editing. Please edit the
   source document instead.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if the following conditions are true:

<UL><LI>The macro you are running opens a Microsoft Excel add-in file (a .xla
   file).
<P>
   -and-

<LI>You run the macro using a shortcut key that includes the SHIFT key.
   For example, you press the following keystroke:
<P>
<P><PRE>      CTRL+SHIFT+T
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do not assign a shortcut key that includes the
SHIFT key to any macro that opens any type of file.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you create a Visual Basic macro in Microsoft Excel, you can assign a
shortcut key to the macro. When you press the shortcut key, Microsoft
Excel runs the macro to which you assigned the shortcut key. To assign a
shortcut key to a macro, use the following appropriate steps.
<P>
<P><h3>Microsoft Excel 97</h3>
 

<OL><P><LI>On the Tools menu, point to Macro, and click Macros.

<P><LI>In the list of macros, click the macro to which you want to assign a
   shortcut key. Then, click Options.

<P><LI>Type a single letter in the shortcut key box.

<P><LI>Click OK. Then, click Cancel.
<P>
</OL>NOTE: If you hold down the SHIFT key while you type a letter in the
shortcut key box, the label to the left of the box changes from "Ctrl+" to
"Ctrl+Shift+." When you do this, you must include the SHIFT key to use the
shortcut key to run the macro.
<P>
<P><h3>Microsoft Excel 7.0</h3>
 

<OL><P><LI>On the Tools menu, click Macro.

<P><LI>In the list of macros, click the macro to which you want to assign a
   shortcut key. Then, click Options.

<P><LI>Select (check) the Shortcut Key check box. Then, type a single letter in
   the shortcut key box.

<P><LI>Click OK. Then, click Close.
<P>
</OL>If the shortcut key for a macro includes the SHIFT key, the macro may not
work as expected if it opens any files, particularly a Microsoft Excel
add-in file. This occurs because holding down the SHIFT key while a file
is opening causes Microsoft Excel to open the file in edit mode, and you
cannot open an add-in in this mode. For this reason, Microsoft recommends
that you do not assign a shortcut key that includes the SHIFT key to a
macro that opens files.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 XL97 XL7<BR>
Keywords          : kberrmsg xlvbainfo<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
