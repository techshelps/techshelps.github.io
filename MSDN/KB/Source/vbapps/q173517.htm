

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: How to Close Datasheet Form Without Saving Design Changes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173517">
<META NAME="KBModify" CONTENT="1998/01/05">
<META NAME="KBCreate" CONTENT="1997/09/08">
<META NAME="Keywords" CONTENT="FmrHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you open a form in datasheet view in Microsoft Access version 2.0, and then make any modifications to the layout of the form, such as increasing the width of a column, Micro...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QA1S,QAUR,QAZW,QAI2,QDN9,QAPN,QANE,QAH4,QAMA,QAU7,QAGC,QAAW,QAB4,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: How to Close Datasheet Form Without Saving Design Changes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173517</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you open a form in datasheet view in Microsoft Access version 2.0, and
then make any modifications to the layout of the form, such as increasing
the width of a column, Microsoft Access prompts you to save the changes to
the form when you close it.
<P>
If you do not have design rights to the datasheet form, Microsoft Access
cannot save the changes you made while viewing the form. When you try to
save the form, you receive the following error message:
<P>
<PRE>   You don't have permissions to modify form '&lt;name of form&gt;'

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To prevent Microsoft Access from prompting you to save the form, use one of
the following methods. The first method involves embedding your datasheet
form as a subform within an unbound main form. The second method uses
application programming interface (API) function calls in an Access Basic
procedure.
<P>
<P><h3>Method 1</h3>
 

<OL><P><LI>Create a new blank form and set the following properties:
<P>
<P><PRE>      Form: frmTest
      ----------------------------
      Caption: &lt;same as subform's&gt;
      ControlSource: &lt;none&gt;
      Default View: Single Form
      Scroll Bars: Neither
      Record Selectors: No
      Navigation Buttons: No
</PRE>
<P><LI>Add your datasheet form as a subform to the new blank form.

<P><LI>Resize and reposition the subform to remove all the unused space in
   the master form.

<P><LI>Save the master form. When you open the master form, it looks like your
   datasheet form; however, changing the column size or font doesn't affect
   the datasheet form's design.  Therefore, closing the master form doesn't
   prompt you to save any changes.
<P>
</OL><h3>Method 2</h3>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
This method assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE></OL>NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code.
<P>
You may have some Microsoft Windows API functions defined in an existing
Microsoft Access library; therefore, your declarations may be duplicates.
If you receive a duplicate procedure name error message, remove or comment
out the declarations statement in your code.

<OL><P><LI>Create a new form to prompt the user. This is necessary to prevent the
   existing datasheet form from calling the API function.
<P>
<P><PRE>      Form: frmCloseDialog
      -----------------------------
      Name: frmCloseDialog
      Caption: Close Datasheet form
      Recordsource: &lt;none&gt;
      Default View: Single Form
      Views Allowed: Form
      Scroll Bars: Neither
      Record Selector: No
      Navigation Buttons: No
      Border Style: Dialog
</PRE><P>
<P><PRE>      Label:
<PRE></PRE>         Name: lblPrompt
         Caption: Are you sure you want to close the form?
      Command Button:
         Name: cmdCloseForm
         Caption: OK
         On Click: [Event Procedure]
      Command Button:
         Name: cmdCancel
         Caption: Cancel
         On Click: [Event Procedure]

</PRE><P><LI>On the View menu, click Code to display the form's module.  Type the
   following lines of code within the form's module:
<P>
<P><PRE>      Option Explicit
      Declare Function KillForm Lib "User" _
<PRE></PRE>        Alias "DestroyWindow" (ByVal intWinHandle As Integer) As Integer

      Sub cmdCancel_Click ()
         On Error GoTo ErrCmdCancel
         DoCmd Close

      ExitCmdCancel:
         Exit Sub

      ErrCmdCancel:
         MsgBox Error$
         Resume ExitCmdCancel
      End Sub

      Sub cmdCloseForm_Click ()
         Dim intResult As Integer, intHnd As Integer
         On Error GoTo errCloseForm

         ' Set the focus back to the datasheet form prior to saving the
         ' record.

         Forms![frmDatasheet].SetFocus
         DoCmd DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, ,A_MENU_VER20

         ' Grab the window handle of the datasheet form, and
         ' Invoke the DestroyWindow API call to close the datasheet form.

         intHnd = forms!frmDatasheet.hwnd
         intResult = KillForm(intHnd)

         ' Close the cancel dialog form frmCloseDialog.
         DoCmd Close A_FORM, Me.Name
      ExitCloseForm:
         Exit Sub
      ErrCloseForm:                 ' In case the datasheet form wasn't
                                    ' open.
         MsgBox Error$
         Resume ExitCloseForm
      End Sub

</PRE><P><LI>Close and save the form created in step 3 as frmCloseDialog.

<P><LI>Open the datasheet form (frmDatasheet) in Design view and view its
   properties.

<P><LI>Set the form's OnUnload property to the following event procedure:
<P>
<PRE>      Sub Form_Unload (Cancel As Integer)
         ' Cancel the unload event of the Datasheet form, and open
         ' the dialog form created within Step 1.

         Cancel = True
         DoCmd OpenForm "frmCloseDialog"
      End Sub

</PRE><P><LI>Close and save the form.

<P><LI>Open the datasheet form, and modify the width of the first column.
<P>
   Note that when you try to close the datasheet form, the dialog form
   prompts you to select either OK or Cancel. When you click OK, the
   datasheet form closes without prompting you to save the changes to the
   form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about declaring Windows APIs, search the Help Index
for "Declare external procedures."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: inf<BR>
Keywords          : FmrHowto<BR>
Version           : WINDOWS:2.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
