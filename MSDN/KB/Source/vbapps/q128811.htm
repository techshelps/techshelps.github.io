

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: VB Example to Open an MS Access Database via DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128811">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/04/11">
<META NAME="Keywords" CONTENT="IntpDde kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how you can use dynamic data exchange (DDE) in Microsoft Visual Basic versions 3.0 or 4.0 to request information from a Microsoft Access database. ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBS0,QBT6,QDN9,QBV4,QAHP,QAZ2,QDKY,QA5F,QAMA,QAPF,QBWS,QA6A,QAH4,QAXB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: VB Example to Open an MS Access Database via DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128811</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how you can use dynamic data exchange (DDE) in
Microsoft Visual Basic versions 3.0 or 4.0 to request information from a
Microsoft Access database. By using DDE, you can manipulate Microsoft
Access objects that are not available through Microsoft Visual Basic's data
access features. For example, you can run a Microsoft Access macro to print
a report or to open a form from Microsoft Visual Basic.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use DDE in Microsoft Visual Basic to request information from a
Microsoft Access database, follow these steps.
<P>
NOTE: This example does not verify if Microsoft Access is running (it
assumes Microsoft Access is open at the time you run DDE commands). Also,
the code does not include any error trapping. You may want to modify this
example to include these enhancements in your project.

<OL><P><LI>Start a new project in Microsoft Visual Basic. Note that Form1 is
   created by default.

<P><LI>Add two text boxes named AppItems and DBItems to Form1.

<P><LI>Add a command button named RunAccessDDE.

<P><LI>Place the following code in the RunAccessDDE button's Click event.
<P>
<P><PRE>    Private Sub Command1_Click()
<PRE></PRE>        Const LINK_MANUAL = 2, LINK_NONE = 0
        Dim Cmd

        ' Create a string containing a Microsoft Access macro command.
        Cmd = "[OPENDATABASE ""C:\MSOFFICE\ACCESS\SAMPLES\NorthWind.MDB""]"

        NOTE: The sample database is called NWIND.MDB in versions 1.1
        and 2.0.

        If AppItems.LinkMode = LINK_NONE Then

           ' Set the DDE server application and topic to MSACCESS|SYSTEM.
           AppItems.LinkTopic = "MSACCESS|SYSTEM"

           ' Specify the information passed to the AppItems text box.
           AppItems.LinkItem = "SysItems"

           ' Set the LinkMode to a valid non-zero setting which causes
           ' Visual Basic to initiate a link to the program defined in
           ' the LinkTopic. The LINK_MANUAL constant value of 2 ensures
           ' that the link is not updated until the LinkRequest method
           ' is invoked.
           AppItems.LinkMode = LINK_MANUAL

           ' Update the contents of the AppItems text box.
           AppItems.LinkRequest

           ' Run a valid DDE operation for Microsoft Access, such as
           ' opening the sample database NorthWind.MDB.
           AppItems.LinkExecute Cmd

           If DBItems.LinkMode = LINK_NONE Then

           ' Set the DDE Server and topic to MSACCESS|NorthWind.
           DBItems.LinkTopic = "MSACCESS|NorthWind"

           ' Pass a list of Microsoft Access tables to DBItems text box.
           DBItems.LinkItem = "TableList"
           ' Set the LinkMode to update the DBItems text box only when the
           ' LinkRequest method is invoked.
           DBItems.LinkMode = LINK_MANUAL

           ' Update the contents of the DBItems text box.
           DBItems.LinkRequest
           'Close the DDE link for the DBItems text box.
           DBItems.LinkMode = LINK_NONE
           End If

           ' Run a valid DDE operation for Microsoft Access, such as
           ' closing the sample database NorthWind.MDB.
           AppItems.LinkExecute "[CloseDatabase]"

           ' Close the DDE link for the AppItems text box.
           AppItems.LinkMode = LINK_NONE
        End If

    End Sub

</PRE><P><LI>Start the project, and click the RunAccessDDE button. Note that the
   AppItems text box displays a tab-delimited string of system topics
   supported in Microsoft Access. The DBItems text box displays a tab-
   delimited string of table names from the sample database NorthWind.MDB.
<P>
</OL>NOTE: Microsoft Access does not support the LinkPoke method for any object
other than a SQL Topic. For instance, you cannot LinkPoke data into
a Microsoft Access table or form.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on using DDE in Microsoft Visual Basic, search for
"DDE" using the Microsoft Visual Basic Help menu.
<P>
For more information on DDE topics and items available in Microsoft
Access, search the Help Index for "DDE."
 
<PRE>Keywords          : IntpDde kbinterop
Version           : 1.10 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
