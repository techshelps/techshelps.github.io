

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Using DAO to Open Password-Protected Database (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161016">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1996/12/13">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo MdlDao">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to use the OpenDatabase method to open a Microsoft Access database that has a database password. Note that this is different from opening a database...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAZV,QAPN,QDKY,QAWK,QBWS,QDN9,QAHE,QDNJ,QAI5,QBS0,QBJZ,QAPF,QBXS,QA01 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using DAO to Open Password-Protected Database (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161016</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to use the OpenDatabase method to open a
Microsoft Access database that has a database password. Note that this is
different from opening a database that is secured with the Microsoft
Access user-level security feature.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you want to use the OpenDatabase method to open a password-protected
database, specify the database password as part of the Connect argument.
The syntax to open a database with the OpenDatabase method is as follows:
<P>
<PRE>  Set db = workspace.OpenDatabase(dbname, options, read-only, connect)

</PRE>NOTE: Even though the Options and Read-Only arguments of the OpenDatabase
method are documented in Help as being optional arguments, you must
provide them when you use the Connect argument. If you use a Connect
argument and you do not provide the Options and Read-Only arguments, you
receive run-time error 3031 "Not a valid password." This occurs even if
the password that you provided in the Connect argument is correct. If you
do not need to use a Connect argument, then you can omit the Options and
Read-Only arguments.
<P>
When you use the OpenDatabase method to open a password-protected
Microsoft Access database, the Connect argument of the OpenDatabase
method requires the following syntax:
<P>
<PRE>   "MS Access;pwd=&lt;password&gt;"

</PRE>The following example uses the OpenDatabase method to open the sample
database Northwind.mdb, which is protected with a database password of
"northwind."
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.

<OL><P><LI>Open the sample database Northwind.mdb for exclusive access. To do so,
   click Open Database on the File menu, and then click to select the
   Exclusive check box in the Open dialog box.

<P><LI>On the Tools menu, click Security, and then click Set Database password.

<P><LI>Type "northwind" (without the quotation marks) in both the Password and
   Verify boxes.

<P><LI>Click OK to close the Set Database Password dialog box.

<P><LI>Close the database.

<P><LI>Create a new, blank database.

<P><LI>Create a module and type the following procedure:
<P>
   NOTE: Substitute the correct path to Northwind.mdb on your hard drive
   in the following sample code.
<P>
<PRE>      Sub OpenDB()
       Dim db As Database
       Dim ws As WorkSpace
       Dim rst As Recordset
       Set ws = DBEngine.WorkSpaces(0)
       Set db = ws.OpenDatabase _
       ("C:\Program Files\Microsoft Office\Office\Samples\Northwind.mdb", _
       False, False, "MS Access;PWD=northwind")
       Set rst = db.OpenRecordset("Customers", dbOpenDynaset)
       If rst.RecordCount &gt; 0 Then
         rst.MoveLast
         MsgBox rst!CustomerID
       End If
       rst.Close
       db.Close
      End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>       OpenDB
</PRE><P>
   Note that a message box displays the Customer ID of the last record in
   the Customers table, indicating the database was successfully opened.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the OpenDatabase method, search the Help Index
for "OpenDatabase method."
<P>
For more information about database passwords, search the Help Index for
"passwords, database," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pwd secure<BR>
Keywords          : kbprg PgmHowTo MdlDao<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
