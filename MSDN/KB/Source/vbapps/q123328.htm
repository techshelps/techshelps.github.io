

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSQUERY: Undocumented DDE Request Items TierType and FileExt </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123328">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/11/29">
<META NAME="Keywords" CONTENT="IntpDde kbinterop PgmHowTo xlquery xlvbainfo kbinterop kbtool">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Query, there are two available dynamic data exchange (DDE) request items that are not documented. The TierType request item and the FileExt request item are both available on the system channel.  NOTE: Unlike earlier versions, online H...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QAGI,QAK6,QAUD,QBUG,QBUF,QBBI,QBS0,QAZ2,QAYY,QABM,QALW,QBWS,QBVV,QAKD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQUERY: Undocumented DDE Request Items TierType and FileExt</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123328</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 2.00 97
WINDOWS
kbtool kbinterop
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Query for Windows 95, version 2.0
<LI>Microsoft Query 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Query, there are two available dynamic data exchange (DDE)
request items that are not documented. The TierType request item and the
FileExt request item are both available on the system channel.
<P>
NOTE: Unlike earlier versions, online Help for Microsoft Query 97 documents
the TierType request item but does not document the FileExt request item.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following describes TierType and FileExt and the information returned
by each item:
<P>
TierType[/source]: This item returns the type of the specified data source.
<PRE>                   If no source is specified, the default data source
                   type is returned. If no source is specified, and there
                   is no source currently connected, Microsoft Query tries
                   to connect to that source. Return values are:

                      1 = Single Tier
                      2 = 1.5 Tier (Access 1.1, Btrieve)
                      3 = Multiple Tier (SQL Server, Oracle, Access 2.0)

</PRE>FileExt[/source]:  For single tier data sources, this item returns the file
<PRE>                   extension for the specified data source. As with
                   TierType, if no source is specified, the file extension
                   for the default data source is returned. If no source is
                   specified, and there is no source that is currently
                   logged on, Microsoft Query tries to connect to that
                   source.

</PRE>For example, if you request the FileExt item and you specify a dBASE data
source, the value "dbf" is returned. If you specify a Text data source,
both the values "txt" and "csv" are returned.
<P>
Note that the FileExt request item only returns a value for a single tier
type data source (not 1.5 tiers).
<P>
<P><h3>Visual Basic Example</h3>
 
<P>
In the following example, the TierType request item is assigned to the
variable tier_type, and returns the value 1 in a message box. The FileExt
request item is assigned to the variable file_ext and returns the value dbf
in cell A1 on Sheet1 in the active workbook. Note that Microsoft Query must
be running, or the Microsoft Query directory must be listed in the path
statement in your AUTOEXEC.BAT file to avoid receiving an error message
when you run the following procedure.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<PRE>Sub Run_Query()

   ' Dimension variables used
   Dim chan As Integer, sql As String
   Dim tier_type As Variant, file_ext As Variant

   ' Define sql statement
   sql = _
       "[open('SELECT customer.CUSTMR_ID FROM C:\win31\data\customer.dbf']"

   ' Establish DDE channel with Microsoft Query
   chan = DDEInitiate("MSQUERY", "System")

   ' Logon using dBase4 data source
   DDEExecute chan, "[Logon('dBase4')]"

   ' Run SQL statement
   DDEExecute chan, sql

   ' Request TierType item
   tier_type = DDERequest(chan, "TierType")
   MsgBox tier_type(1)

   'Request FileExt item
   file_ext = DDERequest(chan, "FileExt")
   Sheets("Sheet1").Range("A1").FormulaR1C1 = file_ext

   ' Terminate DDE channel
   DDETerminate chan

End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Query 97</h3>
 
<P>
For more information about using DDE with Microsoft Query 97, click the
Index tab in Microsoft Excel Help, type the following text
<P>
<PRE>   dde

</PRE>and then double-click the selected text to go to the "Use Dynamic Data
Exchange (DDE) with Microsoft Query" topic.
<P>
<P><h3>Microsoft Query 1.0 and 2.0</h3>
 
<P>
"Microsoft Query User's Guide," Chapter 9, "Using Dynamic Data
Exchange with Microsoft Query"
<P>
For more information about a specific DDE command to use with Microsoft
Query 1.0 and 2.0, click Contents on the Help menu and click the topic DDE
Commands.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 5.00 5.00c 7.00 7.00a 8.0 8.00<BR>
Keywords          : IntpDde kbinterop PgmHowTo xlquery xlvbainfo kbinterop kbtool<BR>
Version           : 1.00 2.00 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
