

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Dialog Box Show Method Fails with Reference Type Edit Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131237">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/06/06">
<META NAME="Keywords" CONTENT="kberrmsg kbprg PgmCtrlsStd">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, when you attempt to display a dialog box over another dialog box and the first dialog box contains an edit box that has the Reference or Formula  Edit Validation  type, you...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBV4,QA01,QAHP,QAPN,QANX,QBJZ,QBWS,QAK3,QAB4,QAP2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Dialog Box Show Method Fails with Reference Type Edit Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131237</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, version 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article,
when you attempt to display a dialog box over another dialog box and the
first dialog box contains an edit box that has the Reference or Formula
"Edit Validation" type, you may receive the following error message:
<P>
<PRE>   Run-time Error '1004':
   Show method of Dialogsheet class failed

</PRE>This error occurs when the second dialog box is displayed during an event
macro of a control on the first dialog box, and the first dialog box has
not been unloaded.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is a known limitation with Microsoft Excel 5.0 style dialog boxes. You
cannot stack a semi-modeless dialog box (any dialog box that has a 
Reference or Formula type edit box) on top of another dialog box.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this limitation, use one of the following methods:
<P>
<P><h3>Method 1: Change the Edit Box Type</h3>
 

<OL><P><LI>Select the edit box.

<P><LI>On the Format menu, click Object.

<P><LI>Click the Control tab, and then click a Type other than Reference or 
   Formula.
<P>
</OL><h3>Method 2: Unload the First Dialog Box Before You Show the Second</h3>
 
<P>
Unload the first dialog box before you show the second dialog box (which 
contains the Reference or Formula type edit box).
<P>
<P><h3>Method 3: Use UserForms</h3>
 
<P>
If you are using Microsoft Excel 97 or Microsoft Excel 98 Macintosh 
Edition, use UserForms instead of Microsoft Excel 5.0 dialogs. UserForms do 
not have this limitation.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q111867.htm">Q111867</A></B>
   TITLE     : XL Err Msg: "Not Enough Stack Space to Run Macro"

</PRE></OL><h3>Microsoft Excel 97</h3>
 
<P>
For information about using UserForms in Microsoft Excel 97:

<OL><P><LI>Start a new workbook and press ALT+F11 to activate the Visual Basic
   Editor.

<P><LI>On the Help menu, click Contents and Index.

<P><LI>Click the Index tab, type "UserForms Collection" (without the
   quotation marks), and then click Display.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: validate XL98 XL97 XL7 XL5<BR>
Keywords          : kberrmsg kbprg PgmCtrlsStd<BR>
Version           : WINDOWS:5.0,5.0c,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
