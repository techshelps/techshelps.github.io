

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Err Msg "The Other Application Quit" with MS Excel 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103258">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/08/19">
<META NAME="Keywords" CONTENT="IntpDde kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you are quitting Microsoft Excel over a dynamic data exchange (DDE) channel in Microsoft Access versions 1.1, 2.0, and 7.0, you may receive the following error message:...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAGB,QA1S,QAY5,QAB4,QDN9,QAB9,QBV8,QAZ2,QAH4,QAPN,QAHT,QBUG,QBUF,QDO5 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Err Msg "The Other Application Quit" with MS Excel 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103258</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you are quitting Microsoft Excel over a dynamic data exchange (DDE)
channel in Microsoft Access versions 1.1, 2.0, and 7.0, you may receive the
following error message:
<P>
<PRE>   The Other Application Quit

</PRE>In Microsoft Access 97, you may receive the error message:
<P>
<PRE>   Run-time error '291'.
   The other application in the DDE conversation quit unexpectedly.
   Restart the other application before reinitiating the DDE conversation.

</PRE><h2>CAUSE</h2>
 
<P>
Microsoft Excel version 4.0 automatically closes down any open DDE
channels when quitting, rather than waiting for the DDE channels to be
closed properly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two methods to work around this behavior. The first method is
to add an On Error Resume Next statement to your Microsoft Access
function, before the DDE quit command. The sample function below
demonstrates this method:
<P>
<PRE>   Function CallExcel ()
      Dim chan
      x = Shell("c:\excel\excel.exe c:\excel\macro1.xlm", 1)
      chan = DDEInitiate("Excel", "System")
      DDEExecute chan, "[Run(""macro1.xlm!Message"")]"
      AppActivate "Microsoft excel"
      On Error Resume Next
      DDEExecute chan, "[quit]"
      DDETerminate chan
    End Function

</PRE>The second method is to have Microsoft Excel quit on its own, rather than
having Microsoft Access send the quit instruction. You can do this by
having the second to last line in a Microsoft Excel macro call another
macro. The first macro will contain a line similar to
<P>
<PRE>   =ON.TIME(NOW()+"0:0:3","Leave")

</PRE>that will call a second macro in three seconds. The second macro will
contain the two lines:
<P>
<PRE>   =QUIT()
   =RETURN()

</PRE>You can remove the DDE quit command from your Microsoft Access function
if you use this method.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following sample function will open Microsoft Excel and run a macro
named Message. When the function instructs Microsoft Excel to quit, the
error message mentioned in the "Symptoms" section will occur.
<P>
<PRE>   Function CallExcel ()
      Dim chan
      x = Shell("c:\excel\excel.exe c:\excel\macro1.xlm", 1)
      chan = DDEInitiate("Excel", "System")
      DDEExecute chan, "[Run(""macro1.xlm!Message"")]"
      AppActivate "Microsoft excel"
      DDEExecute chan, "[quit]"
      DDETerminate chan
   End Function

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the DDEInitiate() function, search the Help
Index for "DDEInitiate," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : IntpDde kberrmsg kbinterop
Version           : 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
