

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: How to Create a Global User-Defined Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151490">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1996/05/23">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  By default, a user-defined function is limited in scope to the workbook in which the function resides. In other words, only sheets within the same workbook can call a user-defined function. If you want to call a user- defined function from another ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QAY5,QBJZ,QBV8,QAB9,QAGI,QBWS,QAUJ,QAMB,QATJ,QAH4,QAFI,QBXR,QA28 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Create a Global User-Defined Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151490</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Macintosh, versions 5.0, 5.0a
</UL> 
<P>
SUMMARY
 
<P>
By default, a user-defined function is limited in scope to the workbook in
which the function resides. In other words, only sheets within the same
workbook can call a user-defined function. If you want to call a user-
defined function from another workbook, you must first make a reference to
the workbook that contains the user-defined function.
<P>
For information about using references to call user-defined functions,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>      ARTICLE-ID: <B><A HREF="../vbapps/Q141288.htm">Q141288</A></B>
      TITLE     : How to Use a Custom Function in Another Workbook

</PRE>However, to be able to call a user-defined function from any file, new or
existing, you have to manually create a reference in each and every
workbook. To make your user-defined functions globally available, you can
group them into one workbook and make an Add-in. With a module sheet
active, click Make Add-in on the Tools menu. When the Add-in is loaded into
memory, your functions will be available to any file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Add-in must be loaded into memory for your functions to be available.
The Add-in can be placed in your XLSTART folder (directory),(usually
"C:\MSOFFICE\EXCEL\XLSTART" (without the quotation marks) in Windows
versions, and in the Excel Startup Folder on the Macintosh, either
"System:Preferences:Excel Startup Folder (5)" or "System:Preferences:Excel
Startup Folder" (without the quotation marks), or loaded through using the
Add-in Manager.
<P>
To load an Add-In through the Add-In Manager, follow these steps:

<OL><P><LI>On the Tools menu, click Browse.

<P><LI>Locate the file, click to select it, and then click OK.
<P>
</OL>Before making an Add-in, do the following:

<UL><LI>Save your source file. Once the Add-in is created, it cannot be edited.

<LI>Remove any debugging code, comments, extraneous sheets, and so on --
   anything that is not essential for the code to run. Leave this
   nonessential information in your source file.

<LI>You may specify a name for your Add-in.
<P>
</UL>To name an Add-In in Microsoft Excel version 5.0, follow these steps:

<OL><P><LI>On the File menu, click Summary Info.

<P><LI>Type the name in the Title box, and click OK.
<P>
</OL>To name an Add-In in Microsoft Excel version 7.0, follow these steps:

<OL><P><LI>On the File menu, click Properties.

<P><LI>Type the name in the Title box, and then click OK.
<P>
</OL>For information about creating a name and description for an Add-in, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>      ARTICLE-ID: <B><A HREF="../EXCEL/Q108425.htm">Q108425</A></B>
      TITLE     : How to Create Add-in Application Name and Description

</PRE></OL>REFERENCES
 
<P>
"Microsoft Excel Visual Basic User's Guide," version 5.0, Chapter 13,
"Creating an Add-in Application," and Chapter 3, "Creating User-Defined
Functions."
<P>
For more information about Installing Add-ins, click Search, or the Index
tab in Help and type:
<P>
<PRE> Add-ins

</PRE>For more information about User-defined Functions in Microsoft Excel 7.0,
click the Index tab in Help and type:
<P>
<PRE> User-Defined Function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00, 5.00a, 5.00c, 7.00, 7.00a<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS: 5.0, 5.0c, 7.0, 7.0a; MACINTOSH: 5.0, 5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
