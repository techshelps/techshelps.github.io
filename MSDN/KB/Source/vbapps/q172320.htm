

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Cannot Use Page Setup in Macro If No Printers Installed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172320">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1997/08/01">
<META NAME="Keywords" CONTENT="kbprg kbdta xlvbahowto xlvbainfo xlprint">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed above, if you run a Visual Basic for Applications macro that attempts to set or get the page setup properties for any sheet in a workbook, you may receive either of the following error messages     Run-time...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVH,QBVP,QAA1,QDI2,QADF,QARJ,QAF8,QDL9,QBWO,QBWN,QAPN,QAB4,QAOX,QBTX,QACT P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Cannot Use Page Setup in Macro If No Printers Installed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172320</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed above, if you run a Visual Basic
for Applications macro that attempts to set or get the page setup
properties for any sheet in a workbook, you may receive either of the
following error messages
<P>
<PRE>   Run-time error '1004':
   Unable to set the &lt;x&gt; property of the PageSetup class

   -or-

   Run-time error '1004':
   Unable to get the &lt;x&gt; property of the PageSetup class

</PRE>where &lt;x&gt; is any of the following words:
<P>
<PRE>   BlackAndWhite        Order
   BottomMargin         Orientation
   CenterFooter         PaperSize
   CenterHeader         PrintArea
   CenterHorizontally   PrintComments
   CenterVertically     PrintGridlines
   ChartSize            PrintHeadings
   Draft                PrintNotes
   FirstPageNumber      PrintTitleColumns
   FitToPagesTall       PrintTitleRows
   FitToPagesWide       RightFooter
   FooterMargin         RightHeader
   HeaderMargin         RightMargin
   LeftFooter           TopMargin
   LeftHeader           Zoom
   LeftMargin

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when there are no printer drivers installed on your
computer. Microsoft Excel cannot set or get page setup properties if no
printer drivers are installed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent this problem from occurring, install a printer driver on your
computer. Use the appropriate method for your situation:

<UL><LI>In Microsoft Windows 95, Microsoft Windows 3.x, and Microsoft Windows
   NT version 4.0, use the Printers option in Control Panel to add and
   remove printer drivers.

<LI>In Microsoft Windows NT version 3.x, use the Print Manager to
   add and remove printer drivers.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design of the versions of Excel listed above.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, page setup properties are only useful when you print or
print preview one or more sheets in a workbook. Because of this, you cannot
change or return most page setup properties unless at least one printer
driver is installed as the default printer.
<P>
If you click Page Setup on the File menu when no printer drivers are
installed, you receive the following error message:
<P>
<PRE>   There are no printers installed. Use the Printers option in Control
   Panel to install a printer.

</PRE>Just as you cannot access the Page Setup dialog box in this case, you
cannot access the properties in the dialog box programmatically.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 XL7 XL5 3.1 3.11 3.5 3.51 5.00c 7.00a<BR>
Keywords          : kbprg kbdta xlvbahowto xlvbainfo xlprint<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97; WINDOWS NT:5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
