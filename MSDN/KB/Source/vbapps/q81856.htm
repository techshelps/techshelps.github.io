

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Excel: Functions Recalculated If New Data or Cells Entered </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81856 ">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1992/03/19">
<META NAME="Keywords" CONTENT="PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the AREAS(), INDEX(), OFFSET(), CELL(), INDIRECT(), ROWS(), COLUMNS(), NOW(), RAND(), or TODAY() functions, the formulas that use these functions are recalculated when either of the following occur:   - You enter ne...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAY5,QAB9,QAUD,QBV8,QBWS,QAE5,QAG2,QDNZ,QA2Q,QACI,QBXS,QAY4,QAKJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Functions Recalculated If New Data or Cells Entered</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81856 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to :

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for the Macintosh, versions 2.2, 3.x, 4.x, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, when you use the AREAS(), INDEX(), OFFSET(), CELL(),
INDIRECT(), ROWS(), COLUMNS(), NOW(), RAND(), or TODAY() functions, the
formulas that use these functions are recalculated when either of the
following occur:

<UL><LI>You enter new data
<P>
   -or-

<LI>You insert or delete cells, rows, or columns on the worksheet
<P>
</UL>This recalculation occurs regardless of whether cells are dependent on the
new data.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To disable automatic recalculation, do either of the following:

<UL><LI>Choose Options from the Tools menu, select the Calculation tab and
   select the Manual option under Calculation (version 5.0) or choose
   Calculation from the Options menu and select the Manual option under
   Calculation.
<P>
   -or-

<LI>Avoid using the following functions:
<P>
<P><PRE>      AREAS()
      INDEX()
      OFFSET()
      CELL()
      INDIRECT()
      ROWS()
      COLUMNS()
      NOW()
      RAND()
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This functionality can be compared to the VOLATILE() macro function and the
Visual Basic, Applications Editions Volatile method (Version 5.0 only) in
Microsoft Excel. You can use the VOLATILE function, or the Volatile method
in a user-defined function to cause the custom function to be recalculated
under the same circumstances of data entry, insertions, and deletions.
<P>
<P><h3>Example for Microsoft Excel version 5.0</h3>
 

<OL><P><LI>In a new module, enter the following:
<P>
<P><PRE>      Function FeetPerSecond(MilesPerHour as Double) as Double
<PRE></PRE>         Application.Volatile
         FeetPerSecond=MilesPerHour*5280/3600
      End Function

</PRE><P><LI>On a worksheet, select the range A1:C50.

<P><LI>In the Formula bar, type the formula "=feetpersecond(60) quote (without
   the quotation marks).
<P>
   NOTE: This value must be entered as an array formula. To enter a formula
   as an array formula in Microsoft Excel for Windows or Microsoft Excel
   for OS/2, press CTRL+SHIFT+ENTER. In Microsoft Excel for the Macintosh,
   press COMMAND+ENTER.

<P><LI>Enter any number into cell D1 and note that the worksheet is
   recalculated.
<P>
</OL>Because this user-defined function contains the Volatile method, this
function is recalculated every time you enter data or insert or delete
cells, columns or rows into any open worksheet. If the FeetPerSecond user-
defined function did not contain the Volatile method, entering data into a
cell would not cause a recalculation to occur.
<P>
<P><h3>Example for Microsoft Excel versions 3.0 and 4.0</h3>
 

<OL><P><LI>Enter the following into a macro sheet:
<P>
<PRE>   A1:   FeetPerSecond
   A2:   =ARGUMENT("MilesPerHour",1)
   A3:   =VOLATILE()
   A4:   =RETURN(MilesPerHour*5280/3600)

</PRE><P><LI>Select cell A1 and choose Define Name from the Formula menu. Select
   the Function option in the Macro section and choose OK.

<P><LI>Open a new worksheet and select cells A1:C50.

<P><LI>Choose Paste Function from the Formula menu. Scroll to the end of
   the listed functions. Select MACRO1!FeetPerSecond(MilesPerHour)
   (without quotation marks) and choose the OK button.

<P><LI>In the formula bar, replace MilesPerHour with "60" (without the
   quotation marks).
<P>
   NOTE: This value must be entered as an array formula. To enter a formula
   as an array formula in Microsoft Excel for Windows or Microsoft Excel
   for OS/2, press CTRL+SHIFT+ENTER. In Microsoft Excel for the Macintosh,
   press COMMAND+ENTER.
<P>
<P><PRE>    Microsoft Excel will return the value 88 in cells A1:C50.
</PRE>
<P><LI>Enter any number into cell D1 and note that the worksheet is
   recalculated.
<P>
</OL>Because this user-defined function has been defined with the VOLATILE
function, this function will be recalculated every time you enter data or
insert or delete cells, columns or rows into any open worksheet. If the
FeetPerSecond user-defined function did not contain the VOLATILE function,
entering data into a cell would not cause a recalculation to occur.
<P>
The functions listed above can be thought of as containing this VOLATILE
function or method.
<P>
NOTE: In versions of Microsoft Excel earlier than version 3.0, the function
OFFSET() was available as a macro function only, not as a worksheet
function. The macro function VOLATILE() is not available in versions of
Microsoft Excel earlier than version 3.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, page 451
"Microsoft Excel Function Reference," version 3.0, page 247
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 2.00 2.01 2.10 2.20 2.21 3.00 4.00 4.00a<BR>
5.00 workbook udf<BR>
Keywords          : PgmOthr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
