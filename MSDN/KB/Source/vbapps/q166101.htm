

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Visible Property Does Not Apply to All CommandBars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166101">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1997/03/31">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you attempt to hide or show a commandbar in a Visual Basic for Applications macro you may receive the following error message:     Run-time error '-2147467259 (80004005)':    Method 'Visible' of object 'CommandBar' failed  CAUSE =====  This pr...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAPN,QBS0,QA01,QAH4,QBVP,QBVV,QANS,QAAP,QA9N,QA5V,QA5E,QAB9,QBTM,QBLO P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Visible Property Does Not Apply to All CommandBars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166101</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to hide or show a commandbar in a Visual Basic for
Applications macro you may receive the following error message:
<P>
<PRE>   Run-time error '-2147467259 (80004005)':
   Method 'Visible' of object 'CommandBar' failed

</PRE><h2>CAUSE</h2>
 
<P>
This problem will occur if you attempt to hide or show a Commandbar to
which the Visible property does not apply.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures
for illustration only, without warranty either expressed or implied,
including, but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. The Visual Basic procedures in
this article are provided 'as is' and Microsoft does not guarantee that
they can be used in all situations. While Microsoft support engineers can
help explain the functionality of a particular macro, they will not modify
these examples to provide added functionality, nor will they help you
construct macros to meet your specific needs. If you have limited
programming experience, you may want to consult one of the Microsoft
Solution Providers. Solution Providers offer a wide range of fee-based
services, including creating custom macros. For more information about
Microsoft Solution Providers, call Microsoft Customer Information Service
at (800) 426-9400.
<P>
The following example will loop through all of the CommandBars and display
the CommandBar name in a message box, without generating the error message
mentioned above.
<P>
NOTE: The "MsgBox ComBar.Name" line in the macro below is for demonstration
purposes. There are over 80 CommandBars that use the Visible property, so
you will receive over 80 message boxes. Remove this line if the macro is
taking too long to run.
<P>
<PRE>   Sub Command_Bars()
       On Error Resume Next
       For Each ComBar In Application.CommandBars
           ComBar.Visible = False
           MsgBox ComBar.Name
       Next ComBar
   End Sub

</PRE>An On Error statement was inserted before the For Each loop. If you run the
macro without the On Error statement, you will receive the error message
mentioned above.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Not all of the CommandBar items support the Visible property. Below is a
list of CommandBar items that are known to generate the error message
mentioned above, when used with the Visible property.
<P>
<PRE>   Index   CommandBar
   --------------------------------
   19      Query and Pivot
   20      Workbook tabs
   21      Cell
   22      Column
   23      Row
   24      Cell
   25      Column
   26      Row
   27      Ply
   28      XLM Cell
   29      Document
   30      Desktop
   31      Nondefault Drag and Drop
   32      AutoFill
   33      Button
   34      Dialog
   35      Series
   36      Plot Area
   37      Floor and Walls
   38      Trendline
   39      Chart
   40      Formula Bar
   41      PivotTable Context Menu
   42      Query
   43      Query Layout
   44      AutoCalculate
   45      Object/Plot
   46      Title Bar (Charting)
   47      Layout
   70      Shapes
   71      Inactive Chart
   72      Excel Control
   73      Curve
   74      Curve Node
   75      Curve Segment
   76      Pictures Context Menu
   77      OLE Object
   78      ActiveX Control
   79      WordArt Context Menu
   80      Rotate Mode
   81      Connector
   82      &amp;Wizard
   83      Add Command
   84      Built-in Menus
   85      System

</PRE>These CommandBars are used for context-sensitive menus and items such as
the current list of sheets in a workbook.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 xl97vbmigrate<BR>
Keywords          : kberrmsg kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
