

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Use a Microsoft Access Macro to Quit Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89596 ">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1992/09/27">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  It is possible to quit Microsoft Windows from within a Microsoft Access application by using a Windows application programming interface (API) function. To do this, you must...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QDL9,QBWO,QBWN,QAH4,QAGB,QAGI,QBWQ,QAY5,QBS0,QAB9,QAUR,QBV8,QAJH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use a Microsoft Access Macro to Quit Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89596 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
It is possible to quit Microsoft Windows from within a Microsoft Access
application by using a Windows application programming interface (API)
function. To do this, you must create a module that declares the API
function and a procedure to call the API function; then, you must call the
procedure in a macro using the RunCode action.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The call to the Windows dynamic-link library (DLL) below behaves in the
same way as the Exit command from the File menu in Program Manager in
Windows 3.x, or the "Shut Down" option from the Start button in Microsoft
Windows 95 and Windows NT 4.0. Each application must agree to be closed;
for example, if you choose Cancel when you are prompted to save a file,
your exit request is also canceled.
<P>
To create a Microsoft Access function that quits Windows, follow these
steps:
<P>
In Microsoft Access 1.0, 1.10, and 2.0:

<OL><P><LI>Create a module and type the following in the Declarations section:
<P>
   NOTE: In the following sample code, an underscore (_) is used as a
   line-continuation character. Remove the underscore from the end of the
   line when re-creating this code in Access Basic.
<P>
<P><PRE>      Option Explicit
      Declare Function ExitWindows% Lib "user" (ByVal dwReserved&amp;,_
<PRE></PRE>                                                ByVal wReturnCode%)

</PRE><P><LI>Type the following procedure:
<P>
<P><PRE>      Function ExitNow ()
<PRE></PRE>         Dim RetVal as Integer
         RetVal = ExitWindows(0, 0)
      End Function

</PRE><P><LI>Save the module as WinExit and close it.

<P><LI>Create the following new macro called TestExit:
<P>
<P><PRE>      Macro Name Condition  Action
      -----------------------------
<PRE></PRE>      TestExit              RunCode

      TestExit Actions
      ---------------------------
      RunCode
         Function Name: ExitNow()

</PRE><P><LI>Save the macro and close it.
<P>
</OL>In Microsoft Access 7.0 and 97:

<OL><P><LI>Create a module and type the following in the Declarations section:
<P>
<P><PRE>      Declare Function ExitWindowsEx Lib "user32" (ByVal uFlags As _
      Long, ByVal dwReserved As Long) As Long
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function ShutDownWindows()
<PRE></PRE>         'This will exit all applications and shut down Windows.
         Dim x As Long
         x = ExitWindowsEx(1, 0)
         application.Quit acExit
      End Function

   NOTE: If you are using Microsoft Windows NT, or if you would like
   to exit all applications but not log off the user, you can change
   the first ExitWindowsEx argument to 0 as follows:

      x = ExitWindowsEx(0, 0)

</PRE><P><LI>Save the module as WinExit and close it.

<P><LI>Create the following new macro called TestExit:
<P>
<P><PRE>      Macro Name Condition  Action
      -----------------------------
<PRE></PRE>      TestExit              RunCode

      TestExit Actions
      -----------------------------
      RunCode
         Function Name: ShutDownWindows()

</PRE><P><LI>Save the macro and close it.
<P>
</OL>You can now add the macro to a form and use it as you would any other
Microsoft Access macro.
<P>
Microsoft does not recommend quitting Microsoft Access by using Windows
API calls, although quitting in this manner can be safely accomplished. In
some cases, temporary files can be left in the Windows Temp directory;
however, you can safely delete the Temp files.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Programming Windows: The Microsoft Guide to Writing Applications for
Windows 3," by Charles Petzold, Microsoft Press, 1990
<P>
"Programmer's Reference Library: Microsoft Windows 3.1 Guide to
Programming Reference," Volumes 1-6, Microsoft Press, 1992
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sdk<BR>
Keywords          : kbprg PgmApi<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
