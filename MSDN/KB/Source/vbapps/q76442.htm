

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Macro to Save All Open Worksheets in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76442 ">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1991/09/24">
<META NAME="Keywords" CONTENT="PgmHowTo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBML,QBVP,QAUR,QAH4,QAU7,QBWS,QBS0,QBSO,QBJZ,QAUD,QAKJ,QA2Q,QAG2,QBT6,QBTI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Macro to Save All Open Worksheets in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76442 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P><h2>SUMMARY</h2>
 
<P>
The following explains a macro that adds a Save All command to the
File menu in Microsoft Excel. When selected, all files that have been
saved previously will be saved automatically. If files are open that
have not been saved previously, a dialog box will appear, prompting
the user for a filename.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you are using Excel version 3.0, you can use the add-in macro
AUTOSAVE.XLA to save all open documents automatically as you work.
This add-in macro is found in the EXCEL\LIBRARY subdirectory and is
documented in the "Microsoft Excel User's Guide."
<P>
Enter the following information into a macro sheet:
<P>
<PRE>   A1: sav_menu
   A2: =ADD.COMMAND(1,"file",A10:C10,7)
   A3: =ADD.COMMAND(2,"file",A10:C10,7)
   A4: =ADD.COMMAND(4,"file",A10:C10,7)
   A5: =ADD.COMMAND(5,"file",A10:C10,7)
   A6: =ADD.COMMAND(6,"file",A10:C10,7)
   A7: =RETURN()
   A8:
   A9:
   A10: Sa&amp;ve All          B10: Save   C10: Save all open documents
   A11:
   A12: Save
   A13: =ECHO(FALSE)
   A14: =FOR("i",1,COLUMNS(WINDOWS()),1)
   A15: =ACTIVATE(INDEX(WINDOWS(),1,i))
   A16: =GET.DOCUMENT(2)
   A17: =IF(ISERROR(B16),SAVE.AS?(),SAVE())
   A18: =NEXT()
   A19: =MESSAGE(TRUE,"All files have been saved!")
   A20: =ACTIVATE.PREV()
   A21: =WAIT(NOW()+0.00003)
   A22: =MESSAGE(FALSE,"")
   A23: =RETURN()

</PRE>After entering the above information, define the two macros shown
above. To do this:

<OL><P><LI>Select cell A1.

<P><LI>From the Formula menu, choose Define Name. Select the Command
   option and choose the OK button.

<P><LI>Select cell A12 and repeat step 2 above.
<P>
</OL>If you would like the Save All command to appear in the File menu
every time you open this particular macro sheet, you must define an
Auto_Open macro. You can do this by following steps 1 and 2 above,
except that in step 2 you must type "Auto_Open" (without the quotation
marks) in the Name text box before choosing the OK button.
<P>
For information about how to do this with a Visual Basic, Applications
Edition, macro, please see the following article(s) in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q131333.htm">Q131333</A></B>
   TITLE     : "Visual Basic Macro to Save All Open Workbooks in MS Excel"

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Functions and Macros," version 2.1
<P>
"Microsoft Excel User's Guide," version 3.0, pages 682-683
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.10 2.10C 2.10D 3.00 2.20 2.21<BR>
Keywords          : PgmHowTo PgmOthr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
