

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Focus Method Doesn't Set Focus to Correct Dialog Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129476">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1995/04/26">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmCtrlsStd">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you create a custom dialog box, if you use the Focus method in a Microsoft Visual Basic for Applications procedure to set  the focus of the dialog box to a specific control, the control that you  specify may not have the fo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADO,QBVP,QA01,QBV4,QBXS,QAHP,QBJZ,QAB5,QAPN,QANX,QA7O,QAOE,QAMN,QBS0,QAIA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Focus Method Doesn't Set Focus to Correct Dialog Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129476</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
<P>
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you create a custom dialog box, if you use the
Focus method in a Microsoft Visual Basic for Applications procedure to set 
the focus of the dialog box to a specific control, the control that you 
specify may not have the focus when you display the dialog box.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs under the following conditions:
<P>
<P><h3>Microsoft Excel for the Macintosh</h3>
 
<P>
- You set the focus of the dialog box to a control other than an edit box.
<P>
In Microsoft Excel for the Macintosh, you cannot set the focus of a dialog
box to a non-edit box, such as a button or drop-down box. This behavior is
by design of the user interface of the Macintosh.
<P>
<P><h3>Microsoft Excel for the Macintosh or for Windows</h3>
 

<UL><LI>You did not assign the procedure that contains the Focus method to the
   dialog frame.
<P>
</UL>The Focus property only works correctly when it is contained in a procedure
that is assigned to the dialog frame, or to a control in the dialog box. To
set the focus of the dialog box when the dialog box is displayed, you must
assign the procedure that contains the Focus method to the dialog frame.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To work around this behavior in Microsoft Excel for the Macintosh, use the
Focus method to set the focus to an edit box in the dialog box, and assign
the procedure that contains the Focus method to the dialog frame.
<P>
To work around this behavior in Microsoft Excel for Windows, assign the
procedure that contains the Focus method to the dialog frame.
The following is an example of how to set the focus in a custom dialog box
using the Focus method in Microsoft Excel for either platform:
<P>
<P><h3>Example</h3>
 

<OL><P><LI>Create a custom dialog box that contains two edit boxes, and a
   combination drop-down edit control.

<P><LI>In the dialog box, select the drop-down control, and note the name that
   appears in the Name box, such as "Drop Down 5."

<P><LI>From the Insert menu, choose Macro, and then choose Module. In the new
   module, enter the following:
<P>
<PRE>      Sub Main()
         DialogSheets(1).Show
      End Sub

      Sub DialogFrame1_Show()
         ' Note that the name used with the DropDowns method should
         ' be the name noted in Step 5 above.
         ActiveDialog.Focus = _
              DialogSheets(1).DropDowns("Drop Down 5").Name
      End Sub

</PRE><P><LI>Select the Dialog1 sheet tab, and select the dialog title. From the
   Tools menu, choose Assign Macro. From the Macro Name/Reference list,
   select DialogFrame1_Show, and choose OK.

<P><LI>From the Tools menu, choose Macro. From the Macro Name/Reference list,
   select Main, and choose Run.
<P>
   Note that the drop-down edit box has the focus.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
You can use the Focus property in a Visual Basic procedure to set the focus
of a dialog box that is displayed. The control on the dialog box that has
the focus is where user keyboard input is directed. The focus is indicated
by a flashing cursor or highlighted text within an edit box with the focus,
or, in Microsoft Excel for Windows only, by a dashed rectangle around the
control or around the selection within the control.
<P>
Note that you can also set the default focus of a dialog box when you
create your dialog sheet. To do this, use the Tab Order dialog box (from
the Tools menu, choose Tab Order). Note also that if you are using
Microsoft Excel for the Macintosh, you can only set the tab order for edit
boxes. For additional information, please see the following article(s) in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../URJump.htm">Q127790</A></B>
   TITLE     : MXL5: Can't Set Tab Order for Control Other Than Edit Box

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about the Focus property, choose the Search button in
MS Excel Visual Basic Help and type:
<P>
<PRE>   focus in dialog boxes
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00<BR>
Keywords          : kbcode kbprg PgmCtrlsStd<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
