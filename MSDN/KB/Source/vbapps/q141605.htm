

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Use Optional Parameters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141605">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo SynFnc">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  In Microsoft Access 7.0 and 97, you can create procedures that accept optional (not required) parameters when using the Optional keyword. This article shows two examples of ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHT,QAMS,QA1S,QA5V,QAUD,QAHE,QDN9,QAYL,QAMB,QAFF,QAVX,QAGU,QBS0,QA01,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use Optional Parameters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141605</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
In Microsoft Access 7.0 and 97, you can create procedures that accept
optional (not required) parameters when using the Optional keyword. This
article shows two examples of how you can create and use procedures with
optional parameters.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: In Microsoft Access 7.0, it was required that the variables declared
as optional were placed at the end of the calling procedure and that the
data type was explicitly a Variant. For example:
<P>
<PRE>   Sub MyTest(strTest1 As String, _
       Optional Test2 As Variant, _
       Optional Test3 As Variant)

</PRE>This was a requirement because optional parameters were passed at the end
of the function call. In Microsoft Access 97 improvements have been made to
the use of the Optional keyword by allowing the data type
casting of the optional variable to be pre-assigned. For example:
<P>
<PRE>    Sub MyTest(strTest1 As String, _
       Optional Test2 As String = "Test2", _
       Optional Test3 As String = "Test3")

</PRE>This allows for the placement of the optional variable anywhere in the
calling order of the function and allows you to test the contents of the
variable.
<P>
<P><h3>Example 1</h3>
 

<OL><P><LI>Create a module and type the following line in the Declarations section
   if it isn't already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function CallEmployeeInfo()
<PRE></PRE>         If Forms!employees!Title &lt;&gt; "Sales Representative" Then
           EmployeeInfo Forms!employees!FirstName, Forms!employees!LastName
         Else
           EmployeeInfo Forms!employees!FirstName, _
           Forms!employees!LastName, Forms!employees!Title
         End If
      End Function

      Sub EmployeeInfo(fname, lname, Optional Title)
         If IsMissing(Title) Then
            MsgBox lname &amp; ", " &amp; fname
         Else
            MsgBox lname &amp; ", " &amp; fname &amp; "   " &amp; Title
         End If

      End Sub

</PRE><P><LI>Open the Employees form in Form view.

<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>       ? CallEmployeeInfo()
</PRE><P>
   Note that the message box opens. If the title is not Sales
   Representative, then the option title argument is not sent to the Sub
   routine but the Sub routine will still process. It just displays the two
   arguments that were provided. If the title is Sales Representative, the
   argument title is sent and displayed in the message box.
<P>
</OL><h3>Example 2</h3>
 

<OL><P><LI>Create a module and type the following line in the Declarations section
   if it isn't already there:
<P>
<P><PRE>     Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<PRE>      Sub OptionalTest(Optional Country)
         Dim dbs As DATABASE, rst As Recordset
         Dim strSQL As String

         ' Return Database variable pointing to current database.
         Set dbs = CurrentDb
         If IsMissing(Country) Then
            strSQL = "SELECT * FROM Orders"
            'This will return all the records
         Else
            strSQL = "SELECT * FROM Orders WHERE [ShipCountry] = '" &amp;_
            Country &amp; "';"
         'This will return only values matching the argument you entered.
         End If
         Set rst = dbs.OpenRecordset(strSQL)
         rst.MoveLast
         Debug.Print rst.RecordCount

      End Sub

</PRE><P><LI>Type the following line in the Debug window, and then press ENTER:
<P>
<P><PRE>      OptionalTest "UK"
</PRE><P>
   Note that the record count will return the number of records where the
   ShipCountry is equal to UK.

<P><LI>Type the following line in the Debug window, and then press ENTER:
<P>
<P><PRE>      OptionalTest
</PRE><P>
   Note that you receive a record count for the whole table. This is
   because the option parameter was not supplied when the Sub procedure was
   called. This feature can be very useful for setting up criteria for
   queries.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Optional keyword, search the Help Index for
"optional argument," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : kbprg PgmHowTo SynFnc
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
