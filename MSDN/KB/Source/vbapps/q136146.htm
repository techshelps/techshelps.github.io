

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: VB Macro to Sort Custom List on First and Second Keys </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136146">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/09/04">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can select only one custom list to sort. However, you can create a Microsoft Visual Basic for Applications macro or procedure  that uses multiple sort keys along with custom lists.  MORE INFORMATION  Microsoft provides progr...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAE1,QAB6,QAH4,QA5V,QA2Q,QBWS,QAMB,QAIJ,QAVZ,QAC2,QABA,QARW,QBXT,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: VB Macro to Sort Custom List on First and Second Keys</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136146</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can select only one custom list to sort. However,
you can create a Microsoft Visual Basic for Applications macro or procedure 
that uses multiple sort keys along with custom lists.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>The following sample macro shows how you can perform a custom list sort on 
multiple keys. The macro performs a custom sort on the second key and then 
a normal sort on the first key.
<P>
<PRE>   Sub Second_Key_Custom_Sort()

       ' Selects the entire list.
       Selection.CurrentRegion.Select

       ' Does the sort here with Custom List 1 which is Normal.
       ' It also assumes the list has headers.
       ' The sort is done on column A.
       Selection.Sort Key1:=Range("A1"), Header:=xlYes, OrderCustom:=1

       ActiveSheet.Range("a2").Select

   ' Line label.
   Again:

       ' Loops until it reachs an empty cell.
       Do Until IsEmpty(ActiveCell)
           ' Gets row number of the starting row.
           StartRow = ActiveCell.Row
           ' Gets the value from the starting cell.
           CellVal = ActiveCell.Value
           ' Starts a loop that will continue until it finds a different
           ' value.
           Do Until ActiveCell.Value &lt;&gt; CellVal
               ActiveCell.Offset(1, 0).Select
           Loop
           ' Selects one cell up.
           ActiveCell.Offset(-1, 0).Select
           ' Gets the ending address.
           EndAdd = ActiveCell.Address
           ' Gets the ending row.
           EndRow = ActiveCell.Row
           ' Select from the beginning row to the ending row.
           ' If you know the columns you want to sort, you can
           ' concatenate them in here.
           ActiveSheet.Range(StartRow &amp; ":" &amp; EndRow).Select
           ' Does the sort for the selection.
           ' Assumes no headers.
           ' Bases Sort on the 4th item in custom list.
           Selection.Sort Key1:=Range("b" &amp; StartRow), _
               Header:=xlNo, OrderCustom:=4
           ' Selects the last cell in that group.
           ActiveSheet.Range(EndAdd).Select
           ' Starts on the next line with a new value.
           ActiveCell.Offset(1, 0).Select
           ' Goes to the line label again.
           GoTo Again
       Loop

   End Sub

</PRE><h3>To Create and Run This Macro</h3>
 

<OL><P><LI>In a new workbook, enter the macro code on a module sheet.

<P><LI>In Sheet1, enter the following sample custom list:
<P>
<PRE>       A1: Number   B1: Month
       A2: 1        B2: Sep
       A3: 2        B3: Nov
       A4: 1        B4: Jun
       A5: 1        B5: Jan
       A6: 2        B6: Mar
       A7: 1        B7: Dec
       A8: 2        B8: May
       A9: 2        B9: Feb
      A10: 1       B10: Apr

</PRE><P><LI>Select any cell in the list.

<P><LI>Run the macro.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about sorting lists, click the Index tab in
Microsoft Excel Help, type the following text
<P>
<PRE>   sorting data, lists

</PRE></OL>and then double-click the selected text to go to the "Sort a list"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.0a 5.0c 7.0 7.0a XL98 XL97 XL7 XL5 custom <BR>
list sorting user-defined<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS:5.0,5.0c,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
