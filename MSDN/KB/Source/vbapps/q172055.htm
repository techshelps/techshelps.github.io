

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Use Events to Determine When Word Quits </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172055">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1997/07/28">
<META NAME="Keywords" CONTENT="vb5all vb5howto vbwin GnrlVb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Visual Basic 5.0 introduces a keyword, WithEvents, that enables your Visual Basic application to respond to the events triggered by an ActiveX server. This article illustrates how you can use WithEvents in your Visual Basic application to trap the ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBS0,QAPN,QAGB,QAO4,QDO7,QAFF,QAMB,QAH4,QAC2,QBWS,QAW6 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use Events to Determine When Word Quits</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172055</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic 5.0 introduces a keyword, WithEvents, that enables your Visual
Basic application to respond to the events triggered by an ActiveX server.
This article illustrates how you can use WithEvents in your Visual Basic
application to trap the Quit event of the Microsoft Word Application
object.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To trap the events of an ActiveX server, you must first declare a variable
that will mirror the actual object. In this example, the ActiveX object is
the Word Application. The declaration appears as follows:
<P>
<PRE>   Dim WithEvents objWord As Word.Application

</PRE>Once the Word.Application object is declared in this manner, you can
respond to the events that it triggers. For example, to respond to the Quit
event of objWord that references Word.Application, you can create a sub
procedure named objWord_Quit.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
NOTE: Microsoft Word 97 is the only Microsoft Office application that
exposes a Quit event.

<OL><P><LI>In the Visual Basic editor, start a new "Standard EXE" project.

<P><LI>Click References on the Project menu. Check "Microsoft Word 8.0 Object
   Library" and click OK.

<P><LI>Click Add Class Module on the Project menu. The default class module
   name is Class1.

<P><LI>Add the following code to Class1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Dim WithEvents objWord As Word.Application
</PRE><P>
<P><PRE>      Private Sub Class_Initialize()
</PRE><P>
<PRE>         Form1.Label1.Caption = "Starting Word..."

         'Instantiate a new instance of Word and add
         'a new document
         Set objWord = New Word.Application
         objWord.Documents.Add
         objWord.Visible = True

         Form1.Label1.Caption = "Word is running..."

      End Sub

      Private Sub objWord_Quit()

         'Respond to the Quit event of Word
         Form1.Label1.Caption = "Word Quit!"

      End Sub

</PRE><P><LI>Add a Label and a CommandButton to Form1.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Dim objAppWithEvents As Class1
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         'Instantiate Class1
         Set objAppWithEvents = New Class1
      End Sub

      Private Sub Form_Unload(Cancel As Integer)
         Set objAppWithEvents = Nothing
      End Sub

</PRE><P><LI>Press the F5 key to run the application. Click Command1. The new
   instance of Word is loaded. Once the application is loaded and visible,
   the caption of the label on Form1 reads "Word is running..." Quit Word.
   Once Word exits, the caption of the label changes to "Word Quit!" in
   response to the Quit event of Word.
</OL> 
<PRE>Keywords          : vb5all vb5howto vbwin GnrlVb kbprg
Technology        : kbvba
Version           : WINDOWS:5.0 97
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
