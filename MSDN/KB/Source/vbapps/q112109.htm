

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Cannot Use Counter to Determine If Record Is New Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112109">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/03/01">
<META NAME="Keywords" CONTENT="kbusage FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The status of the AutoNumber field (or Counter field in version 2.0) cannot be used to determine if the current record is the new record.  CAUSE =====  In Microsoft Access versio...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QALX,QAM9,QDN9,QAPN,QDMH,QADK,QA7O,QA7N,QBTV,QBS0,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Cannot Use Counter to Determine If Record Is New Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112109</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The status of the AutoNumber field (or Counter field in version 2.0)
cannot be used to determine if the current record is the new record.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Microsoft Access version 1.x, the Counter field was Null until the
record was saved (that is, you moved to the next record, or clicked Save
Record on the File menu). Therefore, if you checked the Counter field
(using the IsNull() function) and it was Null, then the record being edited
was a new one. If not, then it was an existing record. The usual method was
to put the following expression in the form's BeforeUpdate property:
<P>
<PRE>   IsNull([&lt;counterfieldname&gt;])

</PRE>In Microsoft Access 2.0 and later, however, the AutoNumber field is updated
as soon as you begin inserting a new record, which invalidates the method
described above for Microsoft Access version 1.x.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>In Microsoft Access 7.0 and 97</h3>
 
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
There is a property called NewRecord. This property can be checked in the
BeforeUpdate of the form to determine if the record is a new one. For
example:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Categories form in Design view.

<P><LI>Add the following code to BeforeUpdate property of the form:
<P>
<P><PRE>      Private Sub Form_BeforeUpdate(Cancel As Integer)
<PRE></PRE>         Dim newmsg As String
         Dim newrec As Integer
         newrec = Me.NewRecord
         If newrec = True Then
             newmsg = "This is a new record"
             MsgBox newmsg
         End If
      End Sub

</PRE><P><LI>Close the module.

<P><LI>Open the form in Form view and click the new record selector.

<P><LI>Type "Bogus Category" in the Category Name text box and click the new
   record selector again. Note that a message box stating "This is a new
   record" appears. Click OK and you will be on a new record.
<P>
</OL><h3>In Microsoft Access 2.0</h3>
 
<P>
To determine if the current record is a new record using a Counter field in
Microsoft Access 2.0, you can check the OldValue property. OldValue
property will return Null for a new record.
<P>
To do this, use the following expression in the form's BeforeUpdate
property:
<P>
<PRE>   IsNull([&lt;counterfieldname&gt;].OldValue)

</PRE></OL>For another technique that does not require the use of a Counter field,
please see the following article here in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q112292.htm">Q112292</A></B>
   TITLE:      ACC: How to Determine if the Current Record Is the New
               Record

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the NewRecord property, search the Help Index
for "NewRecord property."
<P>
For more information about the OldValue property, search the Help Index for
"OldValue."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: forms<BR>
Keywords          : kbusage FmsHowTo<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
