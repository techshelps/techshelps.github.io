

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL97: Custom Menu Merges with Custom Toolbar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159548">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/11/15">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  A custom toolbar and custom menu bar merge together as one toolbar. If the menu bar or toolbar are controlled by macro code, you may receive the  following error message:     Run-time error '1004':    Application-defined or object-defined error  an...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QANS,QBVP,QBOG,QAJQ,QAUJ,QBWR,QAKE,QAH4,QBWS,QDKR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Custom Menu Merges with Custom Toolbar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159548</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A custom toolbar and custom menu bar merge together as one toolbar. If the
menu bar or toolbar are controlled by macro code, you may receive the 
following error message:
<P>
<PRE>   Run-time error '1004':
   Application-defined or object-defined error

</PRE>and neither the toolbar nor the menu bar are displayed properly.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when both of the following conditions are true:

<UL><LI>The custom menu was created using the Menu Editor in Microsoft Excel
   version 5.0 or 7.0.
<P>
   -and-

<LI>The custom toolbar was attached to the workbook.
<P>
   -and-
<P>
</UL>- The names of both the toolbar and menu bar are the same.
<P>
The merged menu bar and toolbar will function correctly; however, the menu
bar will simply be displayed on a toolbar instead of the menu as expected.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
For a custom menu bar to be referred to separately from a custom toolbar in
Microsoft Excel 97, each name must be unique. If the toolbar and menu bar
are given the same name, they are merged as a toolbar. Microsoft Excel does
not recognize that the menu bar is a menu if a toolbar has the same name.
<P>
The custom CommandBar cannot be renamed because it and the custom Toolbar
are one and the same. By renaming the CommandBar, the toolbar is renamed as
well. To rename the CommandBar, the file must be opened in an earlier
version of Microsoft Excel, such as version 5.0 or 7.0.
<P>
<P><h3>To rename the menu bar in Microsoft Excel 5.0 and 7.0</h3>
 

<OL><P><LI>Open the workbook and activate the module sheet.

<P><LI>On the Tools menu, click Menu Editor.

<P><LI>On the Menu bars list, click the custom menu bar. In the Caption text
   box type a new menu name. Click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The menu bar structure in Microsoft Excel 97 has changed. Menubars in
Visual Basic for Applications are now referred to as CommandBars and are
fundamentally the same as toolbars. The CommandBar object is a programmable
object and applies to the following items:

<UL><LI>Menu bars, toolbars and shortcut menus

<LI>Menus on menu bars and toolbars

<LI>Submenus on menus, submenus, and shortcut menus
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information about customizing menus, click the Office Assistant,
type "add menu", click Search, and then click to view "Add a command to a
menu."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Excel Help is not installed on your 
computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office Program or
               Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00 combine menubar menubars<BR>
Keywords          : kbcode kbprg xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
