

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: How to Avoid the Error "Can't Find Project or Library" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131298">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/06/07">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT=" In Microsoft Excel, when you open a workbook that contains a reference to another workbook or add-in, you may receive the following error message:     Can't find project or library  CAUSE =====  You can access functions and macros in another workboo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QBWS,QA3Q,QAB3,QAY2,QAUD,QDNM,QAH4,QBJZ,QBHQ,QA5V,QANF,QAB9,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Avoid the Error "Can't Find Project or Library"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131298</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you open a workbook that contains a reference to
another workbook or add-in, you may receive the following error message:
<P>
<PRE>   Can't find project or library

</PRE><h2>CAUSE</h2>
 
<P>
You can access functions and macros in another workbook by establishing a
reference to that workbook. This reference is established by choosing the
References command from the Tools menu and then selecting the workbook
containing the functions and/or macros.
<P>
When you establish a reference to another workbook in this manner,
Microsoft Excel hard-codes the path of the file when the reference is
established. When you open a Microsoft Excel file that has a saved
reference, Microsoft Excel searches for the file in the following places:

<UL><LI>The hard-coded path for the reference

<LI>The current working directory

<LI>All directories specified by PATH in the AUTOEXEC.BAT file

<LI>The path of the file that contains the reference

<LI>The path where the EXCEL.EXE file is located
<P>
</UL>This can present problems when workbooks are moved to different computers.
<P>
If Microsoft Excel can find the file in any of these locations, the
reference will be successfully established. If the file cannot be found,
you may receive the error message "Can't find project or library."
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To avoid this error message, use either of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Move the workbook that is referenced to any of the locations specified 
above.
<P>
<P><h3>Method 2</h3>
 
<P>
Use the Run method of the Application instead of using the References 
command on the Tools menu.
<P>
For example, if you have the following macro in a workbook that has a 
reference established to the add-in XLODBC.XLA:
<P>
<PRE>   Sub GetData()

      Dim r As Integer
      Dim c As Integer
      Dim chan As Variant

      ' Establish a channel to the data source Nwind.
      chan = Sqlopen("DSN=NWIND")

      ' Execute a query on the channel to return all the records from
      ' the EMPLOYEE table.
      c = Sqlexecquery(chan, "SELECT * FROM EMPLOYEE")

      ' Return the data from the query to A1 on the active sheet.
      r = Sqlretrieve(chan, ActiveSheet.Cells(1))

      ' Close the channel.
      Sqlclose chan

   End Sub

</PRE>You could replace this macro with the macro below. You do not need to 
establish a reference to XLODBC.XLA to run this macro:
<P>
<PRE>   Sub GetData()

      Dim r as Variant
      Dim c as Variant
      Dim chan as Variant

      ' Open the add-in XLODBC.XLA which is located in the \MSQUERY
      ' subdirectory of the Microsoft Excel Library directory.
      Workbooks.Open (Application.LibraryPath _
         &amp; "\MSQUERY\XLODBC.XLA")

      ' Depending on the add-in, you may need to use the
      ' RunAutoMacros method to run the add-ins auto-open procedures.
      ' For example, the Analysis ToolPak - VBA add-in (ATPVBAEN.XLA)
      ' needs to run its auto-open procedure before you can use the
      ' NETWORKDAYS() function. The line would read as follows:
      '
      '    Workbooks("ATPVBAEN.XLA").RunAutoMacros (xlAutoOpen)

      ' Establish a channel to the data source Nwind.
      chan = Run("XLODBC.XLA!Sqlopen", "DSN=NWIND")

      ' Execute a query on the channel to return all the records from
      ' the EMPLOYEE table.
      c = Run("XLODBC.XLA!Sqlexecquery", chan, _
         "SELECT * FROM EMPLOYEE")

      ' Return the data from the query to A1 on the active sheet.
      r = Run("XLODBC.XLA!Sqlretrieve", chan, ActiveSheet.Cells(1))

      ' Close the channel.
      Run "XLODBC.XLA!Sqlclose", chan

   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../EXCEL/Q124277.htm">Q124277</A></B>
   TITLE     : XL5 Err Msg: "Can't Find Project or Library" Running Macro

</PRE><h2>REFERENCES</h2>
 
<P>
"Developing Microsoft Excel 5 Solutions," Eric Wells, Microsoft Press,
pages 576-577.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: addin locate<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS: 5.0, 5.0c, 7.0; MACINTOSH: 5.0, 5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
