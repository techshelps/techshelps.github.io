

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRJ41: "Out Of Memory" Adding Task or Resource in Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136880">
<META NAME="KBModify" CONTENT="1997/09/26">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Project, when you use the Add method in a macro to add a task or resource to your project, you may receive the following error messages     Out of memory or system resources  followed by:     Run-time error '7':     Out of memory.  Add...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAPN,QAIM,QAH4,QAVX,QAVW,QAFF,QAEF,QADZ,QBTC,QBS0,QAG0,QBWS,QAUJ,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRJ41: "Out Of Memory" Adding Task or Resource in Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136880</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project for Windows 95, version 4.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Project, when you use the Add method in a macro to add a task
or resource to your project, you may receive the following error messages
<P>
<PRE>   Out of memory or system resources

</PRE>followed by:
<P>
<PRE>   Run-time error '7':

   Out of memory.

</PRE>Additionally, when you run a Visual Basic macro in another program and you
use OLE Automation to add a task or resource to a project in Microsoft
Project, you may receive the error messages described above.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if you use the Add method of the Tasks collection, or
the Resource collection, without specifying a name argument.
<P>
For example, if you run the following macro in Microsoft Project, you
receive these error messages:
<P>
<PRE>   Sub Test()
      Projects(1).Tasks.Add
   End Sub

</PRE>Although the Help topic for the Add method indicates that this argument is
required, it also states that by default, the name argument is Empty.
<P>
In Microsoft Project version 4.0, you can add a task or resource using the
Add method without specifying a name argument. In this case, a task or
resource is added without a task name or resource name.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid receiving an "out of memory" error message when you add a task to
a project using a macro, include a value for the name argument, even if it
is empty as in the following examples:
<P>
<P><h3>In Microsoft Project</h3>
 
<P>
<PRE>   Sub Test()
      ' Add task "Task1"
      Projects(1).Tasks.Add "Task1"
   End Sub

</PRE>-or-
<P>
<PRE>   Sub Test()
      ' Add blank task
      Projects(1).Tasks.Add ""
   End Sub

</PRE><h3>Using OLE Automation</h3>
 
<P>
<PRE>Sub Test()

   Dim x As Object, y As Object
   Set x = GetObject("", "MSProject.Application")
   x.FileNew
   Set y = x.Projects(1).Tasks.Add ""

End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Note that when you run a Visual Basic macro in another program and you
access Microsoft Project as an OLE Automation object, if you receive the
"Run-time error '7':" error message as described above, the error message
may contain question mark characters such as "?4????" instead of the "out
of memory" text.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../URJump.htm">Q136881</A></B>
   TITLE     : OLE Automation Run-Time Error Message Contains Question
               Marks

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using the Add method to add a task or resource
in Microsoft Project, click the Index tab in Microsoft Project Help, type
the following text
<P>
<PRE>   add

</PRE>double-click the selected text, and then double click "add method" to go to
the "Add Method" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.10<BR>
Keywords          : kbcode kbprg<BR>
Version           : 4.1<BR>
Platform          : WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
