

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Run-time Error '424': Object Required Using DAO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163475">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1997/02/11">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBVP,QAPN,QDN9,QAW6,QBWS,QBJZ,QBHQ,QAEF,QAH4,QAA1,QAB3,QAYY,QAD7,QAB4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Run-time Error '424': Object Required Using DAO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163475</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Visual Basic for Applications macro that uses Data Access
Object, you may receive the following error message:
<P>
<PRE>   Run-time Error '424':
   Object Required

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur when either of the following is true:

<UL><LI>The Data Access Object library is not properly referenced.
<P>
<P><PRE>    -or-
</PRE>
<LI>The Data Access Object files are missing, damaged, or improperly
   registered.
<P>
</UL>NOTE: This problem may also occur if, when you use Microsoft Excel under
Windows NT 4.0, the Microsoft Access Object Library is not referenced.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, use the following appropriate method.
<P>
<P><h3>Method 1: Data Access Object Library Is Not Registered</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.
If you are running Windows NT, you should also update your Emergency
Repair Disk (ERD).
<P>
If the Data Access Object library is not properly referenced, follow these
steps to create a reference to the library:
<P>
Microsoft Excel 97:

<OL><P><LI>Open the file and press ALT+F11 to open the Visual Basic Editor.

<P><LI>In the Visual Basic Editor, click References on the Tools menu.

<P><LI>In the References dialog box, under Available References, click
   "Microsoft DAO 3.5 Object Library," and then click OK.
<P>
   If "Microsoft DAO 3.5 Object Library" is not listed in the box under
   Available References, click Browse and find the Dao350.dll file.
<P>
   This file is located in the following folder:
<P>
<P><PRE>      Program Files\Common Files\Microsoft Shared\Dao
</PRE>
<P><LI>Click the file and click OK.
<P>
</OL>Microsoft Excel 7.0:

<OL><P><LI>Click a Module Sheet.

<P><LI>On the Tools menu, click References.
<P>
   NOTE: It is necessary click a Module Sheet. References is not available
   on the Tools menu on a worksheet, dialog sheet, or chart sheet.

<P><LI>In the References dialog box, under Available References, click
   "Microsoft DAO 3.0 Object Library," and then click OK.
<P>
   If "Microsoft DAO 3.0 Object Library" is not listed in the box
   under Available References, click Browse and find the Dao3032.dll file.
<P>
   This file is located in the following folder:
<P>
<P><PRE>      Program Files\Common Files\Microsoft Shared\Dao
</PRE><P>
   Click the file and click OK.

<P><LI>In the References dialog box, click OK.
<P>
</OL>NOTE: If you are using Windows NT 4.0, you may also need to create a
reference to the Microsoft Access Object Library. To do this, use the
steps shown above for your version of Microsoft Excel.
<P>
Also, if you reference the Microsoft Access Object Library, it must be
referenced BEFORE the Microsoft Data Access Object Library. To change the
order in which libraries are referenced in Microsoft Excel 97, select the
appropriate library in the References dialog box. Then, use the Priority
buttons to move the references up and down in the list as required. When
you are done, click OK.
<P>
In Microsoft Excel 7.0, if the Microsoft Data Access Object Library is
referenced BEFORE the Microsoft Access Object Library, click the Microsoft
Data Access Object Library to remove the check mark from the check box and
Click OK. From the Tools menu, click Reference and select the Microsoft
Data Access Object Library check box to reselect this option. Click OK.
This places the Microsoft Data Access Object Library reference after the
Microsoft Access Object Library in the reference list.
<P>
<P><h3>Method 2: Data Access Object Files are Missing, Damaged, or Unregistered</h3>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE></OL>Testing the Data Access Object Engine:
<P>
Before you proceed with the steps to replace the Data Access Object files,
test the Data Access Object engine with a macro to ensure that it is
working. To do this, type the following macro in a new module, and then run
the macro:
<P>
<PRE>   Sub DAO_Test()
       MsgBox DBEngine.Version
   End Sub

</PRE>If the macro returns an error message, and you already referenced the Data
Access Object library, you must reinstall the Data Access Object engine by
removing and then reinstalling it. If you installed Data Access Object
multiple times, (this can occur when you install multiple programs), you
must edit the registry so that the Data Access Object components are
removed when you remove Microsoft Office. To edit the registry, use the
following steps:

<OL><P><LI>On the Start menu, click Run. In the Open box, type "regedit"
   (without the quotation marks), and then click OK.

<P><LI>Open the following registry key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE/Software/Microsoft/Windows/Current
      Version/SharedDLLs
</PRE>
<P><LI>Click the following value in the SharedDLLs folder:
<P>
<P><PRE>      C:\Program Files\Common Files\Microsoft Shared\DAO\dao3032.dll
</PRE><P>
   If you are using Microsoft Excel 97, click the following value in the
   SharedDLLs folder:
<P>
<P><PRE>      C:\Program Files\Common Files\Microsoft Shared\DAO\DAO350.DLL
</PRE>
<P><LI>On the Edit menu, click Modify. The edit DWORD value dialog box appears.
   If the value data box value is greater than 1, change it to 1, and then
   click OK.

<P><LI>On the Registry menu, click Exit.

<P><LI>Run the Microsoft Office Setup program in maintenance mode. When you are
   prompted, click Remove All.

<P><LI>When you are prompted to remove shared components, click Remove All.
<P>
   If you are prompted to restart the computer after Setup is completed,
   do so.

<P><LI>Install Microsoft Office.
<P>
</OL>If you continue to receive the error message in this article, continue
troubleshooting by using the following steps:

<OL><P><LI>Open the file in Microsoft Excel.

<P><LI>Click the module sheet to switch to it. If you are using Microsoft Excel
   97, press ALT+F11 to start Visual Basic for Applications, and then click
   the module sheet that contains the Data Access Object macro code.

<P><LI>On the Tools menu, click References. Clear any references to the Data
   Access Object libraries. Click OK.

<P><LI>On the Tools menu, click Add-Ins. If you are using Microsoft Excel 97,
   you can find the Add-Ins command only on a worksheet. Clear all the
   add-in check boxes and click OK.

<P><LI>On the File menu, click Save. Then, click Exit on the File menu.

<P><LI>Restart Microsoft Excel and open the file. Reference the Data Access
   Object library you want to use.
<P>
</OL>If the problem continues to occur after you follow these steps, you may
need to reinstall Microsoft Windows 95.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID   : <B><A HREF="../OFFICE/Q178400.htm">Q178400</A></B>
   ARTICLE-TITLE: OFF97: Installing Win 95 to New Folder to Tshoot Office
                  Problems
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 97 opendatabase XL7 XL97<BR>
Keywords          : kberrmsg kbprg<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
