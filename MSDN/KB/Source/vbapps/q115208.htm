

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Error Calling Macro Contained in Open Add-In </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115208">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/05/22">
<META NAME="Keywords" CONTENT="kbprg PgmOthr xlvbainfo xladdins kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you call a macro that is contained in an add-in file, either by using the Call statement or by using the macro name in a Visual Basic procedure in Microsoft Excel, you receive one of the following error messages, even if the add-in that contai...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH0,QBVP,QAH4,QBWS,QAGI,QAB4,QAB3,QBS0,QAB9,QBVV,QAPN,QAIF,QA2Q,QAAP,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Error Calling Macro Contained in Open Add-In</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115208</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you call a macro that is contained in an add-in file, either by using
the Call statement or by using the macro name in a Visual Basic procedure
in Microsoft Excel, you receive one of the following error messages, even
if the add-in that contains the macro is open at the time:
<P>
<PRE>   Sub or Function not defined

   -or-

   Compile error:
   Sub or Function not defined

</PRE><h2>CAUSE</h2>
 
<P>
This behavior occurs when the add-in that contains the macro that you are
calling is not selected in the References dialog box. When you open an add-
in file, the add-in is added to the References dialog box, but is not
selected. This is by design of Microsoft Excel.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving an error message when you call a macro that is contained
in an add-in file from a Visual Basic procedure, do either of the
following:

<UL><LI>Open the add-in file (either before you run the macro, or as a command
   in the macro), and then use the Run method of the Application object to
   run the macro as in the following example:
<P>
<P><PRE>      Application.Run("ADDIN.XLA!Macro_Name")
</PRE><P>
   -or-

<LI>Reference the add-in from the procedure that is calling the add-in macro
   with the following steps. (Note that when you use this procedure, the
   path to the add-in file is hard-coded in the module, so that in order
   to run the procedure, the add-in file must be located in the same
   directory as when you referenced it.)
<P>
   1. Activate the module that contains the procedure that is running the
<P><PRE>      add-in macro.
</PRE><P>
   2. On the Tools menu, click References.
<P>
   3. If the add-in that contains the macro you want to run is listed in
<P><PRE>      the Available References list box, select (check) its checkbox. Click
      OK, and skip step 4.
</PRE><P>
<P><PRE>      If the add-in that contains the macro you want to run is NOT listed
      under Available References, click Browse.
</PRE><P>
   4. From the File Name list, select the add-in you want to reference and
<P><PRE>      click OK. Click OK again.
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
When you use the References dialog box to directly reference another
workbook, add-in, or object library file, you can run a macro contained in
the referenced file using the Call statement and the macro name, or only
the macro name.
<P>
For more information about running a macro that is contained in an add-in,
query on the following words in the Microsoft Knowledge Base:
<P>
<PRE>   tools and references and addin and run

</PRE><h2>REFERENCES</h2>
 
<P>
For a definition of a Referenced Project, click the Search button in Help
and type:
<P>
<PRE>   referenced project
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 97 7.00 5.00 err msg
<P>

Keywords          : kbprg PgmOthr xlvbainfo xladdins kbprg<BR>
Version           : 5.00 5.00c 7.00 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
