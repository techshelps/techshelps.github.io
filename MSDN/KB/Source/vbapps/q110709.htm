

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL5: Drag to Replace in Recorded Macro Returns Invalid Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110709">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/01/27">
<META NAME="Keywords" CONTENT="kbprg PgmOthr kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0 for Windows, when you are recording a Visual Basic subroutine and you drag a cell or range of cells to another cell or range of cells to replace the original information, the recorded subroutine may contain syntax err...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA5V,QBS0,QBJZ,QDNZ,QDMR,QBXS,QAFF,QBWS,QBVP,QAB4,QAG2,QBXT,QA9N,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Drag to Replace in Recorded Macro Returns Invalid Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110709</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
- Microsoft Excel for Windows, version 5.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel version 5.0 for Windows, when you are recording a Visual
Basic subroutine and you drag a cell or range of cells to another cell or
range of cells to replace the original information, the recorded subroutine
may contain syntax errors that prevent it from functioning correctly.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, you may need to modify the recorded code. The
modified code should resemble the following:
<P>
<PRE>   Sub Macro1()
      Range("A1").Select
      Selection.Cut (Range("B1"))
      Range("B1").Select
   End Sub

</PRE>The third line, which originally contained invalid code, has been replaced
by a line of code that performs the correct action.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In a new workbook, create a new worksheet and enter the following
    values:
<P>
<PRE>        A1: Alpha   B1: Bravo

</PRE><P><LI>From the Tools menu, choose Record Macro, and then choose Record New
    Macro.

<P><LI>In the Record New Macro dialog box, choose the Options button. In the
    Expanded Record New Macro dialog box, Under Language, verify that the
    Visual Basic option is selected. Choose OK to begin recording.

<P><LI>Select the contents of cell A1 and drag it to cell B1.

<P><LI>When you are prompted with the "Replace contents of destination cells?"
    message, choose OK.

<P><LI>To stop the Macro Recorder, choose Record Macro from the Tools menu,
    and then choose Stop Recording.

<P><LI>Switch to the new Visual Basic module.
<P>
</OL>The following subroutine should be contained in the module:
<P>
<PRE>   Sub Macro1()
      Range("A1").Select
   ExecuteExcel4Macro "CUT(Range("A1"),Range("B1"))"
      Range("B1").Select
   End Sub

</PRE></OL>The third line (which starts with the ExecuteExcel4Macro method) will
appear in red, indicating that the line contains a syntax error.

<OL><P><LI>Switch to the worksheet.

<P><LI>In cell A1, type "Charlie" (without the quotation marks).

<P><LI>With cell A1 selected, choose Macro from the Tools menu.

<P><LI>From the list of macros, select Macro1 and choose the Run button.
<P>
</OL>You will receive the error message "Syntax error" and the third line
of the subroutine will be selected.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00<BR>
Keywords          : kbprg PgmOthr kbprg<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
