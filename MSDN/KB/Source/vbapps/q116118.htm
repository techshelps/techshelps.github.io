

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Visual Basic Example of Spinner Use on a Date </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116118">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/06/13">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto PgmCtrlsStd PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, you can use a spinner control to change values on a worksheet or in a Microsoft Visual Basic for Applications procedure. In order to use the  spinner to increment and decre...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAHP,QAH4,QBJZ,QBV4,QBWS,QASR,QAKD,QBXS,QA01,QAB5 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Visual Basic Example of Spinner Use on a Date</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116118</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article,
you can use a spinner control to change values on a worksheet or in a
Microsoft Visual Basic for Applications procedure. In order to use the 
spinner to increment and decrement a value over a wide range, you must set 
and use the spinner in conjunction with another value or cell to calculate 
both positive and negative values.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>The following Visual Basic macro (Sub procedure) example uses a spinner 
control to increment and decrement a date value in an edit box.
<P>
<P><h3>Sample Visual Basic Macro Procedure</h3>
 
<P>
To create the sample dialog box and macro code, follow these steps:

<OL><P><LI>In Microsoft Excel 5.0 and 7.0, create a new workbook, click Macro on
   the Insert menu, and then click Dialog.
<P>
   In Microsoft Excel 97 or Microsoft Excel 98, create a new workbook,
   right-click any sheet tab, and then click Insert. In the Insert dialog, 
   click MS Excel 5.0 Dialog, and click OK.

<P><LI>Use the tools on the Forms toolbar to create one edit box and one
   spinner on the dialog sheet.

<P><LI>In Microsoft Excel 5.0 and 7.0, click Macro on the Insert menu, and
   then click Module. In the new module sheet, type the Visual Basic macro
   code in this step.
<P>
   In Microsoft Excel 97 or Microsoft Excel 98, press ALT+F11 to activate
   the Visual Basic Editor. (Or, click the Tools menu, point to Macro,
   and then click Visual Basic Editor.) On the Insert menu, click Module. 
   In the new module, type the Visual Basic macro code in this step.
<P>
<P><PRE>      ' Defines variable called "OldSpin" as an integer, and makes it
      ' available to all subroutines.
      Public OldSpin As Integer
</PRE><P>
<P><PRE>      ' This routine is assigned to the spinner to run when you choose the
      ' spinner. It will determine the difference between the current
      ' spinner value and OldSpin, and use the difference to increment or
      ' decrement the date in the edit box.
<PRE></PRE>      Sub SpinDate()

          ' Sets the edit box value based on the difference
          ' between OldSpin and the spinner value.
          DialogSheets(1).EditBoxes(1).Text = _
              DateValue(DialogSheets(1).EditBoxes(1).Text) - OldSpin + _
              DialogSheets(1).Spinners(1).Value

          ' Resets OldSpin to the spinner value.
          OldSpin = DialogSheets(1).Spinners(1).Value

      End Sub

      ' This routine initializes the spinner and OldSpin to a value of
      ' 15000, populates the edit box with today's date, and displays the
      ' dialog box.
      Sub ShowDialog()

          ' Sets OldSpin to 15000.
          OldSpin = 15000

          ' Sets the current spinner value to 15000.
          DialogSheets(1).Spinners(1).Value = OldSpin

          ' Sets the edit box to today's date.
          DialogSheets(1).EditBoxes(1).Text = Date

          ' Displays the dialog box.
          Dialogsheets(1).Show

    End Sub

</PRE><P><LI>In Microsoft Excel 5.0 and 7.0, click the dialog sheet.
<P>
   In Microsoft Excel 97 or Microsoft Excel 98, press ALT+Q to return to
   Microsoft Excel (or click Close And Return To Microsoft Excel on the
   File menu). Activate the dialog sheet if it is not the active sheet.

<P><LI>Right-click (or CONTROL-click) the spinner control on the dialog sheet
   and click Assign Macro on the shortcut menu. Click the SpinDate macro
   and click OK.

<P><LI>In Microsoft Excel 5.0 and 7.0, click Macro on the Tools menu. Click the
   macro "ShowDialog" and click Run to run the macro.
<P>
   In Microsoft Excel 97 or Microsoft Excel 98, point to Macro on the Tools
   menu, and then click Macros. Click the macro "ShowDialog" and click Run 
   to run the macro.
<P>
</OL>The spinner increments or decrements the date in the edit box. (By default,
this date is the current date.) You can type a different date manually.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Excel 97</h3>
 
<P>
For more information about using spinners, click the Index tab in Microsoft
Excel 97 Help, type the following text
<P>
<PRE>  spinner controls

</PRE></OL>and then double-click the selected text to go to the "About adding buttons,
check boxes, and other controls" topic.
<P>
<P><h3>Microsoft Excel 7.0</h3>
 
<P>
For more information about using spinners, click the Index tab in Microsoft
Excel 7.0 Help, type the following text
<P>
<PRE>  spinners, creating

</PRE>and then double-click the selected text to go to the "Summary of controls"
topic.
<P>
<P><h3>Microsoft Excel 5.0 for Windows and Macintosh</h3>
 
<P>
For more information about using spinners, choose the Search button in
Help, and type:
<P>
<PRE>  spinners, creating

</PRE>Choose the Show Topics button, select the topic "Spinner Button", and
choose Go To.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00a 7.00 5.00 5.00a 5.00c XL98 XL97 XL7 XL5<BR>
Keywords          : kbcode kbprg xlvbahowto PgmCtrlsStd PgmHowto<BR>
Version           : WINDOWS:5.0,5.0c,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
