

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Print a Constant Number of Lines Per Group </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119073">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1994/08/07">
<META NAME="Keywords" CONTENT="kbusage RptEvent">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to create a constant number of lines per data group on a report. You can use this method to consistently print 15 lines per data group, regardless of t...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAKJ,QA5V,QABO,QBXT,QAIB,QAPN,QBS0,QAML,QAMA,QAKC,QA5F,QBC6,QA7O P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Print a Constant Number of Lines Per Group</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119073</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to create a constant number of lines per data
group on a report. You can use this method to consistently print 15 lines
per data group, regardless of the actual number of items within the group.
Note that if the group contains more than 15 items, the function used by
this method will not apply.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A HREF="../ACCESS/Q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in earlier
versions. For more information about Access Basic, please refer to the
"Introduction to Programming" manual in Microsoft Access version 1.x or the
"Building Applications" manual in version 2.0.
<P>
The steps below demonstrate how to create a report in the sample database
Northwind.mdb (or NWIND.MDB in Microsoft Access 2.0 or earlier) with a
constant number of lines per data group. You can use this method in a main
report or subreport:

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a new report based on the Products table.

<P><LI>Group the data by the CategoryID field. Set the GroupHeader property
   to Yes.
<P>
   NOTE: In Microsoft Access 2.0 or earlier, there is a space in
   Category ID.

<P><LI>Add a text box control with the following properties to the
   CategoryID header section:
<P>
<P><PRE>      Name: TotGrp
      ControlSource: =Count(*) 'Returns the number of records per group.
</PRE>
<P><LI>Set the CategoryID header section's ForceNewPage property to
   Before Section.

<P><LI>Add a text box control bound to the ProductName field with the
   following properties to the report's detail section:
<P>
<P><PRE>      Name: ProductName
      ControlSource: [ProductName]
</PRE><P>
   NOTE: In Microsoft Access 2.0 or earlier, there is a space in
   Product Name.

<P><LI>Create a line control in the detail section that extends horizontally
   across the section. Set the line control's Name property to LineControl.

<P><LI>Create a new module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Compare Database 'Use database order for string comparisons.
      Option Explicit
      Global TotCount As Integer
</PRE><P>
<P><PRE>      ' Call the SetCount() function from the group header section's
      ' OnPrint property using the syntax: =SetCount(Report)
</PRE><P>
<P><PRE>      Function SetCount (R As Report)
<PRE></PRE>         TotCount = 0
         R![ProductName].Visible = True
      End Function

      ' Call the PrintLines() function from the detail section's OnPrint
      ' property using the syntax: =PrintLines(Report,[TotGrp]).

      Function PrintLines (R As Report, TotGrp)
         TotCount = TotCount + 1
         If TotCount = TotGrp Then
              R.NextRecord = False
         ElseIf TotCount &gt; TotGrp And TotCount &lt; 15 Then
              R.NextRecord = False
              R![ProductName].Visible = False
         End If
      End Function

</PRE></OL>This method repeats the last detail line for a data group until the total
number of constant lines has been created. In this example, the last detail
line is repeated until 15 detail lines have been printed for each group.
The ProductName control is hidden in order to not repeat the last value,
which creates a constant grid of 15 lines.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: preprinted pre-printed fixed<BR>
Keywords          : kbusage RptEvent<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
