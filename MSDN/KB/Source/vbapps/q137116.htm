

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC95: How to Run a Function from a Custom Toolbar Button </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137116">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/09/20">
<META NAME="Keywords" CONTENT="kbprg kbui PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat).   Advanced: Requires expert coding, interoperability, and mul...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBOG,QBS0,QBWS,QA1S,QAB9,QDN9,QANS,QAY5,QAF0,QDL9,QBWQ,QBWO,QBWN,QBV8,QAL0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: How to Run a Function from a Custom Toolbar Button</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137116</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat).
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to run a Visual Basic for Applications function
or expression from a button on a custom toolbar. The method involves three
general steps:

<UL><LI>Modifying the Windows 95 Registry to allow expressions in custom
   toolbars.

<LI>Creating a Visual Basic function.

<LI>Creating a custom toolbar button that calls the function.
<P>
</UL>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access for Windows 95" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Modifying the Windows 95 Registry</h3>
 
<P>
To modify the Windows 95 registry to allow expressions in custom toolbars,
follow these steps.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.

<OL><P><LI>Start the Registry Editor. To do so, click the Start button, click Run,
   and then type "regedit" (without the quotation marks) in the Run dialog
   box. Click OK.

<P><LI>In the Registry Editor dialog box, locate the following key:
<P>
<P><PRE>      HKEY_CURRENT_USER
</PRE>
<P><LI>Double-click HKEY_CURRENT_USER; double click Software; double-click
   Microsoft; double-click Access; double-click 7.0; and then select
   Settings. Using the right  mouse button (right-click), click Settings,
   point to New on the menu that appears, and then click DWORD value on the
   menu that appears.

<P><LI>Under Name, type the following name for the new DWORD value:
<P>
<P><PRE>      ExprsInToolbars
</PRE>
<P><LI>Select the "ExprsInToolbars" DWORD, and right-click the Modify command.

<P><LI>In the Edit DWORD Value box, enter 1 as the value data, and then
   click OK.

<P><LI>Close the Registry Editor.
<P>
</OL><h3>Creating the Visual Basic Function</h3>
 
<P>
To create the Visual Basic function, follow these steps:

<OL><P><LI>Start Microsoft Access and open any database.

<P><LI>Create a module and type the following line in Declarations section
   if it's not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function Test()
<PRE></PRE>         MsgBox "Hello!"
      End Function

</PRE><P><LI>Close and save the new module.
<P>
</OL><h3>Creating the Custom Toolbar Button</h3>
 
<P>
To create the custom toolbar button, follow these steps:

<OL><P><LI>In the Database window, right-click the toolbar and click Customize.

<P><LI>In the Customize Toolbar box, scroll through the list of categories and
   select Expression.
<P>
   NOTE: If Expression does not appear in the list, please see the
   "Modifying the Windows Registry" section of this article for information
   on how to add this item to the list.

<P><LI>Type the following expression in the Expression text box:
<P>
<P><PRE>      Test()
</PRE><P>
   NOTE: Do not precede the expression with an equal sign (=).

<P><LI>Drag the Expression text box to the toolbar.
<P>
   NOTE: The toolbar must be docked.

<P><LI>If you want to change the button's icon, right-click the new button on
   the toolbar, and then click Choose Button Image. Select a different
   button, and then click OK.

<P><LI>Close the Customize Toolbars box.

<P><LI>Click the custom button on the toolbar. Note that you receive the
   "Hello!" message that you created in the Test() function.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications with Microsoft Access for Windows
95," version 7.0, Chapter 1, "Creating an Application," pages 22-24
 
<PRE>Keywords          : kbprg kbui PgmHowTo
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
