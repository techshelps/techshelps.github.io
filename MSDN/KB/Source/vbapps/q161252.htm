

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC97: Run-Time Error '3027' Using ODBCDirect to Open RecordSet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161252">
<META NAME="KBModify" CONTENT="1997/12/16">
<META NAME="KBCreate" CONTENT="1996/12/18">
<META NAME="Keywords" CONTENT="MdlRcd OdbcHowto OdbcOthr kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use an ODBCDirect connection to open a recordset, you may receive the following error message if you use the .AddNew method:     Run-time Error '3027':    Can't upd...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QDN9,QAB4,QBS0,QAAP,QABM,QBWS,QBXS,QAZV,QAX6,QAH6,QAH4,QAPF,QA9E P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Run-Time Error '3027' Using ODBCDirect to Open RecordSet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161252</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use an ODBCDirect connection to open a recordset, you may receive
the following error message if you use the .AddNew method:
<P>
<PRE>   Run-time Error '3027':
   Can't update. Database or object is read-only.

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications,  please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
By default, Microsoft Access opens a read-only recordset in an ODBCDirect
workspace. The read-only recordset gives better performance when you scroll
through the recordset.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want to be able to modify a recordset in an ODBCDirect workspace,
you must specify a LockEdits argument with the OpenRecordset method. The
full syntax for the OpenRecordset method is:
<P>
<PRE>   Set recordset=object.OpenRecordset(source, type, options, lockedits)

</PRE>You create an editable recordset when you use one of the following
constants in the LockEdits argument of the OpenRecordset method:
<P>
<PRE>   dbOptimistic, dbPessimistic, dbOptimisticValue, or dbOptimisticBatch

</PRE>For example, the following sample code fragment opens an editable recordset
that uses optimistic record locking:
<P>
<PRE>   Set RS = conPubs.OpenRecordset("Authors",dbOpenDynamic,0,dbOptimistic)

   NOTE: You must supply a zero (0) for the Options argument.

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example assumes that you have an ODBC data source that opens
the Pubs database in Microsoft SQL Server:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub ConnectAndAddRecords(UID as String, DSN as String, _
                               Optional PWD as String)
      Dim wrkODBC As Workspace
      Dim conPubs As Connection
      Dim rstTmp As Recordset

      ' Create an ODBCDirect workspace.
      Set wrkODBC = CreateWorkspace _
          ("NewODBCWorkspace", "admin", "", dbUseODBC)

      ' Open a connection to an ODBC data source.
      Set conPubs = wrkODBC.OpenConnection("Connection1", _
          dbDriverNoPrompt,,"ODBC;DATABASE=pubs;UID=" &amp; UID _
          &amp; ";PWD=" &amp; PWD &amp; ";DSN=" &amp; DSN)

      ' Open a recordset which is read-only by default.
      Set rstTmp = conPubs.OpenRecordset("Authors", dbOpenDynamic)

      rstTmp.AddNew
        rstTmp!au_id = "111-11-1111"
        rstTmp!au_lname = "Dickens"
        rstTmp!au_fname = "Charles"
        rstTmp!Contract = 0
      rstTmp.Update
      rstTmp.Close
      conPubs.Close
      wrkODBC.Close
      End Sub

</PRE><P><LI>To test this Procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
   NOTE: Substitute your own username, ODBC data source name and
   password for the UID, DSN and optional PWD arguments in the
   following example:
<P>
<P><PRE>      ConnectAndAddRecords "TestUser","TestDataSource","TestPwd"
</PRE><P>
   Note that the code fails on the rstTmp.AddNew line with the following
   error message:
<P>
<P><PRE>      Run-time Error '3027':
      Can't update. Database or object is read-only.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about ODBCDirect errors, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q169276.htm">Q169276</A></B>
   TITLE     : ACC97: OpenRecordset Method Options Incorrect for ODBCDirect

</PRE></OL>For more information about ODBCDirect workspaces, search the Help Index for
"ODBCDirect workspaces," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about using the OpenRecordset method, search the Help
Index for "OpenRecordset method."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prb<BR>
Keywords          : MdlRcd OdbcHowto OdbcOthr kberrmsg kbusage<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
