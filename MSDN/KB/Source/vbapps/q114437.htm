

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XL: Copy of Recorded Macro Code Doesn't Work Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114437">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/05/04">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmOthr SynGnrl">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed above, when you copy and paste  code in a Visual Basic procedure that was created with the Macro Recorder,  the pasted code may not behave the way that you expect.  For example, when you record a Visual Bas...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVP,QBS0,QA5V,QBUA,QAUD,QAB4,QA9N,QAB9,QBXT,QAIB,QATX,QBT6,QAMB,QBV4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Copy of Recorded Macro Code Doesn't Work Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114437</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed above, when you copy and paste 
code in a Visual Basic procedure that was created with the Macro Recorder, 
the pasted code may not behave the way that you expect.
<P>
For example, when you record a Visual Basic procedure and you type text
into a cell or text box and you manually break the line (press ALT+ENTER in
a cell, or press CTRL+ENTER or ENTER in a Text Box), the line break
character is displayed as a "box" in the recorded procedure.
<P>
If you copy the line that contains this character to another location in
the module or to another module, the line is pasted as multiple lines,
breaking the text at the "box" character. This break causes either a syntax
error or the "Sub or function not defined" error message to appear when you
run the procedure. The error message you receive depends on where the line
break character is located in the string.
<P>
<P><h2>CAUSE</h2>
 
<P>
In some cases, the Visual Basic code recorded by the Macro Recorder
contains an extended ASCII character (such as a carriage return or line
break). When you copy and paste this code to another location in a module,
the character is pasted with the normal functionality.
<P>
The nonprinting character used in Microsoft Excel to create the line break
is not supported by the text format in a Visual Basic module.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, edit the recorded procedure and replace the
symbol with a Chr(n) function, where "n" is the ASCII character code for
the extended character. For example, if the recorded macro appears as 
follows in the module
<P>
<PRE>   ActiveCell.FormulaR1C1 = "good||guy"

</PRE>where || is the "box" character, edit the line as follows:
<P>
<PRE>   ActiveCell.FormulaR1C1 = "good" &amp; Chr(10) &amp; "guy"

</PRE>NOTE: The value 10 is the ASCII character code for a carriage return.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Microsoft 
Excel listed at the beginning of this article. This problem was corrected 
in Microsoft Excel 97 for Windows and Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, if you enter the text "good" and then press ALT+ENTER
and then type the text "guy" in a cell on a worksheet while the macro
recorder is running, the code appears as follows in the recorded procedure
<P>
<PRE>   ActiveCell.FormulaR1C1 = "good||guy"

</PRE>where || is a "box" character.
<P>
If you copy this line, and paste it to another location in the
procedure or module, it appears as follows:
<P>
<PRE>   ActiveCell.FormulaR1C1 = "good"
   guy ""

</PRE>When you run this procedure, you receive the following error message:
<P>
<PRE>   Sub or function not defined

</PRE>If the recorded procedure appears as follows
<P>
<PRE>   ActiveCell.FormulaR1C1 = "goodguy||"

</PRE>where || is a "box" character, then pasting this text to another
location results in the following:
<P>
<PRE>   ActiveCell.FormulaR1C1 = "good guy"

</PRE>You receive a syntax error when you run the procedure that contains this
line.
<P>
For more information about character codes, such as the ANSI or ASCII
Character Set, or the Character Set (0-127), choose the Search button in
the Visual Basic Reference and type:
<P>
<PRE>    character codes

</PRE>For more information about the Chr Function, choose the Search button in
the Visual Basic Help and type:
<P>
<PRE>    Chr
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a macro paste chart XL5 <BR>
XL7<BR>
Keywords          : kbcode kbprg PgmOthr SynGnrl<BR>
Version           : WINDOWS:5.0,5.0c,7.0; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
