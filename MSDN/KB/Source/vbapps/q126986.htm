

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Can't Change Working Time After Running Macro to Edit Calendar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126986">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1995/03/08">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Project, you may not be able to use the Change Working Time dialog box to change the working and nonworking days on the calendar after you run a macro that edits the base calendar.  CAUSE =====  This behavior occurs if you use the Work...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAPN,QACE,QABA,QDNF,QA2O,QBWS,QDMR,QBXT,QBXS,QA5V,QAU3,QAMR,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Can't Change Working Time After Running Macro to Edit Calendar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126986</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Project, you may not be able to use the Change Working Time
dialog box to change the working and nonworking days on the calendar after
you run a macro that edits the base calendar.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs if you use the Working property in a Visual Basic,
Applications Edition, macro to set the working or nonworking days for a
date range on the base calendar. The problem occurs if the date range you
specify extends beyond one month. When this occurs, you cannot use the
Change Working Time dialog box to change the working time for the days in
the second and following months in that date range.
<P>
For example, if you run a macro that contains the following command
<P>
<PRE>    ActiveProject.BaseCalendars(1).Period("3/29/95", "5/5/95").Working = _
       False

</PRE>when you open the Change Working Time dialog box, and select the month of
April 1995, you cannot select the Working option for any of the days in
this month. The Nonworking option remains selected for each day in the
range 3/29/95 to 5/5/95.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To work around this problem, use any of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Use the BaseCalendarEditDays Method to edit the base calendar as in
the following example:
<P>
<PRE>   Sub ChangeWorkDays
      ' Set all days in the range 3/29/95 to 5/5/95 as nonworking
      BaseCalendarEditDays Name:="Standard", startDate:="3/29/95", _
        endDate:="5/5/95", Working:=False
   End Sub

</PRE><h3>Method 2</h3>
 
<P>
Use the Working Property of the Period object with one month
intervals. For example, use the following three commands to set the
Working property to the value False for the entire range 3/29/95 to
5/5/95 instead of one command:
<P>
<PRE>   Sub ChangeWorkDays
     ActiveProject.BaseCalendars(1).Period("3/29/95","3/31/95").Working = _
       False
     ActiveProject.BaseCalendars(1).Period("4/1/95","4/30/95").Working = _
       False
     ActiveProject.BaseCalendars(1).Period("5/1/95","5/5/95").Working = _
       False
   End Sub

</PRE>Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose. Note that a line that is preceded by
an apostrophe introduces a comment in the code--comments are provided to
explain what the code is doing at a particular point in the procedure. Note
also that an underscore character (_) indicates that code continues from
one line to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line
continuation character. For more information about Visual Basic for
Applications programming style, see the "Programming Style in This Manual"
section in the "Document Conventions" section of the "Visual Basic User's
Guide."
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../URJump.htm">Q126987</A></B>
   TITLE     : Exceptions Lost After Running Macro to Edit Calendar

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the BaseCalendars Method, choose the Search
button in the Visual Basic Reference and type:
<P>
<PRE>    BaseCalendars

</PRE>For more information about the Working Property, choose the Search button
in the Visual Basic Reference and type:
<P>
<PRE>    Working

</PRE>For more information about the BaseCalendarEditDays Method, choose the
Search button in the Visual Basic Reference and type:
<P>
<PRE>    BaseCalendarEditDays
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : kbcode kbprg<BR>
Version           : 4.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
