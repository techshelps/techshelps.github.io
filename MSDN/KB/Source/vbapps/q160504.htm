

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC95: Missing Variable Declarations in Rate Function Example </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160504">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/12/04">
<META NAME="Keywords" CONTENT="DcmHlp kberrmsg PgmDecl SynFnc">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the example procedure in the Rate Function Help topic, you receive the following error message:     Variable not defined  This article assumes that you are familiar ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAK9,QALA,QAKD,QAPF,QAEN,QAH4,QBV8,QAB9,QAYL,QBXJ,QA1S,QALB,QBS0,QA3U V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Missing Variable Declarations in Rate Function Example</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160504</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the example procedure in the Rate Function Help topic, you
receive the following error message:
<P>
<PRE>   Variable not defined

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications,  please refer to the "Building
Applications with Microsoft Access for Windows 95" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Rate function example does not dimension a number of the variables it
uses. If you type Option Explicit in the Declarations section of the module
in which you are using the Rate function example, the code does not compile
because all variables have not been declared.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Add the following line of code following the Constant declaration in the
example:
<P>
<PRE>   Dim Fmt, FVal, Guess, PVal, Payment, TotPmts, PayType, APR

</PRE>The modified example looks as follows:
<P>
<PRE>   Const ENDPERIOD = 0, BEGINPERIOD = 1    ' When payments are made.
   Dim Fmt, FVal, Guess, PVal, Payment, TotPmts, PayType, APR
   Fmt = "##0.00"  ' Define percentage format.
   FVal = 0    ' Usually 0 for a loan.
   Guess = 0.1 ' Guess of 10 percent.
   PVal = InputBox("How much did you borrow?")
   Payment = InputBox("What's your monthly payment?")
   TotPmts = InputBox("How many monthly payments do you have to make?")
   PayType = MsgBox("Do you make payments at the end of the month?", _
      vbYesNo)
   If PayType = vbNo Then PayType = BEGINPERIOD Else PayType = ENDPERIOD
   APR = (Rate(TotPmts, -Payment, PVal, FVal, PayType, Guess) * 12) * 100
   MsgBox "Your interest rate is " &amp; Format(CInt(APR), Fmt) &amp; " percent."

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function TryRate()
</PRE><P>
<P><PRE>      End Function
</PRE>
<P><LI>Search the Help Index for Rate function and open the topic.

<P><LI>Click the Example link at the top of the Rate Function Help topic.

<P><LI>Select the sample code, and then press CTRL+C to copy the contents to
   the Clipboard.

<P><LI>Close the Rate Function Example and Rate Function Help windows.

<P><LI>Place the insertion point in your module under the Function TryRate()
   line and press CTRL+V to paste the example. The function now looks as
   follows:
<P>
<P><PRE>      Function TryRate()
<PRE></PRE>      Const ENDPERIOD = 0, BEGINPERIOD = 1    ' When payments are made.
      Fmt = "##0.00"  ' Define percentage format.
      FVal = 0    ' Usually 0 for a loan.
      Guess = 0.1 ' Guess of 10 percent.
      PVal = InputBox("How much did you borrow?")
      Payment = InputBox("What's your monthly payment?")
      TotPmts = InputBox("How many monthly payments do you have to make?")
      PayType = MsgBox("Do you make payments at the end of the month?", _
         vbYesNo)
      If PayType = vbNo Then PayType = BEGINPERIOD Else PayType = ENDPERIOD

      APR = (Rate(TotPmts, -Payment, PVal, FVal, PayType, Guess) * 12) *
         100
      MsgBox "Your interest rate is " &amp; Format(CInt(APR), Fmt) &amp; "
         percent."
      End Function

</PRE><P><LI>On the Run menu, click Compile Loaded Modules. Note that you receive the
   error message:
<P>
<P><PRE>      Variable not defined
</OL></PRE> 
<PRE>Keywords          : DcmHlp kberrmsg PgmDecl SynFnc
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbdocerr</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
