

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Use DDE to Run a Word for Windows Macro from VB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q85857 ">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1992/06/22">
<META NAME="Keywords" CONTENT="IAPDDE vb416 VB4WIN vbwin GnrlVb kbinterop kbprg kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article demonstrates how to send a LinkExecute command to Microsoft Word for Windows from Visual Basic using dynamic data exchange (DDE) to run a macro.  MORE INFORMATION  The following sample program demonstrates how to automatically start Wo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBS0,QAH4,QAIJ,QDL9,QBWQ,QBWO,QBWN,QBWS,QBJZ,QBXS,QANE,QDO7,QDIV,QAZ2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use DDE to Run a Word for Windows Macro from VB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q85857 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0, 3.0
<LI>Microsoft Visual Basic for Windows, version 1.0
<LI>Microsoft Word for Windows, versions 2.0, 6.0, 6.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to send a LinkExecute command to Microsoft
Word for Windows from Visual Basic using dynamic data exchange (DDE) to run
a macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample program demonstrates how to automatically start Word
for Windows and execute a Word macro called MyMacro.
<P>
<P><h3>Steps to Create Sample Program</h3>
 

<OL><P><LI>Start Word and start a new project in Visual Basic. Form1 is created by
   default.

<P><LI>Place the following controls on Form1, and give them these properties:
<P>
<PRE>      Object     Name         Caption
      ---------------------------------
      TextBox    Text1
      Button     Command1     Start Word
      Button     Command2     MyMacro

</PRE><P><LI>Add the following code to the Command1 Click event:
<P>
<PRE>      Sub Command1_Click ()
         x = Shell("winword.exe", 7) 'Start Word for Windows
                                       'minimized without the focus
      End Sub

</PRE><P><LI>Add the following code to the Command2 Click event:
<P>
<PRE>      Sub Command2_Click ()
         Text1.LinkMode = 0         'Clear DDE link if it already exists.
         Text1.LinkTopic = "Winword|document1"  'Set up WINWORD.EXE link.
         Text1.LinkMode = 2         'Establish a cold DDE link.
         Text1.LinkTimeout = 60     'Set the time for a response to
                                    '6 seconds; if a DDETIMEOUT occurs,
                                    'increase the Text1.LinkTimeout

         'VB3Line: Enter the following lines as one line
         Text1.LinkExecute _
            "[ToolsMacro .Name ="+Chr$(34)+"MyMacro"+Chr$(34)+",.Run]"
         ' NOTE: the space is necessary as shown before .Name in the
         ' above LinkExecute statement.
      End Sub

</PRE><P><LI>Create a macro called MyMacro in Word that inserts "hello world" in the
   document:
<P>
   a. Switch to Word.
<P>
   b. From the Tools menu, choose Macro.
<P>
   c. Type "MyMacro" in the Macro Name field. Choose the Edit button.
<P>
   d. Type the following:
<P>
<PRE>         Insert "Hello World"

   e. From the File menu, choose Close. At the "Do you want to keep the
      changes to Global: MyMacro?" prompt, choose Yes. (This will save the
      newly created MyMacro macro.)

   f. From the File menu, choose Exit. At the "Do you want to save the
      global glossary and command changes?" prompt, choose Yes. (The
      MyMacro macro has been added to the Word NORMAL.DOT file.)

</PRE><P><LI>Press the F5 key to run the Visual Basic program.

<P><LI>Choose the Start Word button.

<P><LI>Choose the MyMacro button. This will establish a DDE conversation with
   Word Document1 and execute the MyMacro macro.

<P><LI>Switch to Word to verify that the Document1 contains "Hello World,"
   confirming that the MyMacro macro has been run (the CTRL+HOME key
   combination will move the cursor back to the beginning of the document).
</OL> 
<PRE>Keywords          : IAPDDE vb416 VB4WIN vbwin GnrlVb kbinterop kbprg kbfasttip
Technology        : kbvba
Version           : WINDOWS:1.0 2.0 3.0 4.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
