

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Terminate Windows from Within QuickWin Programs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79382 ">
<META NAME="KBModify" CONTENT="1995/07/20">
<META NAME="KBCreate" CONTENT="1991/12/19">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Microsoft FORTRAN version 5.1 QuickWin programs can terminate themselves, end the Windows session, and return to MS-DOS using the Windows API ExitWindows(). This is a capability that is requested by users attempting to run QuickWin programs in a ba...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBFY,QDL9,QBWQ,QBWO,QBWN,QAUD,QAGB,QA4Q,QAY2,QAVX,QAVW,QAJH,QBWS,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Terminate Windows from Within QuickWin Programs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79382 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, version 5.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft FORTRAN version 5.1 QuickWin programs can terminate themselves,
end the Windows session, and return to MS-DOS using the Windows API
ExitWindows(). This is a capability that is requested by users attempting
to run QuickWin programs in a batch mode from MS-DOS.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
ExitWindows() returns a 1 if successful and a 0 (zero) if unsuccessful. The
function may be unsuccessful if an application running in Windows refuses
to terminate when attempting to exit Windows. The first argument should
always be zero. The second argument is used to pass a return code back to
MS-DOS when Windows exits.
<P>
<P><h3>Sample Code #1</h3>
 
<P>
c  The following code demonstrates how to use ExitWindows() from
c  within a FORTRAN program. This code should be compiled and linked
c  as a QuickWin Windows program.
<P>
<PRE>c  FL /MW WINEXIT.FOR        Sample command line for this program.

      interface to integer*2 function EXITWINDOWS
     + (dwReserved, wReturnCode)
      integer*4 dwReserved [value]
      integer*2 wReturnCode [value]
      end

      program winexit
      integer*2 ExitWindows,j

      open(1,file='test.dat')

      do i=1, 50
        write(*,*) i
        write(1,*) i
      end do

      close(1)

      j = ExitWindows(0,0)
      if (j.eq.0) print*, 'ExitWindows failed'

      end

</PRE>The following batch file demonstrates how this program could be run
from MS-DOS:
<P>
<PRE>   win winexit
   type test.dat

</PRE><h3>Sample Code #2</h3>
 
<P>
c  The following DOS FORTRAN program demonstrates how the QuickWin
c  program WINEXIT.EXE above could be called by a DOS program that
c  resumes execution on completion of the QuickWin program. This code
c  should be compiled and linked as an MS-DOS program.
<P>
<PRE>c  FL  WINCALL.for    Sample command line for this program.

      interface to function spawnlp[c,varying] (mode)
      integer*2 spawnlp, mode
      end

      program wincall

      integer*2 spawnlp,i

</PRE>C Spawning Windows and QuickWin program WINEXIT.EXE from MS-DOS executable.
<PRE>      i=spawnlp(0,loc('d:\\windows\\win.com'c),
     +            loc('d:\\windows\\win.com'c),
     +            loc('e:\\arts\\mine\\exitwin\\WINEXIT.EXE'c),
     +            int4(0) )

</PRE>C After exiting Windows, control returns to this point:
<PRE>      open(2,file='test.dat')

      do j=1,50
        read(2,*) jj
        print*,jj
      end do

      close(2,status='delete')
      end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 5.10<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 20, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
