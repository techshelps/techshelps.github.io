

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Mixed Language Apps Will Not Run Due to Extra END </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86452 ">
<META NAME="KBModify" CONTENT="1995/07/17">
<META NAME="KBCreate" CONTENT="1992/07/07">
<META NAME="Keywords" CONTENT="kbprg kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Mixed-language C and FORTRAN Windows applications may appear to fail to start when executed or, under CodeView for Windows, may immediately exit with the Program Terminated Normally message on the first step into the application.  CAUSE =====  The ...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHT,QAMA,QAH4,QAY5,QAB9,QAJH,QDL9,QBWQ,QBWO,QBWN,QAPN,QBV8,QBVV,QBC9,QBC8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Mixed Language Apps Will Not Run Due to Extra END</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86452 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 5.0 and 5.1
<LI>Microsoft FORTRAN for OS/2, versions 5.0 and 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Mixed-language C and FORTRAN Windows applications may appear to
fail to start when executed or, under CodeView for Windows, may
immediately exit with the Program Terminated Normally message on
the first step into the application.
<P>
<P><h2>CAUSE</h2>
 
<P>
The FORTRAN code may have an additional END statement following the
subroutine or function declaration. An additional END statement is
interpreted by the compiler as an empty main program declaration,
and thus causes the insertion of the entry point _main.
<P>
The startup code in a Windows 3.x executable looks first for a
function named main (_main with C declaration style); if it cannot
find the main (or _main) function, it looks for a function called
WinMain(). If neither of these functions exist, the following
run-time error is generated:
<P>
<PRE>   R6021: No Main Function

</PRE>Because the FORTRAN code declared a _main function that does
nothing, the main window of the program is not created and the
application exits immediately after it starts. This problem is more
common with mixed-language C and FORTRAN Windows applications.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Check all FORTRAN code for extra END statements and remove them.
<P>
<P><h2>STATUS</h2>
 
<P>
This functionality is by design. Windows applications should have
only WinMain() functions as entry points. The problem is caused by
the interpretation that standard FORTRAN syntax gives to an extra
END statement.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With non-Windows applications, an extra END statement causes the
linker to generate the following error:
<P>
<PRE>   error L2025: _main : symbol defined more than once

</PRE>Windows applications do not have an _main function, however, so no
linker error is generated.
<P>
To duplicate this problem, use the MULMIX project example that comes
with FORTRAN 5.1 and add an additional END statement below the MUL
subroutine in the MULF.FOR file. For more information, query on the
following words in the Microsoft Knowledge Base:
<P>
<PRE>   winmain main qwin100
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10<BR>
KBCategory: kbprg kbinterop kbprb<BR>
KBSubCategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
