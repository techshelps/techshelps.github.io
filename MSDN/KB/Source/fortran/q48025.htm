

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: L2029 Error, FGRAPH.FD, FGRAPH.FI Files Used Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q48025 ">
<META NAME="KBModify" CONTENT="1995/07/18">
<META NAME="KBCreate" CONTENT="1989/08/17">
<META NAME="Keywords" CONTENT="kbprg kberrmsg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  An attempt to link an application fails and an L2029 unresolved externals error occurs.  CAUSE =====  The FGRAPH.FI file is placed at the beginning of the main file and FGRAPH.FD is placed in a subroutine in a separate file. This cause applies ONLY...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAH4,QAFF,QAAP,QAIF,QBFY,QACI,QAUD,QAPN,QAM4,QAD2,QAB4,QAPF,QBBS,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: L2029 Error, FGRAPH.FD, FGRAPH.FI Files Used Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q48025 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS and OS/2, version 5.0, 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to link an application fails and an L2029 unresolved
externals error occurs.
<P>
<P><h2>CAUSE</h2>
 
<P>
The FGRAPH.FI file is placed at the beginning of the main file and
FGRAPH.FD is placed in a subroutine in a separate file. This cause
applies ONLY when the symbol name is a graphics function, and it is
in all capitol letters with no leading underscore.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Modify the source code to include the FGRAPH.FI file (the INTERFACE
statements) at the beginning of each file that contains a graphics
call. Include the FGRAPH.FD file (the variable declarations) in
each subroutine that calls a graphics routine.
<P>
This behavior does not occur with FORTRAN PowerStation. Sample 1 below
builds without error.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information on the FGRAPH.FD and FGRAPH.FI files, see page
180 of the Microsoft FORTRAN "Advanced Topics" manual for version 5.1
or page 138 of the Microsoft FORTRAN "Advanced Topics" manual for
version 5.0.
<P>
The following code example demonstrates this problem.
<P>
<P><h3>Sample Code #1</h3>
 
<P>
C Place the main program and subroutine in the same file
<P>
C Compile options needed: None
<P>
<PRE>      INCLUDE 'FGRAPH.FI'   ! interface statements at file beginning
      PROGRAM GRAPH
      CALL DUMMY
      END

      SUBROUTINE DUMMY()
      INCLUDE 'FGRAPH.FD'   ! declarations within the subroutine
      CALL clearscreen( $GCLEARSCREEN )
      RETURN
      END

</PRE>The following code example demonstrates the correct method to make
graphics calls.
<P>
<P><h3>Sample Code #2</h3>
 
<P>
C Place the main program in a separate file
<P>
C Compile options needed: None
<P>
<PRE>      PROGRAM GRAPH    ! No graphics calls in this file, so include
      CALL DUMMY       ! files are not necessary in this file
      END

</PRE>C Place the subroutine into a separate file
<P>
C Compile options needed: None
<P>
<PRE>      INCLUDE 'FGRAPH.FI'  ! interface statements at file beginning
      SUBROUTINE DUMMY()
      INCLUDE 'FGRAPH.FD'  ! declarations within the subroutine
      CALL clearscreen( $GCLEARSCREEN )
      RETURN
      END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.10 L2029<BR>
KBCategory: kbprg kberrmsg kbcode kbprb<BR>
KBSubcategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
