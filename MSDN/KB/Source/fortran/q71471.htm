

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calling DOS and BIOS Interrupts with FORTRAN and MASM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71471 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/04/19">
<META NAME="Keywords" CONTENT="kbprg kbfile kbappnote">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  To obtain the application note  Calling DOS and BIOS Interrupts with FORTRAN and MASM,  call Microsoft Product Support Services. This application note contains preassembled versions of the MASM routines used to call DOS and BIOS interrupts.  The te...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHC,QADN,QAHB,QAGI,QAY5,QAB9,QBDM,QAJH,QAIF,QBV8,QAH4,QA4Q,QAPN,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Calling DOS and BIOS Interrupts with FORTRAN and MASM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71471 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 5.0 and 5.1
<LI>Microsoft FORTRAN for OS/2, versions 5.0 and 5.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To obtain the application note "Calling DOS and BIOS Interrupts with
FORTRAN and MASM," call Microsoft Product Support Services. This
application note contains preassembled versions of the MASM routines
used to call DOS and BIOS interrupts.
<P>
The text of this application note is also available in the Microsoft
Software Library. Download HF0405.EXE, a self-extracting file, from the
Microsoft Software Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/HF0405.EXE">HF0405.EXE</A> <I>(size: 58988 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \softlib\mslfiles directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/HF0405.EXE">HF0405.EXE</A> <I>(size: 58988 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The following is the text of the application note:
<P>
 
<PRE>   Microsoft Product Support Services Application Note (Text File)
    HF0405: CALLING DOS AND BIOS INTERRUPTS WITH FORTRAN AND MASM
</PRE> 
<PRE>                                                   Revision Date: 8/91
                                                       1 Disk Included

</PRE>This information applies to Microsoft FORTRAN versions 5.0 and 5.1.
<P>
<PRE> --------------------------------------------------------------------
| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an            |
| Application Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY      |
| KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO    |
| THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A     |
| PARTICULAR PURPOSE. The user assumes the entire risk as to the     |
| accuracy and the use of this Application Note. This Application    |
| Note may be copied and distributed subject to the following        |
| conditions: 1) All text must be copied without modification and    |
| all pages must be included; 2) If software is included, all files  |
| on the disk(s) must be copied without modification [the MS-DOS(R)  |
| utility DISKCOPY is appropriate for this purpose]; 3) All          |
| components of this Application Note must be distributed together;  |
| and 4) This Application Note may not be distributed for profit.    |
|                                                                    |
| Copyright 1991 Microsoft Corporation. All Rights Reserved.         |
| Microsoft, MS-DOS, and the Microsoft logo are registered           |
| trademarks and Windows is a trademark of Microsoft Corporation.    |
 --------------------------------------------------------------------

</PRE>This application note illustrates how to access DOS interrupts without
using the functions INTDOS and INTDOSX. DOS and BIOS interrupts can
be called by specifying the interrupt number and the input register
values within the main program. INTERRUPT and INTERRUPTX differ from
the INTDOS and INTDOSX routines included with FORTRAN in that
interrupts other than interrupt 21 can be called.
<P>
Included on the enclosed "Calling DOS and BIOS Interrupts with FORTRAN
and MASM" disk are the following files. These files define the
INTERRUPT and INTERRUPTX functions and provide two FORTRAN sample
programs demonstrating how these functions are called.
<P>
<PRE>File           Description
----           -----------

INTERRPT.ASM   The assembly source listing of the INTERRUPT and
               INTERRUPTX routines.

INTERRPT.INC   An include file for INTERRUPT and INTERRUPTX. This
               file contains the INTERFACE to the assembly routines
               and the register structures needed for INTERRUPT and
               INTERRUPTX.

INTERRPT.OBJ   The preassembled version of INTERRPT.ASM to be linked
               with programs calling INTERRUPT or INTERRUPTX.

INT.FOR        FORTRAN sample program that demonstrates how to use the
               INTERRUPT function call. INT.FOR uses INT 21, function
               2A hex to get the system date.

INTX.FOR       FORTRAN sample program using segment registers that
               demonstrates how to use the INTERRUPTX function call.
               INTXFOR uses INT 21, function 41 hex to delete a file.

INT.EXE        Executable version of INT.FOR example.

INTX.EXE       Executable version of INTX.FOR example.

</PRE>The two assembly language routines included in INTERRPT.ASM are as
follows:

<OL><P><LI>INTERRUPT(INTNUM,INREGS,OUTREGS) invokes the interrupt specified by
   INTNUM using the values of INREGS and returns the result of the
   interrupt call in OUTREGS.

<P><LI>INTERRUPTX(INTNUM,INREGS,OUTREGS) invokes the system in the same
   manner as INTERRUPT but accepts segment register values.
<P>
</OL>To use the INTERRUPT and INTERRUPTX functions, the statement
<P>
<PRE>   INCLUDE 'INTERRPT.INC'

</PRE></OL>must be located at the top of the source file where a call is made to
the assembly language procedures. The two statement function
definitions documented at the end of the INTERRPT.INC file must be
uncommented and added to the source code of any FORTRAN program,
function, or subroutine block where the assembly language procedures
are called.
<P>
The statement functions documented at the end of INTERRPT.INC are
shown below. These statement functions must appear before any
executable statements. INTERRPT.OBJ must then be linked with the
object file produced from compiling the main program.
<P>
<PRE>   gethibyte (dataword) = dataword / 256
   getlobyte (dataword) = iand(dataword , 255)

</PRE>Microsoft cannot guarantee that the information stated here regarding
how to use INTERRUPT and INTERRUPTX will allow you to perform all MS-
DOS system or BIOS calls correctly because this information has not
been tested rigorously and is not considered a feature of the product.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10 appnote hf0405.exe S13012 softlib<BR>
KBCategory: kbprg kbfile kbappnote<BR>
KBSubcategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
