

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: R6000 After Many Calls to RunQQ If Linked with Defaults </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123730">
<META NAME="KBModify" CONTENT="1995/07/13">
<META NAME="KBCreate" CONTENT="1994/12/07">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  RunQQ fails and returns error R6000 (stack overflow) after being called many times. The failure occurs after less than 100 calls (the exact number depends on things like system memory) given the following conditions:   - Stack checking is turned on...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QABA,QAGI,QBV8,QDIV,QAKP,QAL4,QAY2,QAE2,QBVV,QA8T,QAG0,QANY,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: R6000 After Many Calls to RunQQ If Linked with Defaults</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 13, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123730</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN PowerStation for MS-DOS, versions 1.0 and 1.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
RunQQ fails and returns error R6000 (stack overflow) after being called
many times. The failure occurs after less than 100 calls (the exact number
depends on things like system memory) given the following conditions:

<UL><LI>Stack checking is turned on when compiling the task called from RunQQ.

<LI>The application was linked using the default stack size of 1MB 'reserve'
   and 4K 'commit'.

<LI>The application is run from MS-DOS.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Set the linker stack option to 32K 'reserve' and 4K 'commit'. This is the
default when compiling and linking using FL32 on the command line.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article.
<P>
This problem does not occur with FORTRAN PowerStation 32.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Page 168 of the User's Guide states that the default stack for the linker
is 1MB 'reserve' and 4K 'commit'. It also states that this is 0x1000000 and
0x4000 respectively - which is inconsitent, it is actually 0x100000 (1MB)
and 0x1000 (4K). These are the values used by default in the Visual
Workbench. Applications built this way will fail as described above.
<P>
The default stack used when building from the command line with FL32 is 32K
<PRE>'reserve' and 4K 'commit'. When an application is compiled and linked using
</PRE>the default options of FL32, it does not have the problem described above.
<P>
To demonstrate the problem, build both sample programs using the linker's
default options in the Visual Workbench. The only compile option required
is /Ge for TASK.FOR. Then exit Windows and run TEST.EXE from MS-DOS.
<P>
To demonstrate the problem without using the Visual Workbench, use the
following commands (assuming the maintenance release is installed). The
linker version for the maintenance release is 1.0F.
<P>
<PRE>   FL32 /c /Ge test.for task.for
   LINK test.obj libf.lib libc.lib
   BINDMSF test.exe
   LINK task.obj libf.lib libc.lib

</PRE>NOTE: It is not necessary to apply BINDMSF to the TASK.EXE because  it is
being run from TEST.EXE, which will have already loaded the MS-DOS
extender. Feel free to use BINDMSF on TASK.EXE; it will have no effect on
this test.
<P>
<P><h3>Sample Code TEST.FOR</h3>
 
<P>
C Compile options required: none or /Ge (it will not affect the test)
<P>
<PRE>      include 'flib.fi'
      include 'flib.fd'

      character*1 answer
      integer*4 i
      integer*4 r

      do i=1,100

          write(*,*)"ready to runqq task.exe"
          r = runqq("task.exe","/none")
          if (r .ne. 0) then
              write(*,*)i," task.exe failed"
              read(*,FMT='(a1)') answer
          else
              write(*,*)i," task.exe was successful"
          end if

      end do

      end

</PRE>SAMPLE CODE task.for
 
<P>
C Compile options required: /Ge (must turn on stack checking for TASK)
<P>
<PRE>      write(*,*)"control passed to task.exe"
      end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.00a docerr<BR>
KBCategory: kbprg kbbuglist kbdocerr<BR>
KBSubcategory: FORTLangIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 13, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
