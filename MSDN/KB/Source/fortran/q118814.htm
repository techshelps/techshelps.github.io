

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: Win32 APIs Callable from a QuickWin Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118814">
<META NAME="KBModify" CONTENT="1995/12/09">
<META NAME="KBCreate" CONTENT="1994/07/31">
<META NAME="Keywords" CONTENT="kbprg kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  On page 166 of the PowerStation 32  Programmer's Guide,  the first paragraph implies that you cannot call Win32 APIs from a QuickWin application; however, you actually can call Win32 APIs that do not require a window handle.  MORE INFORMATION  To c...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAMB,QATX,QDIT,QBFY,QAY2,QAIF,QABI,QAJH,QBWP,QBBS,QA7M,QA4Q,QAH7,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: Win32 APIs Callable from a QuickWin Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 9, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118814</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN PowerStation 32 for Windows NT, version 1.0 and
   4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
On page 166 of the PowerStation 32 "Programmer's Guide," the first
paragraph implies that you cannot call Win32 APIs from a QuickWin
application; however, you actually can call Win32 APIs that do not require
a window handle.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To call a Win32 API, you must create a proper INTERFACE TO statement and
link with the proper import library.
<P>
You can determine the proper INTERFACE TO statement by reading the "Win32
Programmer's Reference". The STDCALL attribute is required for the function
declaration.
<P>
The sample code below calls the MessageBox() API, contained in the import
library, USER32.LIB, which is already linked into the program for a
QuickWin application by default. The first parameter of MessageBox() is a
window handle or 0 (NULL). You must use 0, because the window handle is not
available in a QuickWin application.
<P>
NOTE: When you pass a string to an API, make sure that you use the C
convention, so that the string is NULL terminated. See page 53 of the
"Programmer's Guide" for a discussion of C strings.
<P>
<P><h3>Sample Code</h3>
 
<P>
C Compile options needed: /MW
<P>
<PRE>      INTERFACE TO FUNCTION
     +MESSAGEBOX  (hwnd, text, title, icon)
      INTEGER*4 MESSAGEBOX [STDCALL, ALIAS:'_MessageBoxA@16']
      INTEGER*4 hwnd [VALUE]
      CHARACTER*(*) text [REFERENCE]
      CHARACTER*(*) title [REFERENCE]
      INTEGER*4 icon [VALUE]
      END

      CHARACTER text*34, title*21

      text = 'This API was called from FORTRAN.'C
      title = 'QuickWin Application'C

      PRINT*, "Enter any character to continue: "
      READ(*, '(A)')

      i = MESSAGEBOX(0, text, title, 1)

      PRINT*, "MessageBox called"

      END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 4.00 docerr<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 9, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
