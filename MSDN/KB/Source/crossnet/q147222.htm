

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Group of Hotfixes for Exchange 5.5 and IIS 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147222">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1996/02/21">
<META NAME="Keywords" CONTENT="ntinterop ntsrv kbfix4.00 kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  Access Violation in Explorer.exe  An Access Violation occurs in Windows NT Explorer (Explorer.exe) and other applications while running Microsoft Transaction Server (MTS).  During server process (package) shutdown, an uninitialized hWnd stack varia...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAR4,QBWP,QAM1,QAAD,QBWS,QA1S,QAKP,QAJQ,QAAP,QBW9,QBVX,QDN9,QBV9,QBIC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Group of Hotfixes for Exchange 5.5 and IIS 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147222</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Server Enterprise Edition version 4.0
<LI>Microsoft Cluster Server version 1.0
<LI>Microsoft Transaction Server version 2.0
<LI>Microsoft Internet Information Server version 4.0
<LI>Microsoft Exchange Server version 5.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
<P><h3>Access Violation in Explorer.exe</h3>
 
<P>
An Access Violation occurs in Windows NT Explorer (Explorer.exe) and other
applications while running Microsoft Transaction Server (MTS).
<P>
During server process (package) shutdown, an uninitialized hWnd stack
variable causes a broadcast message with invalid data. This causes
currently running programs (including Explorer.exe) to stop responding
(hang) or restart due to an Access Violation.
<P>
<P><h3>DCOM Fails with 80010111 When Client and Server are on Same Node</h3>
 
<P>
If a Distributed COM (DCOM) client and server are on the same computer and
the client uses anything other than the computer's NetBIOS name to refer to
the server, the call receives errors about invalid headers on packets.
<P>
The specific case that impacts Microsoft Cluster Server (MSCS) is when a
virtual server name is used. The virtual server name is registered with an
IP address that is bound to a node (computer) in the cluster. This is done
so the IP address can be failed over to another node in the cluster without
clients needing to know of the change.
<P>
The problem arises when a server on one of the computers uses the service
of another server in the cluster. If, because of failure or administrator
action, the two servers end up on the same computer, DCOM fails. The
virtual server name and IP address have to be used because the location of
the servers may change.
<P>
<P><h3>Windows NT 4.0 RPC Binds Hang When the Server Is Restarted</h3>
 
<P>
When using RPC over TCP/IP, binds may hang if the server is restarted when
a bind is outstanding. It takes about two hours for TCP/IP to recover from
this.
<P>
<P><h3>IIS/ASP Security Context Becomes Corrupt Under Stress</h3>
 
<P>
Under stress, a script that is supposed to run under the security context
of a specific user may run as System instead. Running under the wrong
security context can result in incorrect file access, incorrect component
availability, and incorrect component capabilities.
<P>
<P><h3>Problem with calling Out-of-Process Applications using Role-based Security</h3>
 
<P>
If there are out-of-process Transaction Server packages using role-based
security, it is possible for someone who has access to the computer to
spoof the identity that the MTS package believes is calling the package.
The scenario described is extremely rare, but the fix eliminates the
possibility completely.
<P>
A side effect of this fix is that all out-of-process components configured
to "Activate as Activator" will now run under the context of the System
user, where formerly they would run under a non-deterministic user context.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, obtain the following fix or wait for the next
Windows NT service pack.
<P>
This hotfix has been posted to the following Internet location (do not
install the Roll-up hotfix if you have previously installed the Cluster
hotfix):
<P>
<PRE>   <B><A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/</A></B>
   hotfixes-postSP3/roll-up/

</PRE>NOTE: The above link is one path; it has been wrapped for readability.
<P>
If you use Cluster Services with Microsoft Exchange Server version 5.5, you
must also install the Cluster hotfixes.
<P>
This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/</A></B>
   hotfixes-postSP3/roll-up/cluster/

</PRE>NOTE: The above link is one path; it has been wrapped for readability.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed these to be problems in the products listed at the
beginning of this article.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.00 2.00 4.00 k2<BR>
Keywords          : ntinterop ntsrv kbfix4.00 kbinterop<BR>
Version           : WinNT:1.0,2.0,4.0,5.5<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
