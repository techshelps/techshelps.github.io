

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RAS Err Msg Connecting a Remote Server Share: Access Denied </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131659">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1995/06/15">
<META NAME="Keywords" CONTENT="kbusage kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  When you try to connect to a remote resource over an existing Remote Access Service (RAS) link that you have access rights to, one of the following messages appears after you enter the correct password:   - From File Manager:        Stop. Access ha...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBWO,QANN,QBW7,QA9A,QAK7,QBW3,QBTX,QBVV,QBG2,QA1S,QAVZ,QABI,QDMH,QBWU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RAS Err Msg Connecting a Remote Server Share: Access Denied</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131659</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to connect to a remote resource over an existing Remote Access
Service (RAS) link that you have access rights to, one of the following
messages appears after you enter the correct password:

<UL><LI>From File Manager:
<P>
<P><PRE>      Stop. Access has been denied.
</PRE>
<LI>From MS-DOS Command Prompt:
<P>
<P><PRE>      Error 5: Access has been denied.
</PRE><P>
</UL>These symptoms occur after you call a RAS server from your RAS client and
the RAS server authenticates you successfully. Your RAS connection is not
affected when the above error messages appear.
<P>
<P><h2>CAUSE</h2>
 
<P>
Your local logon credentials differ from your remote domain credentials or,
if they do not differ, you are not logged on to Windows for Workgroups.
<P>
<P><h3>How RAS Logon and Network Logon Differ</h3>
 
<P>
The RAS server does not log you on to the remote domain with your user
account, password, and domain credentials you enter in the RAS
Authentication dialog box. The remote domain controller only uses these
credentials to verify that you have permission to physically access the
network as a dial-in client.
<P>
NOTE: The RAS Authentication dialog box only appears if you are not logged
on to Windows for Workgroups, or if you are calling a RAS server from your
RAS client for the first time. If you are not prompted by this dialog box,
RAS uses the credentials you enter during your very first RAS call.
<P>
To validate your access to protected resources on the remote domain, the
remote domain controller checks the credentials you enter when you log on
locally to Windows for Workgroups.
<P>
Therefore, if your local logon credentials differ from the remote domain
credentials, or if you are not logged on locally, you cannot access
protected resources on the remote domain and one of the messages above
appears.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To gain access to your remote resources:

<UL><LI>Log on to the remote domain after you establish the RAS connection.
<P>
   -or-

<LI>Automatically log on remotely when you start Windows for Workgroups
   (before the RAS link is established).
<P>
</UL>These solutions are explained below. They assume that the remote domain
administrator has previously granted you access rights to the share you
are trying to connect to.
<P>
<P><h3>Log On to the Remote Domain After You Establish the RAS Connection</h3>
 
<P>
To log on to the remote domain after you establish the RAS connection, or
after you log on locally, enter your remote domain name in Control Panel
Network and then log off and on again:

<OL><P><LI>Run Control Panel and choose Network.

<P><LI>Choose Startup.

<P><LI>Select "Log On To Windows NT Or LAN Manager Domain".

<P><LI>Enter the remote domain name in the Domain Name field and choose OK.
<P>
   NOTE: Making the local domain name identical to the remote domain name
   is a security issue. Check with your administrator before changing it.

<P><LI>Choose OK again.

<P><LI>From the Program Manager Network group, run Log On/Off to log off.
<P>
   NOTE: Logging off does not hang up your RAS connection.

<P><LI>Run Log On/Off again to log on with your remote user name and password.
<P>
</OL>If the symptoms still occur, and you are sure you are supplying
correct credentials, check with your network administrator to determine if
you have access permissions to the remote share.
<P>
Automatically Log On Remotely at Windows for Workgroups Startup
(Before the RAS Link is Established)
 
<P>
To configure Windows for Workgroups and RAS so you do not have to log on,
make your local user account, password, and domain name credentials the
same as your remote domain credentials.
<P>
NOTE: Making the local domain name identical to the remote domain name
is a security issue. Check with your administrator before changing it.
<P>
If you cannot make your credentials the same (due to your network
configuration), you can still avoid logging off and on again after each RAS
connection. To do so, run Control Panel to enter your remote domain name so
you can use your remote domain credentials when you are logging on during
startup of Windows for Workgroups (even though the RAS connection does not
exist yet):

<OL><P><LI>Run Control Panel and choose Network.

<P><LI>Choose Startup.

<P><LI>Select "Log On To Windows NT Or LAN Manager Domain".

<P><LI>Enter the remote domain name in the Domain Name field and choose OK.
<P>
   NOTE: Making the local domain name identical to the remote domain name
   is a security issue. Check with your administrator before changing it.

<P><LI>In the Microsoft Windows Network dialog box choose Log Off.
<P>
   NOTE: Logging off does not hang up your RAS connection.

<P><LI>If your remote user name is different from your local user name, type
   your remote user name in the Default Logon Name field and choose OK.

<P><LI>Quit Windows for Workgroups and reboot your computer.

<P><LI>Start Windows for Workgroups and enter your remote user name and
   password in the logon dialog box.
<P>
   NOTE: A message appears stating that you are logged on. Your remote
   domain credentials are now cached for automatic use when you later
   connect over RAS to your protected resources on the remote domain.
<P>
   Ignore the part of the message that indicates there was no server to log
   you on. This message is expected because the remote domain controller
   cannot be reached for account validation until you have a RAS
   connection.
<P>
</OL>Each time you log on with your remote credentials when you start Windows
for Workgroups, you will be able to establish the RAS connection and
connect to your protected remote resources without having to log off and on
again.
<P>
NOTE: Logging on with your remote credentials may prevent you from
accessing local resources and browse lists because your remote credentials
may not be valid on your local network. For more information, contact your
network administrator.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbnetwork<BR>
KBSubcategory: nthowto ntras ntsecurity<BR>
Additional reference words: 3.11 wfwg wfw pop up
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
