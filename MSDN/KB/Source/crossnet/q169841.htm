

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"Access Denied" Accessing Windows 95 Share from Windows NT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169841">
<META NAME="KBModify" CONTENT="1998/02/16">
<META NAME="KBCreate" CONTENT="1997/06/09">
<META NAME="Keywords" CONTENT="NTSrvWkst osr2 kberrmsg kbnetwork kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  When you attempt to connect to a share on a Windows 95-based computer from a Windows NT 4.0 workstation or server, the connection attempt may not succeed and you may receive an  Access Denied  error message if the following conditions exist:   - Th...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDL9,QBWN,QBWO,QBWQ,QDO3,QA1S,QAI5,QAXB,QAB4,QDNF,QDN9,QBVV,QA5E,QA3A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>"Access Denied" Accessing Windows 95 Share from Windows NT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169841</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release versions 1, 2, 2.1
<LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to connect to a share on a Windows 95-based computer from
a Windows NT 4.0 workstation or server, the connection attempt may not
succeed and you may receive an "Access Denied" error message if the
following conditions exist:

<UL><LI>The Windows 95 server has user-level security enabled (instead of
   share-level security), and the security provider is a Windows NT
   domain.

<LI>You are attempting to connect to the Windows 95-based computer by using
   a UNC name (\\&lt;servername&gt;\&lt;sharename&gt;) instead of by mapping a drive
   letter to the share.

<LI>The Windows NT 4.0 workstation or server has Service Pack 2 installed.
<P>
</UL><h2>CAUSE</h2>
 
<P>
This symptom is the result of an interoperability problem between Windows
NT 4.0 with Service Pack 2 installed and Windows 95. Windows NT 4.0 with
Service Pack 2 makes a connection using a null user name, which Windows 95
does not handle correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95 and
OEM Service Release 2 (OSR2). An update to address this problem is now
available, but is not fully regression tested and should be applied only
to computers experiencing this specific problem. Unless you are severely
impacted by this specific problem, Microsoft does not recommend
implementing this update at this time. Contact Microsoft Technical Support
for additional information about the availability of this update.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows NT 4.0 Service Pack 2 (SP2) uses a new version of the Multiple UNC
Provider (MUP) that contains new code for DFS. This code establishes a
null session when you connect to a server. The Windows 95 File And Print
Sharing service for Microsoft Networks (Vserver) does not handle the null
session correctly and tries to use a null user name to check for the
access rights. When the MUP null session requests arrives at Vserver,
SessSetupX calls AccessLogon.
<P>
Because smb_uid is always zero, even for TESTUSER, there is no way to
distinguish user TESTUSER from the null-session user. Vserver uses the
null user name for credentials checking in further SMB commands and you
receive the "Access Denied" error message.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 95 win95 win95x winnt browse browsing<BR>
Keywords          : NTSrvWkst osr2 kberrmsg kbnetwork kbfixlist<BR>
Version           : 4.0 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
