

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Rebuilding SQL Server Entries After Reinstalling Win NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119401">
<META NAME="KBModify" CONTENT="1997/01/25">
<META NAME="KBCreate" CONTENT="1994/08/15">
<META NAME="Keywords" CONTENT="kbsetup kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  After you reinstall Windows NT, the registry no longer has entries for SQL Server, and if you are using integrated security, the logins need to be restored. The SQL Server Setup program has an option that will rebuild the registry entries. This is ...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAA1,QDI2,QBWP,QDIZ,QAAD,QAGU,QAH4,QBVV,QANE,QAM4,QAK7,QAFI,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Rebuilding SQL Server Entries After Reinstalling Win NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119401</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server, versions 4.2x and 6.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
After you reinstall Windows NT, the registry no longer has entries for SQL
Server, and if you are using integrated security, the logins need to be
restored. The SQL Server Setup program has an option that will rebuild the
registry entries. This is detailed below, and is documented on page 144 of
the SQL Server version 4.2x "Configuration Guide."
<P>
NOTE: This is not documented in the version 6.0 product manuals.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To rebuild the SQL Server Registry entries, open a command prompt. The
Setup program needs various DLLs to run, and the DLL directory most likely
does not exist on the current path. The following commands will add the DLL
directory to the path and run the Setup program to rebuild the Registry.
<P>
The options to the Setup program are case sensitive and must be typed
exactly as shown, including capitalization. Also, a space must be on both
sides of the equal sign (=). This example assumes that SQL Server was
installed on drive C: using SQL Server version 4.2x:
<P>
<PRE>   set path=C:\SQL\DLL;%PATH%
   cd \sql\binn
   setup /t RegistryRebuild = On

</PRE>Note that for SQL Server version 6.0, you can use = On or = True for the
setup line.
<P>
You now must answer the questions exactly as you did during installation.
The setup program will reinsert all of the entries into the registry, but
will not install or change any files.
<P>
If SQL Server was set up to use integrated security, you will need to re-
add all of the users and groups by using the SQL Security Manager. You
should re-add all of the groups and users that you had previously added.
The SQL Security Manager will recognize that the users already exist in SQL
Server, and will not modify SQL Server but will go ahead and add the
necessary security entries in Windows NT.
<P>
Note that if you reinstalled Windows NT because you were changing the
domain for an Advanced Server, you will need to delete and re-add the users
in SQL Server because the default domain name has changed and will cause
the user name mapping to fail.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.20 6.00 rebuild reinstall Windows NT<BR>
KBCategory: kbsetup kbhowto<BR>
KBSubCategory: SSrvWinNT SSrvInst<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
