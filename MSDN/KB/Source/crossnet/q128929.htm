

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LAN Manager Logon Script Window Placement in WFW </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128929">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1995/04/13">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  When you log on from a Windows for Workgroups 3.11 client computer to a LAN Manager or Windows NT domain and your logon script (defined on the server) executes, two windows with identical LAN Manager Logon Script title bars appear. The window in th...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAI5,QAB4,QBWO,QAGB,QBW7,QAVZ,QAGC,QBTX,QAGU,QDL9,QBWQ,QBWN,QBLX,QBWE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>LAN Manager Logon Script Window Placement in WFW</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128929</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.11
<LI>Microsoft LAN Manager Server version 2.2b
<LI>Microsoft Windows NT Server version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you log on from a Windows for Workgroups 3.11 client computer to a LAN
Manager or Windows NT domain and your logon script (defined on the server)
executes, two windows with identical LAN Manager Logon Script title bars
appear. The window in the foreground states the following, and displays a
Cancel button:
<P>
<PRE>   Please wait while your logon script executes...

</PRE>If you press Enter, the logon script on the background window stops with
the following error messages:
<P>
<PRE>   Batch file missing
   Bad command or file name

</PRE>NOTE: The error messages above disappear very quickly. To view the error
messages, ensure that LMSCRIPT.PIF file does not have the Close Window On
Exit check box selected. The LMSCRIPT.PIF file is located in the
WINDOWS\SYSTEM subdirectory.
<P>
<P><h2>CAUSE</h2>
 
<P>
An additional window for the logon script with a Cancel button appears in
front of the actual logon script window when:

<UL><LI>WinPopup is enabled for Startup Settings in Control Panel Network.
<P>
   -and-

<LI>Domain Logon password is saved in the user's password list (PWL) file.
<P>
</UL>The above error messages occurs when you press Enter during the execution
of the logon script in the second background window. This operation cancels
the logon script execution.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, select the window running the logon script to
place it in the foreground.
<P>
To correct this problem:

<OL><P><LI>Reset the cached Domain Logon password by deleting the &lt;username&gt;.PWL
   file in the WINDOWS directory.

<P><LI>Log on to the Domain again. When the Domain Logon dialog box appears,
   enter the logon information, but do not select "Save this Password
   in Your Password List."

<P><LI>Run Control Panel, choose Network. Disable WinPopup.
<P>
   If your require WinPopup, add the following in the [windows] section of
   the WIN.INI file:
<P>
<P><PRE>      load=winpopup.exe
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop<BR>
KBSubcategory: ntinterop ntdomain<BR>
Additional reference words: prodnt 3.10 3.50 3.11 2.20b wfw wfwg lanman<BR>
user name
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
