

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Event ID 1008 Error Messages Generated by Proxy Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176696">
<META NAME="KBModify" CONTENT="1997/12/30">
<META NAME="KBCreate" CONTENT="1997/11/12">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; proxysvr, axsf, winnt, iis, mcis">
<META NAME="Description" CONTENT="  You may see one or more of the following error messages in the event log:  Event ID: 1008 Source: Perflib The open procedure for w3pcache in DLL Mspmon.dll failed performance data for this service will not be returned.  Event ID: 1008 Source: Perfl...">
<META NAME="Product" CONTENT="Proxy Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKF,QAB4,QAY5,QAU3,QAMR,QAPN,QAO4,QAM9,QAML,QALX,QACK,QA4H,QAAP,QANE,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Event ID 1008 Error Messages Generated by Proxy Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176696</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Proxy Server, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may see one or more of the following error messages in the event
log:
<P>
Event ID: 1008
Source: Perflib
The open procedure for w3pcache in DLL Mspmon.dll failed performance
data for this service will not be returned.
<P>
Event ID: 1008
Source: Perflib
The open procedure for w3proxy in DLL Mspmon.dll failed performance
data for this service will not be returned.
<P>
Event ID: 1008
Source: Perflib
The open procedure for wspsrv in DLL Wspperf.dll failed performance
data for this service will not be returned.
<P>
In some situations, in addition to the above error messages, the
Microsoft Proxy Server Performance Monitor shortcut may appear to
open Performance Monitor with incorrect objects and counters.
<P>
<P><h2>CAUSE</h2>
 
<P>
These error messages can be caused if one or more of the following
four registry values are missing or incorrectly set:

<UL><LI>First Counter
<LI>First Help
<LI>Last Counter
<LI>Last Help
<P>
</UL>In one or more of the following keys:
<P>
<PRE>   HKey_Local_Machine\System\CurrentControlSet\Services\W3proxy\
   Performance

   HKey_Local_Machine\System\CurrentControlSet\Services\Wspsrv\
   Performance

   HKey_Local_Machine\System\CurrentControlSet\Services\W3pcache\
   Performance

</PRE><h2>WORKAROUND</h2>
 
<P>
Reinstall Microsoft Proxy Server to replace the missing or incorrect
registry values.
<P>
You may also use the following steps to unload and reload the counters:

<OL><P><LI>From an Microsoft Windows NT command prompt, go to the following
   subdirectory on the Microsoft Proxy Server compact disc:
<P>
<P><PRE>      &lt;drive letter&gt;:\Msproxy\I386\Perfctrs
</PRE>
<P><LI>Do the following commands in the order listed below:
<P>
<P><PRE>      unlodctr wspsrv
      unlodctr w3proxy
      unlodctr w3pcache
      lodctr wspperf.ini
      lodctr w3pctrs.ini
      lodctr cachctrs.ini
</PRE>
<P><LI>If you are using Proxy Server 2.0, you will also need to issue
   the following commands:
<P>
<P><PRE>      unlodctr mspadmin
      lodctr pfctrs.ini
</PRE>
<P><LI>Reboot the computer.
</OL> 
<PRE>Technology        : internet
Version           : WINNT:2.0
Platform          : winnt
Hardware          : ALPHA x86
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
