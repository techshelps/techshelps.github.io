

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB:Scriptor Component Returns "Catastrophic Failure" Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174222">
<META NAME="KBModify" CONTENT="1997/11/03">
<META NAME="KBCreate" CONTENT="1997/09/23">
<META NAME="Keywords" CONTENT="kbprg CommMisc">
<META NAME="KBArea" CONTENT="Support; KB; commerce">
<META NAME="Description" CONTENT="  When a custom scriptor component written in VBScript is executed, the following error may occur based on whether or not error handling code is in place in the component.     Commerce.OrderPipeline error '80020009'     ::OrderExecute() failed for co...">
<META NAME="Product" CONTENT="commerce">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAKP,QA2B,QDNQ,QAZR,QAJG,QAPN,QAUD,QAH4,QAB9,QDKW,QBLM,QAKZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB:Scriptor Component Returns "Catastrophic Failure" Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174222</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Commerce Server, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a custom scriptor component written in VBScript is executed, the
following error may occur based on whether or not error handling code is in
place in the component.
<P>
<PRE>   Commerce.OrderPipeline error '80020009'

   ::OrderExecute() failed for component[0x..] hr: 0x8000ffff PROGID:
   Commerce.Scriptor.1 Cannot Execute Script SetScriptSite Catastrophic
   failure

   &lt;file name&gt;, &lt;line number&gt;

</PRE>The first time a scripting error is encountered, the pipeline returns the
error and a description of the scripting error. For example, if you attempt
to divide an integer by zero in your component, you receive the following
error message the first time pipeline is run:
<P>
<PRE>   Commerce.OrderPipeline error '80020009'

   ::OrderExecute() failed for component[0x..] hr: 0x80004005 PROGID:
   Commerce.Scriptor.1 Cannot Execute Script Execute invocation failed
   Unspecified error Division by zero

   &lt;file name&gt;, &lt;line number&gt;

</PRE>After the scriptor component encounters the divide by zero error,
subsequent executions of the order processing pipeline fail with the
"catastrophic failure" error message.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem occurs because no error handling code is written in the custom
component.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, always specify "On Error Resume Next" in the
component's VBScript code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information about "On Error Resume Next" is included in the
online VBScript reference in Visual Studio:
<P>
<PRE>   Syntax
   On Error Resume Next

   Remarks
   If you don't use an On Error Resume Next statement, any run-time error
   that occurs is fatal; that is, an error message is displayed and
   execution stops.

   On Error Resume Next causes execution to continue with the statement
   immediately following the statement that caused the run-time error, or
   with the statement immediately following the most recent call out of the
   procedure containing the On Error Resume Next statement. This allows
   execution to continue despite a run-time error. You can then build the
   error-handling routine inline within the procedure. An On Error Resume
   Next statement becomes inactive when another procedure is called, so you
   should execute an On Error Resume Next statement in each called routine
   if you want inline error handling within that routine.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: merchant prodcommerce<BR>
Keywords          : kbprg CommMisc<BR>
Version           : Windows:2.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
