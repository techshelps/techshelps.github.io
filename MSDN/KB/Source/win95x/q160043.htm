

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Err Msg: Error Defragmenting Drive &lt;X&gt;. Windows Could Not... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160043">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="defrag scandisk win95 winplus kbenv kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you run Disk Defragmenter (Defrag.exe), you may receive the following error message:     Error Defragmenting Drive        . Windows could not access part of the    drive. Click Help and carry out the instructions for running ScanDisk.    IMPOR...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDI5,QAB4,QBWS,QAC9,QBQU,QDJ6,QBVV,QBSO,QDL9,QBWO,QBWN,QAAP,QBW5,QAR4,QBXH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Err Msg: Error Defragmenting Drive &lt;X&gt;. Windows Could Not...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release versions 1, 2
<LI>Microsoft Plus! for Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Disk Defragmenter (Defrag.exe), you may receive the following
error message:
<P>
<PRE>   Error Defragmenting Drive &lt;drive&gt;. Windows could not access part of the
   drive. Click Help and carry out the instructions for running ScanDisk.
   IMPORTANT: To fix this problem, you must run ScanDisk and choose the
   Thorough option.
   ID No: DEFRAG005

</PRE>Note that the "ID No: DEFRAG005" portion of the error message may be
replaced by "ID No: DEFRAG006."
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs when Disk Defragmenter is unable to read from or write
to one or more bad sectors on the hard disk. The DEFRAG005 error message
is displayed when Disk Defragmenter is unable to write to a sector. The
DEFRAG006 error message is displayed when Disk Defragmenter is unable to
read from a sector.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Before you attempt to work around this problem, you should first make a
backup copy of any important data on your hard disk. After doing so, run
ScanDisk (Scandskw.exe) and perform a thorough test on the hard disk. To
do so, follow these steps:

<OL><P><LI>Click the Start button, point to Programs, point to Accessories, point
   to System Tools, and then click ScanDisk.

<P><LI>Click the hard disk referenced in the error message, and then click
   Thorough in the Type Of Test area.

<P><LI>Click Options, verify that System And Data Areas is selected, and then
   click OK.

<P><LI>Click Start to begin the test.
<P>
</OL>If ScanDisk does not find any bad sectors, or if running ScanDisk does not
correct the problem, configure ScanDisk to detect disk timeouts and check
each cluster five times while performing a surface scan. To do so, follow
these steps:

<OL><P><LI>Use any text editor (such as Notepad) to open the Scandisk.ini file
   in the Windows\Command folder.

<P><LI>Create an [Environment] section in the file, if the section does not
   already exist, and then add the following lines to the section:
<P>
<P><PRE>      ScanTimeOut=On
      NumPasses=5
</PRE><P>
   Note that the "ScanTimeOut=" and "NumPasses=" lines may already exist,
   but with different values.

<P><LI>Save and then close the Scandisk.ini file.

<P><LI>Click the Start button, click Shut Down, click "Restart the computer
   in MS-DOS mode," and then click Yes.

<P><LI>Type the following line and then press ENTER to run ScanDisk
<P>
<P><PRE>      scandisk &lt;drive&gt;:
</PRE><P>
   where &lt;drive&gt; is the drive letter of the hard disk you want to check.
   Note that you should run a surface scan when ScanDisk prompts you to do
   so, repair any errors that ScanDisk finds, and view and save the log
   file that ScanDisk creates.

<P><LI>When ScanDisk is finished, type "exit" (without quotation marks) and
   then press ENTER to return to Windows 95.

<P><LI>Run Disk Defragmenter again.
<P>
</OL>If you still receive the above error message, run Disk Defragmenter to
consolidate free space only, then defragment files only, and then perform a
full defragmentation (both files and free space). To do this, follow these
steps:

<OL><P><LI>Click Start, point to Programs, point to Accessories, point to System
   Tools, and then click Disk Defragmenter.

<P><LI>Click the hard disk referenced in the error message, and then click OK.

<P><LI>Click Advanced, click Consolidate Free Space Only, and then click OK.

<P><LI>Click No when you are prompted to quit Disk Defragmenter.

<P><LI>Click the hard disk referenced in the error message, and then click OK.

<P><LI>Click Advanced, click Defragment Files Only, and then click OK.

<P><LI>Click No when you are prompted to quit Disk Defragmenter.

<P><LI>Click the hard disk referenced in the error message, and then click OK.

<P><LI>Click Advanced, click "Full defragmentation (both files and free
   space)", and then click OK.

<P><LI>Click Yes when you are prompted to exit Disk Defragmenter.
<P>
</OL>If ScanDisk does not find any bad sectors, or if running ScanDisk does not
correct the problem, contact the manufacturer of your computer or hard
disk to inquire about additional workarounds that may correct the problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Many hard disks have sectors that are unusable. If the sectors have been
marked as bad by ScanDisk or another disk tool, Disk Defragmenter displays
the sector as a white box with a red line through it. This indicates that
the cluster has been marked as bad and cannot be used to store data.
<P>
If the disk tool you use is unable to detect bad sectors on your hard
disk, or if you do not run a disk tool on a regular basis, unusable
sectors that are not marked as bad may exist on the disk. When this
occurs, you may not realize that the bad sectors exist until Windows 95
attempts to store data in them. Therefore, it is possible for bad sectors
to appear while you are using the drive normally. If bad sectors begin to
appear on a regular basis, your hard disk may need to be repaired or
replaced.
<P>
Note that you may be able to prevent the error message from being
displayed by deleting some files on your hard disk, but doing so does
not fix the problem that is causing the error message to appear. Disk
Defragmenter does not read from unused sectors while defragmenting a
drive. Therefore, if an unusable sector that does not contain any data
exists on your hard disk, the problem described in this article may not
occur.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 osr1 osr2<BR>
Keywords          : defrag scandisk win95 winplus kbenv kberrmsg kbtool<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
