

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 95 ServiceProvider Priority Values Not Applied </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170619">
<META NAME="KBModify" CONTENT="1997/06/25">
<META NAME="KBCreate" CONTENT="1997/06/25">
<META NAME="Keywords" CONTENT="kbnetwork osr1 osr2 win95 kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry.  Before you edit the registry, you should first make a backup copy of the  registry files (System.dat and User.dat). Both are hidden files in the  Windows folder.   When you co...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBJZ,QBQU,QAXB,QAKD,QBWQ,QDIU,QAC1,QBVV,QBD2,QACK,QAKP,QDNF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 95 ServiceProvider Priority Values Not Applied</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170619</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release versions 1, 2, 2.1
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry. 
Before you edit the registry, you should first make a backup copy of the 
registry files (System.dat and User.dat). Both are hidden files in the 
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you configure the ServiceProvider Priority values in the registry to 
modify the DNS search order, the search order may not seem to be changed.
<P>
<P><h2>CAUSE</h2>
 
<P>
A ServiceProvider registry key exists (with associated registry values) 
at the following registry location:
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\MSTCP\
   ServiceProvider

</PRE>However, the Winsock code incorrectly references the ServiceProvider 
registry key at the following location:
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\MSTCP\
   ServiceProvider

</PRE><h2>RESOLUTION</h2>
 
<P>
To resolve this issue, use either of the following methods:
<P>
<P><h3>Method 1</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems 
that may require you to reinstall Windows 95. Microsoft cannot guarantee 
that problems resulting from the incorrect use of Registry Editor can be 
solved. Use Registry Editor at your own risk.
<P>
NOTE: For information about how to edit the registry, view the Changing 
Keys And Values online Help topic in Registry Editor (Regedit.exe). Note 
that you should make a backup copy of the registry files (System.dat and 
User.dat) before you edit the registry.
<P>
Create the registry key being referenced by Winsock. To do so, use the 
following steps:

<OL><P><LI>Use Regedit.exe to open the following location:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services
</PRE>
<P><LI>On the Edit menu, point to New, and then click Key. Name the new
   key MSTCP.

<P><LI>Click the new MSTCP key, point to New on the Edit menu, and then
   click Key. Name the new key ServiceProvider. The registry path should 
   look like this:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\MSTCP\
      ServiceProvider
</PRE>
<P><LI>Click the new ServiceProvider key, point to New on the Edit menu, and 
   then click Binary Value. Create the following new binary values:
<P>
<P><PRE>    - DnsPriority
    - LocalPriority
    - HostsPriority
    - NetbtPriority.
</PRE>
<P><LI>Set the priority values as appropriate.
<P>
</OL><h3>Method 2</h3>
 
<P>
Obtain the update mentioned in the "Status" section of this article. 
This update causes Winsock to reference the correct location for the 
ServiceProvider key in the registry.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95 and 
OEM Service Release 2 (OSR2). An update to address this problem is now 
available, but is not fully regression tested and should be applied only 
to computers experiencing this specific problem. Unless you are severely 
impacted by this specific problem, Microsoft does not recommend 
mplementing this update at this time. Contact Microsoft Technical Support 
for additional information about the availability of this update.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, see the following articles in the Microsoft 
Knowledge Base:
<P>
<PRE>    ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q158474.htm">Q158474</A></B>
    TITLE     : Windows 95 TCP/IP Registry Entries

    ARTICLE-ID: <B><A HREF="../CROSSNET/Q139270.htm">Q139270</A></B>
    TITLE     : How to Change Name Resolution Order on Windows 95 and
                Windows NT
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords            : kbnetwork osr1 osr2 win95 kbfixlist<BR>
Version             : 95<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
