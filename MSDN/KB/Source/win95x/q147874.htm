

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Slow Performance Across Token Ring Source Routers with NetBEUI </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147874">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1996/03/01">
<META NAME="Keywords" CONTENT="kbnetwork ndis3x osr1 osr2 win95">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  Network performance may be slow when you are using programs that repeatedly connect and disconnect from servers across a source routing bridge in a Token Ring environment.  CAUSE =====  When you are using the NetBEUI protocol on a Token Ring networ...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAK6,QDL9,QBWO,QBWN,QAM5,QAMR,QAXB,QAU3,QAGI,QAY5,QAVZ,QAK2,QAC1,QBD2,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Slow Performance Across Token Ring Source Routers with NetBEUI</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147874</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release versions 1, 2, 2.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Network performance may be slow when you are using programs that
repeatedly connect and disconnect from servers across a source routing
bridge in a Token Ring environment.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you are using the NetBEUI protocol on a Token Ring network, a 
NameQuery packet is broadcast several times without the source routing 
field set. If there is no response to half the possible name query 
requests, remaining requests are resubmitted with the source routing field
set. This behavior was designed to reduce network traffic on the LAN. If a
program repeatedly establishes connections and disconnects from servers 
across a source routing bridge, network performance is greatly reduced.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95 and 
OEM Service Release 2 (OSR2). An update to address this problem is now 
available, but is not fully regression tested and should be applied only 
to computers experiencing this specific problem. Unless you are severely 
impacted by this specific problem, Microsoft does not recommend 
implementing this update at this time. Contact Microsoft Technical Support
for additional information about the availability of this update.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This update recognizes a registry entry that enables the source routing 
information on all NameQuery packets. The default is to send the first 
four NameQuery requests without the source routing information. To enable 
source routing information on all NameQuery packets, add the string value
<P>
<PRE>   QueryAlwaysUsesSourceRouting

</PRE>to the registry under the following key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VXD\Netbeui

</PRE>If the data value is "1" NetBEUI uses source routing information in all 
NameQuery packets. The default value of "0" broadcasts half of the 
NameQuery packets on the local ring first without source routing 
information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 router bridge wan netbios<BR>
Keywords            : kbnetwork ndis3x osr1 osr2 win95<BR>
Version             : 95<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
