

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Desktop Folders Are Not Deleted Under Roving Profiles </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181869">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1998/02/27">
<META NAME="Keywords" CONTENT="osr1 osr2 win95 kbenv kbnetwork kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When roving profiles are implemented, Desktop or Start Menu folders that are not empty when you delete them from the client computer are not deleted from the server profile when you log off. When you log back on, the folders are restored, and are e...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QDL9,QBWO,QBWN,QAGB,QAFI,QBVV,QBCT,QAXB,QAGC,QDJ2,QDKD,QAC1,QDIJ,QBD2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Desktop Folders Are Not Deleted Under Roving Profiles</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181869</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release versions 1, 2, 2.1, 2.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When roving profiles are implemented, Desktop or Start Menu folders that
are not empty when you delete them from the client computer are not
deleted from the server profile when you log off. When you log back on,
the folders are restored, and are empty.
<P>
Note that if an empty folder is deleted, it is deleted from the server
profile, and is not restored during logon.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because during the logoff process, in order to
synchronize the server copy of the desktop with the client, the folder
structure of the client desktop is first enumerated in a hierarchical
order, parent folders first. The server copy of the desktop is also
enumerated, and compared to the client hierarchy. Differences found
between them are the source of a work list, that includes file and folder
deletions to be performed. The work list is processed in the same order as
the enumeration, and since parent folders are listed first, they are not
empty when the delete request is issued to the server.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This issue is resolved by the following updated file for Windows 95, all
versions, which adds functionality to optimize the order in which folder
deletions are requested:
<P>
<PRE>   MPRSERV.DLL version 4.00.958  dated 2/25/98 09:58am  127,488 bytes

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95
(retail release), and Microsoft Windows 95 OEM Service Releases 2 (OSR2)
and 2.1 (OSR2.1). An update to address this problem is now available, but
is not fully regression tested and should be applied only to computers
experiencing this specific problem. Unless you are severely impacted by
this specific problem, Microsoft does not recommend implementing this
update at this time. Contact Microsoft Technical Support for additional
information about the availability of this update.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: roaming<BR>
Keywords          : osr1 osr2 win95 kbenv kbnetwork kbfixlist<BR>
Version           : WINDOWS:95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
