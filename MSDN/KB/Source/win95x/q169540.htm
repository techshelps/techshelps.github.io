

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error Message: Too Many Outstanding Commands </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169540">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1997/06/04">
<META NAME="Keywords" CONTENT="osr2 win95 kberrmsg kbnetwork kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  The Vnetbios.vxd virtual device included with Windows 95 is limited to 38 posted Listens. Some programs that use the NetBIOS Application Programming Interface (API) in Windows 95 may need to post more than 38 Listens. The following error message ma...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAB4,QAXB,QBWQ,QBM7,QALZ,QAIB,QAB5,QAC1,QDO3,QDNF,QBXT,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Message: Too Many Outstanding Commands</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169540</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release version 2
<LI>Microsoft Windows 95 OEM Service Release version 2.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Vnetbios.vxd virtual device included with Windows 95 is limited to 38
posted Listens. Some programs that use the NetBIOS Application Programming
Interface (API) in Windows 95 may need to post more than 38 Listens. The
following error message may be displayed if this is attempted:
<P>
<PRE>   Too many outstanding commands.

</PRE>Note that posting other commands to the NetBIOS interface may also result
in this error message. This occurs mostly with asynchronous commands, but
may also occur with synchronous commands. As a general rule, a command
uses space for one network control block (NCB) in the device's internal
buffer. This buffer is separate from, and does not affect, the number of
sessions available to NetBIOS.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Vnetbios.vxd virtual device runs out of internal storage for NCBs when
38 Listens are posted. A key available in the Microsoft Windows 3.11
System.ini file (the "NumHCBs=" line in the [386Enh] section of the file)
that allows the internal storage buffer to be expanded is not implemented
in Windows 95.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This issue is resolved by the following updated file for Windows 95 (all
versions):
<P>
<PRE>   Vnetbios.vxd version 4.00.953, dated 12/16/97 09:53pm, 27,245 bytes

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95
(retail release) and Microsoft Windows 95 OEM Service Release 2 (OSR2) and
2.1 (OSR2.1). An update to address this problem is now available, but is
not fully regression tested and should be applied only to computers
experiencing this specific problem. Unless you are severely impacted by
this specific problem, Microsoft does not recommend implementing this
update at this time. Contact Microsoft Technical Support for additional
information about the availability of this update.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
After you obtain and install the update, add one of the values listed
below for the "NumHCBs=" line in the System.ini file. Note that the number
of Listens is not an exact correlate of the value set for the "NumHCBs="
line. This occurs because the Vnetbios.vxd internal command buffer is
allocated in pages, rather than the exact value on the "NumHCBs=" line.
<P>
<PRE>   [386Enh]
   NumHCBs=32      ; this is the default value, yields 38 listens
   ;NumHCBs=41      ; yields up to 77 listens
   ;NumHCBs=80      ; yields up to 117 listens

</PRE>NOTE: The semicolon (;) character shown at the beginning of the sample
entries begins commented text. Windows 95 ignores all text that follows
the semicolon. Include only one of the lines in the System.ini file, and
make sure that the leading semicolon has been removed so that the value is
used.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: netbios NumHCBs maximum listens<BR>
Keywords          : osr2 win95 kberrmsg kbnetwork kbfixlist<BR>
Version           : WINDOWS:95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
