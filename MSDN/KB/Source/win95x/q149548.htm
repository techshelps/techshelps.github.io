

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Multiple Copies of Command.com in Memory in MS-DOS Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149548">
<META NAME="KBModify" CONTENT="1996/04/04">
<META NAME="KBCreate" CONTENT="1996/04/04">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you restart your computer in MS-DOS mode, the MEM command may report two or more copies of Command.com in memory.  CAUSE =====  This situation occurs for the following reasons:   - Command.com loads itself in multiple pieces, which may be repo...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJH,QASB,QA9N,QDL9,QBWO,QBWN,QBV8,QAB9,QBWS,QBWQ,QAH4,QBWR,QDK2,QA5W,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Multiple Copies of Command.com in Memory in MS-DOS Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149548</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you restart your computer in MS-DOS mode, the MEM command may report
two or more copies of Command.com in memory.
<P>
<P><h2>CAUSE</h2>
 
<P>
This situation occurs for the following reasons:

<UL><LI>Command.com loads itself in multiple pieces, which may be reported
   separately.

<LI>When you restart your computer in MS-DOS mode, Windows 95 checks the
   "Exit to DOS.pif" file. Or, when you run a program shortcut that
   specifies MS-DOS mode, Windows 95 checks the program information file
   (PIF) for the shortcut. In either case, Windows 95 uses that
   information to build a batch file that describes how MS-DOS mode
   should be configured. The batch file has the following structure:
<P>
<P><PRE>      rem This is the batch file for MS-DOS mode
      &lt;custom Autoexec.bat information&gt;
      &lt;custom batch file information&gt;
      command.com
      &lt;restart the Windows 95 graphical user interface (GUI)&gt;
</PRE><P>
   After the Windows 95 GUI is shut down, Command.com runs the batch file.
   Therefore, two copies of Command.com are resident in memory. The outer
   copy runs the batch file and the inner copy processes your commands.
<P>
   When you type "exit" in the inner copy of Command.com, control is
   returned to the outer copy of Command.com, which restarts the Windows
   95 GUI.
<P>
</UL>Note that two copies of Command.com require less than twice the amount of
memory as one copy because the second and any subsequent copies share
information with the first copy.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Instead of exiting to MS-DOS mode and then running the program manually,
create a shortcut for the program and configure the shortcut to use MS-DOS
mode. When you want to run the program, double-click the shortcut instead
of exiting to MS-DOS mode manually.
<P>
For information about MS-DOS mode settings, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN95X/Q134400.htm">Q134400</A></B>
   TITLE     : General Tips for Using MS-DOS Mode
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv<BR>
KBSubcategory: win95<BR>
Additional reference words: 95<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
