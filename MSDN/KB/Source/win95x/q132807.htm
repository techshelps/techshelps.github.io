

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enhanced Encryption for Windows 95 Password Cache </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132807">
<META NAME="KBModify" CONTENT="1997/10/03">
<META NAME="KBCreate" CONTENT="1995/07/19">
<META NAME="Keywords" CONTENT="msnets osr1 win95 kbfile kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  The following issues exist regarding password list files in Windows 95:  1. An algorithm that can be used to compromise the security scheme used    in the Windows 95 password list (.pwl) file has been posted on the    Internet. A person who can acc...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWN,QAWK,QBWQ,QAXB,QDNF,QDO3,QAJQ,QAGU,QAC1,QABG,QBF0,QBD2,QAVZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Enhanced Encryption for Windows 95 Password Cache</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132807</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release 1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following issues exist regarding password list files in Windows 95:

<OL><P><LI>An algorithm that can be used to compromise the security scheme used
   in the Windows 95 password list (.pwl) file has been posted on the
   Internet. A person who can access the password list file on the hard
   disk of a Windows 95-based computer may be able to use this decryption
   algorithm to generate unencrypted passwords.

<P><LI>If two users with user names containing the same first eight characters
   log on to the same Windows 95-based computer, the first user's password
   list file becomes invalid.
<P>
   Note that this second symptom occurs only with the Windows 95 Password
   Cache update (Mspwl32.dll version 9.00.951) available with Microsoft
   Windows 95 Service Pack 1 and OEM Service Release 1.
<P>
</OL><h2>CAUSE</h2>
 

<OL><P><LI>The encryption mechanism used specifically for Windows 95 .pwl
   files, including not only the algorithm itself but also the manner in
   which it is applied, may be susceptible to certain decryption
   techniques.
<P>
   Different encryption algorithms are applied elsewhere in Windows 95 to
   encrypt other information. These algorithms are not susceptible to the
   decryption techniques mentioned above.

<P><LI>When a user logs on to Windows 95, Windows 95 checks the System.ini
   file to see if that user has logged on before. If there is no entry for
   that user, the first eight characters of the user name are used to
   create a password list file for the user. If another password list file
   with the same name exists, it is overwritten.
<P>
   Note that this second symptom occurs only with the Windows 95 Password
   Cache update (Mspwl32.dll version 9.00.951) available with Microsoft
   Windows 95 Service Pack 1 and OEM Service Release 1.
<P>
</OL><h2>RESOLUTION</h2>
 
<P>
These issues are resolved by the following updated files for Windows 95
and Windows 95 OEM Service Release 1:
<P>
<PRE>   Mspwl32.dll version 4.00.952 (dated 4/26/96) and later
   Net.exe (no version information) dated 12/11/95 and later

</PRE></OL>To install this update, follow these steps:

<OL><P><LI>Download the Mspwlupd.exe file from the Microsoft Software Library to
   an empty folder.

<P><LI>In My Computer or Windows Explorer, double-click the Mspwlupd.exe file
   you downloaded in step 1.

<P><LI>Follow the instructions on the screen.
<P>
</OL>The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Mspwlupd.exe">Mspwlupd.exe</A> <I>(size: 326304 bytes)</I> 

</PRE></OL>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>The following files are installed by Mspwlupd.exe:
<P>
<PRE>   File name     Version    Date/Time         Size     Destination folder
   ----------------------------------------------------------------------
   Mspwl32.dll   4.00.952    4/26/96 9:52am    21,504  Windows\System
   Net.exe                  12/11/95 9:51am   375,930  Windows

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This update is an enhanced security component that substantially
strengthens the encryption used for the Microsoft Windows 95 password
cache. The new component uses a 128-bit key, increased from the 32-bit
key used in the previous version. The new component also includes
enhancements to the method used to store passwords in the .pwl file.
With the 128-bit security, the new component is 2^96 times more
difficult to decrypt.
<P>
This component replaces the Mspwl32.dll and Net.exe files. The previous
.pwl file is automatically upgraded to the new format.
<P>
Net.exe, which is usually used from the command line, no longer uses
the password cache. Users are prompted for passwords when using
Net.exe to connect to resources on the network.
<P>
NOTE: Because the same algorithm is used to cache passwords in Windows
for Workgroups version 3.11, you may want to disable password caching in
Windows for Workgroups using Admincfg.exe. For information about using
Admincfg.exe, please refer to the Windows for Workgroups Resource Kit.
<P>
NOTE: If you disabled password caching on a Windows 95-based computer as
a temporary workaround before installing this update, you can re-enable
password caching after installing this update. You can re-enable password
caching by reversing the procedure documented in the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN95X/Q140557.htm">Q140557</A></B>
   TITLE     : Microsoft Windows 95 Password List Security Issue

</PRE>To re-enable password caching, set the DisablePwdCaching value to zero (0)
or delete the DisablePwdCaching value.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : msnets osr1 win95 kbfile kbnetwork<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
