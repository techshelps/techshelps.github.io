

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Description of Restarting Computer in MS-DOS Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138996">
<META NAME="KBModify" CONTENT="1997/04/18">
<META NAME="KBCreate" CONTENT="1995/10/31">
<META NAME="Keywords" CONTENT="kbenv win95 kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article describes the process that occurs when you restart your computer by choosing  Restart the computer in MS-DOS mode  in the Shut Down Windows dialog box, or by double-clicking a program or shortcut configured to run in MS-DOS mode. This ...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJH,QAIJ,QBWS,QAFY,QDKH,QDL9,QBWO,QBWN,QDKI,QANE,QBWQ,QAGB,QDK2,QAH4,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Description of Restarting Computer in MS-DOS Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138996</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes the process that occurs when you restart your
computer by choosing "Restart the computer in MS-DOS mode" in the Shut
Down Windows dialog box, or by double-clicking a program or shortcut
configured to run in MS-DOS mode. This article also describes how to
define custom Config.sys and Autoexec.bat files to be processed when you
restart your computer using the "Restart the computer in MS-DOS mode"
option.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Restarting the Computer in MS-DOS Mode</h3>
 
<P>
When you restart your computer by choosing the "Restart the computer in 
MS-DOS mode" option in the Shut Down Windows dialog box, Windows closes 
all running programs, removes itself from memory, and then starts a real-
mode command prompt. If the Use Current MS-DOS Configuration option is 
selected in the "Exit to DOS.pif" file that is used to restart the 
computer in MS-DOS mode, the Dosstart.bat file in the Windows folder is 
processed. If the Specify A New MS-DOS Configuration option is selected, 
the Config.sys and Autoexec.bat files listed in the "Exit to DOS.pif" file
are used instead of the Config.sys and Autoexec.bat files in the root 
folder.
<P>
To restart Windows normally after restarting the computer in MS-DOS mode,
type "exit" (without quotation marks) at the command prompt and then press
ENTER.
<P>
<P><h3>Starting a Program in MS-DOS Mode</h3>
 
<P>
When you double-click a program or shortcut configured to run in MS-DOS
mode, the following items are performed. The items listed below assume
that a new MS-DOS configuration has been specified.

<OL><P><LI>The Config.sys and Autoexec.bat files in the root folder of the boot
   drive are renamed to Config.wos and Autoexec.wos. If the Config.sys or
   Autoexec.bat file does not exist in the root folder, a zero-byte
   Config.wos or Autoexec.wos file is created.

<P><LI>The custom Config.sys and Autoexec.bat files specified in the 
   properties for the MS-DOS-based program you are running are copied to 
   the root folder of the boot drive. The last line in the Config.sys file
   is always:
<P>
<P><PRE>      dos=single
</PRE><P>
   The last line in the Autoexec.bat file is always the following line
<P>
<P><PRE>      c:\&lt;windows&gt;\win.com /wx
</PRE><P>
   where &lt;windows&gt; is the name of your Windows folder. The Autoexec.bat
   file also contains a CD statement that changes to the folder that
   contains the MS-DOS-based program's files and a CALL statement that
   starts the MS-DOS-based program.

<P><LI>Windows restarts the computer.

<P><LI>While the computer boots, Io.sys detects the presence of the Config.wos
   and Autoexec.wos files in the root folder of the boot drive and 
   displays the following message:
<P>
<P><PRE>      Windows 95 is now starting your MS-DOS-based-program.
</PRE><P>
<P><PRE>      Press Esc now to cancel MS-DOS mode and restart Windows 95.
</PRE><P>
   The above message is displayed for approximately three seconds. If you
   press the ESC key during this time, the MS-DOS-based program you are
   running does not run and Windows 95 restarts normally instead. Note 
   that the "Starting Windows 95" message is not displayed when the above
   message is displayed.

<P><LI>If you do not press the ESC key while the above message is displayed,
   the Config.sys and Autoexec.bat files are processed. The CALL statement
   in the Autoexec.bat file starts the MS-DOS-based program.

<P><LI>When you quit the MS-DOS-based program, the remainder of the
   Autoexec.bat file is processed, beginning with the line immediately
   following the CALL statement. The line immediately following the CALL
   statement is normally the line that starts Win.com.
<P>
   The /WX switch causes Win.com to rename the current
   Config.sys and Autoexec.bat files to Config.app and Autoexec.app,
   restore the original Config.sys and Autoexec.bat files from the
   Config.wos and Autoexec.wos files, delete the Config.wos and
   Autoexec.wos files, and then reboot the system to Windows 95. Note that
   using the /WX switch instead of the /W switch prevents the following
   message from appearing after these steps are performed:
<P>
<P><PRE>      Press any key to continue...
</PRE><P>
   If the Win.com line is removed from the Autoexec.bat file before you
   quit the MS-DOS-based program, or you attempt to start Windows from the
   command prompt before the Win.com line in the Autoexec.bat file is
   processed, the following message is displayed:
<P>
<P><PRE>      You are currently running in MS-DOS mode. Do you want to return to
      normal mode, to run Windows applications again?
</PRE><P>
   NOTE: If the CALL statement in the Autoexec.bat file starts the MS-DOS
   command interpreter (Command.com), you must type "exit" (without
   quotation marks) at a command prompt and then press ENTER to quit that
   instance of the command interpreter and allow the remainder of the
   Autoexec.bat file to be processed. If the CALL statement starts a 
   third-party command interpreter, you must type the appropriate command 
   to quit that instance of the third-party command interpreter.

<P><LI>Windows restarts the computer.

<P><LI>While Windows starts, the Config.app and Autoexec.app files are copied
   to the properties for the MS-DOS-based program you are running in 
   MS-DOS mode or the properties for the shortcut that starts the MS-DOS-
   based program you are running in MS-DOS mode. If the Config.app and
   Autoexec.app files are accidentally deleted before this occurs, the
   custom Config.sys and Autoexec.bat files must be created again
   manually.
<P>
</OL><h3>Defining Custom Config.sys and Autoexec.bat Files</h3>
 
<P>
To define custom Config.sys and Autoexec.bat files to be processed when you
restart your computer using the "Restart the computer in MS-DOS mode"
option, follow these steps:

<OL><P><LI>If you have not restarted the computer in MS-DOS mode before, click
   Start, click Shut Down, click Restart The Computer In MS-DOS Mode, and
   then click Yes. At the command prompt that appears, type "exit" 
   (without quotation marks) and then press ENTER.

<P><LI>Click the Start button, point to Programs, and then click Windows
   Explorer.

<P><LI>Locate the "Exit to DOS.pif" file in the Windows folder, use the right
   mouse button to click the file, and then click Properties on the menu
   that appears.

<P><LI>Click the Program tab, and then click Advanced.

<P><LI>Click Specify A New MS-DOS Configuration, define the custom Config.sys
   and Autoexec.bat files in the CONFIG.SYS For MS-DOS Mode and
   AUTOEXEC.BAT For MS-DOS Mode boxes, and then click OK.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information about using MS-DOS mode in Windows 95 to run
MS-DOS-based programs, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID : <B><A HREF="../WIN95X/Q134400.htm">Q134400</A></B>
   TITLE      : General Tips for Using MS-DOS Mode
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords            : kbenv win95 kbenv<BR>
Version             : 95<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
