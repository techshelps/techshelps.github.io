

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Windows 95 Performs a Safe-Mode Start </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122051">
<META NAME="KBModify" CONTENT="1998/01/02">
<META NAME="KBCreate" CONTENT="1994/10/25">
<META NAME="Keywords" CONTENT="win95 winboot wpp95 kbenv kbui">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article discusses how Windows 95 boots in Safe mode. A Safe-mode boot can be invoked in the following ways:   - By pressing F5 at the  Starting Windows 95  message.   - By pressing F8 at the  Starting Windows 95  message, and then choosing    ...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QDL9,QBWO,QBWN,QBWQ,QDIV,QDNF,QAKR,QAIJ,QAHE,QBVV,QAGQ,QAJG,QA0B,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Windows 95 Performs a Safe-Mode Start</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122051</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses how Windows 95 boots in Safe mode. A Safe-mode
boot can be invoked in the following ways:

<UL><LI>By pressing F5 at the "Starting Windows 95" message.

<LI>By pressing F8 at the "Starting Windows 95" message, and then choosing
   Safe Mode from the Windows 95 Startup menu.

<LI>Automatically, if Windows 95 did not start on the previous attempt.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
How Windows 95 boots in Safe mode:

<OL><P><LI>Windows 95 bypasses the Registry and the Autoexec.bat and Config.sys
   files.

<P><LI>Himem.sys is loaded with the /testmem:on switch. No other command-line
   switches are processed. For additional information, please see the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../WIN95X/Q133442.htm">Q133442</A></B>
<PRE></PRE>      TITLE     : Safe Mode Boot Does Not Process Machine Switch for
                  Himem.sys

</PRE><P><LI>Ifshlp.sys is loaded. Dblbuff.sys is loaded with the /d+ switch.

<P><LI>Windows 95 obtains path information from the Msdos.sys file.

<P><LI>If Windows 95 files are found, the command "win /d:m" (which enables
   a Safe-mode boot) is executed and Command.com is skipped.
<P>
   If Windows 95 files are not found, Command.com is executed.

<P><LI>When "win /d:m" is executed, Windows 95 looks for a System.cb file
   in the Windows folder. If this file is not present, a clean
   System.cb file is loaded from memory.
<P>
   A clean System.cb file loads the following virtual device drivers
   (VxDs):
<P>
<P><PRE>      mouse=*vmouse
      device=*configmg
      device=*vwin32
      device=*vfbackup
      device=*vshare
      device=*vcomm
      device=*ifsmgr
      device=*ios
      device=*vfat
      device=*vcache
      device=*vcond
      device=*int13
      device=*vxdldr
      device=*vdef
      device=*dynapage
      device=*reboot
      device=*vsd
      device=*parity
      device=*biosxlat
      device=*vmcpd
      device=*vkd
      device=*vdd
      device=*ebios
      device=*vtdapi
      device=*vmpoll
      woafont=dosapp.fon
</PRE>
<P><LI>After these VxDs are loaded, and just before Win.com loads the shell,
   the System.cb file is discarded and the original System.ini file is
   restored. If no System.ini file is found to restore, an empty
   System.ini file is created. The Winstart.bat file is not processed.

<P><LI>Windows 95 now uses the original registry settings and System.ini and
   Win.ini files.
<P>
   This effectively bypasses the [Boot] and [386Enh] sections of the
   System.ini file and disables all the Windows 95 protected-mode devices
   listed in Device Manager. Also, Windows 95 does not run programs listed
   on the "Load=" and "Run=" lines in the [Windows] section of the Win.ini
   file.
<P>
   Note that although the [Boot] section of the System.ini file is
   bypassed, the "shell=" and "drivers=" lines in the [Boot] section
   are processed.

<P><LI>The shell resizes the desktop to a resolution of 640 x 480.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : win95 winboot wpp95 kbenv kbui<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
