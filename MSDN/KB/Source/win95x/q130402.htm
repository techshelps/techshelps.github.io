

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Device Contention in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130402">
<META NAME="KBModify" CONTENT="1996/03/13">
<META NAME="KBCreate" CONTENT="1995/05/18">
<META NAME="Keywords" CONTENT="kbenv kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="   Device contention  refers to the ability of Windows to arbitrate requests for the use of a device (usually a serial port) by more than one program, one of which is not a Windows-based program. Windows 95 does not by default allow a Windows-based p...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDJ9,QDL9,QBWO,QBWN,QBWQ,QABA,QDJP,QAKG,QAB5,QBXS,QBAO,QAJZ,QAJH,QDNF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Device Contention in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130402</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
"Device contention" refers to the ability of Windows to arbitrate requests
for the use of a device (usually a serial port) by more than one program,
one of which is not a Windows-based program. Windows 95 does not by default
allow a Windows-based program to use a serial port that was previously used
by a non-Windows-based program running in a virtual machine (VM) until that
VM is closed. This behavior is different from previous versions of Windows,
in which the default behavior is for the device to be released after a two-
second period of inactivity.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The state of Windows 95 device contention is determined by the value for
the "COM&lt;n&gt;AutoAssign=&lt;x&gt;" setting in the [386Enh] section of the
System.ini file, where &lt;n&gt; is the number of the serial port and &lt;x&gt; is a
value from -1 to 1000.
<P>
The default setting in Windows 95 is -1. This setting causes Windows 95 to
not release a serial port previously used by a non-Windows-based program
running in a VM until that program's VM is closed. When an MS-DOS-based or
Windows-based communications program requests the use of a serial port,
Windows 95 checks to see if the port is in use. If the port is available,
Windows 95 gives the program access to the port. You can change this
behavior by adding "COM&lt;n&gt;AutoAssign=&lt;x&gt;" to the [386Enh] section of the
System.ini file. The default value for this setting in Windows version 3.1
is 2, causing Windows to grant access to the port after two seconds of port
inactivity. In Windows 95, this default has been changed for compatibility
with some of the Windows 95 tools that have automatic answering capability
(such as Microsoft Fax and Dial-Up Networking Server).
<P>
If a Windows-based program attempts to use the serial port before the VM is
closed, you receive one of the following error messages:

<UL><LI>Another program is using the selected Telephony device. Try again
   after the other program completes.

<LI>Cannot initialize port.
<P>
</UL>WARNING: If you set COM&lt;n&gt;AutoAssign=2, do not run a 32-bit communications
program (such as HyperTerminal) and then attempt to run an MS-DOS-based
communications program. Because of the way the 32-bit program controls the
port, the MS-DOS-based program will be unable to access it and may cause
your system to stop responding (hang).
<P>
If you need hot-swapping capability between an MS-DOS-based communications
program and a Windows-based communication program, add the following entry
to the [386Enh] section of the System.ini file:
<P>
<PRE>   Com&lt;n&gt;AutoAssign=0

</PRE>This setting allows an MS-DOS-based application to hand off a "hot port" to
a Windows-based program with no delay. This is sometimes necessary in
bulletin board administration. This configuration can cause some problems
or instabilities because two programs can send commands to the modem at the
same time.
<P>
NOTE: Although all the settings described in this article work, we
recommend that you use the default setting of -1.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kberrmsg<BR>
KBSubcategory: wpp95 win95 wincomm<BR>
Additional reference words: 95 comxautoassign<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
