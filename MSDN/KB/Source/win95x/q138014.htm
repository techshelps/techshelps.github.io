

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>File May Be Truncated to Zero Bytes When Copied Onto Itself </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138014">
<META NAME="KBModify" CONTENT="1997/11/12">
<META NAME="KBCreate" CONTENT="1995/10/10">
<META NAME="Keywords" CONTENT="msnds msnets win95 kbfile kbnetwork kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you try to copy a file onto itself, you receive a Confirm File Replace dialog box prompting you to confirm that you want to replace the existing file. If you click Yes, the file may be truncated to zero bytes. If you click No, the file is unch...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QDL9,QBWO,QBWN,QAJQ,QAA1,QA9N,QDI2,QASB,QDIJ,QAKP,QDOX,QDIZ,QAM2,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>File May Be Truncated to Zero Bytes When Copied Onto Itself</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138014</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to copy a file onto itself, you receive a Confirm File
Replace dialog box prompting you to confirm that you want to replace the
existing file. If you click Yes, the file may be truncated to zero bytes.
If you click No, the file is unchanged.
<P>
This problem occurs only when you copy a file onto itself using two
different views of the same network resource (such as when you have two
different drive letters mapped to the same network resource, or when you
have two UNC connections to the same network resource), or when you copy
a file onto itself using a drive created with the SUBST command.
<P>
NOTE: If you try to move (rather than copy) a file in this manner, the
file may be deleted.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has released a new version (4.00.951) of the Shell32.dll file
(817,664 bytes) that corrects this problem.
<P>
To install this update, download the Windows 95 Service Pack 1 Update
Setup.exe file from one of the sources listed below.
<P>
In addition to correcting the problem described in this article, the new
version of Shell32.dll provides the ability to browse printers from the
Add Printer Wizard for users of the Microsoft Service for NetWare
Directory Services (NDS). Users of the standard network clients included
with Windows 95 can already browse printers and do not require this update
to browse for printers.
<P>
<P><h3>Installation</h3>
 
<P>
To correct the problem described in this article, follow these steps:

<OL><P><LI>Download the Setup.exe file from one of the online services listed
   below to an empty folder.

<P><LI>In My Computer or Windows Explorer, double-click the Setup.exe file.

<P><LI>Follow the instructions on your screen.

<P><LI>After the installation process is finished, shut down and then restart
   your computer.
<P>
</OL><h3>Instructions for Downloading</h3>
 
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/SETUP.EXE">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
                      , a self-extracting file, on the following
</PRE></OL>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A HREF="http://support.microsoft.com/download/support/mslfiles/SETUP.EXE">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
                            , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/SETUP.EXE">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/SETUP.EXE">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>For information about Microsoft Windows 95 Service Pack 1, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN95X/Q142794.htm">Q142794</A></B>
   TITLE     : Availability of Microsoft Windows 95 Service Pack 1

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem does not affect most users, because copying a file onto
itself is an unnecessary task. In addition, this problem occurs only in
the following circumstances:

<UL><LI>The problem occurs only when you copy a file onto itself on a drive
   using drive mapping (such as a mapped network drive or a drive created
   with the SUBST command) or a UNC connection. Users in non-networked
   environments, and users who do not use the SUBST command, are not
   affected by this problem.

<LI>The problem occurs only if you use two views of the same network
   resource, or drive created with the SUBST command, and copy a file
   onto itself. For example, the problem may occur if you map drive X to
   the \\&lt;server&gt;\&lt;folder&gt; network resource, map drive Y to the same
   network resource, and then copy a file from the root folder of drive X
   to the root folder of drive Y.

<LI>The problem occurs only with files of a certain size. While preliminary
   testing indicates that only files smaller in size than approximately
   234K are affected, the affected file size is also dependent on the size
   of the local and network buffers, and may vary based on configuration.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 msnWin95misc pcweek servicepack1<BR>
Keywords          : msnds msnets win95 kbfile kbnetwork kbprb<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
