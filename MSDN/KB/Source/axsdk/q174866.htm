

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: CAB SDK Headers Contain Incorrect CB_MAX_DISK Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174866">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/10/07">
<META NAME="Keywords" CONTENT="InetSDKCAB">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  When compressing data using Fci.lib from the Cabinet (CAB) SDK, a new cabinet file is started after about 134 MB of data has been compressed.  CAUSE =====  Fci.h contains an incorrect definition for CB_MAX_DISK. The value is defined as 0x7FFFFFFL (...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIY,QAKD,QAAP,QAR4,QAKC,QAYY,QALZ,QAI4,QBVX,QAVZ,QDL9,QBXS,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: CAB SDK Headers Contain Incorrect CB_MAX_DISK Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174866</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, versions 4.0, 4.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When compressing data using Fci.lib from the Cabinet (CAB) SDK, a new
cabinet file is started after about 134 MB of data has been compressed.
<P>
<P><h2>CAUSE</h2>
 
<P>
Fci.h contains an incorrect definition for CB_MAX_DISK. The value is
defined as 0x7FFFFFFL (134,217,727) instead of 0x7FFFFFFFL (2,147,483,647)
as it should be. CB_MAX_DISK is also defined incorrectly in this way in
Fdi.h.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Redefine CB_MAX_DISK to the correct value of 0x7FFFFFFFL:
<P>
<PRE>   #define CB_MAX_DISK 0x7FFFFFFFL

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Specifying a value of 0 for disk size (cb value in CCAB struct) resets the
value to CB_MAX_DISK. However, CB_MAX_DISK is defined incorrectly as
0x7FFFFFFL or 134,217,727. It should be 0x7FFFFFFFL, or 2,147,483,647. Data
compression proceeds to about 134 Mb, then it switches to a new cabinet.
The desired result of a larger cabinet (CAB) can be obtained by explicitly
supplying the correct larger value.
<P>
Note that a CAB can normally contain at most 65,500 or so files. There is
no code in FCI to avoid exceeding this value, so the user application may
have to enforce it.
<P>
Also note that unless a CAB will be randomly extracted, cbFolderThresh
should be explicitly set to a very large value. If the CAB will be
randomly extracted, values between 100 K and 1 Mb would be appropriate.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about cabinets and the CAB SDK, see the following Web
site:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/workshop/prog/cab/">http://www.microsoft.com/workshop/prog/cab/</A></B>

</PRE> 
<PRE>Keywords          : InetSDKCAB
Technology        : kbInetDev
Version           : WINDOWS:4.0,4.01
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
