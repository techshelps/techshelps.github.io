

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Error Initializing the WinInet Cache </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160060">
<META NAME="KBModify" CONTENT="1998/01/22">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="AXSDKWinInet iisApi iisFilter iisGeneral kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  When you start an application that uses WinInet functionality (such as Internet Explorer 3.0), the following message might appear:     Error initializing the cache. Shutdown all programs and run ScanDisk or    ChkDsk. Delete the cache, cookies and ...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBF0,QAKP,QACK,QAIJ,QAVZ,QBWS,QAM1,QAH4,QAA1,QABI,QAA8,QAI5,QDL9,QDI2,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error Initializing the WinInet Cache</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 22, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160060</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ActiveX SDK, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you start an application that uses WinInet functionality (such as
Internet Explorer 3.0), the following message might appear:
<P>
<PRE>   Error initializing the cache. Shutdown all programs and run ScanDisk or
   ChkDsk. Delete the cache, cookies and history directories in your
   Windows directory and then restart Internet Explorer. If the problem
   persists reinstall Internet Explorer.

</PRE><h2>CAUSE</h2>
 
<P>
This is a problem with the WinInet cache that occurs whenever WinInet is
first loaded in the context of a service, such as an ISAPI filter, and then
by a user process, such as a browser like Internet Explorer 3.0.
<P>
If this problem occurs consistently on a machine that uses Internet
Information Server (IIS), this problem could be caused by the use of the
WinInet API within an IIS filter DLL. This includes Front Page server
extensions that operate as IIS filter DLLs.
<P>
Generally, if the WinInet DLL is first loaded by a service, the WinInet
cache is initialized in such a way that it cannot be accessed by user-mode
programs. IIS filter DLLs are a common cause of this problem because they
are loaded in a special Internet user account by IIS.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The cache does not work properly in this situation for any user-mode
programs, but other WinInet functions are be impaired. To workaround this
problem, either don't use any IIS filter DLL that uses WinInet, or make
sure a user-mode WinInet application is running before you start the IIS
service.
<P>
For example, you could manually start the IIS service after running
Internet Explorer 3.0. This causes the WinInet cache to initialize in the
user-mode context of Internet Explorer 3.0, thus preventing any filter DLL
using WinInet from locking out other user-mode programs from the cache.
<P>
<P><h2>STATUS</h2>
 
<P>
This problem has been fixed in the latest version of the WinInet DLL, which
can be obtained by installing the Internet Explorer 3.02 File Upload Add-On
for Windows 95 and NT. It is available at
<B><A HREF="http://www.microsoft.com/msdownload/ieplatform/iewin95/iewin95.asp">http://www.microsoft.com/msdownload/ieplatform/iewin95/iewin95.asp.</A></B>
<P>
Internet Explorer 3.02 must be installed before applying this Add-On.
<P>
The problem has also been fixed in Internet Explorer 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The implementation of WinInet uses a memory mapped file (MMF) to share the
cache. If IIS, which is a service, has already created the MMF, then non-
service applications cannot access the MMF.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q106387.htm">Q106387</A></B>
   TITLE     : Sharing Objects with a Service

</PRE> 
<PRE>Keywords          : AXSDKWinInet iisApi iisFilter iisGeneral kbnetwork
Technology        : kbInetDev
Version           : 1.0
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 22, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
