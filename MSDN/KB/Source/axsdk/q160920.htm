

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Framer Sample Does Not Handle Activation Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160920">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1996/12/12">
<META NAME="Keywords" CONTENT="AXSDKDocObjects">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  The Framer sample that comes with the ActiveX SDK does not handle Wm_Activateapp. As a result, the contained DocObject is unable to determine if the container is active or not. This becomes a problem when, for example, Word is started within Framer...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAPF,QAR4,QAIJ,QBVV,QAM1,QABV,QAH6,QAHV,QAHQ,QDO7,QAKP,QAVZ,QBWS,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Framer Sample Does Not Handle Activation Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160920</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ActiveX SDK, version 1.0
<LI>Internet Client SDK, version 4.0, 4.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Framer sample that comes with the ActiveX SDK does not handle
Wm_Activateapp. As a result, the contained DocObject is unable to determine
if the container is active or not. This becomes a problem when, for
example, Word is started within Framer and outside Framer. Actions that you
perform in the contained instance of Word, such as bringing up a dialog
box, actually occur in the standalone instance instead.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The solution to this problem involves notifying the contained DocObject of
activation changes by calling
IOleInPlaceActiveObject::OnFrameWindowActivate() and passing as a parameter
True if framer is activating and False if it is deactivating. The following
code can be added to Framer.cpp in the FrameWndProc function to handle
this:
<P>
<PRE>   case WM_ACTIVATEAPP:
      if (NULL != pFR-&gt;m_pIOleIPActiveObject)
      {
      HRESULT hr;
      hr = pFR-&gt;m_pIOleIPActiveObject-&gt;OnFrameWindowActivate((BOOL)wParam);
      }
      break;

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Framer sample supplied
with the ActiveX SDK. This problem has been fixed in the version of the
Framer sample provided with the Internet Client SDK for Internet Explorer
4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Framer (\Inetsdk\Samples\Framer\Debug\Framer).

<P><LI>Load a Word document into Framer with File-&gt;Open (for example,
   \Inetsdk\Specs\Asynchronous Storage.doc).

<P><LI>Start a standalone copy of Word.

<P><LI>Choose View-&gt;Toolbars from the contained word instance, and the dialog
   box comes up in the stand alone instance. If you change the Toolbar
   settings, notice that the changes are also reflected in the standalone
   instance of Word.
<P>
</OL> 
<PRE>Keywords          : AXSDKDocObjects
Technology        : kbInetDev
Version           : Win:1.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
