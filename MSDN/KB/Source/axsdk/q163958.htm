

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Ccdist.exe Fails to Register Comcat.dll Until Reboot </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163958">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1997/02/20">
<META NAME="Keywords" CONTENT="AXSDKControls kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  Attempting to register a component using RegSvr32.exe or via self- registration using DllRegisterServer() fails when the control uses the component category API.  CAUSE =====  The problem is due to the self-extracting executable Ccdist.exe that ins...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJG,QAGI,QDK2,QAA1,QDI2,QDNN,QABO,QAKP,QAV1,QAV0,QAJ6,QAGU,QAIF,QA0A,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Ccdist.exe Fails to Register Comcat.dll Until Reboot</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163958</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS
kbtool kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Platform SDK, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to register a component using RegSvr32.exe or via self-
registration using DllRegisterServer() fails when the control uses the
component category API.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem is due to the self-extracting executable Ccdist.exe that
installs the component category DLL but fails to register the component in
the system registry until the user reboots the machine.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Component Categories help identify areas of functionality that an OLE
component may support. Applications or components that take advantage of
this functionality may redistribute the self-extracting executable,
Ccdist.exe, from the Win32 SDK. Ccdist.exe then installs the necessary
component categories DLL, Comcat.dll.
<P>
Typically, when a redistributable file is distributed as a self-extracting
executable, it copies the files to the designated directory in the system
and makes the appropriate registry entries. The problem with Ccdist.exe is
that it installs Comcat.dll into the system, but fails to register it,
until the user reboots the machine. This is due to a limitation in the tool
Microsoft used to create the self-extracting Ccdist.exe, where registration
happens only on reboot.
<P>
Before a component can call any of the ICatRegister functions to register
and unregister component category information in the registry, it must
first instantiate the component category manager by calling
CoCreateInstance (CLSID_StdComponentCategoriesMgr,...). This
CoCreateInstance() call fails because although the Comcat.dll is present in
the system, it was not registered correctly.
<P>
The workaround is to either reboot after installing the DLL, or to call
"RegSvr32 ComCat.DLL" after running Ccdist.exe.
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Lanie Kurata, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprb<BR>
KBSubcategory: AXSDKControls<BR>
Additional reference words: 1.00<BR>
Keywords          : AXSDKControls kbprb kbtool<BR>
Version           : 1.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
