

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Getting IHlinkFrame from Within a Hyperlink Target </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174393">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/09/26">
<META NAME="Keywords" CONTENT="AXSDKMisc">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  In an example in the Hyperlinking section of the documentation, the Internet Client SDK indicates that an Active Document application can retrieve the IHlinkFrame interface from its container by calling QueryInterface on the container's IOleInPlace...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV9,QBRJ,QA55,QBFY,QA56,QBBS,QAR4,QAY2,QAVZ,QAW6,QALW,QAPF,QDMW,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Getting IHlinkFrame from Within a Hyperlink Target</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174393</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ActiveX SDK, version 1.0
<LI>Internet Client SDK, versions 4.0, 4.01
<LI>Microsoft Internet Explorer (Programming), versions 3.0, 3.01, 3.02,
   4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In an example in the Hyperlinking section of the documentation, the
Internet Client SDK indicates that an Active Document application can
retrieve the IHlinkFrame interface from its container by calling
QueryInterface on the container's IOleInPlaceFrame object and asking for
IID_IHlinkFrame.
<P>
For Internet Explorer (IE), this will fail. The correct way to retrieve
IHlinkFrame is through the IServiceProvider interface.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Here is sample code that demonstrates the correct method for retrieving
Internet Explorer's IHlinkFrame interface:
<P>
<PRE>   IHlinkFramePtr pHLFrame;
   IOleClientSitePtr pCS = m_lpClientSite;
   IServiceProviderPtr pSP = pCS;
   pSP-&gt;QueryService(SID_SHlinkFrame, IID_IHlinkFrame,
      (void**)&amp;pHLFrame);

</PRE>In an MFC Active Document server, the IOleClientSite interface can be
retrieved from within the document class using the m_lpClientSite protected
member of COleServerDoc.
<P>
<P><h2>REFERENCES</h2>
 
<P>
This sample uses Visual C++ 5.0 COM-support syntax. Please refer to the
Visual C++ 5.0 documentation for discussion on these smart pointers:
<P>
Visual C++ Books Online: Visual C++; Visual C++ Programmer's Guide; Adding
Program Functionality; Overviews; Compiler COM Support: Overview
<P>
 
<PRE>Keywords          : AXSDKMisc
Technology        : kbInetDev
Version           : WINDOWS:1.0,3.0,3.01,3.02,4.0,4.01
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
