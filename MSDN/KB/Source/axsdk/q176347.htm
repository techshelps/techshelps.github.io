

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: IE Can't Open Registered Helper App for URL with Spaces </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176347">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1997/11/05">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  Attempting to invoke a helper application via an HTML link or Internet Explorer address bar with a URL of the form  telnet://some%20URL%20encoded%20string  results in the following error message from Internet Explorer 4.0:     Internet Explorer can...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QATQ,QAJH,QDOT,QBVV,QBFY,QBDM,QAB4,QBIC,QBW5,QDNP,QAE2,QA8T,QA8S,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: IE Can't Open Registered Helper App for URL with Spaces</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176347</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, versions 4.0, 4.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to invoke a helper application via an HTML link or Internet
Explorer address bar with a URL of the form
"telnet://some%20URL%20encoded%20string" results in the following error
message from Internet Explorer 4.0:
<P>
<PRE>   Internet Explorer cannot open the helper application for
      "telnet://some url encoded string/".
   The protocol specified in this address is not valid. Make sure the
      address is correct, and try again.

</PRE><h2>CAUSE</h2>
 
<P>
URLs with embedded spaces, whether they have been URL encoded to %20 or
not, are automatically converted to a form that prevents Internet Explorer
4.0 from correctly locating the registered helper application.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Developers interested in registering their program as the helper
application for a new URL protocol must create a Pluggable Protocol Handler
if they need to support spaces in the URLs their application invokes.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This bug is related to the documentation in the Internet Client SDK
(InetSDK) under the following topic:
<P>
<PRE>   Internet Client SDK: Internet Tools &amp; Technologies; Monikers, URLs,
   Security Zones, and Pluggable Protocols; Overview; Appendix B:
   Registering an Application to a URL Protocol

</PRE>As an example, this section illustrates the technique of registering an
application for a protocol. The documentation shows how to register
Notepad.exe as the handler for URLs of the form "note:c:\myfile.txt"
<P>
First of all, Notepad does not work correctly in this situation, as might
be expected after reading this appendix in the InetSDK. When Internet
Explorer 4.0 processes "note:c:\myfile.txt," it executes Notepad and passes
the entire URL to it. Because Notepad does not understand URLs such as
"note:c:\myfile.txt," it does not open the c:\myfile.txt file as expected.
<P>
The "telnet:" protocol is an example of an application (TELNET) registered
in a similar manner by Internet Explorer 4.0 when it is installed. TELNET
works as expected because the registered shell command under
HKEY_CLASSES_ROOT\telnet\shell\open\command points to a routine in Url.dll
that strips off the "telnet://" part and invokes Telnet.exe with the rest
of the URL.
<P>
Second, as this article describes, if a URL contains spaces when it is
invoked, "note:c:\program files\my file name with spaces.txt" for example,
Internet Explorer fails to execute Notepad at all. An error message similar
to the one listed
under the SYMPTOMS section earlier appears.
<P>
Because spaces are invalid characters in correct URLs, the proper form of
the above example would be "note:c:\program%20files\my%20file%name."
Unfortunately, this example does not work correctly either, as Internet
Explorer pre- converts the %20's back to spaces before passing the string
on to the shell to execute.
<P>
For custom protocols such as "note:" that must support spaces in the URL,
there is an alternative. The "Monikers, URLs, Security Zones, and Pluggable
Protocols" documentation in the InetSDK describes a more complete method
for handling custom protocols. Following the directions therein related to
creating a "Pluggable Protocol Handler" would allow any application to
correctly handle any URL form. Please refer to this documentation for more
information.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Internet Client SDK: Internet Tools &amp; Technologies; Monikers, URLs,
Security Zones, and Pluggable Protocols; Overview; Appendix B: Registering
an Application to a URL Protocol
<P>
 
<PRE>Keywords          : kberrmsg
Technology        : kbInetDev internet
Version           : WINDOWS:4.0,4.01
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
