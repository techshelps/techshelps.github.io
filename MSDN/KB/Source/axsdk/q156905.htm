

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE:How To Use IAuthenticate to Bind to a Secured HTML Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156905">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1996/10/02">
<META NAME="Keywords" CONTENT="AXSDKUrlMon kbdsi">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  The Progress sample included with the ActiveX Internet Client SDK demonstrates how to use a URL moniker to asynchronously bind to data from a remote site on the Internet or an intranet. The sample this article describes, Progress.exe, enhances the ...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QAPN,QAGI,QAVZ,QAUD,QAY2,QBWA,QAK7,QAW6,QBBS,QBBI,QAWK,QAI5,QDOT,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE:How To Use IAuthenticate to Bind to a Secured HTML Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156905</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ActiveX SDK, version 1.0
<LI>Internet Client SDK, version 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Progress sample included with the ActiveX Internet Client SDK
demonstrates how to use a URL moniker to asynchronously bind to data from a
remote site on the Internet or an intranet. The sample this article
describes, Progress.exe, enhances the Progress sample that comes with the
ActiveX Internet Client SDK by handling the case where authentication is
required to access secured data.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Progress.exe">Progress.exe</A> <I>(size: 41761 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services


</PRE>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../AXSDK/Q156904.htm">Q156904</A></B>
   TITLE     : FIX: Returning User Name and Password from IAuthenticate
               Fails

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Handling authentication requests from a URL moniker requires that the URL
moniker host implement a bind status callback object which exposes both the
IBindStatusCallback interface and the IAuthenticate interface. The sample
uses multiple inheritance to expose these interfaces on the same object.
<P>
The IAuthenticate interface consists of a single method, Authenticate. The
sample implements IAuthenticate::Authenticate as follows:
<P>
STDMETHODIMP CBindStatusCallback::Authenticate(
<PRE>    HWND __RPC_FAR *phwnd,
    LPWSTR __RPC_FAR *pszUsername,
    LPWSTR __RPC_FAR *pszPassword)
</PRE>{
<PRE>   if (!phwnd || !pszUsername || !pszPassword)
   {
      return E_INVALIDARG;
   }

   // The progress sample's HWND is stored in g_hwndDlg
   *phwnd = g_hwndDlg;
   *pszUsername = NULL;
   *pszPassword = NULL;
   return S_OK;
</PRE>}
<P>
When the URL moniker attempts to bind to the object specified in the call
to CreateURLMoniker, it determines whether or not the object is secured. If
the object is secured, the URL moniker queries the bind status callback
object for IAuthenticate. The URL moniker queries for IAuthenticate through
the IBindStatusCallback interface pointer registered with the bind context
used in the binding operation.
<P>
The implementation of Authenticate above returns a valid window handle. The
URL moniker uses this handle as the parent window handle in a call to the
InternetErrorDlg WININET API. InternetErrorDlg presents the user with a
dialog box requesting a user name and password required to access the
secured data.
<P>
To demonstrate how a URL moniker requests authentication information from
its host, perform the following steps:

<OL><P><LI>Launch the Internet Information Server (IIS) Service Manager utility.
</OL>2. Double-click on the WWW Service to display its property sheet.
3. Click the Service tab.
4. Under Password Authentication, uncheck both "Allow Anonymous" and
<PRE>   "Windows NT Challenge/Response" and check "Basic (Clear Text)."
</PRE></OL>5. Dismiss the property sheet by clicking OK.
6. Build the revised Progress sample.
7. Run the revised Progress sample and specify as an argument the HTTP
<PRE>   address of an HTML page on the Web Server configured in steps 1 through
   5.
</PRE>8. Click the Go button to commence the download.
9. A network password dialog box appears. Enter the user name and password
<PRE>   of an account that has access to the machine running the IIS.

</PRE>The HTML page specified in step 7 is displayed in the sample dialog box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: URLMON IBSC<BR>
Keywords          : AXSDKUrlMon kbdsi<BR>
Version           : 1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
