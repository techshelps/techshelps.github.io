

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FILE: Enumerating and Displaying Wininet Cache </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172607">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/08/12">
<META NAME="Keywords" CONTENT="AXSDKWinInet">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  The CACHEVW sample demonstrates how to enumerate and display Wininet cache entries. The following Wininet caching APIs are used in the sample:   - FindFirstUrlEntry  - FindNextUrlCacheEntry  - FindCloseUrlCache  - GetCacheEntryInfo  - RetrieveUrlCa...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBF0,QAY2,QAVZ,QBE7,QBE6,QALG,QAPF,QBV9,QBIC,QACJ,QAJ4,QAUD,QABN,QAJH,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Enumerating and Displaying Wininet Cache</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172607</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, versions 4.0, 4.01
<LI>Microsoft ActiveX SDK, version 1.0
<LI>Internet Explorer (Programming), versions 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The CACHEVW sample demonstrates how to enumerate and display Wininet cache
entries. The following Wininet caching APIs are used in the sample:

<UL><LI>FindFirstUrlEntry
<LI>FindNextUrlCacheEntry
<LI>FindCloseUrlCache
<LI>GetCacheEntryInfo
<LI>RetrieveUrlCacheEntryStream
<LI>ReadUrlCacheEntryStream
<LI>UnlockUrlCachEntryStream
<P>
</UL>The following self-extracting file is available for download from the
Microsoft Software Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Cachevw.exe">Cachevw.exe</A> <I>(size: 20392 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The CACHEVW sample contains three files: Cachevw.cpp, Cachevw.rc, and
Makefile. If you have Win32 SDK or Visual C++ installed, you can run the
nmake utility to compile the sample.
<P>
FindNextUrlCacheEntry in Internet Explorer 3.x version of Wininet.dll has a
bug where an entry is skipped if the initial buffer supplied is too small.
When the function gets to an entry that is larger than the buffer supplied,
it returns the buffer size required and the error
ERROR_INSUFFICIENT_BUFFER. On the next call to FindNextUrlCacheEntry, it
goes to the next cache entry instead of the one that returned
ERROR_INSUFFICIENT_BUFFER. To work around the bug, use an initial buffer of
at least 2048 bytes in FindNextURLCacheEntry. This bug will be fixed in the
Internet Explorer 4.0 Wininet.dll. If the application is designed to run
only with the Internet Explorer 4.0 version of Wininet.dll, it's better to
dynamically allocate the buffer. The application could use a much smaller
initial buffer--512 bytes, for example--to enumerate the cache. This is
usually sufficient for most of cache entries.
<P>
In the Internet Explorer 3.x version of Wininet, the size cache entry info
structure is limited to 2,048 bytes, and Wininet.h for Internet Explorer
3.0x has the following define:
<P>
<PRE>   define MAX_CACHE_ENTRY_INFO_SIZE 4096

</PRE>In Internet Explorer 4.0 there will be no size limit to the cache entry
info structure and
the MAX_CACHE_ENTRY_INFO_SIZE flag will also be removed from the Internet
Explorer 4.0
Wininet.h file. Therefore application developers may need to define
MAX_CACHE_ENTRY_INFO value themselves when porting their Wininet
application from Internet Explorer 3.x to Internet Explorer 4.0 and using
the Internet Explorer 4.0 version Wininet.h.
<P>
 
<PRE>Keywords          : AXSDKWinInet
Technology        : kbInetDev
Version           : WINDOWS:1.0,4.0,4.01
Platform          : WINDOWS
Issue type        : kbfile
Solution Type     : kbsample</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
