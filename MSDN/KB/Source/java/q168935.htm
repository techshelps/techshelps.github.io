

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Frequently Ask Questions for Java/COM/DCOM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168935">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/05/22">
<META NAME="Keywords" CONTENT="kbcode kberrmsg CmdLnUtils JCOM JVM VJMisc WizardIss kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  This article covers some of the Frequently Asked Questions (FAQ) about Java/COM/DCOM.  For other Java related FAQs search the Web at http://support.microsoft.com/support/ for 'JAVA' and 'FAQ'.  MORE INFORMATION  Q. 1. I am trying to use an ActiveX ...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXF,QAPN,QAB4,QAB5,QAW6,QAAP,QAHV,QDK6,QA7O,QAOE,QAMN,QDOP,QA2K,QAY2,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Frequently Ask Questions for Java/COM/DCOM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168935</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Virtual Machine for Java
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article covers some of the Frequently Asked Questions (FAQ) about
Java/COM/DCOM.
<P>
For other Java related FAQs search the Web at
<B><A HREF="http://support.microsoft.com/support/">http://support.microsoft.com/support/</A></B> for 'JAVA' and 'FAQ'.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Q. 1. I am trying to use an ActiveX automation object written in Java (the
COMCallingJava sample) from Visual Basic but I keep getting "Out of Memory"
errors.
<P>
A. This is normally caused by the Operating System not being able to find
the Java class file that implements the ActiveX automation server. The
class file that implements the Server must be copied to the java classpath
(for instance: \windows\java\lib) for OLE object creation to work properly
for Java class files. A common example of this is the COMCallingJava sample
application supplied with Visual J++. It will work fine when the sample is
first built because the CEuclid.class is in the local directory (which the
Developer Studio adds to the CLASSPATH before running Internet Explorer).
Trying to run the VBDriver Visual Basic sample code supplied in the
VBDriver project subdirectory will then fail with the "Out of Memory"
error. This can be remedied by copying CEuclid.class to
the \windows\java\lib directory. You can also set the output directory in
the project build options so that the class file is automatically built in
the appropriate classpath directory. This information is also documented in
the following Knowledge Base article: <B><A HREF="../java/Q163720.htm">Q163720</A></B>: Getting Out Of Memory Error
with COMCallingJava.
<P>
Q. 2. Why does Java misinterpret a Boolean value that is returned by a COM
object?
<P>
A. This is a bug, which has been fixed with the latest Microsoft Virtual
Machine for Java. Please follow the link to <B><A HREF="http://www.microsoft.com/java">http://www.microsoft.com/java</A></B>
to download the latest Microsoft Virtual Machine for Java. This version of
the Virtual Machine for Java requires Internet Explorer 3.01. This
information is also documented in the Microsoft KnowledgeBase article:
<B><A HREF="../java/Q162966.htm">Q162966</A></B>: COM Object Returns Incorrect Value for Bool.
<P>
Q. 3. Why do I get a "java.lang.ClassFormatError", when I call Automation
methods from VJ++ that takes parameters of Pointer type BSTR*, long*?
<P>
A. For information on this refer to the Microsoft Knowledge Base article
<B><A HREF="../java/Q165550.htm">Q165550</A></B>, BUG: JavaTLB Generates Invalid Classes for MFC Server.
<P>
Q. 4. Why do I get an
"exception:java.lang.ClassCastException:xl5en32/_ExcelApplication" error,
when creating a new _ExcelApplication class and type-casting it to the
Application interface?
<P>
A. For information on this refer to the Microsoft Knowledge Base article
<B><A HREF="../java/Q169806.htm">Q169806</A></B>, PRB: ClassCastException Error When Using Excel Object in Java.
<P>
Q. 5. Do Visual J++ applets or applications support ActiveX control
containment?
<P>
A. Currently, the Microsoft Java class libraries do not support the
containment of ActiveX GUI controls. You can't place an ActiveX control
that has a user interface or that sources or sinks events directly onto an
applet without implementing all of the ActiveX control containment and
eventing interfaces yourself. To be clear, you can use ActiveX automation
servers from Java and you can write ActiveX automation servers in Java
utilizing the Microsoft Java Virtual Machine's ability to expose Java
classes as ActiveX objects. You can also have ActiveX controls and Java
applets on the same Web page and have them interact (see the OLEControls
sample in Visual J++).
<P>
Q. 6. How do I use the COMCallingJava sample as a DCOM Server?
<P>
A. First you should build the sample and run it as a conventional
(InProcess) automation server. Do this by following the instructions
outlined in the readme.html that is installed with the sample. More
information on how to use this sample via DCOM, can be found in the
KnowledgeBase article: <B><A HREF="../java/Q162164.htm">Q162164</A></B>: Using Java Servers and DCOM.
<P>
Q. 7. When I try to use JavaReg with the /surrogate switch in order to use
my Automation Server written in Java as a DCOM server, the Java console
pops up and closes when run on a remote machine and my client application
hangs?
<P>
A. There are various problems that you may experience when you try to use
an Automation Server written in Java as a DCOM server. These can include
hanging, timeouts, out of memory errors, interface not found errors, and
other errors. These errors are generally caused by not registering the Java
COM object properly on both the client and DCOM server machines. There are
several known bugs with the javareg DCOM surrogate and the DCOM
configuration utility DCOMCNFG that make it difficult to set up Java DCOM
servers and clients. This is a bug and you can get more information
regarding this and how to setup a Java Automation Server as a DCOM Server
in the following Knowledge Base article: <B><A HREF="../java/Q162164.htm">Q162164</A></B>: Using Java Servers and
DCOM.
<P>
Q. 8. Why do I get an exception when I try and use an OLE Control (a.k.a.
OCX) in my Java code?
<P>
A. This can be caused by trying to "new" an OLE Control (OCX) from within
your Java code and then calling one of the methods of the OLE Control. The
Microsoft Java class libraries and Virtual Machine do not currently support
the containment of OLE Controls directly in Java applets. An OLE Control
requires that numerous interfaces and methods be supported in the
"containing" application. This support is currently not implemented.
Therefore, your OLE Control is not fully created and returns an OLE error
when any method is called. This error gets expressed in Java as a thrown
exception. ActiveX automation servers can be used from within your Java
code and it is possible to write an OLE Control so that it can be created
as a simple automation server that does not require full container support.
More information on this can be found in the Microsoft Knowledge Base
article: <B><A HREF="../VISUALC/Q146120.htm">Q146120</A></B> - How to Use an OLE Control as an Automation Server.
<P>
Q. 9. Why do I get "Failed to Create Object" error message, when trying to
instantiate a COM object written in Java?
<P>
A. The following is a checklist that provides some of the common causes for
this error. Make sure:
<P>
<PRE>    1. The Java class is in the classpath.
    2. Your Java method is declared 'public'.
    3. You need to register the class file (using javareg.exe).
    4. Install the latest Java VM from
       <B><A HREF="http://www.microsoft.com/java">http://www.microsoft.com/java</A></B> if you are attempting to
       use CreateObject().
    5. Follow the steps in the Visual J++ sample named COMCALLINGJAVA.

</PRE>Q. 10. Why don't I need to use IDL anymore when creating a Java com object
that is used through IDispatch?
<P>
A. For information on this refer to the Microsoft Knowledge Base article
<B><A HREF="../java/Q172202.htm">Q172202</A></B>, "INFO: Implementing Java Automation Objects using AutoIDispatch."
<P>
Q. 11. Is there a way to disable this Auto IDispatch mechanism of the
Virtual Machine?
<P>
A. You can implement the system interface com.ms.com.NoAutoScripting to
disable the Auto IDispatch for all instances of a class.
<P>
Q. 12. I get ComFailException:&lt;80020005h&gt;Type Mismatch error, when trying
to use the Navigate method of the IWebBrowserApp interface? How do I invoke
Internet Explorer from Java and navigate to a URL?
<P>
A. The following code snippet illustrates creating a Java Object based on
the Microsoft Internet Explorer and calling the Navigate method:
<P>
<PRE>    1. Create a default Java Applet or an Application.
    2. Run JavaTLB on Microsoft Internet Controls.

</PRE>import com.ms.com.*;
import shdocvw.*;
public class Navigate
{
<PRE>   IWebBrowserApp testBrowser = null;

   public static void main( String args[] )
   {
      IWebBrowserApp testBrowser = (IWebBrowserApp)new InternetExplorer();
      testBrowser.getApplication();
      testBrowser.putVisible(true);
      Dispatch.call(testBrowser, "Navigate", "<B><A HREF="http://www.microsoft.com">http://www.microsoft.com</A></B>");
   }
</PRE>}
<P>
The Dispatch.call method is documented in the Microsoft SDK for Java
Documentation, which can be found at
<B><A HREF="http://www.microsoft.com/java/sdk/x/exten025.htm">http://www.microsoft.com/java/sdk/x/exten025.htm.</A></B>
<P>
Q. 13. I am able to automate Excel 7.0 from Java, but I am finding the
classes and interfaces to be quite different in Excel 8. How do I automate
Excel 8.0 from Java?
<P>
A. For information on this refer to the Microsoft Knowledge Base article
<B><A HREF="../java/Q169796.htm">Q169796</A></B>, HOWTO: Automate Excel from Java.
<P>
Q. 14. When I use JavaTLB to generate classes from some COM object
libraries, I get an error J5008.
<PRE>    Should I be concerned?

</PRE>A. Often, the cause of this warning is that the method uses a type that is
not supported in Java.  All methods that produce a J5008 warning are
omitted from the class file. Note that JavaTLB has been replaced by JavaCOM
in the SDK for Java 2.0, preview version.
<P>
Q.15. I get a 'java.lang.NoClassDefFoundError: com/ms/com/LicenseMgr' error
when I run an applet generated by the Database Wizard for Java?
<P>
A. When an applet is run in Internet Explorer and outside of Developer
Studio, the applet is not trusted and does not have access to ILicenseMgr.
This problem is by design since only trusted applets should have access to
the ILicenseMgr. The ILicenseMgr allows the creation of COM objects on the
client. To fix the problem, create a CAB file that contains the classes of
the applet and digitally sign the CAB with the CodeSign kit. For more
information on Cab and Sign technology, look in the 'Cab&amp;Sign' directory on
the Visual J++ CD-ROM. For the latest info on CAB technology please refer
to '<B><A HREF="http://www.microsoft.com/workshop/prog/cab'">http://www.microsoft.com/workshop/prog/cab'.</A></B>
<P>
Q. 16. Why does Visual Basic crash when calling a Java Object that has a
method that returns a Boolean value?
<P>
A. This is a bug with the JavaTLB mapping VT_BOOL to a 4-byte value for
vtable mappings. To work around the problem change the return type of the
Java function to "short" in the IDL/ODL files with -1 representing TRUE and
0 representing FALSE. This problem has been fixed for JCOM, where it maps
VT_B OL to a 2-byte value. You can get JCOM, by installing the SDK for Java
2.0 Preview release from <B><A HREF="http://www.microsoft.com/java">http://www.microsoft.com/java.</A></B> Note that JavaTLB
has been replaced by JCOM in the SDK for Java 2.0 preview version.
<P>
Q. 17. When I run a Java Application that calls a COM object like an ATL
Server, I get a "NoClassDeffoundError" on the COM object. The error occurs
on the line where I create a new COM object in the Java Class?
<P>
A. One reason why you may get this error could be related to missing
parameter attributes for the methods in the ATL servers IDL file. For
Example if you have a method like the one below:
<P>
<PRE>   [id(1), helpstring("method GetString")] HRESULT GetString(BSTR* mystr);

</PRE>JavaTLB executes fine on this TLB. However when you execute your Java
Application that calls this COM object, for example, ISomeInterface m_intf
= (ISomeInterface) new CAtlObj, it fails at this line with a
"java.lang.NoClassDeffoundError". To fix the problem, change the IDL method
to include the [out] attribute. For Example the method looks like the
following:
<P>
<PRE>   [id(1), helpstring("method GetString")] HRESULT GetString([out]BSTR*
   strGUID);

</PRE>So check your methods in the IDL file so that they have the right
attributes such as [in],[out],[retval] and so on. Once you've modified the
IDL file, rebuild your ATL server, and rerun JavaTLB on the ATL Servers
Type Library so that the changes gets reflected.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A HREF="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Rafael M. Munoz, Microsoft Corporation
 
<PRE>Keywords          : kbcode kberrmsg CmdLnUtils JCOM JVM VJMisc WizardIss kbfaq
Technology        : kbInetDev kbole
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
