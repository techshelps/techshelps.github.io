

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Automate Excel from Java </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169796">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/06/09">
<META NAME="Keywords" CONTENT="kbcode kbinterop kbprg JCOM">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  This article illustrates how to call a COM object like Excel from Java. It provides code samples that show how you can make an Excel application visible and open an existing Excel file. There are two code samples. One illustrates how to invoke Exce...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QBXF,QAG1,QAY2,QDO5,QAPN,QAPF,QAJH,QDNM,QA7H,QA6E,QAW6,QANG,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Automate Excel from Java</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169796</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Virtual Machine for Java
<LI>Visual J++ 1.0, 1.1,
<LI>SDK for Java 2.0
<LI>Microsoft Win32 Virtual Machine for Java
<LI>Internet Explorer 3.x,4.0.
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article illustrates how to call a COM object like Excel from Java. It
provides code samples that show how you can make an Excel application
visible and open an existing Excel file. There are two code samples. One
illustrates how to invoke Excel 7.0 from Java and the other shows how to
invoke Excel 8.0 from Java. You will find the classes and interfaces to be
quite different in Excel 8.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Before using code samples 1 and 2, follow these steps below:

<OL><P><LI>Use the Java Applet Wizard to create a default Applet or Application.

<P><LI>Run JAVATLB or JACTIVEX(utility similar to JAVATLB and supported by the
   SDK for Java 2.0)on the Microsoft Excel7.0 Object Library if you are
   using Excel 7.0 or the Microsoft Excel 8.0 Object Library if you are
   using Excel 8.0. This will create Java descriptions of the Excel Object.
<P>
   NOTE: If you are using JACTIVEX, then you will need to build this sample
   with the JVC.EXE that ships with the SDK2.0 for Java. You can download
   the SDK for Java 2.0 from <B><A HREF="http://www.microsoft.com/java/">http://www.microsoft.com/java/.</A></B>

<P><LI>Use the import statement to import the classes of the Excel Object
   Library into your Java project.

<P><LI>Insert either one of the two code snippets in your Java Project to
   automate Excel from Java.
<P>
</OL><h3>Code Sample 1</h3>
 
<P>
<PRE>   import xl5en32.*;
   import com.ms.com.*;
   public void TestExcel()
   {
      _Global gbl = (_Global) new _ExcelApplication();
      Variant param = gbl.Application();
      Application app = (Application) param.getDispatch();
      param.putInt(xl5en32.Constants.xlVisible);
      app.putVisible(param);

      Variant vtemp = new Variant();
      vtemp.noParam();

      Variant vtWorkbooks = Dispatch.get(gbl,"Workbooks");
      Workbooks wbs = (Workbooks)vtWorkbooks.getDispatch();

      Variant vtName = new Variant();
      VtName.putStringRef("C:\\book1.xls");

      Variant vtEmpty = new Variant();
      vtEmpty.noParam();
      wbs.Open(vtName,vtEmpty,vtEmpty,vtEmpty,vtEmpty,vtEmpty,vtEmpty,
               vtEmpty,vtEmpty,vtEmpty,vtEmpty,vtEmpty,vtEmpty);
   }

</PRE></OL><h3>Code Sample 2</h3>
 
<P>
<PRE>   import excel8.*;
   import com.ms.com.*;

   _Global globXL=null;
   _Application appXL=null;
   Workbooks books=null;
   _Workbook book = null;

   try{
      globXL = (_Global)new Global();
      appXL = (_Application)globXL.getApplication();
      appXL.putVisible(0,true);
      books = (Workbooks)appXL.getWorkbooks();

      Variant vTemp = new Variant();
      vTemp.putString("c:\\book1.xls");

      Variant vOptional = new Variant();
      vOptional.noParam();
      book =
</PRE>(_Workbook)books.Open("c:\\book1.xls",vOptional,vOptional,vOptional,vOption
al,vOptional,vOptional,vOptional,vOptional,vOptional,vOptional,vOptional,vO
ptional,0);
<P>
<PRE>      }
      catch(ComFailException e)
      {
         System.out.println(e.getMessage());
      }

</PRE>The above code will make the Excel application visible, and it will open up
an existing Excel file.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A HREF="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>

</PRE> 
<PRE>Keywords          : kbcode kbinterop kbprg JCOM
Technology        : kbInetDev
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
