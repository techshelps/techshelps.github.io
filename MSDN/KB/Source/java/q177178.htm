

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Unable to Sign the Cabfile When Running Signcode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177178">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/11/21">
<META NAME="Keywords" CONTENT="kberrmsg JCab">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  When you run Signcode.exe on your CAB file, one or more of the following errors occur:   - Unable to sign the program          . (80004005)  - Unable to sign the program          . (80030070)  - Unable to sign the program          . (80070005)  - U...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIY,QA40,QDOP,QAH4,QBVV,QAHE,QAYZ,QAKR,QAAP,QAB4,QBXL,QBW5,QAK7,QA2O,QAWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Unable to Sign the Cabfile When Running Signcode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177178</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>SDK for Java, versions 1.0, 1.5, 1.51
   on the following platforms: NT, Win95, x86
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Signcode.exe on your CAB file, one or more of the following
errors occur:

<UL><LI>Unable to sign the program &lt;cabfile&gt;. (80004005)
<LI>Unable to sign the program &lt;cabfile&gt;. (80030070)
<LI>Unable to sign the program &lt;cabfile&gt;. (80070005)
<LI>Unable to sign the program &lt;cabfile&gt;. (80070057)
<P>
</UL><h2>CAUSE</h2>
 
<P>
Signcode.exe could not sign the CAB file for the reason indicated by the
error number. The CAB file may not have been created with -s 6144 parameter
or it is either read-only or corrupt.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Unable to sign the program &lt;cabfile&gt;. (80004005)</h3>
 
<P>
This error appears because you did not reserve space in your CAB file. Re-
create the CAB file using the -s 6144 option to Cabarc.exe. This space must
be reserved in the CAB file to allow room for the digital signature. It is
not necessary to use the -s switch with the signing tools included with the
SDK for Java 2.0 Beta2 or newer. The Signcode.exe utility now creates the
necessary space for the certificate at the time the CAB is signed.
<P>
<P><h3>Unable to sign the program &lt;cabfile&gt;. (80030070)</h3>
 
<P>
This error occurs because you did not reserve enough space in your CAB
file. Re-create the CAB file using the -s 6144 option to Cabarc.exe. It is
not necessary to use the -s switch with the signing tools included with the
SDK for Java 2.0 Beta2 or newer. The Signcode.exe utility now creates the
necessary space for the certificate at the time the CAB is signed.
<P>
<P><h3>Unable to sign the program &lt;cabfile&gt;. (80070005)</h3>
 
<P>
This error appears because your cabfile is marked read-only.
<P>
<P><h3>Unable to sign the program &lt;cabfile&gt;. (80070057)</h3>
 
<P>
This error occurs because your cabfile is corrupt.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use the -s option for Cabarc.exe, the -s 6144 option reserves
unnecessary space in most situations. With the "test" certificate, you can
typically get by with 1K of reserved space in the cab. A good estimate of
the space required is slightly larger than the size of the .spc file you
are signing with. Also note, it is possible that the certificate will
require more than 6144 bytes.
<P>
<P><h3>Example</h3>
 
<P>
C:&gt;CABARC -s 6144 N mycab *.class
<P>
NOTE: It is not necessary to use the -s switch with the signing tools
included with the SDK for Java 2.0 Beta2 or newer. The Signcode.exe utility
now creates the necessary space for the certificate at the time the CAB is
signed.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information on Frequently Asked Questions for CAB files,
please refer to the following Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../java/Q168941.htm">Q168941</A></B>
   TITLE     : INFO: Frequently Asked Questions for CAB Files

</PRE>For more information on Cab and Sign technology, look in the Cab&amp;Sign
folder on the Visual J++ CD-ROM. The Visual J++ CD-ROM also includes a
sample called CabAndSign that gives step-by-step instructions on how to
create Cab files and Test Certificates. For the latest info on CAB
technology, refer to <B><A HREF="http://www.microsoft.com/workshop/prog/cab/">http://www.microsoft.com/workshop/prog/cab/.</A></B>
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A HREF="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Carl
Frisk, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: CABARC, Cab and Sign technology, internet
<P>

Keywords          : kberrmsg JCab<BR>
Technology        : kbInetDev<BR>
Version           : WINDOWS:1.0,1.5,1.51<BR>
Platform          : Win95 winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
