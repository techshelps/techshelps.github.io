

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Serial Communications Speeds in Windows 3.1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82642 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/03/31">
<META NAME="Keywords" CONTENT="kbusage kbdisplay">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Microsoft Windows version 3.1 allows applications to select bit rates as high as 57.6 kilobits per second (Kbps). However, how reliably you can transmit and receive data at high speeds depends on many variables, which are discussed below. With Wind...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAJH,QAMR,QAU3,QDJ9,QBWQ,QDIR,QALA,QBWS,QAH6,QAJ5,QAAP,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Serial Communications Speeds in Windows 3.1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82642 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Windows version 3.1 allows applications to select bit rates
as high as 57.6 kilobits per second (Kbps). However, how reliably you can
transmit and receive data at high speeds depends on many variables, which
are discussed below. With Windows 3.1 in a reasonably busy system, a 19.2
Kbps XModem transfer can run well on a 20 megahertz 80386 machine.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Maximum Bits-Per-Second (BPS) Rate for Windows Applications</h3>
 
<P>
Factors affecting top BPS rate in Windows applications include:

<UL><LI>CPU Speed: Faster CPUs allow faster data throughput with fewer
   errors. This is because they allow the communication driver to
   service character interrupts faster (preventing UART overflow), and
   allow applications to handle transfer protocols better.
<P>
   If you are experiencing slow serial performance or are losing
   characters on an 80286 based PC, do the following to correct the
   problem:
<P>
   1. Reduce the number of MS-DOS drivers and terminate-and-stay-
<P><PRE>      resident (TSR) programs.
</PRE><P>
   2. Do not load MS-DOS 5.0 into upper memory.
<P>
   3. Add the following line to the SYSTEM.INI [standard] section:
<P>
<PRE>         FasterModeSwitch=1.

   For more information on FasterModeSwitch and other SYSTEM.INI file
   switches, see the SYSINI.WRI file in your Windows directory.

</PRE><LI>Transfer Protocols: Data transmission protocols (for example,
   Xmodem, Ymodem, Zmodem, and so on) vary greatly in robustness in a
   multitasking environment. Some are designed to be very fast, with
   little error checking, while others trade throughput for error
   correction. Usually, XModem and ZModem work well with Windows, even
   at high speeds.

<LI>Serial Port Hardware: Newer serial ports use the 16550 UART, which
   contains a buffer to reduce overhead and prevent overflow. See
   additional discussion on this below.

<LI>System Overhead: The more applications, TSRs, and device drivers
   that are running, the busier the operating system is. This reduces
   overall execution time for everything in the system. If you have
   many programs and devices active while trying to transmit data at
   high speeds, you are likely to encounter reduced throughput and
   transmission errors.

<LI>Application Quality: Like most other software, not all serial
   communications applications are created equal. These vary in
   quality and performance, so comparison shopping is valuable before
   purchasing. In general, choose a program that is well-tested and
   supported by an experienced vendor.
<P>
</UL>Maximum Possible Bit Rate for MS-DOS Apps Running in Windows
 
<P>
MS-DOS serial communications applications are designed to run in a non-
multitasking environment, and make assumptions about the operating
system and devices that are not always true in a multitasking
operating system. These applications may allow you to select speeds as
high as 115 Kbps and beyond. While these speeds may work very well in
MS-DOS alone, there will most likely be reduced data throughput when
running these applications in a multitasking operating system such as
Windows or OS/2.
<P>
The guidelines listed above for Windows serial communications
applications also apply to MS-DOS based applications. However, the
following guidelines are important for MS-DOS applications running
within Windows enhanced mode:

<UL><LI>Full-screen vs. Windowed vs. Minimized: MS-DOS applications run
   best in full-screen mode. They receive their foreground priority
   and avoid the overhead of display virtualization. Although MS-DOS
   applications running in a foreground window receive their
   foreground execution priority, the overhead of updating the window
   can seriously reduce application performance. If you wish to run an
   MS-DOS communications application in the background during a data
   transfer, run it minimized as an icon rather than in a window.

<LI>Foreground &amp; Background Execution Priority: Windows allocates
   execution time for MS-DOS applications according to foreground and
   background priorities that are in an application's program
   information file (PIF). If the application is not getting the
   time slices it needs to process incoming data, it will encounter
   errors during data transfer. Increase the MS-DOS application's
   background execution priority in the PIF to prevent errors
   when receiving data in the background. And of course, make sure
   that the "Background" execution is marked in the PIF.

<LI>"Lock Application Memory:" In order to allow more MS-DOS
   applications to run simultaneously, Windows 3.1 386 enhanced mode
   swaps application memory to disk. However, this can slow the
   execution of the MS-DOS application, and significantly reduce
   communications performance. Disable this swapping of application
   memory in the MS-DOS communications program's .PIF by marking the
   "Lock Application Memory" check box in the Advanced Options dialog
   box of the PIF Editor. Note that this PIF setting only applies if
   you have a permanent swap file and 32-bit disk access is enabled.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbdisplay<BR>
KBSubcategory: win31 wincomm<BR>
Additional reference words: 3.10 3.11 modem<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
