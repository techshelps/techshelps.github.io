

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows Err Msg: Invalid HIMEM.SYS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82230 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/03/29">
<META NAME="Keywords" CONTENT="kbusage kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  When you attempt to load Microsoft Windows 3.0 in standard mode or 386 enhanced mode, you may receive the following error message:     Invalid HIMEM.SYS;    Install HIMEM.SYS from your Windows Setup disks  CAUSES ======  This error message can be c...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QDJD,QBWO,QBWQ,QANE,QAB4,QACF,QAY2,QAC9,QBXS,QAGQ,QAFX,QAC1,QDKI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows Err Msg: Invalid HIMEM.SYS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82230 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to load Microsoft Windows 3.0 in standard mode or 386
enhanced mode, you may receive the following error message:
<P>
<PRE>   Invalid HIMEM.SYS;
   Install HIMEM.SYS from your Windows Setup disks

</PRE><h2>CAUSES</h2>
 
<P>
This error message can be caused by the following problems:

<UL><LI>Wrong version of HIMEM.SYS
<LI>Corrupted HIMEM.SYS
<LI>Trying to run Windows from an MS-DOS prompt inside Windows
<P>
</UL><h2>RESOLUTIONS</h2>
 
<P>
Each of these problems and their resolutions is described in detail below.
<P>
<P><h3>Wrong Version of HIMEM.SYS</h3>
 
<P>
The CONFIG.SYS file contains the line "DEVICE=drive:\path\HIMEM.SYS."
If the HIMEM.SYS being loaded is from versions of Windows prior to
Windows 3.0 or versions of MS-DOS prior to MS-DOS 5.0, these error
messages may appear.
<P>
The versions of HIMEM.SYS that you can use with Windows 3.0 are listed
below.

<UL><LI>Version 2.60
   Supplied with Windows 3.0 and 3.0a
   File Size 11,304 bytes
<P>
</UL>To restore HIMEM.SYS, use the EXPAND.EXE utility to expand the file
HIMEM.SY$ to HIMEM.SYS in the directory that is specified in the
CONFIG.SYS file.
<P>
<PRE>File            3.5-Inch Disk Set      5.25-Inch Disk Set
----            -----------------      ------------------

EXPAND.EXE      Disk 2                 Disk 2
HIMEM.SY$       Disk 5                 Disk 3

</PRE><LI>Version 2.77
   Supplied with the MS-DOS 5.0 and 5.0a Upgrades
   File Size 11,552 bytes
<P>
</UL>To restore HIMEM.SYS, use the EXPAND.EXE utility to expand the file
HIMEM.SY_ to HIMEM.SYS in the directory that is specified in the
CONFIG.SYS file.
<P>
<PRE>File            3.5-Inch Disk Set      5.25-Inch Disk Set
----            -----------------      ------------------

EXPAND.EXE      Disk 3                 Disk 6
HIMEM.SY_       Disk 1                 Disk 2

</PRE>The syntax for the EXPAND utility is "EXPAND source destination". The
following is an example:
<P>
<PRE>   C:\&gt;EXPAND A:HIMEM.SY_ C:\HIMEM.SYS

</PRE><h3>Corrupted HIMEM.SYS</h3>
 
<P>
If the HIMEM.SYS being loaded in the CONFIG.SYS file is the right version
but has been corrupted (or is otherwise invalid and not operating properly
with Windows 3.0), the aforementioned error messages may appear. Restore
the file from your Windows 3.0 or MS-DOS 5.0 Upgrade disks using the above
instructions.
<P>
<P><h3>Trying to Run Windows from an MS-DOS Prompt Inside Windows</h3>
 
<P>
If you attempt to run Windows after switching to MS-DOS from within
Windows by choosing the MS-DOS Prompt icon, the aforementioned error
messages may occur. Type "exit" (without the quotation marks) at the
MS-DOS prompt to return to Windows.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kberrmsg<BR>
KBSubcategory: win30 winmem<BR>
Additional reference words: 3.0 3.00 3.0a 3.00a<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
