

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Novell Err Msg: Invalid COMMAND.COM After Windows Exit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81604 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/03/11">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  After exiting Microsoft Windows, you may receive one of the following error messages if you are using a Novell network:     Invalid COMMAND.COM     -or-     Cannot load COMMAND, System halted  NOTE: One of these error messages may occur with a run-...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBVP,QAB4,QBXB,QA8Y,QATJ,QAFI,QBQU,QBW5,QAB9,QBV8,QBWQ,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Novell Err Msg: Invalid COMMAND.COM After Windows Exit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81604 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 2.x, 3.0, 3.0a, 3.1,
   3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After exiting Microsoft Windows, you may receive one of the following
error messages if you are using a Novell network:
<P>
<PRE>   Invalid COMMAND.COM

   -or-

   Cannot load COMMAND, System halted

</PRE>NOTE: One of these error messages may occur with a run-time version of
Windows or with MS-DOS-based applications.
<P>
<P><h2>CAUSE</h2>
 
<P>
The error occurs due to a problem with early releases of the Novell
NETX.COM network shell program.
<P>
<P><h2>STATUS</h2>
 
<P>
Novell has corrected the problem in NETX.COM version 3.26 revision A
included with Microsoft Windows 3.1.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In most cases, you can work around the problem by correctly setting
the COMSPEC environment variable in the CONFIG.SYS or AUTOEXEC.BAT
file. The following SHELL= line will load COMMAND.COM from the root
directory of drive C. If you change your SHELL= statement to point to
a new location, make sure COMMAND.COM is in the directory you are
pointing to, or you may not be able to start your system.
<P>
<PRE>   SHELL=C:\COMMAND.COM /P

</PRE>Note that COMMAND.COM is loaded from the root directory of drive C;
not from the DOS directory. Certain versions of the Novell shell
program may prevent the resident portion of COMMAND.COM from reloading
the transient portion if the COMSPEC variable is set to the DOS
directory. This causes the "Invalid COMMAND.COM" or "Cannot load
COMMAND, System halted" error message to be displayed after you exit
Windows.
<P>
If necessary, consult Novell technical support or Novell documentation
for assistance in modifying your personal login script, and/or upgrade
the Novell Shell. If you are using MS-DOS version 3.3 or earlier, you
can work around the problem by modifying the Novell NetWare COMSPEC
variable. For more detailed information on this subject, contact Novell
Product Support.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Runtime Version of Excel</h3>
 
<P>
If this error message occurs when you are running the run-time version
of Excel (with run-time Windows), configure Excel to look for
COMMAND.COM in the root directory of the boot drive (usually drive C)
or copy COMMAND.COM to the EXCEL directory. To configure Excel to
point to the root directory of the boot drive:

<OL><P><LI>From the File menu, choose Open.

<P><LI>In the Directories box, select the boot drive. For example:
<P>
<P><PRE>      [-C-]
</PRE>
<P><LI>Choose Cancel.
<P>
</OL>The default directory for Excel is now the root directory of drive C,
allowing Excel to locate COMMAND.COM.
<P>
NOTE: This message can also be caused by too little hard disk space.
This can occur when exiting Windows or an application, such as
Microsoft Excel. If you are using a permanent swap file, you need to
have a minimum of 4 MB of available disk space; if you are using a
temporary swap file, you need to have a minimum of 9 MB of available
disk space. Also, be sure that you have a valid TEMP directory.
<P>
The Novell NetWare products included here are manufactured by a vendor
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kb3rdparty<BR>
KBSubcategory: win30 win31<BR>
Additional reference words: wdnovell wderror 3.10 3.00 3.00a 3.1 3.0<BR>
3.0a 2.03 2.10 2.11 3.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
