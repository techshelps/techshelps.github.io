

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>What Is a Clean Boot for Windows for Workgroups? </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90511 ">
<META NAME="KBModify" CONTENT="1995/01/24">
<META NAME="KBCreate" CONTENT="1992/10/18">
<META NAME="Keywords" CONTENT="kbusage kbdisplay kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  A  clean boot  (starting your computer after all unnecessary commands have been removed from your CONFIG.SYS and AUTOEXEC.BAT files) is used as a basic troubleshooting step to test possible conflicts between Windows for Workgroups and various termi...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDIV,QDL7,QAU9,QAIJ,QBFY,QANE,QDL9,QBWQ,QBWN,QAEF,QAA1,QAB5,QAC9,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>What Is a Clean Boot for Windows for Workgroups?</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 24, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90511 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A "clean boot" (starting your computer after all unnecessary commands
have been removed from your CONFIG.SYS and AUTOEXEC.BAT files) is used
as a basic troubleshooting step to test possible conflicts between
Windows for Workgroups and various terminate-and-stay-resident (TSR)
programs and device drivers. There are different types of clean boots;
the correct one to use depends on whether or not Windows for
Workgroups has been installed.
<P>
For more information on clean booting, see Chapter 6 of the "Getting
Started with Microsoft Windows for Workgroups" version 3.1 manual and
Chapter 11 of the version 3.1 "Microsoft Windows for Workgroups Users
Guide."
<P>
NOTE: This article explains how to clean boot your system up to the point
when you start Windows. To start Windows without loading any third-party
programs, you must clear the StartUp group, clear the LOAD= and RUN=
entries in the WIN.INI file, and ensure the SHELL= entry in the SYSTEM.INI
file is loading PROGMAN.EXE. Also, make sure the SYSTEM.INI file does not
include third-party virtual device drivers (VxDs) or other third-party
Windows components.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Before Clean Booting</h3>
 
<P>
Create a bootable floppy disk that contains the MS-DOS system files and any
other files that are required to make the system operational, such as disk-
compression utilities (for example, Stacker), disk partitioning drivers
(for example, Disk Manager), and other third-party device drivers.
<P>
<P><h3>To Clean Boot Before Running Windows Setup</h3>
 
<P>
If there is no disk compression software, disk partitioning software, or
other third-party drivers necessary to start the computer, the machine can
be started from a floppy disk that contains only the MS-DOS system files,
without a CONFIG.SYS or AUTOEXEC.BAT file.
<P>
If there is disk partitioning, disk compression, or other third-party
software required to boot the computer, the startup files on the disk
created above should appear as follows:
<P>
<PRE>   CONFIG.SYS                              AUTOEXEC.BAT
   ----------                              ------------

   FILES=45                                PROMPT $P$G
   BUFFERS=20
   &lt;Third-party disk partitioner&gt;
   &lt;Third-party disk compression driver&gt;
   &lt;Other required third-party driver&gt;

</PRE><h3>Windows for Workgroups 3.1 Clean Boot</h3>
 
<P>
AFTER Windows for Workgroups version 3.1 is installed, a clean boot should
appear as follows:
<P>
<PRE>   CONFIG.SYS                                AUTOEXEC.BAT
   ----------                                 ------------

   FILES=45                                  &lt;WFWG 3.1 dir&gt;NET START
   BUFFERS=20                                PROMPT $P$G
   DEVICE=C:\&lt;WFWG 3.1 dir&gt;\HIMEM.SYS        PATH C:\Windows;C:\DOS;C:\
   &lt;Third-party disk partitioner&gt;            SET TEMP=C:\&lt;valid path&gt;
   &lt;Third-party disk compression driver&gt;
   &lt;Other required third-party drivers&gt;
   DEVICE=&lt;valid path&gt;\PROTMAN.DOS /I:&lt;valid PATH to PROTOCOL.INI&gt;
   DEVICE=&lt;MAC DRIVER&gt;.DOS
   DEVICE=&lt;valid path&gt;WORKGRP.SYS
   SHELL=C:\&lt;valid path&gt;\COMMAND.COM  /E:1024 /P
   STACKS=9,256

</PRE><h3>Windows for Workgroups 3.11 Clean Boot</h3>
 
<P>
AFTER Windows for Workgroups version 3.11 is installed, a clean boot should
appear as follows:
<P>
<PRE>   CONFIG.SYS                                AUTOEXEC.BAT
   ----------                                ------------

   FILES=45                                  &lt;WFWG 3.11 dir&gt;NET START
   BUFFERS=20                                PROMPT $P$G
   DEVICE=C:\&lt;WFWG 3.11 dir&gt;\HIMEM.SYS       PATH=C:\Windows;C:\DOS;C:\
   &lt;Third-party disk partitioner&gt;            SET TEMP=C:\&lt;valid path&gt;
   &lt;Third-party disk compression driver&gt;
   &lt;Other required third-party drivers&gt;
   DEVICE=&lt;WFW 3.11 dir&gt;IFSHLP.SYS
   SHELL=C:\&lt;valid path&gt;\COMMAND.COM  /E:1024 /P
   STACKS=9,256

</PRE><h3>Exceptions</h3>
 
<P>
The following are examples of drivers that SHOULD NOT be removed; they
are used when the computer is turned on to make the hard drive
accessible. This is not a complete list, but it does include most of
the commonly used drivers:
<P>
<PRE>Hard Disk Drivers:      SQY55.SYS, SSTBIO.SYS, SSTDRIVE.SYS,
                        AH1544.SYS, ILIM386.SYS, ASPI4DOS.SYS,
                        SCSIHA.SYS, SCSIDSK.EXE, SKYDRVI.SYS,
                        ATDOSXL.SYS, NONSTD.SYS.

Disk Partitioners:      DMDRVR.BIN, SSTOR.SYS, HARDRIVE.SYS,
                        EDVR.SYS, FIXT_DRV.SYS, LDRIVE.SYS,
                        ENHDISK.SYS.

</PRE>Disk Compression Utilities: STACKER.COM, SSWAP.COM, SSTOR.EXE,
DEVSWAP.COM
<P>
If the purpose of a device driver or program is unknown, DO NOT remove
it. Most device drivers and programs will display a message describing
their purpose when they are initialized.
<P>
A clean boot DOES NOT include:

<UL><LI>DOS=HIGH,UMB
<LI>EMM386.EXE
<LI>INSTALL=SHARE.EXE
<LI>INSTALL=FASTOPEN.EXE
<LI>Third-party memory managers
<LI>RAM disk devices
<LI>JOIN, GRAPHICS, PRINT, SUBST, APPEND
<LI>MODE for printer redirection
<LI>Multiple path statements
<LI>MS-DOS-level mouse drivers
<LI>Third-party disk caches
<LI>Various third-party TSRs
<LI>LOGIMENU, CLICK
<LI>Virus checkers
<LI>Drivers for scanners/fax
<LI>Drivers for CD ROM/network
<LI>Tape backup spoolers/redirectors/buffers
<LI>Data acquisition units
<LI>Keyboard accelerators/buffers
<P>
</UL>For information on clean booting Windows 3.0, query on the following
words in the Microsoft Knowledge Base:
<P>
<PRE>   clean and boot and windows and 3.0
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbdisplay kbtshoot<BR>
KBSubcategory: wfwg<BR>
Additional reference words: 1.0 1.00 3.10 3.11 LAN Manager LANman clean-<BR>
boot PRINT.COM RAMDRIVE.SYS JOIN.EXE PRINT.EXE MODE.COM GRAPHICS.COM<BR>
SUBST.EXE cleanboot tshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 24, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
