

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WG0904: Support for Novell NetWare 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104632">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1993/09/23">
<META NAME="Keywords" CONTENT="wfw wfwg kb3rdparty kbappnote kbfile kbnetwork kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" Microsoft has an Application Note,  WG0904: Support for Novell(R) Netware(R) 4.0,  that contains updated Windows for Workgroups files (NET.EXE, WORKGRP.SYS, VREDIR.386, and VBROWSE.386) and information about using these files with a Novell NetWare v...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAVZ,QA8Y,QAIB,QAA1,QDL9,QBWN,QBWQ,QBXT,QA5V,QDI2,QBDM,QABA,QA9N,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WG0904: Support for Novell NetWare 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104632</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10
WINDOWS
kbnetwork kbfile kbappnote kbsetup kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.1
</UL> 
<P>
Microsoft has an Application Note, "WG0904: Support for Novell(R)
Netware(R) 4.0," that contains updated Windows for Workgroups files
(NET.EXE, WORKGRP.SYS, VREDIR.386, and VBROWSE.386) and information about
using these files with a Novell NetWare version 4.0 client configuration.
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note"
section at the end of this article.
<P>
<P><h2>THE TEXT OF WG0904</h2>
 
<P>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
             WG0904: SUPPORT FOR NOVELL(R) NETWARE(R) 4.0
</PRE> 
<PRE>                                                   Revision Date: 9/93
                                                       1 Disk Included

</PRE>The following information applies to Microsoft Windows(TM) for
Workgroups, version 3.1.
<P>
 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an Application|
| Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER     |
| EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED     |
| WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR      |
| PURPOSE. The user assumes the entire risk as to the accuracy and   |
| the use of this Application Note. This Application Note may be     |
| copied and distributed subject to the following conditions:  1) All|
| text must be copied without modification and all pages must be     |
| included;  2) If software is included, all files on the disk(s)    |
| must be copied without modification (the MS-DOS utility diskcopy is|
| appropriate for this purpose);  3) All components of this          |
| Application Note must be distributed together;  and  4) This       |
| Application Note may not be distributed for profit.                |
|                                                                    |
| Copyright (C) 1993 Microsoft Corporation.  All Rights Reserved     |
| Microsoft and MS-DOS are registered trademarks and Windows is a    |
| trademark of Microsoft Corporation.                                |
| CompuServe is a registered trademark of CompuServe, Inc.           |
| NetWare and Novell are registered trademarks of Novell, Inc.       |
</PRE> 
<P>
<P><h3>Introduction</h3>
 
<P>
This Application Note contains updated Windows for Workgroups files
(NET.EXE, WORKGRP.SYS, VREDIR.386, and VBROWSE.386) and information
about using these files with a Novell NetWare version 4.0 client
configuration. Providing Windows for Workgroups support for NetWare
4.0 first requires proper installation of Novell's client software. If
the setup steps described in this document do not function properly,
contact Novell for more information. Microsoft can ensure connectivity
between Windows for Workgroups and Novell NetWare only when you are
running MSIPX.COM. If you cannot enable the open data-link interface
(ODI) drivers using Novell's procedure (included with NetWare 4.0),
call Novell Technical Support at (800) 638-9273.
<P>
Although the current specification of Windows for Workgroups is MSIPX,
an exclusively NDIS-compliant protocol, Novell's ODINSUP.COM, allows
NDIS protocol stacks to run unmodified over the ODI link support layer
(LSL) and talk to an ODI LAN driver. Novell's LSL can be accessed by
using the ODINSUP driver. Microsoft recommends using ODINSUP.COM
version 1.22 with this Application Note. Novell makes this file
available on its bulletin board service and in the Novell
CompuServe(R) forum. The current filename is DOSUP7.ZIP. For more
availability information, contact Novell or look on the Novell
CompuServe forum.
<P>
When you use ODINSUP.COM with Windows for Workgroups and NetWare 4.0,
the following configuration files are modified:
<P>
<PRE>   CONFIG.SYS
   STARTNET.BAT or AUTOEXEC.BAT
   NET.CFG
   PROTOCOL.INI
   SYSTEM.INI

</PRE><h3>Before You Begin</h3>
 
<P>
Since this configuration requires the Novell IPXODI drivers, set up
your machines and connect to a Novell server from an MS-DOS command
prompt using IPXODI.COM before proceeding with the setup instructions
below. Be sure to back up your files so that you can restore your
original configuration if necessary.
<P>
<P><h3>Setup Instructions</h3>
 

<OL><P><LI>Install Windows for Workgroups with your network interface card
   (NIC) and with Novell NetWare as a secondary network.

<P><LI>Run the Novell NetWare 4.0 client installation program.

<P><LI>Edit the CONFIG.SYS file and remove or remark out (using the REM
   command) the following lines
<P>
<P><PRE>      device=c:\windows\&lt;drivername.xxx&gt;
      device=c:\windows\msipx.sys
</PRE><P>
   where &lt;drivername.xxx&gt; is the name of your NDIS network card
   driver. If you already have ODI connections, these entries are not
   present.
<P>
<P><PRE>    NOTE: The NetWare 4.0 installation program changes the LASTDRIVE=
    statement from drive P to drive Z. Leave this change intact.
</PRE>
<P><LI>By default, the NetWare 4.0 installation program creates a
   STARTNET.BAT file (from which the NetWare files are run) in the
   NWCLIENT subdirectory. You need to edit this file unless the
   NetWare drivers are to be loaded from the AUTOEXEC.BAT file (in
   which case, you need to make the same changes in the AUTOEXEC.BAT
   file). If these drivers are loading from the AUTOEXEC.BAT file,
   remove the @CALL STARTNET.BAT line, which the NetWare installation
   procedure inserts. When you are finished editing the STARTNET.BAT
   or AUTOEXEC.BAT file, it should read as follows:
<P>
<PRE>  Lines                          Comments
</PRE></OL> 
<PRE>  SET NWLANGUAGE=ENGLISH         This is new under 4.0.

  LSL

  ODI MAC driver for your NIC    For example, this line would read
                                 NE2000 if you have an Novell NE2000
                                 NIC.

  ODINSUP.COM                    Manually add this driver from the
                                 DOSUP7.ZIP file.

  C:\WINDOWS\NET START NETBIND   Make sure this line is in either
                                 your AUTOEXEC.BAT or STARTNET.BAT,
                                 depending on which one is used to
                                 start NetWare connectivity.

  IPXODI

  VLM.EXE                        This file replaces NETX.EXE in
                                 NetWare 4.0.

</PRE><P><LI>In the AUTOEXEC.BAT file, remove or remark out the following lines:
<P>
<P><PRE>      c:\windows\net start
      c:\windows\msipx.com
</PRE><P>
<P><PRE>    IMPORTANT: Steps 6 and 7 provide the changes made in the NET.CFG
    and PROTOCOL.INI files if you are using a Novell NE2000 NIC. If
    you are using a different card, many of the changes made will be
    specific to your NIC and therefore different than those below.
</PRE>
<P><LI>To use ODINSUP.COM with Windows for Workgroups 3.1, the NET.CFG
   file should appear as follows. Some of the settings below appear as
   a result of the NetWare 4.0 installation program; you may need to
   manually edit others.
<P>
<P><PRE>    NOTE: If you were using ODINSUP.COM with NetWare 3.11, the 4.0
    installation removes the changes that were made to the NET.CFG
    file. The final file should read as follows:
</PRE><P>
<PRE>Lines                            Comments
</PRE></OL> 
<PRE>PB BUFFERS 7                     This line is added.

PROTOCOL ODINSUP                 This line exists if ODI is
                                 installed before you begin this
                                 procedure.
   BIND NE2000                   If you are using a NIC other than
                                 the NE2000, a different MAC driver
                                 appears here.
   BUFFERED

Link Driver NE2000               This line varies depending on the
                                 NIC you are using.
   Port &lt;XXX&gt;                    This line is set to the I/O base
                                 being used.
   INT &lt;XX&gt;                      This line is set to the IRQ being
                                 used. Both the Port and INT
                                 settings assume that the defaults
                                 are not being used. If the defaults
                                 are being used, these lines do not
                                 appear.
   MEM &lt;XXXXX&gt;                   This line appears only if your NIC
                                 is memory address configurable.
   Frame Ethernet_802.2          These frame types are required.
   Frame Ethernet_802.3
   Frame Ethernet_II
   Frame Ethernet_SNAP
   Protocol IPX 0 Ethernet_802.3
</PRE>NetWare DOS Requester
<PRE>   First Network Drive = F       This setting is new with NetWare
                                 4.0 and is the reason LASTDRIVE no
                                 longer needs to be set to P.

</PRE><P><LI>To use ODINSUP.COM with Windows for Workgroups 3.1, the
   PROTOCOL.INI file should appear as follows. Some of the settings
   below appear as a result of the NetWare 4.0 installation program;
   you may need to manually edit others.
<P>
<P><PRE>    IMPORTANT: If you were using ODI with Windows for Workgroups
    before upgrading Novell NetWare to 4.0, this file does not require
    editing.
</PRE><P>
<P><PRE>    NOTE: To determine the correct MLID name, type the ODI NIC driver
    name at an MS-DOS command prompt.
</PRE><P>
<PRE>Lines                            Comments
</PRE></OL> 
[network.setup]
version=0x3100
<PRE>netcard=NE2000,1,NE2000          Use the MLID name for this entry.
</PRE>transport=ms$netbeui,MS$NETBEUI
transport=IPX,IPX
<PRE>lana0=NE2000,1,ipx               Use the MLID name for this entry.
lana1=NE2000,1,ms$netbeui        Use the MLID name for this entry.

</PRE>[protman]
DriverName=PROTMAN$
PRIORITY=MS$NETBEUI
<P>
[MS$NETBEUI]
DriverName=netbeui$
SESSIONS=10
NCBS=32
<PRE>BINDINGS=NE2000                  Use the MLID name for this entry.
</PRE>LANABASE=1
<P>
<PRE>[NE2000]                         Add this entire section or
                                 convert it from the MS$NE2000
                                 section.
DRIVERNAME=NE2000                Use the MLID name for this entry.
IOBASE=0x300                     This entry should match the
                                 IOBASE setting in the NET.CFG
                                 file.
INTERRUPT=11                     This entry should match the
                                 INTERRUPT setting in the NET.CFG
                                 file.

[MS$NE2000]                      Remark out this entire section by
                                 placing a semicolon at the
                                 beginning of each line, including
                                 the section header.

[MS$IPX]                         Remark out this entire section by
                                 placing a semicolon at the
                                 beginning of each line, including
                                 the section header.

[IPX]                            Add this section.
</PRE>DRIVERNAME=IPX$
<PRE>MediaType=Novell/Ethernet        This section will vary depending
                                 on the transceiver type.
BINDINGS=NE2000                  Use the MLID name for this entry.

</PRE><P><LI>Make the following changes in the SYSTEM.INI file:
<P>
   In the [boot] section of the SYSTEM.INI file, the Novell NetWare
   4.0 installation changes the line
<P>
<P><PRE>      network.drv=wfwnet.drv
</PRE><P>
   to read:
<P>
<P><PRE>      network.drv=netware.drv
</PRE><P>
   Simply change the NETWORK.DRV line so that it reads as follows:
<P>
<P><PRE>      network.drv=wfwnet.drv
</PRE><P>
<P><PRE>    NOTE: Do not change the SECONDNET.DRV=NETWARE.DRV setting.
</PRE><P>
   After you make these changes, update your Windows for Workgroups
   installation with the four files on the enclosed WG0904 disk:
   NET.EXE, WORKGRP.SYS, VREDIR.386, and VBROWSE.386. Copy NET.EXE and
   WORKGRP.SYS to the Windows directory. Copy VREDIR.386 and
   VBROWSE.386 to the Windows SYSTEM subdirectory. For example, if you
   insert the WG0904 disk in drive A and your Windows directory and
   Windows SYSTEM subdirectory are C:\WINDOWS and C:\WINDOWS\SYSTEM,
   respectively, type the following commands at an MS-DOS command
   prompt, pressing ENTER after each line:
<P>
<P><PRE>      copy a:\net.exe c:\windows
      copy a:\workgrp.sys c:\windows
      copy a:\*.386 c:\windows\system
</PRE>
<P><LI>Reboot and restart Windows for Workgroups.
<P>
</OL>For more information concerning ODINSUP.COM, call Novell Technical
Support.
 
<P>
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0904.EXE">WG0904.EXE</A> <I>(size: 289239 bytes)</I> 
                       , a self-extracting file, on the following
</PRE></OL>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0904.EXE">WG0904.EXE</A> <I>(size: 289239 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0904.EXE">WG0904.EXE</A> <I>(size: 289239 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0904.EXE">WG0904.EXE</A> <I>(size: 289239 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>If you are unable to access the source(s) listed above, you can
   have this Application Note mailed to you by calling Microsoft
   Product Support Services Monday through Friday, 6:00 A.M. to 6:00
   P.M. Pacific time at (425) 637-7098. If you are outside the
   United States, contact the Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbfile kbappnote kbsetup kb3rdparty<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: appnote 3.1 3.10<BR>
Keywords            : wfw wfwg kb3rdparty kbappnote kbfile kbnetwork kbsetup<BR>
Version             : 3.10<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
