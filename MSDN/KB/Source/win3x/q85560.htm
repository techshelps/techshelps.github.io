

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a New SYSTEM.INI Without Third-Party Drivers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q85560 ">
<META NAME="KBModify" CONTENT="1995/05/09">
<META NAME="KBCreate" CONTENT="1992/06/14">
<META NAME="Keywords" CONTENT="kbref kbtshoot kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  You can use your original Windows disks to create a new SYSTEM.INI file for your specific hardware. This can be useful for troubleshooting purposes or for replacing a damaged or deleted SYSTEM.INI file.  NOTE: As a precaution, you may want to start...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QA0B,QANE,QABI,QAIJ,QAA1,QBW7,QAI5,QAC9,QBFY,QAEF,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Creating a New SYSTEM.INI Without Third-Party Drivers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 9, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q85560 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use your original Windows disks to create a new SYSTEM.INI file for
your specific hardware. This can be useful for troubleshooting purposes or
for replacing a damaged or deleted SYSTEM.INI file.
<P>
NOTE: As a precaution, you may want to start the Setup program with the
original SYSTEM.INI file, and then press PRINT SCREEN so that you have a
printed copy of the your settings. You can then use this as a reference
when you reset them.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a new SYSTEM.INI file that is configured for your specific
hardware but does not contain any references to third-party device drivers,
do the following:

<OL><P><LI>Rename the SYSTEM.INI file to SYSTEM.BAK.

<P><LI>Expand the file SYSTEM.SR_ from the original Windows disks to the
   Windows directory with the following command:
<P>
<P><PRE>      c:\windows\expand a:\system.sr_ c:\windows\system.ini
</PRE><P>
   NOTE: This file can be found on Disk 1 of the Windows 3.1 1.44-megabyte
   (MB) 3.5-inch disk set or on Disk 2 of the 1.2-MB 5.25-inch disk set.

<P><LI>Change to the Windows drive, and then change to the Windows directory.
   For example:
<P>
<P><PRE>      c:
      cd \windows
</PRE>
<P><LI>Type "setup" (without the quotation marks) to start the MS-DOS-based
   portion of Windows Setup.

<P><LI>Select the correct hardware options for your system. (They are
   blank by default.)
<P>
   NOTE: For a list of valid choices, move your cursor to the blank field
   and then press ENTER.

<P><LI>Accept the changes. (At this point, you can have Setup copy new drivers
   if you want.)

<P><LI>Open the new SYSTEM.INI file in a text editor (for example, MS-DOS
   5.0 Editor). Make the following changes to the SYSTEM.INI file:
<P>
   a. Add PROGMAN.EXE to the SHELL= line in the [Boot] section.
<P>
   b. Remove or remark out the Taskman.exe= line in the [Boot]
<P><PRE>      section.
</PRE><P>
   c. To enable 32-bit disk access, add the following lines to the
<P><PRE>      [386Enh] section:
</PRE><P>
<PRE>         32BitDiskAccess=&lt;Boolean&gt;
         device=*int13
         device=*wdctrl

      Replace &lt;Boolean&gt; with On if you want 32-bit disk access
      enabled; replace it with Off if you do not want 32-bit disk
      access enabled.

    For more information about 32-bit disk access, see Appendix D in
    the Windows Resource Kit manual, or query on the following words
    in the Microsoft Knowledge Base:

       windows and 3.1 and 32-bit and disk and access

</PRE><P><LI>Start Windows. If you do not receive any errors, you have successfully
   re-created your SYSTEM.INI file.
<P>
   If you receive error S020 or S021, the SYSTEM.INI file you created
   may be corrupted. To correct this problem, do the following:
<P>
   a. Check for a duplicate SYSTEM.INI file by typing "dir c:\
<P><PRE>      system.ini  /s" (without the quotation marks) at the MS-DOS
      command prompt.
</PRE><P>
   b. Run CHKDSK to check for lost allocation units by typing "chkdsk
<P><PRE>      /f" (without the quotation marks) at the MS-DOS command prompt.
</PRE><P>
   c. Make sure your hard disk has sufficient free space.
<P>
   d. Delete the corrupted SYSTEM.INI file and then follow the steps
<P><PRE>      outlined above again, starting with number 2.
</PRE><P>
   e. If all else fails, reinstall Windows.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbref kbtshoot kbtlc<BR>
KBSubcategory: win31<BR>
Additional reference words: 3.10 3.11 recreate re-create system.src tshoot<BR>
rebuild clean expanding system.bkp troubleshoot hardware system.tmp vanilla<BR>
"how to create a new" third-party<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 9, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
