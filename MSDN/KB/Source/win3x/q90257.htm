

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Does WFWG Upgrade from LAN Manager 2.1? </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90257 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/10/12">
<META NAME="Keywords" CONTENT="kbsetup kbnetwork kbother">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Windows for Workgroups Setup detects if LAN Manager 2.1 is running by determining whether the LAN Manager redirector is present in memory. If it is, Setup then tries to upgrade using the information in the LAN Manager SETUP.INI file.  MORE INFORMAT...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBWO,QDIZ,QDI2,QAVZ,QAGU,QBWE,QAH5,QAU9,QAY2,QAGR,QDJS,QAEF,QA0B,QAFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Does WFWG Upgrade from LAN Manager 2.1?</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90257 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows for Workgroups Setup detects if LAN Manager 2.1 is running by
determining whether the LAN Manager redirector is present in memory.
If it is, Setup then tries to upgrade using the information in the LAN
Manager SETUP.INI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
LAN Manager 2.1 is only detected if it is loaded and running during
Setup. This means that the NET START WORKSTATION command must have
been executed in order for Setup to find it. Setup does not check the
CONFIG.SYS or AUTOEXEC.BAT or any other file to find LAN Manager.
<P>
If Setup does find LAN Manager 2.1, it uses the information in the LAN
Manager 2.1 SETUP.INI file to upgrade the configuration to Windows for
Workgroups and to remove the LAN Manager statements from the
CONFIG.SYS and AUTOEXEC.BAT files.
<P>
Setup checks the SETUP.INI for the following entries:
<P>
<PRE>   [setup]
   DRIVER0 = card protocol [protocol [protocol [protocol]]]
   DRIVER1 = card protocol [protocol [protocol [protocol]]]
   DRIVER2 = (etc.)

</PRE>It then uses the [netcard] and [transport] sections in LM21DRV.UPD to
map the LAN Manager driver names to Windows for Workgroups driver
identification numbers. A new PROTOCOL.INI is created using the mapped
drivers. The settings for the drivers are copied from the LAN Manager
PROTOCOL.INI file.
<P>
If a mapping does not exist for a driver in SETUP.INI, Setup will warn
the user that the driver could not be upgraded and the driver will be
skipped. The user will have to add this device back by hand using the
Control Panel, which may require the use of Windows for Workgroups
compatible original equipment manufacturer (OEM) disks.
<P>
Setup uses the the [ConfigSys] and [StartupCmd] sections in SETUP.INI
file to delete any lines from the CONFIG.SYS and AUTOEXEC.BAT files
that LAN Manager added. If the user has modified any of these lines so
that they no longer match the lines in the SETUP.INI file, they might
not be deleted. Setup also deletes any lines from the AUTOEXEC.BAT
file that contain these phrases: LOAD NETBEUI, LOAD TCPIP, NET START,
NET LOGON, or NET LOGIN.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbnetwork kbother<BR>
KBSubcategory: wfw<BR>
Additional reference words: 3.10 lanman wfwg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
