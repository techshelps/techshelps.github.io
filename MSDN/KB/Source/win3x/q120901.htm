

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Win32s in Windows and Windows for Workgroups </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120901">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1994/09/21">
<META NAME="Keywords" CONTENT="wfw wfwg win31 kbdisplay kberrmsg kbfile kbinterop kbpolicy">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Win32s is a set of DLLs and a virtual device driver (VxD) that allows Win32-based applications to run on top of Windows or Windows for Workgroups. If you receive the following error message when you run or install a Win32-based application     This...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBWO,QDL9,QBWN,QBWQ,QABI,QBVV,QDIZ,QBXB,QATJ,QAFI,QAEF,QAB4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Installing Win32s in Windows and Windows for Workgroups</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120901</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups versions 3.1, 3.11
<LI>Microsoft Win32s, versions 1.0, 1.1, 1.15, 1.2, 125a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Win32s is a set of DLLs and a virtual device driver (VxD) that allows
Win32-based applications to run on top of Windows or Windows for
Workgroups. If you receive the following error message when you run or
install a Win32-based application
<P>
<PRE>   This program cannot be run in DOS mode

</PRE>Win32s is either not installed or not installed properly.
<P>
You can use Freecell to test your installation of Win32s.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Win32s Version 1.2 Availability and Support</h3>
 
<P>
Win32s is available from many sources. Microsoft Personal Operating System
Support Engineers support the installation of Win32s when it is obtained
from the following source:
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Pw1118.exe">Pw1118.exe</A> <I>(size: 2530739 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>Microsoft Windows and Windows for Workgroups support engineers may not be
able to assist you with individual application or Win32s development
questions. Contact your software manufacturer or Microsoft Developer
Support for assistance in these areas.
<P>
<P><h3>Win32s Problems</h3>
 
<P>
Freecell is an application available with Win32s in the above locations. To
test your installation of Win32s, run Freecell. If you are experiencing
problems but Freecell runs properly, contact the manufacturer of the
product you are attempting to run or install for further information. If
Freecell generates an error, continue reading the following information.
<P>
One of the following error messages occurs when you run Freecell and
Win32s is not installed properly:

<UL><LI>File Error: Cannot find OLECLI.DLL
<P>
   -or-

<LI>Win32s - Error:
   Improper installation. Win32s requires WIN32S.EXE and WIN32S16.DLL
   to run. Reinstall Win32s.
<P>
   -or-

<LI>Win32s - Error:
   Improper installation. Windows requires w32s.386 in order to run.
   Reinstall Win32s.
<P>
   -or-

<LI>Error: Cannot find file freecell.exe (or one of its components)...
<P>
</UL>Also, if Win32s is not installed properly, the display may be corrupted as
soon as you run Freecell.
<P>
<P><h3>Resolutions</h3>
 
<P>
If Win32s is not installed correctly, check the following:

<UL><LI>If you are having video problems, check to see if you have an S3
   video card. Certain S3 drivers do not work with Win32s. Either use
   the generic drivers shipped with Windows, or contact your video card
   manufacturer for an updated driver.

<LI>Make sure that the following line is in your SYSTEM.INI file:
<P>
<P><PRE>      device=*vmcpd
</PRE>
<LI>If you have a printer driver by LaserMaster, remove it or comment it
   out. (It interferes with installing Win32s.) Reboot the computer so that
   the changes you made take effect. After you successfully reinstall
   Win32s, reinstall the driver or remove the comment characters.
<P>
   The driver interferes with installing Win32s because the LaserMaster
   drivers create a WINSPOOL device. The extension is ignored when the
   filename portion of a path matches a device name. As a result, when
   Setup tries to write to WINSPOOL.DRV, it fails because it attempts to
   write to WINSPOOL. In fact, any Win32-based application that tries to
   link to WINSPOOL.DRV also fails; however, most Win32-based applications
   that print under Win32s do not use the WINSPOOL application programming
   interfaces (APIs) because they are not supported in Win32s. As a result,
   you can usually disable this driver while installing Win32s and then
   re-enable it afterwards.

<LI>Delete the WIN32S directory, the WIN32APP directory, and the
   W32SYS.DLL, W32S16.DLL, and WIN32S.EXE files from your hard disk.
<P>
   Edit the WIN32S.INI file on your hard disk. Change the line(s)
   SETUP=1 to read SETUP=0. Reboot your computer and reinstall Win32s.
<P>
   NOTE: You can also delete the WIN32S.INI file altogether for a clean
   installation.
<P>
   Although it is possible to install Win32s over an old installation of
   Win32s, it is recommended that you remove the old files before
   installing the new ones.

<LI>Make sure that paging is enabled. From the Control Panel, choose
   the 386 Enhanced icon, choose Virtual Memory, then choose Change.
   Verify that the drive type is not set to None.

<LI>Make sure that SHARE is enabled. Edit the AUTOEXEC.BAT file and add
   the following line if it is not already there:
<P>
<P><PRE>      C:\DOS\SHARE.EXE
</PRE><P>
   -or-
<P>
   If you are running Windows for Workgroups or you have a file by the
   name VSHARE.386 on your system, you do not need to load SHARE in the
   AUTOEXEC.BAT file. If you have this file, edit the SYSTEM.INI file
   and add the following line to the [386Enh] section:
<P>
<P><PRE>      Device=VSHARE.386
</PRE>
<LI>If you use Windows for Workgroups and Win32s with After Dark or
   Power.drv, you may lose the Network icon in Control Panel and all
   networking features. To resolve this problem, you must remove the
   After Dark statements and the Power.drv statement in the System.ini
   file.
<P>
</UL><h3>Network Installation of Win32s</h3>
 
<P>
The following information describes how to install Win32s on a network
setup of Windows on a Novell NetWare server (SETUP /A and /N).
<P>
NOTE: Microsoft does not support this method; therefore, Microsoft
Technical Support does not support the procedure in this article. Although
we have tested the following procedure and it appears to function as
described, if this method does not work you should use a supported
configuration instead.
<P>
To set up Win32s to a shared Windows directory on a Novell NetWare server,
you must have full read/write access to that directory. Win32s does set up
correctly the first time. The Setup program detects the shared directory
(SETUP /A) as the Windows directory and copies the files to it. Setup also
modifies the .INI files for the copy of Windows from which you are
performing Setup. For all other installations, the SYSTEM.INI files must be
modified manually; otherwise, the full setup program tries to run again and
attempts to write the files to the server directory again. Add the
following lines to each SYSTEM.INI file:
<P>
<PRE>   [Boot]
   drivers=F:\&lt;shared Windows directory&gt;\winmm16.dll

      NOTE: The drivers= line may contain additional drivers.

   [386Enh]
   device=F:\&lt;shared Windows directory&gt;\win32s\w32s.386.

</PRE>Both lines should contain the full network path to the files in the shared
Windows directory. The Win32s Setup program installs the Win32s directory,
which is ordinarily created in the Windows SYSTEM subdirectory, into the
shared Windows directory.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbpolicy kbdisplay kbinterop kberrmsg kbfile<BR>
KBSubcategory: win31 wfw wfwg<BR>
Additional reference words: 3.10 3.11 win32 afterdark<BR>
Keywords          : wfw wfwg win31 kbdisplay kberrmsg kbfile kbinterop kbpolicy<BR>
Version           : 3.10 3.11<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
