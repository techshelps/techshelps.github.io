

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting CD-ROM Problems in Windows 3.1 Enhanced Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q85644 ">
<META NAME="KBModify" CONTENT="1995/05/08">
<META NAME="KBCreate" CONTENT="1992/06/16">
<META NAME="Keywords" CONTENT="kbhw kbmm kbdisplay kbfasttip kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  If you experience problems with a CD-ROM drive when running Microsoft Windows version 3.1 in 386 enhanced mode, there are several steps to try to correct the problem. This article explains these procedures.  NOTE: Windows does not have any special ...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDLP,QAU9,QDL9,QBWO,QBWN,QBXM,QABI,QBWQ,QBW6,QABA,QAY2,QDIR,QDJS,QDIO,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting CD-ROM Problems in Windows 3.1 Enhanced Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q85644 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you experience problems with a CD-ROM drive when running Microsoft
Windows version 3.1 in 386 enhanced mode, there are several steps to try to
correct the problem. This article explains these procedures.
<P>
NOTE: Windows does not have any special device drivers or .INI file
settings that it requires for CD-ROM drives.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>If you start Windows from your AUTOEXEC.BAT file, ensure the MSCDEX
   command is before the WIN command.

<P><LI>Make sure the CD-ROM works at the MS-DOS level before starting
   Windows. To test this, use a data disk. Change the default drive to
   the CD-ROM. For example, type the following to change to drive E:
<P>
<P><PRE>      E:
</PRE><P>
   You should be able to obtain a directory listing by typing "dir"
   (without the quotation marks) at the MS-DOS command prompt. This
   test should be used to confirm that the hardware is functioning
   correctly.

<P><LI>Make sure all the correct drivers are being loaded. You should
   have drivers loaded in both the CONFIG.SYS and AUTOEXEC.BAT files.
   For example, MSCDEX.EXE should be loaded in the AUTOEXEC.BAT file.
   The following is an example of a ProAudio driver being loaded in
   the CONFIG.SYS file:
<P>
<P><PRE>      device=d:\proaudio\tslcdr.sys /d:mvcd001 /r "ProAudio CD driver
</PRE><P>
   For troubleshooting purposes, do not load any of the drivers into
   the upper memory blocks (UMB). For example, don't use LOADHIGH, LH,
   DEVICEHIGH, or any other UMB manager (such as QEMM or 386MAX) to
   load the drivers high.

<P><LI>Use the right driver versions. The following information is taken
   from section 11.1 of the Windows 3.1 README.WRI file:
<P>
<P><PRE>      If you are using a CD-ROM drive with Windows 3.1, you should use
      version 2.21 of Microsoft MS-DOS CD-ROM Extensions (MSCDEX) with
      all configurations of CD-ROM drives. If you use version 2.2 or
      later, you must also remove the following setting from the
      [386Enh] section of the SYSTEM.INI file:
</PRE><P>
<PRE>         device=LANMAN10.386

      This setting can cause some CD-ROM drives to time-out and fail
      with versions later than 2.2 of MSCDEX. However, if you must
      use a version earlier than 2.2 of MSCDEX, the above setting is
      required in the [386Enh] section of your SYSTEM.INI file.

      If a CD-ROM drive causes instability in your system or causes
      your system to fail, you may need to update the CD-ROM driver.
      Also, the Media Control Interface (MCI) driver MCICDA.DRV may
      not work properly with older CD-ROM drivers. Contact your
      CD-ROM drive manufacturer about obtaining an updated driver.

   Updating the Driver
   -------------------

   The CD-ROM driver is located in the CONFIG.SYS file. If the MSCDEX
   driver was upgraded with out upgrading the CD-ROM driver, it is
   possible that the CD-ROM driver itself is out of date. A current
   CD-ROM driver should be obtained from the original equipment
   manufacturer (OEM) of the CD-ROM drive.

   Using SETVER
   ------------

   If you use a version of MSCDEX earlier than 2.21 and you are using
   MS-DOS 5.0, you need to load SETVER.EXE from the CONFIG.SYS file.
   MSCDEX is in the default table for SETVER; therefore, you do not need to
   add an entry for this.

</PRE><P><LI>Make sure the CD-ROM can be correctly accessed from standard mode.
   Again, this doesn't guarantee it will work in 386 enhanced mode,
   but should be done to verify that the hardware is functioning
   correctly.

<P><LI>If problems persist, you can prevent Windows from using any upper
   memory block (UMB) space. Either start Windows with the /D:X
   parameter (WIN /D:X) or add the following line to the [386Enh]
   section of the SYSTEM.INI file.
<P>
<P><PRE>      EmmExclude=A000-EFFF
</PRE><P>
   NOTE: If you are using EMM386.EXE or some other UMB manager, you
   need to use an exclude statement when loading the UMB manager
   because those settings will override other memory exclusion
   switches in Windows 3.1.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbhw kbmm kbdisplay kbfasttip kbtshoot<BR>
KBSubcategory: win31<BR>
Additional reference words: 3.10 3.1 3.11 tshoot multimedia multi media<BR>
multi-media cdrom cd rom homemm<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
