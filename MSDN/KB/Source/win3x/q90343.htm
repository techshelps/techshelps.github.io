

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LAN Manager Logon Scripts Cause System Integrity Violations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90343 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/10/13">
<META NAME="Keywords" CONTENT="kbnetwork kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  You may receive a system integrity violation error while running a Microsoft LAN Manager logon script.  CAUSE =====  Microsoft LAN Manager logon scripts are batch files that are run by the LAN Manager domain controller upon verification of user log...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAVZ,QBWO,QAGU,QAI5,QBTX,QAH5,QBWE,QBWS,QBXS,QBW7,QAGR,QA9A,QAA1,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>LAN Manager Logon Scripts Cause System Integrity Violations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90343 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive a system integrity violation error while running a
Microsoft LAN Manager logon script.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft LAN Manager logon scripts are batch files that are run by
the LAN Manager domain controller upon verification of user logon.
This LAN Manager feature is set up on the LAN Manager server.
<P>
Logon scripts can be enabled in Windows for Workgroups by installing
LAN Manager as a secondary network and setting the logon feature in
Control Panel. When Windows for Workgroups logs on and the user is
verified by the LAN Manager domain controller, the logon scripts are
run automatically in an MS-DOS virtual machine (VM). These scripts are
given a maximum of 30 seconds to run before Windows for Workgroups
regains control and finishes loading. If the LAN Manager logon script
runs for more than 30 seconds, you receive the system integrity
violation error.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, either shorten the logon scripts or
disable this feature in Control Panel, or on the LAN Manager domain
controller.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Usually LAN Manager logon scripts are used to reconnect network shares
automatically for the user. Because Windows for Workgroups has
persistent net connections, it is no loner necessary to use these
scripts for that purpose and it's better not to do so.
<P>
Sometimes logon scripts are used to run programs such as virus
scanners or other utilities from the server. In this case, you may
want to create a batch file (or edit your AUTOEXEC.BAT file) that
starts the Windows for Workgroups real-mode redirector, connects to
the server where the virus scanner exists, runs it, and disconnects
the share. For example:
<P>
<PRE>   c:\windows\net start full
   net use v: \\server\share
   v:\virus\scan.exe
   net use v: /d
   c:\windows\net stop

</PRE><h3>To Disable Logon Scripts in Control Panel</h3>
 

<OL><P><LI>Run Control Panel and choose the Network icon.

<P><LI>Choose the Networks button.

<P><LI>Select Microsoft LAN Manager in the Other Networks In Use list box.

<P><LI>Choose the Settings button.

<P><LI>Clear the Log On To LAN Manager Domain check box.
<P>
</OL>See your LAN Manager administrator if you want to disable logon
scripts on the LAN Manager domain controller, although this is not
necessary if you have disabled it in Control Panel.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kberrmsg<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: 3.10<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
