

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 3.0 File Search Logic Sequence </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q57643 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1990/01/10">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Microsoft Windows version 3.0 uses two file search logic sequences with slight differences. These are known as the KERNEL file search routine and the WIN386 file search routine. The WIN386 file search routine applies only to Windows/386 enhanced mo...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAGI,QBWQ,QAA7,QAB7,QBWS,QAFI,QBXB,QATJ,QAI3,QDIV,QBBI,QABY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 3.0 File Search Logic Sequence</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q57643 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Windows version 3.0 uses two file search logic sequences with
slight differences. These are known as the KERNEL file search routine
and the WIN386 file search routine. The WIN386 file search routine
applies only to Windows/386 enhanced mode.
<P>
This information may be of assistance in debugging problems related to
files not being found and/or incorrect files being found under Windows
3.0.
<P>
The WIN386 file open logic sequence is used for the following files
<P>
<PRE>   SYSTEM.INI
   Windows/386 "device=xxxx.386" in the [386ENH] section of the
      SYSTEM.INI
   SPART.PAR
   KRNL386.EXE
   WINSTART.BAT
   WIN386.PS2
   INSTANCE.386

</PRE>whereas the KERNEL file open logic sequence is used for everything
else, including all Windows applications that use the Windows
OpenFile() call to open files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>The WIN386 Sequence</h3>
 
<P>
<PRE>   If filespec has drive and/or path specified
      Then Open filespec
         If it fails, fail Open request
   Else
      {
      Search WINDIR (startup directory of WIN.COM)
      Search startup directory of WIN386.EXE
      Search Current Working Directory
      Search PATH
      If NOVELL
         Then Open filespec as given
      )
   Else Fail open request


</PRE><h3>The KERNEL Sequence</h3>
 
<P>
<PRE>   If filespec has drive and/or path specified
      Then Open filespec
         If it fails, then fail Open request
   Else
      {
      Search Current Working Directory
      Search WINDIR (startup directory of WIN.COM)
      Search startup directory of KERNEL.EXE (KRNL286, KRNL386)
      Search PATH
      If NOVELL
         Then Open filespec as given
      )
   Else Fail open request
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: win30<BR>
Additional reference words: 3.0 3.00 3.00a<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
