

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reinstalling Windows 3.10 Files over Windows 3.11 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112551">
<META NAME="KBModify" CONTENT="1996/07/29">
<META NAME="KBCreate" CONTENT="1994/03/13">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty kbfile kbappnote kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  This article describes how reconfigure your Windows 3.11 installation to run Windows 3.10 using your original Windows 3.10 disks. If you do not have these disks available, contact Microsoft Product Support Services (PSS) and order Application Note ...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QANE,QAUR,QAFI,QAC9,QA9N,QDIU,QA3W,QBXB,QATJ,QBFY,QASB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Reinstalling Windows 3.10 Files over Windows 3.11</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112551</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how reconfigure your Windows 3.11 installation to
run Windows 3.10 using your original Windows 3.10 disks. If you do not have
these disks available, contact Microsoft Product Support Services (PSS) and
order Application Note WW1007, "Installing Windows 3.10 Files over Windows
3.11."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To install Windows 3.10 files over a local installation of Windows 3.11:

<OL><P><LI>Quit Microsoft Windows.

<P><LI>Create a backup directory. For example, to create a backup directory off
   the root of drive C, type "md c:\backup" (without the quotation marks)
   at the MS-DOS command prompt and then press ENTER.

<P><LI>Copy the files listed below from your Windows SYSTEM subdirectory to
   the backup directory or a floppy disk.
<P>
<P><PRE>      COMMDLG.DLL
      GDI.EXE
      KRNL386.EXE
      PSCRIPT.DRV
      SHELL.DLL
      UNIDRV.DLL
      USER.EXE
</PRE><P>
   To do this, use the following syntax
<P>
<P><PRE>      copy &lt;drive&gt;:\&lt;windir&gt;\system\&lt;filename&gt; &lt;drive&gt;:\&lt;backdir&gt;
</PRE><P>
   where &lt;drive&gt; is your hard disk drive, &lt;windir&gt; is your Windows
   directory, &lt;filename&gt; is the file you are copying, and &lt;backdir&gt; is your
   backup directory.
<P>
   For example, if your hard disk drive is C, your Windows directory is
   named WINDOWS, you are copying COMMDLG.DLL, and your backup directory is
   named C:\BACKUP, type the following:
<P>
<P><PRE>      copy c:\windows\system\commdlg.dll c:\backup
</PRE><P>
   Repeat this command for the remaining files.

<P><LI>Using the table at the end of this article, insert the appropriate
   disks, one by one, and expand the following files to your Windows SYSTEM
   subdirectory.
<P>
<P><PRE>      COMMDLG.DL_
      GDI.EX_
      KRNL386.EX_
      PSCRIPT.DR_
      UNIDRV.DL_
      SHELL.DL_
      USER.EX_
</PRE><P>
   For example, insert Disk 4 of the 3.5 inch, 1.44-megabyte (MB) disk set
   and type the following at the MS-DOS command prompt:
<P>
<P><PRE>      expand a:\commdlg.dl_ c:\windows\system\commdlg.dll
</PRE><P>
   PSCRIPT.DR_ should be expanded to PSCRIPT.DRV, .DL_ files should
   be expanded to .DLL, and .EX_ files should be expanded to .EXE.
<P>
   NOTE: After you copy the new USER.EXE file to your Windows SYSTEM
   subdirectory, your registered user and company name will be blank.

<P><LI>If you use Novell NetWare connectivity, do the following:
<P>
   a. Use a text editor (such as Windows Notepad) to open your
<P><PRE>      SYSTEM.INI file, which is located in your Windows directory.
</PRE><P>
   b. In the [386Enh] section, change DEVICE=VTDA.386 to DEVICE=*VTD.
<P>
   c. Save the file and quit the text editor.
<P>
</OL>To install Windows 3.10 files over a network installation of Windows 3.11:

<OL><P><LI>Determine the location of your SYSTEM.INI file and the network share
   that contains your shared Windows files. For example, if the network
   drive containing your Windows program files is Q, the location of
   your shared Windows files may be Q:\WINSHARE and your user directory
   may be Q:\USER\YOURNAME (or your user directory may be located on
   your local hard disk drive).

<P><LI>Quit Microsoft Windows.

<P><LI>Create a backup directory. For example, to create a backup directory off
   the root of drive C, type MD C:\BACKUP at the MS-DOS command prompt and
   then press ENTER.

<P><LI>Copy the following files from the network share to the backup directory
   on your hard disk drive using the following syntax at the MS-DOS command
   prompt and then press ENTER.
<P>
<P><PRE>      copy &lt;netdrive&gt;:\&lt;netshare&gt;\&lt;filename&gt; &lt;harddrive&gt;:\&lt;backdir&gt;
</PRE><P>
   where &lt;netdrive&gt; is the network drive, &lt;netshare&gt; is the network share
   containing your SYSTEM.INI file, &lt;filename&gt; is the file you are copying,
   &lt;harddrive&gt; is your hard disk drive, and &lt;backdir&gt; is your backup
   directory.
<P>
   For example, if your network drive is Q, the network share is WINSHARE,
   the file you want to copy is COMMDLG.DLL, your hard disk drive is C, and
   your backup directory is named C:\BACKUP, type the following:
<P>
<P><PRE>      copy q:\winshare\commdlg.dll c:\backup
</PRE><P>
   Repeat this command for the remaining files:
<P>
<P><PRE>      COMMDLG.DLL
      GDI.EXE
      KRNL386.EXE
      PSCRIPT.DRV
      UNIDRV.DLL
      SHELL.DLL
      USER.EXE
</PRE>
<P><LI>Remove the read-only file attributes on the shared Windows files using
   the MS-DOS ATTRIB command.

<P><LI>Using the table at the end of this article, insert the appropriate
   disks, one by one, and expand the following files to the network drive
   and share that contains your Windows files:
<P>
<P><PRE>      COMMDLG.DL_
      GDI.EX_
      KRNL386.EX_
      PSCRIPT.DR_
      UNIDRV.DL_
      SHELL.DL_
      USER.EX_
</PRE><P>
   For example, insert Disk 4 of the 5.25-inch, 1.2-MB disk set and
   type the following at the MS-DOS command prompt:
<P>
<P><PRE>      expand a:\commdlg.dl_ q:\winshare\commdlg.dll
</PRE><P>
   PSCRIPT.DR_ should be expanded to PSCRIPT.DRV, .DL_ files should
   be expanded to .DLL, and .EX_ files should be expanded to .EXE.
<P>
   NOTE: After you copy the new USER.EXE file to your Windows SYSTEM
   subdirectory, your registered user and company name will be blank.

<P><LI>Reset the read-only file attributes on the shared Windows files using
   the MS-DOS ATTRIB command.

<P><LI>If you use Novell NetWare connectivity, do the following:
<P>
   a. Use a text editor (such as Windows Notepad) to open your SYSTEM.INI
<P><PRE>      file.
</PRE><P>
   b. In the [386Enh] section, change DEVICE=VTDA.386 to DEVICE=*VTD.
<P>
   c. Save the file and quit the text editor.
<P>
</OL><h2>DISK LOCATION OF FILES TO EXPAND</h2>
 
<P>
<PRE>                                        Disk Number
Filename      5.25-inch, 1.2-MB    3.5-inch, 1.44-MB    3.5-inch, 720K
</PRE></OL> 
<P>
<PRE>COMMDLG.DL_            4                     4                    10
GDI.EX_                1                     1                     3
KRNL386.EX_            2                     2                     4
PSCRIPT.DR_            7                     6                    11
SHELL.DL_              5                     4                     8
UNIDRV.DL_             7                     6                    12
USER.EX_               3                     2                     2
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kb3rdparty kbfile kbappnote kbsetup<BR>
KBSubcategory: win31<BR>
Additional reference words: appnote 3.10 3.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
