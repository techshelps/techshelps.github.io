

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Running Windows for Workgroups on a DEC Pathworks Network </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97737 ">
<META NAME="KBModify" CONTENT="1996/04/25">
<META NAME="KBCreate" CONTENT="1993/04/20">
<META NAME="Keywords" CONTENT="kbnetwork kbsetup kb3rdparty kbfasttip kbpolicy">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" This article contains information about using Windows for Workgroups with third-party products or configurations that have not been tested and are not supported by Microsoft.  If the steps described in this article do not function properly, use a su...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWQ,QBWN,QAVZ,QBFY,QAA1,QAB9,QDIV,QBXT,QA5V,QAIB,QDI2,QAPF,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Running Windows for Workgroups on a DEC Pathworks Network</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97737 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
This article contains information about using Windows for Workgroups
with third-party products or configurations that have not been tested
and are not supported by Microsoft.
<P>
If the steps described in this article do not function properly, use
a supported configuration or contact the manufacturer of your
third-party product for more information.
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although Digital Equipment Corporation (DEC) Pathworks has not been
tested with Windows for Workgroups and its use is not supported with
Windows for Workgroups, you can integrate the two networks following
the appropriate procedure in this article.
<P>
Please note that separate procedures are provided for Windows for
Workgroups 3.11 and Windows for Workgroups 3.1.
<P>
<P>
<P><h2>WINDOWS FOR WORKGROUPS 3.11 PROCEDURE</h2>
 
<P>
To properly set up Windows for Workgroups version 3.11 with DEC
Pathworks, do the following:

<OL><P><LI>Get DEC Pathworks version 4.0 or later running at the MS-DOS level.

<P><LI>Obtain the file DECNB.386 from DEC.

<P><LI>Install Windows for Workgroups 3.11

<P><LI>Select DEC Pathworks under the "Install Windows support for the
   following network only" option.
<P>
   NOTE: There are two options for DEC Pathworks: Version 4.0 and
   Version 4.1 and later. Be sure to select the correct option.
<P>
<P>
</OL><h2>WINDOWS FOR WORKGROUPS 3.1 PROCEDURE</h2>
 
<P>
The procedure below describes the steps necessary to enable the
Windows for Workgroups 3.1 full redirector to connect to DEC Pathworks
running on an Ethernet network. For additional configuration options
(such as Token Ring, asynchronous DECnet, or the Windows for
Workgroups basic redirector), call DEC Technical Support at (800)
332-8000.
<P>
This procedure assumes the following conditions are true:

<UL><LI>DEC Pathworks is installed in the C:\DECNET directory.
<LI>Windows for Workgroups is installed in the C:\WINDOWS directory.
<LI>Your boot drive is drive C.
<P>
</UL>If your system configuration differs, substitute the correct paths
where necessary.
<P>
<P><h3>To Integrate DEC Pathworks and Windows for Workgroups 3.1</h3>
 

<OL><P><LI>Make backup copies of the following files:
<P>
<P><PRE>      AUTOEXEC.BAT
      CONFIG.SYS
      STARTNET.BAT
      PROTOCOL.INI
      SYSTEM.INI
</PRE><P>
   If you encounter any problems during this procedure, you can restore
   these files and return to your original working configuration.

<P><LI>In Windows for Workgroups Control Panel, choose the Network icon.
   Choose the Networks button and remove all the networks listed in
   the Other Networks In Use box. Choose the OK button twice to close
   the Compatible Networks and Network Settings dialog boxes. When
   prompted to restart Windows, choose the Continue button. Quit
   Windows for Workgroups, but do not restart your computer.

<P><LI>Open your AUTOEXEC.BAT file in a text editor, such as MS-DOS
   Editor, and make the following changes:
<P>
   a. Insert the REM command at the beginning of the NET START command
<P><PRE>      line. For example, change
</PRE><P>
<PRE>         c:\windows\net start

      -to-

         rem c:\windows\net start

   b. If the Pathworks directory is not already included in your PATH
      statement, add it. For example, change

         path c:\windows;c:\dos;

      -to-

         path c:\windows;c:\dos;c:\decnet;

</PRE><P><LI>Open your CONFIG.SYS file in a text editor and make the following
   changes:
<P>
   a. Insert the REM command at the beginning of the PROTMAN.SYS
<P><PRE>      DEVICE command line. For example, change
</PRE><P>
<PRE>         device=c:\decnet\protman.sys /i:c:\decnet

      -to-

         rem device=c:\decnet\protman.sys /i:c:\decnet

      NOTE: The CONFIG.SYS file contains two files with similar names:
      PROTMAN.SYS and PROTMAN.DOS. PROTMAN.SYS is the protocol manager
      for Pathworks, which you just disabled. PROTMAN.DOS is the
      protocol manager for Windows for Workgroups and should not be
      altered.

   b. Add a DEVICE command line to load the Pathworks file,
      DLLNDIS.EXE, before the line that loads WORKGRP.SYS. For
      example, change

         device=c:\windows\elnkii.dos
         device=c:\windows\workgrp.sys

      -to-

         device=c:\windows\elnkii.dos
         device=c:\decnet\dllndis.exe
         device=c:\windows\workgrp.sys

      NOTE: The file ELNKII.DOS may differ depending on the type of
      network interface card (NIC) you use.

</PRE><P><LI>The following two steps require that you use a text editor that has
   a cut and paste feature, such as MS-DOS Editor.
<P>
   a. Open the C:\DECNET\PROTOCOL.INI file, and cut the [DATALINK]
<P><PRE>      section (including its title, [DATALINK]).
</PRE><P>
   b. Open the C:\WINDOWS\PROTOCOL.INI file, position the insertion
<P><PRE>      point at the end of the file and paste in the [DATALINK]
      section. Do not close PROTOCOL.INI or quit the text editor.
</PRE>
<P><LI>Make the following additional changes to your
   C:\WINDOWS\PROTOCOL.INI file:
<P>
   a. Modify the BINDINGS statement in the [DATALINK] section so that
<P><PRE>      it is the same as the BINDINGS statement for your other
      transports. For example, change
</PRE><P>
<PRE>         bindings=elnkii.dos

      -to-

         bindings=ms$elnkii

      NOTE: In most cases, NetBEUI is your Windows for Workgroups
      transport. If this is the case, simply copy the BINDINGS
      statement from the [NetBEUI] section to the [DATALINK] section,
      and insert the REM command at the beginning of the original
      BINDINGS statement in the [DATALINK] section. For a more
      complete example of this modification, see the "Sample
      PROTOCOL.INI" section below.

   b. In the [DATALINK] section, make sure that the NI_IRQ statement
      is set to the same value as the INTERRUPT statement in your
      network card section. For example, if your network card section
      appears as follows

         [ms$elnkii]
         drivername=elnkii$
         interrupt=3
         ...

      change the NI_IRQ statement to read

         [DATALINK]
         ni_irq=3

   c. In the [NETWORK.SETUP] section, copy the LANA line for NetBEUI,
      and paste it on the next line. The line you paste should look
      similar to the following:

         lana0=ms$ewtrbtp,1,ms$netbeui

      NOTE: The first parameter, MS$EWTRBTP in this example, varies
      depending on the NIC you use.

   d. In the line you pasted, increase the LANA number by one and
      replace the last parameter, MS$NETBEUI with DATALINK. The
      resulting line should look similar to the following:

         lana1=ms$ewtrbtp,1,datalink

</PRE><P><LI>Open the STARTNET.BAT file in a text editor and make the following
   changes:
<P>
   a. Find the line that contains the NETBIND command and insert the
<P><PRE>      REM command at the beginning of the line. For example, change
</PRE><P>
<PRE>         %boot%\decnet\netbind

      -to-

         rem %boot%\decnet\netbind

   b. Add the NET START command after the line loading NETBIND. For
      example, change

         rem %boot%\decnet\netbind

      -to-

         rem %boot%\decnet\netbind
         c:\windows\net start

   c. Disable the command that starts the Pathworks redirector,
      REDIR.EXE, using the REM command. For example, change

         %boot%\decnet\redir5.exe

      -to-

         rem %boot%\decnet\redir5.exe

   d. Disable the command that loads the DLLNDIS driver using the REM
      command. For example, change

         %boot%\decnet\dllndis

      -to-

         rem %boot%\decnet\dllndis

   e. Locate the command lines that load DNNETH.EXE and add the /LANA
      switch to specify which LANA the DECnet protocol is using. (This
      is the same number you changed in step 6d; it is the LANA number
      for the DATALINK protocol.) For example, change

         %boot%\decnet\dnneth.exe /rem:2
         if errorlevel 1 %boot%\decnet\dnneth.exe /rem:2

      -to-

         %boot%\decnet\dnneth.exe /rem:2 /lana:1
         if errorlevel 1 %boot%\decnet\dnneth.exe /rem:2 /lana:1

   f. Locate the following section for the Pathworks redirector:

         echo -----------------------------------------------
         echo using basic redirector
         echo -----------------------------------------------

      Insert the line, GOTO TIMEDONE, as follows:

         goto timedone
         echo -----------------------------------------------
         echo using basic redirector
         echo -----------------------------------------------

   g. If you use LAT and/or CTERM, add the appropriate line(s) after
      the :TIMEDONE label. For example, if you want to add LAT, add
      the following lines:

         :timedone
         c:\decnet\lat.exe

      Or, if you want to add CTERM, add the following lines:

         :timedone
         c:\decnet\cterm.exe

      NOTE: If you plan to use LAT, LAD, and/or CTERM, you must copy
      the LAT.EXE, LAD.EXE, and/or CTERM.EXE files from the Pathworks
      PCSAV41 file service before you reboot.

</PRE><P><LI>Open your SYSTEM.INI file in a text editor and make the following
   changes:
<P>
   a. In the [386Enh] section, find the NETWORK statement and add the
<P><PRE>      virtual network driver DECNET.386 as follows:
</PRE><P>
<PRE>         [386enh]
         network=vnetbios.386,...,decnet.386

      NOTE: The DECNET.386 file is not included with Windows for
      Workgroups. If you have Windows version 3.1, it is located on
      Disk 2. If you are upgrading over a previous Windows
      installation that was set up for Pathworks, this file should
      already be in your WINDOWS\SYSTEM subdirectory. If this is a new
      Windows for Workgroups installation and you do not have Windows
      3.1, DECNET.386 is available from the DECPCI forum on CompuServe
      or from DEC Technical Support.

   b. Add the following statement to the [386Enh] section:

         timercriticalsection=10000

</PRE></OL>After you restart your machine, you can connect to DEC Pathworks
servers as well as other machines in your Windows for Workgroups
workgroup. If you cannot connect to your DEC Pathworks network,
contact DEC Technical Support.
<P>
NOTE: Pathworks servers do not appear in the list of shared
directories because they are not included in the Windows for
Workgroups network browsing system. To connect to a Pathworks server,
you must type the name of the server and share name.
<P>
<P>
<P><h3>Sample PROTOCOL.INI</h3>
 
<P>
The sample PROTOCOL.INI file below has been modified by following the
previous steps. Comments on modifications appear in parentheses to the
right of statements. This file was taken from a system using NetBEUI
installed on a 3Com EtherLink II NIC.
<P>
[network.setup]
<PRE>   version=0x0000
   netcard=ms$elnkii,1,MS$ELNKII
   transport=ms$netbeui,MS$NETBEUI
   lana0=ms$elnkii,1,ms$netbeui
   lana1=ms$elnkii,1,DATALINK

</PRE>[protman]
<PRE>   DriverName=PROTMAN$

[MS$ELNKII]              (NIC section)
   DriverName=ELNKII$
   INTERRUPT=3
   IOADDRESS=0x300
   MAXTRANSMITS=12
   TRANSCEIVER=onboard   (thin Ethernet cable)

[MS$NETBEUI]             (NetBEUI transport section)
   DriverName=netbeui$
   SESSIONS=6
   NCBS=12
   BINDINGS=MS$ELNKII
   LANABASE=0

[DATALINK]               (DEC Pathworks transport)
   DRIVERNAME=DLL$MAC
   LG_BUFFERS=16
   SM_BUFFERS=6
   OUTSTANDING=32
   HEURISTICS=0
   BINDINGS=MS$ELNKII    (changed to match NetBEUI BINDINGS line)
   NI_IRQ=3              (changed to match NIC INTERRUPT line)


</PRE><h2>REFERENCES</h2>
 
<P>
DEC Technical Support can be reached by calling (800) 332-8000. DEC
provides a detailed document titled "PATHWORKS for DOS and Windows for
Workgroups Installation Guide," which describes how to configure
Windows for Workgroups and a Pathworks network for compatibility. The
document provides information on the following configurations and
topics:
<P>
<PRE>   Physical Media:

      Ethernet
      Token Ring
      Asynchronous DECnet
      DECnet

   Protocols:

      DECnet
      Pathworks NetWare Coexistence
      Digital's LAST/LAD
      Pathworks NetBEUI
      Windows for Workgroups NetBEUI
      Windows for Workgroups Novell

   Miscellaneous:

      Running Windows for Workgroups Novell IPX on Digital's Ethernet
      Connecting to Pathworks for VMS or Pathworks for Ultrix
      Setting up Local Area Disk (LAD) Support
      Using InfoServers

</PRE>You can download "PATHWORKS for DOS and Windows for Workgroups
Installation Guide" from the DECPCI forum on CompuServe, or you can
call DEC Technical Support.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbsetup kb3rdparty kbfasttip kbpolicy<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: 3.10 3.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
