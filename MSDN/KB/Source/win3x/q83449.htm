

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 3.1 Serial Communications Q &amp; A Part 1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83449 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/04/13">
<META NAME="Keywords" CONTENT="kbusage kbdisplay">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  This article contains specific questions and answers regarding the Microsoft Windows operating system version 3.1.  MORE INFORMATION  1. Q. How does Windows 3.1 improve serial communications over Windows       3.0?  1. A. Most of the serial communi...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJ9,QDL9,QBWN,QBWO,QBWQ,QABA,QDJP,QAKG,QBTX,QAC2,QAJQ,QBVV,QAKD,QAM4,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 3.1 Serial Communications Q &amp; A Part 1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83449 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains specific questions and answers regarding the
Microsoft Windows operating system version 3.1.
<P>
<P><h2>MORE INFORMATION</h2>
 

<PRE>1. Q. How does Windows 3.1 improve serial communications over Windows
      3.0?

</PRE><P><LI>A. Most of the serial communications problems experienced by users
<P><PRE>      of Windows 3.0 were corrected in Windows 3.1. The following is a
      summary of the changes:
</PRE><P>
<P><PRE>      a. COM port addresses and IRQs are configurable in the Control Panel.
      Windows 3.0 uses preset address values for serial ports. Windows 3.1
      allows any port address and IRQ. This corrects problems using ports
      COM3 and COM4 (Windows 3.0 uses non-standard default values).
</PRE><P>
<P><PRE>      NOTE: If the communication settings in Terminal do not match those
      specified in Control Panel, Terminal's settings take precedence.
      The Advanced port settings, however, affect all applications
      including Terminal. Therefore, if you experiencing problems when
      using Terminal, verify the I/O base address and IRQ settings in
      Control Panel.
</PRE><P>
<P><PRE>      b. Faster bit rates. Windows-based applications can now set speeds
      higher than 19.2 kilobits per second (Kbps) and up to 57.6 Kbps.
      Contact the application manufacturer for an update to support this
      new feature.
</PRE><P>
<P><PRE>      c. Reduced system overhead. Windows 3.1 is fine tuned for better
      overall performance, including faster throughput and fewer errors
      during serial communications. A new driver interface allows Windows
      to pass data in blocks to the driver, rather than one character at a
      time. See the Windows 3.1 Device Development Kit (DDK) for details.
</PRE><P>
<P><PRE>      d. 16550 UART support for Windows-based applications. This is
      described in detail below.
</PRE><P>
<P><PRE>      e. EnableCommNotification API. Windows-based applications can
      register to be notified by a window message when serial port events
      occur, rather than performing constant polling. (Constant polling
      reduces overall system performance.)
</PRE><P>
<P><PRE>      f. Serial ports on the same IRQ can be used in rotation. On most
      personal computers, serial ports that use the same IRQ cannot be used
      simultaneously; however, Windows 3.0 sometimes prevented them from
      being used in rotation, one after another. This problem was corrected
      in Windows 3.1.
</PRE><P>
<P><PRE>      g. Full duplex improvements. Some users experienced lockups during
      full-duplex transfers at fast bit rates with Windows 3.0. These
      problems were corrected in Windows 3.1.
</PRE>
<PRE>2. Q. How many serial ports does Windows support?

</PRE><P><LI>A. The Windows 3.1 communications driver provides access to
<P><PRE>      standard MS-DOS serial ports (COM1, COM2, COM3, and COM4). Third-
      party serial adapters with more than four ports can be used in
      Windows with special drivers available from their manufacturers.
      Windows allows a maximum of nine serial ports (COM1-COM9).
</PRE>
<PRE>3. Q. What base addresses and IRQs does Windows use for serial ports?

</PRE><P><LI>A. Windows must know the base I/O addresses and interrupt request
<P><PRE>      lines (IRQs) of the serial ports on a personal computer. Windows
      determines this as follows:
</PRE><P>
<P><PRE>      a. Windows looks in the BIOS data area (40:0) first for port base
      addresses. Most personal computers specify address values here for
      built-in COM ports, but not for add-in adapters. If Windows finds an
      address here, it uses this, rather than any other defaults or
      settings.
</PRE><P>
<P><PRE>      b. Serial ports commonly use the following base I/O address and IRQ
      values:
</PRE><P>
<PRE>         Port     Address  IRQ
         ----     -------  ---
         COM1 *    03F8      4
         COM2      02F8      3
         COM3      03E8      4
         COM3(PS/2)3220      3
         COM4      02E8      3

      *If the BIOS data area specifies the COM1 address as 02F8, Windows
       uses IRQ3 instead of IRQ4.

      c. Control Panel Ports Advanced dialog box. The addresses and IRQs of
      ports can be identified, although they are not specified, in the BIOS
      data area. Addresses and IRQs are modified by opening the Control
      Panel, choosing the Ports icon, and selecting the Advanced button.
      Here you can set the COMxBase and COMxIRQ values in the [386Enh]
      section of SYSTEM.INI file. IRQ values 8-15 are allowable entries.
      Setting the port address in this dialog box does not override a BIOS
      data area value.

      For more information on COMxBase and other SYSTEM.INI file switches,
      refer to the SYSINI.WRI file in the WINDOWS directory.

4. Q. Windows 3.0 did not recognize the COM3 and the COM4 ports. The
      COM3Base and COM4Base settings in SYSTEM.INI have been changed;
      however, this has not helped. Is this problem fixed in Windows 3.1?

</PRE><P><LI>A. Yes. The problem in Windows 3.0 is that the communications
<P><PRE>      driver (COMM.DRV) and virtual communications device (VCD) weren't
      using the same values. Now, both modules use the specified values.
      The SYSTEM.INI file should no longer be modified manually. Instead,
      use the Advanced dialog box in the Control Panel (accessed through
      the Ports icon). These settings apply to both standard and 386
      enhanced modes.
</PRE>
<PRE>5. Q. When can the same IRQ be used for different serial ports?

</PRE><P><LI>A. In general, two devices should not be used simultaneously with
<P><PRE>      the same IRQ. For example, if COM1 and COM3 ports both use IRQ4 (the
      common value), problems arise if a serial mouse is on COM1 and a
      modem is on COM3.
</PRE><P>
<P><PRE>      Some personal computers and serial port adapters support IRQ sharing
      (the ability to have multiple ports using the same IRQ). This is
      common on MicroChannel (MCA) bus architecture computers, such as IBM
      PS/2s and some EISA bus computers. Windows 3.1 fully supports IRQ
      sharing serial adapters. To use them correctly, be sure that the IRQ
      values have been set correctly in the Advanced dialog box. Also, if
      the computer does not have MCA or EISA architecture, the setting
      "COMIrqSharing=TRUE" must be set in the [386Enh] section of the
      SYSTEM.INI file. For more information on COMIrqSharing and other
      SYSTEM.INI switches, refer to the SYSINI.WRI file in the WINDOWS
      directory.
</PRE>
<PRE>6. Q. Problems occur when using COM4. What's wrong?

</PRE><P><LI>A. Check the settings in the Advanced dialog box in the Control
<P><PRE>      Panel (accessed through the Ports icon) to make sure that Windows
      knows the correct port address value and IRQ settings for the COM4
      port. The address for COM4 is not usually specified in the BIOS data
      area of most computers because it is not a standard port.
</PRE><P>
<P><PRE>      Many serial adapters use a COM4 default base address of 02E8.
      Unfortunately, this address value conflicts with some peripherals,
      including 8514/A video adapters and certain network adapters. To work
      around this problem, reconfigure one of the peripheral adapters to
      use a different address. If the COM4 address is changed, be sure to
      reset the address value for COM4 in the Advanced dialog box.
</PRE>
<PRE>7. Q. What is "device contention"?

</PRE><P><LI>A. As a multitasking operating system, Windows must handle
<P><PRE>      simultaneous requests for devices, such as COM ports, from different
      applications. "Device contention" refers to the rules Windows uses to
      determine how applications receive control of a device. The 386
      Enhanced dialog of the Control Panel allows the specification of how
      COM ports are allocated to applications.
</PRE><P>
<P><PRE>      The Always Warn option means that Windows displays a dialog box
      asking whether or not an MS-DOS application should receive control of
      a COM port that it detects may be currently in use by another
      application.
</PRE><P>
<P><PRE>      The Never Warn option means that Windows always provides COM port
      access to MS-DOS applications, even if it detects that this port may
      currently be in use by another application.
</PRE><P>
<P><PRE>      The Idle (in sec.) option means that Windows displays a dialog asking
      whether or not an MS-DOS application should receive control of a COM
      port that it detects was in use as recently as the number of seconds
      specified. Otherwise, Windows provides COM port access without a
      warning.
</PRE>
<PRE>8. Q. With Windows 3.0, use of different serial ports on the same IRQ
      in rotation was not possible. Was this problem corrected in Windows
      3.1?

</PRE><P><LI>A. Yes. Serial ports that use the same IRQ (for example, COM1/3 on
<P><PRE>      IRQ4 and COM2/4 on IRQ3) may be used one after the other, but not at
      the same time (unless the serial adapter supports IRQ sharing).
      However, some MS-DOS communication applications may leave a serial
      port in a state that prevents Windows from using its IRQ for other
      ports. The "stuck" communication IRQ may be reset by opening and
      closing the original COM port with a Windows communication
      application, such as Terminal.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbdisplay<BR>
KBSubcategory: win31 wincomm<BR>
Additional reference words: 3.10 COMMQ&amp;A winfest<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
