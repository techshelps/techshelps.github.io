

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Upgrade Installation Fails, Then Setup Doesn't Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92536 ">
<META NAME="KBModify" CONTENT="1995/03/01">
<META NAME="KBCreate" CONTENT="1992/11/09">
<META NAME="Keywords" CONTENT="kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  The Microsoft Windows for Workgroups add-on for Windows 3.1 users does not allow a new installation of Windows for Workgroups; it is an upgrade for Microsoft Windows version 3.1 only.  If the upgrade fails during installation, you may not be able t...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAA1,QDI2,QDL9,QBWN,QBWQ,QAC1,QDIZ,QAA5,QBXT,QA5V,QAIB,QBVV,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Upgrade Installation Fails, Then Setup Doesn't Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92536 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Windows for Workgroups add-on for Windows 3.1 users does
not allow a new installation of Windows for Workgroups; it is an
upgrade for Microsoft Windows version 3.1 only.
<P>
If the upgrade fails during installation, you may not be able to run
SETUP.EXE again. To work around this problem, remove the SETUPSTATE=
line from the [BOOT.DESCRIPTION] section of the SYSTEM.INI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
During the upgrade process, SETUP.EXE adds the line
<P>
<PRE>   SETUPSTATE=

</PRE>to the [BOOT.DESCRIPTION] section of the SYSTEM.INI file. When this
line is present, SETUP.EXE does not allow the installation of Windows
for Workgroups, and the following error message will be displayed:
<P>
<PRE>   Windows 3.1 could not be located on your computer. This version of
   Windows for Workgroups requires that Windows 3.1 already be
   installed. You must either install Windows 3.1 on your computer,
   or purchase the complete version of Windows for Workgroups.

</PRE>To allow Windows for Workgroups to install correctly (provided you
have Windows 3.1 on your computer), remove the SETUPSTATE= line.
<P>
NOTE: The failed upgrade installation may also leave the following
line in the SYSTEM.INI:
<P>
<PRE>   SHELL=SETUP.EXE

</PRE>The statement should be SHELL=PROGMAN.EXE. You may need to make this
change as well.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: 3.1 3.10 win.ini reinstall setup set up setting<BR>
re-install fail resetup re-setup previous error<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 1, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
