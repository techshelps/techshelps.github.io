

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WFWG: Creating a New SYSTEM.INI Without Third-Party Drivers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107131">
<META NAME="KBModify" CONTENT="1995/01/24">
<META NAME="KBCreate" CONTENT="1993/11/15">
<META NAME="Keywords" CONTENT="kbusage kbenv kb3rdparty kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  You can use your original Microsoft Windows for Workgroups version 3.1 or 3.11 disks to create a new SYSTEM.INI file for your specific hardware and version of the network operating system.  Creating a new SYSTEM.INI file can be useful for troublesh...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QANE,QDL9,QBWQ,QBWN,QAVZ,QDIO,QACF,QBXT,QBXS,QA5V,QAIB,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WFWG: Creating a New SYSTEM.INI Without Third-Party Drivers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 24, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107131</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use your original Microsoft Windows for Workgroups version 3.1 or
3.11 disks to create a new SYSTEM.INI file for your specific hardware and
version of the network operating system.
<P>
Creating a new SYSTEM.INI file can be useful for troubleshooting or for
replacing a damaged or deleted SYSTEM.INI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a new SYSTEM.INI file that does not contain references to third-
party device drivers but that is configured for your specific hardware, do
the following:

<OL><P><LI>Rename the SYSTEM.INI file to SYSTEM.BKP.

<P><LI>Expand the file SYSTEM.SR_ from the original Windows for Workgroups
    3.1 or 3.11 disks to your Windows directory (usually C:\WINDOWS) by
    typing the following at the MS-DOS command prompt and pressing
    ENTER:
<P>
       c:\windows\expand a:system.sr_ c:\windows\system.ini
<P>
    NOTE: For Windows for Workgroups 3.1, this file is located on Disk 3
    for both the 1.44-megabyte (MB) 3.5-inch and 1.2-MB 5.25-inch disk
    sets. For Windows for Workgroups 3.11, this file is located on Disk 2
    for both the 1.44-MB 3.5-inch and 1.2-MB 5.25-inch disk sets.

<P><LI>Change to the Windows for Workgroups drive and then change to the
    Windows directory. For example, at the MS-DOS command prompt, type
    the following, pressing ENTER after each line:
<P>
       c:
       cd \windows

<P><LI>To start the MS-DOS portion of Windows for Workgroups Setup, type
    "setup" (without the quotation marks) at the MS-DOS command prompt.

<P><LI>The options are either blank or contain some incorrect defaults
    similar to the following:
<P>
<PRE>       Keyboard:   keyboard.typ
       Codepage:   woafont.fon

    Select the correct hardware options for your system.

</PRE><P><LI>Accept the changes.
<P>
    NOTE: When you accept the changes, you are given the option to have
    Setup copy new drivers.

<P><LI>Open the new SYSTEM.INI file in a text editor, such as MS-DOS 6.0
    or 6.2 Editor. Make the following changes to the SYSTEM.INI file:
<P>
     - Add PROGMAN.EXE to the SHELL= line in the [boot] section.
<P>
     - Remove or remark out the TASKMAN.EXE= line in the [boot]
       section.
<P>
     - Add the following NETWORK.DRV= line to the [boot] section:
<P>
<PRE>          [boot]
          Network.drv=wfwnet.drv

     - For Windows for Workgroups 3.1, change the network= line in the
       [386Enh] section to the following:

          [386Enh]
          network=vnetbios.386,vnetsup.386,vredir.386,vserver.386,
          vbrowse.386,vwc.386

     - For Windows for Workgroups 3.11, change the network= line in the
       [386Enh] section to the following:

          [386Enh]
          network=*vnetbios,vnetsup.386,vredir.386,vserver.386,*vwc

       NOTE: The network= setting in the [386Enh] section of the SYSTEM.INI
       file should be on one line and should not contain spaces or wrapping
       around the second line.

    - To enable 32-bit disk access, add the following lines to the
      [386Enh] section:

         32BitDiskAccess=&lt;Boolean&gt;
         device=*int13
         device=*wdctrl

      NOTE: To enable 32-bit disk access, replace &lt;Boolean&gt; with "True"
      (without the quotation marks). If you do not want 32-bit disk access
      enabled, replace &lt;Boolean&gt; with "False" (without the quotation
      marks).

      For more information about 32-bit disk access, see Appendix D in
      the Windows Resource Kit, or query on the following words in the
      Microsoft Knowledge Base:

          Windows and 3.1 and 32-bit and disk and access

</PRE><P><LI>Start Windows for Workgroups without attempting to load any network
    drivers:
<P>
    - To start Windows for Workgroups 3.1 in standard mode, type the
      following at the MS-DOS command prompt:
<P>
      win /s
<P>
      NOTE: Standard mode is not accessible in Windows for Workgroups
      3.11.
<P>
    - For Windows for Workgroups 3.11, type the following at the MS-DOS
      command prompt:
<P>
      win /n

<P><LI>In the Main group, choose Control Panel and then choose the Network
    icon.
<P>
    For Windows for Workgroups 3.11, open the SYSTEM.INI file in a text
    editor, such as Notepad.

<P><LI>Add the workgroup and computer names.
<P>
    For Windows for Workgroups 3.11, add the ComputerName= and Workgroup=
    settings in the [Network] section.

<P><LI>In Windows for Workgroups 3.1, do the following:
<P>
    - Choose the Adapters button.
<P>
    In Windows for Workgroups 3.11, do the following:
<P>
    - Choose the Network Setup icon in the Network group, then choose the
      Drivers button.

<P><LI>Add the network interface card (NIC).
<P>
    NOTE: You may need to first remove and then reinstall the NIC driver.

<P><LI>When Windows prompts you to restart the computer, choose the
    Continue button.

<P><LI>Exit Windows and restart Windows in 386 enhanced mode.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbenv kb3rdparty kbtlc<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: 3.10 3.11 re-create recreate rebuild rebuilding<BR>
system.src 3rdparty clean<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 24, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
