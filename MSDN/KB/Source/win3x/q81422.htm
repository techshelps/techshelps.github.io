

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>No Expanded Memory in MS-DOS-Based Applications w/ Windows 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81422 ">
<META NAME="KBModify" CONTENT="1996/07/29">
<META NAME="KBCreate" CONTENT="1992/03/05">
<META NAME="Keywords" CONTENT="kbenv kbfile kbappnote">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  If MS-DOS-based applications running under Windows version 3.0 386 enhanced mode do not see any expanded memory, the EMS settings in the PIF file may need to be increased. Increasing the EMS-required above 700K in the PIF Advanced Options box may a...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBW6,QBWQ,QABA,QBAO,QAM4,QAJH,QA26,QBVV,QALM,QAGQ,QBWC,QBDM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>No Expanded Memory in MS-DOS-Based Applications w/ Windows 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81422 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If MS-DOS-based applications running under Windows version 3.0 386 enhanced
mode do not see any expanded memory, the EMS settings in the PIF file may
need to be increased. Increasing the EMS-required above 700K in the PIF
Advanced Options box may allow the applications to use expanded memory. The
following is an example of increasing the EMS settings:
<P>
<PRE>   Settings                Required       Desired
   ----------------------------------------------

   Default settings:       0K             1024K
   Increased settings:     1024K          2048K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>EMS Settings</h3>
 
<P>
The EMS settings must increased because of the way expanded memory is
counted in Microsoft Windows version 3.0. Windows 3.0 supports LIM version
4.0 expanded memory. LIM 4.0 expanded memory counts conventional memory as
expanded in a virtual machine.
<P>
MS-DOS-based applications use only LIM version 3.2 expanded memory. LIM 3.2
expanded memory does not count the conventional memory that it operates in.
As a result, the MS-DOS-based application displays approximately 400K less
expanded memory than is allocated through the Advanced PIF settings.
<P>
The difference between how LIM 3.2 and LIM 4.0 memory is counted results in
the higher EMS settings under Windows 3.0 than would normally be expected.
<P>
<P><h3>Hardware Considerations</h3>
 
<P>
Note that modifying the Advanced PIF settings cannot override hardware or
software conflicts. It may be necessary to use an EMMEXCLUDE statement to
prevent the EMS page frame from conflicting with network cards or other
hardware in the system. A 64K contiguous block of upper memory is required
for windows to create an expanded memory page frame.
<P>
<P><h3>Additional Considerations</h3>
 
<P>
There is a problem with the Expanded Memory Manager in Windows 3.0. If the
minimum EMS required is set to above 0, Windows will not release this
memory back to the minimum memory size pool. To work around this, set the
minimum EMS required to 0. This forces Windows to use memory from the
Global EMS Memory Pool (memory it releases when it doesn't need it).
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows version
3.0. This problem is corrected in version 3.1.
<P>
More information on Windows 3.0 and 3.1 and expanded memory can be found in
the Microsoft Application Note "Memory Management with Windows" (WW0335).
For more information about obtaining this Application Note, query on the
following words in the Microsoft Knowledge Base:
<P>
<PRE>   ww0335 and appnote
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kbfile kbappnote<BR>
KBSubcategory: win30 winmem<BR>
Additional reference words: appnote 3.00 3.00a 3.0 3.0a WW0335 S12782<BR>
softlib<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
