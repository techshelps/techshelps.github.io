

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Configuring SMARTDRV.EXE 4.0 DOUBLE_BUFFERING Properly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82856 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/04/01">
<META NAME="Keywords" CONTENT="kbsetup kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Failure to use the double-buffering feature of the SMARTDrive (SMARTDRV.EXE) utility included with the Microsoft Windows version 3.1 when this feature is required may cause MS-DOS virtual machines to crash, Windows to crash at startup, and other ra...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAHH,QBWQ,QA1S,QBVV,QAO4,QBW6,QDKI,QAIJ,QAFO,QDN9,QAKP,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Configuring SMARTDRV.EXE 4.0 DOUBLE_BUFFERING Properly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82856 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Failure to use the double-buffering feature of the SMARTDrive
(SMARTDRV.EXE) utility included with the Microsoft Windows version 3.1
when this feature is required may cause MS-DOS virtual machines to crash,
Windows to crash at startup, and other random operational problems.
<P>
The Windows Setup program attempts to install the double-buffering
portion of SMARTDrive if Windows detects that it is needed. These
problems may occur if the DOUBLE_BUFFERING entry is disabled in the
CONFIG.SYS file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To verify whether the SMARTDrive utility is necessary, enter the
following command at the MS-DOS command prompt:
<P>
<PRE>   smartdrv

</PRE>If all of the buffering entries list "no", then double buffering is
not necessary. If the double-buffering entry is contained within the
CONFIG.SYS file, it may be disabled. The entry in the AUTOEXEC.BAT
file should not be disabled.
<P>
If the 32-Bit Disk Access option is available, then double-buffering
is probably not necessary. If the 32-Bit Disk Access option is not
available, the following command line should be present in the
CONFIG.SYS file
<P>
<PRE>   DEVICE=C:\WINDOWS\SMARTDRV.EXE /DOUBLE_BUFFER

</PRE>where C is the drive and Windows is the directory location of the
Windows 3.1 SMARTDrive utility.
<P>
If at any time the buffering entries list "yes", then the problem has
been corrected. If the entry "-" appears in the DEVICE= buffering
line, SMARTDrive hasn't yet determined if double buffering is
necessary. This entry may be forced to change (from a "-" to a "yes"
or a "no") by one of the following methods:

<OL><P><LI>Loading drivers or TSRs (terminate-and-stay-resident) programs into
   UMBs (upper memory blocks).

<P><LI>Run Windows and start multiple instances of MS-DOS virtual
   machines. This may not trigger it to change, however, because only
   certain types of writes (DMA into linear != physical memory) will
   cause the buffering to start. If problems occur and the line still
   says "-",  then this is most likely not the problem.
<P>
</OL>Some disk ROM BIOS versions cause Windows to crash when multitasking
occurs. (Technically, this occurs when a page-fault or instance fault
occurs during a read of memory-mapped I/O). Double buffering usually
works around this problem because faults will not occur on the double
buffer. In these cases, double buffering can be forced to start by
adding a plus sign (+) to the end of the command line in the
CONFIG.SYS file as follows
<P>
<PRE>   DEVICE=C:\WINDOWS\SMARTDRV.EXE /DOUBLE_BUFFER+

</PRE></OL>where C is the drive and Windows is the directory location of the
Windows 3.1 SMARTDrive utility.
<P>
Usually, a better approach is to disable the 32-Bit Disk Access option
and use a temporary swap file.
<P>
If the machine continues to exhibit random operational problems while
the 32-Bit Disk Access option is disabled, install the DOUBLE_BUFFER+
entry into the CONFIG.SYS file. Because "instance faults" on the
double buffer may still occur, the complete solution is to load a 4K
memory buffer before and after the double-buffer line in the
CONFIG.SYS file. (Most any driver will work, as long as it does not
contain Windows instance data. The idea is to ensure there is no
Windows instance data in the same 4K page[s] as the double buffer.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbenv<BR>
KBSubcategory: win31 winboot winmem<BR>
Additional reference words: 3.10<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
