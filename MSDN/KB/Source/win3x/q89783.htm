

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows Err Msg: Insufficient File Handles... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89783 ">
<META NAME="KBModify" CONTENT="1996/01/23">
<META NAME="KBCreate" CONTENT="1992/09/30">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty kberrmsg kbtshoot kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  When an MS-DOS-based application is run from Microsoft Windows in 386 enhanced mode, the following error messages may occur:     Insufficient file handles, Increase Files in the CONFIG.SYS     -and/or-     Cannot find file; check to ensure the path...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAVZ,QDI2,QDL9,QBWO,QBWN,QBWQ,QAB4,QBWS,QA26,QAKC,QABI,QABA,QBXS,QDKI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows Err Msg: Insufficient File Handles...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89783 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a, 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When an MS-DOS-based application is run from Microsoft Windows in 386
enhanced mode, the following error messages may occur:
<P>
<PRE>   Insufficient file handles, Increase Files in the CONFIG.SYS

   -and/or-

   Cannot find file; check to ensure the path and filename are correct

</PRE><h2>WORKAROUND</h2>
 
<P>
If the problem occurs while running on a network, check to be sure
that the network is correctly installed. Refer to "Troubleshooting a
Network Setup," below.
<P>
If the problem is not related to the network setup, try increasing the
number of files in the CONFIG.SYS file (FILES=&lt;number&gt;) or in the
SYSTEM.INI file (PerVMFILES=&lt;number&gt;) to  solve the problem. Refer to
"Additional Troubleshooting," later in this article.
<P>
<P><h3>Troubleshooting a Network Setup</h3>
 

<OL><P><LI>Confirm that you have the proper network and version installed,
   as follows:
<P>
   a. Choose the Windows Setup icon from the Program Manager Main group.
<P>
   b. The Windows Setup dialog box is displayed. This dialog box
<P><PRE>      identifies the type of network that you have installed on
      your system. If the dialog box says "No Network Installed,"
      You need to install the proper network.
</PRE><P>
<P><PRE>      If the network is correctly installed, go to step 2.
</PRE><P>
   c. To install the correct network, from the Options menu, select
<P><PRE>      "Change System Settings..." and press ENTER.
</PRE><P>
   d. Under the Networks option, select the proper network from the
<P><PRE>      list provided, then choose OK.
</PRE>
<P><LI>If the problem still occurs under a Novell Network, check to see if
   Windows is set up with the No Network option selected or an
   incorrect network driver. If either of these is the problem, run
   Windows Setup in maintenance mode (run Setup from outside Windows),
   then select and install the correct Novell network.
<P>
   NOTE: This problem occurs if No network is specified for Windows and
   you are connecting to Novell NetWare. Windows works in standard mode
   without the network specified, but it needs needs the virtual device
   drivers to run in enhanced mode.

<P><LI>If the problem still occurs, check to see that IPX.COM and
   NETX.COM files are the correct versions.
<P>
</OL><h3>Additional Troubleshooting</h3>
 
<P>
If the above steps don't work, troubleshoot your file settings as
follows:

<OL><P><LI>Increase the FILES= setting in the CONFIG.SYS file. Informal
   testing has shown that the FILES= statement in the CONFIG.SYS file
   should have a value of at least 45. Increasing this setting
   increases the number of global file handles available to each
   application running in the MS-DOS environment.

<P><LI>This error message may refer to private file handles, which are
   specific to each virtual machine running under Windows. To specify
   the number of private file handles that will be set for each Windows
   virtual machine, place the following statement in the [386enh]
   section of SYSTEM.INI:
<P>
<P><PRE>      PerVMFILES=&lt;number&gt;
</PRE><P>
   Increase the number of files until the application runs without
   displaying the above error message. The default number is 10.

<P><LI>If the above problem occurs when running under a Novell network,
   the SHELL.CFG file may need to be edited to include the following
   line:
<P>
<P><PRE>      FILE HANDLES=60
</PRE><P>
   If the SHELL.CFG file does not exist, use a text editor to create
   it. This file must reside in the same directory as the NETX.COM
   file.
<P>
   NOTE: The sum of the FILES= setting in the CONFIG.SYS file, the
   PerVMFILES= setting in the SYSTEM.INI file, and the FILE HANDLES=
   setting in the SHELL.CFG file cannot exceed 255.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Insufficient file handles can be caused by the following:

<UL><LI>An MS-DOS 5.0 floppy installation (type "setup/f" [without the
   quotation marks]) was performed. This procedure creates a
   CONFIG.SYS file with the statement FILES=10 included. If the system
   is then started with the Startup disk or if CONFIG.SYS from the
   Startup disk is copied to the root directory of the boot drive, the
   above error messages appears in Windows running in 386 enhanced
   mode.

<LI>You are running version 6.0 of the Microsoft Macro Assembler (MASM)
   and the NEW-CONFIG.SYS file was renamed to CONFIG.SYS. This file
   contains the statement FILES=20.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kb3rdparty kberrmsg kbtshoot kbinterop<BR>
KBSubcategory: win31<BR>
Additional reference words: 3.10 3.11 tshoot err msg wp homemm win95<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
