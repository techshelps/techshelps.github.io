

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reinstalling Windows Without Losing Settings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94196 ">
<META NAME="KBModify" CONTENT="1995/07/19">
<META NAME="KBCreate" CONTENT="1992/12/29">
<META NAME="Keywords" CONTENT="kbsetup kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  There may be situations in which you need to reinstall Microsoft Windows to troubleshoot a problem possibly related to file corruption or accidental deletion of files from the Windows directory or the Windows SYSTEM subdirectory. In most cases, it ...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAA1,QBFY,QDI2,QAFI,QAUJ,QABA,QBXB,QATJ,QAGQ,QBAO,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Reinstalling Windows Without Losing Settings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 19, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94196 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There may be situations in which you need to reinstall Microsoft Windows to
troubleshoot a problem possibly related to file corruption or accidental
deletion of files from the Windows directory or the Windows SYSTEM
subdirectory. In most cases, it is not advisable to simply reinstall over
an existing Windows installation because with that procedure, some files
may not be properly updated.
<P>
Installing Windows to a new directory ensures a "clean" installation;
however, any modifications to Windows initialization (.INI) files or the
registration database (REG.DAT) are lost with such an installation. Also,
programs that install files into the Windows directory, such as Microsoft
Word for Windows and Microsoft Excel, cannot run from the new copy of
Windows. Any Windows-based applications must be reinstalled under the new
installation of Windows. Furthermore, any customization of Program Manager
groups, desktop colors and wallpaper, screen-saver settings, and other
user-defined environment settings must be re-created.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to reinstall Windows 3.1 without losing current
settings, such as .INI and REG.DAT file modifications, customized Program
Manager groups (.GRPs), and other desktop settings.

<OL><P><LI>Install Windows into a new directory, such as C:\WIN. Verify that
   Windows runs from this new directory.
<P>
   If Windows ran during installation but does not run from this new
   directory, something has changed on the computer, or file corruption
   has occurred since Windows was installed. The following causes
   should be considered:
<P>
<P><PRE>    - Changes to the path
    - Deletion of files from the Windows directory
    - Low conventional memory
    - File corruption
    - Hardware failures
</PRE>
<P><LI>In this new installation, rename the .GRP files using .GRN, the .INI
   files using .INN, and the .FOT files (located in the Windows SYSTEM
   subdirectory) using .FOZ. Rename the REG.DAT file using REG.DAN. To do
   this, quit Windows and type the following commands at an MS-DOS command
   prompt:
<P>
<P><PRE>      rename c:\win\*.grp *.grn
      rename c:\win\*.ini *.inn
      rename c:\win\reg.dat reg.dan
      rename c:\win\system\*.fot *.foz
</PRE><P>
   NOTE: The *.FOT files have an internal direct path to the *.TTF files,
   which if copied to the old C:\WINDOWS\SYSTEM subdirectory, can create
   problems with the fonts after the C:\WIN directory is removed.

<P><LI>Remove the Read-Only attribute from any files in the C:\WINDOWS and
   C:\WINDOWS\SYSTEM directories. Copy all the files from the new
   installation into the original Windows directory (C:\WINDOWS) by
   typing the following at an MS-DOS command prompt:
<P>
<P><PRE>      attrib -s -h c:\windows\*.* /s
      attrib -r c:\windows\*.* /s
      xcopy c:\win c:\windows /s
</PRE><P>
   If Windows now runs from the C:\WINDOWS directory, the reinstallation
   has been successful, and no settings were lost. To save disk space,
   delete the C:\WIN directory from File Manager or from MS-DOS version 6.0
   or later using the DELTREE command. Also, delete files with the
   extensions .INN, .GRN, and the file REG.DAN in the C:\WINDOWS directory,
   and the files ending with .FOZ in the C:WINDOWS\SYSTEM subdirectory.
<P>
   If Windows does not run, continue with the following steps.

<P><LI>Rename the original .INI files using .INO, and rename the .INN files
   using .INI as follows:
<P>
<P><PRE>      rename c:\windows\*.ini *.ino
      rename c:\windows\*.inn *.ini
</PRE><P>
   Edit the PROGMAN.INI file and replace all occurrences of C:\WIN with
   C:\WINDOWS.
<P>
   If Windows runs now, the problem is being caused by a corruption or
   improper setting in one of the original .INI files. The best solution is
   to back up all data files from Windows-based applications and then
   reinstall the applications. This ensures the correct WIN.INI,
   SYSTEM.INI, and directory settings for each application. Note that you
   must re-create any customization of Program Manager groups and desktop
   settings.
<P>
   To free up disk space, delete excess files as shown in step 3 above.

<P><LI>If Windows does not run now, back up all application data files and
   reinstall the applications under the new Windows installation after
   renaming the .INN, .GRN, .FOZ, and REG.DAN files as follows:
<P>
   rename c:\win\*.inn *.ini
   rename c:\win\*.grn *.grp
   rename c:\win\reg.dan reg.dat
   rename c:\win\system\*.foz *.fot
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Windows Resource Kit," version 3.1, Chart 1.6, "Reinstalling
Windows Without Losing Settings," page 15
<P>
"Getting Started With Microsoft Windows," version 3.1, Chapter 1, "Setting
Up Windows," pages 1-15
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbtshoot<BR>
KBSubcategory: win31<BR>
Additional reference words: tshoot how to preserve 3.10 restore recover<BR>
reinstall re-install save setup<BR>
install rebuild<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 19, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
