

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Communication Port Data Loss in Enhanced-Mode Windows 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q63793 ">
<META NAME="KBModify" CONTENT="1994/11/23">
<META NAME="KBCreate" CONTENT="1990/07/11">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  This article contains information about why MS-DOS applications lose communication-port data when running from enhanced mode in Microsoft Windows version 3.0, and the steps to eliminate this problem.  MORE INFORMATION  Data Loss at 2400 Bits Per Se...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAYY,QALA,QBWQ,QA26,QASR,QAHE,QAK9,QAKR,QAKD,QAJH,QBVV,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Communication Port Data Loss in Enhanced-Mode Windows 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 23, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q63793 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains information about why MS-DOS applications lose
communication-port data when running from enhanced mode in Microsoft
Windows version 3.0, and the steps to eliminate this problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Data Loss at 2400 Bits Per Second (BPS) or Slower</h3>
 
<P>
Communication-port data loss should not occur when using MS-DOS
applications operating at bit rates of 2400 BPS or less. However, data
loss may occur at higher bit rates. If you are experiencing problems
at 2400 BPS or slower, check for a hardware communication-port I/O
base or interrupt assignment conflicts.
<P>
Data Loss at Rates Higher than 9600 BPS
 
<P>
MS-DOS applications cannot use bit rates greater than 9600 BPS when running
under enhanced-mode Windows 3.00. To use higher rates, such as 19,200
BPS, use a Windows-based communications application, such as
FutureSoft's DynaComm Asynchronous, or DCA's CrossTalk for Windows.
<P>
19.2 kilobits per second (Kbps) is the maximum possible data rate for a
Windows-based application.
<P>
Data Loss at 9600 BPS
 
<P>
On many hardware platforms it is not possible to use 9600 BPS in an
MS-DOS application under enhanced mode. This depends on the speed of the
processor and the type of communication-port hardware being used. If
you are experiencing problems at 9600 BPS, take the appropriate steps as
explained below. The steps are different for text only or text/binary data.

<OL><P><LI>Text data only
<P>
   If you are transferring text data ONLY, and your MS-DOS application
   supports XON/XOFF software flow control, you can configure
   enhanced-mode Windows to process the XON/XOFF signals internally.
   This may assist in preventing data loss at 9600 BPS. To enable
   this feature, insert the following line in the [386Enh] section of
   the SYSTEM.INI file:
<P>
<P><PRE>      COMxProtocol=XOFF
</PRE><P>
   where x is the communication port in question. For example, if you
   are using COM1, use COM1Protocol=XOFF. It is important to note that
   this switch does NOT work if you are performing ANY binary data
   transfers, and actually prevents such data from being transferred
   correctly. In addition to adding this switch, you should increase
   the enhanced-mode virtual communication-port buffer size, as detailed
   below (in Step 2).

<P><LI>Binary data, or text and binary data combination
<P>
   If you are transferring any type of binary data, such as
   downloading from a computer bulletin board by modem, you may want
   to increase the enhanced-mode virtual communication-port buffer
   size. This may be done by adding a switch to the [386Enh] section
   of the SYSTEM.INI file, as follows
<P>
<P><PRE>      COMxBuffer=yyy
</PRE><P>
   where x is the communication port in question, and yyy is the
   buffer size in characters (default 128). For example, if you are
   using COM1, and want to increase the buffer size to 256, use
   COM1Buffer=256. Since the buffer default is 128, start with 256 and
   work upward in 128-character increments until the data loss is
   eliminated. Note that data loss cannot be eliminated in all cases;
   in such situations, a Windows communications application should be
   used.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory: win30<BR>
Additional reference words: 3.00 3.0 3.0a 3.00a wincomm win30<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 23, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
