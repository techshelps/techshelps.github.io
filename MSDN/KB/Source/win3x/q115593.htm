

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Remote Access in Windows for Workgroups 3.11 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115593">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1994/05/31">
<META NAME="Keywords" CONTENT="awfax ras wfw wfwg kbfile kbother kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  This article contains a step-by-step guide for troubleshooting Remote Access Services (RAS) in Windows for Workgroups 3.11.  MORE INFORMATION  Steps to Troubleshoot Problems with Remote Access Services  1. Determine whether the modem works at the M...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QBWO,QAS6,QABH,QBXS,QAB4,QAAP,QA1S,QBW6,QAA1,QDL9,QBWQ,QBWN,QBWS,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Remote Access in Windows for Workgroups 3.11</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115593</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.11
WINDOWS
kbtshoot kbfile
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains a step-by-step guide for troubleshooting Remote
Access Services (RAS) in Windows for Workgroups 3.11.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Troubleshoot Problems with Remote Access Services</h3>
 

<OL><P><LI>Determine whether the modem works at the MS-DOS command prompt.
<P>
   Exit Windows and issue the command "Echo ATDT5555555 &gt; COMx" (without
   the quotation marks, where x is the number of the communications port)
   at the MS-DOS command prompt. If you hear the tone from the modem
   dialing 555-5555, proceed to step 2. If you do not hear a dial tone, the
   modem may need to be reconfigured for the correct port address and
   interrupt. Also, if the modem is external, check the serial cable to
   ensure a good connection and make sure the proper cable is being used.
   If the modem is internal, move the modem to a different slot in the
   computer and check the configuration of the jumps on the modem (if any
   exist). Refer to with the modem documentation for setup and technical
   support information.

<P><LI>Determine whether the modem works in Windows Terminal.
<P>
   In the Accessories group, open Terminal and type the command "ATDT"
   (without the quotation marks). If the correct communications (COM) port
   is selected for the modem, a dial tone should be heard and OK or 0
   (zero) should be returned to the modem terminal screen. Pressing ENTER
   should cancel the command to the modem and the message "NO CARRIER"
   should be returned to the screen. If you do not hear a dial tone after
   the ATDT command, choose Communications from the Settings menu to make
   sure the correct Connector (COM Port) setting is selected. If you do not
   see the text echoed back to the screen as you type the command, choose
   Terminal Preferences from the Settings menu and select the Local Echo
   option under Terminal Modes. If the modem does not work in Terminal, the
   modem may not be correctly configured for Windows (or possibly MS-DOS).
   If so, try the following:
<P>
<P><PRE>    - Disable 32-bit file access. To do so, choose the 386 Enhanced icon in
      Control Panel, choose the Virtual Memory button, choose the Change
      button, and then clear the Use 32-Bit Disk Access check box.
</PRE><P>
<P><PRE>    - In the Windows directory, open the SYSTEM.INI file and check the
     [Boot] section for the proper communications driver used globally
     throughout Windows. The line should read, COMM.DRV=COMM.DRV. If
     COMM.DRV= is set to anything other than COMM.DRV, change the line to
     read COMM.DRV=COMM.DRV. Also, make sure the COMM.DRV file in the
     Windows SYSTEM subdirectory has the file date 11/1/93 and a file size
     of 5968 bytes.
</PRE><P>
   If the modem still does not work in Terminal, obtain the Microsoft
   Application Note WW0654, "Windows 3.1 and Serial Communications." You
   can have this Application Note mailed or faxed to you from the automated
   Microsoft FastTips Technical Library, which you can call 24 hours a day,
   7 days a week at (800) 936-4200. NOTE: The FastTips Technical Library is
   available only to customers within the U.S. and Canada.

<P><LI>Check RAS again after performing the above steps.
<P>
   If Terminal is working and RAS is still not working, add the line
   COMxFIFO=0 to the [386Enh] section of the SYSTEM.INI file using a text
   editor. This command turns off the 16-bit buffer built into the 16550
   UART chip, forcing one-bit operation of serial data through the UART
   chip.

<P><LI>Check the file RASMAC.386 in the Windows SYSTEM subdirectory.
<P>
   If RASMAC.386 is dated 11/1/93, disable software compression. To do
   this, choose Disable Software Compression from the Options menu in RAS.
   (The next time you open the Options menu, a check mark should be beside
   Disable Software Compression.) If disabling software compression helps,
   use hardware compression instead.

<P><LI>Try a lower bits-per-second (bps) rate.
<P>
   Slowing the speed of the modem can often help decrease noise on the
   phone lines. It can also help with compatibility problems when using
   high-speed modems (9600 bps and above) that differ slightly in their
   compression and error-correction standards. If the lower bps rate works,
   you may want to disable hardware flow control and/or modem compression.
   To do this, choose the Phone Book Edit button in RAS, choose the Modem
   button, and then clear the Enable Hardware Flow Control and/or Enable
   Modem Compression options.

<P><LI>Check the modem documentation to see if the recommended initialization
   string differs from the one in the MODEM.INF file found in the Windows
   SYSTEM subdirectory. If it does, try entering the command manually.
   Choose the Phone Book Edit button, choose Modem, and select the Enter
   Modem Commands Manually option. This allows you to enter a modem command
   string manually to determine whether the default one in the MODEM.INF is
   related to the problem.

<P><LI>Check the BIOS date of the modem.
<P>
   Check the BIOS date of the modem with the manufacturer to see if a newer
   BIOS is available. To check the BIOS date of the modem using Terminal,
   issue the command ATIx (where x is a value between 1 and 9). For
   example, in Terminal, issue the command ATI3, then &lt;enter&gt;. A BIOS
   version number should be displayed on the screen, (for example, V1.200
   or ver .59). If there is a newer BIOS available, update the BIOS by
   downloading the firmware (software) from the modem manufacturer's
   bulletin board service (BBS) or CompuServe Information Service (CIS)
   forum if available. Some modem manufacturers have a single-chip upgrade
   available if the BIOS of the modem is not software upgradeable.

<P><LI>Determine whether the modem is supported in RAS.
<P>
   If it is an unsupported modem, refer to step 6 above for information
   about checking for the correct communication string sent by RAS from the
   MODEM.INF file. You can make your own section by cutting and pasting the
   information from a related modem section with your own section heading
   (such as [my modem]). This method is not supported, but it may be the
   only way RAS can communicate with your modem.
<P>
</OL><h3>Common Error Messages in RAS</h3>
 
<P>
Error 615:
<P>
When you use RAS in Windows for Workgroups 3.11, you may receive the
message "Error 615: The port was not found." This error can occur when the
Remote Access Phone Book file and the current Remote Access configuration
are inconsistent. If you have changed your communications equipment (for
example, your serial port or modem), be sure to reconfigure RAS. (For more
information, see "Reconfiguring Remote Access" in the online help file.) If
the error persists, remove and re-create the affected Phone Book entry or
reinstall RAS. The Remote Access Phone Book (RASPHONE.PBK) is in the
Windows subdirectory.
<P>
Error 640:
<P>
The message "Error 640: A Net BIOS error has occurred" is generated when
the modem does not negotiate the connection correctly or when the line is
noisy. Set the modem to a lower initial bits-per-second (bps) speed, and
then dial again. (For more information, refer to "Setting Modem Features"
in the online help in RAS.)
<P>
If reducing the modem speed does not correct this error, RAS is probably
running out of conventional memory to set up its session. RAS uses
conventional memory (about 90 kilobytes [K]) without being in the Answer
mode as the server. With RAS set up as the server and in Answer mode, RAS
uses about 120K of conventional memory. You may want to clean boot to see
if you can make more conventional memory available. Most RAS NetBIOS error
640 messages occur when your system has less than 500K free conventional
memory at MS-DOS before starting Windows for Workgroups. Remove any
terminate-and- stay-resident (TSR) programs and other network drivers to
determine whether more conventional memory solves the problem.
<P>
NOTE: Having the NET START command in the AUTOEXEC.BAT file and IFSHLP.SYS
in the CONFIG.SYS file are required to run RAS.
<P>
For more information on Error 640, query on the following words in the
Microsoft Knowledge Base:
<P>
<PRE>   netbios and error and 640

</PRE></OL>Error 692:
<P>
When dialing using RAS, you may receive the message "Error 692: Hardware
Failure in Port or Attached Device" even though all other communication
software is working correctly. This error message is reported when RAS
cannot correctly communicate with the modem. To correct this problem, you
must first know the reason RAS cannot communicate with the modem. Check the
selected modem for RAS with the following steps:

<OL><P><LI>Choose the RAS icon in the Network group.

<P><LI>Choose Setup from the menu list and then choose Configure.

<P><LI>Check the device selected and the port to which it is assigned.
<P>
</OL>The modem's handshaking requirements may not match what is being sent by
RAS, or the emulation for the modem may be incorrect. RAS uses a file
called MODEM.INF in the Windows SYSTEM subdirectory to send the right
communication strings to the modem through the selected modem in RAS. If
you use a text editor (such as Windows Write) with the No Conversion option
selected to open the MODEM.INF file, you can find the modem you have
selected in RAS to look at the COMMAND_INIT string. COMMAND_INIT string is
the communication string RAS sends to set up the modem for communication.
Refer to the modem documentation or check with the modem manufacturer for
the correct communication string for your modem.
<P>
For more information on this error message, query on the following words in
the Microsoft Knowledge Base:
<P>
<PRE>   RAS and ERROR and 692

</PRE></OL>NOTE: The following updated communication Application Notes are available
from Microsoft:

<UL><LI>WG0992: Updated Files for Microsoft At Work PC Fax 1.0

<LI>WG1001: Updated SERIAL.386 Driver for Windows for Workgroups
<P>
</UL>To obtain these Application Notes:
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0992.EXE">WG0992.EXE</A> <I>(size: 113121 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0992.EXE">WG0992.EXE</A> <I>(size: 113121 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0992.EXE">WG0992.EXE</A> <I>(size: 113121 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/WG0992.EXE">WG0992.EXE</A> <I>(size: 113121 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>You can have this Application Note mailed to you from the automated
   Microsoft FastTips Technical Library, which you can call 24 hours
   a day, 7 days a week at (800) 936-4200. NOTE: The FastTips Technical
   Library is available only to customers within the U.S. and Canada.

<LI>If you are unable to access the source(s) listed above, you can
   have these Application Notes mailed to you by calling Microsoft
   Product Support Services Monday through Friday, 6:00 A.M. to 6:00
   P.M. Pacific time at (425) 637-7098. If you are outside the
   United States, contact the Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother kbtshoot kbfile<BR>
KBSubcategory: wfw wfwg awfax ras<BR>
Additional reference words: 3.11 tshoot remote access service baud softlib<BR>
Keywords            : awfax ras wfw wfwg kbfile kbother kbtshoot<BR>
Version             : 3.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
