

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recovering Windows 3.1 After Installing WFWG </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95743 ">
<META NAME="KBModify" CONTENT="1995/05/11">
<META NAME="KBCreate" CONTENT="1993/02/22">
<META NAME="Keywords" CONTENT="kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" IMPORTANT: Read these instructions before proceeding. Microsoft cannot guarantee this procedure to work in every situation. If this procedure fails, you must reinstall Windows 3.1 and Windows-based applications to a new directory.   If you installed...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWN,QAA1,QBWQ,QDI2,QAEF,QDIZ,QAGQ,QAVZ,QA9N,QAFI,QAU9,QANE,QDNN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Recovering Windows 3.1 After Installing WFWG</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 11, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95743 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.1
</UL> 
<P>
IMPORTANT: Read these instructions before proceeding. Microsoft cannot
guarantee this procedure to work in every situation. If this procedure
fails, you must reinstall Windows 3.1 and Windows-based applications
to a new directory.
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you installed Windows for Workgroups over Microsoft Windows version
3.1, you can use the following procedure to restore Microsoft Windows
version 3.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This procedure can be used ONLY if you ran the Setup program for
Windows for Workgroups one time. If you ran the Setup program more
than once, it is not possible to restore the original Windows
configuration files; therefore, Windows 3.1 must be reinstalled to an
empty subdirectory. Also, any third-party software that replaces
Windows virtual device drivers (VxDs) may need to be reinstalled after
reinstalling Windows version 3.1.

<OL><P><LI>Start the machine with MS-DOS.

<P><LI>Edit the CONFIG.SYS and AUTOEXEC.BAT files to remove the Windows for
   Workgroups network device drivers. These drivers are PROTMAN.DOS,
   WORKGRP.SYS, and the network interface card driver (media access
   control [MAC] driver). If NetWare connectivity has been added, also
   remove the referenced lines.
<P>
   Below is an example of lines to remove:
<P>
   CONFIG.SYS
   ----------
<P>
   DEVICE=C:\WINDOWS\PROTMAN.DOS /I:C:\WINDOWS
   DEVICE=C:\WINDOWS\WORKGRP.SYS
<PRE>   DEVICE=C:\WINDOWS\EXP16.DOS   ;or other specific MAC driver
   DEVICE=C:\WINDOWS\MSIPX.SYS   ;If Netware Connectivity added

   AUTOEXEC.BAT
   ------------

   C:\WINDOWS\NET START
   C:\WINDOWS\MSIPX    ;If Netware Connectivity added
   C:\WINDOWS\NETX     ;If Netware Connectivity added

</PRE><P><LI>Copy the files from the WININI.W31 and SYSINI.W31 to a floppy disk.
   These files should be located in the WINDOWS subdirectory.

<P><LI>Run the Windows version 3.1 Setup program. Choose the Custom Setup
   option. A message will appear stating that setup has found a
   previous version of Microsoft Windows on your system and recommends
   that you perform an upgrade. Specify the Windows for Workgroups
   directory as the target directory and press the ENTER key to
   upgrade. When the System Information screen appears, change the
   following line:
<P>
<P><PRE>      Network = Windows for Workgroups (version 3.1)
</PRE><P>
   -to-
<P>
<P><PRE>      Network = No Network Installed (or the specific network in use)
</PRE><P>
   The Windows 3.1 Setup program detects some newer drivers (for
   example, COMM.DRV) and prompts you to replace them with the Windows
   3.1 drivers. In the following example, Setup detects conflict(s)
   between the version of COMM.DRV currently on your system and the
   version that Setup is attempting to copy. You can choose to use the
   currently installed file or replace it with the file that Setup is
   trying to copy.
<P>
<PRE>   Current file : Version 3.10a   Language: U.S. English
                  220800 bytes           10/1/92  3:11

   Proposed file: Version 3.10    Language: U.S. English
                 220800 bytes           03/10/92 3:10

   The replacement file is an older version than your current file.

   - To keep your currently installed driver file, press ENTER.
   - To replace the currently installed driver file, press ESC.

   Press the ESC key, to replace each driver file.

   After Setup loads Windows, the setup program begins to copy files,
   again finding newer versions than those provided with Windows 3.1.
   Setup prompts you for action on each conflicting file as follows:

      The following file conflicts with the version already on your system:

      File: CLIPBRD.EXE

      Description: Windows for Workgroups

      The new version of the file ((Unknown)) you are trying to
      install is older than the currently installed version (3.10a).

      Do you want to replace the file that is already on your system?

               Yes      Help        No

   Replace these files by choosing the Yes option when prompted.
   The files that Setup finds version conflicts for are:

      COMM.DRV      DDEML.DLL    GDI.EXE    MAIN.CPL      USER.EXE
      PRINTMAN.CPL  WINFILE.EXE  SHELL.DLL  COMMDLG.DLL   CLIPBRD.EXE

</PRE><P><LI>From the floppy disk used in step 3, copy WININI.W31 to the
   WINDOWS directory as WIN.INI and SYSINI.W31 to the WINDOWS
   directory as SYSTEM.INI.

<P><LI>Reboot the system, and start Windows 3.1 by typing WIN at the
   command prompt and pressing ENTER.

<P><LI>Remove the program icons that were added by the Windows for
   Workgroups Setup program.
<P>
   Delete the following icons from the Main Group:
<P>
<PRE>      Clipbook Viewer   Mail   Schedule+

   Delete the following icons from the Accessories Group:

      Chat   WinMeter   Net Watcher

   Delete the following icons from the Games Group:

      Hearts

</PRE><P><LI>Remove the files from the WINDOWS and WINDOWS\SYSTEM sub-
   directories that are specific to Windows for Workgroups.
<P>
   Files in the WINDOWS directory to delete:
<P>
<PRE>   CARDS.DLL     IMPEXP.DLL    MSSCHED.DLL  NDDENB.DLL    SCHEDMSG.DLL
   TRNSCHED.DLL  WGPOMGR.DLL   CLIPSRV.EXE  MSHEARTS.EXE  MSMAIL.EXE
   MSREMIND.EXE  NET.EXE       NETDDE.EXE   NETWATCH.EXE  SCHDPLUS.EXE
   WINCHAT.EXE   WINMETER.EXE  MSMAIL.HLP   MSHEARTS.HLP  NETWATCH.HLP
   SCHDPLUS.HLP  WINCHAT.HLP   WFWNET.HLP   NET.MSG       NETH.MSG
   RINGIN.WAV    RINGOUT.WAV

   Files in the SYSTEM directory to delete:

   WFWSETUP.CPL  VBROWSE.386   VCD.386      VDMAD.386     VNB.386
   VNETBIOS.386  VNETSUP.386   VPD.386      VPICD.386     VREDIR.386
   VSERVER.386   VSHARE.386    VWC.386      AB.DLL        COMMCTRL.DLL
   DEMILAYR.DLL  FRAMEWRK.DLL  MAILMGR.DLL  MAPI.DLL      MSSFS.DLL
   NDDEAPI.DLL   PABNSP.DLL    SENDFILE.DLL STORE.DLL     VFORMS.DLL
   WFWNET.DRV    MAILSPL.EXE   NETWORK.INF  MIDIMAP.OLD   LM21DRV.UPD

</PRE></OL>After you follow these steps, Windows 3.1 should be successfully
reinstalled. However, if Windows 3.1 does not perform as expected (for
example, if you receive error messages, system lockups, and so on), you
must reinstall Windows 3.1 and all Windows software to a new
subdirectory.
<P>
For additional information on reinstalling other Windows versions,
query on the following words in the Microsoft Knowledge Base:
<P>
<PRE>   windows and reinstall
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother kbtshoot<BR>
KBSubcategory: wfw win31 wfwg<BR>
Additional reference words: tshoot 3.10 3.11 Uninstall remove removing<BR>
recover<BR>
uninstall deactivate<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 11, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
