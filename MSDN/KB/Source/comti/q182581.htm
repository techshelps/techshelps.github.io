

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Runtime Error: Attempt to Initialize Tagen.dll Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182581">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/16">
<META NAME="Keywords" CONTENT="kbbug1.00 CTIDeploy CTISecurity">
<META NAME="KBArea" CONTENT="Support; KB; comti">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information on how to do this, view the  Restoring the Registry  online Help t...">
<META NAME="Product" CONTENT="comti">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAPN,QAKP,QAAP,QAB4,QA01,QA5E,QABI,QAGU,QDNN,QBWS,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Runtime Error: Attempt to Initialize Tagen.dll Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182581</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft COM Transaction Integrator for CICS and IMS, version 1.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a COMTI application method is invoked, COMTI displays a message box
with the title, "mtx.exe - DLL Initialization Failed," and the text:
<P>
<PRE>   Initialization of the dynamic link library
   C:\program files\sna\COMTI\tagen.dll failed.
   The process is terminating abnormally.

</PRE>When you click OK, another message box is displayed with the title "Object
Creation Failed" and the text:
<P>
<PRE>   ActiveX component can't create object.

</PRE>The Windows NT Event Log contains the following entry:
<P>
<PRE>   Event ID: 4128
   Source: Transaction Server
   Type: Error
   Category: Class Factory Wrapper
   The run-time environment was unable to load an application component due
   to either an error obtaining its properties from the catalog, loading
   the DLL, or getting the procedure address of DllGetClassObject. This
   error caused the process to terminate.
   C:\program files\sna\COMTI\tagen.dll
   (Package: CedarBank)
   (Microsoft Transaction Server Internals Information: File:
   d:\viper\src\runtime\cfw\ccomdll.cpp, Line: 151)

</PRE><h2>CAUSE</h2>
 
<P>
At run time, Tagen.dll must have access to the Windows NT registry key that
identifies the location of a message DLL needed for writing an informative
message to the Windows NT Event Log. However, Tagen.dll attempts to get
Write access to the registry key, when only Read access is required. The
default user profile does not have that right, only Administrators do.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
<P><h3>Method 1</h3>
 
<P>
Start User Manager for domains and assign the Windows NT User (...of the
identity under which the Microsoft Transaction Server package component is
to execute) to the Windows NT Administrators Group.
<P>
<P><h3>Method 2</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" online Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" online Help
topics in Regedt32.exe. Note that you should back up the registry before
you edit it.

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Locate the following key and select it:
<P>
   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog
   \Application\COMTI
<P>
   NOTE: The above registry key is one path; it has been wrapped for
   readability.

<P><LI>Click Permissions on the Security menu.

<P><LI>Confirm that the Windows NT Group, Everyone, has either Read or
   Special Access permission for this registry key.

<P><LI>Select the Name, Everyone. Click Full Control on the Type of Access
   menu.

<P><LI>Click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft COM Transaction
Integrator for CICS and Information Management System, version 1.0.
A supported fix is now available, but has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Technical Support for more information.
 
<PRE>Keywords          : kbbug1.00 CTIDeploy CTISecurity
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
