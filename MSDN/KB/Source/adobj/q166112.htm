

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Conflict with EOF When Using #import with ADO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166112">
<META NAME="KBModify" CONTENT="1998/01/30">
<META NAME="KBCreate" CONTENT="1997/03/31">
<META NAME="Keywords" CONTENT="kbprg adoengall adoengdb adovc MfcDatabase">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  With #import, it is possible to generate classes that encapsulate the typelib of database API's, such as ActiveX Data Objects (ADO), within a windows application. For example:     // Excerpt from Stdafx.h    #include                    // MFC core ...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAH4,QAUJ,QAPN,QAB4,QAEQ,QAYL,QBXT,QBFY,QA5V,QA5E,QAW6,QAIB,QAJQ,QDNN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Conflict with EOF When Using #import with ADO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166112</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO) included with:
   - Microsoft Visual C++, 32-bit Editions, versions 4.2, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With #import, it is possible to generate classes that encapsulate the
typelib of database API's, such as ActiveX Data Objects (ADO), within a
windows application. For example:
<P>
<PRE>   // Excerpt from Stdafx.h
   #include &lt;afxwin.h&gt;         // MFC core and standard components
   ...
   #import "C:\Program Files\Common Files\System\ADO\Msado10.dll"

</PRE>When doing so, you may receive the following errors from the #import for
ADO on the Recordset.EOF property:
<P>
<PRE>   error C2629: unexpected 'short ('
   error C2238: unexpected token(s) preceding ';'

</PRE>NOTE: The same error occurs with ADO version 1.5 using Msado15.dll.
<P>
<P><h2>CAUSE</h2>
 
<P>
Within an application that uses STDIO.H, IOS.H or STREAMB.H
(including AFXWIN.H ), EOF has already been defined as a constant
(-1).  #import then attempts to define the EOF property for ADO's Recordset
or RDO's Resultset objects, and generates the C2629/C2238 errors on this
line of generated code in the MSADO10.TLH file:
<P>
<PRE>   VARIANT_BOOL EOF;

</PRE>This line is attempting to define a variable, but EOF has already defined
it as -1. As a result, this line of code parses to:
<P>
<PRE>   short -1;

</PRE>This does not compile because -1 is not a valid variable name.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this, you can use the rename attribute of #import as shown
below:
<P>
<PRE>   #import "C:\Program Files\Common Files\System\ADO\msado10.dll" \
           rename( "EOF", "A_EOF" )

</PRE>Rename changes the name of any "EOF" string that #import finds in the
specified typelib to a new value.
<P>
NOTE: When you use ADO version 1.5, replace Msado10.dll with Msado15.dll.
<P>
 
<PRE>Keywords          : kbprg adoengall adoengdb adovc MfcDatabase
Version           : 5.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
