

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Distributing RDS Client with Visual Basic Setup Wizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176874">
<META NAME="KBModify" CONTENT="1997/12/04">
<META NAME="KBCreate" CONTENT="1997/11/17">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  This article describes the steps to distribute the Remote Data Service (RDS) client files with a Visual Basic 5.0 application. You need to have a thorough understanding of how RDS and Visual Basic work before you attempt to distribute your applicat...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBS0,QAH4,QDI2,QBFY,QAJH,QASR,QA9Q,QBWS,QDNN,QAH6,QDIZ,QA2Q,QAVX,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Distributing RDS Client with Visual Basic Setup Wizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176874</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Remote Data Service for ADO version 1.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes the steps to distribute the Remote Data Service
(RDS) client files with a Visual Basic 5.0 application. You need to have a
thorough understanding of how RDS and Visual Basic work before you attempt
to distribute your application. There are other RDS Microsoft Knowledge
Base articles available that you can use to learn more about RDS before
distributing your application.
<P>
In order to distribute an RDS client application using Visual Basic you
will need to include the following files with your setup program:
<P>
<PRE>   msadce.dll*   - installed to \Program Files\Common Files\system\msadc
   msadco.dll*   - installed to \Program Files\Common Files\system\msadc
   msador15.dll* - installed to \Program Files\Common Files\system\ado
   msdadc.dll*   - installed to \Program Files\Common Files\system\ole db
   msdaps.dll*   - installed to \Program Files\Common Files\system\ole db
   msdaer.dll*   - installed to \Program Files\Common Files\system\ole db
   msr2c.dll*    - installed to \system

   msadcer.dll   - installed to \Program Files\Common Files\system\msadc
   msadcor.dll   - installed to \Program Files\Common Files\system\msadc
   msader15.dll  - installed to \Program Files\Common Files\system\ado
   msdaerr.dll   - installed to \Program Files\Common Files\system\ole db
   msr2cenu.dll  - installed to \system
   msdatsrc.tlb  - installed to \system
   wininet.dll   - installed to \system

   * indicates an ActiveX component that needs to be registered.

</PRE>There are two ways you could distribute these files using the Visual Basic
Application Setup Wizard.

<UL><LI>Individually select each file when you are prompted for "Add Local" and
   "Add Files" by the Setup Wizard.
<P>
   -or-

<LI>Include the file list we have provided below that you can insert into
   the .swt file the Setup Wizard creates. The steps in the MORE
   INFORMATION section will guide you through this process.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step One</h3>
 
<P>
Build the Test Visual Basic application. Assume that you are building this
application on a computer that already has the proper RDS client files
installed.

<OL><P><LI>Start a new Standard EXE project. Form1 is created by default.

<P><LI>From the Project menu, select References, and select Microsoft Remote
   Data Services 1.5 Library.

<P><LI>Add two CommandButtons to Form1, named Command1, and Command2 by
   default.

<P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<P><PRE>      Private Sub Command1_Click()
      'DataControl
      MousePointer = vbArrowHourglass
      Dim dc As New RDS.DataControl
      dc.Connect = "dsn=pubs;uid=sa;pwd=;"
      dc.SQL = "select * from authors"
      dc.Server = "<B>http://ServerXXXX</B>"
      dc.ExecuteOptions = adcExecAsync
      dc.Refresh
</PRE><P>
<P><PRE>      While dc.ReadyState = 2
       DoEvents 'user has control during async query
      Wend
      MousePointer = vbDefault
      MsgBox dc.Recordset.Fields(0).Value
      End Sub
</PRE><P>
<P><PRE>      Private Sub Command2_Click()
      'DataSpace, DataFactory
      MousePointer = vbArrowHourglass
      Dim ds As New RDS.DataSpace
      Dim df, rs
      Set df = ds.CreateObject("RDSServer.DataFactory",
      "<B>http://ServerXXXX</B>")
      Set rs = df.Query("dsn=pubs;uid=sa;pwd=;", "select * from authors")
      MsgBox rs.Fields(0).Value
      MousePointer = vbDefault
      End Sub
</PRE>
<P><LI>Change the Server, SQL, and Connect strings to match actual servers you
   will be testing against.

<P><LI>Save the project.

<P><LI>Run the project and test its functionality against your server to verify
   that it works. If it does not work at this time, do not continue to Step
   Two below until you have figured out what is wrong. The RDS
   documentation, Readme.txt, and other Microsoft Knowledge Base articles
   will help you debug RDS configuration problems.
<P>
</OL><h3>Step Two</h3>
 
<P>
Build the distributable application using the Visual Basic Application
Setup Wizard.

<OL><P><LI>Start the Visual Basic 5.0 Application Setup Wizard.

<P><LI>On step 1 select your project, select "Rebuild the Project," then click
   "Create Setup Program".

<P><LI>On step 2 ignore the dependency information by clicking Next.

<P><LI>On step 3 click Single directory.

<P><LI>On step 4 select your target setup directory.

<P><LI>On step 5 clear the reference to Msadco.dll; this will be added manually
   later.

<P><LI>On step 6 you should have only the required Visual Basic system files
   and your actual project files listed.

<P><LI>On step 7 click Save Template so you can edit the .swt file later.
   Next, click Cancel because you do not want to create the entire setup
   program just yet.

<P><LI>Find the .swt file you just saved and open it using Notepad or any
   ASCII text editor. Go to the bottom of the section named [File Summary]
   and paste in the following entries for RDS files:
<P>
<P><PRE>      File9="C:\Program Files\Common Files\SYSTEM\MSADC\msadco.dll",True,
      "C:\Program Files\Common Files\SYSTEM\MSADC",$(DLLSelfRegister),True
      File10="C:\Program Files\Common Files\System\MSADC\msadce.dll",True,
      "C:\Program Files\Common Files\SYSTEM\MSADC",$(DLLSelfRegister),True
      File11="C:\Program Files\Common Files\System\MSADC\msadcer.dll",True,
      "C:\Program Files\Common Files\System\MSADC",,True
      File12="C:\Program Files\Common Files\System\MSADC\msadcor.dll",True,
      "C:\Program Files\Common Files\System\MSADC",,True
      File13="C:\Program Files\Common Files\System\ADO\msador15.dll",True,
      "C:\Program Files\Common Files\System\ADO",$(DLLSelfRegister),True
      File14="C:\Program Files\Common Files\System\ADO\msader15.dll",True,
      "C:\Program Files\Common Files\System\ADO",,True
      File15="C:\Program Files\Common Files\System\OLE DB\msdadc.dll",True,
      "C:\Program Files\Common Files\System\OLE DB",$(DLLSelfRegister),True
      File16="C:\Program Files\Common Files\System\OLE DB\msdaps.dll",True,
      "C:\Program Files\Common Files\System\OLE DB",$(DLLSelfRegister),True
      File17="C:\Program Files\Common Files\System\OLE
      DB\msdaerr.dll",True,
      "C:\Program Files\Common Files\System\OLE DB",,True
      File18="C:\Program Files\Common Files\System\OLE DB\msdaer.dll",True,
      "C:\Program Files\Common Files\System\OLE DB",$(DLLSelfRegister),True
      File19="C:\WINNT\system32\msdatsrc.tlb",True,
      "$(WinSysPath)",$(TLBRegister),True
      File20="C:\WINNT\system32\MSR2CENU.DLL",True,
      "$(WinSysPath)",,True
      File21="C:\WINNT\system32\MSR2C.DLL",True,
      "$(WinSysPath)",$(DLLSelfRegister),True
</PRE>
<P><LI>Remove the hard returns we put in for formatting this article so each
<P><PRE>    FileXX= entry is on only one line. Now, adjust the numbers for each
    added FileXX= entry so they are ordered correctly from 1 to the total
    number of included files. Save the .swt file and you are ready to
    rebuild the project.
</PRE>
<P><LI>Start the Visual Basic 5.0 Application Setup Wizard and select the .swt
<P><PRE>    file as your project. Step through to the final step and click Finish
    to create the distribution files. You should now have all the needed
    RDS client files for distribution of your application.
</PRE>
<P><LI>On a computer that has not ever had any RDS files installed, test the
<P><PRE>    functionality of your example program by running the Setup.exe file
    that the Application Setup Wizard created. If it does not work
    correctly, review the steps in this article to make sure you followed
    them correctly, and refer to Step 1, item 7.
</PRE><P>
</OL>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Jon
Fowler, Microsoft Corporation
 
<PRE>Version           : WINDOWS:1.5
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
