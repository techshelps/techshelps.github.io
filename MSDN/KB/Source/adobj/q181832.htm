

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Migrating SQL Statements with Quotes From DAO to ADO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181832">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1998/02/26">
<META NAME="Keywords" CONTENT="adoall adoengdb">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  ActiveX Data Objects (ADO) imposes no restrictions on the syntax used to generate a recordset or execute a statement.  This comes from the underlying native provider, such as the OLE DB provider for Index Server, or the OLE DB provider for ODBC dri...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAB4,QBS0,QAAP,QAPN,QAN0,QBWB,QA9E,QABM,QDN9,QA9Q,QAU9,QAEO,QA5V,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Migrating SQL Statements with Quotes From DAO to ADO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181832</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), versions 1.0, 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
ActiveX Data Objects (ADO) imposes no restrictions on the syntax used to
generate a recordset or execute a statement.  This comes from the
underlying native provider, such as the OLE DB provider for Index Server,
or the OLE DB provider for ODBC drivers.  Valid syntax required for using
ADO successfully is defined by the underlying OLE DB provider.  When
migrating SQL syntax to ADO, you will need to consider this for SQL
statements such as the following, which works when using DAO to go to the
Microsoft Access Jet engine:
<P>
<PRE>   INSERT INTO Authors ( Au_ID, Author ) VALUES (  54, "Record # 54" )

</PRE>However, with ADO (to the OLE DB provider for ODBC drivers via the
Microsoft Access ODBC driver) this syntax generates an error and fails to
execute.
<P>
With ADO, this syntax generates an error, 0x80040E10 or -2147217904, or the
following error message:
<P>
<PRE>   Too few parameters.  Expected 1.

</PRE>Instead, you would have to use the following syntax:
<P>
<PRE>   INSERT INTO Authors ( Au_ID, Author ) VALUES (  54, 'Record # 54' )

</PRE>This is only one example and specific to DAO/Jet.
<P>
<P><h2>CAUSE</h2>
 
<P>
You should examine the Online help for the underlying provider and for the
datastore it exposes in order to determine the correct syntax to provide
your ADO code. As in the case above, even though DAO and the Microsoft
Access ODBC Driver both use Jet, the syntax differed slightly in order for
the Microsoft Access ODBC Driver to meet the ODBC specification.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Errors raised by the provider (or the datastore it exposes) are stored in
the ADO Errors collection. Whereas errors raised by ADO are exposed by the
native error handling of the language you are using. For Visual Basic for
Applications (VBA) and/or VBScript this is the Err object. For C++ or Java
this is typically some kind of exception, although with C++ you may just
have to check for a failed HRESULT if manipulating ADO directly via COM.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following Visual Basic article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q178070.htm">Q178070</A></B>
   TITLE     : HOWTO: Handle Quotes and Pipes in Concatenated SQL Literals

</PRE>This article, while written for DAO, has handy routines for processing a
string to be used in a SQL statement that contains special characters. It
can easily be adapted for non-DAO syntax requirements.
<P>
For additional information on error handling, please see the following
Visual Basic article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ADOBJ/Q167957.htm">Q167957</A></B>
   TITLE     :INFO: Extracting Error Information from ADO in VB

</PRE> 
<PRE>Keywords          : adoall adoengdb
Component         : dao jet
Technology        : odbc ole
Version           : WINDOWS:1.0,1.5
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
