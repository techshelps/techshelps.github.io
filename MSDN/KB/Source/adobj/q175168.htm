

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Causes of 'Operation Must Use an Updateable Query' Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175168">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1997/10/14">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  The following is a common error encountered when using ActiveX Data Objects (ADO) with Active Server Pages:     Microsoft OLE DB Provider for ODBC Drivers error '80004005'     [Microsoft][ODBC Microsoft Access 97 Driver] Operation must use an updat...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAXB,QA1S,QAB4,QAPN,QAZV,QDKY,QAC1,QBD2,QAR4,QABM,QBXS,QBG2,QAKP,QA9E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Causes of 'Operation Must Use an Updateable Query' Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175168</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, version 1.0
<LI>ActiveX Data Objects (ADO), version 1.0
<LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following is a common error encountered when using ActiveX Data Objects
(ADO) with Active Server Pages:
<P>
<PRE>   Microsoft OLE DB Provider for ODBC Drivers error '80004005'

   [Microsoft][ODBC Microsoft Access 97 Driver] Operation must use an
</PRE>updateable query.
<P>
<P><h2>CAUSE</h2>
 
<P>
This article explains the three primary causes of this error, and the
workarounds. Although this article refers to Access databases, the
information provided here also applies to other types of databases.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This error is typically encountered when your script attempts to do an
UPDATE or some other action which alters the information in the database.
This error occurs because ADO is unable to write to the database for one of
the following reasons.

<OL><P><LI>The most common reason is that the Internet Guest account (IUSR_MACHINE)
   does not have Write permissions on the database file (.mdb). To fix this
   problem, use the Security tab in Explorer to adjust the properties for
   this file so that the Internet Guest account has the correct
   permissions.
<P>
   NOTE: When using Access databases with ADO, it is also necessary to give
   the Internet Guest account Write permissions on the directory containing
   the .mdb file. This is because Jet creates an .ldb file to handle
   database locking.

<P><LI>A second cause of this error is that the database was not opened with
   the correct MODE for writing. If you perform the Open on the Connection
   object, you use the Mode property to indicate the permissions on the
   connection as shown here:
<P>
<P><PRE>      SQL = "UPDATE Products Set UnitPrice = 2;"
      Set Conn = Server.CreateObject("ADODB.Connection")
<PRE></PRE>      Conn.Mode = 3      '3 = adModeReadWrite
      Conn.Open "myDSN"
      Conn.Execute(SQL)
      Conn.Close

   NOTE: By default, the MODE is set to 0(adModeUnknown), which generally
   allows updates.

</PRE><P><LI>Another cause of this error is that the "Read Only" setting may be
   checked in the Options page for this DSN in the ODBC Manager.

<P><LI>The last issue and workaround pertains to any SQL data source. The error
   can be caused by SQL statements that violate referential integrity of
   the database. Here are a few of the most common queries that fail:
<P>
   - The simplest group to deal with are those you cannot change: crosstab,
<P><PRE>     SQL pass-through, union, or update (or make-table) action queries that
     have UniqueValue properties set to Yes.
</PRE><P>
   - Another very common cause is when the join includes linked ODBC tables
<P><PRE>     that do not have unique indexes. In this case, there is no way for SQL
     to guarantee that records are unique in a table that has fields whose
     value will change with the query.
</PRE><P>
   - One cause does have a robust workaround. If you try to update a join
<P><PRE>     field on the "one" side of a "one-to-many" query it will fail unless
     you turn on cascading updates. This way, you delegate referential
     integrity to the JET engine.
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
 
<PRE>Technology        : kbInetDev
Version           : WINDOWS:1.0; WINNT:1.0
Platform          : WINDOWS winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
