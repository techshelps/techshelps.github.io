

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: IIS 4 Fails When Using a UNC to Microsoft Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180815">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1998/02/10">
<META NAME="Keywords" CONTENT="adoiis">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  When connecting to a remote Microsoft Access database under Internet Information Server 4.0 (IIS) using either a Universal Naming Convention (UNC) such as \\ComputerName\ShareName or a mapped drive, the following error may appear:     Microsoft OLE...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDKY,QDN9,QBVX,QAKP,QA9E,QAU9,QAAP,QAB4,QBWS,QAYY,QBQU,QA5J,QA5I,QA3A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: IIS 4 Fails When Using a UNC to Microsoft Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180815</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), version 1.5
<LI>Microsoft Internet Information Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When connecting to a remote Microsoft Access database under Internet
Information Server 4.0 (IIS) using either a Universal Naming Convention
(UNC) such as \\ComputerName\ShareName or a mapped drive, the following
error may appear:
<P>
<PRE>   Microsoft OLE DB Provider for ODBC Drivers error '80004005'
   [Microsoft][ODBC Microsoft Access 97 Driver] The Microsoft Jet
   database engine cannot open the file '(unknown)'. It is already
   opened exclusively by another user, or you need permission to view
   its data.

</PRE><h2>RESOLUTION</h2>
 
<P>
To work around this problem use one of the following three methods:

<UL><LI>Place the Microsoft Access .mdb file locally. This is the best solution
   because it provides the best performance.

<LI>Run the application in a separate memory space (isolated process). This
   does not work for some people due to configuration issues.

<LI>Replace the Odbcjt32.dll file with the older version 3.5 or earlier.
   This file can be located on the Visual Studio CD, under the setup. This
   option is not desirable because of performance issues.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Share out the Advworks.mdb from a computer (referred to here as
   Computer1), under the share name: TestUnc.

<P><LI>Create a new System DSN named TestUnc on the Web server that points to
   the Advworks.mdb under the new share on Computer 1(\\Computer1\TestUnc).

<P><LI>On the Web server, create an Active Server Pages (ASP) page that
   includes the following code:
<P>
<P><PRE>      &lt;%
      Set oConn = Server.CreateObject("ADODB.Connection")
      oConn.Open "TestUnc"
      %&gt;
</PRE>
<P><LI>Open the new ASP page from the browser, and you will see this error:
<P>
<P><PRE>      Microsoft OLE DB Provider for ODBC Drivers error '80004005'
      [Microsoft][ODBC Microsoft Access 97 Driver] The Microsoft Jet
      database engine cannot open the file '(unknown)'. It is already
      opened exclusively by another user, or you need permission to view
      its data.
</PRE><P>
</OL> 
<PRE>Keywords          : adoiis
Version           : WINDOWS:1.5; WINNT:4.0
Platform          : WINDOWS winnt
Issue type        : kbbug
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
