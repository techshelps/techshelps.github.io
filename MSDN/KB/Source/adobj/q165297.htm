

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: ADC: How To Use From Inside a Visual Basic Program </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165297">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="kbprg iisapi kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  The Microsoft Advanced Data Connector (ADC) can be used inside a Visual Basic program as easily as it can be used from inside Internet Explorer (IE) 3.0. You are not able to bind controls to it with the AdvancedDataControl as you can in IE, but you...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAUD,QAPN,QABM,QAXB,QAW6,QAN0,QAFF,QAPF,QBXS,QA3N,QAY2,QANF,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: ADC: How To Use From Inside a Visual Basic Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165297</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 3.0
   on the following platform: Windows NT
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Advanced Data Connector (ADC) can be used inside a Visual
Basic program as easily as it can be used from inside Internet Explorer
(IE) 3.0. You are not able to bind controls to it with the
AdvancedDataControl as you can in IE, but you can use the AdvancedDataSpace
and the AdvancedDataFactory objects to return a recordset to your Visual
Basic program with a small amount of code. With this returned recordset you
can populate non-bound controls as you would in a normal program.
<P>
Since the ADC only allows native update capability with the Microsoft SQL
Server ODBC driver, you can use the information in this article to update
non-SQL server ODBC databases very easily.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Program</h3>
 
<P>
This example uses the ADC CreateObject method of the AdvancedDataSpace on
the client to instantiate the AdvancedDataFactory object on a remote server
over http. The AdvancedDataFactory object then uses the Query method to
execute SQL on the remote server and return an ADO/R recordset to the
client.
<P>
In order to run the example code you first need to install the ADC client
components by using a CODEBASE parameter in an OBJECT tag of an HTML page.
To do this go to the sample page on your ADC Server at
<B>http://[SERVER]/Msadc/Samples/Adctest.asp</B> and these components are
automatically be installed on the client.
<P>
This sample uses SQL Server and the Pubs database, but you can change the
System DSN, UID, PWD, and SQL to match any ODBC database you may be using.

<OL><P><LI>Start a new project in Visual Basic and choose "Standard EXE." Form1 is
   created by default.

<P><LI>Add two Command buttons, Command1 and Command2, to Form1.

<P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<PRE>      Dim rs As Object    'Resultset
      Dim ads As Object   'AdvancedDataSpace
      Dim adf As Object   'AdvancedDataFactory

      Private Sub Form_Load()
        Set ads = CreateObject("AdvancedDataSpace")
        Set adf = ads.CreateObject("AdvancedDataFactory", _
         "<B>http://www.myserver.com</B>")
      End Sub

      Private Sub Command1_Click()
        'this query returns a recordset over HTTP
        Dim strCn As Variant, strSQL As Variant
        strCn = "dsn=pubs;uid=sa;pwd="
        strSQL = "select * from authors"
        Set rs = adf.Query(strCn, strSQL)
       Debug.Print rs(0)     'Print Row 1, Col 1 to Debug window
      End Sub

      Private Sub Command2_Click()
        'this example executes an action query but does not return
        'a recordset
        Dim strCn As Variant, strSQL As Variant
        strCn = "dsn=pubs;uid=sa;pwd="
        strSQL = "Update authors Set au_fname = 'Jon' Where au_lname Like
                  's%'"
        adf.Query strCn, strSQL
      End Sub

</PRE></OL>NOTE: You will need to change the DSN to match a System DSN on your
IIS/ASP/ADC server before continuing.

<OL><P><LI>Start the program or press the F5 key.

<P><LI>Click the Command1 button to execute the ADC code that returns a
   resultset. If it executes successfully, row 1 column 1 will be output to
   the Debug window.

<P><LI>Click the Command2 button to execute the action query that updates the
   au_fname column in the authors table. No data will be returned from the
   action query.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Web site for ADC, <B><A HREF="http://www.microsoft.com/adc">http://www.microsoft.com/adc</A></B>
ADC public newsgroup, microsoft.public.adc
Readme file, file://\\[SERVER DIR]\msadc\Doc\readme.txt
ADC Help, file://\\[SERVER DIR]\msadc\Doc\madc10.hlp
 
<PRE>Keywords          : kbprg iisapi kbhowto
Version           : 3.0
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
