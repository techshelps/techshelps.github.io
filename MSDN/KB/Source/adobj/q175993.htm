

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Using ActiveX Data Objects (ADO) via MFC OLE in VC++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175993">
<META NAME="KBModify" CONTENT="1998/03/06">
<META NAME="KBCreate" CONTENT="1997/10/30">
<META NAME="Keywords" CONTENT="adoall adovc">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  The MFC OLE Classes offer a powerful way for Visual C++ 4.X, and 5.0 developers to use the ActiveX Data Objects (ADO) typelib and manipulate ADO objects. This article discusses how to take advantage of MFC-OLE with ADO.  MORE INFORMATION  Before Yo...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA9Q,QAW6,QAH6,QBXO,QAH7,QAD7,QAYY,QBFY,QA56,QA55,QA6A,QAYL,QAMB,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Using ActiveX Data Objects (ADO) via MFC OLE in VC++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175993</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), versions 1.0, 1.5 included with:
<P><PRE>    - Microsoft Visual C++, 32-bit Editions, versions 4.2, 4.2b, 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MFC OLE Classes offer a powerful way for Visual C++ 4.X, and 5.0
developers to use the ActiveX Data Objects (ADO) typelib and manipulate
ADO objects. This article discusses how to take advantage of MFC-OLE with
ADO.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Before You Instantiate Any Classes Created by MFC-OLE</h3>
 
<P>
It is important to initialize OLE before creating any instances of classes
created by MFC-OLE. One way to initialize OLE is with the following code
snippet:
<P>
<PRE>   struct InitOle {
      InitOle()  { ::CoInitialize(NULL); }
      ~InitOle() { ::CoUninitialize();   }
   } _init_InitOle_;

</PRE>If you have any global BSTR's this is also a good place to allocate and
deallocate them.
<P>
<P><h3>Error Handling</h3>
 
<P>
With ADO, you may receive an error in the HRESULT returned from an ADO
method, however, this value is not raised/returned by the MFC-OLE classes.
You may receive a COleException or COleDispatchException. You should also
check the member variable m_lpDispatch for any class derived from
ColeDispatchDriver. If the member variable is NULL you should not continue
executing methods of an ADO object. It is possible, for example, to
generate a series of nested exceptions, which even try/catch(...)blocks
cannot catch. (To see this, take the ADOVC sample mentioned below, and
change the PROGID in the Connection object's CreateDispatch() call to
something invalid.)
<P>
The ADOVC sample demonstrates how to catch exceptions/errors with ADO. For
additional information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ADOBJ/Q174565.htm">Q174565</A></B>
   TITLE     : FILE: Adovc.exe Demonstrates How to Use ADO with Visual C++

</PRE><h3>Passing the License Key to ADO and ADO Redistribution</h3>
 
<P>
ADO 1.0 does require a license key when run on any system that has ADO
installed in a mechanism other than a Microsoft product. Unlike other
mechanisms within Visual C++, that work without passing a license key
as long as that license key exists in the registry, MFC-OLE requires
your ADO 1.0 based code to ALWAYS pass a license key.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ADOBJ/Q174802.htm">Q174802</A></B>
   TITLE     : HOWTO: Passing a License Key to ADO in Visual C++ Using MFC-
               OLE

</PRE><h2>REFERENCES</h2>
 
<P>
"Inside COM", by Dale Rogerson (ISBN 1-57231-349-8)
<P>
For more information, see the following articles in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID:  <B><A HREF="../ADOBJ/Q168122.htm">Q168122</A></B>
   TITLE:       HOWTO: Redistribute ADO 1.0 or ADO/R 1.0 with OLE/DB 1.1

   ARTICLE-ID: <B><A HREF="../ADOBJ/Q168354.htm">Q168354</A></B>
   TITLE     : INFO: Underlying OLE and OLEDB Provider Errors Exposed via
               ADO
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: noupdate s_mfc
<P>

Keywords          : adoall adovc<BR>
Version           : WINDOWS:1.0,1.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
