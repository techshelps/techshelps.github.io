

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Using ActiveX Data Objects (ADO) via OLE SDK in VC++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176342">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1997/11/05">
<META NAME="Keywords" CONTENT="adoall adovc">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  The OLE DB SDK contains two files, Adoid.h and Adoint.h, which make using ActiveX Data Objects (ADO) easier with the OLE DB SDK. This article discusses how to utilize the header files effectively.  MORE INFORMATION  Using ADOID.H and ADOINT.H  Add ...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAPN,QA9Q,QAAP,QAYY,QAW6,QAHV,QAMB,QAH7,QAH6,QBXO,QBVV,QAD7,QBCF,QBPG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Using ActiveX Data Objects (ADO) via OLE SDK in VC++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176342</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), versions 1.0, 1.5 included with:
<P><PRE>    - Microsoft Visual C++, 32-bit Editions, versions 4.2, 4.2b, 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The OLE DB SDK contains two files, Adoid.h and Adoint.h, which make using
ActiveX Data Objects (ADO) easier with the OLE DB SDK. This article
discusses how to utilize the header files effectively.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using ADOID.H and ADOINT.H</h3>
 
<P>
Add the \Oledbsdk\Include and \Oledbsdk\Lib folders to your path and add
Adoid.lib to the link step. You may see this warning message upon
compilation:
<P>
<PRE>   adoid.lib(adoid.obj) : warning LNK4099: PDB "dao40.pdb" was not found
                          with "c:\oledbsdk\lib\adoid.lib" or at &lt;path&gt;;
                          linking object as if no debug info

</PRE>This message can be ignored.
<P>
<P><h3>Before You Instantiate Any Classes Created by OLE SDK</h3>
 
<P>
It is important to initialize OLE before creating any instances of ADO
objects using the OLE SDK. You may use the following code snippet:
<P>
<PRE>   struct InitOle {
   InitOle()  { ::CoInitialize(NULL); }
   ~InitOle() { ::CoUninitialize();   }
   } _init_InitOle_;

</PRE>If you have any global BSTRs, this is also a good place to allocate and
deallocate them.
<P>
<P><h3>Error Handling</h3>
 
<P>
With ADO, you may receive an error in the HRESULT returned from an ADO
method. This may or may not result in errors being filled in the ADO Errors
Collection. The Errors collection only receives errors raised by the
underlying provider (or drivers underneath that provider.) ADO errors are
not populated in the collection but can be retrieved from the IErrorInfo
interface.
<P>
The Adovc sample demonstrates how to catch exceptions or errors with ADO.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ADOBJ/Q174565.htm">Q174565</A></B>
   TITLE     : FILE: Adovc.exe Demonstrates How to Use ADO with Visual C++

</PRE><h3>Passing the License Key to ADO and ADO Redistribution</h3>
 
<P>
ADO 1.0 requires a license key when run on any system that has ADO
installed in a mechanism other than a Microsoft product. If the license key
is already installed in the registry, then you do not need to pass a
license key. Otherwise, instead of CoCreateInstance(), you use
CoGetClassObject() to get a IClassFactory2 interface and
CreateInstanceLic().
<P>
<P><h2>REFERENCES</h2>
 

<UL><LI>"Inside COM" by Dale Rogerson ISBN 1-57231-349-8
<P>
</UL>For more information, see the following articles in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID:  <B><A HREF="../ADOBJ/Q168122.htm">Q168122</A></B>
   TITLE:       HOWTO: Redistribute ADO 1.0 or ADO/R 1.0 with OLE/DB 1.1

   ARTICLE-ID:  <B><A HREF="../ADOBJ/Q168354.htm">Q168354</A></B>
   TITLE     :  INFO: Underlying OLE and OLEDB Provider Errors Exposed via
                ADO

   ARTICLE-ID: <B><A HREF="../ADOBJ/Q169496.htm">Q169496</A></B>
   TITLE     : INFO: Using ActiveX Data Objects (ADO) via #import in VC++


   ARTICLE-ID: <B><A HREF="../ADOBJ/Q175993.htm">Q175993</A></B>
   TITLE     : INFO: Using ActiveX Data Objects (ADO) via MFC OLE in VC++


   ARTICLE-ID: <B><A HREF="../ADOBJ/Q176342.htm">Q176342</A></B>
   TITLE     : INFO: Using ActiveX Data Objects (ADO) via OLE SDK in VC++




</PRE> 
<PRE>Keywords          : adoall adovc
Version           : WINDOWS:1.0,1.5
Platform          : WINDOWS
Issue type        : kbhowto kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
