

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: After Installing IE 4.0, ADO May Raise Error 0x800a0bb9 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171223">
<META NAME="KBModify" CONTENT="1998/01/26">
<META NAME="KBCreate" CONTENT="1997/07/09">
<META NAME="Keywords" CONTENT="ado15bug">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  After installing Internet Explorer 4.0 (beta 2), ADODB code using a recordset may raise an error condition with an error code of 0x800A0BB9 or -2147439686. This error code may occur when performing operations that use ADODB.Recordset objects in con...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAH4,QDI2,QBVV,QAW6,QAPN,QAL3,QAKP,QAB4,QAAP,QAGU,QDIX,QALQ,QBQU,QBV9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: After Installing IE 4.0, ADO May Raise Error 0x800a0bb9</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 26, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171223</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After installing Internet Explorer 4.0 (beta 2), ADODB code using a
recordset may raise an error condition with an error code of 0x800A0BB9 or
-2147439686. This error code may occur when performing operations that use
ADODB.Recordset objects in conjunction with other ADODB objects as shown in
the example below:
<P>
<PRE>   dim cnnObj as new ADODB.Connection
   dim rstObj as new ADODB.Recordset
   dim strSource as string
   ...
   rstObj.Open strSource, cnnObj

</PRE>This only occurs if the user has not already installed ADO 1.5.
<P>
<P><h2>CAUSE</h2>
 
<P>
Internet Explorer 4.0 beta installs Msador15.dll, which when registered
puts two sets of PROGIDs in the registry, both of which point to the newer
Recordset CLSID (the one for ADOR 1.0 Recordset and ADODB/ADOR 1.5
Recordset). Only the "ADOR.Recordset" PROGID should be entered in the
registry.
<P>
ADO/R does not utilize the Connection, Command, Errors, or Parameter
objects. Therefore ADODB 1.0 code using these objects fails if the
Recordset object is not correctly registered.
<P>
This issue is a problem only for code that uses
CreateObject("ADODB.Recordset")--including ASP's Server.CreateObject()--but
is not a problem for compiled VB/C++ applications, which avoid the use of
CreateObject() and instead use a TypeLib or other early-binding mechanism.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
After installing Internet Explorer 4.0, the user can go to the following
folder:
<P>
<PRE>   \program files\common files\system\ado

</PRE>Then you can re-register ADO's Recordset object correctly with the
following command:
<P>
<PRE>   regsvr32 msado10.dll

</PRE>However, if the user already has Msado15.dll installed on their system,
then there will not be any conflict as a result of the ADOR registration
bug. You should not re-register Msado10.dll after ADO 1.5 has been
installed on the machine.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This bug only affects users of Active Server Pages 1.0 who install Internet
Explorer (4.0 Beta 2).
<P>
This bug does not affect users of Internet Information Server 4.0 because
it correctly installs the rest of ADODB. It also does not affect anyone who
doesn't use Active Server Pages 1.0.
<P>
 
<PRE>Keywords          : ado15bug
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 26, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
