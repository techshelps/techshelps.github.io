

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cannot Run Setup If Installation Source Is Unavailable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137103">
<META NAME="KBModify" CONTENT="1997/03/05">
<META NAME="KBCreate" CONTENT="1995/09/20">
<META NAME="Keywords" CONTENT="offwinsetup kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  If you install any of the programs listed above, and if you then attempt to run Setup for that program in maintenance mode in order to add or remove components or to uninstall or reinstall the program, you may receive any of the following error mes...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QAH4,QDKX,QBWS,QBVP,QAY2,QAB4,QBJZ,QAIH,QAUR,QAE1,QAEF,QAFI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cannot Run Setup If Installation Source Is Unavailable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137103</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Access 97 for Windows
<LI>Microsoft Access, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft PowerPoint 97 for Windows
<LI>Microsoft PowerPoint for Windows 95, version 7.0
<LI>Microsoft Project for Windows 95, version 4.1
<LI>Microsoft Publisher for Windows 95, version 3.0
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you install any of the programs listed above, and if you then attempt
to run Setup for that program in maintenance mode in order to add or
remove components or to uninstall or reinstall the program, you may
receive any of the following error messages:
<P>
<PRE>   Setup cannot find the files on 'E:\' from which you originally installed
   the product.

   Setup tried to create an invalid path using 'D:\OFFICE95\' and
   'Setup.exe'.

   Setup could not remove the file:
   '\\SERVER\SHARE\OFFICE95\Cdonline\RESULTS.HLP'.

   Setup could not open the file:
   '\\SERVER\SHARE\OFFICE95\Setup.exe'.

</PRE>Note that the paths in these error messages will vary depending on the
program you are using.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur if the location from which the programs were
originally installed is no longer available.
<P>
The original installation location may be unavailable for the following
reasons:

<UL><LI>You installed the program(s) from a CD-ROM drive and the letter
   of the CD-ROM drive has changed as a result of installing a new hard
   disk or a removable disk drive, such as an Iomega ZIP drive.
<P>
   -or-

<LI>You installed the program(s) from a network share (\\SERVER\SHARE, for
   example) that has either been renamed or is no longer available.
<P>
   -or-

<LI>You installed the program(s) from a flat directory, created by
   copying all of the files from the CD-ROM or disks onto your hard
   drive. Since installation was originally completed, the flat
   directory has been deleted from your hard disk or has been moved to
   another location.
<P>
   -or-

<LI>You used FDISK or another disk partition management program to add new
   partitions to your hard drive. As a result, some of your drive letters
   have changed.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
<P><h3>Method 1: Start the setup program from the new location</h3>
 
<P>
Instead of launching the Setup program from either the shortcut for the
Setup program on your hard drive or from Add/Remove Programs in Control
Panel, double-click the Setup.exe file in the new source location.
<P>
<P><h3>Method 2: Modify the Setup.stf file</h3>
 
<P>
In many cases, it is possible to work around this problem by making some
changes to the Setup.stf file used by the Setup program.
<P>
<PRE>   Application                        Setup Table File
   --------------------------------   ----------------
   Microsoft Office 95 Standard       Off95std.Stf
   Microsoft Access 7.0               Acc95.Stf
   Microsoft Office 95 Professional   Off95pro.Stf
   Microsoft Excel 7.0                Xl95.Stf
   Microsoft Word 7.0                 Wrd95.Stf
   Microsoft PowerPoint 7.0           Ppt95.Stf

   Microsoft Office 97 Standard       Off97std.Stf
   Microsoft Office 97 Professional   Off97pro.Stf
   Microsoft Access 97                Acc97.Stf
   Microsoft Excel 97                 Excel97.Stf
   Microsoft Word 97                  Word97.Stf
   Microsoft PowerPoint 97            Ppt97.Stf

</PRE>WARNING: This modification may not be supported by Microsoft Product
Support Services (PSS). PSS will support some modifications to a BACKUP
copy of the Setup.stf file. Note also that while PSS may help customers
modify specific lines of an STF, we will not rewrite the entire file in
order to achieve a desired configuration. As a general rule, support is
limited to options that can normally be changed by a user during a
standard installation of the program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you install Microsoft Office or any of the Microsoft programs listed
above, the location from which the program is being installed is recorded
by the Setup program. When you re-run a program's Setup program, either
to add or remove components or to uninstall or reinstall the program, the
Setup program expects the files it requires to be available in the same
location from which the installation was originally performed.
<P>
If the original installation source is no longer available, the Setup
program may not be able to locate the files that it needs, and you may
receive any of the error messages shown above.
<P>
In some cases, the error messages will be displayed repeatedly: clicking
the Ignore button may allow the Setup program to complete successfully.
In other cases, the Setup program will fail to complete.
<P>
You can use the Find All Files dialog box to locate the Setup.stf file
used by the Setup program that you are trying to run. Once you have
located the Setup.stf file, make a backup copy of the file (name the copy
"BACKUP.STF") and then follow these steps to open the Setup.stf file:

<OL><P><LI>In Microsoft Excel, click the Open on the File menu, and open the
   Setup.stf file that you want to modify.

<P><LI>In the Text Import Wizard dialog box, click the Next button
   until "Step 3 of 3" appears.

<P><LI>In the Text Import Wizard - Step 3 Of 3 dialog box, scroll the Data
   Preview box until the word "ObjId" appears in the first column.

<P><LI>Hold down the SHIFT key on your keyboard.

<P><LI>Use the scroll bar to scroll the Data Preview window as far to the
   right as is possible. You should see the words "Install Directory" in
   the far right column.

<P><LI>Click once on the last column.
<P>
   All of the columns should be highlighted.

<P><LI>Under Column Data Format, click the Text option. Click Finish.
<P>
   Once the file is open, look for the following entries:
<P>
<PRE>   Entry (column A)        Sample values (column B)
   ------------------------------------------------

   Source Directory        \\Server\Share\Office95
                           D:\Office95

   MSAPPS Network Server   \\Server\Share
   MSAPPS Network Drive    J:
   MSAPPS Network Path     \Office95\Msapps

</PRE></OL>Each entry in column B helps to specify the path to the original source
location of the application. You can change the values in column B to
reflect the current location of the application's files.
<P>
For example, if you installed Microsoft Office from a CD-ROM, and if the
CD-ROM drive used to be drive D, you would see "D:\Office95" in column B.
If the CD-ROM drive is now drive E:, you could change the value in column
B next to "Source Directory" to "E:\Office95" (without the quotation
marks).
<P>
Similarly, if you installed Microsoft Office from a network share, and if
the network share has been renamed, the values in column B next to
"Source Directory," "MSAPPS Network Server," "MSAPPS Network Drive," and
"MSAPPS Network Path," would need to be changed to reflect the current
path to the installation files. Each line should have a value similar to
the following:
<P>
<PRE>   Entry (Column A)        Sample Value(s) (Column B)
   ----------------------------------------------------------------
   Source Directory        \\&lt;server&gt;\&lt;share&gt;\&lt;path to Setup.exe&gt;
   MSAPPS Network Server   \\&lt;server&gt;\&lt;share&gt;
   MSAPPS Network Drive    &lt;a drive letter that points to the share&gt;
   MSAPPS Network Path     \&lt;path to Setup.exe &gt;\Msapps

</PRE>Once you have made the necessary changes, you need to save and close the
Setup.stf file:

<OL><P><LI>Select the entire worksheet by pressing CTRL+SHIFT+SPACEBAR.

<P><LI>On the Format menu, click Column, and then click Column AutoFit
   Selection.

<P><LI>On the File menu, click Save As.

<P><LI>In the Save As dialog box, make sure that the Save As Type box
   contains the Text (Tab Delimited) item. The name of the file should
   be "Setup.stf".

<P><LI>To save the file, click Save or OK.

<P><LI>On the File menu, click Close to close the STF file. If you are
   prompted to save the file, click the No button.
<P>
</OL>After you save and close the file, you should be able to run the Setup
program and add or remove components, or uninstall or reinstall the
application.
<P>
If you installed a program from a flat directory that is no longer
available because it has been deleted, you may need to re-create the flat
directory, and then run the Setup program (that is, modification of the
Setup.stf file may not work in this case).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.0 4.10 7.00 8.00 97 problems pub pub95<BR>
publisher
<P>

Keywords            : offwinsetup kbsetup<BR>
Version             : 7.00 97<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
