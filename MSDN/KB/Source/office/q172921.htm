

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF97: Unable to Insert CGM File Running Under Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172921">
<META NAME="KBModify" CONTENT="1997/12/17">
<META NAME="KBCreate" CONTENT="1997/08/20">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you insert a Computer Graphics Metafile (CGM) file in a Microsoft Office program, the Basic Options dialog box appears. When you click OK, the Convert File dialog box appears displaying a list of graphics file types. If you select Computer Gra...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAH2,QAB4,QBWS,QACI,QDKX,QBWG,QA9N,QAB5,QAK7,QA1S,QBVV,QA01,QAH5,QAJQ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Unable to Insert CGM File Running Under Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172921</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 Professional Edition for Windows
<LI>Microsoft Windows NT versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you insert a Computer Graphics Metafile (CGM) file in a Microsoft
Office program, the Basic Options dialog box appears. When you click OK,
the Convert File dialog box appears displaying a list of graphics file
types. If you select Computer Graphics Metafile, you receive the following
error message:
<P>
<PRE>   An error occurred while importing this file. &lt;filename&gt;

</PRE>where &lt;filename&gt; is the full path and file name of the CGM file being
inserted.
<P>
If you select anything other than Computer Graphics Metafile, the Basic
Options dialog box will appear again. If you click OK, you will
receive the same error message.
<P>
<P>
NOTE: Your symptoms may vary. For example, the dialog boxes may not appear
in the same order listed. In Microsoft Access, you do not receive an error
message when you try to insert a CGM file, but the insert does not succeed.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs if the following are true:

<UL><LI>Microsoft Office 97 is installed on Windows NT version 3.51 or 4.0.
<P>
   -and-

<LI>You logged in without Administrator permissions to the registry.
<P>
   -and-

<LI>You do not have Create Link, Write DAC, and Write Owner permissions for
   the following key in the registry:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\Graphic
      Filters\Import\CGM
</PRE><P>
   NOTE: By default, users who log in as User or Guest only have Special
   Access permissions to this key. Create Link, Write DAC, and Write Owner
   permissions are necessary for the CGM filter to insert a CGM file. A
   user with Administrator permissions has Full Control permissions on this
   registry key, so they will not receive an error message.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To insert a CGM file, you must either have Administrator permissions for
the registry, or your permissions for the
HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\Graphic
Filters\Import\CGM registry key must be set to Full Control.
<P>
WARNING: Using Registry Editor incorrectly can cause serious,
system-wide problems that may require you to reinstall Windows NT to
correct them. Microsoft cannot guarantee that any problems resulting
from the use of Registry Editor can be solved. Use this tool at your
own risk.
<P>
Follow these steps to set Full Control permissions for the CGM registry
key:

<OL><P><LI>Log into Windows NT as Administrator.

<P><LI>Click Start, and then click Run.

<P><LI>In the Open box, type "regedt32" (without the quotation marks), and
    then click OK.
<P>
    This will start the 32-bit version of the Registry Editor. If you run
    Regedit.exe instead of Regedt32.exe, you cannot change the registry
    security permissions.

<P><LI>In the Registry Editor, click the window titled HKEY_LOCAL_MACHINE.

<P><LI>Select the following registry key:
<P>
       HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\Graphic
       Filters\Import\CGM

<P><LI>On the Security menu, click Permissions.

<P><LI>In the Registry Key Permissions dialog box, click the "Replace
    Permission on Existing Subkeys" check box.

<P><LI>In the Name list, double-click Everyone.

<P><LI>In the Special Access dialog box, click Full Control (All).
<P>
    This will change the permissions from Special Access to Full Control
    for the key and all its subkeys.

<P><LI>Click OK twice.

<P><LI>Close the Registry Editor.
<P>
</OL>After completing these steps, anyone that logs in at this computer will be
able to insert CGM files.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Office 97 when
running under Windows NT versions 3.51 and 4.0. We are researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior does not occur with any of the other graphics filters.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 8.0<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
