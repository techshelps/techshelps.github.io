

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF97: Setting the Default Shared Templates Location </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178373">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/12/19">
<META NAME="Keywords" CONTENT="offadmin offNIW">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QBWS,QAA1,QABA,QAFI,QA36,QDI2,QBDM,QASR,QAVZ,QDH3,QBJZ,QAUR,QDIU,QBVP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Setting the Default Shared Templates Location</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178373</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains instructions for setting the shared templates
location using the Network Installation Wizard.
<P>
IMPORTANT: Use version 2.1 of the Network Installation Wizard to modify
the Microsoft Office Setup files.
<P>
To access the Network Installation Wizard on the Web, connect to the
following Web site:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/office/ork/">http://www.microsoft.com/office/ork/</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE>NOTE: Another method of setting the shared workgroup templates location is
through a system policy file. For more information about using System
Policy Editor to create a policy file, see chapter 7 in the Microsoft
Office 97 Resource Kit.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: This modification may not be supported by Microsoft. Microsoft
support engineers will support some modifications to a BACKUP copy of the
Setup.stf file. Note also that while support engineers may help customers
modify specific lines of an STF, we will not rewrite the entire file in
order to achieve a desired configuration. As a general rule, support is
limited to options that can normally be changed by a user during a
standard installation of the application.
<P>
NOTE: The following steps work only if you first perform an administrative
installation (setup /a) of Office 97 to a server on your network. If you
are performing a stand-alone installation using the Office 97 compact disc,
you should not use the steps in this article.
<P>
Before you perform the following steps, make a backup copy of the
Off97pro.stf or Off97std.stf file on your server. Rename the file to
Backup.stf and do not open or edit it for any reason.

<OL><P><LI>Start the Network Installation Wizard. Open the LST file that you want
   to use.
<P>
   NOTE: The Network Installation Wizard opens the appropriate STF and INF
   files for editing.

<P><LI>Click Next to continue through the wizard until you reach the Add
   Registry Entries dialog box.

<P><LI>Add the following two keys and the associated values to the registry.
<P>
<P><PRE>    Key 1
    -----
</PRE><P>
<PRE>      Item            Value
      ----------------------------------

      Root:           HKEY_Local_Machine

      Data type:      SZ

      Key:            Software\Microsoft\Office\8.0\New User Settings\
                      Common\FileNew\SharedTemplates

      Value name:     SharedTemplates

      Value data:     &lt;folder you want to use for shared templates&gt;

    Key 2
    -----

      Item            Value
      ----------------------------------

      Root:           HKEY_Current_User

      Data type:      SZ

      Key:            Software\Microsoft\Office\8.0\Common\FileNew\
                      SharedTemplates

      Value name:     SharedTemplates

      Value data:     &lt;folder you want to use for shared templates&gt;

</PRE><P><LI>After you add the settings to the registry, click Next.

<P><LI>In the Select Quiet Mode dialog box, select the Quiet Level that you
   want, and then click Next.

<P><LI>In the Save Changes dialog box, type the file names for your customized
   Setup files, and then click Finish.
<P>
</OL><h3>Additional Steps to Modify the STF</h3>
 
<P>
Before you continue with the steps in this section, see the "Opening the
STF for Editing" section in this article for instructions for opening the
STF file.
<P>
After you follow the instructions for opening the STF in Microsoft Excel,
follow these steps to make the necessary changes:

<OL><P><LI>Scroll to the end of the worksheet to the custom entries you added.
   Locate the first custom entry and change column F to the following
   (including the quotation marks):
<P>
<P><PRE>      "LOCAL", "Software\Microsoft\Office\8.0\New User Settings\Common\
      FileNew\SharedTemplates", "", "&lt;Templates Folder&gt;", ""
</PRE><P>
   Note that &lt;Templates Folder&gt; is the disk drive and folder name. For
   example, you could type the following:
<P>
<P><PRE>      "H:\Templates"
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      "H:\Templates\Word"
</PRE><P>
   NOTE: You can use a universal naming convention (UNC) path for the
   &lt;Templates Folder&gt; setting, but do not include an environment variable.
   See the following examples:
<P>
<P><PRE>    Correct
    -------
</PRE><P>
<P><PRE>    "\\Server1\Templates"
</PRE><P>
<P><PRE>    Incorrect
    ---------
</PRE><P>
<P><PRE>    "\\Server1\Templates\%UserName%"
</PRE><P>
   NOTE: You can also delete the settings for columns B, C, and D for this
   row because they are not used.

<P><LI>The second custom entry for the Shared Templates location should read
   as follows (including the quotation marks):
<P>
<P><PRE>      "CURRENT", "Software\Microsoft\Office\8.0\Common\FileNew\
      SharedTemplates", "", "&lt;Templates Folder&gt;", ""
</PRE><P>
   Note that &lt;Templates Folder&gt; is the disk drive and folder name.
<P>
   NOTE: You can delete the settings for columns B, C, and D for this row
   because they are not used.
<P>
</OL>After you save the changes in the custom STF file, you can use the STF file
by using the command line parameters in the last dialog box of the Network
Installation Wizard.
<P>
When you run Microsoft Office 97 Setup by using the modified STF file, the
default shared templates folder is automatically changed.
<P>
<P><h3>Opening the STF for Editing</h3>
 
<P>
When you open the Microsoft Office Setup Table File (STF), you must use a
certain process to avoid damaging the integrity of the file. To do this,
follow these steps:

<OL><P><LI>Make a backup copy of the original .stf file.

<P><LI>Open the document in Microsoft Word.

<P><LI>On the Edit menu, click Replace. In the Find What box, type the
    following (without the quotation marks):
<P>
       "^t "
<P>
    Note that there is a space after the letter "t."
<P>
    In the Replace With box, type the following (without the quotation
    marks):
<P>
       "^t"
<P>
    Click Replace All. Click Close.
<P>
    NOTE: You cannot use ^t^w in the Find What box because ^w replaces
    a tab followed by second tab as well as a tab followed by a space. You
    want to replace only tabs followed by spaces (&lt;tab&gt;&lt;space&gt;).

<P><LI>On the File menu, click Save As. In the Save As Type list, click
    Text Only (*.txt). The File Name box should contain either:
<P>
       Off97Pro.stf.txt (for the Office 97 Professional Edition)
<P>
       -or-
<P>
       Off97Std.stf.txt (for the Office 97 Standard Edition)
<P>
    Click Save, and then quit Microsoft Word.

<P><LI>Click Start, point to Programs, and then click Windows Explorer.

<P><LI>On the View menu, click Options, and then click the View tab.

<P><LI>Clear the "Hide file extensions for known file types" check box. Click
    OK.

<P><LI>In the folder in which you saved the .stf file, rename the file to its
    original file name of:
<P>
       Off97Pro.stf (for the Office 97 Professional Edition)
<P>
       -or-
<P>
       Off97Std.stf (for the Office 97 Standard Edition)

<P><LI>In Microsoft Excel, open the .stf file you want to edit.

<P><LI>In the Text Import Wizard dialog box, click Next twice to proceed to
    the Step 3 of 3 dialog box.

<P><LI>In the "Text Import Wizard - Step 3 Of 3" dialog box, under Data
    Preview, drag the vertical scroll box all the way down and drag the
    horizontal scroll box all the way to the right. Hold the SHIFT key
    down, and then click the last column. All of the columns should be
    selected.

<P><LI>Under Column Data Format, click Text, and then click Finish.
<P>
</OL>For more information about editing the STF file in Microsoft Excel, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q162796.htm">Q162796</A></B>
   TITLE     : OFF97: Setup Error 932 After Modifying STF File
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: admin install workstation network server<BR>
Keywords          : offadmin offNIW<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
