

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF97: How to Use Custom STF Files with MS Office 97 Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158281">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/10/28">
<META NAME="Keywords" CONTENT="offNIW OffWinSetup kbfaq kbsetup kbtool">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you run the Microsoft Office 97 Setup program, you may receive the following error messages:     Setup Error 544    Setup is unable to open the data file    'H:\~MSSETUP.T\~MSSTFOF.T\custom.stf'; run    Setup again from where you originally ra...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QDKX,QARW,QBWS,QBJZ,QDH3,QAB4,QAUJ,QAKR,QAHE,QAH4,QDNE,QAGB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: How to Use Custom STF Files with MS Office 97 Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158281</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Microsoft Office 97 Setup program, you may receive the
following error messages:
<P>
<PRE>   Setup Error 544
   Setup is unable to open the data file
   'H:\~MSSETUP.T\~MSSTFOF.T\custom.stf'; run
   Setup again from where you originally ran it.

   -and-

   Setup Error 723
   Setup was unable to read configuration information
   from the first section of the setup file:
   H:\~MSSETUP.T\~MSSTFOF.T\custom.stf.

</PRE>When you click OK for the second error message, you exit the Setup program.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem will occur if the following conditions are true:

<UL><LI>You used the Microsoft Office 97 Network Installation Wizard (NIW) to
   create a custom setup table file (.stf) for use with Microsoft Office
   97.
<P>
   -and-

<LI>You ran the Microsoft Office 97 Setup program with the "/t" switch.
   For example:
<P>
<P><PRE>      setup /t custom.stf
</PRE><P>
</UL><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, you must make a copy of your
Setup.lst file, and rename it so that it matches your custom setup table
file. Then, modify it so that all references to "Off97pro.stf" within the
renamed .lst file are replaced with references to your custom setup table
file.
<P>
NOTE: If you use version 2.1 of the Network Installation Wizard (NIW 2.1)
to customize your setup table file, it is not necessary to create a custom
.lst file; NIW 2.1 does this automatically. Proceed to the step after step
14 to use the customized .lst and .stf files.
<P>
For example, if you created a Custom.stf file, you need to create a
Custom.lst file and then modify it. To do this:

<OL><P><LI>In Windows Explorer, go to the folder on your network server that
    contains the administrative installation of Microsoft Office 97.

<P><LI>Locate the Setup.lst file. Right-click the file, and then click Copy
    on the shortcut menu.

<P><LI>On the Edit menu, click Paste.

<P><LI>Select the "Copy of Setup.lst" file. On the File menu, click
    Rename. Type "Custom.lst", without quotation marks, and click OK.

<P><LI>Right-click the Custom.lst file. Click "Open With" on the shortcut
    menu.

<P><LI>In the list of programs, click Notepad. Clear the "Always use this
    program" check box. Click OK.

<P><LI>In Notepad, click Find on the Search menu.

<P><LI>In the Find What box, type "Off97pro.stf", without quotation marks.
    Click Find Next.

<P><LI>When a reference to "Off97pro.stf" is selected, click Cancel.

<P><LI>Delete "Off97pro.stf" and type "Custom.stf", without quotation marks,
    in its place.

<P><LI>Press F3.

<P><LI>Delete the selected reference to "Off97pro.stf", and type
    "Custom.stf" in its place.

<P><LI>Repeat steps 11 and 12 until you receive the message
<P>
       Cannot find "Off97pro.stf"
<P>
    Click OK.

<P><LI>On the File menu, click Save. Then, click Exit on the File menu.
<P>
</OL>After the Custom.lst file has been created and modified, you can run your
customized Setup by using the following command line:
<P>
<PRE>   &lt;path&gt;\setup /l custom.lst

</PRE></OL>where &lt;path&gt; is the path to Setup.exe. Note that the name of the Custom.stf
is NOT included in this command; the Custom.lst file knows what setup table
file to use.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design of the Microsoft Office 97 Setup program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Office 97 Network Installation Wizard (NIW) allows you to
create custom setup solutions for Microsoft Office 97. To use the NIW, you
must first perform an administrative installation ("setup /a") of Microsoft
Office 97 on a network server. After this is done, you can run the NIW,
choose various setup options, and create a customized setup table file.
<P>
In Microsoft Office for Windows 95 version 7.0, you instruct the Setup
program to use a custom setup table file by adding the "/t" switch and the
name of the setup table file to your command line. For example:
<P>
<PRE>   setup /t custom.stf

</PRE>Microsoft Office 97 uses a slightly different method of loading files when
you run the Setup program. Instead of using the "/t" switch, you now use
the "/l" switch, followed by the name of a customized .lst file. This .lst
file contains the name of the custom setup table file you want to use. For
example, if your custom files are Custom.lst and Custom.stf, you would use
the following command line:
<P>
<PRE>   setup /l custom.lst

</PRE>Since Custom.lst contains references to Custom.stf, Custom.stf is then
automatically used by the Setup program.
<P>
NOTE: It is very important that the names of the .lst and the .stf file are
the same. For example, if your .lst file is named Custom.lst, your .stf
file should be named Custom.stf. If the file names do not match, you may
receive the following error message:
<P>
<PRE>   Setup Error 530
   This is an invalid command line option.

</PRE>Other switches, such as "/q", "/q0", "/q1", and "/qt", can still be used in
the command line. Their functionality has not changed. To perform a quiet
mode installation of Microsoft Office 97 using the custom setup table file
and .lst file, use the following command:
<P>
<PRE>   setup /l custom.lst /q1
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 8.00<BR>
Keywords          : offNIW OffWinSetup kbfaq kbsetup kbtool<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
