

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF97: "I/O Error" Creating New Data Source Under Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173158">
<META NAME="KBModify" CONTENT="1997/08/27">
<META NAME="KBCreate" CONTENT="1997/08/26">
<META NAME="Keywords" CONTENT="offrfs OffWinSetup xlquery kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you point to Get External Data on the Data menu, and then click Create New Query to create a new data source, you may receive the following error message:     Microsoft Query    I/O error during save. You may have typed an...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAA1,QDI2,QBWP,QDH3,QAEF,QBVP,QAB4,QAFI,QBWS,QDNE,QDO3,QAH4,QAK6,QDL9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: "I/O Error" Creating New Data Source Under Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173158</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you point to Get External Data on the Data menu,
and then click Create New Query to create a new data source, you may
receive the following error message:
<P>
<PRE>   Microsoft Query
   I/O error during save. You may have typed an invalid file name.

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur if all of the following conditions are true:

<UL><LI>Your computer is running Microsoft Windows NT version 4.0.
<P>
   -and-

<LI>You install Service Pack 3 (SP3) for Windows NT 4.0.
<P>
   -and-

<LI>You then perform a Run From Network Server (RFS) installation of
   Microsoft Office 97 from a server that contains an administrative
   installation of Microsoft Office 97.
<P>
</UL>NOTE: This problem does not occur if you are running Microsoft Windows 95,
if you perform a Typical or Custom installation of Microsoft Office 97 from
a CD or an administrative installation point, or if you install Microsoft
Office 97 before you install Service Pack 3.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, follow these steps:

<OL><P><LI>Quit all running programs.

<P><LI>Use Windows NT Explorer to go to the Winnt\System32 folder on
   the hard disk. Delete or rename the following file:
<P>
<P><PRE>      Odbc32.dll
</PRE>
<P><LI>On the Start menu, point to Settings, and click Control Panel. In the
   Control Panel, double-click Add/Remove Programs. Click the
   Install/Uninstall tab. In the list of programs, click Microsoft Office
   97. Then, click Add/Remove.

<P><LI>In the Microsoft Office 97 Setup dialog box, click Remove All. When
   you are prompted to remove Microsoft Office 97, click Yes. When you are
   prompted to remove shared components, click Yes.

<P><LI>After Microsoft Office 97 is removed from your computer, reconnect
   to the network server that contains the administrative installation
   point for Microsoft Office 97, and then run the Setup program located
   on the server.

<P><LI>Install Microsoft Office 97.
<P>
</OL>After you install Microsoft Office 97, start Microsoft Excel 97. You can
then create a new data source.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following combination of factors cause this problem to occur:

<UL><LI>Service Pack 3 for Microsoft Windows NT 4.0 includes a copy of the file
   Odbc32.dll. When you install Service Pack 3 on your computer,
   Odbc32.dll is installed in the Winnt\System32 folder.

<LI>When you install Microsoft Office 97 on your computer, the Setup
   program checks for the existence of the Odbc32.dll file in the
   Winnt\System32 folder. If the program locates a newer version of the
   file, it assumes that certain keys exist in the registry. As a result,
   the Setup program does not attempt to create or update the keys.

<LI>If the Microsoft Office 97 Setup program detects that a newer version
   of Odbc32.dll already exists in the Winnt\System32 folder, it does
   not create the following registry key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\odbc.ini\ODBC File DSN\
<PRE></PRE>         DefaultDSNDir

   The value of this key is usually the following:

      C:\WINDOWS\ODBC\Data Sources

</PRE><LI>If this key is missing and you create a new data source by using
   Microsoft Excel 97 and Microsoft Query 97, the new data source is
   created in the default installation folder. Usually, this folder is
   Program Files\Microsoft Office\Office.
<P>
   However, if you performed a Run From Network Server installation of
   Microsoft Office 97, the default installation folder is located on
   the network server. Because this folder is usually a read-only folder,
   the new data source cannot be saved in the folder, and you receive the
   error message.
<P>
</UL>If you install Microsoft Office 97 BEFORE you install Service Pack 3, the
Setup program creates the correct registry keys, and you are able to create
new data sources without receiving this error message.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 XL97<BR>
Keywords          : offrfs OffWinSetup xlquery kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
