

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF: Setup Cannot Locate the Program Files Folder </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164808">
<META NAME="KBModify" CONTENT="1997/03/14">
<META NAME="KBCreate" CONTENT="1997/03/07">
<META NAME="Keywords" CONTENT="kbusage OffWinSetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   When you run t...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAFI,QAA1,QDL9,QBWO,QBWN,QAH4,QDI2,QBI9,QDH3,QBS0,QA1S,QBWS,QDIZ,QAYY P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF: Setup Cannot Locate the Program Files Folder</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164808</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Office for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Microsoft Office Setup program, the Setup program may
fail to identify the Program Files folder on your computer. The Setup
program may then attempt to install certain Microsoft Office components
(see the "More Information" section) in a folder other than the Program
Files folder.
<P>
NOTE: This behavior occurs regardless of the type of installation (Typical,
Custom, and so on) you perform.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Microsoft Office Setup program determines the location of the Program
Files and Common Files folders by checking the following registry keys:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\
      ProgramFilesDir

   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\
      CommonFilesDir

</PRE>If these keys contain an incorrect drive letter or path information,
Microsoft Office Setup may be unable to install files in the existing
Program Files folder.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
For the Microsoft Office Setup program to detect the path to the Program
Files folder, you must correct the path in the registry keys. To do this,
use the following steps:

<OL><P><LI>On the Start menu, click Run.

<P><LI>In the Open box, type "regedit" (without the quotation marks) and click
   OK.

<P><LI>Double-click the plus sign (+) to the left of the following items in
   order
<P>
<P><PRE>      HKEY_LOCAL_MACHINE
      SOFTWARE
      Microsoft
      Windows
      CurrentVersion
</PRE><P>
   to open the following registry key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion
</PRE>
<P><LI>In the value pane, note the value to the right of ProgramFilesDir.
   If the folder name does not exist on your hard disk, proceed to step 5.
   Otherwise, skip step 5.

<P><LI>Click ProgramFilesDir. On the Edit menu, click Modify. In the Value Data
   box, type the correct path to the Program Files folder (for example,
   C:\Programs). Then, click OK.

<P><LI>In the value pane, look at the value to the right of CommonFilesDir.
   If the folder name does not exist on your hard disk, proceed to step 7.
   Otherwise, skip step 7.

<P><LI>Click CommonFilesDir. On the Edit menu, click Modify. In the Value Data
   box, type the correct path to the Common Files folder (for example,
   C:\Common). Then, click OK.

<P><LI>On the Registry menu, click Exit.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Office 97</h3>
 
<P>
The Microsoft Office 97 components that are automatically installed in the
Program Files folder are the following:
<P>
<PRE>   Microsoft Excel:
   
      Microsoft Map
   
   Microsoft Word:
   
      Help
      Proofing Tools
      Text Converters
   
   Microsoft Powerpoint:
   
      Help
   
   Data Access:
   
      Data Access Objects for Visual Basic
   
   Office Tools:
   
      Spelling Checker
      Organizational Chart
      Equation Editor
      Microsoft Photo Editor
      MS Info
      Clip Gallery
      Find All Word Forms
   
   Converters and Filters:
   
      Text Converters
      Graphics Filters

</PRE></OL><h3>Microsoft Office 95</h3>
 
<P>
The Microsoft Office 95 components that are automatically installed in the
Program Files folder are the following:
<P>
<PRE>   Microsoft Excel:
   
      Help for Visual Basic
      Microsoft Map
   
   Microsoft Word:
   
      Hyphenation
      Grammar
      Thesaurus
      Lotus 1-2-3 Converter
      Text with Layout Converter
   
   Office Tools:
   
      Spelling Checker
      WordArt
      Organizational Chart
      Microsoft Graph version 5.0
      Microsoft Graph version 5.0 Help
      Equation Editor
      MS Info
      Clip Art Gallery
      Find All Word Forms
   
   Converters, Filters and Data Access:
   
      Converters
      Filters
      Microsoft Query
      Data Access Objects for Visual Basic
      Help for Data Access Objects

</PRE><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q157030.htm">Q157030</A></B>
   TITLE     : OFF97: Change Directory Unavailable for Office Tools
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97<BR>
Keywords            : kbusage OffWinSetup<BR>
Version             : 7.0 7.0a 97<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
