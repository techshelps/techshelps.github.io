

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF97: Invalid Page Fault in OLE32.DLL Closing Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180188">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/01/30">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT=" WARNING: The information in this article has not been confirmed or tested by Microsoft. Some or all of the information in this article has been taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS AT...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QBUP,QAB4,QAH4,QAIH,QBVP,QAGB,QAHI,QDOF,QDMH,QAUR,QAIJ,QBBK,QBV0,QAYC P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Invalid Page Fault in OLE32.DLL Closing Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180188</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
WARNING: The information in this article has not been confirmed or tested
by Microsoft. Some or all of the information in this article has been taken
from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION
PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this
information "as is" without warranty of any kind, either express or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you close a Microsoft Word document or a Microsoft Excel workbook, you
may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, an error message similar to the following appears:
<P>
<PRE>   &lt;PROGRAM&gt; caused an invalid page fault in module OLE32.DLL at &lt;address&gt;

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur if the Office item log file, Offitems.log, is
damaged.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To troubleshoot this error, attempt to isolate the problem to corruption in
the Offitems.log log file, which is located in your Windows folder.
<P>
To check for corruption in the log file, follow these steps:

<OL><P><LI>Close all programs.

<P><LI>Rename the Offitems.log file (to Offitems.old for example).

<P><LI>Restart Word or Excel, open a file, make a change to the file, save the
   file, and then close the file.

<P><LI>If the error does not appear, the problem has been isolated.

<P><LI>If the error reappears, close Word or Excel.

<P><LI>Find the file called OLE2.REG and double-click the file name.

<P><LI>Click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The log file, Offitems.log, stores journal information into Microsoft
Outlook on the create, open, close and save events for any file in Office
97. If renaming the log file allows Outlook to start successfully, Outlook
regenerates the log files. However, any journal information contained in
the original log file will be lost.
<P>
The Outlook Journal process automatically records a log of user activities.
Each of the Office 97 programs provides AutoJournal capabilities, logging
to an Outlook Journal entry each time you open, save, or print a document.
With the Journal and the Outlook 97 timeline view, you can find information
based on when you worked on a document, and not worry about where you saved
it or what you named it. To configure Outlook 97 to use the AutoJournal
feature, use the Journal tab on the Options dialog box. With this you can
add, remove, and edit the types of AutoJournal entries.
<P>
If you turn on Outlook AutoJournal for any of the Office 97 programs,
Outlook tries to record activities of the Office program directly to the
Outlook Journal. When Outlook is not running, the Office program makes a
call to Mso97.dll that causes the journal entry to write to "Offitems.log"
in the Windows directory. When Outlook starts, the Journal processes these
entries after a Messaging Application Programming Interface (MAPI) idle
time of 30 seconds.
<P>
For more information on the Journal feature of Outlook, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A HREF="../URJump.htm">Q172002</A></B>
   Title     : Setting Outlook Journal Registry Entries

   Article-ID: <B><A HREF="../OUTLOOK/Q167975.htm">Q167975</A></B>
   Title     : Office Programs Stop Responding While Outlook is Busy

   Article-ID: <B><A HREF="../OUTLOOK/Q167975.htm">Q167975</A></B>
   Title     : OL97: Office Programs Stop Responding While Outlook Is Busy

   Article-ID: <B><A HREF="../OUTLOOK/Q166850.htm">Q166850</A></B>
   Title     : OL97: Outlook Starts Slowly with AutoJournal Feature
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: word8 word97<BR>
Keywords          : kbinterop<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
