

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Switch from MAPI to VIM Electronic Mail Support </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109833">
<META NAME="KBModify" CONTENT="1996/09/10">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="kbusage kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  This article describes how the Word for Windows Setup program installs support for electronic mail (email) programs and how you can modify your Windows settings to support one of two different electronic mail interface protocols: messaging applicat...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAIH,QAL7,QDL9,QBWO,QBWN,QABA,QAA1,QBWQ,QBAO,QDO7,QDI2,QBXS,QAH4,QDNN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Switch from MAPI to VIM Electronic Mail Support</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 10, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109833</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows, version 4.2, 4.3
<LI>Microsoft Word for Windows, version, 6.0, 6.0a
<LI>Microsoft Windows operating system version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how the Word for Windows Setup program installs
support for electronic mail (email) programs and how you can modify your
Windows settings to support one of two different electronic mail interface
protocols: messaging application programming interface (MAPI) and vendor
independent messaging (VIM is used by the Lotus cc:Mail electronic mail
program).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
All of the Microsoft Office for Windows programs (namely, Microsoft
Word, Microsoft Excel, Microsoft Mail, Microsoft PowerPoint, and Microsoft
Access) support the MAPI interface protocol by default. To support VIM
electronic mail systems, they use a MAPI-to-VIM translation DLL
(MAPIVIM.DLL). The following two diagrams show the route Word uses when you
send electronic mail using the Send command on the File menu:
<P>
<PRE>   Microsoft Mail                Lotus cc:Mail
   ------------------------------------------

   File Send                     File Send
       |                             |
   MAPI.DLL                      MAPIVIM.DLL
       |                             |
   Microsoft Mail                VIM.DLL or SMI.DLL
                                     |
                                 cc:Mail

</PRE><h3>How Word Installs Electronic Mail Support</h3>
 

<OL><P><LI>The Word Setup program searches the Windows WIN.INI file for the
   following setting, which indicates that a VIM-compliant email
   program (such as cc:Mail) is installed on your computer
<P>
<P><PRE>      [Mail]
      MAPIDLL=&lt;WINDOWS&gt;\SYSTEM\MAPIVIM.DLL
</PRE><P>
   where &lt;WINDOWS&gt; is the location of your Windows program directory (for
   example, "C:\WINDOWS"). If Setup finds this setting, it copies the
   MAPIVIM.DLL file to your &lt;WINDOWS&gt;\SYSTEM subdirectory and updates the
   MAPIDLL setting in your WIN.INI file to reflect the location of the new
   MAPIVIM.DLL file.
<P>
   If the MAPIDLL setting points to a different .DLL file, Microsoft
   Office programs use the MAPI functions in the specified .DLL
   instead of MAPI.DLL.

<P><LI>If Setup does not find the above MAPIDLL setting, it searches the
   WIN.INI file for the following setting, which indicates that a
   MAPI-compliant email application (such as Microsoft Mail) is
   installed on your computer:
<P>
<P><PRE>      [Mail]
      MAPI=1
</PRE><P>
   NOTE: If Setup installs MAPI support, it deletes any MAPIDLL entry from
   your WIN.INI file, if one exists.

<P><LI>If Setup detects both MAPI and VIM on your system, it prompts you to
   select which messaging system to support.
<P>
</OL><h3>How Word Determines Whether to Add Mail Commands to Menus</h3>
 
<P>
When you start the program, Word uses the following criteria to determine
whether to add electronic mail commands to your menus (mail commands
include the Send and Add Routing Slip commands on the File menu and the
Merge To Electronic Mail selection in the mail merge helper):

<UL><LI>When you start Word, it checks for the MAPIDLL= entry in the [Mail]
   section of your WIN.INI file. If Word finds this entry, it attempts to
   load the .DLL file from the listed location. If the MAPIDLL setting is
   invalid, or if the .DLL file is missing, Word looks for the .DLL file on
   the PATH (for Lotus CC:Mail, Word loads MAPIVIM.DLL if it finds VIM.DLL
   on the PATH). If Word cannot load the .DLL, it concludes that electronic
   mail functionality is unavailable, so it does not add mail commands to
   your Word menus.

<LI>If Word does not find the MAPIDLL= entry, it looks for the MAPI=1 entry
   in the [Mail] section of your WIN.INI file. If Word finds this entry, it
   attempts to load MAPI.DLL from a directory on the PATH. If Word cannot
   find MAPI.DLL or if the MAPI= setting is 0 (zero), Word concludes that
   electronic mail functionality is unavailable, so it does not add mail
   commands to your Word menus.
<P>
</UL>If the electronic mail commands are missing in Word, check the following:

<OL><P><LI>Make sure the MAPIDLL= OR MAPI=1 setting is present in the [Mail]
   section of your WIN.INI file and that it points to a valid file in
   a valid location on your PATH statement. Add or correct the entry if
   necessary.

<P><LI>Check the PATH statement in your AUTOEXEC.BAT file to be sure it
   includes the location of the MAPIDLL file or MAPI.DLL.

<P><LI>If the problem persists, replace your existing .DLL file with a fresh
   copy. This rules out the possibility that the .DLL file is damaged.
<P>
</OL><h3>How to Switch from One Mail System to Another</h3>
 
<P>
When you access email from Word, Word searches first for the MAPIDLL
setting. If it finds this setting, Word supports VIM-compliant email
systems. If it doesn't find it, Word then searches for the MAPI=1 setting
and, if it finds it, it supports MAPI-compliant email systems.
<P>
If you work on a network that uses both MAPI- and VIM-compliant email
programs, you may want Word to be able to switch back and forth between
the two applications. To do this, add both of the above settings to the
[Mail] section of your WIN.INI file. When you want to use a MAPI-compliant
email program, comment the MAPIDLL line to deactivate it (to comment a
line in the WIN.INI file, type a semicolon [;] at the beginning of the
line). The following sample WIN.INI entries demonstrate this procedure:
<P>
To use a MAPI-compliant email program (such as Microsoft Mail), comment the
MAPIDLL line:
<P>
<PRE>   [Mail]
   ;MAPIDLL=&lt;WINDOWS&gt;\SYSTEM\MAPIVIM.DLL
   MAPI=1

</PRE></OL>To use a VIM-compliant email program (such as cc:Mail), remove the
semicolon (;) from the MAPIDLL line to reactivate it:
<P>
<PRE>   [Mail]
   MAPIDLL=&lt;WINDOWS&gt;\SYSTEM\MAPIVIM.DLL
   MAPI=1

</PRE>NOTE: If Word Setup did not install the MAPIVIM.DLL file (this happens if
there was no MAPIDLL line in your WIN.INI file), you must copy it from the
original Word disks and decompress it in your &lt;WINDOWS&gt;\SYSTEM
subdirectory. For instructions on manually decompressing a file, see pages
11-12 in the Microsoft Word 6.0 "Quick Results" manual. If you have 3.5-
inch disks, MAPIVIM.DLL is located on Disk 7; if you have 5.25-inch disks,
MAPIVIM.DLL is on Disk 8.
<P>
For more information on using cc:Mail with Word for Windows, query on the
following words in the Microsoft Knowledge Base:
<P>
<PRE>   cc:mail and mapivim.dll and lotus

</PRE>The cc:Mail products included here are manufactured by Lotus Development
Corporation, vendors independent of Microsoft; we make no warranty, implied
or otherwise, regarding these products' performance or reliability.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Quick Results," for Microsoft Word version 6.0, pages 11-12
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kb3rdparty<BR>
KBSubcategory: offwin
<P>

Additional reference words: kbsetup w4wnetwork msmail e-mail ccmail winppt<BR>
officeinterop smartsuite 6.00 6.00a 4.20 4.30 word6 send routing available<BR>
file menu can't send mail macppt can't email
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 10, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
