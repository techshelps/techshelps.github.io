

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF95: Page Fault in Mso95.dll When You Run MS Excel Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145570">
<META NAME="KBModify" CONTENT="1997/03/10">
<META NAME="KBCreate" CONTENT="1996/02/04">
<META NAME="Keywords" CONTENT="offwin xlvbainfo kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you run a macro in Microsoft Excel version 7.0, you may receive the following error message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contact the program vendor.  If you click Detai...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDKX,QAPN,QDL9,QBWO,QBWN,QAH4,QBWS,QBHQ,QDNF,QDH3,QBWQ,QAW6,QBJZ,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF95: Page Fault in Mso95.dll When You Run MS Excel Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145570</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00 7.00a
WINDOWS
kbusage kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows 95, versions 7.0, 7.0a, 7.0b
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft PowerPoint for Windows 95, version 7.0
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a macro in Microsoft Excel version 7.0, you may receive the
following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, a message similar to the following appears:
<P>
<PRE>   EXCEL caused an invalid page fault in module MSO95.DLL at
   0137:5066e949.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when all of the following conditions are met:

<UL><LI>You run Microsoft Excel for Windows 95 on a computer that is
   running Microsoft Windows 95.
<P>
   -and-

<LI>You run a macro that uses a property that requires you to establish a
   reference to the Microsoft Office 95 Object Library.
<P>
   -and-

<LI>You fail to establish a reference to the Microsoft Office 95 Object
   Library by clicking References on the Tools menu on the module sheet.
<P>
   -and-

<LI>You run the macro more than once.
<P>
</UL>This problem occurs when you use Microsoft Excel version 7.0 and Microsoft
Windows 95. This problem does not occur when you use Microsoft Excel
version 7.0 and Microsoft Windows NT 3.51.
<P>
This behavior may also occur when you use a macro in any Office version 7.0
program that requires you to establish a reference to the Microsoft Office
95 Object Library.
<P>
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, enable the Microsoft Office 95 Object Library
before you run the macro. To do this, use the following steps in Microsoft
Excel:

<OL><P><LI>In the module sheet, click References on the Tools menu.

<P><LI>In the References dialog box, select the "Microsoft Office 95 Object
   Library" check box.

<P><LI>Click OK.
<P>
</OL>NOTE: The reference to the Microsoft Office 95 Object Library is disabled
by default in Microsoft Excel version 7.0.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem occurs when you use the following properties in a macro:
<P>
<PRE>   BuiltinDocumentProperties
   CustomDocumentProperties
   DocumentProperties

</PRE></OL>You can use the BuiltinDocumentProperties property to return the collection
of built-in document properties, and the CustomDocumentProperties property
to return the collection of custom document properties.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about built-in document properties, click the Index
tab in Microsoft Excel Help, type the following text
<P>
<PRE>   object library

</PRE>and then double-click Office 95 Library for Document Properties to go to
the "BuiltinDocumentProperties Property" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kberrmsg<BR>
KBSubcategory: offwin xlvbainfo
<P>

Additional reference words: 7.00 MS095.DLL
<P>

<BR>
Keywords            : offwin xlvbainfo kberrmsg kbusage<BR>
Version             : 7.00 7.00a<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
