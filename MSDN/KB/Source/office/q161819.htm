

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF97: How To Install Bookshelf Basics to an Admin Install </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161819">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/06">
<META NAME="Keywords" CONTENT="offadmin offork OffWinSetup kbfaq kbreadme kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  This article contains the text of the document, Bookshlf.doc, located in the Microsoft Office 97 Resource Kit. It explains how to install the files for Microsoft Bookshelf Basics to an administrative installation point of Microsoft Office 97 such t...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANO,QBC9,QBC8,QAA1,QDI2,QA6P,QAMA,QA5F,QAIB,QBXT,QA5V,QAKC,QAY2,QBC6,QDKX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: How To Install Bookshelf Basics to an Admin Install</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains the text of the document, Bookshlf.doc, located in
the Microsoft Office 97 Resource Kit. It explains how to install the files
for Microsoft Bookshelf Basics to an administrative installation point of
Microsoft Office 97 such that a user can reference the Bookshelf Basics
from a workstation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: This modification may not be supported by Microsoft. Microsoft
support engineers will support some modifications to a BACKUP copy of the
SETUP.STF file. Note also that while support engineers may help customers
modify specific lines of an STF, we will not rewrite the entire file in
order to achieve a desired configuration. As a general rule, support is
limited to options that can normally be changed by a user during a standard
installation of the application.
<P>
ADDING MICROSOFT BOOKSHELF BASICS TO AN OFFICE 97 ADMINISTRATIVE
INSTALLATION POINT
<P>
When Office 97 is used to make an administrative installation point, the
files for Microsoft Bookshelf Basics are not included. This is because
adding 270MB of Bookshelf files to the installation point would make it
too large for most of our customers, and prevent them from using Microsoft
System Management Server to distribute Office 97 installation packages to
users.
<P>
However, if you are not using Microsoft System Management Server, and
you have enough room on your administrative installation point, you can
add Bookshelf Basics by hand. Once this is done, users can run Bookshelf
Basics from that point.
<P>
Additionally, you can place Bookshelf Basics on a separate share point to
enable users to run Bookshelf Basics from that share point. The user will
still require access to the administrative installation point to run
Bookshelf Basics, in addition to requiring access to the separate
Bookshelf share point.
<P>
NOTE: The instructions below are recommended only for administrators who
have a familiarity with administrative installations and editing the STF
file. For more information, see 6, "Customizing Client Installations" in
the Microsoft Office 97 Resource Kit.
<P>
WARNING: Off97Pro.stf is a tab-delimited file that relies heavily on
positional parameters, and can be easily damaged by modifying it with the
wrong editor.
<P>
TO ADD MICROSOFT BOOKSHELF BASICS TO YOUR ADMINISTRATIVE INSTALLATION POINT
<P>
<PRE>  1. Create an administrative installation point on a hard disk that has
     at least 600MB free space. If the administrative installation point
     has already been created, there should be at least 270MB free space
     remaining.

  2. On the Office 97 CD, locate the folder named Books.

  3. Copy the Books folder into the folder on your administrative
     installation point that contains the main Office applications files.
     For example, copy the Books folder to MSOffice\Books on the server.

  4. Make a backup copy of the file Off97pro.stf.

  5. Open Off97pro.stf in WordPad or another text editor that will not
     alter tabs and spaces.

  6. Locate the section "Office Install Modes". In that section you will
     find two lines. One line will contain the words "Network" and
     "AppMainDlg", and the other line will contain the words "Floppy" and
     "AppMainDlg". The lines will also include numbers. The numbers in
     your file may differ from the sample lines below.

      43   Network   AppMainDlg   53 55 59 : 50 65   No %1
      44   Floppy    AppMainDlg   56 58 61  63  : 50 65 No %1

  7. On the "Network AppMainDlg" line, the first two numbers after the
     word "AppMainDlg" should be changed to match the first two numbers
     on the "Floppy AppMainDlg" line. For example:

      43   Network   AppMainDlg   56 58 59 : 50 65   No %1
      44   Floppy    AppMainDlg   56 58 61  63  : 50 65 No %1

  8. Search for the line containing the phrase "Bookshelf Basics
     Workstation Install". The line may vary slightly from the sample
     line below:

      9503  Yes  Bookshelf Basics Workstation Install Microsoft Bookshelf

       Basics includes a dictionary, thesaurus, and book of quotations.
       These references can be accessed directly from within Microsoft
       Word, Excel, and PowerPoint.  Group   9506  %d,%d

  9. Note the number at the beginning of the line. In the sample above, it
     is 9503.

 10. Find the following line.  The numbers may vary from the sample
     below:

      57   &amp;Run from Network Server  Group 77 90 206 69 276 306 198 105 331
        112 122 10003 97 2203 114 7802  off97_bb.dll,114  No

 11. Take the number you noted in step 9, and add it to this line. It
     should be added so that it is next to last in the long list of numbers
     between the words "Group" and "off97_bb.dll". Use spaces to separate
     the numbers, not tab characters. For example, insert the number 9503
     in the list of numbers:

      57  &amp;Run from Network Server  Group  77 90 206 69 276 306 198 105 331
        112 122 10003 97 2203 114 9503 7802  off97_bb.dll,114  No

 12. Do not change anything else in the file. Save the file with the
     changes you just made.

</PRE>TO USE MICROSOFT BOOKSHELF BASICS FROM A SEPARATE INSTALLATION POINT

<OL><P><LI>Create an administrative installation point. You do not need additional
   disk space, since no additional files will be added to this folder.

<P><LI>On the Office 97 CD, locate the folder named Books.

<P><LI>Copy the Books folder onto the installation point you have selected.
   The Books folder will require approximately 270MB.

<P><LI>Follow steps 4 through 11 in the previous procedure.

<P><LI>With the STF file still open in WordPad, search for the following
   line. Note that the numbers in your file may differ from the sample
   line below.
<P>
<P><PRE>    9807  AddRegData """CURRENT"", ""Software\Microsoft\Microsoft
      Reference\Bookshelf\96L\Options"", ""Drive"", ""%s"", ""REG_SZ""
      "%s,%d
</PRE>
<P><LI>Replace the %s that is contained in double quotes with the location
   of the share point containing the books folder:
<P>
<P><PRE>    9807  AddRegData """CURRENT"", ""Software\Microsoft\Microsoft
      Reference\Bookshelf\96L\Options"", ""Drive"",
      ""\\MyServer\BookShare"", ""REG_SZ"" " %s,%d
</PRE>
<P><LI>Do not change anything else in the file. Save the file with the
   changes you just made.
<P>
</OL>TO USE MICROSOFT BOOKSHELF BASICS FROM A SEPARATE INSTALLATION POINT
(ALTERNATE METHOD, REQUIRING USER PARTICIPATION)
<P>
If your users know the location of the Bookshelf Basics files, you can
have them enter that information themselves. To do so, follow the steps
given in the first procedure. When the user attempts to launch Bookshelf
for the first time, a dialog box will appear asking for the location of
the Bookshelf files. The user may type a valid network path into the text
box of this dialog box. The system will remember the location and will not
prompt again unless the Bookshelf files are moved from the server.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Office Resource Kit," version 97
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbreadme<BR>
KBSubcategory: offwinsetup offork offadmin<BR>
Additional reference words: 97 off97 8.00<BR>
Keywords          : offadmin offork OffWinSetup kbfaq kbreadme kbsetup<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
