

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFF97: Errors Running Setup After "Run From CD" Installation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164163">
<META NAME="KBModify" CONTENT="1997/02/25">
<META NAME="KBCreate" CONTENT="1997/02/24">
<META NAME="Keywords" CONTENT="kbsetup kbprb kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you run the Microsoft Office 97 Setup program in maintenance mode, you may receive error messages similar to the following:  If You Click Reinstall     SelfReg    Failed to unregister .SRG file.     -and-     Setup could not create the folder ...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDKX,QDI2,QDIZ,QBWS,QAC9,QDH3,QAB4,QBXM,QDLP,QDNE,QBVV,QAEF,QA4B,QAY2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Errors Running Setup After "Run From CD" Installation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164163</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Microsoft Office 97 Setup program in maintenance mode,
you may receive error messages similar to the following:
<P>
<P><h3>If You Click Reinstall</h3>
 
<P>
<PRE>   SelfReg
   Failed to unregister .SRG file.

   -and-

   Setup could not create the folder 'D:\OFFICE\'.

   -and-

   There is not enough disk space to complete installation. You can
   change your installation options, continue installation, or exit
   Setup.

   -and-

   Setup tried to create an invalid path using 'D:\office\' and
   'OFFICE\PSS8.HLP'.

   NOTE: You receive over 100 error messages similar to the previous error
   message.

   -and-

   Setup Parse Error in Initialize pass
   Object ID 1081: RegFile Object: Failed to Register .SRG File
   D:\Office\EXCEL8.SRG.

   -and-

   Setup could not open the file: 'D:\Office\EXCEL.EXE'.

   -and-

   Setup is not yet complete.
   If you quit now, the product will not be installed properly.
   Quit Setup?

</PRE><h3>If You Click Remove All</h3>
 
<P>
<PRE>   SelfReg
   Failed to unregister .SRG file.

   -and-

   Setup Error in Initialize pass
   Object ID 8623: RegMso Object: Failed to load Mso97.dll.

   -and-

   Microsoft Office 97 Setup was not completed successfully.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>You perform a Run From CD installation of Microsoft Office 97 on
   your computer.
<P>
   -and-

<LI>You change the drive letter of the CD-ROM drive by installing a new
   hard disk or other type of drive, by creating a new hard disk partition
   (or partitions), or by manually changing the CD-ROM drive letter.
<P>
   -and-

<LI>You run the Setup program and click Reinstall or Remove All.
<P>
</UL>For example, if the CD-ROM drive is drive D when you perform a Run From CD
installation of Microsoft Office 97, and you then change the CD-ROM drive
to drive J, the problem occurs when you run Setup and click Reinstall or
Remove All.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent this problem from occurring, do not change the drive letter of
the CD-ROM drive after you install Microsoft Office 97.
<P>
If the problem described in this article already occurred, use the
following appropriate method.
<P>
<P><h3>Method 1</h3>
 
<P>
If the problem occurs after you run Setup and click Reinstall, run
Microsoft Office 97 Setup again. The Setup program allows you to perform a
new installation of Microsoft Office 97. All settings that refer to the
earlier CD-ROM drive designation are overwritten by the new settings.
<P>
<P><h3>Method 2</h3>
 
<P>
If the problem occurs after you run Setup and click Remove All, (or if you
have not run Microsoft Office 97 Setup since you changed the CD-ROM drive)
use the following steps:

<OL><P><LI>On the Start menu, point to Find, and click Files Or Folders.

<P><LI>In the Named box, type "Off97pro.stf" or "Off97std.stf" (without
   the quotation marks). Verify that the Look In box refers to drive C,
   and that the Include Subfolders check box is selected. Then, click Find
   Now.

<P><LI>In the list of found files, right-click the .stf file. On the shortcut
   menu, click Rename.

<P><LI>Change the file name to "Off97pro.yyy" or "Off97std.yyy" (without
   the quotation marks), and then press ENTER.

<P><LI>Close the Find dialog box.

<P><LI>Run Microsoft Office 97 Setup and perform a new installation of
   Microsoft Office 97.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Office 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
One way to prevent the CD-ROM drive from being changed is to manually set
the drive letter to a letter that is ordered later in the alphabet, for
example, R or S. This reduces the likelihood that the CD-ROM drive is
automatically changed when you install a new hard disk or create a new disk
partition.
<P>
For information about changing the drive letter of a CD-ROM drive, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN95X/Q121244.htm">Q121244</A></B>
   TITLE     : How to Change the Drive Letter of a CD-ROM Drive

</PRE></OL>When you perform a Run From CD installation of Microsoft Office 97, most
of the files that are used by Microsoft Office 97 programs are stored on
the Microsoft Office 97 compact disc. Because of this, there are a large
number of registry keys that refer to the locations of files on the compact
disc.
<P>
If you change the drive letter for your CD-ROM drive, these settings no
longer refer to the correct locations for the required files. As a result,
you cannot run any of the Microsoft Office 97 programs unless you first
reinstall Microsoft Office 97. If you run Microsoft Office 97 Setup and
click Reinstall or Remove All, you may receive the error messages described
in this article.
<P>
If you changed your CD-ROM drive letter and you already attempted to
reinstall Microsoft Office 97, run Microsoft Office 97 Setup again and
perform a new installation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbprb kberrmsg<BR>
KBSubcategory: offwinsetup<BR>
Additional reference words: 97 OFF97
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
