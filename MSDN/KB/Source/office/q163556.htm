

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"Unable to Register Mfc40.dll" Error During MS Office Install </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163556">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/02/12">
<META NAME="Keywords" CONTENT="offkbproc OffWinSetup kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you run the Microsoft Office Setup program, you receive the following error message:     Unable to register Mfc40.dll  CAUSE =====  This error message appears because the versions of certain .dll files that exist in the Windows\System or Winnt...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAA1,QAUJ,QAB4,QDI2,QBWS,QBSO,QDL9,QBWO,QBWN,QDNN,QAH4,QDH3,QAFI,QAAP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>"Unable to Register Mfc40.dll" Error During MS Office Install</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163556</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Office for Windows 95, versions 7.0, 7.0a, 7.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Microsoft Office Setup program, you receive the following
error message:
<P>
<PRE>   Unable to register Mfc40.dll

</PRE><h2>CAUSE</h2>
 
<P>
This error message appears because the versions of certain .dll files that
exist in the Windows\System or Winnt\System32 folder are the wrong
versions.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, use the following procedure.
<P>
<P><h3>Locate and Rename Files</h3>
 
<P>
To find and rename the files, follow these steps:

<OL><P><LI>Use Microsoft Windows Explorer to locate the Mfc40.dll file.
<P>
   By default, this file is in the Windows\System folder (under Microsoft
   Windows 95) or in the Winnt\System32 folder (under Microsoft Windows NT
   4.0).
<P>
   NOTE: If you are unable to find this file, click Options on the View
   Menu in Windows Explorer. Click the View tab, click Show All and click
   OK.
<P>
   If you cannot find the file in either of the folder locations, use the
   Find File feature to locate it. To do this, follow these steps:
<P>
<P><PRE>    a. Click Start, point to Find, and then click Files Or Folders.
</PRE><P>
<P><PRE>    b. In the Find dialog box, click the Name &amp; Location tab.
</PRE><P>
<P><PRE>    c. In the Named box, type the file name.
</PRE><P>
<P><PRE>       In this case, the file name is Mfc40.dll.
</PRE><P>
<P><PRE>    d. In the Look In box, type or select drive C.
</PRE><P>
<P><PRE>    e. Click to select the Include Subfolders check box.
</PRE><P>
<P><PRE>    f. Click Find Now.
</PRE><P>
<P><PRE>    g. All copies of the file that exist on your system are listed in the
       lower portion of the Find dialog.
</PRE><P>
<P><PRE>    h. Make a note of the location of all copies of the file.
</PRE>
<P><LI>After you locate the Mfc40.dll file, rename it. To rename the file,
   right-click the file name, and click Rename on the shortcut menu. Type
   "Mfc40.bak" (without the quotation marks), and then press ENTER to
   rename the file. Rename all copies of the Mfc40.dll file.
<P>
   NOTE: If you receive an error message that indicates that you cannot
   rename the name, go to the "What to Do If the File Is in Use and Cannot
   Be Renamed" section.

<P><LI>Repeat step 1 to locate and rename the Msvcrt40.dll file to
   Msvcrt40.bak. Rename all copies of the Msvcrt40.dll file.

<P><LI>Run the Microsoft Office Setup program. If the Setup program runs
   in maintenance mode, click Reinstall. Otherwise, choose the type of
   installation that you want to perform.
<P>
</OL><h3>What to Do If the File Is in Use and Cannot Be Renamed</h3>
 
<P>
In some cases, Windows 95 or Windows NT 4.0 may be using the Msvcrt40.dll
or Mfc40.dll file. If this is the case, do the following to replace the
file:

<OL><P><LI>Restart your computer, but press and hold the SHIFT key to disable
   all startup programs.

<P><LI>Close all tasks except Systray and Explorer. To do this, press
   CTRL+ALT+DEL to display the Task List. In the Close Program dialog box,
   click the task you want to close, and then click End Task.

<P><LI>Use the steps in the "Locate and Rename Files" section to rename the
   existing Msvcrt40.dll file to Msvcrt40.bak. Then rename the existing
   Mfc40.dll file to Mfc40.bak.

<P><LI>When you restart your computer, you may receive an error message
   that indicates that Msvcrt40.dll or Mfc40.dll cannot be found. If
   this occurs, click OK.

<P><LI>Run the Microsoft Office Setup program. The Microsoft Office Setup
   program installs both the Mfc40.dll and Msvcrt40.dll files.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The error message listed in the "Symptoms" section may appear when certain
.dll files are not the version that the Setup program expects to find. The
files may be the "wrong" version because of hardware or BIOS (basic
input/output system) conflicts or Microsoft Windows 95 or Windows NT
registry problems.
<P>
Some programs install different versions of the Mfc40.dll and the
Msvcrt40.dll files from the versions the Microsoft Office Setup program
installs. If one of the files is the wrong version, the Microsoft Office
Setup program may fail to complete successfully.
<P>
Both Microsoft Office 7.0 and Microsoft Office 97 install the following
versions of the Mfc40.dll and Msvcrt40.dll files:
<P>
<PRE>   Mfc40.dll       Size: 924,432 bytes   Version: 4.1.6139
   Msvcrt40.dll    Size: 326,656 bytes   Version: 4.10.6038

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about incorrect versions of Mfc40.dll and
Msvcrt40.dll, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   Article ID: <B><A HREF="../VISUALC/Q153733.htm">Q153733</A></B>
   Title     : PRB: Wrong Mfc40.dll and Msvcrt40.dll from ActiveX
               CD-ROM Disc

   Article ID: <B><A HREF="../ACCESS/Q159685.htm">Q159685</A></B>
   Title     : PRB: "Unable to Register Mfc40.dll" Error Installing
               MS Access
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 7.00 7.00a 7.00b 95 97 mfc40 msvcrt dll<BR>
8.00 OFF97 OFF4 OFF7 Mfc40 Msvcrt<BR>
Keywords          : offkbproc OffWinSetup kbfaq<BR>
Version           : 4.00 7.00 7.00a 7.00b 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
