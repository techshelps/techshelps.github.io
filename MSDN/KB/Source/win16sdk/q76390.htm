

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Full-Screen MS-DOS Apps Slow Timer Msgs in Enhanced Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76390 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1991/09/23">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  In 386 enhanced mode, Windows system timer (WM_TIMER) messages are generated less often when an MS-DOS-based application runs full-screen with its PIF file specifying background execution than when the same MS-DOS-based application runs in a window...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAJH,QBWS,QAEV,QA5W,QATK,QACE,QAYC,QAXC,QDH9,QAGQ,QAZA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Full-Screen MS-DOS Apps Slow Timer Msgs in Enhanced Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76390 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In 386 enhanced mode, Windows system timer (WM_TIMER) messages are
generated less often when an MS-DOS-based application runs full-screen with
its PIF file specifying background execution than when the same
MS-DOS-based application runs in a window.
<P>
When a full-screen MS-DOS-based application is running, Windows does not
need to track the mouse and update the screen. Therefore, Windows runs with
a low priority in the background. Windows-based applications receive fewer
WM_TIMER messages because the number of timer ticks that Windows
receives decreases from 18.2 per second to 2 per second or even fewer.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows's 386 enhanced mode architecture and display mechanism account
for the way that WM_TIMER messages behave when MS-DOS-based applications
are running.
<P>
First of all, WM_TIMER messages are not guaranteed to be sent exactly
at a specified time; they may be sent any time after the specified
time has elapsed. For example, a WM_TIMER message set for 60
milliseconds may be sent at exactly 60 milliseconds, or it may be sent
more than two minutes later. WM_TIMER messages behave this way because
they have the lowest priority of any Windows message. Applications
receive WM_TIMER messages only after all other messages in the system
have been processed (that is, when all message queues are empty).
<P>
In 386 enhanced mode, Windows uses a virtual machine architecture that
sets up a virtual machine (VM) for each MS-DOS-based application. Windows
is essentially an MS-DOS-based application and creates a VM for itself
called the System VM. The System VM runs Windows and all Windows-based
applications; each MS-DOS-based application receives a separate VM.
<P>
Virtual machines behave like 8086 processors with additional privileged
instructions provided by the 80386 processor's virtual-8086 mode. Virtual-
8086 mode differs from real mode in that it has memory protection, virtual
memory, and privilege-checking mechanisms. Each virtual machine also has an
optional protected-mode portion. The System VM uses its protected mode
portion to run Windows-based applications.
<P>
The Windows Virtual Machine Manager (VMM) controls the multitasking of
the virtual machines; it manages memory, CPU execution time, and
device coordination. The VMM runs in the 80386 processor's 32-bit flat
memory model along with Windows virtual devices (VxDs), and
preemptively schedules the virtual machines.
<P>
Foreground virtual machines running MS-DOS-based applications always
receive 18.2 timer ticks each second so that the VM looks exactly like a
stand-alone 8086 machine. When the System VM is in the foreground, it
(and Windows) receives 18.2 timer ticks per second as well.
<P>
Background virtual machines do not receive 18.2 timer ticks per
second; they receive 2 or fewer ticks per second because the VMM
reduces their relative priorities. As a result, the foreground VM can
run faster.
<P>
When the System VM is in the background and a full-screen MS-DOS-based
application is in the foreground, Windows receives fewer timer ticks,
and therefore runs slower than normal. Windows-based applications process
their messages slower, causing WM_TIMER messages to be delayed.
<P>
Windowed MS-DOS-based applications behave differently from full-screen
MS-DOS-based applications. Windows creates a special agent application,
WINOLDAP, to run windowed MS-DOS-based applications. WINOLDAP's job is to
place all output from an MS-DOS-based application into the client area of a
window. Windows controls all parts of the display, including the area of
the windowed MS-DOS-based application, and tracks the mouse pointer.
<P>
Under such circumstances, Windows is running in the background with a
high priority. The windowed MS-DOS-based application is running in the
foreground in a VM. The VMM preemptively multitasks the VMs so that
the MS-DOS-based application can run and Windows can manage the screen.
Because the System VM has a high priority, it receives more timer ticks per
second than other background VMs. Windows and Windows-based applications,
therefore, process more messages, which allows WM_TIMER messages to be
sent more often.
<P>
Even though background VMs receive fewer timer ticks per second, they
still receive time slices according to their relative priorities.
<P>
NOTE: This article applies to MS-DOS-based applications that have a PIF
file set for background execution. If the MS-DOS-based application is
running full-screen in the foreground with its PIF file set to exclusive
processing, all other applications, including Windows, will be
suspended, just as if the MS-DOS-based application were run under Windows
in standard mode. If the MS-DOS-based application runs in a window with
exclusive processing set, then Windows does not get suspended because it
must manage the screen output for the MS-DOS-based application.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: KrWoa<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
