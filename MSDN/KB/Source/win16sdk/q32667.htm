

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Font Metrics and the Use of Negative lfHeight </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q32667 ">
<META NAME="KBModify" CONTENT="1995/04/04">
<META NAME="KBCreate" CONTENT="1988/07/11">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The following illustrations show the most commonly used font metrics, including Character Height, which is selected with negative values of lfHeight.  Each illustration is followed by notes describing the metrics.   _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ ...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QATX,QAHT,QDL9,QBWO,QBWN,QBCG,QBA2,QAZA,QANO,QBDM,QBC9,QBC8,QAYV,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Font Metrics and the Use of Negative lfHeight</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q32667 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following illustrations show the most commonly used font metrics,
including Character Height, which is selected with negative values of
lfHeight.
<P>
Each illustration is followed by notes describing the metrics.
<P>
<PRE> _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

                     O    O
 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
                       /\
                      /  \
                     /    \
 _ _ _ _ _ _ _ _ _  /______\ _ _ _ ___   _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
                   /        \     /   \|
                  /          \   |     |
 _ _ _ _ _ _ _ _ /_ _ _ _ _ _ \ _ \___/| _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
                                       |
                                       |
 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\___/_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
                                                      |
                                                      |- External Leading
 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _|_ _ _ _ _ _ _ _ _ _
                                                      |
                     O    O                           |- Internal Leading
 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _|_ _ _ _ _ _ _ _ _ _
              |        /\
              |       /  \
              |      /    \
              |     /______\ _ _ _ ___   _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
 Char Height -|    /        \     /   \|
              |   /          \   |     |
              |  /_ _ _ _ _ _ \ _ \___/| _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
              |                        |
              |                        |
 _ _ _ _ _ _ _|_ _ _ _ _ _ _ _ _ _\___/_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _


 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
              |                                           |
              |      O    O                               |
              |                                           |
              |        /\                                 |
              |       /  \                                |
              |      /    \                               |- Ascent
 Cell Height -|     /______\       ___                    |
              |    /        \     /   \|                  |
              |   /          \   |     |                  |
              |  /_ _ _ _ _ _ \ _ \___/| _ _ _ _ _ _ _ _ _|_ _ _ _ _ _ _ _
              |                        |                  |
              |                        |                  |- Descent
 _ _ _ _ _ _ _|_ _ _ _ _ _ _ _ _ _\___/_ _ _ _ _ _ _ _ _ _|_ _ _ _ _ _ _ _


</PRE><h3>NOTES</h3>
 
<P>
<P><h3>Cell Height</h3>
 
<P>
This is the height selected on positive lfHeight in the LOGFONT. It is
the height of the font bitmap for raster fonts. It is returned as
tmHeight in the TEXTMETRIC structure from GetTextMetrics().
<P>
<P><h3>Character Height (Also Known as Em)</h3>
 
<P>
This is the height selected on negative lfHeight in the LOGFONT. (that
is, the mapper will try to match a font whose character height matches
the absolute value of the requested height). NOTE: By definition, the
Em is equal to Cell Height minus Internal Leading. The Em defines the
point size of a font. In MM_TEXT mapping mode, the Em is related to
the point size as follows:
<P>
<PRE>   Em=dpiY*point_size/72;  // where dpiY is dots per inch in Y direction

</PRE>The dpiY of a font is equal to tmDigitizedAspectY in TEXTMETRICS.
<P>
<P><h3>Internal Leading</h3>
 
<P>
This is returned as tmInternalLeading in the TEXTMETRIC structure from
GetTextMetrics() and often, but not necessarily, describes how much
space has been left inside the font bitmap for diacritical marks
(accents).
<P>
<P><h3>External Leading</h3>
 
<P>
This is returned as tmExternalLeading in the TEXTMETRIC structure from
GetTextMetrics() and describes how much extra space the font designer
expects the application to leave between rows of the font. It is not
included in the bitmap and is not modified by TextOut()/ExtTextOut(),
even in OPAQUE mode. When outputting multiple lines of text, the lines
should be separated by (tmHeight + tmExternalLeading).
<P>
<P>
<PRE> Character Width                       Character Width
        |                                     |
 |-------------|                       |-------------|

 |          |                         /          /   |
 |          |                        /          /    |
 |          |                       /          /     |
 |          |                      /          /      |
 |----------|                     /----------/       |
 |          |                    /          /        |
 |          |                   /          /         |
 |          |                  /          /          |
 |          |                 /          /           |
                                            |________|
 |_____________|              |_____________|    |
        |                            |           Overhang
   Character width        Character width
 (including white space)  (including white space)

   Overhang = 0                  Overhang &gt; 0

</PRE><h3>NOTES</h3>
 
<P>
<P><h3>Overhang</h3>
 
<P>
tmOverhang specifies the per string extra width that may be added to
some synthesized fonts. When synthesizing some attributes such as bold
or italic, GDI or a device may have to add width to a string on both a
per character and per string basis. For example, GDI synthesizes
embolding by expanding the intercharacter spacing and overstriking
with an offset and italicizes a font by skewing the string.
<P>
In either case, there is an overhang past the basic string. For bold
strings, it is the distance by which the overstrike is offset. For
italic strings, it is the amount the top of the font is skewed past
the bottom of the font. tmOverhang allows the application to determine
how much of the character width returned by a GetTextExtent() call on
a single character is the actual character width and how much is the
per string extra width. The actual width is the extent less the
overhang. In other words, tmOverhang is the difference between the
width of a character when it is output singly versus its width when it
is in the interior of a string.
<P>
For more information, look up the following topics in the Windows
Software Development Kit reference:

<UL><LI>CreateFont()    (in Volume 1 of the version 3.0 reference)
<LI>TEXTMETRIC      (in Volume 2 of the version 3.0 reference)
<P>
</UL>Or, query on the following word:
<P>
<PRE>   EXTTEXTMETRIC
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: fonts metrics lfHeight height TEXTMETRIC<BR>
EXTTEXTMETRIC LOGFONT 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiFnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
