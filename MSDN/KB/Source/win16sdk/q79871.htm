

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Applications That Run with or Without Pen Extensions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79871 ">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1992/01/09">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Typically, applications that are developed for Microsoft Windows for Pen Computing do not run unless the pen extensions are installed in memory. The reason for this is that these applications are implicitly linked to PENWIN.DLL. When a user runs an...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBHF,QDL9,QBWO,QBWN,QAJH,QAOG,QBVV,QAY5,QBWS,QAA1,QBWQ,QDI2,QAB9,QAPF,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Applications That Run with or Without Pen Extensions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79871 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Pen Computing version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Typically, applications that are developed for Microsoft Windows for Pen
Computing do not run unless the pen extensions are installed in memory. The
reason for this is that these applications are implicitly linked to
PENWIN.DLL. When a user runs an application that is implicitly linked to
PENWIN.DLL on a system where the pen extensions are not installed, the
application fails to load with the following error message:
<P>
<PRE>   File Error
   Cannot find PENWIN.DLL

</PRE>The SNOOP sample application, provided with the Microsoft Windows for Pen
Computing in the Windows Software Development Kit (SDK), is an example of
an application that runs only when the pen extensions are installed.
<P>
Applications can be designed to run in either environment, under Windows
with or without the pen extensions. The HFORM sample application, also
provided with the Windows for Pen Computing in the Windows SDK, is an
example of this type of application.
<P>
This article lists the steps required to create an application that runs in
either environment; this article also lists other sample applications that
do not implicitly link with PENWIN.DLL.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An application that does not implicitly link with PENWIN.DLL can use the
pen API functions when they are available and can run in the Windows
environment when the pen extensions are not available. The application must
not reference any of the pen functions directly. At run time, the
application must retrieve the handle to PENWIN.DLL and explicitly load any
functions that the application will use. The following four steps detail
how an application that is not implicitly linked to PENWIN.DLL would load
and use the Recognize function:

<OL><P><LI>Prototype the Recognize function in the application's header file
   as follows:
<P>
<P><PRE>      REC (FAR PASCAL *lpfnRecognize)(LPRC);
</PRE>
<P><LI>In the application's initialization, use GetSystemMetrics() to see
   if the pen extensions are installed. If the value returned from
   this function is zero, the pen extensions are not installed.
   Otherwise, the return value is the handle to PENWIN.DLL.

<P><LI>If the extensions are installed, use GetProcAddress() to retrieve
   the address of the Recognize function. A NULL return value
   indicates an error. The following fragment demonstrates this step:
<P>
<P><PRE>      if (lpfnRecognize = GetProcAddress(hPenWinDLL, "Recognize"))
</PRE>
<P><LI>Finally, call the function using the procedure address, as follows:
<P>
<P><PRE>      lpfnRecognize(&amp;rc);
</PRE><P>
</OL>As noted above, the HFORM sample application provided with the Windows for
Pen Computing SDK demonstrates the process detailed in this article.
REPAINT, HOTSPOTS, and PRESSURE are additional sample applications in the
Software/Data Library that demonstrate this method. The articles that
describe these sample applications can be found by searching this Knowledge
Base for the name of the desired sample application.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: WpenMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
