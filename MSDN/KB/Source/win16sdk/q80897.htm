

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 3.1 Application Compatibility (part 2 of 7) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80897 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/02/20">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Application Compatibility Document for Windows 3.1  Due to the amount of information in this document, it has been broken into seven pieces. To find all seven pieces of this document and the Windows 3.1 Compatibility Test checklist, query this know...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAYS,QAHR,QAJH,QAGI,QAGQ,QAVX,QAVW,QAY5,QANJ,QAC1,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 3.1 Application Compatibility (part 2 of 7)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80897 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10
WINDOWS
kbtool 31compattest
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h3>Application Compatibility Document for Windows 3.1</h3>
 
<P>
Due to the amount of information in this document, it has been broken
into seven pieces. To find all seven pieces of this document and the
Windows 3.1 Compatibility Test checklist, query this knowledge base on
the words:
<P>
<PRE>   prod(winsdk) and 31compattest


                         Multimedia and Sound
                         ====================

</PRE>Windows version 3.1 includes multimedia and sound drivers. Most of
these enhancements should affect only applications that use the sound
functions. Applications that use unusual drivers, such as fax machine
applications, should also test to be sure the sound drivers don't
interfere.
<P>
<P><h3>MS-DOS SOUND APPLICATIONS</h3>
 
<P>
<P><h3>Potential Problem</h3>
 
<P>
Some MS-DOS-based applications that use audio cards, such as SoundBlaster,
may not run correctly in virtual machines or may run incorrectly after
Windows terminates.
<P>
<P><h3>Test</h3>
 
<P>
Carry out each of the following steps. Be sure your application runs
correctly as you complete each step:

<OL><P><LI>Run the MS-DOS-based application in a virtual machine.

<P><LI>Exit Windows and run your application under MS-DOS.
<P>
<P>
</OL><h3>WINDOWS SOUND APPLICATIONS</h3>
 
<P>
<P><h3>Potential Problem</h3>
 
<P>
Although Windows sound functions are 100 percent backward compatible,
some Windows-based applications may not function properly with the new
functions.
<P>
<P><h3>Test</h3>
 
<P>
Run your application and try all the sound capabilities.
<P>
<P>
<P><h3>UNUSUAL DRIVERS</h3>
 
<P>
<P><h3>Potential Problem</h3>
 
<P>
Applications requiring unusual drivers, such as WinFax, may not be
compatible with Multimedia extensions.
<P>
<P><h3>Test</h3>
 
<P>
Run your application and try the functions of your application that
the driver supplies.
<P>
<P>
<PRE>                          Window Management
                          =================

</PRE></OL>The window management (User module) enhancements may affect Windows
3.0 applications. To test this, perform as many operations as possible
that will move, size, scroll, and repaint your application windows.
The following sections list a few basic methods to try, but also try
as many other methods as possible.
<P>
In some cases, Windows version 3.1 will ensure compatibility with
existing Windows version 3.0 applications by supporting both the
Windows versions 3.0 and 3.1 implementations. If an application's
Windows version as set by Resource Compiler (RC) is 3.0, Windows
version 3.1 carries out the Windows 3.0 implementation; that is, the
Windows version 3.1 enhancement has no impact on an existing Windows
version 3.0 application. However, if a Windows version 3.0
application's Windows version is changed to 3.1 without corresponding
changes to the application code, the application may encounter
problems wherever Windows version 3.1 carries out the 3.1
implementation.
<P>
<P>
<P><h3>MOVING AND SIZING</h3>
 
<P>
For Windows 3.0 applications, the SetWindowPos function assumes that
SWP_NOMOVE and SWP_NOSIZE are set if SWP_HIDEWINDOW or SWP_SHOWWINDOW
was set. Thus, hiding and showing a window and changing its size and
position are not possible in an atomic operation. Windows version 3.1
applications are not so limited.
<P>
<P><h3>Potential Problem</h3>
 
<P>
Any Windows version 3.0 application whose version number is changed to
3.1 may make unnecessary calls to SetWindowPos.
<P>
In a Windows version 3.0 application, if you call SetWindowPos with
SWP_SHOWWINDOW when the window is already visible, SetWindowPos always
causes the entire window to be redrawn. This also affects the
operation of ShowWindow. In a Windows version 3.1 application, a call
to SetWindowPos with SWP_SHOWWINDOW on a window that is already
visible will not redraw (unless other areas must be updated as a
result of a size, move, or z-order operation specified in addition to
SWP_SHOWWINDOW).
<P>
<P><h3>Potential Problem</h3>
 
<P>
Any Windows version 3.0 application whose version number is changed to
3.1 may encounter problems if it depends on redrawing on each call to
SetWindowPos with SWP_SHOWWINDOW set.
<P>
MoveWindow is shorthand for a call to SetWindowPos with the
SWP_NOZORDER and SWP_NOACTIVATE flags set. If the MoveWindow fRedraw
parameter is FALSE, then SWP_NOREDRAW is also set. In a Windows 3.0
application, when MoveWindow is called on a top-level window with
fRedraw set to FALSE, Windows calls SetWindowPos without setting the
SWP_NOREDRAW flag and then calls ValidateRect to prevent the client
area from repainting. However, WM_NCPAINT and WM_ERASEBKGND messages
will have been sent, even though fRedraw was FALSE. In a Windows
version 3.1 application, MoveWindow no longer makes this special case.
<P>
<P><h3>Potential Problem</h3>
 
<P>
Any Windows version 3.0 application whose version number is changed to
3.1 may encounter problems if it depends on receiving WM_NCPAINT and
WM_ERASEBKGND messages after a call to MoveWindow.
<P>
In a Windows version 3.0 application, Windows always redraws a
window's frame completely when the window is moved or sized. In a
Windows version 3.1 application, Windows no longer redraws a window's
frame completely in all cases. For example, the following code
sequence will not redraw the window border:
<P>
<PRE>   MoveWindow(hwnd, ..., FALSE);
       .
       .
       .
   InvalidateRect(hwnd, NULL, TRUE);

</PRE><h3>Potential Problem</h3>
 
<P>
Any Windows version 3.0 application whose version number is changed to
3.1 may have an incomplete window frame if it depends on Windows
redrawing the frame completely after moving and sizing.
<P>
<P><h3>Tests</h3>
 

<OL><P><LI>Start your application in its default state. Maximize and minimize
   it; be sure it paints correctly after each operation.

<P><LI>Move your application as far right and left as you can in small
   increments, watching for repaint problems each time you stop
   moving.

<P><LI>Resize your application using the mouse to drag the border.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10<BR>
KBCategory: kbtool<BR>
KBSubcategory: TlsCompat<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
