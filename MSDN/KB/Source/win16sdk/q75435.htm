

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows, Code Pages, and Character Sets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75435 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1991/08/20">
<META NAME="Keywords" CONTENT="GdiFnt kb16bitonly kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The ASCII (American Standard Code for Information Interchange) character set defines a mapping of the letters, numerals, and specified punctuation and control characters to the numbers from zero to 127. The term  code page  is used to refer to exte...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QDL9,QBWO,QBWN,QAH4,QBWQ,QDJS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows, Code Pages, and Character Sets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75435 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ASCII (American Standard Code for Information Interchange)
character set defines a mapping of the letters, numerals, and
specified punctuation and control characters to the numbers from zero
to 127. The term "code page" is used to refer to extensions of the
ASCII character set that also map specified symbols to the numbers
from 128 through 255.
<P>
This article discusses how Windows deals with code pages and warns
against some of the pitfalls that applications can encounter.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ANSI (American National Standards Institute) character set maps
the letters and numerals in the same manner as ASCII. However, ANSI
does not support control characters and it maps many symbols,
including accented letters, that are not mapped in standard ASCII. All
Windows fonts are defined in the ANSI character set.
<P>
An OEM (original equipment manufacturer) code page is built into the
computer hardware. There are a number of OEM code pages, each defined
for a particular language. These code pages are referred to by a
number; for example, code page 437 is installed in the original IBM PC
computer.
<P>
MS-DOS uses code pages to change the available character set, depending
on user preference. A code page change is implemented by programming a
new character set into the video display hardware. By changing to the
code page for a particular language, the accented characters
appropriate to that language are made available. Each code page is
limited to 256 symbols.
<P>
For each code page, MS-DOS maintains a mapping table to map lowercase
characters to and from uppercase. Because all string parameters to
MS-DOS (filenames) are implicitly coded in the current code page,
when the table is changed, filenames that were accessible under one
case mapping may not be available under another. However, the common
code pages were designed to combat this problem.
<P>
Windows runs as an extension to MS-DOS. There is a mapping layer that
translates between the ANSI character set and an OEM character set.
When Windows is installed, the Setup program determines the installed
character set and installs the corresponding ANSI-OEM translation
tables and Windows OEM fonts.
<P>
If the user changes the current MS-DOS code page, Windows does not
change its ANSI-OEM mapping tables automatically. It is necessary to
run the Windows Setup program to modify these tables and to load the
corresponding fonts.
<P>
Windows-based applications must use the Windows functions AnsiToOem() and
OemToAnsi() when transferring information to and from MS-DOS. In
addition, applications must use the correct character set when
creating filenames.
<P>
There is no one-to-one mapping between the ANSI and OEM character
sets. Applying the AnsiToOem() function followed by the OemToAnsi()
function to a given string will not always result in the original
string. A file that has been named with one of these strings cannot
be accessed by any Windows-based application. The filename must be changed
by the user from outside of Windows.
<P>
The following two scenarios may have differing results.
<P>
<P><h3>SCENARIO 1</h3>
 
<P>
A lowercase ANSI string is passed to the AnsiToOem() function. The
result is passed to MS-DOS, which maps the string to uppercase.
<P>
<P><h3>SCENARIO 2</h3>
 
<P>
An uppercase ANSI string is passed to the AnsiToOem() function. The
string is passed to MS-DOS.
<P>
This is caused by the fact that the MS-DOS lowercase to uppercase
conversion mapping and the Windows ANSI case conversion do not match.
To avoid this problem, use the AnsiUpper() function to convert the
ANSI string to uppercase before passing it to the AnsiToOem()
function. Also note, this is only a problem with extended characters.
These problems are often overlooked until your customers call to
complain.
<P>
Keep in mind that both ANSI and OEM are 8-bit character sets. In
applications, always use the "unsigned char" type instead of "signed
char" for character variables. Problems that result from using "signed
char" are very hard to track.
<P>
The SYSTEM.INI file contains entries that relate to code pages. In the
[boot] section, the OEMFONTS.FON line specifies the file that contains
the OEM stock font. In the [keyboard] section, the OEMANSI.BIN line
specifies the ANSI-OEM translation table. If this line is blank,
Windows uses the default table built into the keyboard driver. In the
[enh] section, the *WOA.FON lines specify the fonts used in an MS-DOS
window at various resolutions.
<P>
Windows does not provide any mechanism for an application to work with
data that is not in the current MS-DOS code page, nor does Windows
recognize changing the OEM code page in an MS-DOS window. However, an
application is free to provide its own translation tables and provide
a data format that includes the code page.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiFnt<BR>
Keywords            : GdiFnt kb16bitonly kbprg<BR>
Version             : 3.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
