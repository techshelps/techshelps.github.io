

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Baseline Shifts in Cell When Character Italicized </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q72460 ">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1991/05/25">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT=" NOTE: With TrueType fonts in Windows 3.1, this process described below is not necessary. An application should do a version check to determine if it is running under version 3.0 and perform this process only if the application is indeed running unde...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMN,QBE7,QBE6,QACI,QDL9,QBWO,QBWN,QADF,QAEB,QABF,QDNZ,QAWN,QBWQ,QAE8,QAKE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Baseline Shifts in Cell When Character Italicized</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q72460 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
NOTE: With TrueType fonts in Windows 3.1, this process described below is
not necessary. An application should do a version check to determine if it
is running under version 3.0 and perform this process only if the
application is indeed running under Windows 3.0 or if the application is
using non TrueType fonts in Windows 3.1.
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a font is italicized under Windows version 3.0, the dimensions of the
character cells change because the descender of the character may require
more space at the left edge of the character cell.
<P>
Because the character cell is larger, the relative position of the baseline
of the character within the cell changes. The baseline itself is not
affected, but when a character is drawn italic and nonitalic with the
TextOut() function at the same x coordinate, the baseline of the italic
font is shifted a few pixels to the right.
<P>
To account for this shift, calculate the slope of the font -- ascent
divided by overhang -- after italicization. Using this slope, the number of
pixels by which the character cell was expanded left is equal to descent
divided by slope, or (descent times overhang) divided by ascent. This value
can be subtracted from the x coordinate in the TextOut() call to align the
baselines.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Consider the character "f". In a normal character cell, it would
appear as:
<P>
<PRE>          ^ ........
          | ........
          | ...xx...
          | ..x..x..
    Ascent| ..x.....
          | ..xx....
          | ..x.....
          | ..x.....
          | ..x.....
          v .xxx....&lt;-baseline
   Descent^ ........
          v ........

</PRE>When italicized, the descent is shifted to the left and the ascent is
shifted to the right, along a line of constant slope equal to the
ascent divided by the overhang:
<P>
<PRE>          ^ ............
          | ............
          | .......xx...
          | ......x..x..
    Ascent| .....x......
          | .....xx.....
          | ....x.......
          | ....x.......
          | ...x........
          v ..xxx.......&lt;-baseline
   Descent^ ............
          v ............
                     &lt;-&gt;
                      Overhang

</PRE>Because the descent of the character is shifted left according to the
slope of the line, this particular character cell has been expanded
one pixel left, which has the effect of shifting the baseline in the
character cell one pixel right.
<P>
Since the overhang represents the amount the ascent of the character
is shifted right in the cell, the corresponding shift of the descent
can be calculated and can be called the "underhang":
<P>
<P>
<PRE>                descent * overhang
   underhang = --------------------
                      ascent

</PRE>When calling the TextOut() function, use the normal x-coordinate where
the text should be drawn, but subtract the underhang. This places the
baseline of the character exactly where it would be if the character
were not italic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiFnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
