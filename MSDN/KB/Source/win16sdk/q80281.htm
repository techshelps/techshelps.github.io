

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Combining Multiple Compiled Resource Files Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80281 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/01/23">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  An application is unable to load some of its resources, while other resources load properly.  CAUSE =====  Several small compiled resource (RES) files have been combined using the MS-DOS command  COPY /b .  RESOLUTION  Use the #include directive to...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIM,QDL9,QBWO,QBWN,QBWQ,QBE7,QBE6,QAH4,QAOT,QAJH,QA3P,QALM,QAB9,QAGQ,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Combining Multiple Compiled Resource Files Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80281 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbtool kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An application is unable to load some of its resources, while other
resources load properly.
<P>
<P><h2>CAUSE</h2>
 
<P>
Several small compiled resource (RES) files have been combined
using the MS-DOS command "COPY /b".
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the #include directive to combine the files at the source
level.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Resource Compiler that was shipped with the Microsoft Windows
Software Development Kit (SDK) versions 2.x ca not handle large
resource files because of inherent memory limitations. To work around
these limitations, it is recommended that programmers compile the
resources into small RES files, and combine these files using the
MS-DOS COPY /b command.
<P>
The Resource Compiler shipped with version 3.x of the Windows SDK has
been enhanced to handle resource files much larger than its Windows
2.x counterpart. The format of the compiled resource files in Windows
3.x does not support concatenation of RES files.
<P>
If an application has a large number of resources, even the version
3.x Resource Compiler can run out of memory. If this occurs, modify
the design of the application to use a resource-only dynamic-link
library (DLL). The following three steps outline the required process
to perform this type of functionality:

<OL><P><LI>Use the Resource Compiler to create a resource-only DLL that
   contains some of the application's resources. See the note below
   regarding resource-only DLLs under Windows 3.x.

<P><LI>In the application, load the resource library using the
   LoadLibrary function.

<P><LI>Use the LoadBitmap, LoadMenu, and so forth, functions to load
   resources from the DLL as required.
<P>
</OL>Under Windows 3.x, resource-only DLLs require a Windows exit procedure
(WEP). The WEP must be exported in the DEF file and the export must
have the RESIDENTNAME attribute. Place the code for the WEP into a
FIXED code segment. The source code for a WEP follows:
<P>
<PRE>   int far pascal WEP(int NotUsed)
      {
      return 1;
      }

</PRE></OL>The "far" and "pascal" declarators are in lowercase to avoid having to
include the WINDOWS.H header file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 dialog icon menu bitmap cursor font<BR>
rcdata stringtable<BR>
KBCategory: kbtool kbprg kbprb<BR>
KBSubcategory: TlsRc<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
