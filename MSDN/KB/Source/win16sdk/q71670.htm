

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: BACKGRND Demonstrates Background Processing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71670 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/04/30">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT=" BACKGRND uses a PeekMessage() loop to do background processing. The background task is to draw rectangles at random in the application's client window. BACKGRND draws one  batch  of rectangles each time through the PeekMessage() loop, and all the re...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKJ,QAK4,QAA7,QANX,QAGU,QAPW,QA8T,QA8S,QAXQ,QAPF,QADP,QAWH,QDL9,QBXS,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: BACKGRND Demonstrates Background Processing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71670 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows '
   versions 3.0 and 3.1
</UL> 
<P>
BACKGRND uses a PeekMessage() loop to do background processing. The
background task is to draw rectangles at random in the application's client
window. BACKGRND draws one "batch" of rectangles each time through the
PeekMessage() loop, and all the rectangles in each batch are drawn in the
same color. This provides a visual indication of how much background work
is done before BACKGRND offers to yield.
<P>
Both the "batch size" and the total number of rectangles drawn can be
changed using a menu selection.
<P>
BACKGRND does not replace the main GetMessage() loop with a PeekMessage()
loop. Instead, it enters a PeekMessage() loop only when the user chooses
the Draw! menu item.
<P>
While it draws the rectangles, BACKGRND displays a modeless dialog box
that:

<OL><P><LI>Allows the user to cancel the background processing before all
   the rectangles have been drawn (by choosing the Cancel button)

<P><LI>Indicates both the total number of rectangles to be drawn and the
   batch size

<P><LI>Displays a "gas gauge" that indicates the percentage of the
   background task that has been completed
<P>
</OL>BACKGRND can be run along with another Windows-based application (for
example, Notepad) to illustrate the difference between "polite" and
"impolite" background processing.
<P>
If the batch size is set to a "polite" small value (for example, 10
rectangles each time through the PeekMessage loop), the user can easily
type within Notepad while BACKGRND is drawing rectangles. BACKGRND draws
rectangles in the spare time slices between the messages generated by the
user's keystrokes, and calls PeekMessage() often enough that the user will
still find Notepad responsive.
<P>
If the batch size is set to an "impolite" large value (for example, 1000
rectangles each time through the PeekMessage() loop), BACKGRND can complete
its background job much more quickly, because there are fewer calls to
PeekMessage() and thus less overhead. However, a user trying to type in
Notepad will find the keyboard so unresponsive that Notepad will be
essentially useless.
<P>
Download BACKGRND.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/BACKGRND.EXE">BACKGRND.EXE</A> <I>(size: 33826 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/BACKGRND.EXE">BACKGRND.EXE</A> <I>(size: 33826 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib BACKGRND.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrMsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
