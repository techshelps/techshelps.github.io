

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Alternate MDI Tiling Scheme Code Sample Available </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q72135 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/05/15">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The Microsoft Software Library contains the source code to a sample program, MDITILE, that demonstrates how to implement an alternate tiling scheme for the multiple document interface (MDI) of Windows version 3.0.  The alternate tiling scheme demon...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAW9,QDL9,QBWO,QBWN,QBWQ,QA5V,QAK4,QAKC,QAPF,QAH4,QAGQ,QBE7,QBE6,QBC6,QBW1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Alternate MDI Tiling Scheme Code Sample Available</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q72135 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Software Library contains the source code to a sample
program, MDITILE, that demonstrates how to implement an alternate tiling
scheme for the multiple document interface (MDI) of Windows version 3.0.
<P>
The alternate tiling scheme demonstrated in this sample attempts to tile
MDI child windows so they are wider than they are tall. The default MDI
tiling scheme sizes the child windows to be tall and narrow. This is
unsuitable for MDI applications based on text such as a word processor.
<P>
Download MDITILE.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/MDITILE.EXE">MDITILE.EXE</A> <I>(size: 29870 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/MDITILE.EXE">MDITILE.EXE</A> <I>(size: 29870 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The horizontally based tiling scheme implemented in this sample uses
the following eight-step procedure:

<OL><P><LI>Count the number of MDI child windows that are not iconic
   (represented by an icon). These are the only windows affected by
   tiling. This value is saved in "cKids."

<P><LI>Find the next square (that is, a number "n," such that some integer
   "x" is the square root, x*x == n), that is greater than the number
   of windows to tile.

<P><LI>Set a column value, "cCols," to "x-1," where "x" is the root of the
   square found in step 2.

<P><LI>Set a row counter, "cRows," to "cKids / cCols."

<P><LI>Set a remainder counter, "cMulRows," to "cKids % cCols." This
   accounts for the child windows that are not included in the base
   grid of cCols by cRows.

<P><LI>Get the dimensions of the client rectangle in which tiling is to
   occur. Note that it may be desirable to reduce the size of this
   rectangle to leave space at the bottom of the MDI client window for
   a row of icons. Divide the vertical height of the rectangle by
   cRows to get the child window height, and divide the horizontal
   width of the rectangle by cCols to get the child window width.

<P><LI>Loop through each row. In this row, the application will tile
   cCols child windows. The value "cRows-cMulRows" is the number of
   rows that can be created with cCols columns. If the rows that can
   have cCols columns have already been done, then increment cCols
   so that all remaining rows have an extra window. Since cMulRows
   are left to tile, adding one window to each row account for all
   remaining windows.
<P>
   This is also why cCols was initially "x-1." If "cCols==x," then
   the first rows (at the top of the window) would have more windows
   than rows on the bottom. If this tiling scheme is desired, set
   cCols to "x" as the assumed number of columns, then decrement
   cCols when cMulRows have been tiled.

<P><LI>Once the number of columns has been calculated, loop through the
   columns, moving each window to the appropriate section of that row.
<P>
</OL>NOTE: It is preferable to move windows with BeginDeferWindowPos(),
DeferWindowPos(), and EndDeferWindowPos(), instead of many calls to
SetWindowPos(), because the visual effect of the window movement is much
cleaner.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib MDITILE.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrMdi<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
