

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Changing Size of an Edit Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80553 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/02/04">
<META NAME="Keywords" CONTENT="kb16bitonly UsrCtl kbfile kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  EXPEDIT is a file in the Microsoft Software Library that demonstrates changing the size of an edit control in response to an EN_UPDATE message. In the sample, when the typed text reaches the end of a line, the edit control expands to allow the user...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QA7O,QAMN,QAB5,QAOE,QBXT,QA5V,QAIB,QABN,QAEV,QDL9,QBWO,QBWN,QAUD,QAYC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Changing Size of an Edit Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80553 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg kbfile
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
EXPEDIT is a file in the Microsoft Software Library that demonstrates
changing the size of an edit control in response to an EN_UPDATE message.
In the sample, when the typed text reaches the end of a line, the edit
control expands to allow the user to continue typing on a new line.
<P>
Download EXPEDIT.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/EXPEDIT.EXE">EXPEDIT.EXE</A> <I>(size: 29990 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/EXPEDIT.EXE">EXPEDIT.EXE</A> <I>(size: 29990 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Windows sends the EN_UPDATE notification message to the parent of the edit
control whenever the contents of the edit control have been altered, but
before the display is updated. The notification is sent to the parent
window as the HIWORD of the lParam parameter of a WM_COMMAND message. The
ID of the control is in the wParam.
<P>
Therefore, for an application to determine when it is necessary to change
the size of the edit control, it must handle the WM_COMMAND case in which
the wParam is the ID of the control and the HIWORD of the lParam is
EN_UPDATE. When EXPEDIT receives an EN_UPDATE notification message, it
performs the following eight actions:

<OL><P><LI>Sends an EM_FMTLINES message to the edit control (wParam = 1). When
   the control processes this message, it modifies its buffer to have
   the character sequence carriage return-carriage return-linefeed
   (CR-CR-LF) at the end of each line.

<P><LI>Retrieves the length of the edit control's buffer.

<P><LI>Passes a handle to the (nonempty) buffer of the DrawText() function,
   which calculates the size of the rectangle required to hold all the
   text.

<P><LI>Adjusts the text height returned by DrawText because DrawText
   interprets the CR-CR-LF sequence at the end of each buffer line as
   two lines instead of one.

<P><LI>Compares the right edge of the rectangle returned from DrawText with
   the "limit." DrawText will extend the right edge of the rectangle
   if the text is too long. If the right edge of the last line exceeds
   the limit, then the edit control needs an additional line. EXPEDIT
   performs all the obvious limit checks.

<P><LI>If the height has not changed, then it is not necessary to change
   the size of the edit control, and EXPEDIT returns. Otherwise,
   the size of the edit control must be changed.

<P><LI>Updates the size of the edit control with MoveWindow() and
   UpdateWindow().

<P><LI>Returns FALSE so that the Dialog Manager will not do anything when
   it receives the EN_UPDATE message.
<P>
</OL>NOTE: The key idea of this implementation is to "predict" whether the next
character will fit in the edit control; if it will not, then add a new line
to the control so that the character will fit. This prediction is
accomplished by subtracting the width of "W" from the edge of the edit
control's rectangle to get the limit.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib EXPEDIT.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrCtl<BR>
Keywords            : kb16bitonly UsrCtl kbfile kbprg<BR>
Version             : 3.00 3.10<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
