

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use _export Keyword or DEF File EXPORTS Statement </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77986 ">
<META NAME="KBModify" CONTENT="1997/08/12">
<META NAME="KBCreate" CONTENT="1991/10/31">
<META NAME="Keywords" CONTENT="kb16bitonly KrDll kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  In Windows 3.0 and later, the _export keyword should not be used as a general replacement for exporting functions in the EXPORTS section of a module-definition (DEF) file.  MORE INFORMATION  The _export declarator can sometimes be used to export fu...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QDL9,QBWO,QBWN,QAY5,QAB9,QBV8,QBWQ,QAH4,QBBI,QAEY,QBVV,QAY2,QAPN,QAM1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use _export Keyword or DEF File EXPORTS Statement</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77986 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Windows 3.0 and later, the _export keyword should not be used as a
general replacement for exporting functions in the EXPORTS section of a
module-definition (DEF) file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The _export declarator can sometimes be used to export functions from
Windows-based applications and dynamic-link libraries (DLLs); however, this
method has several limitations.
<P>
In the Windows environment, all callback functions must be flagged as
exported to ensure that the prolog code is fixed up at load time. The fixed
up prolog code works with the procedure-instance addresses returned from
the MakeProcInstance() function to bind the proper data segment to the
exported function when it is called.
<P>
Examples of callback functions are: window procedures, dialog box
procedures, and enumeration callback procedures (see Section 14.4, "Writing
Exported Functions" in the "Microsoft Windows Software Development Kit
Guide to Programming"). A DLL must also flag as exported any functions
called from other modules.
<P>
The second edition of "Programming Windows" by Charles Petzold (Microsoft
Press) has a good explanation of the special Windows prolog code and the
effects of listing functions in the EXPORTS section of the module-
definition file (pages 280-286 and 895-896).
<P>
Usually, functions are flagged as exported by listing them in the EXPORTS
section of the modules' module-definition file. In addition to enabling
fixup of the prolog code, exporting functions from the module-definition
file provides control of the ordinal values of the exported functions. This
is especially important for DLLs because existing applications that call
the exported functions will not need to be relinked when the DLL is
modified if the interface-function prototypes and ordinal values are not
changed between versions. Specifying ordinal values also allows the Windows
dynamic-link mechanism to operate faster and to use less memory.
<P>
When compiling Windows-based applications and DLLs using Microsoft C
version 6.0 and later, the _export keyword may be used in place of listing
the function in the EXPORTS section of the module-definition file, with the
following limitations:

<UL><LI>This method provides no control over the ordinal values of the
   exported functions (as discussed above).

<LI>The function name is not resident. RESIDENTNAME, required for WEPs
   (Windows exit procedures) in DLLs, can be specified only in a
   module-definition file.

<LI>Exportname cannot be specified (no alias name).

<LI>The NODATA option cannot be specified.

<LI>The "parameter-option specification" cannot be overridden.
<P>
</UL>For more information, see pages 10-4 and 10-5 in the "Microsoft Windows
Software Development Kit Reference Volume 2."
<P>
 
<PRE>Keywords          : kb16bitonly KrDll kbhowto
Version           : 3.0 3.1
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
