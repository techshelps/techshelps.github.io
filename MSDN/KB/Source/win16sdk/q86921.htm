

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tap and Tap-and-Hold Pointer Events </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86921 ">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1992/07/20">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  In the Microsoft Windows for Pen Computing environment, the pen can exhibit either mouse or pen functionality. Generally, the pen acts similar to a mouse until the Recognize function determines that the user started a recognition session. To enable...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBHF,QAO4,QAPN,QDL9,QBWO,QBWN,QAO3,QAY5,QAUD,QAO2,QAQ7,QBV8,QAB9,QAGU,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Tap and Tap-and-Hold Pointer Events</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86921 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Pen Computing version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the Microsoft Windows for Pen Computing environment, the pen can exhibit
either mouse or pen functionality. Generally, the pen acts similar to a
mouse until the Recognize function determines that the user started a
recognition session. To enable the pen to function even better as a mouse
in applications developed for standard (non-pen) Microsoft Windows, the
Recognize() function may abort the recognition session with a pointer event
return value to indicate that the user intends to perform a standard mouse
operation instead of starting a recognition session. The ProcessWriting()
function also exhibits this behavior.
<P>
A pen-centric application can take advantage of this functionality by
clearing the RCO_NOPOINTEREVENT flag in the lRcOptions field of the
recognition context (RC) data structure. The text below describes pointer
events and provides some pseudocode to demonstrate how an application might
process the REC_POINTEREVENT return value.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows for Pen Computing defines two types of pointer events: "tap" (Tap)
and "tap and hold" (TapNHold). A Tap is analogous to clicking the left
mouse button. The user produces a Tap by clicking the tip of the pen on the
tablet and removing it quickly, without otherwise moving the pen. The user
produces a TapNHold by clicking the tip of the pen on the tablet and
holding it there without movement for a specified amount of time.
<P>
An application can be notified of these events early in the recognition
process if it calls the Recognize function with a valid RC data structure.
If the RCO_NOPOINTEREVENT flag is not set in the RC structure (the
default), the Recognize function looks for pointer events and returns. The
following pseudocode demonstrates how an application can process both types
of pointer events:
<P>
<PRE>   case WM_LBUTTONDOWN:
      if (IsPenEvent(message, GetMessageExtraInfo()))
      {
         // Process pen event
         InitRC(hwnd, &amp;rc);  // May have been done previously...
         if (Recognize(&amp;rc) == REC_POINTEREVENT)
         {
            // Process pointer event
            if (GetAsyncKeyState(VK_LBUTTON) &amp; 0x8000)
               // Pen is still down: TapNHold functionality
            else
               // Pen up: Tap functionality
         }
      }
      else
         // Process mouse event
      break;

</PRE>Note that if the Recognize function aborts with a REC_POINTEREVENT return
value, no further recognition takes place. The system recognizer will not
have been called. Therefore, the application will not receive a WM_RCRESULT
message.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: WpenRcgnzr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
