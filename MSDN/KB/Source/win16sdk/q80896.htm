

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 3.1 Application Compatibility (part 1 of 7) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80896 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/02/20">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Application Compatibility Document for Windows 3.1  To make Windows version 3.1 better and more robust than Windows version 3.0, Microsoft enhanced and improved many Windows features. Although every effort was made to ensure compatibility with appl...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAVW,QAVX,QAJH,QAA1,QBTX,QAGU,QAPG,QAG9,QAMB,QDI2,QAYZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 3.1 Application Compatibility (part 1 of 7)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80896 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10
WINDOWS
kbtool 31compattest
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h3>Application Compatibility Document for Windows 3.1</h3>
 
<P>
To make Windows version 3.1 better and more robust than Windows
version 3.0, Microsoft enhanced and improved many Windows features.
Although every effort was made to ensure compatibility with
applications developed for Windows version 3.0, some enhancements may
affect the operation of these applications -- especially if an
application uses features in an undocumented fashion or relies on
invalid assumptions about the behavior of Windows.
<P>
Microsoft is eager to help you resolve any compatibility problems you
may encounter. This document identifies the enhancements that may
affect existing Windows version 3.0 applications and explains how you
can determine whether your application will run successfully under
Windows version 3.1.
<P>
Please read each section carefully and use the "Windows 3.1
Compatibility Test" (available separately) as a checklist to ensure
that you have carried out the recommended tests. As you complete each
test, mark whether your application passed or failed the test. If your
application failed a test, please supply comments that will help
Microsoft determine the cause of the compatibility problem. If you
choose not to carry out a test, please indicate why in the comments
section.
<P>
When you have completed the Compatibility Test, return it to:
<P>
<PRE>   Windows Compatibility Test
   Microsoft Corporation
   One Microsoft Way
   Building 4
   Redmond, WA 98052-6399

</PRE>Due to the amount of information in this document, it has been broken
into seven pieces. To find all seven pieces of this document and the
Windows 3.1 Compatibility Test checklist, query this knowledge base on
the words:
<P>
<PRE>   prod(winsdk) and 31compattest



                   Application Installation Programs
                   =================================

</PRE>Enhancements to the Program Manager's group file format and extensions
to the PROGMAN.INI file may affect your application's installation
program.
<P>
<P><h3>Potential Problem</h3>
 
<P>
Your installation program may not correctly add your application's
icon to Program Manager or may not correctly save your application's
PROGMAN.INI settings.
<P>
<P><h3>Tests</h3>
 
<P>
Run your installation program in each of the following applicable
environments:

<UL><LI>MS-DOS
<LI>MS-DOS command prompt under Windows version 3.1
<LI>Windows using the Run command in the Program Manager's File menu
<P>
<P>
<PRE>                             Windows Setup
                             =============

</PRE></UL>Windows version 3.1 Setup is easier to use, faster, more robust, and
capable of detecting more hardware and network configurations than was
the Windows version 3.0 Setup. Special attention was given to the need
to upgrade from Windows version 3.0 while maintaining existing group
files and WIN.INI settings.
<P>
<P><h3>Potential Problem</h3>
 
<P>
Setup may fail to correctly preserve your application's program group
files and WIN.INI settings.
<P>
<P><h3>Test</h3>
 
<P>
Use Setup to install Windows version 3.1 on a computer on which both
Windows version 3.0 and your application are already installed. After
installation, be sure that your application's WIN.INI settings are
correct and that your application runs properly.
<P>
<P>
<PRE>                         Shell Application
                         =================

</PRE>This section applies only to applications that replace the standard
Windows shell application, Program Manager. The shell application (as
specified by the "shell" setting in the SYSTEM.INI file) is no longer
guaranteed to be the first process.
<P>
<P><h3>Potential Problem</h3>
 
<P>
An application that assumes it is the shell only when it is the first
process will not exit Windows correctly when terminated.
<P>
<P><h3>Test</h3>
 
<P>
Make your application the shell by specifying your application's
executable filename with the "shell" setting in the SYSTEM.INI file.
Exit Windows and be sure Windows terminates correctly.
<P>
<P><h3>Solution</h3>
 
<P>
Your application must determine whether it is the shell by doing the
following:

<OL><P><LI>Check the number of processes running when it starts.

<P><LI>If more than one process is running, check the shell setting in the
   SYSTEM.INI file.
<P>
<P>
<PRE>                      Windows Shell Applications
                      ==========================

</PRE></OL>Enhancements to the Program Manager, File Manager, Print Manager, and
Control Panel may affect your application.
<P>
<P><h3>DRAG AND DROP</h3>
 
<P>
Drag and drop was reimplemented, and Windows now exports the drag-drop
functions and message (WM_DROPFILES).
<P>
<P><h3>Potential Problem</h3>
 
<P>
An application that reverse-engineered the Windows version 3.0 drag-
drop protocol may encounter difficulties.
<P>
<P><h3>Tests</h3>
 

<OL><P><LI>Drag a file from File Manager to your application. Be sure your
   application opens the proper file.

<P><LI>Drag a file associated with your application to Print Manager. Be
   sure your application opens and prints the proper file.
<P>
<P>
</OL><h3>SYSTEM COLORS</h3>
 
<P>
Windows now provides more system colors and user preferences. Users
can select separate colors for active and inactive title bar text,
button face, button shadow, button text, button highlight, disabled
text, highlight, and highlighted text. Different wallpapers and color
schemes were added, and the default color scheme is changed.
<P>
<P><h3>Potential Problem</h3>
 
<P>
An application may not use all colors correctly.
<P>
<P><h3>Test</h3>
 
<P>
Display your application's windows, dialog boxes, and controls, and
check the colors of the active and inactive title bar text, button
face, button shadow, button text, button highlight, disabled text,
highlight, and highlighted text colors. Use the Control Panel to set
each of the following system color schemes:

<UL><LI>System colors set to default.
<LI>System colors set to a nondefault color scheme, such as Arizona.
<LI>System colors set to a random scheme in which you set colors
   individually. (Don't use the predefined color schemes.)
<P>
<P>
</UL><h3>CARDFILE AND WRITE FILES</h3>
 
<P>
The Cardfile file format is changed, and both Cardfile and Write
documents can now contain embedded OLE objects.
<P>
<P><h3>Potential Problem</h3>
 
<P>
Any application that makes assumptions about Cardfile and Write file
formats may not be able to read or write to these files correctly.
<P>
<P><h3>Tests</h3>
 

<OL><P><LI>Use your application to create Cardfile or Write files. Use Windows
   version 3.1 Cardfile and Write to open and view the files.

<P><LI>Use Windows version 3.1 Cardfile and Write to create files
   containing OLE objects. Be sure your application can open and read
   the files.
<P>
</OL><h3>OTHER CONSIDERATIONS</h3>
 

<UL><LI>Path searching is enhanced. When trying to load DLLs, Windows
   searches directories in the following order: current directory,
   Windows directory, System directory, application directory, path.
   The application directory is new for Windows version 3.1.

<LI>Title fonts for Program Manager and desktop icons are changed, and
   icon titles can now wrap.

<LI>More than one printer can now be installed on a port.

<LI>Control Panel's font installation is enhanced.

<LI>Program Manager automatically reconnects network drives and devices
   when Windows is restarted.

<LI>File Manager is entirely new for Windows version 3.1. File Manager
   includes an interface that lets applications add menu items to File
   Manager menu by using a File Manager extension library.

<LI>Control Panel now provides an interface for adding new Control
   Panel applications and icons.

<LI>The Startup group contains applications that load whenever Windows
   is started. For backward compatibility, Windows continues to
   support the "load" line in the WIN.INI file.

<LI>The [intl] section in the WIN.INI file is enhanced. More date
   formats and currency symbols are available.

<LI>Desktop spacing can now be changed by a new setting in the WIN.INI
   file and by the SystemParametersInfo function.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10<BR>
KBCategory: kbtool<BR>
KBSubcategory: TlsCompat<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
