

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: DDEML Samples Using Microsoft Foundation Classes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92829 ">
<META NAME="KBModify" CONTENT="1997/07/07">
<META NAME="KBCreate" CONTENT="1992/11/16">
<META NAME="Keywords" CONTENT="kbfile kbprg kbsample UsrDde">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  CDDEML is a set of two sample applications that demonstrate a DDEML client and a DDEML server. They are written using the Microsoft Foundation Class Libraries (MFC) and define new classes for handling DDEML.  The following file is available for dow...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBGP,QABO,QAPF,QAY5,QAY2,QARL,QAJH,QAB5,QAI8,QBV8,QAB9,QBXF,QDL9,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: DDEML Samples Using Microsoft Foundation Classes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92829 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
CDDEML is a set of two sample applications that demonstrate a DDEML client
and a DDEML server. They are written using the Microsoft Foundation Class
Libraries (MFC) and define new classes for handling DDEML.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Cddeml.exe">Cddeml.exe</A> <I>(size: 57709 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This sample contains two applications that demonstrate a DDEML server and
DDEML client in MFC applications. This sample defines four new classes to
help implement the DDEML support. These classes are:
<P>
<PRE>   CDDEClient
   CDDEClientConv
   CDDEServer
   CDDEServerConv

</PRE>The CDDEClient and CDDEServer classes encapsulate the functionality of a
DDEML client or server. CDDEClientConv and CDDEServerConv encapsulate
individual conversations that are managed by the CDDEClient or CDDEServer
class. The CDDEClient and CDDEServer classes maintain a map of the current
conversations according to the conversations handle. Using this map, the
server or client can look up any ongoing conversation based on its handle.
<P>
These classes were designed to implement DDEML in a very general way. As a
result, these classes don't do much by themselves; they are designed to be
reused in an application by deriving from each of these classes. Typically,
an application derives one class from CDDEClient or CDDEServer. This
derived class contains details such as what conversations are supported and
how to handle callbacks that do not relate to a specific conversation.
Usually there is only one instance of this class in an application. An
application may derive many classes from CDDEClientConv or the application
supports. These derived classes implement how each conversion handles
callbacks. They also may contain buffers to store data from the
conversation, or pointers to other objects that they need to communicate
with. This sample contains a client and server application built using the
classes mentioned above.
<P>
One difficulty in writing DDEML classes is how to handle the DDEML callback
function. In this sample, the DDEML callback function is contained in the
CDDEClient or CDDEServer class. The callback function first checks to see
whether the transaction is for the client or server, or for one of the
conversations. If it is for the client or server, then the callback
function calls the member function that handles that transaction. If the
transaction is for a conversation, then the callback function looks up the
pointer to the conversation object using the handle of the conversation in
the conversation map. Then it calls the member function of the conversation
that handles that transaction. Therefore, by using these classes, an
application developer does not need to write a DDEML callback function.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib CDDEML.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrDde<BR>
Keywords            : kbfile kbprg kbsample UsrDde<BR>
Technology          : kbMfc<BR>
Version             : 3.0 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
