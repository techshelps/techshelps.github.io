

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Modifying the System Menu of an MDI Child Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77930 ">
<META NAME="KBModify" CONTENT="1997/08/12">
<META NAME="KBCreate" CONTENT="1991/10/30">
<META NAME="Keywords" CONTENT="kb16bitonly UsrMdi kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The system menu of an MDI child can be modified only after the WM_CREATE message for the MDI child is processed. If an application tries to modify the system menu of an MDI child during the processing of the child's WM_CREATE message, the system me...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QAUD,QAF0,QDL9,QBWO,QBWN,QAYC,QARL,QDKW,QAGQ,QBWR,QAY0,QALZ,QBXU,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Modifying the System Menu of an MDI Child Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77930 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The system menu of an MDI child can be modified only after the WM_CREATE
message for the MDI child is processed. If an application tries to modify
the system menu of an MDI child during the processing of the child's
WM_CREATE message, the system menu will not be changed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is common to try to alter a window's system menu during the processing
of its WM_CREATE message. This method has no effect on the system menu of
an MDI child, however, because of the way a MDI child window is created:

<OL><P><LI>The MDI client window calls the CreateWindowEx() function to create
   the window.

<P><LI>Then, the MDI client window replaces the default system menu with
   the special MDI child system menu.
<P>
</OL>The WM_CREATE message is sent to the child window by CreateWindowEx().
Changes to the MDI child's system menu on WM_CREATE have no effect
because the MDI client assigns a special MDI system menu to the child
after CreateWindowEx() returns.
<P>
To work around this design decision, the child window procedure can
post a custom message to itself during the processing of its WM_CREATE
message. This custom message is processed after the MDI client has
finished creating the MDI child. The code for this workaround might
resemble the following:
<P>
<PRE>#define WM_ADDMENUITEM (WM_USER+1)

</PRE></OL>LONG FAR PASCAL MDIChildWndProc(HWND hWnd,
<PRE>                                WORD wMsg,
                                WORD wParam,
                                LONG lParam)
{
    switch (wMsg)
       {
    case WM_CREATE:
       PostMessage(hWnd, WM_ADDMENUITEM, 0, 0L);
       break;

    case WM_ADDMENUITEM:
       {
       HMENU        hMenu;

       hMenu = GetSystemMenu(hWnd, FALSE);
       InsertMenu(hMenu, -1, MF_BYPOSITION, IDM_NEW,
             (LPSTR)"New Item\0");
       DrawMenuBar(hWnd);
       }
       break;

    default:
       return DefMDIChildProc(hWnd, wMsg, wParam, lParam);
       }

    return 0;
</PRE>}
<P>
 
<PRE>Keywords          : kb16bitonly UsrMdi kbhowto
Version           : 3.0 3.1
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
