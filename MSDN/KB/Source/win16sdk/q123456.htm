

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: MSCDEX May Not Detect Disk Change </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123456">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1994/12/01">
<META NAME="Keywords" CONTENT="MMCDROM kb3rdparty kbmm">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  If a GetAttributes function call is the first MS-DOS API call made following a CD-ROM disk change, MSCDEX doesn't detect that the disk is changed, so the function call reflects the contents of the previous disk. The next Open, Search, or Change Dir...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAY5,QAIF,QDL9,QBWO,QBWN,QBV8,QAB9,QDLP,QABI,QABH,QBXM,QBWS,QAKP,QAC9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: MSCDEX May Not Detect Disk Change</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123456</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft CD-ROM Extensions (MSCDEX) for MS-DOS,
   versions 2.0, 2.1, 2.2, 2.21, 2.22, 2.23
<LI>Microsoft Windows Software Development Kit (SDK), version 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a GetAttributes function call is the first MS-DOS API call made
following a CD-ROM disk change, MSCDEX doesn't detect that the disk is
changed, so the function call reflects the contents of the previous disk.
The next Open, Search, or Change Directory function call will cause MSCDEX
to detect the disk change.
<P>
<P><h2>CAUSE</h2>
 
<P>
The MSCDEX driver fails to issue a Media Check call to the Hardware
Dependent Device Driver when the GetAttributes call is made.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can check for a CD-ROM ID file by using the C-Runtime access() function
or by making direct calls to the MS-DOS Interrupt 21h. Function AX=4300h
should be changed to use a file open call. Windows Applications that use
the SDK OpenFile() function to detect a key file should be changed to use
_lopen().
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the MSCDEX versions listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The OpenFile() function in the Microsoft Windows version 3.1 SDK makes a
GetAttributes function call prior to opening a file for reading if the
system is running with Novell Netware loaded. The OpenFile() function fails
if the GetAttributes() function fails to find the requested file. As a
result, if the OpenFile() function is used to detect which CD-ROM is in the
drive by opening a key file, the wrong CD-ROM may be detected following a
disk change.
<P>
NOTE: Some products mentioned in this article are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: buglist2.00 buglist2.10 buglist2.20 buglist2.21<BR>
buglist2.22 buglist2.23<BR>
Keywords          : MMCDROM kb3rdparty kbmm<BR>
Version           : MS-DOS:2.0,2.1,2.2,2.21,2.22,2.23;WINDOWS:3.1<BR>
Platform          : MS-DOS WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
