

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Baud Rates in Windows 3.1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108928">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1993/12/20">
<META NAME="Keywords" CONTENT="kb16bitonly kbprg KrCommapi kbhowto kbprg kbwebcontent">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Under Windows 3.1, baud rates are specified in the BaudRate field of the communications port's DCB structure, and are set using SetCommState(). Baud rates can be specified by using the CBR_ constants listed in WINDOWS.H, or by using the actual baud...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QALA,QAK9,QBXS,QAKJ,QDL9,QBWO,QBWN,QBBI,QAEN,QBWQ,QANY,QAB6,QABA,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Setting Baud Rates in Windows 3.1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108928</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under Windows 3.1, baud rates are specified in the BaudRate field of the
communications port's DCB structure, and are set using SetCommState(). Baud
rates can be specified by using the CBR_ constants listed in WINDOWS.H, or
by using the actual baud rate.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
OpenComm(), by default, sets the baud rate of a communications port to
9600. BuildCommDCB() can be used to set the baud rate; however,
BuildCommDCB() accepts only the following baud rates: 110, 150, 300, 600,
1200, 2400, 4800, 9600, and 19200. If none of these baud rates are used,
BuildCommDCB() returns an error.
<P>
The SetCommState() function can be used to set the baud rate to values
between 2 and 115,200. The following CBR_ constants are defined in
WINDOWS.H:
<P>
<PRE>   CBR_110        CBR_14400
   CBR_300        CBR_19200
   CBR_600        CBR_38400
   CBR_1200       CBR_56000
   CBR_2400       CBR_128000
   CBR_4800       CBR_256000
   CBR_9600

</PRE>NOTE: These are not the same constants as a listed in the Windows 3.1 SDK
documentation for the DCB structure.
<P>
NOTE: The CBR_56000 constant actually corresponds to a baud rate of 57,600.
<P>
NOTE: The baud rate divisor is incorrect for CBR_14400.
<P>
SetCommState() allows either the CBR_ constant or the actual baud rate in
the BaudRate field of the DCB. SetCommState() calls into COMM.DRV to apply
the DCB settings to the communications port. Although CBR_128000 and
CBR_256000 are defined, they are not used in the communications driver
(COMM.DRV).
<P>
When setting the baud rate, COMM.DRV first determines if the baud rate is a
CBR_ constant; if so, COMM.DRV looks up the baud rate divisor in a table.
<P>
If the baud rate is not in the CBR_ constant table and the UART is 8250,
16540, or 16550, the baud rate is set using 115,200 as the divisor and is
divided by the user specified baud rate. The subsequent integer value from
this division is used to set the baud rate (the remainder from the division
is not used). For example, if the user specified a baud rate of 60000, the
calculation would be 115200/60000, which is 1.
<P>
Therefore, the baud rate can be set to 115,200 by placing any value in
BaudRate that is greater than CBR_56000 (57,600) and less than CBR_110,
because this will always equal a baud rate of 1 (using the above formula)
and signal the UART to operate at it's highest possible speed (115,200). A
115,200 baud rate cannot be specified directly in the DCB structure because
the baud rate variable is an unsigned integer and cannot be larger than 64k
in the 16 bit world.
<P>
Third-party replacement communications drivers may set baud rates
differently. If using a replacement, check with the software manufacturer
to determine how to correctly set the baud rate.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: CBR_128000 CBR_256000 COMM.DRV<BR>
Keywords            : kb16bitonly kbprg KrCommapi kbhowto kbprg kbwebcontent<BR>
Version             : 3.10<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
