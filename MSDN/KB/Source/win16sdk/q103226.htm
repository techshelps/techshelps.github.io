

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Mixed-Language Application (VB, COBOL, SQL) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103226">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1993/08/18">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT=" VBCOBSQL: Demonstrates a Mixed-Language (Visual Basic-COBOL-ESQL) Application  You can use Microsoft(R) Visual Basic(TM), Microsoft COBOL, and Microsoft SQL Server to build full-featured client-server applications that use the strengths of each prod...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QABM,QAH6,QABI,QDNN,QA5F,QAMA,QAJH,QDL9,QBWO,QBWN,QBAQ,QAZV,QAY2,QAOT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Mixed-Language Application (VB, COBOL, SQL)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103226</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   version 3.1
</UL> 
<P>
VBCOBSQL: Demonstrates a Mixed-Language (Visual Basic-COBOL-ESQL)
Application
<P>
You can use Microsoft(R) Visual Basic(TM), Microsoft COBOL, and
Microsoft SQL Server to build full-featured client-server applications
that use the strengths of each product. Visual Basic creates the
graphical user interface. Subroutine calls are made in the Basic code
to COBOL dynamic-link libraries (DLLs). The COBOL DLL contains
Embedded SQL (ESQL) to request the necessary data from the SQL Server.
The COBOL DLL manipulates the retrieved data as required, then passes
the data back to Visual Basic. In other words, Visual Basic is the
graphical front-end and COBOL DLL is the back-end of the client
application.
<P>
VBCOBSQL uses the PUBS database from the SQL Server package. The demo
makes several queries to the PUBS database, such as Author Search and
List Publications in a Category. It also allows you to insert and
delete authors and add new publications to the database.
<P>
To build VBCOBSQL, you will need Visual Basic version 2.0 Professional
Edition, Microsoft COBOL version 5.0 or Micro Focus(R) COBOL version
3.0, and Embedded SQL Toolkit for COBOL.
<P>
In Visual Basic, load the VBCOBDEM.MAK project and build an .EXE file
for the application. Before building the COBOL DLL that accesses SQL
Server, make sure that your build environment is set up to build
COBOL/SQL Server applications. Set the LIB environment variable to
include the drive and path of the following files:

<UL><LI>LCOBOLW.LIB (supplied with the COBOL compiler)

<LI>COBW.LIB (supplied with the COBOL compiler)

<LI>SQLAKW.LIB (supplied with Embedded SQL for COBOL)

<LI>W3DBLIB.DLL (supplied with Embedded SQL for COBOL)
<P>
</UL>You also need the object file, CBLWINA.OBJ, supplied with the COBOL
compiler. You must specify "Mixed Language Support" when you install
this file from the COBOL disks.
<P>
Next, edit the VBCOBSQL.DIR directives file to use your own server,
database, user ID, and password. There are two ways to build the DLL:

<UL><LI>Run COBC.BAT and COBL.BAT, in that order. The first batch file
   compiles the DLL and the second links it. VBCOBSQL.DLL will be
   created.

<LI>Build the DLL using Programmer's WorkBench (PWB). This sample
   includes the VBCOBSQL.MAK make file to allow you to build with PWB.
<P>
</UL>Make sure that this DLL is in your current directory or in your PATH.
For more information on building DLLs, see "COBOL Programming for
Windows," Chapter 2 (Building Dynamic Link Libraries) included with
Microsoft COBOL or the Micro Focus(R) COBOL User's Guide.
<P>
Before running the demo, make sure that the following files are in
your current directory or in your PATH:

<UL><LI>SQLAKW.DLL  (provided with Embedded SQL toolkit for COBOL)

<LI>W3DBLIB.DLL (provided with Embedded SQL toolkit for COBOL)

<LI>DBNMP3.DLL  (provided with Embedded SQL toolkit for COBOL)

<LI>CBLWIN.DLL  (provided with the COBOL compiler)

<LI>CBLSSEG.DLL (provided with the COBOL compiler)

<LI>VBRUN200.DLL (provided with Visual Basic version 2.0)
<P>
</UL>To run the demo, run the executable file you created in Visual Basic.
You can also run the demo interactively in Visual Basic. In the login
screen, fill in the fields required to log into the PUBS database. If
the login is successful, you will be in the demo. You can then select
SQL options from the menu to perform the search/update operations. Use
the Help menu items to get more information on using the demo and
building mixed-language client-server applications.
<P>
VBCOBSQL is a companion application for the "Building VB/COBOL/ESQL
Mixed-Language Applications" technical article on the Microsoft
Developer Network CD.
<P>
Download VBCOBSQL.EXE, a self-extracting file, from the
Microsoft Software Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/VBCOBSQL.EXE">VBCOBSQL.EXE</A> <I>(size: 689385 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/VBCOBSQL.EXE">VBCOBSQL.EXE</A> <I>(size: 689385 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 softlib VBCOBSQL.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: GenSDK<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
