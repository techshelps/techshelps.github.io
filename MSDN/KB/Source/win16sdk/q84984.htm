

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: List of Functions That Are Valid in Metafiles </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84984 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/05/26">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Pages 2-41 and 2-42 of the  Microsoft Windows Software Development Kit (SDK) Reference Volume 1  for version 3.0 list the subset of Windows GDI functions that an application can use in a metafile under Windows 3.0. The list printed in the manual is...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAH2,QBWQ,QAY5,QBV8,QAB9,QAE1,QAY4,QA5V,QBFM,QABO,QAJH,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: List of Functions That Are Valid in Metafiles</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84984 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg kbdocerr
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Pages 2-41 and 2-42 of the "Microsoft Windows Software Development Kit
(SDK) Reference Volume 1" for version 3.0 list the subset of Windows
GDI functions that an application can use in a metafile under Windows
3.0. The list printed in the manual is incorrect.
<P>
Page 107 of the "Microsoft Windows Software Development Kit:
Programmer's Reference, Volume 1: Overview," lists the functions that
are valid in a metafile for Windows 3.1. This list is incomplete.
<P>
This article provides a corrected list of functions that an
application can use in a metafile under Windows 3.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following list of functions that are valid in a Windows 3.1
metafile is taken from page 107 of the "Windows SDK: Programmer's
Reference, Volume 1: Overview":
<P>
<PRE>AnimatePalette           OffsetViewportOrg   SetBkMode
Arc                      OffsetWindowOrg     SetDIBitsToDevice
BitBlt                   PatBlt              SetMapMode
Chord                    Pie                 SetMapperFlags
CreateBrushIndirect      Polygon             SetPixel
CreateDIBPatternBrush    Polyline            SetPolyFillMode
CreateFontIndirect       PolyPolygon         SetROP2
CreatePatternBrush       RealizePalette      SetStretchBltMode
Ellipse                  RestoreDC           SetTextColor
Escape                   RoundRect           SetTextJustification
ExcludeClipRect          SaveDC              SetViewportExt
ExtTextOut               ScaleViewportExt    SetViewportOrg
FloodFill                ScaleWindowExt      SetWindowExt
IntersectClipRect        SelectClipRgn       SetWindowOrg
LineTo                   SelectObject        StretchBlt
MoveTo                   SelectPalette       StretchDIBits
OffsetClipRgn            SetBkColor          TextOut


</PRE>The following table lists additional functions that are valid in a
metafile under Windows 3.1:
<P>
<PRE>CreateDIBitmap           CreateSolidBrush    Rectangle
CreateFont               DeleteObject        ResizePalette
CreateHatchBrush         ExtFloodFill        SetPaletteEntries
CreatePalette            FillRgn             SetTextAlign
CreatePen                InvertRgn           SetTextCharacterExtra
CreatePenIndirect        PaintRgn

</PRE>Although the following functions might function correctly in a
metafile, they should not be used in a metafile:
<P>
<PRE>AbortDoc                 EndPage             StartPage
EndDoc                   StartDoc            ResetDC

</PRE>Windows has a number of functions that are not supported in metafiles
directly because they are used to put an object into a metafile. The
region functions are a common example of this function category. An
application can create an arbitrary region, either directly or by
combining existing regions. When an application selects the handle to
the region into a metafile DC (display context), Windows records a
CREATEREGION record into the metafile.
<P>
An application can select a bitmap into a memory DC that is compatible
with the display (not directly into the metafile), and then then call
the BitBlt function to move the bitmap from the memory DC into the
metafile DC. Windows saves the bitmap image in the metafile as a DIB
(device-independent bitmap).
<P>
For more information, please refer to the online documentation for the
Windows SDK or pages 106-109 of the "Windows SDK: Programmer's
Reference, Volume 1: Overview" for version 3.1 manual.
<P>
* As a general rule, a metafile should be as device-independent as
possible. Therefore, an application should not record into a metafile
a GDI function that requires device units. Such functions include
BitBlt, FillRgn, SetViewportExt, and SetViewportOrg.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 docerr<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: GdiMeta<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
