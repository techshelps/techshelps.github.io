

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create Device-Independent Printing Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76260 ">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1991/09/18">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Windows provides a device-independent platform for application developers. Device independence applies to printing as well. To write code to work with any printer driver, applications must not rely on any special feature in a printer driver. Instea...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QAOX,QADF,QAH4,QABA,QACT,QAJH,QDL9,QBWO,QBWN,QAB5,QBVV,QBWQ,QBAO,QABB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Device-Independent Printing Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76260 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows provides a device-independent platform for application developers.
Device independence applies to printing as well. To write code to work with
any printer driver, applications must not rely on any special feature in a
printer driver. Instead, applications should direct all requests through
the Windows Graphical Device Interface (GDI).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are two major classes of printers: raster printers and PostScript
printers. This article is directed towards application support for raster
printers.
<P>
With the exception of the standard printer escapes, applications should not
rely on any printer escape to be supported in a particular printer driver.
Note that the printer escapes are supported in Windows 3.1, but it is
recommended that you use the new equivalent functions, instead of the
escapes.
<P>
The standard escapes/functions are: STARTDOC/StartDoc(), ENDDOC/EndDoc(),
NEXTBAND, NEWFRAME, SETABORTPROC/SetAbortProc(), and ABORTDOC/AbortDoc().
The remaining escapes are optional for printer drivers. Applications should
use the QUERYESCSUPPORT escape to test for the support of optional escapes.
Applications should not depend on private knowledge of how a particular
driver works.
<P>
For example, the DRAWPATTERNRECT escape is available on certain
devices. The following code fragment determines if the DRAWPATTERNRECT
escape is supported on the installed device. If not, an alternative
function, PatBlt(), is used to create the output.
<P>
<PRE>  short i;

  i = DRAWPATTERNRECT;

  if (Escape(hPr, QUERYESCSUPPORT, sizeof(i), (LPSTR)&amp;i, NULL))
      Escape(hPr, DRAWPATTERNRECT, sizeof(lpPatRect),
               (LPSTR)lpPatRect, NULL);
  else
      PatBlt(hPr, .....);

</PRE>Of the remaining escapes, the following are used frequently:
GETPHYSPAGESIZE, GETPRINTINGOFFSET, PASSTHROUGH, and DRAWPATTERNRECT.
An application should minimize the number of escapes that it uses.
<P>
Another area of device independence applies to ExtDeviceMode().
Applications should not allow the user to change printer settings globally.
If the user wants to change the printer settings for all applications, the
Control Panel utility should be used. It is more appropriate for printer
settings to be associated with an application, a document, or a particular
set of pages in a document. For more information please see the Knowledge
Base article
<P>
<PRE>   "Using ExtDeviceMode() to Modify Printer Settings"
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiPrn<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
