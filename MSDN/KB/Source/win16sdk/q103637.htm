

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Use EV_RINGTE for Modem Ring Detection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103637">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1993/08/26">
<META NAME="Keywords" CONTENT="kb16bitonly KrCommApi kbdocerr kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT=" Many communications applications need ring detection. The documentation for SetCommState() indicates that EV_RING should be the event to set for this purpose. However, the EV_RING bit does not work as expected; the EV_RINGTE (ring indicator trailing...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADN,QAHC,QAK2,QDL9,QBWO,QBWN,QAHB,QBXS,QAO4,QBWQ,QAPN,QAO2,QBVV,QAY0,QAS6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Use EV_RINGTE for Modem Ring Detection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103637</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10
WINDOWS
kbprg kbdocerr
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows,
   version 3.1
</UL> 
<P>
Many communications applications need ring detection. The documentation for
SetCommState() indicates that EV_RING should be the event to set for this
purpose. However, the EV_RING bit does not work as expected; the EV_RINGTE
(ring indicator trailing edge) event should be used for ring detection.
<P>
The trailing edge of the ring indicator (RI) generates a modem status
register (MSR) interrupt, which in turn sets the EV_RINGTE bit. EV_RING is
set to the current status of RI. Because the interrupt does not occur until
RI changes from high to low, EV_RING almost always is low (except when it
happens to be high during another MSR interrupt).
<P>
The EV_RINGTE event is not referenced in the SetCommEventMask()
documentation; however, it is defined in WINDOWS.H, and will be supported
in future versions of 16-bit Windows.
<P>
NOTE: The information in this article applies to the 16-bit comm driver in
Windows 95 also.
<P>
<P><h3>EV_RING</h3>
 
<P>
EV_RING is set when the ring indicator is detected high during Modem Status
Register (MSR) interrupt processing. This is an absolute state, but since
it is read only during MSR interrupt processing, it will almost always be
zero. The only time it will not be zero is when the ring indicator is high
and the MSR interrupt is triggered for some other reason, such as a change
in the state of a line (CD, CTS, or DSR). Because of this, EV_RING has no
real value for detecting a ring.
<P>
<P><h3>EV_RINGTE</h3>
 
<P>
EV_RINGTE is set when a ring is detected on the modem. The trailing edge of
a ring indicator generates an MSR interrupt, which in turn sets the
EV_RINGTE event. Use this event to detect a ring.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 Win16 COMM SetCommState event<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: KrCommApi<BR>
Keywords            : kb16bitonly KrCommApi kbdocerr kbprg<BR>
Version             : 3.10<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
