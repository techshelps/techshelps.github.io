

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Changing the Default Background Color of an MDI Client </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75002 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/08/06">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Normally, a multiple-document interface (MDI) client window defines its background color to be the system color value COLOR_BACKGROUND+1, which is defined in the Windows SDK file WINDOWS.H. This value corresponds to the window background color defi...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QARL,QABA,QDL9,QBWO,QBWN,QAB9,QAGQ,QAUD,QAKD,QAJ2,QAEV,QAPG,QBW9,QBTX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Changing the Default Background Color of an MDI Client</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75002 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Normally, a multiple-document interface (MDI) client window defines its
background color to be the system color value COLOR_BACKGROUND+1, which is
defined in the Windows SDK file WINDOWS.H. This value corresponds to the
window background color defined by the user in the Control Panel.
<P>
It is possible to alter the default background color of an MDI client
window by subclassing the MDI client window procedure, and processing the
WM_ERASEBKGND message. All other messages are passed to the original MDI
client window procedure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
During processing of the WM_ERASEBKGND message, the class word that defines
the MDI client's background color is altered using the SetClassWord()
function. Then, control is passed to the original MDI client window
procedure to paint and update the window. When control returns from the
original MDI client window procedure, the MDI client's class word that
defines the background color is set back to its original value so that
other MDI applications currently running are not affected.
<P>
Below is a sample window procedure that can be used to subclass the
default MDI client window procedure.
<P>
LONG FAR PASCAL MdiClientWndProc(hwnd, msg, wParam, lParam)
HWND hwnd;
WORD msg, wParam;
LONG lParam;
{
<PRE>  LONG lRetCode;

  switch (msg)
    {
  case WM_ERASEBKGND:
    {
    HBRUSH hbrNew, hbrOld;
                                       // create a solid purple brush
    hbrNew = CreateSolidBrush(RGB(75, 45, 145));
                                    // set the class background color
    hbrOld = SetClassWord(hwnd, GCW_HBRBACKGROUND, hbrNew);
                   // let the old window procedure handle the message
    lRetCode = CallWindowProc(lpfnMDIClientOld, hwnd, msg, wParam,
                lParam);
                             // set background back to original value
    SetClassWord(hwnd, GCW_HBRBACKGROUND, hbrOld);
    DeleteObject(hbrNew);         // all done with this, so delete it
    break;
    }

  default:
    lRetCode = CallWindowProc(lpfnMDIClientOld, hwnd, msg, wParam,
                lParam);
    break;
    }
  return lRetCode;
</PRE>}
<P>
This code fragment is taken from MDISUBCL.EXE, a file in the Microsoft
Software Library, which contains an application that demonstrates this
operation.
<P>
Download MDISUBCL.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/MDISUBCL.EXE">MDISUBCL.EXE</A> <I>(size: 24085 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/MDISUBCL.EXE">MDISUBCL.EXE</A> <I>(size: 24085 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib MDISUBCL.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrMdi<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
