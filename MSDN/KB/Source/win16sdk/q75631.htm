

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XLTABLE Clipboard Format Documentation Available </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75631 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1991/08/26">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  XLTABLE is a new clipboard format developed for use in dynamic-data exchange (DDE) conversations with Microsoft Excel.  Using this format instead of BIFF (the Binary Interchange File Format) results in faster conversations. Code to read and write t...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNG,QALG,QAKC,QA5V,QBSU,QBVP,QBC6,QATX,QAKD,QAI4,QAYY,QDNZ,QDL9,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XLTABLE Clipboard Format Documentation Available</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75631 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
XLTABLE is a new clipboard format developed for use in dynamic-data
exchange (DDE) conversations with Microsoft Excel.
<P>
Using this format instead of BIFF (the Binary Interchange File Format)
results in faster conversations. Code to read and write this format is
also easier to implement. The format does not introduce translation
problems that can occur when putting text on the clipboard.
<P>
The "Microsoft Excel Software Development Kit," part number 065-000-
020, describes all the Excel file formats. In the United States, this
document is available for $20.00 through the Microsoft Consultant
Relations Program by calling (800) 227-4679. Outside the United
States, contact the Microsoft subsidiary that supports your country
for pricing and availability information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information documents the XLTABLE data format:
<P>
<P><h3>FAST FILE FORMAT</h3>
 
<P>
The Fast DDE Table data consists of multiple simple_datablocks, one
after the other:
<P>
<PRE>   Fast_DDE_Table = &lt;simple_datablock&gt; &lt;simple_datablock&gt; ...
       &lt;simple_datablock&gt;

</PRE>A simple_datablock has three parts:
<P>
<PRE>    WORD tdt;       // The table datatype
    WORD cb;        // The size (in bytes) of the data part
    BYTE data[];    // There are cb bytes in this part

</PRE>Description of the Table Datatypes:
<P>
<PRE>tdt         Value    Meaning
---         -----    -------

tdtTable    0x0010   Gives the size of the table. The cb is 4.
                     The data (4 bytes) has two words: the first
                     word is the number of rows, the second word
                     is the number of columns.

tdtFloat    0x0001   The data contains floating point values in IEEE
                     real format. The size of each entry is 8 bytes.

tdtString   0x0002   The data contains strings in "st" format. In this
                     format, the first byte gives the length of the
                     string, and the following bytes make up the
                     string. The string is not null-terminated.

tdtBool     0x0003   Boolean values: 1 = TRUE, 0 = FALSE
                     Each entry is 2 bytes.

tdtError    0x0004   Error values for the cell:

                         0  = #NULL!
                         7  = #DIV/0!
                         15 = #VALUE!
                         23 = #REF!
                         29 = #NAME?
                         36 = #NUM!
                         42 = #N/A

                     Each entry is 2 bytes.

tdtBlank    0x0005   The cb is 2. The data (2 bytes) has one word.
                     The value of the word is the number of blank cells.

tdtType     0x0080   Not used. Gives the type of the cell. Each entry
                     is 2 bytes.

tdtFormat   0x0081   Not used. Gives the format of the cell (0-
                     relative index into the format table as shown in
                     the Format Number dialog box). Each entry is 2
                     bytes.

</PRE>Order of the cells: The first simple_datablock must be of type
tdtTable. This record provides the number of rows and columns. This is
followed by rows*cols cells represented by the subsequent
simple_datablocks. The cells are represented row-wise, (all cells of
the first row are listed first, then all cells of the second row, and
so on).
<P>
For example, the Fast DDE Table for a selection consisting of three
cells in a row, containing the strings "East", "West", and "North",
respectively, will resemble the following:
<P>
<PRE>   10 00 04 00 01 00 03 00    - tdtTable, 4, 1, 3
   02 00 10 00                - tdtString, 16
      04 45 61 73 74          - 4, East
      04 57 65 73 74          - 4, West
      05 4e 6f 72 74 68       - 5, North
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 DDE clipboard<BR>
KBCategory: kbprg<BR>
KBSubcategory: UsrClp<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
