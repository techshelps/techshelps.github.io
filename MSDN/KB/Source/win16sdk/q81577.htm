

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Limits on the Number of Open Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81577 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/03/11">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Because an application developed for the Windows graphical environment runs only within the MS-DOS environment, the number of files that the application can open is subject to two distinct limits imposed by MS-DOS. This article discusses these limi...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABN,QBWS,QBJQ,QDL9,QBWO,QBWN,QAKC,QAJH,QBC6,QBWQ,QAJB,QAG8,QAGI,QBVV,QARR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Limits on the Number of Open Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81577 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Because an application developed for the Windows graphical environment
runs only within the MS-DOS environment, the number of files that the
application can open is subject to two distinct limits imposed by
MS-DOS. This article discusses these limits.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The first limit on the number of open files is imposed by a table of
SFT data structures (System File Tables) within MS-DOS. The initial
number of SFTs is specified in the FILES= line of the CONFIG.SYS file.
MS-DOS version 5.0 does not provide a function to change the number of
SFTs in the table. However, some applications, including Windows,
contain the information necessary to change the size of the table.
<P>
The SFT table is global, that is, it is shared by all applications or
tasks that are active in the system. (Each task is represented by a
PSP or program segment prefix.) The exception to the global nature of
the SFT table, and the associated limit on the number of open files,
in introduced by Windows. Different groupings of applications, called
virtual machines (or VMs), have a "per VM" address space. This allows
a virtual machine to have a local portion of the SFT table, which
exists only in that VM. Because all graphical applications in the
Windows environment run in a single VM, only the MS-DOS (not
graphical) applications run in separate VMs.
<P>
MS-DOS does not support more than 255 SFTs. Therefore, it does not
support more than 255 open files at any time in any specific VM. The
SHARE utility, which extends MS-DOS core functionality, does not
support the ability to increase the size of the SFT table on a "per
VM" basis under Windows, because SHARE must, at any time, in any VM,
be able to enumerate all open SFTs in the entire system.
<P>
The second limit on the number of open files involves a "per
application" table, called the JFN table, which is stored in each
task's PSP. By default, the JFN in the PSP has room for 20 entries,
which limits each application to 20 open files. An application running
on MS-DOS version 3.3 and subsequent versions can change the size of
the JFN by calling MS-DOS INT 21h function 67h. This call allocates a
new JFN table and modifies values in the PSP to indicate the larger
size of the JFN table. This allows the application corresponding to a
particular PSP to open more than 20 files, provided that the global
SFT table, shared by all applications, has available SFTs.
<P>
The two limits work together as follows. First, to open a file, the
application must have a place available in its JFN table. Second,
MS-DOS must have an available SFT in its internal SFT table. Note that
if either of these requirements is not met, the OPEN (or CREATE) INT
21h call will fail with error 4.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: KrFileIO<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
