

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Using ASP with a SQL Trusted Conn with Guest Acct </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176380">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/11/06">
<META NAME="Keywords" CONTENT="AXSFCompADO AXSFDataBase">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  When using Microsoft SQL Server with Integrated or Mixed Security with Microsoft Internet Information Server (IIS) 3.0, it may be necessary to access SQL Server from a guest account. Setting up a guest account can be used to work around problems co...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAI5,QBG2,QAA1,QABI,QAGU,QBW7,QDI2,QBWG,QBWP,QATQ,QAK7,QAMJ,QBVX,QBWA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Using ASP with a SQL Trusted Conn with Guest Acct</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176380</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, versions 1.0, 1.0b
<LI>Microsoft Visual Studio versions 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using Microsoft SQL Server with Integrated or Mixed Security with
Microsoft Internet Information Server (IIS) 3.0, it may be necessary to
access SQL Server from a guest account. Setting up a guest account can be
used to work around problems connecting an IIS machine to SQL Server on a
separate physical machine over a trusted connection.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This method allows IIS, using Active Server Pages (ASP), to access a SQL
Server over a trusted connection, but the method limits all SQL access to
guest access only. If you want all users to connect to the SQL Server and
maintain their identity to properly map to different privilege levels in
SQL Server, you will need to use Basic authentication.
<P>
Use the following steps to set up a user account in the NT user manager,
make sure that both the SQL Server and the IIS machine have access to this
account, and map this account to an SQL account.

<OL><P><LI>Create an NT user account (WEBUSER for this example) that both machines
   have can access. This is easily done by creating the account on the
   domain controller. If this is not possible, a local user account must be
   set up on both the IIS machine and the machine hosting SQL Server. Make
   sure that the passwords match on all accounts you create, and keep track
   of this password.

<P><LI>Add the WEBUSER account to the guests group of both the SQL Server and
   the IIS machine.

<P><LI>On the machine running IIS, start the Internet Service Manager.

<P><LI>Open the properties for the WWW service.

<P><LI>In the Anonymous Logon section on the Service tab of this tabbed
   dialog box, change the user name to WEBUSER and the password to the one
   used in step 1.

<P><LI>On the machine hosting SQL Server, use the Security manager to map the
   WEBUSER account to an existing user logon on SQL Server. For more
   information on how to do this, consult the SQL Server documentation.
<P>
</OL>Make sure that any pages that need to access the SQL Server are accessible
by the WEBUSER account. All users that browse these pages will be
authenticated by NT as the WEBUSER and consequently, all connections to SQL
Server will be made as the WEBUSER.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../AXSF/Q176379.htm">Q176379</A></B>
   TITLE     : HOWTO: IIS and SQL Server on Separate Machines with Trusted
               Conn

</PRE></OL>For the latest Knowledge Base artices and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>


</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Paul Enfield, Microsoft Corporation
<P>
 
<PRE>Keywords          : AXSFCompADO AXSFDataBase
Technology        : kbInetDev
Version           : WINNT:1.0,1.0b,97
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
