

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: SQL Server with Integrated Security, IIS on Same Machine </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176378">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/11/06">
<META NAME="Keywords" CONTENT="AXSFCompADO AXSFDataBase AXSFSQL">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  This article describes how to set up Microsoft SQL Server using Integrated Security on the same physical machine as Microsoft Internet Information Server.  MORE INFORMATION  When using SQL Server through a Trusted Connection, it may be necessary to...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAA1,QAI5,QDI2,QBWP,QAK7,QBWS,QAAD,QAJQ,QABA,QBG2,QAY2,QATQ,QBW7,QBAO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: SQL Server with Integrated Security, IIS on Same Machine</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176378</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, versions 1.0, 1.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to set up Microsoft SQL Server using Integrated
Security on the same physical machine as Microsoft Internet Information
Server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When using SQL Server through a Trusted Connection, it may be necessary to
host SQL Server and Internet Information Server on the same machine. This
is commonly done with IIS 3.0 to work around limitations in accessing SQL
Server through a Trusted Connection.
<P>
To allow access to SQL Server through a Trusted Connection, the SQL Server
Login Security Mode needs to be set to either Mixed, or Windows NT
Integrated. This can be changed from the Microsoft SQL Server Enterprise
Manager,. From the Server menu, select SQL Server and Configure. The
login settings are on the tab labeled Security Options.
<P>
To properly facilitate ActiveX Data Objects (ADO) connections from Active
Server Pages (ASP), a System data source name (DSN) must be used.
<P>
Use the following steps to set up this DSN:

<OL><P><LI>On the machine running Windows NT 4.0 that hosts these two products,
   click the Start menu.

<P><LI>Select Settings.

<P><LI>Click Control Panel.

<P><LI>Double-click ODBC.

<P><LI>Select the System DSN tab from the tabbed dialog box.

<P><LI>Click Add.

<P><LI>Select the SQL Server ODBC driver from the list.

<P><LI>Name your new data source.

<P><LI>In the Server combo-box, type "(local)" without the quotes.

<P><LI>Check the "Trusted Connection" check box.

<P><LI>Change whatever additional settings are necessary for your DSN.

<P><LI>Click OK.
<P>
</OL>By setting the server to (local) we are preventing anyone using this DSN
from looking out to the network for the SQL Server. By avoiding this step,
you prevent the NTLM authentication process necessary to establish a
trusted connection to SQL Server.
<P>
After setting up this DSN, you may access it as you would normally in ASP
code.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base artices and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Paul Enfield, Microsoft Corporation
<P>
 
<PRE>Keywords          : AXSFCompADO AXSFDataBase AXSFSQL
Technology        : kbInetDev
Version           : WINNT:1.0,1.0b
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
