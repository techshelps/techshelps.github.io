

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Accessing SQL Server with Integrated Security from ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176377">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/11/06">
<META NAME="Keywords" CONTENT="AXSFCompADO AXSFDataBase AXSFSQL">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  When accessing SQL Server with integrated security from Active Server Pages (ASP) there are some limitations that you should be aware of when designing your Web site. This article gives a high-level overview of these limitations and describes possi...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAK7,QAI5,QBG2,QAAD,QBVX,QAVZ,QBWP,QAJQ,QABG,QBVV,QAGU,QDKW,QDNQ,QBC9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Accessing SQL Server with Integrated Security from ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176377</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, versions 1.0, 1.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When accessing SQL Server with integrated security from Active Server Pages
(ASP) there are some limitations that you should be aware of when designing
your Web site. This article gives a high-level overview of these
limitations and describes possible workarounds.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft SQL Server Integrated Security requires NTLM authentication in
order to map user accounts to SQL Server accounts. This process requires
that a token be created during the authentication process. This token
requires a the user password to create a private encryption key. Because of
this, the token can only be created on a domain controller or the logged on
user's machine. Also note that Windows NT 4.0 does not allow the forwarding
of such tokens.
<P>
With these points in mind you can see that after a Web browser is
authenticated by Internet Information Server (IIS), an authenticated
connection to the SQL Server is not possible. At this point when IIS
attempts to connect to SQL Server via NTLM, IIS does not have the necessary
information to complete the NT authentication process.
<P>
There are a couple possible workarounds to this limitation:
<P>
<P><h3>Host IIS and SQL Server on the Same Machine</h3>
 
<P>
By eliminating the need for IIS to create an authenticated connection to
SQL Server, you can work around this problem. To do this you must use a
data source name (DSN) that does not look out to the network for the SQL
Server and instead looks directly to the local machine. This can be done by
using the "(local)" setting in a System DSN.
<P>
<P><h3>Use Basic Authentication Instead of NTLM in IIS</h3>
 
<P>
By using Basic authentication, the password is BASE64 encoded and sent to
IIS during the authentication process. With the password, IIS can now
complete the NTLM authentication process when connection to SQL Server.
<P>
NOTE: This method is not secure. BASE64 encoded passwords can be decrypted
by anyone able to sniff network packets over the Internet or intranet.
<P>
<P><h3>Map the Anonymous User Account from IIS to a SQL Server Guest Account</h3>
 
<P>
This method assumes that all users will have the same level of privileges
to the SQL Server resources. This method is most often the LEAST acceptable
option.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../AXSF/Q176379.htm">Q176379</A></B>
   TITLE     : HOWTO: IIS and SQL Server on Separate Machines with Trusted
               Connection

   ARTICLE-ID: <B><A HREF="../AXSF/Q176378.htm">Q176378</A></B>
   TITLE     : HOWTO: SQL Server with Integrated Security, IIS on Same
               Machine


   ARTICLE-ID: <B><A HREF="../AXSF/Q176380.htm">Q176380</A></B>
   TITLE     : HOWTO: Using ASP with a SQL Trusted Conn with Guest Acct

</PRE>For the latest Knowledge Base artices and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A HREF="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>


</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Paul
Enfield, Microsoft Corporation
<P>
 
<PRE>Keywords          : AXSFCompADO AXSFDataBase AXSFSQL
Technology        : kbInetDev
Version           : WINNT:1.0,1.0b
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
