

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Cannot Open File Unknown Using Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166029">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/03/28">
<META NAME="Keywords" CONTENT="AXSFConfig kbsetup kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  When using Active Server Pages to query an Access database, you may encounter the following error message.     Microsoft OLE DB Provider for ODBC Drivers error '80004005'     [Microsoft][ODBC Microsoft Access 97 Driver] The Microsoft Jet database  ...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDKY,QAI5,QDNQ,QBW7,QDN9,QAHT,QAK7,QAB4,QAJQ,QBWG,QBG2,QACI,QBWS,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Open File Unknown Using Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166029</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Active Server Pages 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using Active Server Pages to query an Access database, you may
encounter the following error message.
<P>
<PRE>   Microsoft OLE DB Provider for ODBC Drivers error '80004005'

   [Microsoft][ODBC Microsoft Access 97 Driver] The Microsoft Jet database
   engine cannot open the file '(unknown)'. It is already opened
   exclusively by another user, or you need permission to view its data.

   /scripts/somefile.asp, line x

</PRE><h2>CAUSE</h2>
 
<P>
This Error message can be caused by any of the following conditions:

<OL><P><LI>The Access .mdb file is located on another machine than the IIS Server.
<P>
   -and-
<P>
   IIS Server is configured to use NT Challenge / Response when
   accessing secured script files.

<P><LI>The Access .mdb file is located on another machine than the machine
   running IIS.
<P>
   -and-
<P>
   IIS is configured to use the IUSR_computername account for anonymous
   access.
<P>
   -and-
<P>
   The script file being access is not secured and permits anonymous
   access.
<P>
   -and-
<P>
   The IUSR_computername is a local account and the same account/password
   does not exist on the remote machine

<P><LI>The Access .mdb file is located on another machine than the machine
   running IIS.
<P>
   -and-
<P>
   IIS is configured to use Basic (Clear Text) authentication when
   accessing secured script files.

<P><LI>The Access .mdb file is located on the same machine as the Web server.
<P>
   -and-
<P>
   The datasource uses a UNC path to point to the .mdb file (e.g.
   DSN=\\servername\share).
<P>
   -and-
<P>
   NT Challenge/Response is used to authenticate the user.
<P>
</OL><h2>RESOLUTION</h2>
 
<P>
A possible workaround for this issue is to move the .mdb file to the server
running IIS.
<P>
If it is not possible to move the .mdb file locally, the following
workarounds can be used to address the causes above:
<P>
Use Basic Authentication instead of NT Challenge response when accessing
secured scripts that query .mdb files located on another server. You can do
this with the following:

<UL><LI>Create another IUSR_computername account with the same password on the
   remote machine containing the .mdb file or specify
   DOMAIN\IUSR_computername for anonymous logon to IIS.

<LI>Grant access to the .mdb file or share for the authenticated user.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
When using NT Challenge / Response with IIS, the users credentials are
created at the browser. The credentials are then sent to IIS. IIS cannot
forward those credentials on to another server.
<P>
The connection is attempted, but there is no username specified when
connecting to the remote machine, so the connection fails.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../IIS/Q174811.htm">Q174811</A></B>
   TITLE     : FILE: Authentication and Security for Internet Developers

</PRE></OL> 
<PRE>Keywords          : AXSFConfig kbsetup kbtshoot
Version           : 3.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
