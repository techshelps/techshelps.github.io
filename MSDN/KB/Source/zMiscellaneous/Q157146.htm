

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PUB97: ACMSETUP Caused a General Protection Fault in Mfc40.dll </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157146">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/10/07">
<META NAME="Keywords" CONTENT="kberrmsg kbsetup kbdta">
<META NAME="KBArea" CONTENT="Support; KB; publisher, winprint">
<META NAME="Description" CONTENT="  When you run Publisher 97 Setup, you may see the following error message:     This program has performed an illegal operation and will be    shut down. If the problem persists, please contact the program    vendor.  When you click Details, you rece...">
<META NAME="Product" CONTENT="Publisher">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QA2R,QBWP,QBWS,QDNN,QDKA,QAJ6,QAUD,QAH4,QAA1,QDO1,QDL9,QDI2,QBWQ,QBWO P6 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PUB97: ACMSETUP Caused a General Protection Fault in Mfc40.dll</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157146</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Publisher 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Publisher 97 Setup, you may see the following error
message:
<P>
<PRE>   This program has performed an illegal operation and will be
   shut down. If the problem persists, please contact the program
   vendor.

</PRE>When you click Details, you receive the following error message:
<P>
<PRE>   ACMSETUP caused a general protection fault in module mfc40.dll.

</PRE>When you click Close, you receive this error message:
<P>
<PRE>   ARTGALRY.DLL is unable to register itself in the Registry.

</PRE>These errors occur after Publisher 97 installation reaches 100%, and
the message box indicating that your system is being updated is
displayed on the screen.
<P>
<P><h2>CAUSE</h2>
 
<P>
This occurs on computers where certain core dynamic link libraries
(DLLs) have been replaced by versions that are not compatible with
Publisher 97 setup.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you are running Windows 95 or Windows NT 3.51, rename the following
files.
<P>
<PRE>   Msvcrt20.dll
   Msvcrt40.dll
   Mfc40.dll

</PRE>After the files have been renamed, run Publisher Setup again.
<P>
If you are running Windows NT 4.0, rename the following two files:
<P>
<PRE>   Msvcrt20.dll
   Mfc40.dll

</PRE>Do not rename the Msvcrt40.dll file if you are running Windows NT 4.0.
<P>
NOTE: Some programs, such as the FastFind program, require
Msvcrt20.dll. If one of these programs is installed on your computer,
you may receive an error message when you try to rename Msvcrt20.dll
while you are in Windows. If this happens, do the following:

<OL><P><LI>Copy Msvcrt20.dll from your Publisher compact disc to a temporary
   location on your hard drive. For example, copy the file to the C:\
   directory.

<P><LI>On the Start menu, click Shut Down.

<P><LI>In the Shut Down dialog box, click to select "Restart in MS-DOS
   mode," and then click Yes.

<P><LI>At the command prompt, type the following instructions, and press
   ENTER (&lt;ENTER&gt;) after each line:
<P>
<P><PRE>      cd system &lt;ENTER&gt;
      ren msvcrt20.dll msvcrt20.bak &lt;ENTER&gt;
      copy c:\msvcrt20.dll &lt;ENTER&gt;
      exit &lt;ENTER&gt;
</PRE><P>
   Windows 95 restarts with a new copy of Msvcrt20.dll.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 4.0 3.0 w_mspub mspub pub97 pub4 gpf<BR>
general protection fault<BR>
Keywords          : kberrmsg kbsetup kbdta<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
