

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Locating and Excluding RAM/ROM Addresses in the UMA </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112816">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1994/03/22">
<META NAME="Keywords" CONTENT="kbusage kbtshoot kbtool">
<META NAME="KBArea" CONTENT="Support; KB; msdos">
<META NAME="Description" CONTENT="  This article describes how to locate adapter RAM and ROM addresses in the upper memory area (UMA) by using the Microsoft Diagnostic (MSD) utility and/or excluding memory ranges on the EMM386.EXE line in the CONFIG.SYS file.  MORE INFORMATION  The U...">
<META NAME="Product" CONTENT="MS-DOS">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QBW6,QDMR,QAC2,QAKP,QAB5,QBSO,QDNZ,QDKI,QAHC,QBXT,QA5V,QANE,QAM9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Locating and Excluding RAM/ROM Addresses in the UMA</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112816</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft MS-DOS operating system versions 6.0, 6.2, 6.21, 6.22
<LI>Microsoft Windows operating system versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to locate adapter RAM and ROM addresses in the
upper memory area (UMA) by using the Microsoft Diagnostic (MSD) utility
and/or excluding memory ranges on the EMM386.EXE line in the CONFIG.SYS
file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The UMA, which is between 640K and 1024K, is primarily reserved for RAM and
ROM on hardware devices. The UMA is also used by EMM386.EXE to load device
drivers and terminate-and-stay-resident (TSR) programs into available
addresses in the UMA. Conflicts can result when either of the following
occur:

<UL><LI>Two or more hardware devices are trying to use the same memory
   address in the UMA.
<P>
   -or-

<LI>EMM386.EXE is unable to detect whether an address is in use by a
   hardware device and loads a TSR program or device driver into that
   address.
<P>
</UL>To determine which of the above is causing the problem, edit your
EMM386.EXE line in the CONFIG.SYS file to read as follows:
<P>
<PRE>   device=c:\dos\emm386.exe noems x=a000-f7ff

</PRE>Reboot the computer. If the problem still occurs, it may be caused by
multiple hardware devices using the same memory address. In such cases, you
must consult your hardware documentation or manufacturer for information on
resolving the conflict.
<P>
If the problem does not occur, it is most likely being caused by a conflict
with EMM386.EXE and a hardware device in the UMA. To resolve this type of
conflict, you must identify which upper memory addresses are being used by
hardware and then exclude these addresses using the EMM386.EXE device line
in the CONFIG.SYS file. The Microsoft Diagnostic (MSD) utility can be used
to identify upper memory blocks (UMBs) in use by hardware. To do this:

<OL><P><LI>Reboot the computer and perform a "clean boot" by pressing F5 once
   when the message "Starting MS-DOS..." appears.

<P><LI>Type "msd" (without the quotation marks) at the MS-DOS command prompt,
   and press M to select Memory. Using the legend at the top of the screen,
   locate the area(s) marked as RAM and/or ROM, and make a note of the
   starting and ending addresses of this area(s). This is the area(s) that
   needs to be excluded using the EMM386.EXE device line in the CONFIG.SYS
   file.

<P><LI>Open the CONFIG.SYS file and add the exclusion(s) to the EMM386.EXE line
   (for example, X=C000-C7FF X=D800-DBFF), and restart the computer.
<P>
</OL>If memory conflicts exist after you complete the above procedure, there may
be some adapter RAM and/or ROM addresses that MSD is unable to correctly
detect. Use the following technique to help isolate the conflicting memory
region.

<OL><P><LI>Verify that the problem is being caused by a conflict in the UMA by
   editing the CONFIG.SYS file and specifying the following parameters
   on the EMM386.EXE device line:
<P>
   a. NOEMS
   b. X=A000-F7FF
   c. Remove any other X= or I= parameters
   d. Remove the HIGHSCAN parameter, if present
<P>
   A sample line might read as follows:
<P>
<P><PRE>      device=c:\dos\emm386.exe noems x=a000-f7ff
</PRE>
<P><LI>Save the changes and restart the computer. If the problem goes away,
   continue with the steps below. If the problem still occurs, it is not
   being caused by a conflict in the UMA, and you need to perform other
   troubleshooting to determine the cause of the problem. For more
   information on troubleshooting EMM386.EXE, query on the following words
   in the Microsoft Knowledge Base:
<P>
<P><PRE>      emm386.exe and troubleshooting and notr
</PRE>
<P><LI>If the problem is corrected by using X=A000-F7FF, edit the CONFIG.SYS
   file and shrink the excluded range by changing the parameter to
   X=C000-F7FF. Save the file and restart the computer. If the problem does
   not recur, proceed to the next step.
<P>
   If the problem does recur, the conflict may be in either the A000 or
   B000 range. To verify this, change the X=C000-F7FF parameter to
   X=A000-BFFF and restart the computer. If this corrects the problem, you
   can further narrow the range by changing the parameter to X=A000-AFFF.
   If the problem still exists, try X=B000-BFFF. Once you have narrowed the
   problem down to a specific range (B000-BFFF), you may be able to narrow
   it down to half of the range. To do this, try excluding either the first
   half (X=B000-B7FF) or the second half (X=B800-BFFF) of the range. If
   neither of these work, you must leave the whole range excluded
   (X=B000-BFFF).

<P><LI>If specifying X=C000-F7FF does not cause the problem to recur, open the
   CONFIG.SYS file and shrink the range further to X=D000-F7FF. Restart the
   computer and see if the problem recurs. If not, shrink the range further
   to X=E000-F7FF. Repeat this process until the problem recurs.

<P><LI>When the problem recurs, edit the CONFIG.SYS file to change the first
   number in the range back to what it had been and decrease the second
   number in the range. For example, if X=D000-F7FF worked correctly,
   but X=E000-F7FF did not, change the first number back to D000 and
   decrease the second number, so the range reads X=D000-EFFF. If that
   works, decrease the second number again (X=D000-DFFF). Once you have
   narrowed the problem down to a specific range (for example, D000-DFFF),
   you may be able to narrow it down to half of the range. To do this, try
   excluding either the first half (X=D000-D7FF) or the second half
   (X=D800-DFFF). If neither of these work, you must leave the whole range
   excluded (X=D000-DFFF).
<P>
</OL><h3>Notes</h3>
 

<UL><LI>If you have several hardware devices in your system using upper
   memory addresses, you may need to exclude more than one range. For
   example, you might list X=C000-C7FF X=E000-EFFF on the EMM386.EXE line.

<LI>If may be possible to narrow an exclusion to a smaller portion of a
   range (for example, X=C000-C3FF or X=C400-C7FF or X=C800-CBFF or
   X=CC00-CFFF.)
<P>
</UL>The MSD utility contains a memory map that may be helpful in understanding
how the upper memory ranges are divided and defined. To view the memory
map, type "msd" (without the quotation marks) at an MS-DOS command prompt
and then choose M for Memory.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbtshoot kbtool<BR>
KBSubcategory: msdos wfw wfwg win31<BR>
Additional reference words: 6.22 5.00 6.00 6.20 tshoot troubleshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
