

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Hot Keys in Windows 386 Enhanced Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89494 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1992/09/23">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16ddk">
<META NAME="Description" CONTENT="  Some Windows-based applications implement shortcut ( hot ) keys by establishing a Windows hook that scans the stream of keystrokes typed and responds to the hot key. While this technique works correctly within the Windows system virtual machine in ...">
<META NAME="Product" CONTENT="Win16 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAQT,QDL9,QBWO,QBWN,QBWQ,QACK,QDH9,QBE4,QA63,QADO,QBW9,QAA1,QAB5,QBVV,QA5W V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Hot Keys in Windows 386 Enhanced Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89494 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Device Driver Kit (DDK) for Windows versions 3.0
   3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Some Windows-based applications implement shortcut ("hot") keys by
establishing a Windows hook that scans the stream of keystrokes typed and
responds to the hot key. While this technique works correctly within the
Windows system virtual machine in 386 enhanced mode, the hot key will not
be recognized while an MS-DOS virtual machine (VM) has the focus because
the keystroke will not be visible to the Windows system virtual machine. In
order to define a "global" hot key that is active even while an MS-DOS-
based application is running, a virtual device (VxD) must be written to
perform this task. This article describes the steps for writing such a VxD.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There is a sample VxD called VHOTKEYD in the Software/Data Library that
demonstrates the steps necessary to reflect a hot key into the system
virtual machine. VHOTKEYD sets up a global hot key through the
VKD_Define_Hot_Key service. The hot key handler schedules a system-VM-
specific event that will force the focus to the system VM through the
System_Control service and force the keystroke into the system VM through
the VKD_Reflect_Hot_Key service. Instead of the VKD_Reflect_Hot_Key
service, the VKD_Force_Keys service could be used; however, in that case
the hot key handler must explicitly call VKD_Cancel_Hot_Key_state;
furthermore, the hot key must be defined with the Local_key option and must
be locally disabled for the system VM. The advantage of using
VKD_Force_Keys is that the hot key is inserted into the VM's virtual
keyboard buffer so that keystrokes submitted before the hot key will still
be processed in the VM's context.
<P>
In any case, a switch to the system virtual machine will not take place if
a) the virtual machine being switched away from is in a critical section,
or b) that virtual machine runs exclusively. VHOTKEYD uses the
VKD_Force_Keys technique.
<P>
Download VHOTKEYD.EXE, a self-extracting file, from the Microsoft
Software Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/VHOTKEYD.EXE">VHOTKEYD.EXE</A> <I>(size: 19775 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \softlib\mslfiles directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/VHOTKEYD.EXE">VHOTKEYD.EXE</A> <I>(size: 19775 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10  softlib VHOTKEYD.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: D3DmaVkdhotkey<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
