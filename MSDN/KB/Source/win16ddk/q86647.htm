

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>New Printer Escapes in PostScript Driver Version 3.52 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86647 ">
<META NAME="KBModify" CONTENT="1995/02/16">
<META NAME="KBCreate" CONTENT="1992/07/13">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16ddk">
<META NAME="Description" CONTENT="  Versions 3.52 and later of the PostScript driver for Microsoft Windows 3.1x (PSCRIPT.DRV) implements four new printer escape functions: OPENCHANNEL, DOWNLOADHEADER, CLOSECHANNEL, and SETGDIXFORM. The text below documents these four new printer esca...">
<META NAME="Product" CONTENT="Win16 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QACT,QAOX,QANY,QBVV,QAB5,QAN8,QAMB,QADF,QAUD,QAKD,QDL9,QBWO,QBWN,QBQU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>New Printer Escapes in PostScript Driver Version 3.52</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86647 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Device Development Kit (DDK) for Windows version
   3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Versions 3.52 and later of the PostScript driver for Microsoft Windows 3.1x
(PSCRIPT.DRV) implements four new printer escape functions: OPENCHANNEL,
DOWNLOADHEADER, CLOSECHANNEL, and SETGDIXFORM. The text below documents
these four new printer escape functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The numerical values for the four new printer escape functions are as
follows:
<P>
<PRE>   #define OPENCHANNEL      4110
   #define DOWNLOADHEADER   4111
   #define CLOSECHANNEL     4112
   #define SETGDIXFORM      4113

</PRE><h3>OPENCHANNEL</h3>
 
<P>
An application can use the OPENCHANNEL printer escape in conjunction
with the PASSTHROUGH printer escape to send data directly to the
printer. The OPENCHANNEL printer escape prevents the PostScript driver
from downloading a PostScript header to the printer.
<P>
Note: To use this printer escape, an application must have complete
information about how the particular printer operates.
<P>
<PRE>   short Escape(hdc, OPENCHANNEL, sizeof(WORD), NULL, NULL)

   Parameter    Description
   ---------    -----------

   hdc          HDC identifies the device context.

</PRE>Returns: Greater than zero if the printer escape is successful. This
<PRE>         value is less than or equal to zero if the printer escape is
         not successful or not implemented.

</PRE>Comments: Send an OPENCHANNEL printer escape before sending any data
<PRE>          to the printer. The OPENCHANNEL printer escape is an
          alternative to the STARTDOC printer escape; each print job
          uses either one, not both.

          OPENCHANNEL suppresses downloading a PostScript header.
          Because the NEWFRAME printer escape and the ResetDC function
          cause the driver to download a PostScript header, avoid
          using NEWFRAME and ResetDC in conjunction with OPENCHANNEL.

</PRE><h3>DOWNLOADHEADER</h3>
 
<P>
An application uses the DOWNLOADHEADER printer escape to download one
of four PostScript headers to the printer. The lpInData parameter
contains a pointer to a WORD value that specifies the desired header.
<P>
<PRE>   BOOL Escape(hdc, DOWNLOADHEADER, sizeof(WORD), lpInData, NULL)

   Parameter    Description
   ---------    -----------

   hdc          HDC identifies the device context.

   lpInData     LPINT Pointer to a WORD value.

</PRE>Returns: TRUE if the printer escape is successful. FALSE if the printer
<PRE>         escape is not successful or not implemented.

</PRE>Comments: If lpInData == NULL, or if lpInData points to a WORD that
<PRE>          contains a value other than one of the four choices listed
          below, the DOWNLOADHEADER printer escape will select a
          header depending on the current state of the DEVMODE data
          structure and the printer escapes previously issued by the
          application.

          This printer escape sends the selected header between the
          DSC comments %%BeginResource and %%EndResource.

</PRE>The lpInData parameter points to a WORD that contains one of the
following four values:
<P>
<PRE>   #define PS_HEADER   1  // Full header (normal PostScript header)

   #define PS_1        4  // Assume header has been permanently
                          // downloaded to the printer. Prints error
                          // page if not.

   #define PS_2        8  // Minimal PostScript header

   #define TI_HEADER  13  // TrueImage header

</PRE><h3>CLOSECHANNEL</h3>
 
<P>
The CLOSECHANNEL printer escape closes the printer channel opened by
the OPENCHANNEL printer escape.
<P>
<PRE>   short Escape(hdc, CLOSECHANNEL, sizeof(WORD), NULL, NULL)

   Parameter    Description
   ---------    -----------

   hdc          HDC Identifies the device context.

</PRE>Returns: Greater than zero if the printer escape is successful. This
<PRE>         value is less than or equal to zero if the printer escape is
         not successful or not implemented.

</PRE><h3>SETGDIXFORM</h3>
 
<P>
The SETGDIXFORM printer escape sends an /SM command to the printer to
transform the printer coordinates to the default GDI coordinate
system.
<P>
<PRE>   short Escape(hdc, SETGDIXFORM, sizeof(WORD), NULL, NULL)

   Parameter    Description
   ---------    -----------

   hdc          HDC identifies the device context.

</PRE>Returns: Greater than zero if the printer escape is successful. This
<PRE>         value is less than or equal to zero if the printer escape is
         not successful or not implemented.

</PRE>Comments: The SETGDIXFORM printer escape sets the printer to "Portrait
<PRE>          Mode without Mirroring" mode regardless of the settings in
          the Advanced Options dialog box.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: D2PrnPscript<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
