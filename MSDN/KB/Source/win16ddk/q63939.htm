

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: How GETSCALINGFACTOR Affects a Clipping Region </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q63939 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1990/07/17">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16ddk">
<META NAME="Description" CONTENT="  In the Microsoft Windows graphical environment, printer drivers that can create graphics in finer resolutions than text support the GETSCALINGFACTOR printer escape. For example, the HP LaserJet printer with the HPPCL driver can create graphics at 3...">
<META NAME="Product" CONTENT="Win16 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QABO,QACT,QAJQ,QAOX,QAB5,QAIW,QATX,QAMB,QAGB,QADF,QBXS,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: How GETSCALINGFACTOR Affects a Clipping Region</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q63939 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Device Driver Kit (DDK) for Windows versions 3.0
   and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the Microsoft Windows graphical environment, printer drivers that
can create graphics in finer resolutions than text support the
GETSCALINGFACTOR printer escape. For example, the HP LaserJet printer
with the HPPCL driver can create graphics at 300, 150, and 75 dots per
inch (dpi). Because text on this printer is always printed in 300 dpi,
the printer driver responds to this printer escape to inform the
caller of the scaling factors from the text resolution to the current
graphics resolution, for both the X and Y axes. If the user sets the
graphics resolution of an HPPCL printer to 150 dpi through the Control
Panel, the driver returns the values (1, 1) for this escape (exponent
of 2). If the graphics resolution is 75 dpi, the scaling factors are
(2, 2). The same logic holds for 300 dpi; the scaling factors are (0,
0). The X and Y factors are always the same on HPPCL because this
printer always has the same resolutions on the X and Y axes. On
another printer device, the two factors may differ from each other.
<P>
The scaling factors are typically used to set clipping regions on this
type of printer device. Because the graphics device interface (GDI)
sets a clipping region only at the text resolution, it is the
application's responsibility to adjust the region's coordinates before
passing them to the call that creates the region. For example, suppose
an application creates a rectangular clipping region on an HPPCL
printer. The coordinates (X1, Y1) specify the upper-left corner and
(X2, Y2) the lower-right corner, all in device units. Before passing
these parameters to the CreateRectRgn() function, the application must
send the GETSCALINGFACTOR printer escape to obtain the current scaling
factors. If the current graphics resolution is 150 dpi, the scaling
factors should be (1, 1). The application would adjust the coordinates
to (X1 &gt;&gt; 1, Y1 &gt;&gt; 1) and (X2 &gt;&gt; 1, Y2 &gt;&gt; 1), which is equivalent to
dividing each by 2. After Windows creates the region, calling the
SelectClipRgn() function selects the region into the device context as
the clipping region.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The GETSCALINGFACTOR printer escape is documented in Chapter 5 of the
Microsoft Windows Software Development Kit (SDK) "Programmer's
Reference, Volume 3: Messages, Structures, and Macros" manual for
version 3.1, and in Chapter 11 of the Microsoft Windows Device Driver
Kit (DDK) "Device Driver Adaptation Guide."
<P>
HPCLIP is a file in the Microsoft Software Library that demonstrates using
a scaling factor to set a clipping region on a printer device that
supports a lower graphics resolution than text resolution.
<P>
Download HPCLIP.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/HPCLIP.EXE">HPCLIP.EXE</A> <I>(size: 18915 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \softlib\mslfiles directory
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/HPCLIP.EXE">HPCLIP.EXE</A> <I>(size: 18915 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 DDKPRINT softlib HPCLIP.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: GdiPrnMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
