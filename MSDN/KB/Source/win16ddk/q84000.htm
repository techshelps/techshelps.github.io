

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Obtaining a Virtual Device (VxD) ID Number </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84000 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1992/04/27">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16ddk">
<META NAME="Description" CONTENT="  The DECLARE_VIRTUAL_DEVICE line of every virtual device (VxD) used in the Microsoft Windows graphical environment contains a VxD identifier (ID) field. This field contains either the unique number assigned to that virtual device or the constant Und...">
<META NAME="Product" CONTENT="Win16 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAB5,QA4H,QAKC,QAGI,QBC6,QBWQ,QAG8,QAHC,QADN,QDH9,QAR5,QAYC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Obtaining a Virtual Device (VxD) ID Number</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84000 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Device Driver Kit (DDK) for Windows versions 3.0
   and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The DECLARE_VIRTUAL_DEVICE line of every virtual device (VxD) used in the
Microsoft Windows graphical environment contains a VxD identifier (ID)
field. This field contains either the unique number assigned to that
virtual device or the constant Undefined_Device_ID.
<P>
While most virtual devices can use the Undefined_Device_ID, certain virtual
devices must a have unique identifier. A VxD that calls an MS-DOS device or
a terminate-and-stay-resident (TSR) program must have an ID. An ID is also
required for a VxD that provides any of the following:

<UL><LI>A service or services
<LI>A V86-mode application programming interface (API)
<LI>A protected-mode API
<P>
</UL>Windows does not prevent a VxD that uses the Undefined_Device_ID from
loading more than once in a given Windows session. As Windows loads, it
retrieves a list of all virtual devices to load by sending the Interrupt
2Fh Function 1605h broadcast and checking the SYSTEM.INI file. If a VxD is
specified more than once and it uses the Undefined_Device_ID, it is loaded
multiple times. However, if the VxD has its own unique ID, Windows
recognizes the situation, informs the user, and aborts the loading process
(unless the VxD contains code to address this situation and allow Windows
to continue).
<P>
Microsoft uses the V*D.386 naming convention for the VxDs provided with
Windows where the "*" names the device virtualized by the VxD. Other VxD
vendors should use a different naming convention; preferably one that
incorporates the company name. The resulting name should be as mnemonic as
possible.
<P>
To obtain a unique VxD ID, complete the form below and return it to
Microsoft through electronic mail. Send completed forms to:
<P>
<PRE>   vxdid@microsoft.com

</PRE>This address is valid for any electronic mail service with Internet access.
<P>
Some systems require an address prefix to connect to Internet. For example,
electronic mail on the CompuServe system should be addressed as follows:
<P>
<PRE>   &gt;INTERNET:vxdid@microsoft.com

</PRE>You may also use a Service Request (SR) to obtain a VxD ID, but be aware
that your service contract will be decremented for an instance, even if you
are only using the SR to obtain a unique VxD ID.
<P>
NOTE: Microsoft no longer accepts FAXED or Postal-Mailed ID requests.
<P>
NOTE: The method of using OEM numbers documented on page 17-5 of the
"Microsoft Windows Device Development Kit Virtual Device Adaptation Guide"
manual for version 3.0 of the Microsoft Windows Device Development Kit
(DDK) is no longer correct. VxD ID numbers are assigned on a per-VxD basis.
Microsoft will assign a unique number for each VxD you write; OEM ID
numbers, which can be used for up to 32 VxDs, are not assigned.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Virtual Device ID Request</h3>
 
<P>
Contact Name(s):
Phone Number(s):
CompuServe ID or Microsoft Support Advantage Account Number(s):
Internet Electronic Mail Address:
<P>
<PRE>   Company Name:
        Address:
        Address:
 City/State/Zip:
        Country:

</PRE>Number of VxDs planned:
<P>
Provide the following information for each virtual device planned:
<P>
<PRE>VxD Filename: ________.386      Virtual __________ Device

</PRE>Will this VxD be loaded from TSR? (Yes/No):
Will this VxD call out to an MS-DOS TSR/device driver through the
"Interrupt 2Fh call out" (Interrupt 2Fh, Function 1607h)? (Yes/No):
<P>
Estimate the number of
<PRE>   Virtual-8086 (V86) functions exported:
   PM functions exported:
   VxD Services:

</PRE>If this VxD replaces a "standard" VxD, which one does it replace:
<P>
Summarize the purpose of this VxD:
<P>
Summarize the technical attributes of this VxD (interrupts hooked, I/O
ports trapped, and so forth):
<P>
In what way or with what products will this VxD be distributed?
<P>
Will the functions or services of this VxD be documented for others to
call?
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 DDKVXD<BR>
KBCategory: kbprg<BR>
KBSubcategory: D3MiscCoding<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
