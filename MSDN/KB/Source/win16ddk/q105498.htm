

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Custom Page Sizes for PostScript Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105498">
<META NAME="KBModify" CONTENT="1995/03/16">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; win16ddk">
<META NAME="Description" CONTENT="  Custom page sizes can be added to the PostScript driver by updating the source code for the driver contained in the Windows 3.1 DDK. The MKPRN utility included in the DDK must also be updated. This information is specific to versions 3.5 through 3....">
<META NAME="Product" CONTENT="Win16 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QANY,QAU9,QA4H,QAN8,QACT,QADF,QBWQ,QBCF,QBWA,QADX,QAKC,QBXN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Adding Custom Page Sizes for PostScript Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105498</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to

<UL><LI>Microsoft Windows Device Driver Kit (DDK) for Windows, version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Custom page sizes can be added to the PostScript driver by updating the
source code for the driver contained in the Windows 3.1 DDK. The MKPRN
utility included in the DDK must also be updated. This information is
specific to versions 3.5 through 3.58 of the PostScript driver.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To make the PostScript driver aware of the custom page size, the
following changes must be made:

<UL><LI>PSCRIPT.RC: The new page size ID and name need to be added to the
   STRINGTABLE.

<LI>PAPERSIZ.RC: The ID and page size need to be added to the end of the
   PAPERSIZES table, immediately before the NULL entry.

<LI>RESOURCE.H: The ID needs to be defined. It must be a value greater
   than 256, even though the other paper sizes IDs are much smaller.
   This is because COMMDLG.DLL will not recognize a user defined size
   if it's ID is less than 256.

<LI>PRINTERS.H: The "#define DMPAPER_USER_LAST" statement needs to be
   changed to define DMPAPER_USER_LAST to the new paper size ID.
<P>
</UL>The MKPRN utility included with the Windows 3.1 DDK compiles
Adobe-standard PostScript Printer Description files (.PPD files)
to create Windows Printer Description files (.WPD files).
<P>
The following changes need to be made to MKPRN to add a custom
size:

<UL><LI>MKPRN.C:
<P>
   The paper size name and ID need to be added to the paper_table[]
   array.
<P>
<P><PRE>     The size of the array needs to be changed. It is originally
     defined as PaperSizes[DMPAPER_USER_LAST+1]. This needs to
     be incremented by one; however, since the definition of
     DMPAPER_USER_LAST also changes in this process (changed in
     PRINTERS.H), DMPAPER_USER_LAST should not be used.  This
     number can be filled in directly, by counting the total
     number of paper sizes (including the new one) and adding
     one.  Or, DMPAPER_USER+2 can be used.
</PRE><P>
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10<BR>
KBCategory: kbtool<BR>
KBSubcategory: DtwoPrnPscript<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
