

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the AdvancedSetUpDialog() Configuration Call </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90563 ">
<META NAME="KBModify" CONTENT="1995/04/12">
<META NAME="KBCreate" CONTENT="1992/10/19">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16ddk">
<META NAME="Description" CONTENT="  Windows printer drivers are expected to export the ExtDeviceMode() function, which displays a configuration dialog box for the printer. This dialog box generally prompts the user for characteristics of the printout, such as orientation, paper size,...">
<META NAME="Product" CONTENT="Win16 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QAGI,QAOX,QANX,QDIZ,QANE,QDL9,QBWO,QBWN,QAY5,QADF,QAK3,QAB9,QAM4,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using the AdvancedSetUpDialog() Configuration Call</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 12, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90563 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Device Development Kit (DDK) for Windows version
   3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows printer drivers are expected to export the ExtDeviceMode()
function, which displays a configuration dialog box for the printer. This
dialog box generally prompts the user for characteristics of the printout,
such as orientation, paper size, and paper source. This box is displayed
whenever an application or DLL calls into the ExtDeviceMode() function; for
example, when the Configure button in the printer control panel application
is clicked.
<P>
However, with the introduction of the common dialog box DLL, this top-level
configuration dialog box has been generalized and is now being provided by
the print common dialog box. Thus, those applications that configure the
printer via the common print dialog box will raise a different top-level
configuration dialog box than those applications that call ExtDeviceMode()
directly for this purpose.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To still allow the user to configure driver-specific characteristics,
Windows version 3.1 printer drivers can export the AdvancedSetUpDialog()
procedure that, when invoked, raises another dialog box to prompt the user
for additional print configuration information. If the common print dialog
box detects the presence of this function in the driver, it activates a
button labeled Options that, when clicked, calls the AdvancedSetUpDialog()
function. The dialog box that is raised upon invocation of the
ExtDeviceMode() function, however, frequently has the same Options button
that, in turn, calls AdvancedSetUpDialog().
<P>
This approach bears the problem that a printer driver may want to know
whether the AdvancedSetUpDialog() function has been called from the Options
button of the common print dialog box or the top-level ExtDeviceMode()
configuration dialog box. For example, if the printer driver offers a
feature that is included in the ExtDeviceMode() dialog box, then this
feature should also be available in the AdvancedSetUpDialog() box in case
the top-level configuration box has been bypassed by the common print
dialog box; however, IF the advanced dialog box has been selected through
the ExtDeviceMode() dialog box, the feature should not be available in the
advanced dialog box to avoid redundancy.
<P>
To work around this problem, the dialog box procedure for the top-level
dialog box procedure should set a global flag that the advanced dialog box
can test upon to determine whether it has been called from the driver's top-
level configuration dialog box. In addition, the first parameter passed to
AdvancedSetUpDialog()--the window handle that serves as the parent for the
dialog box--can be used to determine where the AdvancedSetUpDialog()
function was called from.
<P>
Microsoft recommends that applications use the common print dialog box
wherever possible when setting up a printer, and that printer drivers do
not duplicate functionality in the AdvancedSetUpDialog() and
ExtDeviceMode() dialog boxes to prompt the user for printer-specific
characteristics.
<P>
<P><h2>REFERENCE</h2>
 
<P>
The AdvancedSetUpDialog() function is documented on pages 134-135 in the
Microsoft Windows version 3.1 "Device Driver Adaptation Guide."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: CmdlgPrtGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 12, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
