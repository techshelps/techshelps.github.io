

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Accessing CREATE_DB, REPAIR_DB, and COMPACT_DB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126606">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/02/27">
<META NAME="Keywords" CONTENT="kbcode kbprg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  The help file for the ODBC version 2.0 Desktop Drivers mentions that the Microsoft Access driver will accept the keywords CREATE_DB, REPAIR_DB, and COMPACT_DB on the lpszAttributes parameter, but gives no details on their syntax.  MORE INFORMATION ...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAQ,QDKY,QBPM,QAUJ,QBW7,QAI5,QA1S,QBFY,QAFI,QAJQ,QBWG,QA9E,QAI4,QAGI,QAK6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Accessing CREATE_DB, REPAIR_DB, and COMPACT_DB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126606</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The help file for the ODBC version 2.0 Desktop Drivers mentions that the
Microsoft Access driver will accept the keywords CREATE_DB, REPAIR_DB, and
COMPACT_DB on the lpszAttributes parameter, but gives no details on their
syntax.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SQLConfigDataSource lpszAttributes keywords CREATE_DB, REPAIR_DB, and
COMPACT_DB cannot be used in conjunction with other keywords. If you want
your programs to create a datasource and also create a new .MDB file for
that datasource, you must do this in a two stage process. You must create
the datasource on one call to SQLConfigDataSource, and create the new .MDB
file on a separate call to SQLConfigDataSource.
<P>
The syntax for these keywords are:
<P>
<PRE>   CREATE_DB=&lt;path name&gt; &lt;sort order&gt;
   REPAIR_DB=&lt;path name&gt;
   COMPACT_DB=&lt;source path&gt; &lt;destination path&gt; &lt;sort order&gt;

</PRE>where &lt;path name&gt; is the fully qualified path name to the .MDB file to be
created or repaired. &lt;source path&gt; is the fully qualified path name to the
.MDB file to be compacted. &lt;destination path&gt; is the fully qualified path
name of the file after it has been compacted. &lt;sort order&gt; is one of the
following keywords:
<P>
<PRE>   General, Traditional Spanish, Dutch, Swedish/Finnish,
   Norwegian/Danish, Icelandic, Czech, Hungarian, Polish,
   Russian, Turkish, Arabic, Hebrew, Greek

</PRE>NOTE: The General sort order covers English, French, German,
Portuguese, and Italian.
<P>
With CREATE_DB, the file named in &lt;path name&gt; must not exist at the time
SQLCOnfigDataSource is called.
<P>
With REPAIR_DB, the file named in &lt;path name&gt; must be a valid .MDB file.
<P>
With COMPACT_DB, the file named in &lt;source path&gt; must be a valid .MDB file.
&lt;destination path&gt; can point to the same file as &lt;source path&gt;, in which
case the file will be compacted into the same location. If &lt;destination
path&gt; names a different file than &lt;source path&gt;, the file named as the
&lt;destination path&gt; must not exist at the time SQLConfigDataSource is
called.
<P>
For example, the following code segment would create a .MDB file, repair
it, compress it to a second file, compress it in the same location, and
then create a datasource for it.
<P>
<PRE>   void Config_Sample(void)
   {
             RETCODE retcode;
             int     subscrp;
     extern  HWND    hWnd;      /* Main window handle. */

     UCHAR szDriver[] = "Microsoft Access Driver (*.mdb)";
     UCHAR *szAttributes2[] =
     // Create the original .mdb file.
     {"CREATE_DB=c:\\odbcsdk\\smpldata\\access\\general.mdb General\0\0",

     // Issue a REPAIR_DB on the created file.
     "REPAIR_DB=c:\\odbcsdk\\smpldata\\access\\general.mdb\0\0",

     // Compact the file into a new location.
     "COMPACT_DB=c:\\odbcsdk\\smpldata\\access\\general.mdb "
       "c:\\odbcsdk\\smpldata\\access\\general2.mdb General\0\0",

     // Compact the file onto itself.
     "COMPACT_DB=c:\\odbcsdk\\smpldata\\access\\general.mdb "
       "c:\\odbcsdk\\smpldata\\access\\general.mdb General\0\0",

     // Create a datasource for the first .mdb file created.
     "DSN=albacc\0FIL=MS Access\0JetIniPath=odbcddp.ini\0"
     "DBQ=c:\\odbcsdk\\smpldata\\access\\general.mdb\0"
     "DefaultDir=c:\\odbcsdk\\smpldata\\access\0\0"};

     for (subscrp = 0;
          subscrp &lt;= ((sizeof szAttributes2 / sizeof(UCHAR *)) - 1);
           subscrp++)
     {
       retcode = SQLConfigDataSource(hWnd,
                                     ODBC_ADD_DSN,
                                     szDriver,
                                     szAttributes2[subscrp]);
       if (retcode != TRUE)
         handle_error(retcode);
     }
     return;
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.00.2317 Windows NT SQLConfigDataSource desktop<BR>
driver access<BR>
Keywords            : kbcode kbprg kbusage<BR>
Version             : 2.00.2317<BR>
Platform            : WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
