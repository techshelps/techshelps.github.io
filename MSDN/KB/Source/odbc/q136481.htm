

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Running ODBC Applications as Windows NT Services </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136481">
<META NAME="KBModify" CONTENT="1997/10/14">
<META NAME="KBCreate" CONTENT="1995/09/10">
<META NAME="Keywords" CONTENT="odbc kbenv kberrmsg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  ODBC applications running as Windows NT services may encounter the following error when attempting to connect to an ODBC data source:     szSqlState =  IM002     pfNativeError = 0    szErrorMsg =  [Microsoft][ODBC Driver Manager] Data source name  ...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QA9E,QBWS,QACK,QAK6,QAA1,QBVV,QABM,QAJ4,QDI2,QAI5,QAYY,QAO0,QAJH,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Running ODBC Applications as Windows NT Services</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136481</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50
WINDOWS
kbenv kberrmsg kbfile kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
ODBC applications running as Windows NT services may encounter the
following error when attempting to connect to an ODBC data source:
<P>
<PRE>   szSqlState = "IM002"
   pfNativeError = 0
   szErrorMsg = "[Microsoft][ODBC Driver Manager] Data source name
                 not found and no default driver specified"

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When a standard ODBC data source is defined, it is specific to the Windows
NT account under which the ODBC Administrator process is running. This is
because the data source definition is stored in the HKEY_CURRENT_USER hive
in the Windows NT registry. Applications running in environments which do
not have that specific user's hive set up as HKEY_CURRENT_USER will not
have access to that data source.
<P>
Applications running as Windows NT services can be made to run under a
Windows NT account using the control panel, but may be running at times
when that user's hive is not the one set up as HKEY_CURRENT_USER. For
example, if the NT account is not logged on, their hive will not be set as
HKEY_CURRENT_USER, and the NT service will not be able to access the ODBC
data source. This also applies to DLLs running as SQL Server version 6.0
Extended Stored Procedures because they run as part of the SQL Server
process, which always runs as a Windows NT service. This same problem also
affects applications running under the Windows NT Scheduler service, which
covers applications started with the Windows NT AT command.
<P>
Microsoft ODBC version 2.5 addresses this problem by introducing the
concept of a system data source. The definitions of system data sources are
stored in the registry HKEY_LOCAL_MACHINE hive under SOFTWARE/ODBC/ODBC.INI
where they will always be accessible to Windows NT services.
<P>
ODBC 2.5 started shipping with Microsoft SQL Server version 6.0 and
Microosft Office 95, and will ship with future releases of other ODBC-
capable products.
<P>
Users who do not already have an ODBC 2.5 driver installed can obtain the
ODBC 2.5 ODBC Administrator and Driver Manager by downloading the file
ODBC25.EXE from the Microsoft Software Library (MSL).
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/ODBC25.EXE">ODBC25.EXE</A> <I>(size: 456616 bytes)</I> 
                       , a self-extracting file, on the following services:

</PRE><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select ODBC.
<PRE></PRE>      Enter kbfile <A HREF="http://support.microsoft.com/download/support/mslfiles/ODBC25.EXE">ODBC25.EXE</A> <I>(size: 456616 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com.
      Change to the Softlib/Mslfiles folder.
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/ODBC25.EXE.">ODBC25.EXE.</A> <I>(size: 456616 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location.
      Type "mssupport" (without the quotation marks).
      Double-click the MS Software Library icon.
      Find the ODBC product area.
      Locate and download ODBC25.EXE.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL.
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/ODBC25.EXE.">ODBC25.EXE.</A> <I>(size: 456616 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>The file ODBC25.EXE also includes documentation on the new features in ODBC
2.5, such as the system data sources.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.50 drivers msnSQL<BR>
KBCategory: kbenv kbfile kberrmsg<BR>
KBSubcategory: odbc<BR>
Keywords          : odbc kbenv kberrmsg kbfile<BR>
Version           : 2.50<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
