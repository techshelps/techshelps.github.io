

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Cursor Library Returns Duplicate Row in Asynchronous Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124897">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1995/01/16">
<META NAME="Keywords" CONTENT="kbbug2.00.1510 kbprg">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  When the ODBC Cursor Library is used to set up a static cursor with a driver whose asynchronous mode is enabled, it returns duplicate rows under certain circumstances. These duplicate rows are returned every time an asynchronous operation with the ...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QA9E,QBHQ,QAUD,QAFO,QA5V,QAU9,QAR4,QA5W,QAY5,QAM1,QDKW,QALW,QAKJ,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Cursor Library Returns Duplicate Row in Asynchronous Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124897</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the ODBC Cursor Library is used to set up a static cursor with a
driver whose asynchronous mode is enabled, it returns duplicate rows
under certain circumstances. These duplicate rows are returned every time
an asynchronous operation with the driver returns SQL_STILL_EXECUTING. The
number of duplicate rows retrieved on subsequent fetches (MoveNext's in
MFC) is variable. Certain conditions can cause as many as 500 consecutive
repetitions of the same record.
<P>
This behavior has typically been observed in MFC applications using the
ODBC database classes to build snapshots (which cause the ODBC Cursor
Library's static cursor implementation to be used).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Users of MFC database classes can avert this behavior by:

<OL><P><LI>Setting synchronous mode on by calling the SetSynchronousMode() method
    of CDatabase

<P><LI>Using forwardOnly recordsets
<P>
</OL>Users of the ODBC API and the Cursor Library can work around the behavior
by:

<OL><P><LI>Calling SQLSetStmtOption (hstmt, SQL_ASYNC_ENABLE,
    SQL_ASYNC_ENABLE_OFF).

<P><LI>Using forward-only cursors in the Cursor Library.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in ODBC Cursor Library version
2.00.1510. This problem has been fixed in the 32-bit version of the ODBC
2.5 Cursor Library (ODBCCR32.DLL, 2.50.3006). The 16-bit cursor library has
not been changed. If you are using the 16 bit SQL Server driver, this
should not be a problem because you can use the server side cursors in SQL
Server version 6.0 and eliminate the need for the cursor library. If you
are using the Access driver, you need to use the 32-bit driver and the new
32-bit cursor library.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can get ODBC 2.50 components from:

<UL><LI>anonymous-FTP: FTP.MICROSOFT.COM:\BUSSYS\SQL_ODBC\ODBC-PUBLIC\ODBC25.EXE
<LI>The Microsoft Developer Network (MSDN) Level II CD: ODBC210B\X86\ODBC25
<P>
</UL>They are also available on the SQL Server version 6.0 CD, under
ODBC_SDK\ODBC25\REDIST.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00.1510 MFC VISUAL C++ MSVC Windows NT<BR>
KBCategory: kbprg<BR>
KBSubcategory:
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
