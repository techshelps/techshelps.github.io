

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: How to Use SQLInstallDriver API with a 32-Bit Installer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158615">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1996/11/01">
<META NAME="Keywords" CONTENT="SSrvProg kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  If you want an application to obtain Windows 95 logo compliance, you should not use SQLInstallODBC to install ODBC components. Instead, use the SQLInstallDriverManager, SQLInstallDriver, SQLConfigDriver (if necessary) and SQLInstallTranslator (if n...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAU9,QA9E,QAA1,QDI2,QDNN,QAUD,QA3A,QDIZ,QABI,QAWP,QA1S,QAH4,QA0K,QABM,QDJ3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Use SQLInstallDriver API with a 32-Bit Installer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158615</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity SDK version 2.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you want an application to obtain Windows 95 logo compliance, you should
not use SQLInstallODBC to install ODBC components. Instead, use the
SQLInstallDriverManager, SQLInstallDriver, SQLConfigDriver (if necessary)
and SQLInstallTranslator (if necessary), as described in the Readme25.txt
file that comes with the installation of the "ODBC Desktop Driver Pack
3.0." This file can be found in the Windows\System directory. The APIs
listed below make appropriate configurations in the registry; they do not
copy the files to the destination directory. It is the task of the
installation program to copy the installation files to the target
directory.
<P>
The following is a list of the Installer APIs that can be used by an
installation program:

<UL><LI>Use SQLInstallDriverManager to install the driver manager components.

<LI>Use SQLInstallDriver to install the driver.

<LI>Use SQLConfigDriver to optionally configure the driver after it has
   been installed by SQLInstallDriver.

<LI>Use SQLInstallTranslator to configure translators, if they are used by
   the drivers.
<P>
</UL>The advantage of using the above APIs in the 32-bit installation programs
for ODBC drivers is that they will make the transition to install under
ODBC 3.0 easier.
<P>
This article illustrates the usage of the SQLInstallDriver API with the
help of a C program. The documentation of the SQLInstallDriver can be found
in the "ODBC 2.0 Programmer's reference and SDK guide".
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following is the C program that illustrates the usage of the
SQLInstallDriver API:
<P>
<PRE>/*
</PRE>INSTDRV.C:
This program demonstrates usage of SQLInstallDriver for configuring 32-bit
drivers. To configure the driver, this program uses the Odbc.inf file in
one case, and uses just the driver attributes in another case. Note that
usage of driver attributes will be more portable than using Odbc.inf files
in the long run.
<P>
<PRE>*/
#include "windows.h"
#include "sql.h"              //for typedefs in ODBC and API declarations
#include "sqlext.h"
#include "odbcinst.h"         //installer declares
#include "iostream.h"

//check error message for installer functions
void check_error(BOOL rc, char *func, char *mesg)
</PRE>{
<PRE>     if (rc == TRUE )
    {
       MessageBox(GetActiveWindow(), mesg, func, MB_OK);
    }
    else

       MessageBox(GetActiveWindow(), "Failed", func, MB_OK);
</PRE>}
<PRE>//configures driver and returns the output path to copy the driver files.
//if it fails returns NULL.
//parameter inf is used to determine whether we are using INF file are not.

</PRE>BOOL configure_driver_inf (BOOL inf, char *szPathInf, char *szDriver, char
*szPathOut, int size_path)
{
<P>
<PRE>   char szInf[256];
   char szDrv[256];
   unsigned short cbPathOut; //total num. of bytes returned in szTargetDir
   BOOL rc;
//make sure that the size of output path buffer is at least _MAX_PATH bytes
   if ( size_path  &lt; _MAX_PATH )
   {
      cout &lt;&lt; "error: size of the output buffer  is less than _MAX_PATH ";
      return -1;
   }

    if (inf )
   {

         rc = SQLInstallDriver(szPathInf, szDriver,szPathOut, size_path,
</PRE>&amp;cbPathOut);
<PRE>         return rc;

   }

   else
   {

         rc = SQLInstallDriver(NULL, szDriver,szPathOut,size_path,
</PRE>&amp;cbPathOut);
<PRE>         return rc;

   }

}

int main (int argc ,char * argv[] )
</PRE>{
<P>
<PRE> //driver attributes for SQL Server Driver
  char szDriver2[256] = "SQL
</PRE>Server\0Driver=SQLSRV32.DLL\0SETUP=SQLSRV32.DLL\0\0";
<PRE> //configure Microsoft Access driver using Odbc.inf
  char szDriver[256] = "Microsoft Access Driver (*.mdb)";
  char szInf[256] = "d:\\dev\\vc\\instdrv\\odbc.inf";
  char  szPath[_MAX_PATH] = "\0";  //target directory will be returned here
  unsigned short  cbPathOut; //total num. of bytes returned in szTargetDir
  BOOL rc;

//configure using the Odbc.inf file. Make sure to specify the driver name
//correctly as specified in the Odbc.inf
             rc = configure_driver_inf  ( TRUE, szInf,szDriver, szPath,
</PRE>sizeof(szPath));
<PRE>   if (rc == TRUE )
   {
      MessageBox(GetActiveWindow(),szPath, "Install Driver", MB_OK);

   }

   else
   {
</PRE>MessageBox(GetActiveWindow(), "Install Driver Error\n Check the input
parameters and try again", "Install Driver", MB_ICONSTOP|MB_OK);
<PRE>      return 1;
   }
 /*
 Configure without using the Odbc.inf file. Specify the attributes of the
</PRE>driver. The example just uses the DRIVER and SETUP attributes for SQL
Server Driver. Other attributes can also be included with a driver.
Normally the attributes of a driver can be found by looking up the registry
key under HKEY_LOCAL_MACHINE\Software\Odbc\Odbcinst.ini\&lt;driver-name&gt;.
<PRE>*/
     //This option  going to be portable in the long run.
   rc = configure_driver_inf  ( FALSE, NULL,szDriver2, szPath,
</PRE>sizeof(szPath));
<P>
<PRE>   if (rc == TRUE )
   {
      MessageBox(GetActiveWindow(),szPath, "Install Driver", MB_OK);

   }
   else
   {
</PRE>MessageBox(GetActiveWindow(), "Install Driver Error\n Check the input
parameters and try again", "Install Driver", MB_ICONSTOP|MB_OK);
<PRE>      return 1;
   }

 return 0;
</PRE>}
<P>
<PRE>//sample Odbc.inf used for SQLInstallDriver
</PRE>[Source Media Descriptions]
"1", "ODBC Drivers Setup", "odbc32.dll", "."
<P>
[ODBC Drivers]
"Microsoft Text Driver (*.txt; *.csv)"=
"Microsoft Paradox Driver (*.db )"=
"Microsoft Excel Driver (*.xls)"=
"Microsoft dBase Driver (*.dbf)"=
"Microsoft FoxPro Driver (*.dbf)"=
"Microsoft Access Driver (*.mdb)"=
"SQL Server"=
"Oracle"=
<P>
[ODBC]
"Main"=1,odbccp32.dll,,,,1995-5-10,,,,,,,,,,88064,,,,2.50.30.6 ,
"CtlPnl"=1,odbccp32.cpl,,,,1995-5-10,,,,,,,,,,6656,,,,2.50.30.6 ,
"Help"=1,odbcinst.hlp,,,,1994-03-10,,,,,,,,,,17412,,,,02.00.15.10,
"WinSysNT01"=1,ctl3dnt.dll,,,,1995-4-
4,,,,,,ctl3d32.dll,,,SHARED,27136,,,,02.29.00.00,
"WinSys9501"=1,ctl3d95.dll,,,,1995-4-
4,,,,,,ctl3d32.dll,,,SHARED,26112,,,,02.29.00.00,
;"Msvcrt20"=1,msvcrt20.dll,,,,1994-12-
07,,,,,,,,,SHARED,243200,,,,.02.10.00.00,
<P>
[Generic Thunk ODBC Driver Manager]
"Thunk1"=1,odbc32gt.dll,,,,1995-3-3,,,,,,,,,,7168,,,,,
"Thunk2"=1,odbc16gt.dll,,,,1995-3-3,,,,,,,,,,23440,,,,,
<P>
[Generic Thunk ODBC]
"Thunk1"=1,ds32gt.dll,,,,1995-3-3,,,,,,,,,,4608,,,,,
"Thunk2"=1,ds16gt.dll,,,,1995-3-3,,,,,,,,,,5024,,,,2.10.23.23,
<P>
[Microsoft Access Driver (*.mdb)]
"Msvcrt10" = 1, msvcrt10.dll,,,, 1994-11-18,,,,,,,,, SHARED, 210944,,,,,
;"Msvcrt20" = 1, msvcrt20.dll,,,, 1994-11-18,,,,,,,,, SHARED, 243200,,,,
2.10.0.0,
"msjter32.dll" = 1, msjter32.dll,,,, 1995-5-12,,,,,,,,,, 23824,,,,
3.00.00.1923,
"msjint32.dll" = 1, msjint32.dll,,,, 1995-5-11,,,,,,,,,, 35600,,,,
3.00.00.2001,
"vbajet32.dll" = 1, vbajet32.dll,,,, 1995-5-8,,,,,,,,, SHARED, 55328,,,,
2.0.0.5321,
"vbar2232.dll" = 1, vbar2232.dll,,,, 1995-5-8,,,,,,,,, SHARED, 1403796,,,,
2.0.0.5321,
"ven2232.olb" = 1, ven2232.olb,,,, 1995-5-8,,,,,,,,, SHARED, 37376,,,,
2.0.0.5321,
"Tools" = 1, odbctl32.dll,,,, 1994-11-18,,,,,,,,,, 76288,,,, 3.00.32.0001,
"Changes" = 1, odbcjtnw.hlp,,,, 1994-11-18,,,,,,,,,, 83833,,,,,
"Help" = 1, odbcjet.hlp,,,, 1994-11-18,,,,,,,,,, 113064,,,,,
"Driver" = 1, odbcjt32.dll,,,, 1995-5-12,,,,,,,,,, 225792,,,, 3.20.01.0000,
"Setup" = 1, odbcjt32.dll,,,, 1995-5-12,,,,,,,,,, 225792,,,, 3.20.01.0000,
"Engine" = 1, msjt3032.dll,,,, 1995-5-12,,,,,,,,,, 1015568,,,,
3.00.00.2001,
"IIsam"=1,msrd2x32.dll,,,,1995-05-12,,,,,,,,,,250640,,,,3.00.00.2001,
"Strings"=1,odbcji32.dll,,,,1995-05-12,,,,,,,,,,37888,,,,3.20.01.0000,
<PRE> [SQL Server]
</PRE>"Setup"=1,sqlsrv32.dll,,,,1995-08-07,,,,,,,,,,210944,,,,2.50.1.21,
"Driver"=1,sqlsrv32.dll,,,,1995-08-07,,,,,,,,,,210944,,,,2.50.1.21,
"WinSysNT01"=1,ctl3dnt.dll,,,,1995-4-
4,,,,,,ctl3d32.dll,,,SHARED,27136,,,,02.31.00.00,
"WinSys9501"=1,ctl3d95.dll,,,,1995-4-
4,,,,,,ctl3d32.dll,,,SHARED,26112,,,,02.31.00.00,
"Msvcrt10"=1,msvcrt10.dll,,,,1993-07-23,,,,,,,,,SHARED,210944,,,,,
"Help"=1,drvssrvr.hlp,,,,1994-07-12,,,,,,,,,,105964,,,,02.00.19.06,
"Network"=1,dbnmpntw.dll,,,,1995-5-11,,,,,,,,,SHARED,16896,,,,1995.6.7.0,
<P>
[ODBC Translators]
"MS Code Page Translator"=
<P>
[MS Code Page Translator]
"Setup"=1,mscpxl32.dll,,,,1995-08-07,,,,,,,,,,15360,,,,2.50.01.21,
"Translator"=1,mscpxl32.dll,,,,1995-08-07,,,,,,,,,,15360,,,,02.50.01.21,
"Code Page 850"=1,12520850.cpx,,,,1994-07-12,,,,,,,,,,2233,,,,,
"Code Page 437"=1,12520437.cpx,,,,1994-07-12,,,,,,,,,,2151,,,,,
"WinSysNT01"=1,ctl3dnt.dll,,,,1995-4-
4,,,,,,ctl3d32.dll,,,SHARED,27136,,,,02.31.00.00,
"WinSys9501"=1,ctl3d95.dll,,,,1994-11-
30,,,,,,ctl3d32.dll,,,SHARED,26112,,,,02.31.00.00,
"Msvcrt10"=1,msvcrt10.dll,,,,1993-07-23,,,,,,,,,SHARED,210944,,,,,
<P>
[ODBC Driver Manager]
"Driver"=1,odbc32.dll,,,,1995-08-07,,,,,,,,,,64512,,,,2.50.30.6 ,
"Cursor"=1,odbccr32.dll,,,,1995-08-07,,,,,,,,,,167936,,,,2.50.30.6 ,
"WinSysNT01"=1,ctl3dnt.dll,,,,1995-4-
4,,,,,,ctl3d32.dll,,,SHARED,27136,,,,02.31.00.00,
"WinSys9501"=1,ctl3d95.dll,,,,1995-4-
4,,,,,,ctl3d32.dll,,,SHARED,26112,,,,02.31.00.00,
"Msvcrt10"=1,msvcrt10.dll,,,,1993-07-23,,,,,,,,,SHARED,210944,,,,,
;"resource"=1,odbcint.dll,,,,1995-08-07,,,,,,,,,,32768,,,,2.0050.30.06,
"resource"=1,odbcint.dll,,,,1995-08-07,,,,,,,,,,31768,,,,2.0050.40.06,
<P>
[Microsoft Access Driver (*.mdb)-Keys]
SQLLevel=0
FileExtns=*.mdb
FileUsage=2
DriverODBCVer=02.01
ConnectFunctions=YYN
APILevel=1
<P>
[SQL Server-Keys]
APILevel=1
ConnectFunctions=YYY
DriverODBCVer=02.01
FileUsage=0
SQLLevel=1
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.50 Installer 32-bit VC 4.0<BR>
Keywords            : SSrvProg kbhowto kbprg<BR>
Version             : 2.50<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
