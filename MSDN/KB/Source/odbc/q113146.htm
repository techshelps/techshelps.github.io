

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Some API's May Return SQL_ERROR: SQLSTATE S0001 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113146">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1994/03/28">
<META NAME="Keywords" CONTENT="kbusage kbbug1.02.3231">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT=" BUG# ODBCSDK2: 2309 (1.02.3231)   Calling any of the API's (SQLNumResultCols, SQLDescribeCol or SQLColAttributes), after executing a SELECT INTO statement with SQLExecDirect, will cause the SQL Server driver to return SQL_ERROR instead of SQL_SUCCES...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QABM,QA9E,QAGI,QALW,QAU9,QAA1,QAKP,QALZ,QDI2,QAIF,QAZV,QAJQ,QA2Q,QAY4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Some API's May Return SQL_ERROR: SQLSTATE S0001</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113146</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 1.0
</UL> 
<P>
BUG# ODBCSDK2: 2309 (1.02.3231)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Calling any of the API's (SQLNumResultCols, SQLDescribeCol or
SQLColAttributes), after executing a SELECT INTO statement with
SQLExecDirect, will cause the SQL Server driver to return SQL_ERROR instead
of SQL_SUCCESS. If you call SQLError, you will get the following:
<P>
<PRE>   SQLSTATE S0001, fNativeError 2714

</PRE>For example:

<OL><P><LI>Set up a SQL Server data source.

<P><LI>Log onto this SQL Server and use the pubs database.

<P><LI>SQLExecDirect: select * into test from authors.
   It returns SQL_SUCCESS.

<P><LI>Now call SQLNumResultCols.
   This will return *pcCol = -1 and a return code of SQL_ERROR.Calling
   SQLError yields:
<P>
<P><PRE>      szSqlState = "S0001", *pfNativeError = 2714, *pcbErrorMsg = 107
      szErrorMsg="[Microsoft][ODBC SQL Server Driver][SQL Server] There is
      already an object named 'test' in the database."
</PRE><P>
   SQLNumResultCols should actually return SQL_SUCCESS with *pcCol=0.
   Calling SQLDescribeCol (to describe any column) or SQLColAttributes
   (for any column) will cause the same behavior.
<P>
</OL><h2>WORKAROUND</h2>
 
<P>
Use the SQL Server driver versions prior to 1.02.3231. The problem does not
occur in these earlier versions.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the SQL Server Driver
version 1.02.3231. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 1.02.3231 ODBC
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
