

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: pcbValue Shows 1022 Even if Size of Available Data &gt; 1022 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141810">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1995/12/27">
<META NAME="Keywords" CONTENT="kbusage kbbug2.00">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT=" BUG#: 2400 (QJET)   When fetching an OLE object from a Microsoft Access 2.0 database (*.MDB) using the 16-bit ODBC Access driver, SQLFetch always returns a pcbValue of 1022 bytes even though the actual size of the data is greater than 1022.  WORKARO...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA9E,QDN9,QAL2,QAUD,QDKY,QA59,QAU9,QALG,QAYY,QANY,QA9N,QAKP,QAY2,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: pcbValue Shows 1022 Even if Size of Available Data &gt; 1022</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141810</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.00
</UL> 
<P>
BUG#: 2400 (QJET)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When fetching an OLE object from a Microsoft Access 2.0 database (*.MDB)
using the 16-bit ODBC Access driver, SQLFetch always returns a pcbValue of
1022 bytes even though the actual size of the data is greater than 1022.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft recommends moving to the 32-bit ODBC Access driver, because this
behavior is not seen in the 32-bit version.
<P>
MORE INFORMATION
 
<P>
To reproduce this problem:
<P>
Create a table (mytable) in Access 2.0 with two fields: Col1 text, Col2 OLE
Object.
Insert some text data into col1.
Open Paintbrush. Scribble, cut and paste the picture into Col2 (actual size
&gt; 1022 bytes).
<P>
Create a 16-bit datasource to this Access database.
<P>
Then, from ODBC Test:
<P>
Full connect to the Access database.
<P>
SQLExecdirect ( Select * from mytable)
<P>
SQLBindCol(icol=2, fCType=SQL_C_CHAR=1, cbValueMax=1023)
<P>
SQLFetch:
<PRE>   Return:   SQL_SUCCESS_WITH_INFO=1
                icol, fCType, cbValueMax, pcbValue, rgbValue
                2, SQL_C_CHAR=1, 1023, 1022, "151C2E00020...."

</PRE>NOTE: Even though the number of bytes of available data to return for the
column is 40K, the pcbValue shows 1022. pcbValue returns the correct number
of bytes if the cbValueMax is set to 1022 or less. This behavior is not
seen in the 32-bit ODBC Access driver version 3.x.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in 16-bit Access ODBC
driver version 2.00.2317. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00.2317 Access ODBC Driver<BR>
KBCategory: kbusage kbbug2.00<BR>
KBSubcategory: odbc access
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
