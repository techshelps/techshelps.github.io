

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: SQL Server Drivers' Use of ODBC.INI and WIN.INI Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110474">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1994/01/23">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  This article discusses the connection mechanics of the SQL Server driver version 1.01.2807 and later. It shows how the various .INI file entries are used to make the connection and also how entries are made in the WIN.INI file when installing a dat...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWD,QAU9,QA0B,QA9E,QAVZ,QAA1,QAK6,QBHQ,QDI2,QBVX,QABA,QBVV,QAYY,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: SQL Server Drivers' Use of ODBC.INI and WIN.INI Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110474</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses the connection mechanics of the SQL Server
driver version 1.01.2807 and later. It shows how the various .INI
file entries are used to make the connection and also how entries are
made in the WIN.INI file when installing a data source with the
driver.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following ODBC.INI and WIN.INI files will be used in this section:
<P>
<P><h3>ODBC.INI</h3>
 
<P>
[ODBC Data Sources]
InventorySQL=SQL Server
<P>
[InventorySQL]
Driver=C:\WINDOWS\SYSTEM\sqlsrvr.dll
Description=Inventory server for Corp.
Server=INVSQL
OemToAnsi=No
<P>
<P><h3>WIN.INI</h3>
 
<P>
[SQL Server]
INVSQL=dbmsspx3,INVSQL
<P>
When the SQL Server driver is loaded by the Driver Manager, because the
InventorySQL data source has been chosen by the user, the SQL Server driver
determines the server name by looking up the SERVER entry in the section
for InventorySQL from the ODBC.INI file. The SQL Server driver then looks
at the WIN.INI file s SQL Server Section to find an entry for INVSQL.
<P>
If it finds an entry for INVSQL, it loads the Network Library (Net-
Library), dbmsspx3 in the above example, and passes the server name on the
right hand side of the entry to the net-library. This net-library,
dbmsspx3, then takes the server name INVSQL and resolves the name using
network specific services, and connects to the SQL Server on the network.
<P>
In the above case, if there were no entry for INVSQL in the WIN.INI file,
the SQL Server driver would then have checked for DSQUERY in the SQL Server
section. If DSQUERY existed, as in the following WIN.INI file, the SQL
Server driver would have loaded the net-library for DSQUERY (dbmsspx3 in
the example below) and passed the server name INVSQL to it. The net-
library, dbmsspx3, would then connect to the server as mentioned in the
previous paragraph.
<P>
<P><h3>WIN.INI</h3>
 
<P>
[SQL Server]
DSQUERY=dbmsspx3
<P>
Furthermore, if there were no entry for INVSQL in the WIN.INI file and if
the DSQUERY entry does not exist in the WIN.INI file either, the SQL Server
driver will by default load DBNMP3.DLL.
<P>
When setting up a SQL Server data source using the driver, if (Default) is
chosen for the Network address and the Network library, the SQL Server
driver will not make any entries in the WIN.INI file. However, if the
network address and the network library are (default), and if and only if,
the entries in the dialog box for Server and Data Source are the same, the
entry for the data source will be removed from the WIN.INI file's SQL
Server section. This may not be desirable in some cases. As a result, the
best thing to do would be to setup the Data Source again, and this time do
not use (Default) for network library and network address in the Setup
Dialog Box. Instead use the installation-specific net-library and network
address.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory: odbc
<P>

Additional reference words: 1.01.2807
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
