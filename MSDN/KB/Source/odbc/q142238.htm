

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG:  Setup /AUTO Fails to Install 32-bit ODBC on Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142238">
<META NAME="KBModify" CONTENT="1996/02/16">
<META NAME="KBCreate" CONTENT="1996/01/08">
<META NAME="Keywords" CONTENT="kbsetup kberrmsg kbbug2.10">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT=" BUG#: 3191 (ODBCSDK2)   The setup program provided in the ODBC SDK 2.10a fails to install the 32-bit ODBC components on Windows NT when the /AUTO switch is used.  WORKAROUNDS  1. You can modify the setup program by calling SQLConfigDataSource after ...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QA9E,QBWP,QAU9,QAH4,QAW2,QAW1,QA0B,QAGI,QAKP,QAJQ,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG:  Setup /AUTO Fails to Install 32-bit ODBC on Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142238</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.1
</UL> 
<P>
BUG#: 3191 (ODBCSDK2)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The setup program provided in the ODBC SDK 2.10a fails to install the
32-bit ODBC components on Windows NT when the /AUTO switch is used.
<P>
<P><h2>WORKAROUNDS</h2>
 

<OL><P><LI>You can modify the setup program by calling SQLConfigDataSource after
   SQLInstallODBC. For more details on SQLConfigDataSource, please refer to
   Chapter 24, Installer DLL Function Reference, of the "ODBC 2.0
   Programmer's Reference and SDK Guide."

<P><LI>You can use SQLWritePrivateProfileString, a macro call that calls
   WritePrivateProfileString in the Windows API, to write a value name and
   data to the ODBC.INI subkey of the registry. For more details on
   SQLWritePrivateProfileString, please refer to Chapter 24, Installer
   DLL Function Reference, of the "ODBC 2.0 Programmer's Reference and SDK
   Guide."
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the ODBC 2.10a SDK. We are
researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Driver Setup Toolkit is included with the ODBC SDK to give developers
an easy way to include a customized setup program with their deliverable
database drivers. The toolkit is located in the \ODBCSDK\DRVSETUP.KIT
directory and is specifically designed to enable developers to customize an
ODBC-compatible driver setup program.
<P>
The driver setup program supports automatic setup. This is useful for multi-
user environments, where users can set up drivers from a network drive;
automatic setup provides all users with the same ODBC drivers and data
sources. To setup automatically, users run the setup program with the /AUTO
switch.
<P>
For more details, please refer to Chapter 6, Using the Driver Setup
Toolkit, of the "ODBC 2.0 Programmers Reference and SDK Guide."
<P>
The following is an excerpt from the ODBC SDK 2.10 release notes:
<P>
<P><h3>Chapter 6: Using the Driver Setup Toolkit (Problems and Information)</h3>
 
<P>
"Setup /AUTO works on Windows NT as well. However, on Windows NT, you
cannot configure a standalone system first and get a copy of the ODBC.INI
and ODBCINST.INI files, as the information for 32-bit setup is in the
registry. (See step 4 in "To configure a system for automatic setup, the
network administrator.") You must manually create these files for network
installation on Windows NT workstations. The file format for ODBC.INI is
described in the ODBC 2.0 Programmer's Reference. The file format for the
ODBCINST.INI file is the same for both 16-bit and 32-bit drivers."
<P>
However, when you manually create ODBC.INI and ODBCINST.INI files and
run Setup.exe, you will encounter the following error:
<P>
<PRE>   Setup is unable to install ODBC.
   C:\~SMPLSTP.T\ODBCINST.INI is either empty or missing.

</PRE></OL>Actually, Setup.exe creates a temporary directory: C:\~SMPLSTP.T and
ODBCINST.INI does exist in that directory.
<P>
Note that Setup /AUTO has been tested on Windows 95 and does not work on
this operating system either.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: Visual C++  Visual Basic<BR>
KBCategory: kbsetup kberrmsg kbbug2.10<BR>
KBSubcategory: odbc sdk
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
