

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Jet 3.0 Dynamic Memory Usage and Access ODBC Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154384">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1996/08/02">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  Many enhancements have been made to Microsoft Jet 3.0 over the Jet 2.x versions to improve performance. Dynamic Memory Usage is one of them and it is a configurable performance setting.  Microsoft Jet 2.x pre-allocated a default of 512 KB for its b...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA9E,QBW6,QABA,QAKD,QAU9,QBXS,QAY5,QDN9,QBAO,QALH,QDIV,QBE7,QBE6,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Jet 3.0 Dynamic Memory Usage and Access ODBC Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154384</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 3.40
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Many enhancements have been made to Microsoft Jet 3.0 over the Jet 2.x
versions to improve performance. Dynamic Memory Usage is one of them and it
is a configurable performance setting.
<P>
Microsoft Jet 2.x pre-allocated a default of 512 KB for its buffer size
with an upper limit (MaxBufferSize) of 4 MB RAM. The behavior of
MaxBufferSize has been changed in Jet 3.0, which allocates memory on an “as-
needed” basis up to an internally calculated high water mark.  The idea is
to efficiently use the memory in large RAM systems without the need to
adjust Registry Settings.
<P>
The high water mark (MaxBufferSize) for Jet 3.0 is calculated by the
following formula:
<P>
<PRE>   ( (((Total Ram in MB  -  12)/4 ) * 1024) +  512 ) KB

</PRE>For example, for a system with 32 MB RAM, Jet 3.0 uses a calculated
MaxBufferSize of 5,632 KB. You can override this value by setting the
MaxBufferSize value in the following HKEY_LOCAL_MACHINE subtree:
<P>
<PRE>   \SOFTWARE\Microsoft\Jet\3.0\Engines\Jet

</PRE>For Jet 3.5, the registry location for MaxBufferSize is:
<P>
<PRE>    \SOFTWARE\Microsoft\Jet\3.5\Engines\Jet 3.5

</PRE>In addition, Jet 3.5 settings may be modified at the ODBC data source
level. For additional information, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q168686.htm">Q168686</A></B>
   TITLE     : PRB: Performance Loss When Upgrading Jet ODBC Driver

</PRE>For MaxBufferSize (DWORD), enter a value in KB. You may have to add the
keys, if you do not have them already in the registry.
<P>
The minimum value that Microsoft Jet 3.0 can use by default is 512 KB.
However,the minimum value the the user can set is 128 KB. Unlike Jet 2.x,
Jet 3.0 can exceed the MaxBufferSize. When this occurs, the engine starts
up a background thread to start flushing pages to bring the buffer pool
down to the designated MaxBufferSize.
<P>
For more information on Jet 3.0, refer to the “Microsoft Jet Database
Engine Programmer's Guide” published by Microsoft Press.
<P>
Question:
<P>
How does MaxBufferSize setting affect ODBC applications using the Access
Driver?
<P>
Answer:
<P>
Microsoft Access ODBC Driver v3.x is based on Jet 3.0 Engine. If you do not
set the MaxBufferSize in the Registry and try to insert records
continuously into a table,  you will notice a huge growth in the memory
consumed by the application (process) using the driver. If your
application, running on Windows NT, is inserting records without ever
closing the database connection, the system may run out of virtual memory.
<P>
The memory growth will eventually reach a peak value that is equal to the
high water mark computed by Jet 3.0 and can be easily mistaken for a memory
leak in the driver. However, it is important to note that it is not a
memory leak as the memory growth stabilizes after reaching the peak value.
This behavior is by design.
<P>
If you don’t want the driver/Jet to allocate dynamic memory based on the
formula discussed above, it is recommended that you set the MaxBufferSize
to a value like 512 KB. You can set it to a higher value to gain better
performance.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.40 MFC Database Classes RDO Visual Basic<BR>
Visual C++<BR>
KBCategory: kbnetwork<BR>
KBSubcategory:<BR>
Keywords          : kbnetwork<BR>
Version           : 3.40.2728<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
