

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Implementation of Searched Updates in the Access Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127096">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1995/03/12">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  This article discusses how the Microsoft Access ODBC driver implements the SQL UPDATE statement and the implications of this in a concurrent multi- user situation.  MORE INFORMATION  The Microsoft Access ODBC driver relies on the Jet engine for dat...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAC1,QBD2,QA1S,QAJZ,QAA5,QA9E,QDIX,QDN9,QAW5,QBSO,QAU9,QAPN,QAJQ,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Implementation of Searched Updates in the Access Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127096</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00.2317
WINDOWS
kbusage
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses how the Microsoft Access ODBC driver implements the
SQL UPDATE statement and the implications of this in a concurrent multi-
user situation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Access ODBC driver relies on the Jet engine for data
processing. Jet is Microsoft's relational database engine that handles the
database processing for Microsoft Access and Microsoft Visual Basic.
<P>
A lost update is a typical concurrency problem and can occur when two
processes read the same data from the database, and try to update the data
based on what they read before either of the updates succeeds. With the
Access ODBC driver (Jet), there is no guaranteed way of preventing lost
updates. This is primarily because the Jet engine does not support a Read
or Intent-to-Update type lock. It only supports Write locks, which conflict
only with the other writers.
<P>
To understand why a lost update happens, you need to know how the following
SQL statement is executed:
<P>
<PRE>   Update &lt;table name&gt; Set &lt;column values&gt; Where &lt;searchcondition&gt;

</PRE>Even though this is a single SQL statement, it is implemented in roughly
two steps:

<OL><P><LI>Get a bookmark for all rows in the table that match the WHERE
   clause. A bookmark is the unique key value of a row.

<P><LI>For each bookmarked row, update it with the new values in the
   SET clause.
<P>
</OL>Now, consider two instances of an application running simultaneously. There
are several combinations of possible executions in the two processor update
case. If both processors attempt to do step 2 at the same time, one
processor would get a lock conflict error. The lock conflict error tells
you that the record is locked by another user on another machine.
<P>
If both processors do step 1 at the same time and processor #1 completes
(finishes and releases the lock) the update before processor #2 attempts
the update, processor #1's update will be lost. No error will be generated.
This is a classic lost update problem without transactions.
<P>
Transactions can help. A transaction ensures that the write lock obtained
by the first processor is held, which would mean that the second processor
would notice the lock. However, through the Jet driver, there is no way to
ensure that at any given time some other processor is not in the step 1
phase of the update. Hence, even with transactions, a lost update might
occur in a multi-machine update scenario.
<P>
The same reasoning applies to the combination of the DELETE and UPDATE
statements in a multi-user situation. You should note that this problem
is encountered very rarely.
<P>
Also, using the SQLSetPos, an ODBC API call, to do the UPDATEs or DELETEs
is faster and minimizes the chance of any lost updates or deletes.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00.2317 concurrency locking VISUAL C++<BR>
KBCategory: kbusage<BR>
KBSubcategory:<BR>
Keywords          : kbusage<BR>
Version           : 2.00.2317<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
