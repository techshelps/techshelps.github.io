

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ODBC Call Failed or Error 3146 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160762">
<META NAME="KBModify" CONTENT="1996/12/17">
<META NAME="KBCreate" CONTENT="1996/12/09">
<META NAME="Keywords" CONTENT="kbinterop kbenv kbusage kbsetup kbprb">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  If ODBC 2.x drivers pass function calls to the ODBC 1.x Driver Manager, you may receive the following errors from any 16-bit application that uses ODBC on a Windows 16-bit environment (such as Windows for Workgroups 3.11 or Windows 3.1).   - ODBC C...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QAGI,QBWO,QBE7,QBE6,QAU9,QAH5,QAGU,QABM,QDL9,QBWQ,QBWN,QAB4,QAAP,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ODBC Call Failed or Error 3146</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160762</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.2x, 6.0, and 6.5
<LI>Microsoft Open Database Connectivity, versions 1.x, 2.5, and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If ODBC 2.x drivers pass function calls to the ODBC 1.x Driver Manager, you
may receive the following errors from any 16-bit application that uses ODBC
on a Windows 16-bit environment (such as Windows for Workgroups 3.11 or
Windows 3.1).

<UL><LI>ODBC Call Failed
<P>
   -or-

<LI>3146 error - driver doesn't support the function
<P>
</UL><h2>CAUSE</h2>
 
<P>
Early versions of the ODBC Driver Manager (1.x) were placed in the Windows
directory on 16-bit Windows platforms, while subsequent versions of the
ODBC Driver Manager (2.x and above) were placed in the Windows\System
directory. The best way to determine if you are encountering the problem is
to search the computer for the Odbc.dll file, and verify the version in
File Manager. You can do this by clicking on the file and then clicking
Properties on the File menu. If the first possible Odbc.dll file in the
path is the ODBC 1.x Driver Manager, you are most likely encountering the
problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, remove the ODBC 1.x Driver Manager (Odbc.dll)
from the path and/or place the ODBC 2.x Driver Manager (Odbc.dll) in the
path first.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following portion of an ODBC Spy trace was obtained from an instance in
which the error reported was "ODBC Call Failed" from Access (the
SQLSetParam was replaced in ODBC 2.0 with SQLBindParameter):
<P>
<PRE>   SQLSetParam
      0x01010009
      1
      SQL_C_DEFAULT
      SQL_VARCHAR
      11
      0
      0x6E16774D
      0x6A16774D
      SQL_ERROR
   SQLError
      NULL
      NULL
      0x01010009
      [5]IM001
      -8190
      [54][SYWARE][ODBCSPY]Driver does not support this function
      511
      54
      SQL_SUCCESS
   SQLError
      NULL
      NULL
      0x01010009
      [5]00000
      -8190
      [0]
      511
      0
      SQL_NO_DATA_FOUND.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbenv kbusage kbsetup kbprb<BR>
KBSubcategory: SSrvGen odbc<BR>
Additional reference words: 1.xx 2.50 3.00 4.2x 6.00 6.50<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
