

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Text Driver Needs Directory Before Define Format Enabled </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124657">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1995/01/09">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  This article discusses why you must select a directory before the Define Format button is enabled when adding a new data source for the ODBC Text Driver version 2.0.  MORE INFORMATION  When you add a text data source for the ODBC Text Driver versio...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QBXB,QAU9,QBRZ,QATX,QAMB,QAFI,QA9E,QDNG,QAYY,QAK6,QA2Q,QAG2,QBVV,QA0B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Text Driver Needs Directory Before Define Format Enabled</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124657</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses why you must select a directory before the Define
Format button is enabled when adding a new data source for the ODBC Text
Driver version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you add a text data source for the ODBC Text Driver version 2.0, you
can define the format of the text files that this data source is going to
be associated with. This can be done by selecting the Define Format button
under Options in the ODBC Text Setup dialog box.
<P>
The text driver treats each text file as a table. Defining the format of a
text file lets the driver know how many columns are there in this table,
what their data types are, etc. The Define Format option is not enabled
until you select Select Directory to specify the directory that is going to
be used by the driver.
<P>
The reason for this can be seen by looking at how the text driver stores
the format information, also called as schema information. All the schema
information associated with a text data source is stored in a file called
SCHEMA.INI. The requirement is that the text driver should be able to
locate this file when an application connects to the text data source.
<P>
To be able to do this, the text driver needs to know during data source
setup time, the directory that the text files (tables) are going to be
located in. With this information, the driver will create the SCHEMA.INI
file in the same directory.
<P>
If you do not specify a directory, then the driver has no way of
determining at connect time where the SCHEMA.INI file is located. Hence,
the driver will not allow you to define the format. As a result, Define
Format is grayed out.
<P>
NOTE: This button is still grayed out when you select the Use Current
Directory button. This is because Use Current Directory does not give the
driver a definite directory to write the SCHEMA.INI. Although it can write
SCHEMA.INI to the current directory, when an application uses the DSN, the
current directory may be in another directory and the SCHEMA.INI is
missing.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00.2317 ODBC Desktop Database Drivers Pack<BR>
MFC VISUAL C++ FOXPRO WORD EXCEL Windows NT<BR>
KBCategory: kbprg<BR>
KBSubcategory:
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
