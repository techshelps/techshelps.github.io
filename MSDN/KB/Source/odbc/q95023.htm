

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INF: Error Handling in Visual Basic Data Access Layer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95023 ">
<META NAME="KBModify" CONTENT="1997/03/19">
<META NAME="KBCreate" CONTENT="1993/01/31">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  The Visual Basic ODBC layer provides the user with a lot of information on error conditions. The errors can be handled by using the On Error function.  MORE INFORMATION  There are 49 trappable errors for Visual Basic ODBC object language elements (...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QBS0,QA9E,QAKP,QAYL,QAH4,QA1S,QAY5,QATR,QAMA,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Error Handling in Visual Basic Data Access Layer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95023 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Visual Basic ODBC layer provides the user with a lot of
information on error conditions. The errors can be handled by using
the On Error function.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are 49 trappable errors for Visual Basic ODBC object language
elements (error numbers 600 through 648). A list of these messages and
their meanings can be found in the online help (Data Access Help). In
Visual Basic, all runtime errors are fatal errors; Visual Basic
displays the error message and terminates the program. However, it is
possible to trap these error messages and transfer control to an error
handling routine. The "On Error Go To &lt;linenumber&gt;" function
accomplishes this. Control is transferred to &lt;linenumber&gt; where the
error handling routine begins. Within this routine, the ERR function
can be used to obtain the error number of the current error message,
and based on this, appropriate action can be taken. Some of the Visual
Basic ODBC Object layer (VB/ODBC) error messages use internal
variables to provide specific information about an error. This is
referred to as the "variable portion of the error message" in the
online Data Access Help. The variable portion can be retrieved by
using the ERROR$ function. So, the error handler would typically
contain a call to the ERR function to get the error code; if the error
has a variable portion, it would contain a call to the ERROR$
function.
<P>
Because of the architecture of the VB/ODBC, there are four places
where the actual error may have occurred:

<OL><P><LI>Visual Basic
</OL>2. The ODBC driver manager
3. The ODBC driver
4. The data source
<P>
The ODBC API defines a standard set of error codes that are returned
for errors that occur in 2, 3, or 4. Visual Basic maps these
error codes to one of its own 49 trappable errors. In cases where it
makes sense to provide the native ODBC error code back to the VB
application, VB does so - and the variable portion of the error
message contains the native error. Eight of the 49 trappable errors
(ERR numbers 602, 606, 611, 613, 615, 618, 619, and 644)
return the native error messages in the ERROR$ function when these
errors occur. You can use a general error handler
containing a Select Case statement to return the ERROR$ function for
those ERR numbers. Native ODBC errors contain a lot of information,
including the name of the data source, the driver name, the vendor of
the driver, and the error text. For example:
<P>
<PRE>   [Microsoft][ODBC SQL Server Driver][SQL Server] Invalid object
   name 'Employees'.

</PRE></OL>The important thing to note, especially for programmers transitioning
from VBSQL, is that there are no callback error handler controls
available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.00<BR>
Keywords            : kbusage<BR>
Version             : 1.00<BR>
Platform            : MS-DOS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
