

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Return Values to AppleScript from FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149107">
<META NAME="KBModify" CONTENT="1996/05/31">
<META NAME="KBCreate" CONTENT="1996/03/27">
<META NAME="Keywords" CONTENT="kbinterop kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  It is possible to use AppleScript to run a Visual FoxPro program and return a value to AppleScript.  MORE INFORMATION  In the following example, the AppleScript portion asks the user for a Customer ID and then calls a Visual FoxPro program. The Vis...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QDNQ,QA56,QA55,QAH4,QALW,QAUR,QABA,QBWS,QBXS,QA5V,QA4H,QA01,QAY2,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Return Values to AppleScript from FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 31, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149107</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
It is possible to use AppleScript to run a Visual FoxPro program and return
a value to AppleScript.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In the following example, the AppleScript portion asks the user for a
Customer ID and then calls a Visual FoxPro program. The Visual FoxPro
program then opens a database, sums the order amounts for the Customer ID
that was entered, and returns the sum to the script. Then the script
displays the result in a dialog box.

<OL><P><LI>Save the following FoxPro program file as MyQuery.prg in the Visual
   FoxPro folder:
<P>
   PARAMETERS lcCustID
   SET DEFAULT TO HOME()+"Samples:Data"
   OPEN DATA TestData.DBC
   SELECT SUM(Order_Amt) AS Tot_Ord_Amt ;
<P><PRE>      FROM Orders ;
      WHERE Cust_Id=UPPER(lcCustID) ;
      INTO CURSOR Temp
</PRE>   SET DEFAULT TO HOME()
<PRE>   IF _TALLY &gt; 0   &amp;&amp; Check to see that any records where found
      RETURN Temp.Tot_Ord_Amt
   ELSE
      RETURN _TALLY
   ENDIF

</PRE><P><LI>Use the AppleScript Script Editor to save and run the following script.
<P>
   IMPORTANT: When typing the code listed below, replace the semicolons
   with the AppleScript line continuation character by typing Option+Enter
   in the Script Editor.
<P>
   copy (display dialog "Please enter the Customer's ID" buttons ;
<P><PRE>      {"OK", "Cancel"} default answer "") to dialogResults
</PRE><P>
   if the button returned of dialogResults is "OK" and ;
<P><PRE>      {the text returned of dialogResults} is not "" then
</PRE><P>
<P><PRE>      tell application ;
<PRE></PRE>         "Macintosh HD:Microsoft Visual FoxPro:Microsoft Visual FoxPro"

            activate
            Do Script "SET DEFAULT TO HOME()"
            Do Script ;
               "myquery(["&amp;{the text returned of dialogResults}&amp;"])"
            display dialog the result

      end tell

   end if
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b VFoxMac<BR>
KBCategory: kbinterop kbhowto kbcode<BR>
KBSubcategory: FxinteropDde
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 31, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
