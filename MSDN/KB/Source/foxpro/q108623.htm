

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Forcing FoxPro Window to Always Remain on Top </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108623">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1993/12/14">
<META NAME="Keywords" CONTENT="kbinterop kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The sample code below forces the main FoxPro window to remain on top of all other windows. It demonstrates how to use the FOXTOOLS.FLL library commands to call the SetWindowPos() Microsoft Windows application programming interface (API) function.  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAKJ,QAGI,QBHQ,QAY5,QBWQ,QAMA,QBV8,QAB9,QAGQ,QA63,QABI,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Forcing FoxPro Window to Always Remain on Top</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108623</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The sample code below forces the main FoxPro window to remain on top
of all other windows. It demonstrates how to use the FOXTOOLS.FLL
library commands to call the SetWindowPos() Microsoft Windows application
programming interface (API) function.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The program first declares some compile-time constants (to improve
readability) and loads the FOXTOOLS.FLL library that is supplied with
FoxPro for Windows. It then retrieves the handle to the main FoxPro window
using a call to MainHWND(), which is a function residing in the
FOXTOOLS.FLL library. It then calls the SetWindowPos() function and passes
the handle to the main FoxPro window and the HWND_TOPMOST constant to make
sure that window always remains on top.
<P>
<PRE>   *** Define compile-time constants
   #DEFINE HWND_TOPMOST -1
   #DEFINE HWND_NOTOPMOST -2
   #DEFINE SWP_NOSIZE 1
   #DEFINE SWP_NOMOVE 2

   *** Load FoxTools library
   SET LIBRARY TO SYS(2004)+"FOXTOOLS"

   *** Register the Windows API function
   setwin=RegFn("SetWindowPos","IIIIIII","I")

   *** Obtain handle to main FoxPro window
   handle=mainhwnd()

   *** Call SetWindowPos() API function
   =CallFn(setwin,handle,HWND_TOPMOST,0,0,0,0,SWP_NOMOVE+SWP_NOSIZE)

   *** Release the FoxTools library
   SET LIBRARY TO

</PRE>In order to remove the "always on top" attribute from the main FoxPro
window, the program above could be modified to make the CallFn() line
use the constant HWND_NOTOPMOST instead of HWND_TOPMOST as the third
argument.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Windows Software Development Kit, "Programmer's Reference,
Volume 2: Functions," page 892
<P>
FOXTOOLS.WRI located in the C:\FOXPROW\GOODIES\FOXTOOLS subdirectory
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
SDK<BR>
KBCategory: kbinterop kbtool kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
