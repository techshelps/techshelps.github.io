

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Converter: How the Position of Screens Is Converted </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130831">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/30">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article addresses the issue of positioning converted screens. It explains how window position is calculated in FoxPro version 2.x for Windows and in Visual FoxPro. It also describes how the converter converts screen position. The source code t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACI,QADF,QAJP,QAEQ,QA56,QA55,QAJQ,QBE7,QBE6,QAA8,QAGQ,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Converter: How the Position of Screens Is Converted</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130831</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article addresses the issue of positioning converted screens. It
explains how window position is calculated in FoxPro version 2.x for
Windows and in Visual FoxPro. It also describes how the converter converts
screen position. The source code to the CONVERT.APP application is included
with the Professional Edition of Visual FoxPro, and is installed in the
TOOLS\CONVERT directory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
FoxPro version 2.x for Windows uses foxels to calculate window and object
location. A foxel is a unit of measure unique to FoxPro that is equivalent
to the average height and width of a character. In FoxPro versions 2.x for
Windows, a window position is based on the font of its container. In other
words, if a user window is defined on the desktop, the font of the main
FoxPro window determines the top and left position of the screen.
Developers often place a MODIFY WINDOW SCREEN FONT &lt;fontname&gt;,&lt;fontsize&gt;
statement in the Setup code of a FoxPro version 2.x screen to ensure that
windows are consistently displayed at the same location on different
systems.
<P>
A screen added to a FoxPro version 2.x project can be positioned by using
the Arrange button. The window's coordinates are saved in foxels in the
Project Manager (ARRANGED field of the PJX table). The information relative
to the position of the window is not stored anywhere if the screen is not
included in a project.
<P>
A Visual FoxPro form can use pixels or foxels. A pixel is the smallest
element that can be displayed on a screen. It is resolution dependent but
is not affected by font information.
<P>
Visual FoxPro provides an application (CONVERT.APP) that converts FoxPro
2.x projects to a Visual FoxPro format. The converter dialog is displayed
when you open a FoxPro version 2.x project in Visual FoxPro. Screen sets
are converted to form sets, and each screen contained in a screen set is
converted to a form. The SCALEMODE property of a converted form is set to 3-
Pixels.
<P>
During the conversion process, CONVERT.APP converts the window position
from foxels to pixels. The calculation is defined in the AddPos method of
the FP25FORM class in the CONVERT.PRG file. CONVERT.APP uses the font of
the desktop in the current Visual FoxPro session as a basis for the
conversion.
<P>
For example, if the desktop font is MSSansSerif 10, the converter uses the
fontmetrics of MSSansSerif 10 to convert the position of the form window.
On the other hand, if the desktop font is MSSansSerif 12, MSSansSerif 12 is
the basis for the conversion from foxel to pixel, and the resulting window
appears at a lower position than it was previously located.
<P>
Therefore, to ensure that windows are located at the same absolute position
in a converted screen, verify that the font of the main FoxPro window is
the same as the one used by FoxPro version 2.6 screens.
<P>
NOTE: When the SCALEMODE property of a form is set to 0-Foxels, the window
position is based on the font it uses. As opposed to windows defined with a
DEFINE WINDOW command used in FoxPro version 2.x screen definition, the top
and left positions of a Visual FoxPro form are not set by the font of the
container window. Thus, in Visual FoxPro, the MODIFY WINDOW SCREEN FONT
&lt;FontName&gt; command does not alter the position of a form.
<P>
The following example code illustrates the fact that the position of a
window is based on its font:
<P>
<PRE>   omyform1=CREATEOBJECT('myform')
   omyform1.show

   oMyform2=CREATEOBJECT('myform2')
   omyform2.show


   suspend

   DEFINE CLASS MyForm2 AS Form
      caption = "Arial, 18"
      scalemode = 0
      fontname="Arial"
      fontsize=18
      top = 1
      left = 1
      height = 10
      width = 20
   ENDDEFINE

   DEFINE CLASS MyForm AS Form
      caption= "Arial,10"
      scalemode = 0
      fontname="Arial"
      fontsize=10
      top = 1
      left = 1
      height = 10
      width = 20
   ENDDEFINE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolOtherdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
