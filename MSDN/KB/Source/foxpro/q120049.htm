

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Can't Use More Than 2 Subqueries in SELECT-SQL Statement </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120049">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/08/31">
<META NAME="Keywords" CONTENT="kbprg kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When more than two subqueries at the same level and not nested are used in the WHERE clause of a SELECT-SQL statement, the error message  SQL Too many subqueries  is displayed when the SQL statement is executed.  STATUS ======  Microsoft is researc...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACI,QBJQ,QA9N,QAY4,QAKD,QAPN,QA2Q,QAY2,QAJQ,QAB4,QAG2,QABM,QAB9,QBWS,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Can't Use More Than 2 Subqueries in SELECT-SQL Statement</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120049</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When more than two subqueries at the same level and not nested are used in
the WHERE clause of a SELECT-SQL statement, the error message "SQL Too many
subqueries" is displayed when the SQL statement is executed.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The last paragraph of the WHERE clause section in the "SELECT-SQL"
topic of the "Language Reference" manual and the online Help system states
the following:
<P>
<PRE>   You can have multiple subqueries at the same level (not nested) in the
   WHERE clause.

</PRE>This information is true, but you cannot have more than two subqueries at
the same level in a SELECT-SQL command, as demonstrated by the following
example:
<P>
<PRE>   &amp;&amp;Create Tables
   CREATE TABLE TEST1 (F1 C(3),F2 n(3),F3 n(3))
   CREATE TABLE TEST2 (F1 C(3),F2 N(3))

   &amp;&amp;Insert Data into TEST1.DBF
   INSERT INTO TEST1 (F1,F2,F3) VALUES('AAA',10,1)
   INSERT INTO TEST1 (F1,F2,F3) VALUES('AAA',5,10)
   INSERT INTO TEST1 (F1,F2,F3) VALUES('BBB',10,2)
   INSERT INTO TEST1 (F1,F2,F3) VALUES('BBB',5,10)
   INSERT INTO TEST1 (F1,F2,F3) VALUES('CCC',10,1)
   INSERT INTO TEST1 (F1,F2,F3) VALUES('CCC',5,10)

   &amp;&amp;Insert Data into TEST2.DBF
   INSERT INTO TEST2 (F1,F2) VALUES('AAA',1)
   INSERT INTO TEST2 (F1,F2) VALUES('BBB',2)
   INSERT INTO TEST2 (F1,F2) VALUES('AAA',2)
   INSERT INTO TEST2 (F1,F2) VALUES('BBB',5)

   &amp;&amp;SQL command to demonstrate the situation
   SELECT F1,F2,F3 FROM TEST1 WHERE F1 IN(SELECT F1 FROM TEST2) AND;
                                    F2 &gt;(SELECT MIN(F2) FROM TEST2) AND;
                                    F3 &lt;(SELECT AVG(F2) FROM TEST2)

</PRE>The above SQL statement will result in the "SQL Too many subqueries" error
message when it is executed, whereas the following statement will not:
<P>
<PRE>   SELECT F1,F2,F3 FROM TEST1 WHERE F1 IN(SELECT F1 FROM TEST2) AND;
                                    F2 &gt;(SELECT MIN(F2) FROM TEST2)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a 2.50b 2.60 err<BR>
errmsg msg<BR>
KBCategory: kbprg kberrmsg kbprb<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
