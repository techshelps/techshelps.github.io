

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Make GENXTAB.PRG Work with Any Table/.DBF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113525">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/04/06">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Currently, you can only use GENXTAB.PRG with the first three fields of a database even though the comments in GENXTAB.PRG say otherwise. The comments read as follows:      Calling example:     DO genxtab WITH 'XTAB.DBF',.T.,.T.,.T.,1,2,5,.T.      T...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA5V,QABA,QBXT,QAIB,QA7O,QA7N,QAJ2,QDI1,QAZZ,QAZV,QAJZ,QABG,QAMB,QDPA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Make GENXTAB.PRG Work with Any Table/.DBF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113525</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, and 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, and 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Currently, you can only use GENXTAB.PRG with the first three fields of a
database even though the comments in GENXTAB.PRG say otherwise. The
comments read as follows:
<P>
<PRE>    Calling example:
    DO genxtab WITH 'XTAB.DBF',.T.,.T.,.T.,1,2,5,.T.

    This command causes GENXTAB to write the output database to
    'XTAB.DBF'. However, XTAB.DBF will be deleted and the output
    stored to a cursor called XTAB. The input database will be closed
    at the conclusion of the program. The rows in XTAB.DBF will
    contain the unique values of field 1 in the database that is
    selected when GENXTAB is called, the columns will contain
    unique values of field 2 in the input database, and the
    cell values will come from field 5 in the input database.
    The thermometer will be shown. A total field will be created.

</PRE>All the parameters work correctly except the row, column, and cell
parameters. GENXTAB.PRG always uses the first field as the row, the second
field as the column, and the third field as the cell.
<P>
To correct this problem, modify GENXTAB.PRG using the code below and save
it as GENXTABX.PRG.
<P>
For more information about the meaning of the parameters, please see the
following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q113971.htm">Q113971</A></B>
   TITLE     : How to Call GENXTAB.PRG

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To make the modifications, choose Go To from the Edit menu, and then change
the lines below.
<P>
WARNING: All of the following modifications must be made at the same time
in order to maintain the functionality of GENXTABX.PRG.
<P>
<PRE>   Line 238
   ORIGINAL CODE:
      IF inpfields[1,2] $ 'MGP'
   CHANGE TO:
      IF inpfields[m.rowfld,2] $ 'MGP'

   Line 242
   ORIGINAL CODE:
      IF inpfields[2,2] $ 'MGP'
   CHANGE TO:
      IF inpfields[m.colfld,2] $ 'MGP'

   Line 246
   ORIGINAL CODE:
      IF inpfields[3,2] $ 'MGP'
   CHANGE TO:
      IF inpfields[m.cellfld,2] $ 'MGP'

   Line 310
   ORIGINAL CODE:
      outarray[1,1] = mapname(inpfields[1,1])
   CHANGE TO:
      outarray[1,1] = mapname(inpfields[m.rowfld,1])

   Line 311
   ORIGINAL CODE:
      outarray[1,2] = inpfields[1,2]
   CHANGE TO:
      outarray[1,2] = inpfields[m.rowfld,2]

   Line 312
   ORIGINAL CODE:
      outarray[1,3] = inpfields[1,3]
   CHANGE TO:
      outarray[1,3] = inpfields[m.rowfld,3]

   Line 313
   ORIGINAL CODE:
      outarray[1,4] = inpfields[1,4]
   CHANGE TO:
      outarray[1,4] = inpfields[m.rowfld,4]

   Line 317
   ORIGINAL CODE:
      outarray[i,2] = inpfields[3,2]                   &amp;&amp; field type
   CHANGE TO:
      outarray[i,2] = inpfields[m.cellfld,2]           &amp;&amp; field type

   Line 318
   ORIGINAL CODE:
      outarray[i,3] = inpfields[3,3]                   &amp;&amp; field length
   CHANGE TO:
      outarray[i,3] = inpfields[m.cellfld,3]           &amp;&amp; field length

   Line 319
   ORIGINAL CODE:
      outarray[i,4] = inpfields[3,4]                   &amp;&amp; decimals
   CHANGE TO:
      outarray[i,4] = inpfields[m.cellfld,4]           &amp;&amp; decimals

   Line 325
   ORIGINAL CODE:
      outarray[ALEN(coluniq)+2,2] = inpfields[3,2]
   CHANGE TO:
      outarray[ALEN(coluniq)+2,2] = inpfields[m.cellfld,2]

   Line 326
   ORIGINAL CODE:
      outarray[ALEN(coluniq)+2,3] = inpfields[3,3]
   CHANGE TO:
      outarray[ALEN(coluniq)+2,3] = inpfields[m.cellfld,2]

   Line 327
   ORIGINAL CODE:
      outarray[ALEN(coluniq)+2,4] = inpfields[3,4]
   CHANGE TO:
      outarray[ALEN(coluniq)+2,4] = inpfields[m.cellfld,4]

</PRE>Save the file as GENXTABX.PRG so that the original GENXTAB can be used.
This completes the changes necessary to make GENXTABX.PRG work with any
database and any character or numeric fields you choose. To test the
changes, use the following example, which uses the SALESMAN.DBF file in the
TUTORIAL subdirectory off the main FoxPro directory.
<P>
<P><h3>Example</h3>
 
<P>
<PRE>   *** CODE BEGINS HERE ***
   CLOSE DATA
   newgxtx=GETFILE('PRG',"Select GENXTABX.PRG","Select")
   oldgxt=_genxtab
   _genxtab=newgxtx
   SELECT 0
   gxtname=GETFILE('DBF',"Chose SALESMAN.DBF","USE")
   USE (gxtname) EXCLUSIVE
   SET SAFETY OFF
   INDEX ON name+state TAG combo
   SET SAFETY ON
   DO (_GENXTAB) WITH 'TEST_GXT',.T.,.T.,.T.,4,9,5,.T.
   BROWSE
   CLOSE DATA
   _genxtab=oldgxt
   *** CODE ENDS HERE ***

</PRE>To make GENXTABX your default _genxtab, add the following line to your
CONFIG.FP or CONFIG.FPW file:
<P>
<PRE>   _GENXTAB=&lt;path to FoxPro directory&gt;\GENXTABX.PRG
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.50 2.50a 2.50b 2.60 crosstab<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxenvConfigfp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
