

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Unexpected Behavior When FoxPro Application Is Encrypted </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124118">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1994/12/19">
<META NAME="Keywords" CONTENT="kbtool kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a FoxPro table (.DBF) file is included in a project and the resulting application (.APP) file is encrypted, you may encounter problems such as a distorted display, a hung computer, or a return to the MS-DOS prompt.  WORKAROUND  To work around ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QBXS,QAVW,QAVX,QAH4,QAY2,QAUR,QABG,QAG2,QAAW,QANE,QAA8,QAJN,QAGX,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Unexpected Behavior When FoxPro Application Is Encrypted</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124118</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a FoxPro table (.DBF) file is included in a project and the resulting
application (.APP) file is encrypted, you may encounter problems such as a
distorted display, a hung computer, or a return to the MS-DOS prompt.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use a third party product such as Cryptor to
encrypt the database, or use the techniques outlined in the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q115476.htm">Q115476</A></B>
   TITLE     : How to Encrypt FoxPro .DBF Files

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start FoxPro for MS-DOS. Use the CUSTOMER.DBF table located in the
   FPW26\TUTORIAL directory, and create a quick screen. Save the screen as
   CUSTOMER.SCX.

<P><LI>Open the CONTROL3.SCX screen located in the WINDOWS26\TUTORIAL
   directory.

<P><LI>From the File menu, choose Save As to save the screen under a different
   name (MYCONTROL.SCX). Then close CONTROL3.SCX.

<P><LI>From the file menu, choose Open to open MYCONTROL.SCX.

<P><LI>Double-click the push buttons and change the Append prompt to Browse.
   Select the valid code snippet check box to expose the associated code.
   Then modify the code as shown below.
<P>
   DO CASE
   CASE act2 = 1
<P><PRE>      GO TOP
</PRE>   CASE act2 = 2
<P><PRE>      SKIP -1
      IF BOF()
<PRE></PRE>         GO TOP
      ENDIF
   CASE act2 = 3
      SKIP 1
      IF EOF()
            GO BOTTOM
      ENDIF
   CASE act2 = 4
      GO BOTTOM
   CASE act2 = 5
   DEFINE WINDOW test FROM 15,0 TO 21,44
   ACTIVATE WINDOW test
   BROWSE IN WINDOW test SAVE NOWAIT WHEN showget()
   CASE act2 = 6
      CLEAR WIND
      CLEAR READ
   ENDCASE
   SHOW GETS
   RETURN 0

</PRE><P><LI>Close the valid code snippet. From the system menu, choose Screen. Then
   choose Screen Layout from the resulting popup. In the Screen Layout
   dialog, activate the cleanup and procedure snippet. Then type this code:
<P>
   PROCEDURE showget
   SHOW GETS
   RETURN
<P>
   Then close the code snippet, and save the screen with the changes.

<P><LI>In the Command window, type the following to start a new project file:
<P>
   Create project Test,

<P><LI>In the project file, choose Add to include the CUSTOMER.DBF table in the
   project. Choose Add again to add the CUSTOMER.SCX screen. From the
   system menu, choose Project. Then select "Set main" to make CUSTOMER.SCX
   the main program.

<P><LI>With CUSTOMER.SCX highlighted in the project, click the edit push button
   to edit the screen. Then from the edit screen dialog, choose Add to add
   MYCONTROL.SCX to the screen set. Choose the arrange push button to
   arrange the two screens side by side. Then save the arrangement, and
   close the edit screen dialog.

<P><LI>From the sys menu, click Project. Then select project info. In the
<P><PRE>    project info dialog, select the encrypt check box so the resulting
    TEST.APP file is encrypted. From the project file, choose Build. Then'
    select Build Application to create the TEST.APP file. After completing
    the .APP file, close the project file.
</PRE>
<P><LI>From the system menu, choose Run. Then choose "Run application," from
<P><PRE>    the resulting popup. Select TEST.APP from the group of files.
</PRE>
<P><LI>When the application is running, press the Next push button to see the
<P><PRE>    display update correctly. Then press the Browse button and move through
    the data. You'll see that all records are fine. Press the Bottom push
    button. You'll see a blank screen. try to use any of the push buttons
    again. You will either see no records at all or garbage. After a short
    time the computer may hang.
</PRE><P>
</OL>The problem does not occur if the .APP is built in FoxPro for Windows.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.50 2.50a 2.50b 2.60 2.60a buglist2.50<BR>
buglist2.50a buglist2.50b buglist2.60 buglist2.60a freeze crash hang no<BR>
response dumped lock up locked<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: FxtoolAccessory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
