

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Change the Mouse Pointer to Any .CUR or .ANI File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137627">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/10/02">
<META NAME="Keywords" CONTENT="kbprg kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The ability to change the mouse pointer to a cursor file other than one of the default system cursors is available to Visual FoxPro through the Windows API. This feature set is available under both Windows 95 and Windows NT.  Visual FoxPro allows y...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QA4Q,QBWP,QBWQ,QAO3,QAMB,QDL9,QBWO,QBWN,QAPN,QAB9,QBXS,QAEB,QBSO,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Change the Mouse Pointer to Any .CUR or .ANI File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137627</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ability to change the mouse pointer to a cursor file other than one of
the default system cursors is available to Visual FoxPro through the
Windows API. This feature set is available under both Windows 95 and
Windows NT.
<P>
Visual FoxPro allows you to change the MousePointer property to specify
one of the pointer shape available in the default 12 system pointers, and
the DragIcon property allows you to set the pointer to any monochrome .cur
file. However, in some cases, you might want a colored pointer or an
animated pointer (.ani file). You can use the Windows API to do this.
<P>
The example in this article shows a method using LoadCursorFromFile() and
SetSystemCursor(). There are other functions that may be useful as well
such as CopyIcon(), ClipCursor(), GetCursor(), and so on. See the
Win32api.hlp file for more information on these functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code demonstrates a form with two command buttons. The upper
button changes the pointer to an animated cursor and the lower button
resets the pointer to the original cursor. The sample code is designed to
run under Windows NT. It requires slight modification to run under Windows
95; instructions are given in comments.
<P>
<P><h3>Sample Code</h3>
 
<P>
PUBLIC oform1
<P>
oform1=CREATEOBJECT("form1")
oform1.Show()
RETURN
<P>
DEFINE CLASS form1 AS form
<PRE>     Caption = "Form1"
     Name = "Form1"

     ADD OBJECT command1 AS commandbutton WITH ;
          Top = 72, ;
          Left = 96, ;
          Height = 29, ;
          Width = 94, ;
          Caption = "SetCursor", ;
          Name = "Command1"

     ADD OBJECT command2 AS commandbutton WITH ;
          Top = 144, ;
          Left = 96, ;
          Height = 29, ;
          Width = 94, ;
          Caption = "ResetCursor", ;
          Name = "Command2"

     PROCEDURE Init
          public currenthcurs,tempcurs,newhcurs,OCR_NORMAL
          OCR_NORMAL=32512  &amp;&amp;from winuser.h
     ENDPROC

     PROCEDURE command1.Click
          MyDir=space(255)
          declare Integer GetWindowsDirectory in Win32Api String @, Integer
          declare Integer CopyIcon in Win32Api Integer
          declare Integer LoadCursorFromFile in Win32Api String
          declare Integer SetCursor in Win32Api Integer
          declare SetSystemCursor in Win32Api Integer, Integer
          declare Integer GetCursor in Win32Api

          currenthcurs=GetCursor()
          tempcurs=CopyIcon(currenthcurs)
          len=GetWindowsDirectory(@MyDir,255)
          MyDir=left(MyDir,len)+"\System32\dinosaur.ani"  &amp;&amp; WindowsNT
</PRE>*  Uncomment the next line and comment the previous line if running under
*  Windows 95, or set MyDir to the path to a valid .cur or .ani file.
<PRE>*         MyDir=left(MyDir,len)+"\cursors\dinosaur.ani"  &amp;&amp; Windows95
          newhcurs=LoadCursorFromFile(MyDir)
          =SetSystemCursor(newhcurs,OCR_NORMAL)
     ENDPROC

     PROCEDURE command2.Click
          =SetSystemCursor(tempcurs,OCR_NORMAL)
     ENDPROC
</PRE>ENDDEFINE
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more details, you can find a reference to these cursor functions in the
Win32Api.hlp Help file and in the Win32 SDK. The creation of cursor files
is supported by Imagedit.exe, and the Windows NT utility Aniedit.exe can be
used to create animated cursors.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
