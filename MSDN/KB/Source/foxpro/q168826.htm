

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Adding VB Custom Method Control Causes Fault in VFP5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168826">
<META NAME="KBModify" CONTENT="1997/05/22">
<META NAME="KBCreate" CONTENT="1997/05/21">
<META NAME="Keywords" CONTENT="FxinteropOcx kberrmsg vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Adding a custom control that has been created in Visual Basic 5.0 using a custom method can cause a fault in Visual FoxPro 5.0 and 5.0a.  If the operating system is Windows 95, the message is  Illegal Operation - Invalid Page Fault.  If the operati...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAOE,QAMN,QBWS,QAHV,QA56,QA55,QA2Q,QAPN,QBBS,QAG2,QDIR,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Adding VB Custom Method Control Causes Fault in VFP5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168826</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Adding a custom control that has been created in Visual Basic 5.0 using a
custom method can cause a fault in Visual FoxPro 5.0 and 5.0a.
<P>
If the operating system is Windows 95, the message is "Illegal Operation -
Invalid Page Fault." If the operating system is Windows NT, the error is an
Application Error, Visual FoxPro referenced memory location 0x00000000,
which could not be read.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Add SYS(2333,0) in the INIT event of the form, save and run the form at
least once before adding the custom control to the form. Using the
SYS(2333,0) disables the ActiveX dual interface (VTABLE binding) support.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create the control in Visual Basic 5.0 with the following steps:

<OL><P><LI>Run Visual Basic 5.0, and select "Create new ActiveX control."

<P><LI>Add a TextBox control to the form.

<P><LI>Click Add-Ins on the menu. If the ActiveX Control Interface Wizard does
   not already show up as one of the options, select Add-Ins Manager.

<P><LI>When the Add-Ins manager shows up, click the ActiveX Control
   Interface Wizard.

<P><LI>Click the Add-Ins menu again, and select the ActiveX Control Interface
   Wizard.

<P><LI>Click Next until you reach the Select Interface Members screen,
   then remove all props/events/methods from the Selected name list box.

<P><LI>Click Next to go to the Create Custom Interface Member' screen,
   then click New.

<P><LI>In the Add custom Member dialog box, type MYTEST under the Name
   text box, select Method for the type, and then click OK.

<P><LI>Click Next twice, and then click Finish.

<P><LI>From the File menu, select Make &lt;project name&gt; to compile the
   OCX.
<P>
</OL>In Visual FoxPro 5.0, do the Following:

<OL><P><LI>Start Visual FoxPro.

<P><LI>Create a new form.

<P><LI>Add an OLE Container control to the form.

<P><LI>Select your new Visual Basic created control from the list (if you do
   not name the project or the control in Visual Basic, the name in the
   box will be Project1.UserControl1).
<P>
</OL>NOTE: A system error occurs, caused by Visual FoxPro 5. This error does
<PRE>      not occur with Visual FoxPro 3.x.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxinteropOcx kberrmsg vfoxwin<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
