

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Printer Driver is Corrupted" Error Under Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137954">
<META NAME="KBModify" CONTENT="1995/10/15">
<META NAME="KBCreate" CONTENT="1995/10/09">
<META NAME="Keywords" CONTENT="kbprint kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using raw-mode printing under Windows 95 and printing to a remote printer, it is possible to receive the error  Cannot write to device PRN  followed by the error  Printer driver is corrupted.   CAUSE =====  The user needs to capture the printe...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QDL9,QBWQ,QBWO,QBWN,QACT,QDJP,QAB4,QADF,QBXS,QAA1,QAAP,QDI2,QBC9,QBC8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Printer Driver is Corrupted" Error Under Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 15, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137954</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using raw-mode printing under Windows 95 and printing to a remote
printer, it is possible to receive the error "Cannot write to device PRN"
followed by the error "Printer driver is corrupted."
<P>
<P><h2>CAUSE</h2>
 
<P>
The user needs to capture the printer to a local port.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When you install a new printer under Windows 95, a dialog box appears
asking "Do you print from MS-DOS-based programs?" Click Yes, and then click
the Capture Printer Port button. Continue installing the printer by
choosing the appropriate choices for the computer where you are installing
the printer driver. At this point, raw-mode printing should work as it did
under Windows version 3.1.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When using raw-mode printing under FoxPro version 2.6 for Windows, FoxPro
imitates the way an MS-DOS-based application prints. Under Windows 95, the
printer, by default, does not capture the printer port. Windows 95 uses
universal naming conventions (UNC) to find a remote printer.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Install a network printer under Windows 95 using the New Printer
   Wizard. Click No when asked, "Do you print from MS-DOS-based programs?"

<P><LI>In FoxPro, run the following code example to a Hewlett-Packard printer
<P>
   SET PRINTER ON
   ??? ""
   ? "I set the printer in raw mode"
   ??? CHR(27)+"(s3B"
   ? "I am printing bold"
   ??? CHR (27) + "(s0B"
   ? "Now it's not bold"
   SET PRINTER OFF
   SET PRINTER TO
<P>
</OL>The error message should occur at this point.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.60a FoxWin<BR>
KBCategory: kbprint kbprb<BR>
KBSubcategory: FxprintRaw<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 15, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
