

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: SELECT-SQL Error When Joining Parent to Two Child Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157254">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1996/10/09">
<META NAME="Keywords" CONTENT="buglist5.00 FxprgSql kbprg vfoxwin vfpbug5.0a kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the SELECT-SQL command with the ON clause, to Join a Parent table to two child tables, may cause the following error:     SQL: Column               is not found  If the error occurs, then a result set is not created by the query.  CAUSE =====...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBMW,QDNC,QDNA,QACI,QAAP,QBVV,QBFY,QA9N,QAY4,QAPN,QAKD,QDNU,QA6A,QAB4,QABM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SELECT-SQL Error When Joining Parent to Two Child Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157254</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the SELECT-SQL command with the ON clause, to Join a Parent table to
two child tables, may cause the following error:
<P>
<PRE>   SQL: Column &lt;column name&gt; is not found

</PRE>If the error occurs, then a result set is not created by the query.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Visual FoxPro query parser looks at the SELECT-SQL queries starting
from the innermost part of it. In the case of the SELECT..JOIN..ON
statement in the MORE INFORMATION section of this article the parser looks
at the following:
<P>
<PRE>   INNER JOIN test3 ;
      ON  test1.t1f1 = test3.t3f1 ;

</PRE>The parser cannot resolve the reference for "test1.t1f1" because it is not
in scope at this level.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can use one of the following workarounds to correct this behavior:

<OL><P><LI>Run the Query after opening all the tables involved with the query. This
   way the Visual FoxPro query parser is able to resolve all the
   references.

<P><LI>Modify the Query in the MORE INFORMATION section of this article as
   follows:
<P>
<P><PRE>      SELECT *;
<PRE></PRE>        FROM test1;
        INNER JOIN test2;
          ON  test1.t1f1 = test2.t2f1 ;
        INNER JOIN test3 ;
          ON  test1.t1f1 = test3.t3f1

</PRE></OL>With the above query, the parser is able to relate each ON clause to the
JOIN clause that it belongs to.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create and Populate three tables as following:
<P>
<P><PRE>      CREATE TABLE test1 (t1f1 c(5), t1f2 c(5))
      INSERT INTO test1 VALUES("AAAAA", "11111")
      INSERT INTO test1 VALUES("BBBBB", "22222")
</PRE><P>
<P><PRE>      CREATE TABLE test2 (t2f1 c(5), t2f2 c(5))
      INSERT INTO test2 VALUES("AAAAA", "A1A1")
      INSERT INTO test2 VALUES("AAAAA", "A2A2")
</PRE><P>
<P><PRE>      CREATE TABLE test3 (t3f1 c(5), t3f2 c(5))
      INSERT INTO test3 VALUES("BBBBB", "B1B1")
      INSERT INTO test3 VALUES("BBBBB", "B2B2")
</PRE>
<P><LI>Issue the "CLOSE ALL" command in the Command window to Close all the
   tables.

<P><LI>Issue the following SQL Statement:
<P>
<P><PRE>      SELECT *;
<PRE></PRE>        FROM  test1;
        INNER JOIN test2;
           INNER JOIN test3 ;
           ON  test1.t1f1 = test3.t3f1 ;
        ON test1.t1f1 = test2.t2f1

</PRE></OL>The above command produces the "SQL: Column 'T1F1' is not found" error, and
a result set is not created.
<P>
When creating a query to Join a Parent table to two child tables using the
View Designer, the SQL statement that is built is similar to the one in
step 3. Because of this, the View Designer is not able to process the query
correctly.
<P>
The above article discusses the correct syntax for a select based on a
parent, child and grandchild relationship.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q156667.htm">Q156667</A></B>
   TITLE     : Limitations of View Designer vs. CREATE SQL VIEW Command
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist5.00 FxprgSql kbprg vfoxwin vfpbug5.0a kbbuglist kbprg<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
