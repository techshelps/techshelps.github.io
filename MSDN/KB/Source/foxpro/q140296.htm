

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use a KeyPress Event in Lieu of ON KEY LABEL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140296">
<META NAME="KBModify" CONTENT="1995/12/19">
<META NAME="KBCreate" CONTENT="1995/11/28">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Many developers use ON KEY LABEL to assign programs or procedures within programs that are to be executed upon pressing a specific key (usually a function key). However, if the ON KEY LABEL assignment is to be specific to a control within a form, a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBUD,QBV4,QAH4,QAPN,QBT6,QAHP,QAO4,QAMB,QAQT,QACI,QAC2,QAMN,QABG,QABA,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use a KeyPress Event in Lieu of ON KEY LABEL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 19, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140296</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Many developers use ON KEY LABEL to assign programs or procedures within
programs that are to be executed upon pressing a specific key (usually a
function key). However, if the ON KEY LABEL assignment is to be specific to
a control within a form, a better alternative would be to use the KeyPress
event of that control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The KeyPress event is available for the following form controls:
<P>
<PRE>   CheckBox, ComboBox, CommandButton, EditBox, Form, ListBox, OptionButton,
   Spinner, TextBox

</PRE>It is possible to use this event to check for the press of a specific key.
When using the KeyPress event to perform an action based on a function key,
the function key's value should be used as shown in this table:
<P>
<PRE>   Key     Alone   Shift    Ctrl    Alt
   ------------------------------------
   F1        28      84      94     104
   F2        -1      85      95     105
   F3        -2      86      96     106
   F4        -3      87      97     107
   F5        -4      88      98     108
   F6        -5      89      99     109
   F7        -6      90     100     110
   F8        -7      91     101     111
   F9        -8      92     102     112
   F10       -9      93     103     113
   F11      133     135     137     139
   F12      134     136     138     140

</PRE>For more information on key values, refer to the INKEY() function in
Visual FoxPro Help file.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following steps show how to use the KeyPress event.

<OL><P><LI>Create a form, and place a text box on it.

<P><LI>In the ControlSource property of the text box, type mykey (or any other
   variable that you might prefer).

<P><LI>Place the following code in the KeyPress event of the text box:
<P>
   LPARAMETERS nKeyCode, nShiftAltCtrl
   *: The previous line of code is already contained in the KeyPress event
   *: by default.
   DO CASE
<P>
<P><PRE>      CASE nKeyCode = 28
<PRE></PRE>         WAIT WINDOW "The F1 Key has been pressed" NOWAIT
         mykey = "F1 Key"
         ThisForm.Refresh

      CASE nKeyCode = -4
         WAIT WINDOW "The F5 Key has been pressed" NOWAIT
         mykey = "F5 Key"
         ThisForm.Refresh

   ENDCASE

</PRE><P><LI>Place the following code in the Load event of the form:
<P>
   CLEAR MACROS
   SET HELP OFF
   *: This will disable FoxPro's default function key assignments.

<P><LI>Place the following code in the Destroy event of the form:
<P>
   RESTORE MACROS
   SET HELP ON
   *: This will restore FoxPro's default function key assignments.

<P><LI>Place a command button on the form, and place the following code in its
   click event:
<P>
   ThisForm.Release

<P><LI>Save and run the form. If either the F1 or F5 key is pressed, the
   appropriate WAIT WINDOW messages should appear, and the text box should
   be updated.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 19, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
