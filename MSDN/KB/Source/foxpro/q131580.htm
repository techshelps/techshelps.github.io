

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ODBC Converts Microsoft Excel Character Data to Memos </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131580">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/06/14">
<META NAME="Keywords" CONTENT="kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using the Microsoft Excel ODBC driver (from the Microsoft Desktop Database Drivers version 2.0) to perform a query against a Microsoft Excel spreadsheet, a Visual FoxPro table or cursor is produced. This table or cursor contains the requested ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA7N,QA7O,QACI,QAY2,QA56,QA55,QA9E,QAYY,QA5V,QAGI,QAE1,QADX,QAJP,QBQU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ODBC Converts Microsoft Excel Character Data to Memos</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131580</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the Microsoft Excel ODBC driver (from the Microsoft Desktop
Database Drivers version 2.0) to perform a query against a Microsoft Excel
spreadsheet, a Visual FoxPro table or cursor is produced. This table or
cursor contains the requested data from the Microsoft Excel spreadsheet. If
a cell contains text, that text will appear inside memo fields in the
resulting Visual FoxPro table or cursor.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the data is passed to Visual FoxPro from ODBC, the resulting column is
255 characters wide. Visual FoxPro cannot place more than 254 characters in
a character field. Therefore, the data must be placed into a memo field.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Add a character field to the table that contains the results of the query.
Replace that character field with the contents of the memo field.
<P>
For example, if the resulting table contains a memo field called sqlmemo,
add a character field with the name sqlchar to the table. Then use the
following command to copy the data from the memo field to the character
field:
<P>
<PRE>   REPLACE ALL sqlchar WITH TRIM(sqlmemo)

</PRE>Then remove the memo field from the table.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Microsoft Excel version 5.0, create a workbook called ONE.XLS.

<P><LI>Place the word "this" in column 1, row 1 of Sheet1.

<P><LI>Place the word "one" in column 1, row 2 of Sheet1.

<P><LI>Place the word "two" in column 1, row 3 of Sheet1.

<P><LI>Place the word "three" in column 1, row 4 of Sheet1.

<P><LI>Save the workbook as ONE.XLS.

<P><LI>Create a data source called "excel" using the Microsoft Excel ODBC
   driver. The data source should point to the ONE.XLS file saved in step
   6.

<P><LI>Exit from Microsoft Excel, and start Visual FoxPro.

<P><LI>Enter the following commands in the Command window:
<P>
   h = SQLCONNECT("excel32","","")
   ? SQLEXEC(h,'SELECT * FROM "Sheet1$" Sheet1_')
   BROWSE
<P>
   You will see that the Microsoft Excel cells are presented as memo
   fields.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbinterop kbprb<BR>
KBSubcategory: FxinteropExcel<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
