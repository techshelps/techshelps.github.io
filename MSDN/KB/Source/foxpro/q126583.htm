

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Printer Setup Is Disabled When Using _MFI_SETUP in Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126583">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/02/26">
<META NAME="Keywords" CONTENT="kbprg kbprb kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Printer Setup option of your menu is disabled.  CAUSE =====  The system menu option  _MFI_SETUP  exists as a menu command in your menu. When there is no text to be printed in the active window, FoxPro disables the Printer Setup option menu choi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDIZ,QBXS,QAH4,QDI2,QDL9,QBWQ,QBWO,QBWN,QANE,QAVI,QBV8,QBTX,QAOX,QACT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Printer Setup Is Disabled When Using _MFI_SETUP in Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126583</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Printer Setup option of your menu is disabled.
<P>
<P><h2>CAUSE</h2>
 
<P>
The system menu option "_MFI_SETUP" exists as a menu command in your menu.
When there is no text to be printed in the active window, FoxPro disables
the Printer Setup option menu choice, and because the _MFI_SETUP variable
is context-aware, it is enabled and disabled accordingly.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use one of the following three workarounds:

<UL><LI>Use the SYS(1037) function. This is the best workaround, but it works
   only if you are using version 2.6 or later of FoxPro for Windows or
   version 2.5 or later of FoxPro for Macintosh.
<P>
   To invoke the printer setup dialog regardless of what is displayed on
   the screen, use the following code as a Command in your menu:
<P>
   ? SYS(1037)
<P>
   The Help file for FoxPro version 2.6 and 2.6a, in both the MS-DOS
   and Windows versions, is partially incorrect in that it states that this
   command is Macintosh-specific and will be ignored in the Windows and
   MS-DOS Versions of FoxPro. SYS(1037) works in FoxPro versions 2.6 and
   2.6a for Windows, but not in other versions.
<P>
   -or-

<LI>Issue the command "Set PDSETUP TO '?'" (without the double-quotation
   marks) as the command for your menu pad. This invokes the MS-DOS printer
   driver setup without invoking the Windows Printer Setup.
<P>
   -or-

<LI>Issue the RUN command as in this example:
<P>
   RUN /N7 CONTROL MAIN.CPL PRINTERS
<P>
   This invokes the Control Panel, Printers option. However this is a less
   desirable workaround because, as noted in article <B><A HREF="../FOXPRO/Q101154.htm">Q101154</A></B>, this
   causes the control panel to flash momentarily in the background. This
   command is specific to Windows only.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create and run a program containing the following code:
<P>
<PRE>   **---------------------------------------------------------**
   ** Place this code in a file called MENU.MPR               **
   **---------------------------------------------------------**
   SET SYSMENU TO
   SET SYSMENU AUTOMATIC
   DEFINE PAD testpad OF _msysmenu PROMPT "System" COLOR SCHEME 3
   ON PAD testpad OF _msysmenu ACTIVATE POPUP SYSTEM
   DEFINE POPUP SYSTEM MARGIN RELATIVE SHADOW COLOR SCHEME 4
   DEFINE BAR _mfi_setup OF SYSTEM PROMPT "Printer Setup..."

   **--------------------------------------------------------**
   ** Place this code in a file called MENU.PRG              **
   **--------------------------------------------------------**
   Terminate = .F.
   ON KEY LABEL f5 Do Stopit
   DO menu.mpr
   READ VALID terminate
   SET SYSMENU TO DEFAULT

   Procedure Stopit
   STORE .T. TO terminate
   clear Read

</PRE>While running the program, you can access the menu pad labeled SYSTEM, but
the Printer Setup option is disabled.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin 2.50 2.50a 2.50b 2.60<BR>
2.60a _MFI_SETUP<BR>
PDSETUP print menu setup exe disabled<BR>
KBCategory: kbprg kbprb kbdocerr<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
