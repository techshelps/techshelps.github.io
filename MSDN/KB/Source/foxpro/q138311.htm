

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Mapi Session Control and Exchange May Cause Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138311">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/10/16">
<META NAME="Keywords" CONTENT="kbole kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the MAPI Session Control that comes with Visual FoxPro 3.0 and Exchange that comes with Windows 95 may result in the following error when you attempt to log on:     OLE Idispatch exception code 0 from MSMAPI32: Login has failed  The following...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAL7,QAPN,QAAP,QA9Q,QA7O,QAOE,QAMN,QAB5,QDJ2,QA56,QA55,QAUJ,QANE,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Mapi Session Control and Exchange May Cause Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138311</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the MAPI Session Control that comes with Visual FoxPro 3.0 and
Exchange that comes with Windows 95 may result in the following error when
you attempt to log on:
<P>
<PRE>   OLE Idispatch exception code 0 from MSMAPI32: Login has failed

</PRE>The following error occurs if the LogonUI property is set to false (.F.):
<P>
<PRE>   The profile name is incorrect.

</PRE>This warning appears if anything other than the profile name is entered
into the Username property. The Password property is ignored.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Mapi.ocx file that ships with Visual FoxPro 3.0 is only compatible with
Microsoft Mail, not with Exchange. The Mapi.ocx file and Microsoft Mail use
an earlier version of MAPI, whereas Exchange uses MAPI version 1.0.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this incompatibility, do one of the following:

<UL><LI>Have a session of Exchange currently running; then the error messages
   will not appear.

<LI>Place the profile name in the Username property. This avoids the warning
   message of "Invalid Profile name" and the Logon prompt for MS Exchange.

<LI>Use OLE Messaging by using OLE Automation to MAPI.
<P>
   For more information about using the OLE Messaging object, please see
   the September 1995 Microsoft Developer Network (MSDN) Level II CD-ROM
   compact disc, which contains the MAPI software development kit (SDK) and
   files necessary to get OLE Messaging to work with Visual FoxPro.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form, and add MAPI Session Control to the form.

<P><LI>Right-click the icon for the MAPI Session Control, and choose
   properties.

<P><LI>Clear the LogonUI check box, and select the NewSession check box.

<P><LI>Run the form. At this point, an error message appears.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin MSMAPI Mail OCX<BR>
KBCategory: kbole kbinterop kbprb<BR>
KBSubcategory: FxinteropOcx<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
