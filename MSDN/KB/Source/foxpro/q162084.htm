

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Non-Standard RETURN TO MASTER Behavior After LOCATE Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162084">
<META NAME="KBModify" CONTENT="1997/01/14">
<META NAME="KBCreate" CONTENT="1997/01/13">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In an error-handling routine of a sub-program, a RETURN TO MASTER command returns processing to the highest level running program.  An error caused by a faulty LOCATE FOR command does not result in a successful RETURN TO MASTER until after first re...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAAP,QAB4,QAOE,QAMA,QAH4,QALW,QAB9,QACI,QBV8,QAEF,QAKP,QBXT,QA9N,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Non-Standard RETURN TO MASTER Behavior After LOCATE Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162084</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In an error-handling routine of a sub-program, a RETURN TO MASTER command
returns processing to the highest level running program.
<P>
An error caused by a faulty LOCATE FOR command does not result in a
successful RETURN TO MASTER until after first returning to the command
immediately following the line that caused the error.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Copy the following two programs, and paste them into appropriately named
program (.prg) files:

<OL><P><LI>Copy the following into a program named ReturnFail:
<P>
   ** Returnfail.prg - demonstrates failure of
   ** RETURN TO MASTER in a class error method
   DEFINE CLASS returntest AS custom
<P><PRE>      PROCEDURE init
<PRE></PRE>         CLEAR
         USE HOME()+"samples\data\customer"
         ERROR 12, "MyError"
         *LOCATE FOR CustHeight="Steve" &amp;&amp; No such column in table
         =MESSAGEBOX("It didn't return to master")
      ENDPROC

      PROCEDURE error
         LPARAMTERS  nError, cMethod, nLine
         =MESSAGEBOX("The error is " + STR(nError,2,0) + ;
             " in " + cMethod +" method.")
         RETURN TO MASTER
      ENDPROC
   ENDDEFINE

</PRE><P><LI>Copy the following into a program named TryFail:
<P>
   ** Tryfail.prg - program to test the failure of
   ** RETURN TO MASTER in a class where the error is
   ** caused by a LOCATE FOR fault.
   CLEAR
   CLOSE ALL
   SET PROCEDURE TO returnfail
   oRef = CREATEOBJECT("returntest")
   =MESSAGEBOX("It did return to master")

<P><LI>Run TryFail with the command "Do tryfail" (without the quotes). Observe
   that the only message is "It did return to master."

<P><LI>Edit the program "ReturnFail" by issuing the following command:
<P>
<P><PRE>      MODIFY COMMAND returnfail
</PRE><P>
   Find the following two lines of code:
<P>
<P><PRE>      ERROR 12, "MyError"
      *LOCATE FOR CustHeight="Steve" &amp;&amp; No such column in table
</PRE><P>
   Remove the asterisk from the second line, and place an asterisk to the
   left of the first so that the lines look like:
<P>
<P><PRE>      *ERROR 12, "MyError"
      LOCATE FOR CustHeight="Steve" &amp;&amp; No such column in table
</PRE><P>
   Save that program.

<P><LI>Run tryfail again and observe the second and third messages.
<P>
</OL>An error caused by the ERROR command causes an error, and the error method
successfully issues a RETURN TO MASTER command, which successfully returns
to the highest level running program.
<P>
An error caused by a faulty LOCATE FOR command does not result in a
successful RETURN TO MASTER until after first returning to the command
immediately following the line that caused the error.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>
Additional reference words: 3.00 3.00b 5.00 vfoxwin kbdsd
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
