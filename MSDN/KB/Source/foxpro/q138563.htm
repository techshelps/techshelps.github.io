

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Form Not Cleared from Memory When Grid Has the Focus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138563">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b fixlist5.00 FxotherGeneral vfoxwin kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The RELEASE command will not release a form from memory if a grid has the focus when the form is released. The form is cleared off the screen, but _screen.formcount is not decremented, and _screen.activeform.name still shows the name of the form in...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADR,QAJX,QAEF,QANE,QADO,QBT6,QAA8,QBV4,QAI2,QAR4,QAMA,QAH4,QACF,QAMB,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Form Not Cleared from Memory When Grid Has the Focus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138563</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbprg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The RELEASE command will not release a form from memory if a grid has the
focus when the form is released. The form is cleared off the screen, but
_screen.formcount is not decremented, and _screen.activeform.name still
shows the name of the form in the Debug window. If another object on the
form, such as a text box, has the focus when the form is released,
_screen.formcount is decremented, and _screen.activeform.name is cleared.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create s program named Main.prg that contains this code:
<P>
   SET PROCEDURE TO Main.prg
   ON KEY LABEL F12 CLEAR EVENTS
   ON KEY LABEL F11 SET SYSMENU TO DEFAULT
<P>
   DO MyMenu.MPR
   READ EVENTS
<P>
   SET SYSMENU TO DEFAULT
<P>
<PRE>   PROCEDURE ClearForms                  &amp;&amp; Clear all open forms
       IF _SCREEN.FormCount &gt; 0
            FOR i = _SCREEN.FormCount TO 1 STEP -1
                 _SCREEN.Forms(i).Release
            ENDFOR
       ENDIF

</PRE><P><LI>Create a menu named MyMenu.
<P>
   a. Add a Form1 prompt that uses this command:
<P>
<P><PRE>      DO FORM Form1.SCX
</PRE><P>
   b. Add a Clear Forms prompt that uses this command:
<P>
<P><PRE>      DO ClearForms
</PRE><P>
   c. Add an Exit program prompt that uses this command:
<P>
<P><PRE>      CLEAR EVENTS
</PRE><P>
   d. Generate and save the menu in the directory where Main.prg is
<P><PRE>      located.
</PRE>
<P><LI>Create a form named Form1.
<P>
   a. Add the Customer and Orders tables located in the Vfp\Samples\Data
<P><PRE>      directory to the data environment.
</PRE><P>
   b. Drag a field from the Customer table onto the form to create a
<P><PRE>      text box.
</PRE><P>
   c. Drag the Orders table onto the form to create a grid.
<P>
   d. Save the form in the directory where Main.prg is located.

<P><LI>Open the Debug window and place _screen.formcount in the left pane.

<P><LI>Run Main.prg.

<P><LI>Click the Form1 menu, and then click the grid to give it the focus.
   _screen.formcount will equal 1. Multiple instances of Form1 can be run
   with the same result.

<P><LI>Release Form1 by clicking the Clear Forms menu. Form1 will clear off the
   screen, but _screen.formcount will still equal 1.

<P><LI>Exit the program, or click the Clear Forms menu again to return
   _screen.formcount to 0.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxotherGeneral VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00<BR>
Keywords          : buglist3.00 buglist3.00b fixlist5.00 FxotherGeneral vfoxwin kbbuglist kbfixlist kbprg<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
