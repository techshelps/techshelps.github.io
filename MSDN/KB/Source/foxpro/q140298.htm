

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Print All Detail Records in Field Order </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140298">
<META NAME="KBModify" CONTENT="1995/12/01">
<META NAME="KBCreate" CONTENT="1995/11/28">
<META NAME="Keywords" CONTENT="kbtool kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In the Visual FoxPro Report Designer, you may want to print all the records for a single field within a data grouping before printing records for the next field. This article gives you the steps to accomplish this.  MORE INFORMATION  To print all r...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAOX,QA5V,QAB9,QAUD,QA4C,QABH,QABI,QAA1,QAPF,QAH6,QAKD,QAH7,QAD7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Print All Detail Records in Field Order</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140298</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the Visual FoxPro Report Designer, you may want to print all the records
for a single field within a data grouping before printing records for the
next field. This article gives you the steps to accomplish this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To print all records of a particular field before printing the records of
another field using the Report Designer, the report must be set up in a
certain way. This example uses the Testdata!Customer table in the
Vfp\Samples\Data subdirectory. Another field can be substituted for Country
as the Grouping Field in the code example and field expressions.
<P>
These directions must be followed precisely to get the desired behavior.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a user-defined function (UDF) to handle the processing:
<P>
   a. Type the following command in the Command window to create a program
<P><PRE>      to hold the UDF:
</PRE><P>
<P><PRE>      MODIFY COMMAND countkid.prg
</PRE><P>
   b. Enter the following code in Countkid.prg:
<P>
<P><PRE>      PARAMETERS cFldname, cCountry
      cPassback=""
      nPerposn=AT(".",cFldname)
      cFldname=UPPER(SUBSTR(cFldname,nPerposn+1,LEN(cFldname)-nPerposn))
      =AFIELDS(acFnames)
      nAfldpos=ASUBSCRIPT(acFnames,ASCAN(acFnames,cFldname),1)
      SELECT * FROM CUSTOMER WHERE COUNTRY=cCountry INTO ARRAY aMyray
      anRow=ALEN(aMyray,1)
      FOR nI=1 TO anRow
<PRE></PRE>          cPassback=cPassback+ALLTRIM(aMyray(nI,nAfldpos))+CHR(13)
      ENDFOR
      RETURN cPassback

</PRE><P><LI>In the Customer.dbf table, add an index tag Country for the field
   Country. This will be used in this example for the data grouping.

<P><LI>Create a report, and add the Customer table to the Data Environment
   (DE). Set the Order property of the Cursor object within the DE to
   Country.

<P><LI>Set up a Data Grouping in the report on the Country field.

<P><LI>Add a field to the report within the detail band. In the expression for
   this field, enter:
<P>
   IIF(nMycount&lt;1,countkid("&lt;fieldname&gt;",Country),"")
<P>
   NOTE: The "&lt;fieldname&gt;" should contain the name of the field you want to
   print. For example, use Customer.Cust_id or Cust_id.

<P><LI>In the Report Expression dialog box, click the Float option, and select
   the Stretch with Overflow check box.

<P><LI>Click the Print When button, and in the Print When dialog box, select No
   under Print Repeated Values and select the Remove Line if Blank check
   box for each field expression.

<P><LI>Create a report variable called nMycount, and set the following values:
<P>
   Value to Store = 0
   Initial Value = 0
   Reset = Customer.Country
   Calculation = Sum
   Check the Release after Report check box.

<P><LI>Place additional field expressions (in Step 4) for each field you want
   to print. Each field expression should be placed below the preceding
   field expression in the detail band. Within each group, all values for
   each field expression will print before the all the values for each
   subsequent field expression.
<P>
</OL><h3>General Notes</h3>
 

<UL><LI>The fieldname in quotation marks is passed to the UDF along with the
   name of the grouping field without quotation marks. In the previous
   example, "Customer.Cust_id" or "Cust_id" is passed as the first
   parameter, and Country is passed as the next parameter.

<LI>The array functions allow data manipulation within the report without
   affecting the original data. You build an expression with carriage
   returns that you then pass back to the report to print. The variable and
   IIF ensure that this UDF will run once only for each record processed.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbhowto<BR>
KBSubcategory: FxtoolRwriter<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
