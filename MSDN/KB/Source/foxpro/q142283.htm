

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Uniqueness of Index Violated When Creating Primary Index </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142283">
<META NAME="KBModify" CONTENT="1996/01/15">
<META NAME="KBCreate" CONTENT="1996/01/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After you create a Primary Index for a table that is populated with records and choose to make the structure changes permanent, the following error message appears:     Uniqueness of index        is violated.  CAUSE =====  More than one record, inc...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QATJ,QA28,QAEF,QAMA,QAFO,QA7O,QA7N,QBWS,QBCT,QAGC,QAGB,QAUJ,QAKD,QDMH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Uniqueness of Index Violated When Creating Primary Index</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142283</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you create a Primary Index for a table that is populated with records
and choose to make the structure changes permanent, the following error
message appears:
<P>
<PRE>   Uniqueness of index &lt;name&gt; is violated.

</PRE><h2>CAUSE</h2>
 
<P>
More than one record, including any deleted records, contain the same value
within the field being used for the Primary Index. This also applies to the
existence of more than one blank record, whether marked for deletion or
not.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Eliminate any use of the same value within multiple records. There are many
methods you could use, but perhaps the easiest is to use a query. The
following example query will generate a cursor that contains a list of the
values that occur in more than one record of a table:
<P>
<PRE>   SELECT &lt;field name&gt; FROM &lt;table name&gt;;
      GROUP BY &lt;field name&gt;;
      HAVING COUNT(&lt;field name&gt;) &gt; 1

</PRE>For information about obtaining the number of duplicate records, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q115617.htm">Q115617</A></B>
   TITLE     : How to List Duplicate Records in a Field

</PRE>For information about deleting duplicate records, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q104332.htm">Q104332</A></B>
   TITLE     : Methods of Deleting Duplicate Records from a Database

</PRE>If duplicate records have been marked for deletion and you prefer that the
table not be packed to eliminate them, the Primary Index must contain the
following filter to ignore the deleted records:
<P>
<PRE>   !DELETED()

</PRE>For more information about reusing deleted primary key values, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q139756.htm">Q139756</A></B>
   TITLE     : Cannot Reuse Deleted Primary Key Values in Visual FoxPro

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The intent of a primary index is to never permit duplicate values on the
specified fields. For more information about primary indexes, search for
"primary index" in the Visual FoxPro Help file.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new table that has two fields. In this case, the table is
   called States and the fields are Fullname (Character, 15) and Abbrev
   (Character, 2).

<P><LI>Add the following records to the table:
<P>
<PRE>   Fullname     Abbrev
   -------------------
   Alabama      AL
   Alaska       AK
   Arizona      AZ
   Arkansas     AR

</PRE><P><LI>Add two blank records to the table, and mark them for deletion, but do
   not pack the table.

<P><LI>On the Window menu, click View Window, and if the States table isn't
   open, click Open. Then select it.

<P><LI>Click the Properties button, and from the Work Area Properties window,
   click the Modify button.

<P><LI>Click the Index tab in the Table Designer, and enter state for the Name,
   set Primary as the Type, and Fullname for the Expression.

<P><LI>Click OK. Within the message box asking to make structure changes
   permanent, click Yes. At this point, the following error appears:
<P>
   Uniqueness of index state is violated.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
