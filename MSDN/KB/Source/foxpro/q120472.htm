

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SELECT-SQL Using CMONTH() Function Truncates Month Text </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120472">
<META NAME="KBModify" CONTENT="1995/08/28">
<META NAME="KBCreate" CONTENT="1994/09/12">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a SELECT-SQL operation using the CMONTH() function on a date field, the resulting query table truncates the textual values returned by CMONTH(). For example,  September  is truncated to  Septemb .  CAUSE =====  When a SELECT-SQL statement includ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAY5,QAB9,QAKD,QA2Q,QAPN,QACE,QAUD,QAG2,QDKS,QAY2,QBWS,QAP2,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SELECT-SQL Using CMONTH() Function Truncates Month Text</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120472</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a SELECT-SQL operation using the CMONTH() function on a date field, the
resulting query table truncates the textual values returned by CMONTH().
For example, "September" is truncated to "Septemb".
<P>
<P><h2>CAUSE</h2>
 
<P>
When a SELECT-SQL statement includes the CMONTH() function, the resulting
query table translates the defined field type from the source table to the
necessary field type in the query table.
<P>
For example, if the source table has a field called "DATE" and it is
defined as having a Date type with a field length of 8, FoxPro will
translate the resulting output field that holds the results of the CMONTH()
operation into a Character type field. The first record returned by the
SELECT-SQL operation will then govern the output field's length. If the
first value returned is ten characters long, the resulting field definition
will be of type Character with a length of 10. If the first value returned
is four characters long, the resulting field definition will be of type
Character with a length of 4. In such a situation, any subsequent values
that are longer than the field definition will be truncated. This is the
expected and normal behavior of a SELECT-SQL statement and is true of any
calculated expression performed in a SELECT-SQL statement.
<P>
To demonstrate this behavior, execute the code shown below:
<P>
<PRE>   SET SAFETY OFF
   CLOSE DATABASES
   CREATE TABLE cmon (date D)

   SELECT cmon
   FOR I = 1 TO 12
      APPEND BLANK
      REPLACE cmon.date WITH CTOD(PADL(ALLTRIM(STR(I)),2,"0")+"/01/94")
   ENDFOR

   &amp;&amp; After the first SELECT has been executed, press the ESC key
   &amp;&amp; and it will process the second SELECT statement.

   SELECT CMONTH(date) AS Month FROM cmon            &amp;&amp; Truncated values
   SELECT CMONTH(date)+"       " AS Month FROM cmon  &amp;&amp; Nontruncated values

</PRE>In FoxPro, the month of September may be truncated in the first SELECT
statement since the underlying field definition in the Query table is
defined as Character with a length definition matching the length of
whatever the first value returned from the SELECT statement was. After you
press the ESC key, the second SELECT statement will be displayed. By adding
additional spaces to the CMONTH(field) expression, the underlying field
MONTH will now be long enough to hold all the values returned from the
SELECT-SQL statement.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To have sufficient length for the full text value returned by the CMONTH()
function, modify the SELECT-SQL statement by adding spaces to the
CMONTH(field) function as shown in the following example:
<P>
<PRE>   SELECT CMONTH(date)+"     " as Month FROM cmon

</PRE>Appending spaces to the field that is being converted will add enough space
to the field definition to hold the text month values returned by CMONTH().
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.00 2.50 2.50a 2.50b<BR>
2.50c 2.60<BR>
2.60a<BR>
short<BR>
cut off<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
