

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Methods of Deleting Duplicate Records from a Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104332">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/09/13">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can use a number of methods to eliminate duplicate records from a database. The method you use will be determined by the specific product being used, whether making a duplicate of the original table is feasible, and the amount of disk space ava...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QATJ,QA28,QAFO,QAPN,QAKH,QAM9,QALX,QAEF,QA7O,QA7N,QALM,QAGB,QBW5,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Methods of Deleting Duplicate Records from a Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104332</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a
<LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5, 2.5a
<LI>Microsoft FoxBASE+ for MS-DOS, version 2.01
<LI>Microsoft FoxBASE+ for the Macintosh, version 2.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use a number of methods to eliminate duplicate records from a
database. The method you use will be determined by the specific
product being used, whether making a duplicate of the original table
is feasible, and the amount of disk space available.
<P>
The three methods can be summarized as follows:

<UL><LI>Process database sequentially, determining if records are
   duplicates and manually deleting duplicate records. This method
   requires writing a program.

<LI>Create a unique index and copy the records to a new file that
   contains only unique records. This method can be performed without
   writing a program.

<LI>In FoxPro 2.0 or later, perform a SELECT DISTINCT command, which
   will create a new table with only unique records. This method can
   be performed without writing a program.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1 - Process Database Sequentially</h3>
 
<P>
This method can be used with FoxBASE+ as well as FoxPro. It requires
the least amount of disk space to perform the deletions, although it
requires a PACK command after all deletions have been completed. The
PACK command can require 3-5 times the database size in disk space.

<OL><P><LI>Create a program named DUPE.PRG with the following commands:
<P>
   * Memory variables -
   * counter = counter used to cycle through fields
   * firstrec = array containing first record to test
<PRE>   * secrec   = array containing second record to test
   USE &lt;filename&gt;

   * The following command would be modified to include all fields
   * in the data table that make a record unique.
   * Some fields may have to be converted to character fields.
   INDEX ON field1 + field2 TO temp.idx
   SET INDEX TO temp.idx
   GO TOP

   * Use two arrays to see if data has changed.
   * This program requires that all fields in each record be
   * identical in order for a record to be considered a duplicate.
   * If fewer fields were required to define a record as a duplicate,
   * the arrays would be built with only those fields required to
   * define a record as a duplicate.
   DO WHILE .NOT. EOF()   &amp;&amp; In FoxPro 2.0 and later, DO WHILE can be
      SCATTER TO firstrec &amp;&amp; replaced by more efficient SCAN.ENDSCAN
      counter = 1
      SKIP
      SCATTER TO secrec
   * Compare each array element to see if other record differs.
      DO WHILE counter &lt; FCOUNT()
         IF firstrec(counter) &lt;&gt; secrec(counter)
            EXIT
         ENDIF
          DELETE
          EXIT
      ENDDO
   ENDDO

</PRE><P><LI>Issue the following command:
<P>
<P><PRE>      DO dupe.prg
</PRE>
<P><LI>Pack the database if desired.
<P>
</OL><h3>Method 2 - Create a Unique Index and Copy the Records to a New File</h3>
 
<P>
This method can be used with FoxBASE+ as well as FoxPro.

<OL><P><LI>Issue the following commands:
<P>
<P><PRE>      USE &lt;database&gt;
      SET UNIQUE ON
</PRE>
<P><LI>Create a temporary, unique index. Modify the following command as
   necessary to include all the fields that make a unique record.
<P>
<P><PRE>      INDEX ON field1 + field2 TO TEMP.IDX
      SET INDEX TO temp.idx
</PRE>
<P><LI>If you are not using FoxPro 2.0 or later, or if maintaining the
   index expressions in the current .CDX file is not required, create
   a new file as follows. Otherwise, go to step 4.
<P>
<P><PRE>      COPY TO newtable
      USE newtable
</PRE>
<P><LI>If FoxPro 2.0 or later is being used and it is desirable to
   maintain the structure of the original .CDX file, create a new file
   as follows. Otherwise, go to step 5.
<P>
<P><PRE>      COPY TO newtable WITH CDX
      USE newtable
</PRE>
<P><LI>Copy or rename the new table, memo file, and .CDX to the original
   name. If you are renaming, delete the original file(s) first.

<P><LI>Issue the following command:
<P>
<P><PRE>      SET UNIQUE OFF
</PRE>
<P><LI>Delete TEMP.IDX if desired.
<P>
</OL>Method 3 - In FoxPro 2.0 or Later, Use SELECT
<P><h3>DISTINCT to Create New Table with Only Unique Records</h3>
 

<OL><P><LI>Issue the following command:
<P>
<P><PRE>      USE &lt;filename&gt;
</PRE>
<P><LI>Do one of the following:
<P>
<P><PRE>    - Create a new query by choosing New Query from the Run menu,
      selecting the Fields check box, selecting the No Duplicates
      check box, and choosing OK. From the Output list box, choose
      Table/DBF and type "newtable" (without the quotation marks) in
      the Name box. Choose the Do Query button to execute the query.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - Issue the following command in the Command window:
</PRE><P>
<PRE>         SELECT DISTINCT * from &lt;filename&gt; INTO TABLE newtable

</PRE><P><LI>If maintaining the index expressions in the current .CDX file is
   not required, create a new file as follows. Otherwise, go to step
   4.
<P>
<P><PRE>      COPY TO newtable
      USE newtable
</PRE>
<P><LI>If you want to maintain the structure of the original .CDX file,
   create a new file as follows. Otherwise, go to step 5.
<P>
<P><PRE>      COPY TO newtab2 WITH CDX
      USE newtab2
      APPEND FROM newtable
</PRE>
<P><LI>Copy or rename the new table, memo file, and .CDX to the original
   name. If you are renaming, delete the original file(s) first.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 1.02 2.00 2.50 2.50a<BR>
remove sql<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
