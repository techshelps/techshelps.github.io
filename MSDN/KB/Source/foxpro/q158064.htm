

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "VFP500.dll Is Invalid or Damaged" Error in VFP 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158064">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/10/23">
<META NAME="Keywords" CONTENT="kbsetup kbtool kbtshoot kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The error message  The file Vfp500.dll is invalid or damaged  appears when you try to run an executable on a machine that does not have Visual FoxPro installed This error occurs even if you have copied the Vfp500.dll file and the Vfp5enu.dll file t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDL9,QBWQ,QBWO,QBWN,QBWP,QDI2,QA9N,QASB,QBVV,QAFI,QDNN,QAY2,QAB4,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "VFP500.dll Is Invalid or Damaged" Error in VFP 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158064</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The error message "The file Vfp500.dll is invalid or damaged" appears when
you try to run an executable on a machine that does not have Visual FoxPro
installed This error occurs even if you have copied the Vfp500.dll file and
the Vfp5enu.dll file to the /Windows/System folder.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is caused by an outdated dynamic-link library (DLL). Oleaut32.dll.
When you install Visual FoxPro, this DLL gets updated.
<P>
It has not been updated on the machine to which the executable has been
copied. The Setup Wizard's setup program has not been used to install the
executable on the destination system.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the Setup Wizard to create distribution disks, and install the
application from them or create a netsetup and install from the network.
The Setup Wizard takes care of updating Oleaut32.dll.
<P>
If you choose not to use the Setup Wizard use one of the two methods
outlined below. The first method applies to Windows 95. The second method
applies to Windows NT 3.51.
<P>
NOTE: If the Windows 95 method is used on a Windows NT 3.51 machine the
machine is rendered UNBOOTABLE!
<P>
<P><h3>Windows 95</h3>
 
<P>
The outdated Oleaut32.dll file on the destination machine may be in use by
other programs. Do not replace it while Windows is active. If you wish to
just copy the Oleaut32.dll from the development machine, copy the file from
the \Windows\System folder to a disk, then boot the destination machine to
an MS-DOS prompt, and copy the file from the disk to that machine's
\Windows\System folder.
<P>
<P><h3>Windows NT 3.51</h3>
 
<P>
Do not copy the Oleaut32.dll file to the Windows\System folder!
<P>
Follow the directions under the heading "To Update the Service Pack version
of Oleaut32.dll" in the Readme.hlp file in the Visual FoxPro directory.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create an executable that runs a simple program, such as one that
   executes a WAIT WINDOW command.

<P><LI>Copy the executable to another machine that does not have Visual FoxPro
   installed on it.

<P><LI>Copy the Vfp500.dll and the Vfp5enu.dll from the development system's
   \Windows\System folder to the destination system's \Windows\System
   folder.

<P><LI>Run the executable.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbtool kbtshoot kbprb<BR>
KBSubcategory: FxenvGeneral FxsetupGeneral FxtoolDk<BR>
Additional reference words: 5.00 kbdsd VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
