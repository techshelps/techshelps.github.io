

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Formatting a Date or Time Value to Query an SQL Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145817">
<META NAME="KBModify" CONTENT="1997/05/19">
<META NAME="KBCreate" CONTENT="1996/02/07">
<META NAME="Keywords" CONTENT="FxinteropOdbc kbinterop vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro, you can format date type input data as {mm/dd/yy}, or, if you type directly in a date field, as mm/dd/yy. However, when you perform a remote query on an SQL table and format the data in this fashion, an ODBC error is the result.  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QAKD,QAH7,QAH6,QAD7,QA7O,QA7N,QADK,QABM,QAU3,QANN,QAMR,QAPF,QAFH,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Formatting a Date or Time Value to Query an SQL Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145817</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Visual FoxPro, you can format date type input data as {mm/dd/yy}, or, if
you type directly in a date field, as mm/dd/yy. However, when you perform a
remote query on an SQL table and format the data in this fashion, an ODBC
error is the result.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If, in a remote query, you pass date, time, or timestamp values to an SQL
table, you need to format the data with the following escape clauses:

<UL><LI>Date value: {d 'yyyy-mm-dd'}, where yyyy represents the year, mm the
   month, and dd the day.

<LI>Time value: {t 'hh:mm:ss'}, where hh represents the hours, mm the
   minutes, and ss the seconds.

<LI>Timestamp value: {ts 'yyyy-mm-dd hh:mm:ss'}.
<P>
</UL>In a SQL Pass Through command, you can use the following syntax to retrieve
the value of a date field:
<P>
<PRE>   =SQLEXEC( nConnHandle, "SELECT * FROM TITLES WHERE
      Titles.pubdate&lt;{ts '1995-06-12 12:55:00'}", 'MyCursor')

</PRE>You can use the following syntax to create a remote view that queries
datetime information:
<P>
<PRE>   CREATE SQL VIEW sqldate REMOTE CONNECTION sqldate AS SELECT * FROM ;
      dbo.titles WHERE Titles.pubdate&lt;{ts '1985-06-12 12:55:00'}

</PRE>In the View Designer, ensure that the date, the time, or the timestamp
values are formatted as needed in the Examples field of the Selection
Criteria tab. Once the view is saved, the information in the Examples field
is saved with the view. If the view is opened and modified, the information
disappears and has to be typed back in the Examples field.
<P>
Note that when you pass the field name (not a value) as a parameter to a
remote query, you do not receive an ODBC error because Visual FoxPro
performs a conversion.
<P>
<P><h2>REFERENCES</h2>
 
<P>
ODBC 2.0 Programmer's Reference and SDK Guide, pp.50-52, Microsoft Press.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxinteropOdbc kbinterop vfoxwin<BR>
Version             : 3.0 3.0b<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 19, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
