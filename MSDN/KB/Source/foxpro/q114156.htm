

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: "Internal Consistency Error" with BROWSE FORMAT Command </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114156">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/04/25">
<META NAME="Keywords" CONTENT="FxprgGeneral kbbuglist kberrmsg kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you double-click a memo field displayed as an @ ... SAY in a format file, an  Internal Consistency Error  occurs.  RESOLUTION  There are two workarounds for this problem. The first is to use a BROWSE PREFERENCE command instead of the BROWSE FO...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QDNG,QAAP,QAB4,QDL9,QBWQ,QBWO,QBWN,QAR4,QAKP,QBV8,QAB9,QBWT,QA7Y V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: "Internal Consistency Error" with BROWSE FORMAT Command</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114156</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.6x | 2.5x 2.6x
<PRE>WINDOWS   | MS-DOS
</PRE>kbprg kbfixlist kbbuglist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you double-click a memo field displayed as an @ ... SAY in a format
file, an "Internal Consistency Error" occurs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two workarounds for this problem. The first is to use a BROWSE
PREFERENCE command instead of the BROWSE FORMAT command. The second is to
replace the format file with a screen. Format files are included in later
versions of FoxPro only for backwards compatibility; the Screen Builder
should be used instead.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Once the error occurs, pressing the ENTER or ESC keys several times will
cause a stack fault error under Windows and will hang the machine under
MS-DOS.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start FoxPro for Windows.

<P><LI>Open the SALESMAN table in the &lt;FoxPro_directory&gt;\TUTORIAL subirectory.

<P><LI>Create a format file by issuing the following command:
<P>
<P><PRE>      MODIFY FILE format1.FMT
</PRE>
<P><LI>In this file, place the following code:
<P>
<P><PRE>      @1,1 SAY notes
</PRE>
<P><LI>Close the file.

<P><LI>In the Command window, type the following commands:
<P>
<P><PRE>      SET FORMAT TO format1.FMT
      BROWSE FORMAT
</PRE><P>
   The Browse window will appear. The word "Memo" will not appear, but the
   text will be visible.

<P><LI>Double-click one of the lines of text. The error will occur.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos VFoxWin FoxWin 2.50 2.50a 2.50b 2.60<BR>
2.60a ice errmsg err msg fixlist3.00 buglist2.50 buglist2.50a buglist2.50b<BR>
buglist2.60 buglist2.60a crash<BR>
KBCategory: kbprg kbfixlist kbbuglist kberrmsg<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kbbuglist kberrmsg kbfixlist kbprg<BR>
Version           : 2.5x 2.6x | 2.5x 2.6x<BR>
Platform          : MS-DOS WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
