

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Export Memo Fields to an ASCII File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95722 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/02/21">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The COPY TO            TYPE DELIMITED command ignores memo fields. To create an ASCII, delimited file from a .DBF file that contains memo fields, you must either convert the memo fields to character fields or use low-level file I/O commands.  MORE ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QA01,QBXS,QAPN,QBE7,QBE6,QA5V,QAP2,QAUD,QBV8,QAZV,QAY2,QAB9,QAWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Export Memo Fields to an ASCII File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95722 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The COPY TO &lt;filename&gt; TYPE DELIMITED command ignores memo fields. To
create an ASCII, delimited file from a .DBF file that contains memo
fields, you must either convert the memo fields to character fields or
use low-level file I/O commands.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples assume the .DBF file has the following
structure:
<P>
<PRE>   FIELD NAME            TYPE
   Numfield              Numeric
   Memo1                 Memo
   Charfield             Character

</PRE><h3>Method 1 (For FoxPro 2.x Only)</h3>
 
<P>
To convert the memo field to a character field:

<OL><P><LI>In the Command window, type:
<P>
<P><PRE>      USE &lt;database name&gt;
</PRE>
<P><LI>From the Database menu, choose Setup.

<P><LI>In the Setup dialog box, choose the Modify button.

<P><LI>In the Structure dialog box, add a field "Newchar" of type
   character. The length of the character field should be large enough
   to accommodate the largest memo field.

<P><LI>To save your changes, choose the OK button in the Structure dialog
   box, choose the Yes button in the "Make structure changes
   permanent?" message box, and choose the OK button in the Setup
   dialog box.

<P><LI>In the Command window, type:
<P>
<P><PRE>      REPLACE ALL newchar WITH memo1
</PRE><P>
</OL>You can now create an ASCII, delimited file from the database with the
following command:
<P>
<PRE>   COPY TO &lt;filename&gt; FIELDS numfield, charfield, newchar ;
     TYPE DELIMITED

</PRE></OL>The limitation of this method is that the maximum number of characters
allowed in a character field is 254. If the memo field is longer than
this, it will be truncated.
<P>
<P>
<P><h3>Method 1 (For Visual FoxPro)</h3>
 
<P>
To convert the memo field to a character field:

<OL><P><LI>In the Command window, type:
<P>
<P><PRE>      USE &lt;database_name&gt;! &lt;table_name&gt;
</PRE>
<P><LI>From the Window menu, choose View.

<P><LI>In the View dialog box, choose the Properties button.

<P><LI>In the Work area Properties dialog box, choose Modify.

<P><LI>In the Table designer dialog box, add a field "Newchar" of type
   Character. The length of the character field should be large enough
   to accommodate the largest memo field.

<P><LI>To save your changes, choose the OK button in the Table designer dialog
   box, choose the Yes button in the "Make structure changes
   permanent?" dialog box, and choose the OK button in the Work area
   Properties dialog box.

<P><LI>In the Command window, type:
<P>
<P><PRE>      REPLACE ALL newchar WITH memo1
</PRE><P>
</OL>You can now create an ASCII-delimited file from the database with the
following command:
<P>
<PRE>   COPY TO &lt;filename&gt; FIELDS numfield, charfield, newchar ;
     TYPE DELIMITED

</PRE></OL>The limitation of this method is that the maximum number of characters
allowed in a character field is 254. If the memo field is longer than
this, it will be truncated.
<P>
<P><h3>Method 2</h3>
 
<P>
This method uses low-level file I/O commands to create the ASCII,
delimited file. The file created is in the same format as a file
created with the COPY TO &lt;filename&gt; TYPE DELIMITED command; that is,
fields are separated by commas, and character fields are enclosed in
quotation marks. The following example assumes that the database is
named "mydata", and that the memo field is to be treated as a
character field:
<P>
<PRE>   handle=FCREATE('c:\mytext.txt')
   IF handle &lt; 0
     WAIT WINDOW "Unable to create file"
     RETURN
   ENDIF
   USE mydata
   SCAN
     *Numeric values must be converted to characters before
     *writing them to a text file.
     *The following line converts the number to a string
     =FWRITE(handle,ALLTRIM(STR(numfield))+",")
     *The following sends open quotes for the memo field
     =FWRITE(handle,CHR(34))
     x=MEMLINES(memo1)
     FOR i = 1 TO x
       =FWRITE(handle,MLINE(memo1,i))
       *The following line inserts a space before writing the next
       *line from the memo field
       =FWRITE(handle," ")
     ENDFOR
     *the following line adds close quotes and a delimiter
     *after the memo field
     =FWRITE(handle,CHR(34)+",")
     *the following line uses FPUTS to end a record with a
     *carriage return and linefeed
     =FPUTS(handle,CHR(34)+ALLTRIM(charfield)+CHR(34))
   ENDSCAN
   =FCLOSE(handle)

</PRE><h2>REFERENCES</h2>
 
<P>
FoxPro version 2.0 for MS-DOS "Interface Guide," "Modifying Database
Structure"
<P>
FoxPro version 2.0 for MS-DOS "Developer's Guide," "Low-Level File I/O"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxDos FoxWin FoxMac 2.00 2.50<BR>
2.50a 2.50b 2.60 2.60a memo export<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
