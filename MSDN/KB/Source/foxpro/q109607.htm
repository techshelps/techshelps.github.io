

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Reboot the System from Within FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109607">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/01/05">
<META NAME="Keywords" CONTENT="kbinterop kbenv kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Occasionally it may be necessary to change the AUTOEXEC.BAT or CONFIG.SYS file in order to help a FoxPro-generated .EXE file run better under Windows. By using the Windows API function ExitWindows(), you can give the user a choice of rebooting the ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDL9,QBWO,QBWN,QBWQ,QDK2,QAY5,QBV8,QBXS,QAB9,QABI,QAGQ,QDIT,QBFY,QA4Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Reboot the System from Within FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109607</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Occasionally it may be necessary to change the AUTOEXEC.BAT or CONFIG.SYS
file in order to help a FoxPro-generated .EXE file run better under
Windows. By using the Windows API function ExitWindows(), you can give the
user a choice of rebooting the system now or later.
<P>
See below for more details and a code sample.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By using FOXTOOLS.FLL and the Windows API function ExitWindows(), you can
reboot the entire system. The following code illustrates this concept.
<P>
NOTE: While it is possible to reboot the system from within a FoxPro for
Windows program by making use of the Windows API function ExitWindows(),
FoxPro may not do a complete cleanup and may leave *.TMP files in your SET
TEMP= subdirectory.
<P>
<PRE>   *** Begin Code ***
   * WARNING: Make sure all work is saved before running code

   SET LIBRARY TO SYS(2004)+"FOXTOOLS.FLL" ADDITIVE
   bootup=REGFN("ExitWindows","II","I")
   title="Program Message"
   msg="Changes have been made to your CONFIG.SYS. " + ;
      "Choose 'Yes' to reboot your system so changes can " + ;
      "take effect. Choose 'No' to continue without rebooting."
   choice=MSGBOX(msg,title,20)
   IF choice=6 &amp;&amp; button 'Yes' was chosen
      =CALLFN(bootup,67,0)
   ELSE
      WAIT WINDOW "You have chosen to continue" TIMEOUT 2
   ENDIF

   *** End Code ***

</PRE>The ExitWindows() function requires two numeric values to be passed to it
and returns a single integer. The significance of the first integer (67) is
that it is the decimal equivalent of 0x43 hexadecimal or EW_REBOOTSYSTEM,
which is a low-order word in the C++ language. The second integer is
reserved and is always zero. When the ExitWindows() function is called, it
sends a message to all active applications that a request has been made to
terminate Windows. If all applications "agree" to be terminated, the
WM_ENDSESSION message will be sent to all applications before Windows is
terminated.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Visual C++ Help file
<P>
Microsoft Windows Software Development Kit, "Programmer's Reference, Volume
2: Functions," page 290
<P>
FOXTOOLS.WRI located in the C:\FOXPROW\GOODIES\FOXTOOLS subdirectory
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxWin 2.50 2.50a 2.50b quit<BR>
restart SDK API<BR>
FOXTOOLS.FLL<BR>
KBCategory: kbinterop kbenv kbtool kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
