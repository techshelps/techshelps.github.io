

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: GotFocus &amp; Valid Events Fire Unexpectedly in Box of Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139913">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1995/11/19">
<META NAME="Keywords" CONTENT="buglist3.00 buglist5.00 FxotherGeneral kbprg vfpbug5.0a kbbuglist kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The GotFocus and Valid events of a text box in a grid column fire unexpectedly if you set the focus to the text box from outside the grid. The GotFocus event fires. Then the Valid event fires, and then the GotFocus event fires again. Then focus fin...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAPN,QAO4,QAHP,QAH4,QBFM,QADN,QADO,QBXT,QA5V,QAIB,QBXS,QAB9,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: GotFocus &amp; Valid Events Fire Unexpectedly in Box of Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139913</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The GotFocus and Valid events of a text box in a grid column fire
unexpectedly if you set the focus to the text box from outside the grid.
The GotFocus event fires. Then the Valid event fires, and then the GotFocus
event fires again. Then focus finally settles on the control. This means
that any code in the GotFocus event executes twice, and the code in the
Valid event fires before the text box has been processed. In Visual FoxPro
5.0a, the GotFocus event fires twice but the Valid event does not fire.
<P>
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use public variables or custom properties of the form to test conditionally
whether the Valid and GotFocus events should fire. The following steps
provide an example.
<P>
<P><h3>Step-by-Step Example Workaround</h3>
 

<OL><P><LI>Create a custom property called FiredFrom.

<P><LI>Set the initial value of the FiredFrom property to "".

<P><LI>Create another custom property called TimesThrough.

<P><LI>Set the initial value of TimesThrough to 0.

<P><LI>In the Click event of the command button that sets the focus to the text
   box in the grid column, add the following line of code before the call
   to the SetFocus method:
<P>
   THISFORM.FiredFrom = 'CommandBtn'

<P><LI>In the Valid event of the text box, add a conditional structure such as
   this one:
<P>
   IF THISFORM.FiredFrom = 'commandbtn'
<PRE>        THISFORM.FiredFrom = ""
   ELSE
        *do your code
   ENDIF

</PRE><P><LI>In the GotFocus event, add the following line of code as the first line:
<P>
   THISFORM.TimesThrough = THISFORM.TimesThrough + 1

<P><LI>Then add a conditional structure to the GotFocus event such as this one:
<P>
   IF THISFORM.TimesThrough &lt;= 1
<PRE>        *do your code
   ELSE
        THISFORM.TimesThrough = 0
   ENDIF

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a form, and place a grid on it.

<P><LI>Set the Column Number to 2.

<P><LI>Make the current control of the grid's second Column a text box.

<P><LI>In the GotFocus event of the text box, enter the following line of
   code:
<P>
   WAIT WINDOW "GotFocus"

<P><LI>In the Valid event of the text box, enter the following line of code:
<P>
   WAIT WINDOW "Valid"

<P><LI>Place a command button on the Form.

<P><LI>In the command button's Click event, enter the following line of code:
<P>
   THISFORM.Grid1.Column2.Text1.SetFocus

<P><LI>Save and run the Form.

<P><LI>Click the command button. The GotFocus event Wait Window appears. Then
   the Valid event Wait Window statement appears, and then the GotFocus
   event Wait Window appears again. In Visual FoxPro 5.0a, the GotFocus
   event Wait Window appears twice.
<P>
</OL><h3>Comparison Example</h3>
 
<P>
For comparison, follow these steps:

<OL><P><LI>Place a text box anywhere on the form.

<P><LI>Put the same Wait Window statements in the new text box GotFocus and
   Valid events.

<P><LI>Place a second command button on the form.

<P><LI>In the new command button's Click event, enter the following line of
   code:
<P>
   THISFORM.Text1.SetFocus

<P><LI>Save and run the Form.

<P><LI>Click the second command button to set the focus to the text box on the
   form. In this case, you only see the GotFocus event Wait Window.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist3.00 buglist5.00 FxotherGeneral kbprg vfpbug5.0a kbbuglist kbhowto kbprg<BR>
Version             : 3.0 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
