

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Printing Report with "Page # of #" Format in Footer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101016">
<META NAME="KBModify" CONTENT="1995/08/31">
<META NAME="KBCreate" CONTENT="1993/07/01">
<META NAME="Keywords" CONTENT="kbtool kbprint kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To print a report with a footer that has a  Page # of #  format, you must use a user-defined function (UDF), as explained below.  MORE INFORMATION  NOTE: This technique does not work in FoxPro 2.x for Windows.  To obtain the total number of pages, ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QABH,QAYL,QAY5,QAB9,QBV8,QBWA,QDMW,QBCI,QBWS,QBXS,QBE7,QBE6,QAOX,QDNG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Printing Report with "Page # of #" Format in Footer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 31, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101016</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5x, 2.6x
<LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To print a report with a footer that has a "Page # of #" format, you must
use a user-defined function (UDF), as explained below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This technique does not work in FoxPro 2.x for Windows.
<P>
To obtain the total number of pages, the report must be run twice as the
following code demonstrates:
<P>
<PRE>   CLEAR
   CLOSE DATABASES

   USE file.dbf
   pgcnt=0
   check=.T.

   Old_Con=SET('CONSOLE')
   SET CONSOLE OFF
   REPORT FORM filename FOR condition NOCONSOLE
   SET CONSOLE &amp;Old_Con
   REPORT FORM filename FOR condition

   PROCEDURE pgcnt
      check=.F.
      pgcnt=_PAGENO
      RETURN ''

</PRE>The CHECK variable is used to make sure that the PGCNT() function is run
only one time. The following IIF() function is required in the Summary
band:
<P>
<PRE>   IIF(CHECK=.T.,PGCNT(),'')

</PRE>The IIF() function checks to see if the CHECK variable is true the first
time it runs the report; if CHECK is true, it will run the PGCNT()
function. The PGCNT() function simply stores the _PAGENO variable to
another variable called PGCNT. In the final report, PGCNT will then have
the correct value.
<P>
On the report layout, the footer would contain:
<P>
<PRE>   Page _PAGENO of PGCNT

</PRE><h2>REFERENCES</h2>
 
<P>
"Commands &amp; Functions," version 2.0, page C3-662
"Language Reference," version 2.5, page L3-820
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin FoxDos 1.02 2.00 2.50 2.50a 2.50b 2.60<BR>
2.60a 3.00 no num header page # of # page number report count current<BR>
RWriter<BR>
KBCategory: kbtool kbprint kbprg kbcode<BR>
KBSubcategory: FxtoolRwriter<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 31, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
