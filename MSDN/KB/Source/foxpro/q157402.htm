

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Use Config.fpw Files with OLE Automation Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157402">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/10/10">
<META NAME="Keywords" CONTENT="kbusage kbprg kbinterop kbole kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to reference specific configuration variables when Visual FoxPro is set up as an OLE Automation Server. When you define an OLE server, you can either reference the Visual FoxPro Application object or create custom OLE cla...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9Q,QDKI,QAPN,QA2K,QA56,QA55,QAW6,QAA1,QAKR,QAHE,QDI2,QABI,QAJQ,QBFY,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Use Config.fpw Files with OLE Automation Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157402</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to reference specific configuration variables
when Visual FoxPro is set up as an OLE Automation Server. When you define
an OLE server, you can either reference the Visual FoxPro Application
object or create custom OLE classes. These two types of OLE objects require
different methods to read environment settings.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual FoxPro exposes FoxPro as an OLE server. The Application object
provides the top level of the hierarchy. For example, in an OLE client
application, you can run the following command to create an OLE object:
<P>
<PRE>   CREATEOBJECT("VisualFoxPro.Application")

</PRE>If you are referencing the VisualFoxPro.Application object, the normal
configuration file conventions are adopted since an instance of Vfp.exe is
launched (assuming you use CreateObject() and not GetObject()). This means
it references the Config.fpw file in the default directory, or you can add
to a registry key the -C startup switch that specifies the path to the
Config.fpw file. The registry key to modify follows:
<P>
<PRE>   HKEY_CLASSES_ROOT\CLSID\{GUID}\LocalServer32

</PRE>The GUID is different for every install of Visual FoxPro. The Value of this
key is as follows:
<P>
<PRE>   C:\VFP5\VFP.EXE /automation -CC:\CONFIG.FPW

</PRE>When you create your own custom OLE Automation servers, the OLE classes you
create are delivered in either a .dll or an .exe file. Before you build the
.exe or .dll, add the Config.fpw file into the project and make sure it is
marked as included. At run time, the Config.fpw that resides inside of the
.exe or .dll file is used.
<P>
To specify a different Config.fpw file once an OLE Automation Server is
distributed, you can use the same procedure as above and modify the
registry key for the OLE server.
<P>
NOTE: If you have included the Config.fpw file in the project, the -C
switch is ignored.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbprg kbinterop kbole kbhowto<BR>
KBSubcategory: FxenvConfigfp<BR>
Additional reference words: 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
