

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Capture Input in a Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140652">
<META NAME="KBModify" CONTENT="1996/10/17">
<META NAME="KBCreate" CONTENT="1995/12/05">
<META NAME="Keywords" CONTENT="kbtool kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro allows you to use combo boxes in Forms to select or input data within the form. Combo boxes allow data to be derived from several sources: value, alias, SQL statements, queries, arrays, fields, files, structures, and popups. This arti...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAKD,QACI,QAHP,QBV3,QAYY,QAB9,QA7O,QA7N,QAY4,QAY2,QBWS,QA2Q,QBT6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Capture Input in a Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140652</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual FoxPro allows you to use combo boxes in Forms to select or input
data within the form. Combo boxes allow data to be derived from several
sources: value, alias, SQL statements, queries, arrays, fields, files,
structures, and popups. This article shows an example of how to input
information that may not be contained in the ComboBox drop down and change
a field value in a table with the value entered in the combo box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The steps below will demonstrate how to input data into a ComboBox and
store it to a field in a table if the value has changed:

<OL><P><LI>Create a new Form, and place the following code in its Load event
   procedure:
<P>
   PUBLIC ARRAY aTitle(1)
   SELECT DISTINCT(customer.contact) FROM customer ;
<P><PRE>      INTO ARRAY aTitle
</PRE>
<P><LI>Add the Customer table from Vfp\Samples\Mainsamp\Data to the Data
   Environment of the form.

<P><LI>Place a text box on the form, and set its ControlSource property to:
<P>
   Customer.Contact

<P><LI>Place a combo box on the form. Set its RowSource property to aTitle
   and its RowSourceType property to 5 - Array.

<P><LI>In the InteractiveChange procedure, type the following lines of code:
<P>
   IF Customer.Contact != Thisform.combo1.DisplayValue
<P><PRE>      REPLACE Customer.Contact WITH Thisform.combo1.DisplayValue
      Thisform.Text1.Refresh
      SELECT DISTINCT(customer.contact) FROM customer ;
<PRE></PRE>         INTO ARRAY aTitle
   ENDIF

</PRE><P><LI>In the LostFocus procedure, type the following lines of code:
<P>
   IF Customer.Contact != Thisform.combo1.DisplayValue
<P><PRE>      REPLACE Customer.Contact WITH Thisform.combo1.DisplayValue
      Thisform.Text1.Refresh
      SELECT DISTINCT(customer.contact) FROM customer ;
<PRE></PRE>         INTO ARRAY aTitle
   ENDIF
   thisform.combo1.displayvalue=""

</PRE><P><LI>Add a command button to the form, and type the following code into its
   Click event procedure:
<P>
   SKIP
   ThisForm.Combo1.DisplayValue=Customer.Contact
   ThisForm.Refresh

<P><LI>Add another command button to the form, and place the following code in
   its Click event procedure:
<P>
   SKIP -1
   ThisForm.Combo1.DisplayValue=Customer.Contact
   ThisForm.Refresh

<P><LI>Save and run the form. Change the value in the combo box, and skip
   through the table using the command buttons. Close the form, and browse
   the Customer table. Look at the Contact field. The changes entered
   in the combo box will be reflected in the field.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information about this topic, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q139769.htm">Q139769</A></B>
   TITLE     : How To Add a New Value to a List of Values in a Combo Box
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxMac 3.00b 3.00 VFoxWin<BR>
KBCategory: kbtool kbhowto kbcode<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 17, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
