

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Set the Color and Font of Grid Rows Conditionally </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132549">
<META NAME="KBModify" CONTENT="1995/07/31">
<META NAME="KBCreate" CONTENT="1995/07/17">
<META NAME="Keywords" CONTENT="kbprg kbui kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro provides several dynamic properties that allow control over the appearance of information contained in grid columns. These properties are collectively referred to as dynamic properties.  This article shows by example how to use a comb...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAPG,QAG9,QARR,QA5V,QAPF,QBXS,QAVQ,QABO,QAUY,QAE1,QADF,QAZV,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Set the Color and Font of Grid Rows Conditionally</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132549</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual FoxPro provides several dynamic properties that allow control over
the appearance of information contained in grid columns. These properties
are collectively referred to as dynamic properties.
<P>
This article shows by example how to use a combination of the dynamic
properties, the SETALL method, and an IIF statement to change the color or
font of entire rows in the grid that meet a predetermined condition.
<P>
The dynamic properties include:
<P>
<PRE>   DynamicForeColor
   DynamicBackColor
   DynamicFontName
   DynamicFontSize
   DynamicFontBold
   DynamicFontItalic
   DynamicFontStrikethru
   DynamicUnderline
   DynamicAlignment
   DynamicCurrentControl

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following program creates a form and places a grid on it. The grid
object displays information from the Customer table in the Tastrade
database. For only those customers from Washington, the code displays all
of the columns with blue text.
<P>
<P><h3>Code Sample</h3>
 
<P>
** Begin code example
<P>
OPEN DATABASE c:\vfp\samples\mainsamp\data\tastrade
<PRE>#include FOXPRO.h        &amp;&amp; used for color constants.
PUBLIC otheForm          &amp;&amp; keep form live after the program is done
otheForm = CREATEOBJECT("theForm")      &amp;&amp; make the form
otheForm.SHOW                 &amp;&amp; show the form

</PRE>DEFINE CLASS theForm AS FORM  &amp;&amp; class definition for the form
<PRE>   SCALEMODE = 0
   ADD OBJECT "testgrid" AS mygrid   &amp;&amp; add the grid to the form

   PROCEDURE INIT
      THISFORM.CAPTION = "Grid with conditional color in rows"
      THISFORM.WIDTH = 100
      THISFORM.BACKCOLOR = RGB(192,192,192)
   ENDPROC

   PROCEDURE DESTROY
      SET DATABASE TO tastrade
      CLOSE DATA
      RELEASE thisform
   ENDPROC

</PRE>ENDDEFINE
<P>
<PRE>DEFINE CLASS mygrid AS GRID      &amp;&amp; class definition for the grid
   COLUMNCOUNT= 3
   SCROLLBARS = 3
   RECORDSOURCETYPE = 0        &amp;&amp; alias
   RECORDSOURCE = "Customer"
   WIDTH = 83
   TOP = 1
   LEFT = 7
   PROCEDURE INIT              &amp;&amp; use the init procedure to set
                               &amp;&amp; appropriate column properties
      WITH THIS.column1
         .header1.CAPTION = "Customer ID"
         .WIDTH = 15
         .CONTROLSOURCE = "customer.customer_id"
      ENDWITH

      WITH THIS.column2
         .header1.CAPTION = "Company Name"
         .WIDTH = 25
         .CONTROLSOURCE = "customer.company_name"
      ENDWITH
      WITH THIS.column3
         .WIDTH = 10
         .header1.CAPTION = "Region"
         .CONTROLSOURCE = "customer.region"
      ENDWITH

   ** The following two lines of code determine the conditional
   ** row color for the grid:

      foreexpr = 'IIF(ALLTRIM(customer.region) == "WA",' + ;
         LTRIM(STR(COLOR_BLUE)) + ',' + LTRIM(STR(COLOR_BLACK)) +')'
      THIS.SETALL("DynamicForeColor",foreexpr,"Column")
   ENDPROC

</PRE>ENDDEFINE
<P>
** End code example
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbui kbcode<BR>
KBSubcategory: FxprgGrid<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
