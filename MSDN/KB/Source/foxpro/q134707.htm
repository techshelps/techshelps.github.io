

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Unbinding Grid with SetAll Method Still Displays Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134707">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1995/08/09">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxprgGrid VFoxWin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After executing the following command to unbind the grid columns from their sources of data, Visual FoxPro still shows data in a grid cell if that cell is clicked:                .           .SetAll( ControlSource ,  , Column )  CAUSE =====  The te...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QAE1,QARR,QAVX,QAVW,QAHP,QBT6,QAYY,QDMN,QDNZ,QBXS,QAPN,QA56,QA55,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Unbinding Grid with SetAll Method Still Displays Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134707</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After executing the following command to unbind the grid columns from their
sources of data, Visual FoxPro still shows data in a grid cell if that cell
is clicked:
<P>
<PRE>   &lt;form name&gt;.&lt;grid name&gt;.SetAll("ControlSource","","Column")

</PRE><h2>CAUSE</h2>
 
<P>
The text box (the default control) in the grid columns is caching the last
value it knew about.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In addition to setting the data source to nothing, you need to set the
Value property of the text boxes for the grid columns to nothing ("").
<P>
<PRE>   &lt;form name&gt;.&lt;grid name&gt;.SetAll("Value","","TextBox")

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Similar problems are encountered with other controls, such as edit boxes,
that are set as the CurrentControl for a grid column.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
NOTE: The following steps assume a working knowledge of the Visual FoxPro
Form Designer. See Chapter 9 of the Microsoft Visual FoxPro "Developer's
Guide" for more information on working with the Form Designer.

<OL><P><LI>Open the Testdata.dbc database found in the \VFP\Samples\Data directory.

<P><LI>Create a new form.

<P><LI>Add the Customer table from the Testdata database to the DataEnvironment
   of the form.

<P><LI>Add a grid object by dragging the Grid icon from the Form Controls
   toolbar and dropping it on the form.

<P><LI>Set the RecordSource property of the grid to the Customer table.

<P><LI>Save the form as Test.scx, and run it.

<P><LI>In the Command window, issue this command:
<P>
   Test.grid1.SetAll("ControlSource","","Column")

<P><LI>Click any cell in the first column of the grid to have data show up in
   that cell. Click other cells in the first column. Data should show up in
   any clicked cell, and the previous cell should appear blank. Data may or
   may not appear in the other cells of the other columns, depending on
   which cell was active when the ControlSource was set to blank (""). This
   behavior is the same, though, no matter which cell is active.

<P><LI>To keep data from showing in any of the cells, issue the following two
   commands together:
<P>
<P><PRE>      Test.grid1.SetAll("ControlSource","","Column")
      Test.grid1.SetAll("Value","","TextBox")
 </BLOCKQUOTE>


	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist3.00 buglist3.00b buglist5.00 FxprgGrid VFoxWin vfpbug5.0a kbbuglist<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
