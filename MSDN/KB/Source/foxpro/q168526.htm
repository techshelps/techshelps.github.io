

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Top-Level Form Releases Undocked Toolbars in VFP 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168526">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="buglist5.00 FxprgGeneral FxprgToolbar vfoxwin vfpfix5.0a kbcode kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro 5.0, clicking the Close button (the  x  in the upper-right corner of the form) of a Top-Level form destroys undocked toolbars. However, a docked toolbar is not destroyed. Pressing the Close button should not destroy the undocked to...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANS,QAF0,QAGB,QAAW,QAR4,QAH4,QA5E,QDL9,QBWQ,QBWO,QBWN,QBVV,QA56,QA55,QAI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Top-Level Form Releases Undocked Toolbars in VFP 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168526</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Visual FoxPro 5.0, clicking the Close button (the "x" in the upper-right
corner of the form) of a Top-Level form destroys undocked toolbars.
However, a docked toolbar is not destroyed. Pressing the Close button
should not destroy the undocked toolbar. This happens prior to the
QueryUnload event of the form and cannot be controlled by the developer.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Microsoft
Visual FoxPro version 5.0a for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Place the following code in a .prg file and run it.  A Top-Level form,
   Myform1, with a docked toolbar appears.
<P>
<P><PRE>      **** Program Example****
</PRE><P>
<P><PRE>       PUBLIC goForm
       goForm = CREATEOBJECT("myform")
       goForm.Show()
</PRE><P>
<P><PRE>       DEFINE CLASS myform AS form
<PRE></PRE>         BackColor = RGB(255,255,255)
         ShowWindow = 2
         oToolbar = .NULL.

         PROCEDURE Activate()
           IF ISNULL(THIS.oToolbar)
             THIS.oToolbar = CREATEOBJECT("mytoolbar")
             THIS.oToolbar.Show()
           ENDIF
         ENDPROC

         PROCEDURE QueryUnload()
           NODEFAULT
         ENDPROC
       ENDDEFINE

       DEFINE CLASS mytoolbar AS toolbar
         ShowWindow = 1
         ADD OBJECT mybutton AS commandbutton WITH ;
          Top = 5, ;
          Left = 5, ;
          Height = 22, ;
          Width = 24, ;
          Caption = ""

         PROCEDURE Init()
           THIS.Dock(0)
         ENDPROC
       ENDDEFINE

       ****End of Code Example****

</PRE><P><LI>While the toolbar is docked, attempt to close Myform1 by clicking the
   close button of the form. Since the QueryUnload contains the NODEFAULT
   command, the form does not close.

<P><LI>Now, undock the toolbar and attempt to close Myform1 again by clicking
   the close button of the form. The undocked toolbar disappears.
</OL> 
<PRE>Keywords          : buglist5.00 FxprgGeneral FxprgToolbar vfoxwin vfpfix5.0a kbcode kbbuglist kbfixlist
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
