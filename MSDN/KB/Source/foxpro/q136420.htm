

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create an Array of Unique Random Numbers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136420">
<META NAME="KBModify" CONTENT="1995/09/10">
<META NAME="KBCreate" CONTENT="1995/09/07">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The FoxPro RAND() function returns a random number between 0 and 1. This article shows by example how to:   - Create random numbers between 5 and 10.   - Easily create an array of random numbers between any two integers.   - Make the random numbers...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKC,QAND,QBC6,QAYV,QAUD,QAG8,QAB9,QAY5,QAKD,QBV8,QAPF,QAKH,QABL,QAWN,QA4Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create an Array of Unique Random Numbers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 10, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136420</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
<LI>Microsoft FoxPro for UNIX, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The FoxPro RAND() function returns a random number between 0 and 1. This
article shows by example how to:

<UL><LI>Create random numbers between 5 and 10.

<LI>Easily create an array of random numbers between any two integers.

<LI>Make the random numbers in an array unique.
<P>
</UL>The user-defined functions (UDFs) listed in this article demonstrate how.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a program file called Myudf.prg that contains the following code:
<P>
   FUNCTION RANDOM
   *  Returns a random number between any 2 numbers.
   *  Syntax: =RANDOM(Lower Value, Higher Value)
   *  Example:  lnX=RANDOM(5,10)
   PARAMETER anLow,anHigh
   lnRnumber=INT((RAND()*(anHigh-anLow+1))+anLow)
   RETURN lnRnumber
<P>
   FUNCTION A_RANDOM
   *  Returns an array of random numbers between any 2 numbers.
   *  The array must already be defined
<PRE>   *  Syntax:   =A_RANDOM(ArrayName,Lower Value, Upper Value)
   *  Example:  =A_RANDOM('gaMyarray',17,25)
   PARAMETER lcA_name,anLow,anHigh
   lnAlength=ALEN(&amp;lcA_name)
   FOR lni=1 TO lnAlength
     &amp;lcA_name(lni)=INT((RAND()*(anHigh-anLow+1))+anLow)
   ENDFOR
   RETURN &amp;lcA_name

   FUNCTION U_RANDOM
   *  Returns an array of unique random numbers  between any 2 numbers.
   *  The array must already be defined
   *  Syntax:   =U_RANDOM(Array Name, Lower Value, Upper Value)
   *  Example:  =U_RANDOM('gaMyarray',1,10)
   PARAMETER lcA_name,anLow,anHigh
   lnAlength=ALEN(&amp;lcA_name)
   IF lnAlength&gt;anHigh-anLow
      lnAlength=anHigh-anLow+1
   ENDIF
   &amp;lcA_name=.F.
   lni=1
   DO WHILE lni&lt;=lnAlength
      lnRnumber=INT((RAND()*(anHigh-anLow+1))+anLow)
      llNextnum=.T.
      IF lnRnumber=anLow .OR. lnRnumber=anHigh
         DO CASE
         CASE lnRnumber=anLow
            lnK=1
            DO WHILE lnK&gt;0
               anLow=anLow+1
               lnK=ASCAN(&amp;lcA_name,anLow)
            ENDDO
         CASE lnRnumber=anHigh
            lnK=1
            DO WHILE lnK&gt;0
               anHigh=anHigh-1
               lnK=ASCAN(&amp;lcA_name,anHigh)
            ENDDO
         ENDCASE
      ELSE
         lnK=ASCAN(&amp;lcA_name,lnRnumber)
         IF lnK&gt;0
            llNextnum=.F.
         ENDIF
      ENDIF
      IF llNextnum
         &amp;lcA_name(lni)=lnRnumber
         lni=lni+1
      ENDIF
   ENDDO

</PRE><P><LI>Save and Close Myudf.prg

<P><LI>Test the functions:
<P>
   a. To print a single random number between 5 and 10, type the following
<P><PRE>      in the Command window:
</PRE><P>
<P><PRE>      SET PROCEDURE TO MYUDF.PRG
      ? RANDOM(5,10)
</PRE><P>
   b. To populate an array with random numbers, type the following in the
<P><PRE>      Command window:
</PRE><P>
<P><PRE>      SET PROCEDURE TO MYUDF.PRG
      DIMENSION gaMyarray(10)
      =A_RANDOM('gaMyarray',1,10)
</PRE><P>
   c. If you want to populate an array with unique random numbers, type
<P><PRE>      the following in the Command window:
</PRE><P>
<P><PRE>      SET PROCEDURE TO MYUDF.PRG
      DIMENSION gaMyarray(10)
      U_Random('gaMyarray',1,10)
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin FoxWin FoxDos FoxUnix 2.00 2.50 2.50a<BR>
2.50b 2.50c 2.60 2.60a 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 10, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
