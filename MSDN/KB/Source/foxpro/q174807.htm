

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Editing the SQL Statement of a Remote or Local View </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174807">
<META NAME="KBModify" CONTENT="1997/10/08">
<META NAME="KBCreate" CONTENT="1997/10/06">
<META NAME="Keywords" CONTENT="FxtoolAccessory VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Sometimes a programmer may want to create a remote or local view that the View Designer cannot produce. Unfortunately, there is no way to directly edit the SQL Statement generated by a remote or local view in the Database Designer. You can paste it...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAH4,QAZV,QBWT,QABM,QBWS,QAY2,QAB9,QAAW,QAPN,QBXR,QBV8,QA9N,QANN,QALQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Editing the SQL Statement of a Remote or Local View</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174807</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes a programmer may want to create a remote or local view that the
View Designer cannot produce. Unfortunately, there is no way to directly
edit the SQL Statement generated by a remote or local view in the Database
Designer. You can paste it into a .prg file and then edit the code.
However, this will not save changes back to the database container. You can
programmatically create a view using the CREATE SQL VIEW, but then you must
set all the properties using the DBSetProp() function. An easier method is
to design as much of the view as possible within the Database Designer and
then run Gendbc.prg to obtain the code. You can then modify the SQL
statement, add the necessary changes, and write the new view back to the
database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
First, create as much of the view as possible with the View Designer. Then
run Gendbc.prg to produce code that re-creates the database and its
contents. Copy only the part of the Gendbc code that creates the local or
remote view (the CREATE SQL VIEW command) and sets its properties (the
DBSetProp functions) into another program. Now, modify the CREATE SQL VIEW
command to reflect the necessary changes. Finally, with the original
database open, run the second program file, which contains the new CREATE
SQL VIEW syntax and DBSetProp functions, to re-create the view with the
desired changes. This technique is useful with both local and remote views.
<P>
The example below uses a simple view created from the Customer table. It
modifies the view to return only customers from the USA:

<OL><P><LI>In the Command window or program file, type the following lines of code
   and run them:
<P>
<P><PRE>      MD HOME()+"..\ztest"
      USE HOME()+"samples\data\customer.dbf"
      COPY TO HOME()+"..\ztest\customer.dbf"
      CD HOME()+"..\ztest"
      CLOSE DATABASE ALL
      CREATE DATABASE Ztest
<PRE></PRE>      MODIFY DATABASE Ztest NOWAIT   &amp;&amp; NOWAIT only if in a program

</PRE><P><LI>Add the Customer table located in the ztest folder to the database.

<P><LI>Right-click on the database container and click New Local View from
   the Shortcut menu. In Visual FoxPro for Macintosh, Control+Click instead
   of right-click.

<P><LI>From the New Local View dialog box, select the New View option, then add
   the Customer table to the view, and add all the fields to the view.
   Save the view as Ztest and run the view. Note that the view has records
   from all countries in the Browse window. Close the Browse window, the
   View Designer and the Database Designer window.

<P><LI>Type the following two lines of code in the Command window:
<P>
<P><PRE>      CLOSE TABLES ALL
      SET DATABASE TO Ztest
      DO HOME()+"tools\gendbc\gendbc" WITH "Ztest"
</PRE>
<P><LI>Open the Ztest.prg file and locate the CREATE SQL VIEW command
   that creates the SQL view in the database container. Copy the CREATE
   SQL VIEW command and all the DBBSETPROP commands into a program file
   called Ztest2.prg. Change the following line from the following:
<P>
<P><PRE>      CREATE SQL VIEW "ZTEST" ;
      AS SELECT * FROM ztest!customer
</PRE><P>
   to the following:
<P>
<P><PRE>      CREATE SQL VIEW "ZTEST" ;
      AS SELECT * FROM ztest!customer WHERE country ="USA"
</PRE><P>
   This creates a view that lists only the customers whose country field
   contains "USA." Copy only the code that creates the SQL View into the
   Ztest2 program.  If you copy all the code from Ztest.prg, it will
   re-create both the table and the SQL view contained within the database.
   However, all the data for the Customer table is lost.

<P><LI>With the Ztest database still open, run the Ztest2 program file. If
   SAFETY is set off, a message appears that asks if you want to overwrite
   the Ztest view.  Answer "Yes" to this dialog box. This re-creates the
   SQL View with the changes and write it to the database container. Retain
   the Ztest2.prg program in case further changes are needed for the SQL
   View.

<P><LI>Modify the Ztest database and double-click the view. Notice that the
   view now shows only customers from the United States.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: gendbc view<BR>
Keywords          : FxtoolAccessory VFoxMac vfoxwin<BR>
Version           : MACINTOSH:3.0b; WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
