

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Calculating Years, Months, and Days Between Two Dates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130444">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1995/05/21">
<META NAME="Keywords" CONTENT="FoxDos FoxWin FxprgGeneral vfoxwin kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The program in this article shows by example how to calculate the combination of days, months, and years between two dates (starting date and ending date) passed as date parameters.  NOTE: The starting date must be an earlier date than the ending d...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QAGJ,QAYV,QAUD,QAH4,QAIJ,QAHE,QDL9,QBWQ,QBWO,QBWN,QA4F,QAPF,QAML,QADN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Calculating Years, Months, and Days Between Two Dates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130444</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50 2.50a 2.50b 2.60 2.60a 3.00| 2.50 2.50a 2.50b 2.60 2.60a
<PRE>WINDOWS                         | MS-DOS
</PRE>kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The program in this article shows by example how to calculate the
combination of days, months, and years between two dates (starting date and
ending date) passed as date parameters.
<P>
NOTE: The starting date must be an earlier date than the ending date.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To run the program, save the following code as BTWNDATE.PRG. Then issue
the following command where startdate and enddate are date values:
<P>
<PRE>   DO BTWNDATE.PRG WITH startdate, enddate

</PRE>For example:
<P>
<PRE>   DO BTWNDATE WITH {01/05/93},{01/05/95}

</PRE><h3>Code Sample</h3>
 
<P>
<PRE>   *
   * BTWNDATE.PRG
   *

   PARAMETERS startdate, enddate
   IF startdate &gt; enddate
        WAIT WINDOW "Start date must " + CHR(13) ;
        + "be earlier than End date"
        RETURN
   ENDIF
   IF PARAMETERS() &lt;&gt; 2
        WAIT WINDOW "Not Correct Number of Parameters"
        RETURN
   ENDIF

   PRIVATE  precmpdate, vyears, vmonths, vdays
   precmpdate={}
   vyears=0
   vmonths=0
   vdays=0
   * Calculate:
   *     endofmonth is the last day of month prior to month of enddate
   *
   endofmonth = CTOD(ALLTRIM(STR(MONTH(enddate))) + '/' + "01" + '/' + ;
   ALLTRIM(STR(YEAR(enddate)))) - 1
   *
   IF MONTH(startdate) &lt;= MONTH(enddate)
        vyears = YEAR(enddate) - YEAR(startdate)
        IF DAY(startdate) &lt;= DAY(enddate)
             vmonths = MONTH(enddate) - MONTH(startdate)
             vdays = DAY(enddate) - DAY(startdate)
        ELSE
             IF MONTH(startdate) = MONTH(enddate)
                  vyears = vyears - 1
             ENDIF
             vmonths = MOD(MONTH(enddate) - MONTH(startdate) - 1 + 12, 12)
             vdays = endofmonth - precmpdate + DAY(enddate)
        ENDIF
   ELSE
        vyears = YEAR(enddate) - YEAR(startdate) - 1
        IF DAY(startdate) &gt; DAY(enddate)
             vmonths = MONTH(enddate) - MONTH(startdate) + 12 - 1
             vdays = endofmonth - precmpdate + DAY(enddate)
        ELSE
             vmonths = MONTH(enddate) - MONTH(startdate) + 12
             vdays = DAY(enddate) - DAY(startdate)
        ENDIF
   ENDIF
   CLEAR
   WAIT WINDOW  CHR(13) + ;
             '  Years: '  + STR(vyears) + CHR(13) + ;
             ' Months: ' + STR(vmonths) + CHR(13) + ;
             '   Days: ' + STR(vdays) + CHR(13) + ;
             CHR(13) + ;
             ' Between ' + DTOC(startdate) + CHR(13) +;
             '     and ' + DTOC(enddate)

   RETURN

convert date

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: FxprgGeneral VFoxWin FoxWin FoxDos<BR>
Additional reference words: 3.00 2.50 2.50a 2.50b 2.60 2.60a<BR>
Keywords          : FoxDos FoxWin FxprgGeneral vfoxwin kbcode kbhowto kbprg<BR>
Version           : 2.50 2.50a 2.50b 2.60 2.60a 3.00<BR>
Platform          : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
