

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Call to MessageBox() Acts As If ALT Key Were Pressed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100561">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="FxprgFoxtools kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After the CallFn() function in FOXTOOLS.FLL is used to call the Windows MessageBox() function, the system behaves as if the ALT key were being pressed.  CAUSE =====  A zero (0) is being passed as the first parameter to the MessageBox() function. Th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAGI,QAVX,QAVW,QBV8,QAB9,QBTM,QDL9,QBWQ,QBWO,QBWN,QBXS,QBHQ,QAUD,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Call to MessageBox() Acts As If ALT Key Were Pressed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100561</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50 2.50a
WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After the CallFn() function in FOXTOOLS.FLL is used to call the
Windows MessageBox() function, the system behaves as if the ALT key
were being pressed.
<P>
<P><h2>CAUSE</h2>
 
<P>
A zero (0) is being passed as the first parameter to the MessageBox()
function. This causes the message box window to be a top-level window
belonging to Windows itself, which causes problems with the READ
command. For example, after the push button is chosen in the following
program, the keyboard acts as if the ALT key were being held down, and
nothing can be typed in the GET field.
<P>
<PRE>   DEFINE WINDOW test ;
     AT  0, 0  ;
     SIZE 15,50 ;
     SYSTEM MINIMIZE
   MOVE WINDOW test CENTER
   ACTIVATE WINDOW test
   @ 5,5 GET y ;
     SIZE 1,20 ;
     DEFAULT " "
   @ 5,30 GET x ;
     PICTURE "@*VN Call MSGBOX" ;
     SIZE 2,15 ;
     DEFAULT 1 ;
     VALID CallMBox()
   READ CYCLE
   RELEASE WINDOW test


   FUNCTION CallMBox     &amp;&amp;  X VALID
   SET LIBRARY TO SYS(2004)+"foxtools"
   mbox = regfn("MessageBox", "ICCI","I")
   result = callfn(mbox, 0, ;
     "I called the Windows MessageBox() function", ;
     "Title Bar",16)
   SET LIBRARY TO
   RETURN .T.

</PRE><h2>RESOLUTION</h2>
 
<P>
Use the MsgBox() function in FOXTOOLS.FLL to put a message window on
the screen. This function uses a format similar to that of the Windows
MessageBox() function; however, MsgBox() takes only three arguments.
In order to use this function, the CallMBox() function in the program
above must be modified as follows:
<P>
<PRE>   FUNCTION CallMBox     &amp;&amp;  X VALID
   SET LIBRARY TO SYS(2004)+"foxtools"
   result = msgbox("I called the FoxTools MsgBox() Function", ;
    "Title Bar",16)
   SET LIBRARY TO
   RETURN .T.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
With the exception of RegFn() and CallFn(), the functions provided in
FOXTOOLS.FLL are not supported by Microsoft Technical Support either
electronically or by telephone. Some of these functions have existed for a
while, but none of them have been through a true test cycle. However, as
developers, we understand that it is important to get tools out as soon as
possible, even if they are not fully supported. Microsoft provides no
warranty, expressed or implied, regarding the use of these functions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a like<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgFoxtools<BR>
Keywords          : FxprgFoxtools kbprb kbprg<BR>
Version           : 2.50 2.50a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
