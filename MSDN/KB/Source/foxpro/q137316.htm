

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SET ALTERNATE Adds Extra Spaces to the End of Each Line </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137316">
<META NAME="KBModify" CONTENT="1996/07/15">
<META NAME="KBCreate" CONTENT="1995/09/25">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the SET ALTERNATE command to output to a text file can produce a result that contains extra spaces on the end of each line.  RESOLUTION  If you don't want to see the information scroll on the screen while the text file is being created, use t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QBRZ,QAHT,QAH4,QADF,QBXT,QA5V,QAIB,QAVX,QAVW,QAMO,QAMN,QAKR,QAA8,QBNT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SET ALTERNATE Adds Extra Spaces to the End of Each Line</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137316</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the SET ALTERNATE command to output to a text file can produce a
result that contains extra spaces on the end of each line.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you don't want to see the information scroll on the screen while the
text file is being created, use this command:
<P>
<PRE>   SET CONSOLE OFF

</PRE>If you want to see the information scroll on the screen, set the
_Screen.Fontname property to a non-proportional (mono-spaced) font, such as
Courier.
<P>
By calling the SET CONSOLE OFF or setting the FontName property to a non-
proportional font, you can prevent the extra spaces from appearing in the
text file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example uses the Customer table in the Vfp\Samples\Data
directory.

<OL><P><LI>Create a program containing this code:
<P>
   CLOSE ALL
   SET SAFETY OFF
   SET CONSOLE ON
   USE C:\VFP\SAMPLES\DATA\customer.dbf
   SET ALTERNATE TO test
   SET ALTERNATE ON
   GOTO TOP
   DO WHILE !EOF()
<P><PRE>      ? ALLTRIM(cust_id)+" "+ALLTRIM(company)+" "+ALLTRIM(contact)
      SKIP
</PRE>   ENDDO
   SET ALTERNATE OFF
   CLOSE ALTERNATE
   CLOSE DATABASES
   SET SAFETY ON

<P><LI>Ensure that the _SCREEN.FontName property is set to Arial (or any
   other proportional font). This can be done using this command:
<P>
   _SCREEN.FontName="Arial"

<P><LI>Run the program. After running the program, open the Test.txt file
   and place the insertion point to determine that there are extra spaces
   added to the end of each line.
<P>
</OL><h3>Steps to Avoid Behavior</h3>
 

<OL><P><LI>To resolve the problem and display the text file on the screen as it is
   created:
<P>
   a. Add the following two lines of code to the top of the program:
<P>
<PRE>      oldfont=_SCREEN.FontName          &amp;&amp; This establishes the name
      _SCREEN.FontName="Courier"        &amp;&amp; of the current font and then
                                        &amp;&amp; sets the font to Courier.

   b. Add the following line of code to the bottom of the program:

      _SCREEN.FontName=oldfont          &amp;&amp; This sets the font back to
                                        &amp;&amp; the original setting.

   c. Run the program, and open the Test.txt file. Note that no extra
      blanks have been added to the end of each line.

</PRE><P><LI>To resolve the problem without displaying the text file on the screen as
   it is created:
<P>
   a. Change the SET CONSOLE ON line in the program to SET CONSOLE OFF.
<P>
   b. Run the program. Now you will not see the Test.txt file scroll on
<P><PRE>      the screen as it is being created. After the program completes, open
      the "text.txt" file. Note that no extra
      blanks have been added to the end of each line.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
