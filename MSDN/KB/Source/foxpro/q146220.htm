

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: The ODBC Text File Driver Only Supports INSERT Statement </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146220">
<META NAME="KBModify" CONTENT="1996/02/20">
<META NAME="KBCreate" CONTENT="1996/02/14">
<META NAME="Keywords" CONTENT="kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a scenario where a cursor is open from a Remote View or SQL Pass Through connection made through the Text File ODBC driver, if you try to modify or delete a record in that cursor, one of the following errors occurs:     Connectivity error: [Micr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QAXB,QBWS,QA9E,QA5V,QA2Q,QAEF,QACI,QBD2,QATX,QAMB,QAE1,QAC1,QAGB,QBTX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: The ODBC Text File Driver Only Supports INSERT Statement</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146220</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a scenario where a cursor is open from a Remote View or SQL Pass Through
connection made through the Text File ODBC driver, if you try to modify or
delete a record in that cursor, one of the following errors occurs:
<P>
<PRE>   Connectivity error: [Microsoft][ODBC Text Driver] Deleting data
   in an attached (or linked) table not supported by this ISAM.

   -or-

   Connectivity error: [Microsoft][ODBC Text Driver] Updating data
   in an attached (or linked) table not supported by this ISAM.

</PRE><h2>CAUSE</h2>
 
<P>
The Text File ODBC driver does not support the SQL DELETE or UPDATE
statements.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a comma-delimited text file for use as the data source for the
   ODBC driver by typing each of the following commands in the Command
   window:
<P>
   SET DEFAULT TO home()+"samples\data"
   USE customer
   COPY TO customer.csv DELIMITED  &amp;&amp; Creates comma delimited Customer file
   USE

<P><LI>Set up a Text File data source. In Windows 3.1x, do this through the
   ODBC Administrator in the Visual FoxPro program group or by using the
   ODBC icon in the Windows Control Panel. In Windows 95, do this through
   the 32 ODBC Administrator located in the ODBC program group or the
   Control Panel. In Windows NT, do this through the 32 ODBC Administrator
   in the Visual FoxPro program group or the ODBC icon in Control Panel.

<P><LI>Use the following steps to set up a Data Source for the Visual FoxPro
   table saved as a comma-delimited file in Step 1:
<P>
   a. Open the ODBC or 32 Bit ODBC Administrator icon.
<P>
   b. From the Add list, select Microsoft Text Driver, and click OK. The
<P><PRE>      ODBC Text Setup dialog box will appear.
</PRE><P>
   c. Type FoxPro Text Test in the Data Source Name, and then click the
<P><PRE>      Select Directory button.
</PRE><P>
   d. Select the Vfp\Samples\Data directory, and click OK.
<P>
   e. Click the Options button, and then click the Define Format button.
<P>
   f. In the Define Text Format dialog box, select the Customer.csv file.
<P>
   g. Click the Guess button to create a Data Type, Name, and Width for
<P><PRE>      each column of the selected file. Select each column, starting with
      F1, from the list. For each item in the list with a Data Type of
      Char, change the Width from 255 to the correct column width (if
      known). If the correct column width is not known, set each to 254
      (the value used for the purposes of this example). Either way, as
      each column width is set, click Modify. The column width for each
      Char column must be set to a value less than 255 to enable the
      column to appear in Visual FoxPro as Character rather than Memo data.
</PRE><P>
   h. When you finish, click OK in the Define Text Format dialog box, and
<P><PRE>      then click OK in the OCBC Text Setup dialog box. Then click Close in
      the Data Sources dialog.
</PRE>
<P><LI>Open the Testdata database by typing the following command in the
   Command window:
<P>
   MODIFY DATABASE testdata

<P><LI>Right-click in an empty area of the Database Designer, and select New
   Remote View. Then click the New View button.

<P><LI>Select the Available Datasources option. Then select FoxPro Text Test
   from the list, and click OK.

<P><LI>From the list of tables in the Open dialog box, select Customer.csv, and
   click OK.

<P><LI>Click the Fields tab of the View Designer, and click the Add All button.

<P><LI>Click the Update Criteria tab of the View Designer, and click the column
   next to the Key field (F1 in this example) beneath the Key to place a
   check mark there.

<P><LI>Place a check in the column under the Pencil for this same field, and
<P><PRE>    click the Update All button to make all fields updatable.
</PRE>
<P><LI>Place a check mark in the Send SQL Updates check box.

<P><LI>Right-click in the View Designer, and select Run Query

<P><LI>Edit the first record by removing the "I" from "ALFKI" in the first
<P><PRE>    record. Then press the DOWN ARROW to move the record pointer. Depending
    on the setting in the Update Using box on the Update Criteria tab, one
    of the two errors will appear. If "SQL DELETE then INSERT" is selected,
    the first error appears, while if "SQL UPDATE" is selected, the second
    appears. If Revert is selected from the error dialog box, the change
    will be backed out and the view can be closed.
</PRE><P>
</OL><h3>Notes</h3>
 
<P>
Although DELETE and UPDATE are not supported, the INSERT statement is. If
you press CTRL-Y after Revert is selected in Step 13, a new record is
added to the view. By entering data and then moving the record pointer, you
can ensure that this information is saved to the text file.
<P>
The ODBC Text File driver does not support DELETE and UPDATE statements
because ODBC depends on a unique key index to determine which record to
update or delete. The text file has no such index, so the only allowable
modifications are newly added records, which use the INSERT statement
without DELETE or UPDATE statements.
<P>
<P><h2>REFERENCES</h2>
 
<P>
ODBC DDP3.0 Help File (Odbcjet.hlp)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbinterop kbprb<BR>
KBSubcategory: FxinteropOdbc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
