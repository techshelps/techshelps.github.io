

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: APPEND BLANK on a Child Grid Does Not Display New Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141740">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/12/24">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a one-to-many form, when you want your form to have the ability to add child records into the grid, you find that clicking the grid does not allow you to scroll beyond the last record. Adding a button that uses APPEND BLANK to add a new child re...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBWS,QA9N,QAH4,QACI,QA5D,QAPN,QARR,QA7O,QAJD,QACM,QBV8,QAB9,QADZ,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: APPEND BLANK on a Child Grid Does Not Display New Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141740</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a one-to-many form, when you want your form to have the ability to add
child records into the grid, you find that clicking the grid does not allow
you to scroll beyond the last record. Adding a button that uses APPEND
BLANK to add a new child record won't add a record to the grid.
<P>
<P><h2>CAUSE</h2>
 
<P>
In a one-to-many form the grid only displays related records -- records
that have a key identical to the key of the parent. When you issue an
APPEND BLANK command, the key field in the new record is blank and is
therefore not displayed in the grid.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
After issuing an APPEND BLANK command, use REPLACE to write a value to the
key field. You can also use the INSERT command with the VALUES clause
instead of APPEND BLANK. For example, remove the asterisk from the code in
step 4 below, or use the command button in Step 5 to resolve the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to create a one-to-many form with a command button
that calls APPEND BLANK and a command button that calls INSERT.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form.

<P><LI>In the Data Environment of the form add \Vfp\Samples\Data\Orders.dbf.
   Then add the table \Vfp\Samples\Data\Orditems.dbf

<P><LI>Drag some fields from the Orders table in the data environment onto the
   form. Click the title bar of the Orditems table in the data environment,
   and drag it onto the form to create a grid.

<P><LI>Add a command button to the form, and set its Caption property to
   Append. Add the following code to the Click event of the button:
<P>
   SELECT Orditems
   APPEND BLANK
   * REPLACE order_id WITH Orders.order_id
   SELECT Orders
   THISFORM.Refresh

<P><LI>Add another command button to the form, and set its Caption property to
   Insert. Add the following code to the Click event of the button
<P>
   INSERT INTO orditems (order_id) VALUES (Orders.order_id)
   THISFORM.Refresh

<P><LI>Add a final command button to the form, and set its Caption property to
   Exit. Add the following code to the Click event of the button:
<P>
   RELEASE THISFORM

<P><LI>Click the View Classes button on the form control toolbar. Select Add
   from the menu. In Visual FoxPro 5.0, double-click the file in
   \Vfp\Samples\Classes\Buttons.vcx. Or in Visual FoxPro 3.0, double-click
   the file in \Vfp\Samples\Controls\Buttons.vcx. Select the VCR control,
   and drop it onto the form.

<P><LI>Run the form, and click the Append button.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q138559.htm">Q138559</A></B>
   TITLE     : How to Append Records to a Grid
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGrid<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
