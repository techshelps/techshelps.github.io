

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Valid Clause Not Executed When Leaving Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124921">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/01/16">
<META NAME="Keywords" CONTENT="kbprg kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When the insertion point is positioned on a popup or a list box, and then the user clicks some other object, such as a push button, code contained in the VALID clause of the popup is not executed.  CAUSE =====  VALID clauses are executed under two ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBFM,QAPN,QAW6,QAVX,QAVW,QAY5,QAH4,QBVV,QAY2,QAB9,QAAF,QAGX,QAGU,QADN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Valid Clause Not Executed When Leaving Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124921</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows versions, 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the insertion point is positioned on a popup or a list box, and then
the user clicks some other object, such as a push button, code contained in
the VALID clause of the popup is not executed.
<P>
<P><h2>CAUSE</h2>
 
<P>
VALID clauses are executed under two conditions:
<P>
- When a user attempts to leave a field.
<P>
<PRE>   -or-

</PRE>- When a user selects an item from a screen object.
<P>
In the latter case, the VALID clause is not executed in either a list
box or popup object, because tabbing out of the object or clicking another
object on the screen does not constitute leaving an object.
<P>
When an element is chosen from either of these objects, only then is the
VALID clause code executed.
<P>
Although this may seem counter-intuitive, logically this makes sense
because tabbing through a list box or popup isn't the same action as
selecting an item from the list.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To enforce the execution of Valid routines for objects like a list box or a
popup, regardless of whether or not an item was chosen, use a flag to
determine if the valid has been executed. The following steps explain how
to do this. This example assumes that the VALID clause of the list box or
popup calls a user defined procedure or function, such as listbox_valid().

<OL><P><LI>Create a flag in the WHEN of the list box or popup, and set it to False:
<P>
   lValidDone = .F.

<P><LI>In the VALID procedure or function of the list box or popup set a
   variable to True:
<P>
   lValidDone = .T.

<P><LI>In the WHEN clause of the objects that follow and precede the list box
   or popup, insert an IF statement to check the value of lValidDone:
<P>
   IF lValidDone = .F.
<P><PRE>      DO listbox_valid()  &amp;&amp; execute the list box Valid routine
</PRE>   ENDIF
<P>
</OL>The above IF...ENDIF structure may need to be used in the WHEN of any
object the user may tab to or select with the mouse after entering the list
box or popup.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
Create and run a program containing the following code:
<P>
<PRE>   DEFINE WINDOW "test" ;
        AT 0.000, 0.000 ;
        SIZE 15.615,91.400 ;
        FONT "MS Sans Serif", 8 ;
        FLOAT ;
        NOCLOSE ;
        MINIMIZE ;
        SYSTEM

   CLOSE ALL
   USE SYS(2004)+"\Tutorial\Customer" IN 1
   SELECT company FROM customer INTO ARRAY testarray

   ACTIVATE WINDOW test NOSHOW

   @ 1.846,19.200 GET popval ;
        PICTURE "@^" ;
        FROM testarray ;
        SIZE 1.538,25.167 ;
        DEFAULT 1 ;
        FONT "MS Sans Serif", 8 ;
        STYLE "B" ;
        VALID myvalid1()

   @ 2.423,50.800 GET m.test ;
        SIZE 1.000,23.200 ;
        DEFAULT " " ;
        FONT "MS Sans Serif", 8 ;
        PICTURE "@K" ;
        VALID myvalid2()

   @ 4.692,19.400 GET listval ;
        PICTURE "@&amp;N" ;
        FROM testarray ;
        SIZE 6.615,55.200 ;
        DEFAULT 1 ;
        FONT "MS Sans Serif", 8 ;
        VALID myvalid3()

   @ 12.000,19.400 GET butnval ;
        PICTURE "@*HN Test Button 1;Test Button 2;Quit" ;
        SIZE 1.769,15.000,0.667 ;
        DEFAULT 1 ;
        FONT "MS Sans Serif", 8 ;
        STYLE "B" ;
        VALID myvalid4()

   ACTIVATE WINDOW test

   READ CYCLE

   RELEASE WINDOW test

   ****************[ VALID FUNCTIONS ]****************

   FUNCTION myvalid1     &amp;&amp;  Popval VALID

   WAIT WINDOW "Executing popup Valid routine."

   FUNCTION myvalid2     &amp;&amp;  m.test VALID

   WAIT WINDOW "Executing GET field VALID routine."

   FUNCTION myvalid3     &amp;&amp;  ListVal VALID

   WAIT WINDOW "Executing list box VALID routine"

   FUNCTION myvalid4     &amp;&amp;  ButnVal VALID

   DO CASE
   CASE butnval = 1
        WAIT WINDOW "Pressed button 1"
   CASE butnval = 2
     WAIT WINDOW "Pressed button 2"
   CASE butnval = 3
        CLEAR READ
   ENDCASE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
tshoot<BR>
KBCategory: kbprg kbtshoot<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
