

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Search for Specific Text in a Memo Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117217">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1994/06/22">
<META NAME="Keywords" CONTENT="FxprgGeneral kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article demonstrates the two methods you can use to search for specific text in a memo field. The first method uses the Query Designer. The second method programmatically searches a memo field of a database and highlights a specific word or ph...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAVW,QAVX,QAH4,QATX,QAPF,QAUD,QAPN,QAMB,QBWS,QAG2,QBDM,QA5V,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Search for Specific Text in a Memo Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117217</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50 2.50a 2.50b 2.60 3.00 | 2.00 2.50 2.50a 2.50b 2.60 | 2.50b 2.50c
<PRE>WINDOWS                    | MS-DOS                     | MACINTOSH
</PRE>kbprg kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates the two methods you can use to search for
specific text in a memo field. The first method uses the Query Designer.
The second method programmatically searches a memo field of a database and
highlights a specific word or phrase. The program continues searching and
highlighting all occurrences within a memo field until all the matches are
located.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1</h3>
 
<P>
This example uses the CLIENTS database in the SAMPLE\ORGANIZE\DBFS
subdirectory interactively using the Query Designer. Open the Query
Designer (File, New, Query), and select the drop-down box under fField Name
in the Selection Criteria dialog. Scroll to the bottom of the list of
fields, and select &lt;EXPRESSION...&gt;. In the Expression window, enter the
following: "ATC("msrchstr", Notes)."
<P>
In the Criteria drop-down box, select "More Than." In the Example textbox,
type "0" (zero). When the query is performed, the cursor returns the set of
records where the searched-for string occurs in the specified field at any
location.
<P>
<P><h3>Method 2</h3>
 
<P>
This code example uses the CLIENTS database in the SAMPLE\ORGANIZE\DBFS
subdirectory. Before executing the code, open the memo field of the first
record and type the following text:
<P>
<PRE>   "This is a test of memo field text search program.
   If the test is successful, two occurrences will be found.."

</PRE>After executing the program, type "test" (without the quotation marks) in
the @ ... GET field, and press the RETURN key. The program will open the
Notes memo field and highlight each occurrence of the word "test." The
program will find two instances of the string "test" within the memo field:
<P>
<PRE>   SET TALK OFF
   msrchstr=SPACE(5)   &amp;&amp; This variable can be any size. &amp;&amp;
   USE clients
   GO TOP
   @ 1,10 GET msrchstr
   READ
      msrchstr=ALLTRIM(msrchstr)
      m.occurrence=1
      DO WHILE .t.
      mfound=AT(msrchstr,Notes,m.occurrence)
         IF mfound &gt; 0
            m.occurrence=m.occurrence+1
            MODI MEMO notes NOWAIT RANGE mfound,mfound+LEN(msrchstr)
            WAIT WINDOW 'Press any key to find next occurrence'
         ELSE
            WAIT WINDOW 'No more'
            EXIT
            ENDIF
      ENDDO
   SET TALK ON
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.50 2.50a 2.50b 2.60 3.00 VFoxWin FoxMac<BR>
                            FoxDos FoxWin highlight search find locate<BR>
                            text string<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kbhowto kbprg<BR>
Version           : 2.50 2.50a 2.50b 2.60 3.00 | 2.0<BR>
Platform          : MACINTOSH MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
