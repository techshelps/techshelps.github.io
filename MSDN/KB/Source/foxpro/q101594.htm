

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Ampersand Displays as Underscore in Popup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101594">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1993/07/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After you create a popup from an array that has strings as elements, if a element has an ampersand (*) in the string's text, the ampersand displays as  _  (an underscore) instead of  *  in the selected item box of the popup. For example, if the arr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA18,QAYL,QAY2,QA2Q,QAVX,QAVW,QAG2,QAAF,QDIZ,QBXS,QATX,QAMB,QBWS,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Ampersand Displays as Underscore in Popup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101594</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.6 and 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you create a popup from an array that has strings as elements, if a
element has an ampersand (&amp;) in the string's text, the ampersand displays
as "_" (an underscore) instead of "&amp;" in the selected item box of the
popup. For example, if the array element was "TEST1 &amp; TEST2", it would
display in the selected item box as "TEST1 _TEST2" when selected.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is caused by a feature of Windows. In Windows, an ampersand
indicates that the next character should be underlined; therefore, this
behavior also occurs in FoxPro for Windows.
<P>
To display an ampersand in Windows, you have to use two ampersands (for
example, &amp;&amp; Text). However, this workaround cannot be used in FoxPro
because a double ampersand indicates that the following text is a comment
and FoxPro should ignore the rest of the line, which usually generates a
syntax error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The best resolution for this is not to use ampersands in popups,
whether from arrays or lists. The reason for this is that the behavior
of some of the workarounds is unreliable and unpredictable.
<P>
One workaround that could be acceptable for short popups is to
create the popup from a list.
<P>
To do this,  initialize a variable in the Setup code for
each item that needs to contain an ampersand, and then put the variable
in the prompt for the popup using macro substitution.
For example, in the Setup code, place this line of code:
<P>
<PRE>   myvar="TEST1 &amp;"+"&amp; TEST2"

</PRE>And in the popup prompt's list, enter the variable preceeded by an
ampersand(for macro substitution)
<P>
<PRE>   &amp;myvar

</PRE>Items in the list that do not contain ampersands do not need to be placed
in variables. The problem with this resolution is that the items on the
list show two ampersands, not just one. But the display value just shows
one. Both ampersands get stored to the popup's variable.
<P>
There is not a good solution for this issue if the popup is from an array
and some of the array elements contain text with ampersands. Changing these
elements as above can be tried.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>From the File menu, choose New, select Screen, and then choose
   New.

<P><LI>After the Screen Builder is displayed, choose Layout from the
   Screen menu.

<P><LI>In the Screen Layout dialog box, select Code under Options, and
   then choose Screen Setup Code.

<P><LI>Enter the following screen Setup code:
<P>
<P><PRE>      DIMENSION test(2)
      test(1)="TEST1 &amp; TEST2"
      test(2)="TEST3 &amp; TEST4"
</PRE>
<P><LI>Select the Popup tool from the toolbox and place a popup on the
   screen.

<P><LI>In the Popup dialog box, select Array Popup and type "test"
   (without the quotation marks).

<P><LI>In the Variable box, type "x" (without the quotation marks), and
   then choose OK.

<P><LI>From the Program menu, choose Generate.

<P><LI>Save the changes as ZTEST.SCX.

<P><LI>After ZTEST.SPR has been generated, type the following command in
   the Command window:
<P>
<P><PRE>      DO ztest.spr
</PRE>
<P><LI>Select TEST3 &amp; TEST4 from the popup. Note that it displays as
   TEST3 _TEST4.
<P>
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60 2.0a<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgMacrosub<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
