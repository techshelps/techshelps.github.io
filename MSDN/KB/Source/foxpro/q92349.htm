

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Resolving "Structural CDX File Not Found" Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92349 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1992/11/04">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing a USE        command causes a  Structural CDX file not found  error to occur.  CAUSE =====  The associated structural .CDX file is not present in the current directory and SAFETY is on.  RESOLUTION  Use one of the following three methods to...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAEF,QAAP,QDH6,QA9N,QANJ,QDKD,QAA1,QACI,QBVV,QAPN,QAGB,QAB3,QDI1,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Resolving "Structural CDX File Not Found" Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92349 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing a USE &lt;file&gt; command causes a "Structural CDX file not found"
error to occur.
<P>
<P><h2>CAUSE</h2>
 
<P>
The associated structural .CDX file is not present in the current
directory and SAFETY is on.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use one of the following three methods to remove the reference from
the CDX file and allow FoxPro to open the DBF file:

<OL><P><LI>Choose the Ignore button instead of the Cancel button. FoxPro
   removes the reference to the structural .CDX file from the .DBF
   file header and displays a message to indicate that the reference
   was removed. FoxPro opens the database file after removing the
   reference.

<P><LI>Use SET SAFETY OFF to suppress the error message. However, because this
   method disables the file-protection facility, no warning is
   displayed when a file may be overwritten.

<P><LI>Use an ON ERROR statement to trap the structural .CDX file error.
   With the code below, FoxPro can automatically remove the reference
   without displaying an error message.
<P>
<PRE>      SET SAFETY ON                    &amp;&amp; Enable file protection.
      USE customer                     &amp;&amp; Open a DBF file.
      INDEX ON city TAG city ADDITIVE  &amp;&amp; Create structural CDX file.
      CLOSE ALL                        &amp;&amp; Close all files.
      DELETE FILE customer.cdx         &amp;&amp; Remove CDX file.

      ON ERROR WAIT WINDOW "REMOVING REFERENCE AUTOMATICALLY" NOWAIT
      *** Trap the error and print a message

      USE customer
      *** Invoke the ON ERROR routine to automatically remove the
      *** reference.

      WAIT WINDOW "OK to issue USE &lt;file&gt; now !" NOWAIT

      ON ERROR
      *** release the ON ERROR statement

   NOTE: FoxPro does not open any files after the ON ERROR statement
   removes the reference. The user must issue the USE &lt;file&gt; command
   again to access the information in the .DBF file.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxDos FoxWin 2.00 2.50 2.50a<BR>
suppress missing<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
