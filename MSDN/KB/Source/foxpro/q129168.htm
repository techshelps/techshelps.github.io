

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Recover Corrupt DataBase Container Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129168">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/19">
<META NAME="Keywords" CONTENT="kbprg kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The best way to ensure that you will be able to recover corrupt DBC files is to use proactive measures, such as frequently backing up the Database files (both the .DBC and .DCT files). The next best method is to use the GENDBC.PRG tool located in t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAW6,QAR4,QBWS,QBVV,QAAP,QANE,QAH4,QAW9,QAU7,QALW,QAIR,QAB5,QAFI,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Recover Corrupt DataBase Container Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129168</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The best way to ensure that you will be able to recover corrupt DBC files
is to use proactive measures, such as frequently backing up the Database
files (both the .DBC and .DCT files). The next best method is to use the
GENDBC.PRG tool located in the VFP\TOOLS\GENDBC subdirectory.
<P>
GENDBC.PRG is a utility that generates a custom .PRG file that can then be
executed to re-build the DataBase Container that GENDBC was run against.
The resulting .PRG file, when run, will recreate the DataBase Container to
the state prior to when GENDBC was run against it. Thus it may be necessary
to run GENDBC many times during the development life cycle to prevent loss
of work if the files are damaged.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When GENDBC.PRG is run, it creates a "generation" program file for the
current Database container. If no Database is open it will prompt for one.
<P>
To use GENDBC, execute it from the Command window. For example:
<P>
<PRE>   DO C:\VFP\TOOLS\GENDBC\GENDBC.PRG WITH 'GD_MYDBC'

</PRE>When GENDBC.PRG is finished, a program file with the same name as the
database will be created in the current directory. This program can then be
executed to recreate damaged Database (.DBC) files. For instance, in the
example above, a program named "GD_MYDBC.PRG" would be created.
<P>
If the Database (.DBC) file is corrupt or damaged at the table level (in
other words, the .DBC is a FoxPro Table (.DBF)) and it is not usable as a
FoxPro table, GENDBC will not correct the matter. The error generated in
this case is:
<P>
<PRE>   UNRECOVERABLE ERROR...FILE &lt;path&gt;\dbc_name.dbc IS NOT A
   DATABASE AT LINE &lt;line_no&gt;

</PRE>If this is the case, a third-party database repair utility will be required
to repair the DBC at the table level. However, once the file is corrected
in this manner, there is still no guarantee that the .DBC file will be
recoverable with GENDBC.PRG. Thus the importance of using GENDBC.PRG prior
to using the Database or immediately following any changes to the Database
Container.
<P>
For additional information on repairing a corrupt database, please see the
following article
in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A HREF="../FOXPRO/Q129400.htm">Q129400</A></B>
TITLE: Free Table Command Removes Table From Corrupted Database
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin  remove free damage<BR>
corrupted<BR>
KBCategory: kbprg kbtshoot<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
