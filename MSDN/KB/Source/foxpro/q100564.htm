

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create a Custom Search Screen </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100564">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="kbenv kbprg kbcode kbui">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can create a customized search screen by creating a quick screen with an End Search Screen push button, as illustrated in the example below.  MORE INFORMATION  This example uses the CUSTOMER database located in the FoxPro TUTORIAL subdirectory ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA7O,QAH4,QA7N,QAA8,QAKC,QAUD,QBC6,QAZV,QDMH,QAJQ,QBXS,QAYL,QAFR,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Custom Search Screen</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100564</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You can create a customized search screen by creating a quick screen with
an End Search Screen push button, as illustrated in the example below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This example uses the CUSTOMER database located in the FoxPro TUTORIAL
subdirectory and assumes that the database is indexed on and the order is
set to the CNO field in the CUSTOMER database. In this screen, once a CNO
number (customer number) is entered, the database will be searched for the
corresponding record(s). The information in the record will be displayed,
and you can press a key to move to the next record that has the same CNO
number, if it exists. To quit, choose the End Search Screen button.
<P>
To create this customized search screen, do the following:

<OL><P><LI>Create a quick screen.

<P><LI>Select the Use Memory Variables check box on the first screen.

<P><LI>Choose OK.

<P><LI>Create a push button that says "End Search Screen". Be sure that the
   variable you assign it doesn't match a field name.

<P><LI>In the VALID clause of the End Search Screen push button, input the
   following procedure:
<P>
<PRE>      CLEAR READ     &amp;&amp; Terminate Screen

</PRE><P><LI>Double-click each field except the CNO field and select the Say and
   Refresh options. This enables all the fields to be displayed, but
   only the CNO field that is used to enter the customer number that
   will be searched for in the database may be edited.

<P><LI>In the VALID clause of the M.CNO field, input the following
   procedure:
<P>
<P><PRE>      SEEK ALLTRIM(m.cno)  &amp;&amp; Find first CNO in the database equal to
<PRE></PRE>                           &amp;&amp; M.CNO.

      *****IS THERE A RECORD WITH THIS CNO IN THE DATABASE?
      IF FOUND()           &amp;&amp; If a record with the CNO exists,
        SCATTER MEMVAR     &amp;&amp; read record into memory variables and
        SHOW GETS          &amp;&amp; refresh the SAY fields that use the
                           &amp;&amp; memory variables.
        WAIT WINDOW 'PRESS TO SEE NEXT RECORD.'

        *****CODE TO DEAL WITH MULTIPLE RECORDS WITH SAME CNO
        *****NUMBER
        SKIP 1                   &amp;&amp; Skip to the next record.
        oldcno=m.cno
        SCATTER MEMVAR           &amp;&amp; Get the new M.CNO.
        DO WHILE oldcno = m.cno  &amp;&amp; Is the next record's CNO equal to
                                 &amp;&amp; the previous?
          SHOW GETS              &amp;&amp; Refresh the SAY fields with new
                                 &amp;&amp; information.
          WAIT WINDOW 'PRESS RETURN FOR NEXT RECORD.'
          SKIP 1                 &amp;&amp; Go to the next record and repeat
                                 &amp;&amp; same process until there are no
                                 &amp;&amp; more records with the CNO number.
          oldcno=m.cno
          SCATTER MEMVAR
        ENDDO
        m.cno=oldcno             &amp;&amp; Only show the old CNO number.
        WAIT WINDOW 'NO MORE RECORDS FOUND WITH CNO:'+oldcno
        *****END OF CODE THAT IS NEEDED FOR MULTIPLE RECORDS*****

        RETURN                &amp;&amp; Return control to screen and don't
                              &amp;&amp; execute the code below.
      ENDIF

      *****IF THE RECORD WAS NOT FOUND,
      *****BLANK THE MEMORY VARIABLES OUT AND DISPLAY NOTHING.
      SCATTER MEMVAR BLANK
      SHOW GETS
      WAIT WINDOW 'THE SPECIFIED CNO WAS NOT FOUND.'

</PRE><P><LI>From the Screen menu, choose Layout (in FoxPro for MS-DOS, choose Screen
   Layout).

<P><LI>In FoxPro for Windows, choose the Screen Setup Code button. In FoxPro
   for MS-DOS, select the Setup check box. In the setup code for the
   screen, type the following:
<P>
<P><PRE>      SCATTER MEMVAR BLANK
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos 2.00 2.50 2.50a 2.x screen search<BR>
locate<BR>
function<BR>
KBCategory: kbenv kbprg kbcode kbui<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
