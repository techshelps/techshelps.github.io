

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Use the APPEND GENERAL Command with an Imager File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152370">
<META NAME="KBModify" CONTENT="1996/10/16">
<META NAME="KBCreate" CONTENT="1996/06/12">
<META NAME="Keywords" CONTENT="kbprg kbgraphic kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to use the APPEND GENERAL command to place PICT files into a Visual FoxPro general field. It also provides some information on problems that might occur and how to correct them.  The general syntax of the APPEND GENERAL c...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH2,QAIB,QAFI,QA56,QA55,QBTI,QBJZ,QAPF,QBV8,QAB9,QA7O,QA7N,QAUR,QACI,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Use the APPEND GENERAL Command with an Imager File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152370</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to use the APPEND GENERAL command to place PICT
files into a Visual FoxPro general field. It also provides some information
on problems that might occur and how to correct them.
<P>
The general syntax of the APPEND GENERAL command to append Imager files in
Visual FoxPro is:
<P>
<PRE>   APPEND GENERAL &lt;generalfield&gt; FROM &lt;filename&gt; ;
      CLASS "Microsoft Imager 2.0 Picture"

</PRE>NOTE: This command should be all on one line. It is shown here on two lines
due to space limitations.
<P>
To determine what to enter for the CLASS clause on the APPEND GENERAL
command, modify a general field in Visual FoxPro. Then choose the Insert
Object command from the Edit menu. The items listed are the class names
that will work with the APPEND GENERAL command.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual FoxPro ships with some PICT files. They are located in the
"Microsoft Visual FoxPro:Samples:Graphics" folder. These graphics are
contained in self-extracting archive (sea) files. To follow the steps
below, double-click the Picts.sea to extract the PICT files. Store them in
the default folder specified "Picts folder."
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following steps are necessary to use the APPEND GENERAL command to
place a PICT file into a Visual FoxPro general field:

<OL><P><LI>Open the PICT file in Microsoft Imager. Imager can also open TIFF
  (Tag Image File Format) files. Open the Samples:Graphics:Pict
   Folder:Fox:ADD.PICT file.

<P><LI>From the File menu, choose Save As to save the image file. In the Save
   As dialog, change the File Type to Macintosh PICT. Select Options in the
   Save As dialog to change the attributes of the PICT file. The defaults
   are fine for purposes of this article. Saving the file out of Imager
   will change the Creator to MIMG so that OLE will work with it.

<P><LI>Save the ADD.PICT file as ADDImager.PICT. Close the PICT file in Imager.

<P><LI>In Visual FoxPro, create or open a table that has a general field.
   Append a blank record to the table, such as APPEND BLANK. In the Visual
   FoxPro Command window, issue the following command:
<P>
   APPEND GENERAL olefield FROM ;
<P><PRE>      HOME()+"Samples:Graphics:Fox:ADDImager.PICT" ;
      CLASS "Microsoft Imager 2.0 Picture"
</PRE><P>
   NOTE: The above command should be all on one line. It is shown here as
</OL>three lines due to space limitations. Your general field name and path to
the PICT file may vary.
<P>
This PICT file should Append with no problems. However, it is small. PICT
files larger than the samples shipped with Visual FoxPro may require more
memory to be allocated to Imager before they can be successfully Appended.
By default, Imager has 4096K allocated to it. Increasing this to 8192K will
allow larger PICT files to be inserted into the general field with the
APPEND GENERAL command or by going through the interface and choosing the
Insert Object command from the Edit menu when the general field has been
opened (MODIFY GENERAL olefield).
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q151636.htm">Q151636</A></B>
   TITLE     : BUG: Insert Object of an Imager file Causes Error or
               Hangs Mac

</PRE></OL>The following program can be used to automate changing the creator of the
PICT file to Imager and appending the PICTS into a general field. The
program assumes that the Picts.sea file found in the Microsoft Visual
FoxPro:Samples:Graphics folder has been unstuffed and the following is the
folder path to the Outline PICT files:
<P>
<PRE>   &lt;foxpro folder&gt;:Samples:Graphics:Picts folder:Outline

</PRE>There are only six Outline PICT files. This process can take a long time if
a large number of files are involved.
<P>
<PRE>   SET LIBRARY TO HOME()+"FoxTools.cfm"  ADDITIVE
   DIMENSION farray(1,1)
   CLEAR

   y=HOME()+"Samples:Graphics:Picts folder:Outline:*.PICT"
   x=ADIR(farray,"&amp;y")

   ? "Changing Creators of the Pict files to Imager."
   ?
   FOR i=1 TO x
   IF FxSetType(SYS(2027,HOME()+ ;
   "Samples:Graphics:Picts folder:Outline:"+farray(i,1)),"PICT","MIMG")=0
      WAIT farray(i,1)+" changed successfully" TIMEOUT 2
   ELSE
      WAIT farray(i,1)+" not changed successfully" TIMEOUT 2
   ENDIF
   ENDFOR

   SELECT 0
   CREATE TABLE OutlinePicts (descript C(32), olefield G)

   ?
   ?
   ?
   ? "Appending in the Pict files"
   ?
   FOR i=1 TO x
   APPEND BLANK
   REPLACE OutlinePicts.descript WITH farray(i,1)
   y=SYS(2027,HOME()+"Samples:Graphics:Picts folder:Outline:"+farray(i,1))
   APPEND GENERAL olefield FROM (y) CLASS "Microsoft Imager 2.0 Picture"
   WAIT farray(i,1)+" appended" TIMEOUT 2
   ENDFOR

   BROWSE NOWAIT
   SET LIBRARY TO
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b VfoxMac<BR>
KBCategory: kbprg kbgraphic kbhowto<BR>
KBSubcategory: FxprgGeneral
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
