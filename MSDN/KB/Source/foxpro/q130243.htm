

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create Persistent Relations Using ALTER TABLE SQL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130243">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/15">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To create a persistent relation after tables are created, you can use the ALTER TABLE SQL command and its associated clauses.  MORE INFORMATION  A persistent relation must meet these requirements:   - The tables participating in the persistent rela...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QBWA,QAPN,QAMA,QA28,QATJ,QBBI,QAHB,QAUJ,QAE1,QARR,QBFY,QAHT,QBVV,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Persistent Relations Using ALTER TABLE SQL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130243</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To create a persistent relation after tables are created, you can use
the ALTER TABLE SQL command and its associated clauses.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A persistent relation must meet these requirements:

<UL><LI>The tables participating in the persistent relation must reside in a
   .DBC file because a persistent relation is considered a property of the
   DBC. Each persistent relation is a record in the DBC.

<LI>The parent table must have primary-key type of index.
<P>
</UL>The ALTER TABLE SQL command can only operate on existing tables, and
persistent relations can only exist in a DBC. Therefore, you must first
create a database containing two tables, as in this example:
<P>
<PRE>   CREATE DATABASE pr_dbc
   CREATE TABLE pr_Parent (cid c(3), cfld2 c(3))
   CREATE TABLE pr_Child (cid c(3), cfld2 c(3), cfld3 c(3))
   MODIFY DATABASE

</PRE><h3>Example One: Using the ALTER TABLE SQL Command to Create a Persistent Table</h3>
 
<P>
<PRE>   ALTER TABLE pr_Parent ADD PRIMARY KEY cid TAG p_cid
   ALTER TABLE pr_Child ALTER COLUMN cid c(3) ;
      REFERENCES pr_Parent TAG p_cid

</PRE>Explanation:
<P>
The first line of code adds a primary key index to the pr_Parent table with
the ADD PRIMARY KEY clause. The first portion of ADD PRIMARY KEY identifies
the field (cid) or expression that is to be indexed. The second portion,
the TAG clause, allows a name to be specified for the index. This clause is
required if the ADD PRIMARY KEY &lt;expression&gt; is anything other than a
column name. If the ADD PRIMARY KEY &lt;expression&gt; is a column name and the
TAG clause is not used, Visual FoxPro, by default, uses the column name as
a TAG name.
<P>
The second line of code adds an ordinary index to the pr_child table on the
column (cid) specified in the ALTER COLUMN clause. The REFERENCE clause
identifies the parent table (pr_Parent) of the relation. The TAG portion of
the REFERENCES clause is optional if there already is a primary key
existing in the specified parent table.
<P>
If the primary key had is not predefined in the parent table and the TAG
clause is not used, Visual FoxPro generates this error message:
<P>
<PRE>   No Primary Key.

</PRE>In addition, the relation is not established, but the TAG is still created
in the child table. The TAG clause is more for readability than any other
reason, it doesn't serve any other function here.
<P>
<P><h3>Example Two: Using the ALTER TABLE SQL Command to Create a Persistent Table</h3>
 
<P>
<PRE>   ALTER TABLE pr_Parent ALTER COLUMN cid c(3) PRIMARY KEY
   ALTER TABLE pr_Child ALTER COLUMN cid c(3) ;
      ADD FOREIGN KEY cid TAG cc_id REFERENCES ar_parent TAG cid

</PRE>Explanation:
<P>
The first line of code adds a primary key index based on the cid column
with the default name of cid. This method does not provide a method of
naming the TAG, to name the tag see the first line of example one.
<P>
The second line establishes the persistent relation between pr_Child and
pr_Parent. It creates an index TAG on the column (cid) specified in the ADD
FOREIGN KEY clause of the command. The TAG clause, is required here and can
be used to give the TAG a more descriptive name.
<P>
The REFERENCES clause specifies the table that is to be the parent. The TAG
portion of the REFERENCES clause is optional if there is already a primary
key existing in the specified parent table. If the primary key is not
predefined in the parent table and the TAG clause is not used, Visual
FoxPro generates this error message:
<P>
<PRE>   No Primary Key.

</PRE>NOTE: The TAG clause is more for readability than any other reason, it
doesn't serve any other function here. Also, the ALTER COLUMN clause is
optional. Therefore, the second command could be:
<P>
<PRE>   ALTER TABLE pr_Child ADD FOREIGN KEY cid TAG cc_id ;
      REFERENCES ar_parent

</PRE>Note that the TAG portion of the REFERENCES clause was also dropped.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgRelation<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
