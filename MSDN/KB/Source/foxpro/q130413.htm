

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create an Updatable Cursor (View) to Update Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130413">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/05/18">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article explains how an updatable view to update the data in underlying tables can be created. As long as referential integrity rules are not violated, this example will update the underlying tables.  MORE INFORMATION  Step-by-Step Example to ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAXB,QA7O,QA7N,QBWT,QAAW,QBWS,QAC1,QBD2,QAPF,QBXS,QAZV,QAA5,QAH4,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create an Updatable Cursor (View) to Update Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130413</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how an updatable view to update the data in
underlying tables can be created. As long as referential integrity rules
are not violated, this example will update the underlying tables.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example to Create Updatable View that Updates Underlying Table</h3>
 

<OL><P><LI>Open the TestData database in SAMPLES\DATA directory. Type MODIFY
   DATABASE in the Command window to open the Database Designer.

<P><LI>Right-click the background. Then choose New Local View, and then choose
   New View.

<P><LI>Choose the CUSTOMER table from the Add Table or View list.

<P><LI>In the View Designer, click the Fields tab, and add the CUST_ID and
   COMPANY fields to the field list.

<P><LI>In the Update Criteria tab, click next to CUST_ID in the key column.
   Then click next to COMPANY in the pencil (updatable) column. Select the
   "Send SQL Updates" check box.

<P><LI>Select the Key Fields Only option.

<P><LI>Save this view as UpdCust, and leave the View Designer.

<P><LI>Right-click the view, and choose BROWSE. Change a company name, and then
   close the BROWSE. When the view is closed, the database designer becomes
   the active area.

<P><LI>In the Command window, close the view by issuing USE, or issue
   =TABLEUPDATE().

<P><LI>Right click the CUSTOMER table in the Database Designer. Choose BROWSE.
<P><PRE>    Notice that the changes made to the view's COMPANY field have been
    passed back to the CUSTOMER table's COMPANY field.
</PRE><P>
</OL>NOTE: The CUST_ID field, which is the primary key field, is not updatable.
<P>
<P><h3>Same Example in Code</h3>
 
<P>
This same View can also be created with this code:
<P>
CREATE SQL View UpdCust AS SELECT cust_id, company ;
<PRE>   FROM testdata!customer
</PRE></OL>=DBSETPROP('updcust.cust_id','Field','KeyField',.T.)
=DBSETPROP('updcust.company', 'Field','UpDatable',.T.)
=DBSETPROP('updcust.cust_id', 'Field','UpDatable',.F.)
=DBSETPROP('updcust','View','WhereType',1)
=DBSETPROP('updcust','View','SendUpdates',.T.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00  VFoxWin Cursor<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
