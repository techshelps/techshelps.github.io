

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Buffering in the TASTRADE Sample Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130656">
<META NAME="KBModify" CONTENT="1995/11/21">
<META NAME="KBCreate" CONTENT="1995/05/24">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The ORDENTRY.SCX form in the C:\VFP\SAMPLES\MAINSAMP\FORMS directory contains controls as well as a grid to create a one-to-many form from tables in the TASTRADE.DBC database.  This form uses optimistic buffering, as well as custom routines when re...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA5V,QAUR,QAH4,QAEF,QAU7,QAGB,QBXS,QAML,QAGC,QDMH,QBWS,QBVV,QA7O,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Buffering in the TASTRADE Sample Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130656</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ORDENTRY.SCX form in the C:\VFP\SAMPLES\MAINSAMP\FORMS directory
contains controls as well as a grid to create a one-to-many form from
tables in the TASTRADE.DBC database.
<P>
This form uses optimistic buffering, as well as custom routines when
records are appended, saved, or the record pointer is moved. Much of the
code is supplied in the base class for the form, so it is not readily
apparent when you modify the ORDENTRY.SCX form itself.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The BufferMode property in the Ordentry.scx form itself sets optimistic
buffering. This property causes grids to use optimistic table buffering and
all other controls to use optimistic row buffering. The remaining code is
located in the class used to create this form.
<P>
The ParentClass property is set to tsbaseform. The ClassLibrary property is
set to C:\VFP\SAMPLES\MAINSAMP\LIBS\TSBASE.VCX. These two pieces of
information tell you what you need to know to look at the code behind the
order entry form.

<OL><P><LI>Choose Open from the File menu, and select Files of Type: Visual Class
   Library.

<P><LI>Select the TSBASE.VCX file from the C:\VFP\SAMPLES\MAINSAMP\LIBS
   directory. After you choose OK, a list of classes contained in the
   library appears on the right side of the dialog box. Choose tsbaseform,
   and click OK again.
<P>
</OL><h3>Methods Used with the BufferMode Property</h3>
 
<P>
The following methods are used in conjunction with the BufferMode property
to handle updates of data in the tables:
<P>
<PRE>Method               Functions Performed
</PRE></OL> 
<PRE>Init                 Adds navigation buttons and sets up error
                     message array.

QueryUnLoad          Writes out current record if it has data, and
                     cancels out a blank, appended record.

*AddNew              Prepares a form to accept a new record, and
                     appends a blank record to the table.

*AskToSave           Asks the user if changes should be saved, and
                     saves or restores data.

*DataChanged         Checks to see if any data has changed in the
                     current workarea.

*Delete              Reverts a newly appended record, or deletes a
                     record that already exists in the table.

*First               Moves the record pointer to the appropriate record.
</PRE>*Last
*Next
*Prior
<P>
<PRE>*IsNewAndEmpty       Returns true (.T.) if the user has added a new
                     record but has not yet made any changes.

*Restore             Cancels all user changes.

*Save                Saves changes to the tables.

*WriteBuffer         Saves the current value of the field to a buffer if
                     the user clicks the toolbar without leaving the
                     current field.

</PRE>NOTE: All methods names preceded with an asterisk (*) are user-defined
methods that were added to the form. The asterisk is to categorize the
methods here. The names are not preceeded with an * in the class library.
<P>
In most cases, this code could have been placed in a different method, such
as the Click event of a button. The advantage of using special names for
these methods is that the code is not overwritten in memory if the
developer adds custom code to the default methods included in a form.
<P>
The code to save or discard changes is encapsulated in two methods. The
Restore method is the only method that reverts data through a TABLEREVERT()
function. The Save method is the only method that saves data from the form
into the table; it accomplishes this through a TABLEUPDATE() function. Each
method sets the lAllRows parameter to true (.T.) for the TABLEREVERT() or
TABLEUPDATE() function. This causes all updates to be written to disk or
discarded and allows the method to work with row or table buffering.
<P>
These two methods are called whenever it is necessary to discard changes to
a record or save changes to a table. Both methods assume that the desired
work area has been selected prior to invoking the method. The Restore
method is called by the AddNew, AskToSave, Delete, First, Last, Next, and
Prior methods. The Save method is called only by the AskToSave method.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
