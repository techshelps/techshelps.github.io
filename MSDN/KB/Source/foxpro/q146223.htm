

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Position Error: Outline Control on Classed Pageframe </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146223">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1996/02/14">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If an outline control is placed on a page of a pageframe and that pageframe is saved as a class, the class is repositioned during its use in designing a form. The outline control will first appear in its original design location when the form is ru...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIB,QAB5,QAMN,QA7O,QAOE,QACI,QBWS,QABO,QAJP,QAR4,QAHV,QAI2,QAPN,QA9N,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Position Error: Outline Control on Classed Pageframe</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146223</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If an outline control is placed on a page of a pageframe and that pageframe
is saved as a class, the class is repositioned during its use in designing
a form. The outline control will first appear in its original design
location when the form is run. Then if you click an alternate tab of the
pageframe followed by clicking the original tab, the outline control jumps
to that location on the page in the form.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To correct this behavior in the design of the form, use the following
steps, which are based on building a test example as specified in the
"Steps to Reproduce Problem" section of this article.

<OL><P><LI>Place the following two commands in the form's Activate event:
<P>
   Thisform.&lt;the name of the class&gt;.Pageframe1.activepage = 1
   Thisform.refresh

<P><LI>Place the following command in the Init event of the form:
<P>
<P><PRE>      Thisform.refresh
</PRE>
<P><LI>Place the following command in the Init event of the pageframe of the
   current instantiation of the class:
<P>
   This.activepage = 2

<P><LI>Place the following command in the Activate event of the page that
   contains the Outline control:
<P>
   This.refresh
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
Using the Visual FoxPro interface, create a new class consisting of a
pageframe that contains an OLE container control that contains the Outline
control on the first page. Place this class in the upper-left corner of a
form. Drag the class to the lower-right corner of the form. Run the form
and observe the position of the outline control. Here are the steps:

<OL><P><LI>On the File menu, click New, select Class, and click the New Class
   button. In the New Class dialog box, click Based on, and then click
   Pageframe. Give it a class name of Outltest, and store it in a class
   library named Testvcx.vcx.

<P><LI>In the Class Designer, right-click the pageframe, and select Edit.

<P><LI>From the Forms Control toolbar, select the OLE Container Control tool,
   and place it on the first page of the pageframe, which is in Edit mode.

<P><LI>In the Insert Object dialog box, click Insert Control. Then from the
   Control Type list, select the Outline Control. Position and size the
   outline control on the pageframe so that it looks as you would want it
   to look on a user's form. Then save the new class, and close the Class
   Designer by using the menu options or by pressing CTRL+W.

<P><LI>In the Command window, type:
<P>
   MODIFY FORM outltest.

<P><LI>On the Forms Controls toolbar, click the View Classes button. Click
   Add, and sele Testvcx.vcx from the Open dialog box. Click Open.

<P><LI>From the Forms Controls toolbar, click the Outltest class tool, and
   place the class on the form in the upper-left corner. Drag the class to
   the lower-right corner of the form.

<P><LI>Click the exclamation mark tool on the Visual FoxPro toolbar to Run the
   form. Observe that the OLE Outline control is positioned off of the
   pageframe. Click the tab for page 2 of the pageframe, and then click the
   tab for page. Observe that the Outline control is now located where it
   should be.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxprgClassoop VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b jump misplace<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
