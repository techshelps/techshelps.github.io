

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example Code Shows How to Refresh a Graph </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140860">
<META NAME="KBModify" CONTENT="1996/10/17">
<META NAME="KBCreate" CONTENT="1995/12/07">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Previous versions of FoxPro could call procedures (refreshgrph, updategrph) that were built into the Graph Wizard to redraw a chart to reflect changes in data. While this functionality was never officially supported, the information was made availa...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA5V,QBWS,QA2Q,QAG2,QDNX,QAIK,QAQG,QA7O,QAXB,QAGB,QAGI,QALQ,QAEF,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Example Code Shows How to Refresh a Graph</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140860</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Previous versions of FoxPro could call procedures (refreshgrph, updategrph)
that were built into the Graph Wizard to redraw a chart to reflect changes
in data. While this functionality was never officially supported, the
information was made available to customers and many developers used it.
<P>
This article gives example code for the equivalent functionality using
Visual FoxPro and the new Graph Wizard. Of course, it is only intended as
an example, your tables and so will be different.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Assumptions</h3>
 

<UL><LI>A form exists and that there is an olebound control on the form with its
   ControlSource property set to a table that has charts in a General
   field.

<LI>The Spcgrph table is opened exclusively.

<LI>The tables used are Phonz.dbf which contains the data and Spcgrph.dbf
   which has a general field called olegraph that contains the chart.
<P>
</UL><h3>Using the Code</h3>
 
<P>
You could place this code in the Click event of a button marked "Refresh
Chart."
<P>
<P><h3>Code Sample</h3>
 
<P>
** Select the work area and turn off the console
SELECT PHONZ
SET CONSOLE OFF
SELECT email,  avg_time, FROM PHONZ INTO CURSOR SPCRES
<P>
**  Now the data is in the cursor SPCRES. The table with the graph in it
**  needs to have the current record deleted. The following code
**  adds the updated chart in a new record. The operation seems to
**  confuse the olebound control, so you should lock the screen, so
**  you won't see it. Then set the controlsource of the olebound control
**  to null for the duration.
**
**  Note that the wizard does not just modify the chart that you are
**  on, it appends a new record with a new chart. If you don't want
**  your table to grow every time that you do this, you must delete
**  the current record.
**
**  The spcgrph table must be packed after deletion, so it must
**  be opened exclusivly. Because the Wizard leaves spcgrph opened
**  non-exclusivly, it needs to be closed and re-opened.
<P>
select spcgrph
delete
pack
use
thisform.lockscreen = .T.
<P>
thisform.oleboundcontrol1.controlsource = ""
<P>
**  Load the New chart
<P>
<PRE>    SELECT SPCRES
    DO (_GENGRAPH) WITH "AUTOGRAPH", 4, 1, "Test1",,,,"spcgrph",.T.

</PRE>** after using this wizard, the graph table (spcgrph) is open, but it
** is not open exclusively. Note that if you had more than one chart
** in the table, you would have to do some fancy shuffling at this point
** to make sure that you were on the right record. (the one that you want
** to show in the form.
<P>
select spcgrph
use
use spcgrph.dbf in 0 exclusive
<P>
**  Close the cursor and go back where you came from
<P>
<PRE>    SELECT SPCRES
    USE
    SELECT PHONZ

    thisform.oleboundcontrol1.controlsource = "spcgrph.olegraph"
    thisform.lockscreen = .F.

</PRE>** Refresh the Form
<P>
THISFORM.REFRESH
THISFORM.OLEBOUNDCONTROL1.REFRESH
<P>
******************* End Of Code ******************************
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q140291.htm">Q140291</A></B>
   TITLE     : How to call graph wizard &amp; create a chart programmatically
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 3.00b<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 17, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
