

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error Occurs when Closing Issue in Anomaly Tracking System </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166506">
<META NAME="KBModify" CONTENT="1997/04/10">
<META NAME="KBCreate" CONTENT="1997/04/08">
<META NAME="Keywords" CONTENT="FxtoolGeneral kbtool msats">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When closing an issue in a new Anomaly Tracking System (ATS) database, the following error occurs:     File 'onclose.prg' does not exist.  CAUSE =====  The sample database that ships with ATS includes a sample procedure that executes when the Statu...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAGB,QAB4,QAPN,QBWS,QAAP,QAB9,QAO4,QAIJ,QBT6,QBSO,QBJZ,QBV4,QBXB,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Occurs when Closing Issue in Anomaly Tracking System</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166506</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Anomaly Tracking System, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When closing an issue in a new Anomaly Tracking System (ATS) database, the
following error occurs:
<P>
<PRE>   File 'onclose.prg' does not exist.

</PRE><h2>CAUSE</h2>
 
<P>
The sample database that ships with ATS includes a sample procedure that
executes when the Status of an issue is changed to Closed. This procedure
automatically assigns an issue to "Unassigned" whenever an issue is closed.
The template database that ATS uses to create new databases is configured
to use this stored procedure. However, the procedure file OnClose.fxp is
not included in the new database directory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two possible methods that can be used to avoid this error:

<OL><P><LI>Copy the file "OnClose.fxp" from the ATS\Shardata directory to the
   ATS\Template directory before creating new databases in ATS. This method
   adds the functionality of the OnClose procedure to every new database
   that is created in ATS.

<P><LI>Modify a newly created ATS database so that it does not call the OnClose
   procedure. The following steps outline how to do this:
<P>
   a. Start ATS and login to the new database as the administrator.
<P>
   b. Select Property Options Maintenance from the Tools menu.
<P>
   c. Select Status in the Group list and Closed in the Name list.
<P>
   d. Click Edit.
<P>
   e. Remove OnClose() from the validation procedure text box, and
<P><PRE>      click Save.
</PRE><P>
   f. Close the Property Options Maintenance dialog box.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start ATS and create a new database.

<P><LI>Run the All Issues query.

<P><LI>Click New to enter a new issue into the database.

<P><LI>Change the Status property to Closed.
<P>
</OL>NOTE: The error message occurs.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: msats<BR>
Keywords            : FxtoolGeneral kbtool msats<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
