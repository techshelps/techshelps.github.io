

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: CHANGE WHEN and VALID Clauses Don't Work with Arrow Keys </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126232">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/02/16">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you use the CHANGE command to view or change records in a table, the CHANGE WHEN clause doesn't work correctly when you press any of the ARROW keys to move between records.  Once a field is changed, if you continue to press any of the ARROW keys...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAUD,QAL2,QBFM,QDMH,QADN,QBXQ,QAYV,QAPN,QAO2,QAH4,QAEF,QAKP,QALW,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: CHANGE WHEN and VALID Clauses Don't Work with Arrow Keys</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126232</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the CHANGE command to view or change records in a table, the
CHANGE WHEN clause doesn't work correctly when you press any of the ARROW
keys to move between records.
<P>
Once a field is changed, if you continue to press any of the ARROW keys or
the ENTER key to move between records, the CHANGE VALID will behave like a
FORCED VALID until you press the PAGE UP or PAGE DOWN key.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The program below demonstrate the problem with the WHEN and the VALID
clauses of the CHANGE command. Depending on which key combination is used,
you may run into one or more of the following problems:

<UL><LI>The WHEN clause for current record is not executed.

<LI>The previous WHEN result is still active.

<LI>The VALID clause for current record is executed even when no data was
   changed.
<P>
</UL><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create and then run a program containing the following code. When
   running the program, use only the PAGE UP and PAGE DOWN keys to move
   between records.
<P>
   SET DEFAULT TO SYS(2004)+"tutorial"
   USE customer
   testfile=SYS(3)
   COPY TO &amp;testfile
   USE &amp;testfile
<P>
   CHANGE FIELDS cno, company, address WHEN chgwhen() VALID chgvalid()
<P>
   CLOSE ALL
   WAIT WINDOW "CLOSING ALL FILES" NOWAIT
   DELETE FILE &amp;testfile..dbf
<P>
   FUNCTION chgwhen
   * MOD returns 0 for all even records, and 1 for all odd records.
   IF MOD(RECNO(),2)=0
<P><PRE>       WAIT WINDOW 'W: Recno is ' + ALLTRIM(STR(RECNO())) + ;
       '. Even records are Editable' NOWAIT
       RETURN .T.
       &amp;&amp; Returning True allow the current record to be edited
</PRE>   ELSE
<P><PRE>       WAIT WINDOW 'W: Recno is ' + ALLTRIM(STR(RECNO())) + ;
       '. Odd records are READ-ONLY' NOWAIT
       RETURN .F.
       &amp;&amp; Returning False makes the current record read only
</PRE>   ENDIF
<P>
   FUNCTION chgvalid
   IF MOD(RECNO(),2)=0
<P><PRE>       WAIT WINDOW 'V: Recno is ' + ALLTRIM(STR(RECNO())) + ;
       '. Even record changes validated OK'
       RETURN .T.
</PRE>   ELSE
<P><PRE>       WAIT WINDOW 'V1: Recno is ' + ALLTRIM(STR(RECNO())) + ;
<PRE></PRE>         '. Odd records should be READ-ONLY'
       WAIT WINDOW 'V2: Current record was changed. RECORD WHEN '+ ;
         'protection failed, or'
       WAIT WINDOW 'V3: RECORD VALID is behaving like a FORCED VALID '+ ;
         'because Previous record was changed.'
       RETURN .T.
   ENDIF

</PRE><P><LI>Change or delete some of the fields in one or more of the even records,
   and try to change some of the fields in the odd records.

<P><LI>Repeat steps 1 and 2 using the ARROW keys as well as the PAGE UP and
   PAGE DOWN keys.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin buglist2.50 buglist2.50a buglist2.50b<BR>
buglist2.60 buglist2.60a 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxotherGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
