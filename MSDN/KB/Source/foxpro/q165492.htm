

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Using ADO with a Visual Foxpro Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165492">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1997/03/20">
<META NAME="Keywords" CONTENT="FxinteropGeneral FxinteropOdbc vfoxwin kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT=" This article assumes that you are familiar with Microsoft Internet Information Server (IIS) and with creating Active Server Pages (ASP) applications using the programming tools provided with Microsoft Internet Information Server or Microsoft Visual ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QAYY,QBWA,QAI5,QBVX,QAVZ,QAU9,QDNQ,QAZV,QAPN,QAK6,QBQU,QA9E,QA62 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Using ADO with a Visual Foxpro Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165492</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
This article assumes that you are familiar with Microsoft Internet
Information Server (IIS) and with creating Active Server Pages (ASP)
applications using the programming tools provided with Microsoft Internet
Information Server or Microsoft Visual InterDev. Additionally, it assumes
that you are familiar with HTML. For more information on Microsoft
Information Server and Active Server Pages please see the following Web
site:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/iis/default.asp">http://www.microsoft.com/iis/default.asp</A></B>

</PRE><h2>SUMMARY</h2>
 
<P>
This article describes how to use ActiveX Data Objects (ADO) on an Active
Server Page (ASP) to access data in a Visual FoxPro database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to run Active Server Pages, you must have access to a machine
running Microsoft Internet Information Server version 3.0. If you currently
have IIS 2.0, you can download IIS 3.0 from the following Web site:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/iis/default.asp">http://www.microsoft.com/iis/default.asp</A></B>

</PRE>In order to access a Visual FoxPro database through ADO, you must have the
latest Visual FoxPro ODBC driver. For more information about obtaining this
driver, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q157767.htm">Q157767</A></B>
   TITLE     : PATCH: Vfpodbc5.exe Visual FoxPro ODBC Driver Version 5.0

</PRE>There are three ways to set up ODBC to access your database over the
Internet Information Server:

<OL><P><LI>Create a System Data Source on the IIS Server machine that points to
   the database.

<P><LI>Create a File Data Source that points to the database. If you create
   this Active Server Page in a Database Project in Visual InterDev Studio,
   if you add a connection that uses a file data source, it includes the
   data source information in the Global.asa file. This can then be
   distributed with the Active Server Page.

<P><LI>When creating the connection object through VBScript, include the
   connect string when running the Open method (example below).
<P>
</OL><h3>Limitations</h3>
 
<P>
Recordsets, or cursors, generated by Visual FoxPro through the Visual
FoxPro ODBC Driver must be of type STATIC, or READONLY. The Visual FoxPro
ODBC driver does not support the KEYSET, or DYNAMIC cursor types.
<P>
<P><h3>Example</h3>
 
<P>
This example does not use a specific data source.  The connect string is
being specified in the connection object's Open method. If you do wish to
create and use a Data source, ensure it is a System Data Source on the
Microsoft Internet Information Server machine.
<P>
<P><h3>Please Remember</h3>
 
<P>
Change the SourceDB setting to reflect the Tastrade.dbc on the test system.
Ensure the Visual FoxPro ODBC driver version 5.0.0.402 is installed on the
Microsoft Information Server where this Active Server Page is stored.
Please see article reference above for availability options of this driver.
<P>
<P><h3>Contents of the ASP Page</h3>
 
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;TITLE&gt;VFP ASP ADO Test&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;
   &lt;H3&gt;ActiveX Data Object (ADO)&lt;/H3&gt;
   &lt;%
   Set Conn = Server.CreateObject("ADODB.connection")
   ConnStr= "Driver=Microsoft Visual Foxpro Driver; " + _
   "UID=;SourceType=DBC;SourceDB=C:\VFP\Samples\Tastrade\Data\Tastrade.dbc"
   Conn.Open ConnStr   'This can be a datasource name or a connect string
   Set cmdTemp = Server.CreateObject("ADODB.Command")
   Set rs = Server.CreateObject("ADODB.Recordset")
   SQLText="Select Distinct Products.Product_ID,Products.Product_Name,"+ _
      "Products.English_Name,Products.Unit_Price, " + _
      "Products.Quantity_In_Unit from Tastrade!Products"
   cmdTemp.CommandText = SQLText
   cmdTemp.CommandType = 1 'SQL statement
   Set cmdTemp.ActiveConnection = Conn
   rs.CacheSize = 10
   rs.Open cmdTemp,,adopenstatic
   %&gt;
   &lt;P&gt;
   &lt;TABLE BORDER=1&gt;
   &lt;TR&gt;
   &lt;% For i = 0 to RS.Fields.Count - 1 %&gt;
        &lt;TD&gt;&lt;B&gt;&lt;% = RS(i).Name %&gt;&lt;/B&gt;&lt;/TD&gt;
   &lt;% Next %&gt;
   &lt;/TR&gt;
   &lt;% Do While Not RS.EOF %&gt;
        &lt;TR&gt;
        &lt;% For i = 0 to RS.Fields.Count - 1 %&gt;
             &lt;TD VALIGN=TOP&gt;&lt;% = RS(i) %&gt;&lt;/TD&gt;
        &lt;% Next %&gt;
        &lt;/TR&gt;
        &lt;%
        RS.MoveNext
   Loop
   RS.Close
   Conn.Close
   %&gt;
   &lt;/TABLE&gt;
   &lt;BR&gt;
   &lt;BR&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Additional information on Active Data Object can be found in the following
sources:
<P>
ADO Web page, <B><A HREF="http://www.microsoft.com/data/ado/">http://www.microsoft.com/data/ado/</A></B>
<P>
Visual InterDev online documentation; search on ADO
<P>
Visual InterDev online documentation; search on Active Server Pages
 
<PRE>Keywords          : FxinteropGeneral FxinteropOdbc vfoxwin kbhowto
Version           : 3.0 3.0b 5.0 5.0a
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
