

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Y-Axis Format in Graph Is Lost After Using UPDATEGRPH </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108669">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1993/12/15">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use the UPDATEGRPH function to programmatically update a graph in a database created by Microsoft Graph through GENGRAPH.APP, the y-axis number format (for example, #,##0) that is saved with the graph's datasheet is lost after the graph is...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAG2,QA2Q,QBXS,QBJZ,QA7O,QA7N,QAUR,QDNG,QAIX,QABI,QAGB,QAU7,QDI1,QAZZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Y-Axis Format in Graph Is Lost After Using UPDATEGRPH</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108669</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the UPDATEGRPH function to programmatically update a graph in
a database created by Microsoft Graph through GENGRAPH.APP, the y-axis
number format (for example, #,##0) that is saved with the graph's datasheet
is lost after the graph is updated with the new data. The #,##0 format on
the y-axis is replaced with the general format based on the new data.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In the Command window, issue the following command:
<P>
       CREATE QUERY

<P><LI>Select the CUSTOMER.DBF file from the FOXPROW\TUTORIAL subdirectory.

<P><LI>Select the Fields check box.

<P><LI>In the RQBE Select Fields dialog box, choose the Remove All button.

<P><LI>In the Table Fields list box, select the YTDPURCH field and then
    choose the Move button. Repeat this step again, but this time select
    the CONTACT field. Select the No Duplicates check box and then choose
    the OK button.

<P><LI>Under Field Name, select the STATE field, select the logical operator
    LIKE, and in the Example text box, type the state LA.

<P><LI>In the Output list box, select Graph.

<P><LI>Choose the Do Query button.

<P><LI>Select the Column chart type and then choose the Next button.

<P><LI>If you want, change the default title and then choose the Next
    button.

<P><LI>Choose the Zoom button.

<P><LI>Double-click the graph to open Microsoft Graph.

<P><LI>Click the datasheet and select the entire YTDPURCH column.

<P><LI>From the Format menu, choose Number, select the #,##0 format, and then
   choose the OK button. Check that the values on the Y-axis in the chart
   display in the newly selected format (that is, 12,0000, 10,000, and so
   on).

<P><LI>From the File menu, choose Update, and then choose Exit And Return To
   FoxPro [###].

<P><LI>Click the close box in the Zoom window.

<P><LI>In the Microsoft FoxPro GraphWizard dialog box, choose the Save As
    button.

<P><LI>Using the default filename (QRYGRAPH.DBF), save the graph in the
   FOXPROW directory and then choose the Save button. A WAIT window will
   appear with the drive and directory where the QRYGRAPH.DBF file is
   saved.

<P><LI>Choose the OK button in the Microsoft FoxPro GraphWizard dialog box and
   then press ESC to close the RQBE dialog box. You don't have to save the
   UNTITLED.QPR file.

<P><LI>From the Window menu, choose View.

<P><LI>In the View window, select a work area and open the QRYGRAPH.DBF file
   and then BROWSE the database. Double-click the field called GEN and
   verify that the chart's Y-axis is correctly formatted. Press ESC twice
   to exit the general field and the Browse window. Close the
   QRYGRAPH.DBF.

<P><LI>In the Command window or in a program, issue the following code:
<P>
       CLEAR ALL
       SELECT ytdpurch,contact FROM \Foxprow\Tutorial\CUSTOMER WHERE ;
<PRE>          STATE="MA" INTO CURSOR query  &amp;&amp; semicolon not required at
                            &amp;&amp; the Command window
       DO UPDATEGRPH IN GENGRAPH.APP WITH ;
          "\FoxProw\qrygraph.dbf", 1, 1, "My Title"
       USE \Foxprow\qrygraph IN 0
       SELECT qrygraph
       BROWSE

</PRE><P><LI>In the Browse window, double-click the field called GEN; the values on
   the updated chart's y-axis will show a different number format. The
   #,##0 number format that was originally saved with the graph's
   datasheet will be replaced by the general format based on the new data.
<P>
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b gengraph updategrph<BR>
format<BR>
msgraph qrygraph chart relational query by example<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxtoolRqbe<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
