

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Preprocessor Directives Incorrect in "Language Tips" Help </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118617">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/07/25">
<META NAME="Keywords" CONTENT="kbprg kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT=" In the  Language Tips  section of the online Help file, under the  Tips and Tricks  topic, the second paragraph under the  Preprocessor Directives  topic incorrectly states the following:     This code would not work because _DOS would be changed to...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAH4,QAB4,QDO9,QDL9,QBXT,QBWQ,QBWO,QBWN,QA5V,QAO3,QANE,QAIB,QBWI,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Preprocessor Directives Incorrect in "Language Tips" Help</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118617</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
In the "Language Tips" section of the online Help file, under the "Tips and
Tricks" topic, the second paragraph under the "Preprocessor Directives"
topic incorrectly states the following:
<P>
<PRE>   This code would not work because _DOS would be changed to .T. and
   _WINDOWS would be changed to .F. so that the code could never work
   properly again. Instead use the following:

      #IF "Win" $ VERS()
      #DEFINE windows_code .T.
      #ELIF "Mac" $ VERS()
      #DEFINE mac_code .T.
      #ELIF "Unix" $ VERS()
      #DEFINE unix_code .T.
      #ELSE
      #DEFINE dos_code .T.
      #ENDIF
      #IF windows_code
      ? "Compiled under WINDOWS"
      #ELIF dos_code
      ? "Compiled under DOS"
      #ENDIF

</PRE>This resolution code is incorrect because FoxPro does not allow nested
preprocessor directives. When you compile the code above, it will create an
.ERR file with the same name as the source file if the .ERR File option is
selected in the Compile dialog box. The *.ERR file will log the following
errors:
<P>
<PRE>   #elif "Mac" $ VERS()
   Error in line 3: Mismatched #if/#elif/#else/#endif.
   #elif "Unix" $ VERS()
   Error in line 5: Mismatched #if/#elif/#else/#endif.
   #else
   Error in line 7: Mismatched #if/#elif/#else/#endif.
   #endif
   Error in line 9: Mismatched #if/#elif/#else/#endif.

</PRE>The correct resolution code is:
<P>
<PRE>   #DEFINE win_code "Win" $ VERS()
   #DEFINE mac_code "Mac" $ VERS()
   #DEFINE unix_code "Unix" $ VERS()
   #DEFINE dos_code NOT("Win" $ VERS() OR "Mac" $ VERS() ;
      OR "Unix" $ VERS()))
   #IF win_code
   ? "Compiled under WINDOWS"
   #ELIF dos_code
   ? "Compiled under DOS"
   #ENDIF
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.50 2.50a 2.50b 2.50b<BR>
2.60<BR>
docerr<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
