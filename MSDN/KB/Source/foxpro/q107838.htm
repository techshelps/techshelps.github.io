

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: After SELECT-SQL FoxPro Deletes Compound Structural Index </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107838">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1993/11/29">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you issue an SQL SELECT statement that outputs to a database file that has a compound structural index attached to it, the index is deleted from the disk drive. The new database file will not contain any reference to the compound structural inde...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABD,QABE,QA28,QATJ,QAZV,QDI1,QAZZ,QAEF,QAB9,QBCT,QA2Q,QAY2,QAGC,QAGB,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: After SELECT-SQL FoxPro Deletes Compound Structural Index</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107838</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you issue an SQL SELECT statement that outputs to a database file that
has a compound structural index attached to it, the index is deleted from
the disk drive. The new database file will not contain any reference to the
compound structural index.
<P>
<P><h2>CAUSE</h2>
 
<P>
When an SQL SELECT statement outputs to an existing database, FoxPro
re-creates the entire file. Since the header record of the database file is
created anew, no reference to the compound structural index is retained.
FoxPro displays a warning that it will overwrite the current database file.
FoxPro deletes the file to eliminate the possibility of retaining a
compound structural index that contains tags that may not match the new
database structure.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To retain the index file on the target database after performing the SQL
SELECT statement, do one of the following:

<UL><LI>Instead of using a structural compound index, create a nonstructural
   compound (compact) .CDX index file. This index will have a different
   name from the database.
<P>
   -or-

<LI>Use an .IDX index file with the database.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In the Command window, issue the following commands:
<P>
<P><PRE>      USE CLIENTS.DBF
      COPY TO XCLIENTS.DBF
      USE XCLIENTS.DBF
</PRE>
<P><LI>From the Database menu, choose Setup.

<P><LI>Create a compound structural index with a tag on the State field.

<P><LI>In the Command window, issue the following commands:
<P>
<P><PRE>      USE CLIENTS.DBF
      SELECT * FROM CLIENTS INTO TABLE XCLIENTS.DBF
</PRE>
<P><LI>A warning message appears saying the target database already exists and
   asks if you want to overwrite XCLIENTS.DBF. Choose Yes.

<P><LI>In the Command window, type:
<P>
<P><PRE>      DIR XCLIENTS.*
</PRE><P>
</OL>The XCLIENTS.CDX file no longer exists on the disk.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a 2.50b<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
