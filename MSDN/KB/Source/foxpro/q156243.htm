

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Closing SDI Form with Menu Causes Objects to Shift Upward </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156243">
<META NAME="KBModify" CONTENT="1997/03/24">
<META NAME="KBCreate" CONTENT="1996/09/19">
<META NAME="Keywords" CONTENT="FxprgClassoop FxtoolFormdes FxtoolMBuilder kbui vfoxwin kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a Single-Document Interface (SDI) or Top-Level form (form with the ShowWindow property set to 2 - As Top-Level Form) has a menu, releasing the form causes the controls contained within the form to momentarily shift upward before the form disappe...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QAMN,QAH4,QAF0,QAPN,QAAW,QAI2,QACI,QBXS,QBJZ,QBWS,QBWR,QANS,QAFY,QA5D V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Closing SDI Form with Menu Causes Objects to Shift Upward</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156243</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a Single-Document Interface (SDI) or Top-Level form (form with the
ShowWindow property set to 2 - As Top-Level Form) has a menu, releasing the
form causes the controls contained within the form to momentarily shift
upward before the form disappears.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Set the form's Visible property to .F. - False before releasing the form.
See the MORE INFORMATION section below for details on implementing this.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual FoxPro 5.0 gives you the ability to create forms that can appear
outside of (or in lieu of) the FoxPro desktop, and appear in the task list
or on the task bar. These forms are called Top-Level, or SDI, forms, and
require setting the form's ShowWindow property to "2 - As Top-Level Form."
You can add menus, toolbars, and child forms to these forms in the same way
you add them to the Visual FoxPro desktop in this and previous versions of
Visual FoxPro.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form called Test.

<P><LI>Set the form's ShowWindow property to 2 - As Top-Level Form in the Form
   Designer Property window.

<P><LI>Add a command button to the form, and set its Caption property to
   Close. Place the following code in the Click method of this command
   button:
<P>
<P><PRE>      THISFORM.Release()
</PRE>
<P><LI>In the Init method of the form, add the following code:
<P>
<P><PRE>      DO TESTMENU.MPR WITH THIS, .T.
</PRE>
<P><LI>Create a new menu. Make it a Menu rather than a Shortcut.

<P><LI>Select Menu then Quick Menu from the FoxPro menu bar to create a default
   quick menu.

<P><LI>On the View menu, click General Options. In the General Options
   dialog box, select the Top-Level Form check box, then click OK.

<P><LI>On the Menu menu, click Generate. Save the menu as Testmenu, then select
   the Generate button to generate the default .mpr file.

<P><LI>Run the Test form, then click the Close button. The Close button
   shifts upward on the form, then the form closes. This shift also
   occurs if the form is closed in any of the following ways: Clicking
   Close on the File menu; clicking the Close button [X] in the upper
   right corner of the form under Windows 95 or NT 4.0; or pressing Alt+F4
   or clicking Close on the Control menu.
<P>
</OL>The workaround is to make the form invisible immediately before releasing
it. Because a form may be closed in several different ways, the workaround
must be incorporated in several places. Here is sample code to demonstrate
this.
<P>
To handle when the form is closed by clicking a command button, place the
following in the Click method code for your Quit or Close command button:
<P>
<PRE>   * Close button Click() code
   THISFORM.Visible = .F.
   THISFORM.Release()

</PRE></OL>To handle when the form is closed by clicking the Close [X] button under
Windows 95 or NT 4.0, or pressing Alt+F4 or clicking Close on the Control
menu, place the following in the QueryUnload() method code for the form:
<P>
<PRE>   * Form.QueryUnload() code
   THIS.Visible = .F.

</PRE>To handle when the form is released by clicking Exit (or equivalent) from
the menu on the SDI form, add this to a procedure for the Exit bar of your
menu:
<P>
<PRE>   * Menu Exit bar code
   LOCAL oForm
   oForm = _screen.ActiveForm
   _screen.ActiveForm.Visible = .F.
   oForm.Release()
   SET SYSMENU TO DEFAULT    &amp;&amp; Resets VFP menu back to default
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxprgClassoop FxtoolFormdes FxtoolMBuilder kbui vfoxwin kbprb<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
