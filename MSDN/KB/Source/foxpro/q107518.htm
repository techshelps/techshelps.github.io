

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: ON SHUTDOWN Does Not Work When a READ Is Active </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107518">
<META NAME="KBModify" CONTENT="1997/10/14">
<META NAME="KBCreate" CONTENT="1993/11/19">
<META NAME="Keywords" CONTENT="FxprgFoxtools kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you close FoxPro for Windows through the Windows Task List, the ON SHUTDOWN command doesn't execute, and control doesn't return to FoxPro for Windows. Instead, FoxPro for Windows flashes for a split second and then FoxPro disappears from the Tas...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QDKA,QAGB,QAH4,QA01,QAGQ,QAR4,QBVV,QAVX,QAVW,QAGI,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ON SHUTDOWN Does Not Work When a READ Is Active</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107518</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50a
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you close FoxPro for Windows through the Windows Task List, the ON
SHUTDOWN command doesn't execute, and control doesn't return to FoxPro for
Windows. Instead, FoxPro for Windows flashes for a split second and then
FoxPro disappears from the Task List. Then, when you attempt to quit
Windows, the Windows message box (called by the ON SHUTDOWN command)
appears and Windows hangs.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro 2.5a for Windows.
This problem was corrected in FoxPro 2.5b for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a program that contains the following code and call it
   FLLTEST.PRG:
<P>
<P><PRE>      #DEFINE MB_ICONHAND 16
      #DEFINE MB_OK 0
</PRE><P>
<P><PRE>      SET LIBRARY TO foxtools.fll
      MsgBox=RegFn("MessageBox","ICCI","I")
      result=CallFn(MsgBox,0,"You can not close FoxPro this way", ;
<PRE></PRE>         "Close FoxPro Correctly",MB_ICONHAND+MB_OK)
      WAIT WINDOW "Please Hit Any Key to Continue"
      RELEASE LIBRARY foxtools.fll
      ON SHUTDOWN

</PRE><P><LI>Create a simple screen using the following code and save the screen as
   TEST.SPR:
<P>
<P><PRE>      CLEAR
      @1,1 SAY "Input x" GET x DEFAULT SPACE(10)
      READ CYCLE
</PRE>
<P><LI>In the Command window, type:
<P>
<P><PRE>      ON SHUTDOWN DO flltest.prg
</PRE>
<P><LI>In the Command window, type:
<P>
<P><PRE>      DO test.spr
</PRE>
<P><LI>When the screen is running, minimize FoxPro for Windows.

<P><LI>Click any where outside Program Manager or press CTRL+ESC.

<P><LI>In the Task List window, select Microsoft FoxPro, and choose End Task.
<P>
   FoxPro will come up for a split second and then close down. It will no
   longer appear in the Task List.

<P><LI>In Windows Program Manager, choose Exit from the File menu. The Windows
   message box (called by the ON SHUTDOWN command) will appear, and then
   Windows will hang.
<P>
</OL>If the .SPR file is not running, and steps 3, 5, 6, 7, and 8 are executed,
everything works properly.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50a buglist2.50a fixlist2.50b<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxprgFoxtools<BR>
Keywords          : FxprgFoxtools kbbuglist kbfixlist kbprg<BR>
Version           : 2.50a<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
