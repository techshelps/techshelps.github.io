

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create a Foundation READ Time-Out </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107837">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/11/29">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A foundation READ is commonly used to provide a place for a menu to wait in an application (.APP) or executable file (.EXE) created by FoxPro. However, if the TIMEOUT clause is added to the foundation READ, the foundation READ will not work.  The f...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBFN,QAH4,QBXS,QAF0,QAPN,QANE,QAGB,QAG2,QBWS,QBJZ,QBWR,QA2Q,QAY2,QABH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Foundation READ Time-Out</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107837</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A foundation READ is commonly used to provide a place for a menu to wait in
an application (.APP) or executable file (.EXE) created by FoxPro. However,
if the TIMEOUT clause is added to the foundation READ, the foundation READ
will not work.
<P>
The foundation READ and the TIMEOUT clause will work correctly together if
the VALID clause of the foundation READ calls a procedure instead of
evaluating a variable, as shown below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a menu with a foundation READ that works with the TIMEOUT clause,
do the following:

<OL><P><LI>From the File menu, choose New, and select Menu. Choose OK.

<P><LI>Add one or more pads to the menu. One pad should have QUIT as the menu
   prompt. Under Result, select Procedure, and enter the following code for
   the QUIT pad:
<P>
<P><PRE>      m.quitting = .T.
      CLEAR READ ALL
</PRE>
<P><LI>From the Menu menu, choose General Options. Select the Cleanup check
   box. In the cleanup code snippet window, enter the following code:
<P>
<P><PRE>      m.quitting = .F.
      READ VALID quitting() TIMEOUT 10
</PRE><P>
<P><PRE>      SET SYSMENU TO DEFAULT
</PRE><P>
<P><PRE>      PROCEDURE quitting
      IF m.quitting
<PRE></PRE>         RETURN .T.
      ELSE
         IF READKEY(0) = 6
            RETURN .T.
         ELSE
            RETURN .F.
         ENDIF
      ENDIF

</PRE><P><LI>From the Program menu, choose Generate. When you are asked if you want
   to save the changes, choose Yes. Enter TIMEOUT as the menu name.

<P><LI>In the Command window, enter the following command to display your
   custom menu:
<P>
<P><PRE>      DO TIMEOUT.MPR
</PRE>
<P><LI>Wait 10 seconds. The FoxPro default system menu should appear.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.00 2.50 2.50a 2.50b time<BR>
read<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
