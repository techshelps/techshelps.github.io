

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connection Properties You Can Access with SQLGETPROP() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132231">
<META NAME="KBModify" CONTENT="1995/10/23">
<META NAME="KBCreate" CONTENT="1995/07/03">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro, you can view the current property settings for a connection by using the SQLGETPROP() command with the respective connection handle. This article lists the connection properties that can be accessed with SQLGETPROP() and shows how...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QAUD,QBXS,QAPN,QABA,QBBI,QBAO,QA9E,QA7O,QA56,QA55,QAOE,QAMN,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Connection Properties You Can Access with SQLGETPROP()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132231</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Visual FoxPro, you can view the current property settings for a
connection by using the SQLGETPROP() command with the respective connection
handle. This article lists the connection properties that can be accessed
with SQLGETPROP() and shows how to use SQLGETPROP().
<P>
This information is also available under SQLSETPROP() in the Visual FoxPro
Help file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Visual FoxPro, you can use SQLGETPROP() to display the information used
to create the active connection, to work with shared connections, to
control interface display and time intervals, and to fetch result sets into
view cursors. You can also use it to ensure that active connections are
deactivated after a specified time interval, to manage transactions, and to
display internal ODBC handles.
<P>
SQLGETPROP() returns the current or default settings for an active
connection. SQLGETPROP() returns a numeric value to describe the setting.
To view the current property settings for a connection, use SQLGETPROP()
with the respective connection handle using the following syntax:
<P>
<PRE>   SQLGETPROP(nConnectionHandle, cSetting)

</PRE>For example, the following command reads the setting for the "asynchronous"
connection property:
<P>
<PRE>   SQLGETPROP(gnConnHandle, 'asynchronous')

</PRE>The nConnectionHandle parameter specifies the connection handle to the data
source returned by SQLCONNECT(). If you specify 0 for the active
connection, SQLGETPROP() returns the default setting. If a connection level
error occurs, -1 is returned. If an environment level error occurs, -2 is
returned.
<P>
The cSetting parameter specifies the setting.
<P>
<P><h3>Connection Properties Available</h3>
 
<P>
The connection properties that can be accessed with SQLGETPROP() are listed
below in functional groups.
<P>
To display the information used to create the active connection:

<UL><LI>ConnectString   The login connection string.
<LI>DataSource      The name of the data source as defined by ODBC.
<LI>Password        The connection password.
<LI>UserID          The user identification.
<P>
</UL>NOTE: Documents that ship with the Professional Edition of Microsoft Visual
FoxPro version 3.0 for Windows and the Visual FoxPro Help file incorrectly
list the ConnectName property as being available with the SQLGETPROP()
function.
<P>
For more information about documentation error regarding the ConnectName
property and the SQLGETPROP() function, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q137408.htm">Q137408</A></B>
   TITLE     : DOCERR: Can't Use ConnectName Property w/SQLGETPROP()
               Function

</PRE>To work with shared connections:

<UL><LI>ConnectBusy     True (.T.) if a shared connection is busy; false (.F.)
<PRE>                   otherwise.

</PRE></UL>To control interface display:

<UL><LI>DispLogin       Controls when the ODBC Login dialog box is displayed.
<LI>DispWarnings    Controls whether error messages are displayed or not.
<P>
</UL>To control time intervals:

<UL><LI>ConnectTimeout  Specifies the time (in seconds) to wait before
<PRE>                   returning a connection time-out error.
</PRE><LI>IdleTimeout     Specifies the idle timeout interval (in seconds).
<P>
</UL>To qualify active connections are deactivated after a specified time
interval: (1)

<UL><LI>WaitTime        Controls the amount of time in milliseconds that
<PRE>                   elapses before Visual FoxPro checks whether the SQL
                   statement has completed executing.

</PRE><LI>QueryTimeout    Controls the time (in seconds) to wait before returning
<PRE>                   a general time-out error.

</PRE></UL>To manage transactions:

<UL><LI>Transactions    Determines how the connection manages transactions on
<PRE>                   the remote table.

</PRE></UL>To control fetching of result sets into view cursors:

<UL><LI>synchronous     Specifies if result sets are returned synchronously
<PRE>                   (the default) or asynchronously.
</PRE><LI>BatchMode       Specifies if SQLEXEC( ) returns result sets all at once
<PRE>                   (the default), or individually with SQLMORERESULTS( ).

</PRE></UL>To display internal ODBC handles:

<UL><LI>ODBChdbc (2)    The internal ODBC connection handle that can be used by
<PRE>                   external library files (.FLL files) to call the ODBC
                   API functions.
</PRE><LI>ODBChstmt (2)   The internal ODBC statement handle that can be used by
<PRE>                   external library files (.FLL files) to call the ODBC
                   API functions.

</PRE></UL>(1) If in manual transaction mode, the connection is not deactivated.
<P>
(2) If a connection is deactivated, the ODBChdbc and ODBChstmt values are
<PRE>    no longer valid.

</PRE>NOTE: See SQLSETPROP() in the Visual FoxPro Help file for a list of the
settings you can set with the SQLSETPROP() function.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbinterop<BR>
KBSubcategory: FxinteropOdbc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 23, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
