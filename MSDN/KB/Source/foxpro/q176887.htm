

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Running VFP Exe as Post-Setup Executable Hangs the Process </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176887">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/11/18">
<META NAME="Keywords" CONTENT="vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you run an .exe file written in Visual FoxPro (VFP) 5.x as a Post- Setup Executable in the Setup Wizard, the wizard does not successfully exit the setup process. The setup process hangs when the Post-Setup Executable is completed and you must ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QALZ,QDI2,QAH4,QDIZ,QBWS,QBWP,QAUJ,QAGB,QAFZ,QDJO,QA56,QA55,QAKP,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Running VFP Exe as Post-Setup Executable Hangs the Process</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176887</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run an .exe file written in Visual FoxPro (VFP) 5.x as a Post-
Setup Executable in the Setup Wizard, the wizard does not successfully exit
the setup process. The setup process hangs when the Post-Setup Executable
is completed and you must use the CRTL-ALT-DEL keys to terminate the setup
through the Task Manager.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior is seen in Windows NT 4.0 Server or Workstation regardless of
the version of the Service Pack installed.
<P>
To re-create the problem the executable must be a Visual FoxPro executable
and Windows NT 4.0 must be the operating system. Other executables, like
Notepad.exe, do not cause the problem, nor does the problem occur if the
setup program is running on Windows 95.
<P>
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a simple project, named MyProj.

<P><LI>Create a new program named Main.prg and add it to the project.

<P><LI>In Main.prg, type the following code:
<P>
<P><PRE>      WAIT WINDOW "inside " + Program() TIMEOUT 1 QUIT
</PRE>
<P><LI>Build the project into an .exe file name Myproj.exe.

<P><LI>Create a second project to run as the Post-Setup Executable and name it
   Post.

<P><LI>Create a new program named Postmain.prg and add it to the project.

<P><LI>In Postmain.prg, type the following code:
<P>
<P><PRE>      WAIT WINDOW "POST: inside " + Program() TIMEOUT 1
      QUIT
</PRE>
<P><LI>Build this project into .exe file named Post.exe.

<P><LI>Create a distribution files folder and place Post.exe and Myproj.exe in
   the folder.

<P><LI>Run the Setup Wizard.

<P><LI>In Step 3 of the Setup Wizard, select and create Netsetup Disk Images.

<P><LI>In Step 4 of the Setup Wizard, click the "..." button next to the
<P><PRE>    Post-Setup Executable text box and select Post.exe.
</PRE>
<P><LI>Finish running the Setup Wizard.

<P><LI>Quit Visual FoxPro and run the Netsetup Setup.exe on an NT 4.0
<P><PRE>    computer.
</PRE><P>
<P><PRE>    NOTE: The Setup program runs the Post-Setup Executable (Post.exe) and
    you will see "POST: inside Postmain" display in the upper-right corner.
    However, the setup hangs once the Post-Setup Executable is completed.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Setup Wizard Post-setup<BR>
Keywords          : vfoxwin<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
