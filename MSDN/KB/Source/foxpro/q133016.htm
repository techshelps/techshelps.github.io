

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Dynamically Changing Buffering Mode Doesn't Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133016">
<META NAME="KBModify" CONTENT="1995/07/31">
<META NAME="KBCreate" CONTENT="1995/07/23">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Dynamically changing the BufferModeOverride property of the Data environment changes the property, but not the behavior of the buffering. A dialog box reporting  Property setting will not take effect until data environment reloaded  also appears.  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAH4,QBXS,QAUD,QBWS,QAY5,QAMB,QBWC,QAQ7,QBVV,QAX1,QBV8,QAJQ,QAB9,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Dynamically Changing Buffering Mode Doesn't Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133016</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Dynamically changing the BufferModeOverride property of the Data
environment changes the property, but not the behavior of the buffering. A
dialog box reporting "Property setting will not take effect until data
environment reloaded" also appears.
<P>
<P><h2>CAUSE</h2>
 
<P>
Visual FoxPro does not change the behavior of the BufferModeOverride
property dynamically while the tables are open. However, you can resolve
the issue by closing the tables with the CloseTables method. Then change
the property, and then open the tables again with the OpenTables method.
The new setting of the buffering will then take effect.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following steps show you how to create a form that contains a combo box
that allows you to change the BufferModeOverride property dynamically.

<OL><P><LI>Create a new form. Set the DataSession property to 2 and the Caption
   property to Customer. In the ACTIVATE method of the form, enter the
   following code:
<P>
   THISFORM.Refresh

<P><LI>Using the right mouse button, click the form, and choose Data
   Environment. Then Using the right mouse button again, click the Data
   Environment window, and choose Add.
<P>
   Add the CUSTOMER.DBF table located in the C:\VFP\SAMPLES\DATA or
   equivalent directory. Drag the first three fields in this table
   (Cust_Id, Company and Contact) onto the form.

<P><LI>Create a combo box and set the RowSourceType property to 1. Enter the
   following value into the RowSource property:  "1- Use Form Setting,2 -
   Pessimistic Row,3 - Optimistic Row,4 - Pessimistic Table,5 - Optimistic
   Table"

<P><LI>In the Valid method of the combo box, enter this code:
<P>
<P><PRE>      THISFORM.Dataenvironment.CloseTables
      THISFORM.Dataenvironment.Cursor1.BufferModeOverride = THIS.ListIndex
      THISFORM.Dataenvironment.OpenTables
</PRE><P>
   In the Init method of the combo box, enter this code:
<P>
<P><PRE>      THIS.ListIndex=1
</PRE>
<P><LI>Add a command button to the form, and enter Next in the Caption
   property. Enter the following code in the Click method:
<P>
   SKIP
   THISFORM.Refresh

<P><LI>Add another command button with Previous as the Caption with the
   following code in the Click method:
<P>
   SKIP - 1
   THISFORM.Refresh

<P><LI>Add another command button with Exit as the Caption, and enter the
   following code in the Click method:
<P>
   RELEASE THISFORM

<P><LI>Add a final command button with Write as the Caption, and enter the
   following code in the Click method:
<P>
   IF TABLEUPDATE(.T.,.F.)
<P><PRE>      =MESSAGEBOX("SUCCESS",64)
</PRE>   ELSE
<P><PRE>      nAnswer=MESSAGEBOX("FAILURE - Write this New data ?",52)
      IF nAnswer=6
<PRE></PRE>         =TABLEUPDATE(.T.,.T.)
      ELSE
         =TABLEREVERT(.T.)
         THISFORM.Refresh
      ENDIF
   ENDIF

</PRE><P><LI>Save the form, and create two instances of the form. You can now change
   the buffering dynamically with the combo box.
<P>
</OL>NOTE: Instead of changing the BufferModeOverride property, you can use the
CURSORSETPROP() function to do the same thing. This method does not require
you to open and close the tables. To use Table Buffering, ensure that
MULTILOCKS is set ON. Below is a code example using the CURSORSETPROP()
function:
<P>
<PRE>   =CURSORSETPROP('Buffering',THIS.ListIndex)

</PRE></OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxprgMultiuser<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
