

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Connectivity Error: Not a Recognized Built-in Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140575">
<META NAME="KBModify" CONTENT="1995/12/11">
<META NAME="KBCreate" CONTENT="1995/12/04">
<META NAME="Keywords" CONTENT="kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When trying to run or browse a remote view, you may receive a Connectivity error similar to this one:     Connectivity error: [Microsoft][ODBC SQL Server Driver][SQL    Server]'CTOD' is not a recognized built-in function name  CAUSE =====  The CTOD...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QADK,QAY5,QAB9,QBWT,QBV8,QABA,QA7O,QA7N,QAB4,QAPF,QANN,QBVV,QBG2,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Connectivity Error: Not a Recognized Built-in Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140575</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When trying to run or browse a remote view, you may receive a Connectivity
error similar to this one:
<P>
<PRE>   Connectivity error: [Microsoft][ODBC SQL Server Driver][SQL
   Server]'CTOD' is not a recognized built-in function name

</PRE><h2>CAUSE</h2>
 
<P>
The CTOD function is added by the user as one of the Output fields, Order
By, or Group By fields, or it is added by the View Designer as part of the
Selection Criteria. CTOD is a FoxPro-specific function that is not
recognized by the SQL Server.
<P>
When browsing the Remote View, FoxPro passes the SQL command (listed in the
Remote View SQL window) to the back-end server for execution. A
connectivity error message is generated when any of the FoxPro-specific
functions are passed to the back-end server.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The View Designer problem in Microsoft Visual FoxPro version 3.0 for
Windows is fixed in Microsoft Visual FoxPro version 3.0b for Windows. In
version 3.0, the view designer added the CTOD to the WHERE clause whenever
a Selection Criteria on a Datetime field is added to the view. Version 3.0b
does not add the CTOD automatically. Currently, 3.0b requires that the date
in the example be surrounded by single quotation marks.
<P>
<P><h3>Steps to Work Around Problem</h3>
 

<OL><P><LI>Create an updatable View using SQL Passthrough. Use one of the SQL
   Server built-in functions or remove whatever the View Designer added.
<P>
   For information about creating an updatable View, please see the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../FOXPRO/Q138094.htm">Q138094</A></B>
<PRE></PRE>      TITLE     : How to Create Updatable Views by Using SQL Passthrough

   Following is an example of an SQLEXEC command that queries the Employee
   table for a range of dates in the Hire_date field and then returns only
   the date portion of the datetime field:

      =SQLEXEC(Handle, "SELECT emp_id, ;
         STR(datepart(month,hire_date),2) + '/';
         + STR(datepart(day,hire_date),2) + '/' ;
         + STR(datepart(year,hire_date),4) AS 'The_hire_date' ;
         FROM employee ;
         WHERE hire_date &gt;= '01/01/93' AND hire_date &lt;= '12/31/93'")

   Note: STR() and datepart() are Microsoft SQL Servers built-in functions.

</PRE><P><LI>Remove all FoxPro-specific functions from the Remote View.

<P><LI>Create a Local view based on the Remote View.

<P><LI>Add the necessary functions or selection criteria to the Local View.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a Remote View to a Microsoft SQL Server.

<P><LI>Add some fields to the Selected Output using the Functions/Expressions
   window, and use a FoxPro function such as ALLTRIM or DTOC.

<P><LI>Add Selection Criteria using a Datetime type field.

<P><LI>Browse the view.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbinterop kbprb<BR>
KBSubcategory: FxinteropOdbc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
