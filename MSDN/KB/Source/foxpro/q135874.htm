

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Exception Error When Using ODBC to SQL Server via TCP/IP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135874">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1995/08/29">
<META NAME="Keywords" CONTENT="FxinteropOdbc kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When creating a remote view to a SQL server using TCP/IP sockets installed with the SQL Server Client Software version 4.21a, the following occurs:   - A Win32s error is displayed.     -or-   - The product shuts down without any error message.  Thi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBWD,QDNT,QAB4,QBG2,QABM,QABA,QA9E,QAU9,QAUJ,QAA1,QAAP,QDI2,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Exception Error When Using ODBC to SQL Server via TCP/IP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135874</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 1.30
WINDOWS
kbinterop kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft Win32s version 1.30
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When creating a remote view to a SQL server using TCP/IP sockets installed
with the SQL Server Client Software version 4.21a, the following occurs:

<UL><LI>A Win32s error is displayed.
<P>
   -or-

<LI>The product shuts down without any error message.
<P>
</UL>This occurs with TCP/IP sockets or IPX/SPX. It does not happen with named
pipes.
<P>
<P><h2>CAUSE</h2>
 
<P>
When Visual FoxPro connects to a data source and sends data, it uses a 4K
packet size by default. This default packet size causes errors when using
TCP/IP with SQL Server and ODBC. The ODBC default is usually 512 bytes.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, modify the default packet size that Visual
FoxPro uses. You can achieve this by creating a connection, changing the
PacketSize property of the connection, and creating the remote view against
the connection.
<P>
The following procedure explains how to get a connection and modify its
attributes:

<OL><P><LI>Open a database. To create a connection, click New and then Connection
   on the File menu. This opens the Connection Designer.

<P><LI>Set the attributes for the connection, and save it as myconnection.

<P><LI>In the Command window, type:
<P>
<P><PRE>      =DBSETPROP('Myconnection','connection','PacketSize',512)
</PRE><P>
   This saves the PacketSize property in the database. If you want to
   modify the packet size for the current session only, use the
   SQLSETPROP() function as follows:
<P>
<P><PRE>      =SQLSETPROP(0,'PacketSize',512)
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Install TCP/IP Protocol.

<P><LI>Install the SQL Server 4.21a Client Software. (This is necessary in
   order to get the required dll - Dbmssoc3.dll.) Switch the Protocol
   from named pipes to TCP/IP.

<P><LI>In the Autoexec.bat add C:\SQL and C:\SQL\BIN to the path. This step
   is necessary for the ODBC driver manager to find Dbmssoc3.dll. Without
   this added to the path, you will receive this error message:
<P>
   Driver unable to load communication module. Driver has not been
   correctly installed.

<P><LI>Reboot.

<P><LI>Start Windows and go into the ODBC Driver Manager. Configure the driver.

<P><LI>Start Visual FoxPro, and create a database. In the database, create a
   Remote View based off FoxHole_tcp.

<P><LI>Log in.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
A TCP/IP socket is an addressable point that consists of an IP address and
a TCP or UPD port number. It provides applications access to TCP/IP
protocols.
<P>
A Named pipe is a communication API that provides a software connection
between a client and a server.
<P>
For more information about using TCP/IP named piped versus sockets, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SNA/Q128985.htm">Q128985</A></B>
   TITLE     : Comparing SNA Client TCP/IP Named Piped vs Sockets
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin TCPIP<BR>
KBCategory: kbinterop kbprb<BR>
KBSubcategory: FxinteropOdbc<BR>
Keywords          : FxinteropOdbc kbinterop kbprb<BR>
Version           : 3.00 1.30<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
