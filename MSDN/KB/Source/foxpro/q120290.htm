

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Display More than One Record at a Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120290">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/09/07">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can view more than one record at a time within a screen by using the BROWSE command, but sometimes you may want to have this ability without using BROWSE. This article shows you how you can use code to create your own screen.  MORE INFORMATION ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QADF,QA7O,QA4F,QABA,QAYS,QAXC,QA7N,QAH4,QDMH,QA9N,QASB,QAOE,QAMN,QAML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Display More than One Record at a Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120290</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
<LI>Microsoft FoxPro for UNIX, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can view more than one record at a time within a screen by using the
BROWSE command, but sometimes you may want to have this ability without
using BROWSE. This article shows you how you can use code to create your
own screen.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code demonstrates one method you can use to create your own
screen. For practical application, you will need to increase the number of
@..GET commands and make the array larger than demonstrated in this
example. With FONT clauses and higher resolution video drivers under FoxPro
for Windows, you could display quite a few more records at one time. This
example displays only two records at a time.
<P>
SET TALK OFF
SET SAFETY OFF
<PRE>SET DEFAULT TO d:\fpw26\tutorial   &amp;&amp; path containing INVOICES.DBF
</PRE>USE Invoices
INDEX ON ino TAG Ino
<PRE>ON ERROR DO brerr WITH ERROR()     &amp;&amp;  To trap  for EOF().
DIMENSION myray(2,5)               &amp;&amp;  Creates an empty 10 element
                                   &amp;&amp;  array for later use.
GO TOP                             &amp;&amp;  Start at top of table, to
                                   &amp;&amp;  fill initial array.

</PRE>*** Place five fields of the first two records into the array:
COPY NEXT 2 TO ARRAY myray FIELDS ino, cno, idate, itotal, salesman
<P>
*** Define the window to place the @..GETs, and @..SAYs:
DEFINE WINDOW brwin ;
<PRE>    AT 0.000, 0.000 ;
    SIZE 7.813,75.429 ;
     FONT "MS Sans Serif", 8 ;
     FLOAT ;
     NOCLOSE ;
     MINIMIZE ;
     SYSTEM

</PRE>*** Intialize and declare variables for later use:
REGIONAL m.choice, m.quitting
m.quitting = .F.
m.choice = "OK"
<P>
*** Activate the window 'Brwin' and create all the @..SAYs
*** and @..GETs to create two rows of five fields and the
*** button controls:
<P>
ACTIVATE WINDOW brwin
<P>
@ 0.250,8.571 SAY "Ino"  ;
<PRE>        FONT "MS Sans Serif", 8 ;
     STYLE "BT"

</PRE>*** The @...GETs below contain the array elements.
@ 1.688,9.000 GET myray(1,1) ;
<PRE>   SIZE 1.000,4.143 ;
   DEFAULT 0 ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 0.250,20.571 SAY "Cno"  ;
<PRE>   FONT "MS Sans Serif", 8 ;
   STYLE "BT"
</PRE>@ 1.688,19.286 GET myray(1,2) ;
<PRE>   SIZE 1.000,7.714 ;
   DEFAULT " " ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 0.250,32.571 SAY "Idate"  ;
<PRE>   FONT "MS Sans Serif", 8 ;
   STYLE "BT"
</PRE>@ 1.688,31.286 GET myray(1,3) ;
<PRE>   SIZE 1.000,7.857 ;
   DEFAULT {  /  /  } ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 0.250,44.571 SAY "Itotal"  ;
<PRE>   FONT "MS Sans Serif", 8 ;
   STYLE "BT"
</PRE>@ 1.688,43.286 GET myray(1,4) ;
<PRE>   SIZE 1.000,8.143 ;
   DEFAULT 0 ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 0.250,54.857 SAY "Salesman"  ;
<PRE>   FONT "MS Sans Serif", 8 ;
   STYLE "BT"
</PRE>@ 1.688,57.000 GET myray(1,5) ;
<PRE>   SIZE 1.000,4.429 ;
   DEFAULT " " ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 3.250,9.000 GET myray(2,1) ;
<PRE>   SIZE 1.000,4.143 ;
   DEFAULT 0 ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 3.250,19.286 GET myray(2,2) ;
<PRE>   SIZE 1.000,7.714 ;
   DEFAULT " " ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 3.250,31.286 GET myray(2,3) ;
<PRE>   SIZE 1.000,7.857 ;
   DEFAULT {  /  /  } ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 3.250,43.286 GET myray(2,4) ;
<PRE>   SIZE 1.000,8.143 ;
   DEFAULT 0 ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"
</PRE>@ 3.250,57.000 GET myray(2,5) ;
<PRE>   SIZE 1.000,4.429 ;
   DEFAULT " " ;
   FONT "MS Sans Serif", 8 ;
   PICTURE "@K"

</PRE>*** Here is the push button containing controls to display the
*** next two records, the top two records, the previous two
*** records, the bottom two records, or to exit the screen. See
*** the VALID function Control() below.
<P>
@ 5.250,1.714 GET choice ;
<PRE>   PICTURE "@*HN \NEXT;TO\P 2;\PREVIOUS;\BOTTOM 2;E\XIT" ;
   SIZE 1.625,11.375,0.500 ;
   DEFAULT 1 ;
   FONT "MS Sans Serif", 8 ;
   STYLE "B" ;
   VALID control()

</PRE>IF NOT WVISIBLE("Brwin")
<PRE>   ACTIVATE WINDOW brwin
</PRE>ENDIF
<P>
READ CYCLE
<P>
*** Clear the ON ERROR setting, and release the window Brwin
*** after the READ is cleared.
ON ERROR
RELEASE WINDOW brwin
<P>
*** Supporting Procedures and Functions:
<P>
*** This error code traps one thing. It is looking for
*** an EOF error. If one is found, the last two records are
*** displayed, with the WAIT WINDOW message.
<P>
PROCEDURE brerr
PARAMETER errid
IF errid=4
<PRE>   WAIT WINDOW "The last two records are already being ;
      displayed!" NOWAIT
   GO BOTTOM
   SKIP -1
   COPY NEXT 2 TO ARRAY myray ;
     FIELDS ino, cno, idate, itotal, salesman
   SHOW GETS
</PRE>ENDIF
<P>
RETURN
<P>
*** Control code for the above push button:
<PRE>FUNCTION control                &amp;&amp;  CHOICE VALID
</PRE>#REGION 1
DO CASE
<PRE>  CASE m.choice = "NEXT"         &amp;&amp;  Displays the next two records.
     SKIP
     COPY NEXT 2 TO ARRAY myray FIELDS ino, cno, idate, ;
       itotal, salesman
     SHOW GETS

  CASE m.choice = "TOP 2"        &amp;&amp;  Displays the top two records.
     GO TOP
     COPY NEXT 2 TO ARRAY myray FIELDS ino, cno, idate, ;
        itotal, salesman
     SHOW GETS

   CASE m.choice = "PREVIOUS"     &amp;&amp;  Displays the previous two
                                  &amp;&amp;  records.
     SKIP -3
     COPY NEXT 2 TO ARRAY myray FIELDS ino, cno, idate, ;
        itotal, salesman
     SHOW GETS

  CASE m.choice = "BOTTOM 2"     &amp;&amp;  Displays the final two
                                 &amp;&amp;  records.
     GO BOTTOM
     SKIP -1
     COPY NEXT 2 TO ARRAY myray FIELDS ino, cno, idate, ;
       itotal, salesman
     SHOW GETS

   CASE m.choice = "EXIT"         &amp;&amp;  Exits the screen.
     WAIT WINDOW "BYE-BYE" NOWAIT
     m.idlequit = .T.
     m.quitting = .T.
     CLEAR READ
  ENDCASE

</PRE>RETURN
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Interface Guide," version 2.0 (MS-DOS), Chapter 12
"User's Guide," version 2.5x, 2.6, 2.6a (MS-DOS), Chapter 12
"User's Guide," version 2.5x, 2.6, 2.6a (Windows), Chapter 11
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxDos FoxWin 2.00 2.50 2.50a<BR>
2.50b 2.50c 2.60<BR>
2.60a scroll multiple<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
