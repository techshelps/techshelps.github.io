

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Walking the Fields Collection of a Message in Active Msg </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175432">
<META NAME="KBModify" CONTENT="1997/10/23">
<META NAME="KBCreate" CONTENT="1997/10/21">
<META NAME="Keywords" CONTENT="vfoxwin ActMsg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Many FoxPro developers may not be aware that the Active Messaging library exists for them to use as an extremely robust alternative to canned mail messaging API (MAPI) controls. This article is designed as part of a short (non-interdependent) serie...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QA7N,QAYC,QAV5,QAEV,QAW6,QA62,QBHQ,QA4H,QAP2,QBVV,QAYY,QAUJ,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Walking the Fields Collection of a Message in Active Msg</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175432</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
   on the following platform: Win95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Many FoxPro developers may not be aware that the Active Messaging library
exists for them to use as an extremely robust alternative to canned mail
messaging API (MAPI) controls. This article is designed as part of a short
(non-interdependent) series intended to provide FoxPro developers with
information, development tips, and useful snippets about the Microsoft
Active Messaging Library.
<P>
This article introduces some aspects of working with a Message objects
Fields Collection by providing a short code snippet demonstrating how to
cycle through the Fields Collection of a sample Message.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Cycling through the fields collection can be particularly useful when
trying to debug a Messaging application. This is especially true if this
method is built upon to allow walking the collections of two different
messages simultaneously and finding the differences between them.
<P>
<PRE>   * AM_FieldData.PRG
   * ----------------
   *
   *Create a MAPI Session object then Logon. The Logon dialog can be
   *bypassed by providing a valid ProfileName as the first parameter
   *(as a string) to the Logon Method as seen below.
   objSession = CREATEOBJECT("mapi.session")
   objSession.Logon("Stevekl")

   *Get a sample message - for this example we'll take whatever is at
   *the top of the Inbox
   objMessage = objSession.Inbox.Messages.GetFirst
   objFieldsColl = objMessage.Fields

   *A key component of a Message Object is it's Fields Collection. The
   *Fields Collection is composed of a variable number of Field Objects
   *that each possess the properties: Name, Value, Type, and ID
   intFldCnt = objFieldsColl.Count
   ctrThisField = 1
   FOR ctrThisField =1 TO intFldCnt
      *Display Name, Value, Type, and ID properties of the Field Object
      DO CASE
         CASE TYPE("objFieldsColl.Item(ctrThisField).Value") = "C"
            strValue = objFieldsColl.Item(ctrThisField).Value
         CASE TYPE("objFieldsColl.Item(ctrThisField).Value") = "N"
            strValue = ;
               ALLTRIM(STR(objFieldsColl.Item(ctrThisField).Value,30,10))
         OTHERWISE
            *There is a potential that a field may contain data types
            *not support for display by Visual FoxPro.
            strValue = "Not Displayed"
      ENDCASE
      MESSAGEBOX(;
         "Field #" + ALLTRIM(STR(ctrThisField)) + " of " ;
         +    ALLTRIM(STR(intFldCnt)) ;
         +    CHR(13) + CHR(10) ;
         + "Name : " ;
         +    objFieldsColl.Item(ctrThisField).Name ;
         +    CHR(13) + CHR(10) ;
         + "Value: " ;
         +    strValue ;
         +    CHR(13) + CHR(10) ;
         + "Type : " ;
         +    ALLTRIM(STR(objFieldsColl.Item(ctrThisField).Type)) ;
         +    CHR(13)+CHR(10) ;
         + "ID   : " ;
         +    ALLTRIM(STR(objFieldsColl.Item(ctrThisField).ID,20)))
   NEXT ctrThisField

   *Clean up then exit
   objSession.Logoff
   RELEASE objFieldsColl, objMessage, objSession

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information on where to acquire the Active Messaging
library, see the following information in the Microsoft KnowledgeBase:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../MAPI/Q171440.htm">Q171440</A></B>
   TITLE     : Where to Acquire the Active Messaging Library


</PRE>Further generic information on Active Messaging can be found on the MSDN,
or in the OLEMSG.HLP file, which can be had by following the directions in
<B><A HREF="../MAPI/Q171440.htm">Q171440</A></B> noted above.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: VFoxWin<BR>
Keywords          : vfoxwin ActMsg kbcode<BR>
Version           : WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
