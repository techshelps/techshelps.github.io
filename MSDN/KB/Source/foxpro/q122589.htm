

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Printer Not Ready When Print Long Doc on Local Printer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122589">
<META NAME="KBModify" CONTENT="1994/11/09">
<META NAME="KBCreate" CONTENT="1994/11/08">
<META NAME="Keywords" CONTENT="kbprint kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using FoxPro for MS-DOS on a stand-alone (non-networked) computer or on a networked computer that has a local printer, you may receive the message  Printer Not Ready  when printing a lengthy document or report to the MS-DOS PRN printer, even t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QACT,QAL2,QAYV,QAKC,QAGI,QBC6,QBB1,QAY5,QAKD,QADN,QAB9,QANY,QAG8,QDJP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Printer Not Ready When Print Long Doc on Local Printer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 9, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122589</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a,
   2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using FoxPro for MS-DOS on a stand-alone (non-networked) computer or
on a networked computer that has a local printer, you may receive the
message "Printer Not Ready" when printing a lengthy document or report to
the MS-DOS PRN printer, even though the printer is in the middle of
printing that item.
<P>
<P><h2>CAUSE</h2>
 
<P>
This can happen because the printer's memory buffer is full and unable to
accept more of the document for the moment. It can happen even though the
memory buffer is large, provided the document is even larger. It can also
happen with printers that have no memory buffer.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use any one of the following three solutions to avoid the problem by
instructing both MS-DOS and FoxPro to wait until the printer is able to
accept more of the document.
<P>
<P><h3>Solution One</h3>
 
<P>
Add the following line to the AUTOEXEC.BAT file. Then reboot the computer:
<P>
<PRE>   MODE LPTn RETRY=P  (or, "MODE LPTn,,P")

</PRE>Here n (a numeric value from 1 to 3) is the number of the parallel printer
port.
<P>
<P><h3>Solution Two</h3>
 
<P>
Add the following line to the FoxPro CONFIG.FP file. The command instructs
MS-DOS to continue retrying until the printer accepts input or the number
of tries has been exceeded. It is valid for any IBM-compatible or Epson-
compatible printer, even those without a print buffer.
<P>
<PRE>   TIME=999999

</PRE>The number specifies the number of FoxPro retries before timing out. The
largest value recognized is one less than a million, which is 999999.
<P>
<P><h3>Solution Three</h3>
 
<P>
Include a user-defined function (udf) in the program that calls the FoxPro
report. Here's an example:
<P>
<PRE>   REPORT FORM &lt;docname.frx&gt; TO PRINT

   * include, for example, the following four line function:

   FUNCTION pauser
   PARAMETERS no_param
   =INKEY(5)  &amp;&amp; pause for 5 seconds waiting for keystroke that never comes
   RETURN ""

</PRE>The report definition file (&lt;docname.frx&gt;) should contain a single
character variable in the page footer band containing this expression:
<P>
<PRE>   pauser()

</PRE>This calls the pauser() function contained in the calling program. The
numeric value, in this case 5, denotes seconds; it can be any value from 0
(an indefinite wait) to 65535.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprint kbprb<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 9, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
