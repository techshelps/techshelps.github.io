

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Report Fields Stacked w/ IIF Commands Not Previewed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97065 ">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1993/04/06">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In the Report Writer, if conditional IIF commands are used that result in two fields, each with conditional IIF commands, being placed on top of each other, page preview will not show expected results.  STATUS ======  Microsoft has confirmed this t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QABH,QAOX,QAB9,QAR4,QBV8,QBVV,QAL3,QAK5,QBWA,QBF2,QATV,QAML,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Report Fields Stacked w/ IIF Commands Not Previewed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97065 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.50
MS-DOS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0 and 2.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the Report Writer, if conditional IIF commands are used that result
in two fields, each with conditional IIF commands, being placed on
top of each other, page preview will not show expected results.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro versions 2.0 and 2.5
for MS-DOS. This problem has been corrected in FoxPro version 2.5a for MS-
DOS.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Page preview will evaluate only the top IIF field. Therefore, only
the conditions in the top IIF field will show up when viewing the
document.
<P>
When the report is sent to the printer, the IIF fields will be
evaluated properly and the report will be printed out with each IIF
field and its .T. or .F. contents printed on the report.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the FOXPRO2\TUTORIAL\CUSTOMER.DBF database.

<P><LI>Create a report and select two fields, such as the CNO and COMPANY
   fields.

<P><LI>Add a third field to the Detail line using this syntax in the
   field expression:
<P>
<P><PRE>      IIF(CUSTOMER.STATE='TX','TEXAS','')
</PRE>
<P><LI>Add another field directly on top of the last field with this
   syntax in the field expression:
<P>
<P><PRE>      IIF(CUSTOMER.STATE ='CA','CALIFORNIA,'')
</PRE>
<P><LI>Select Page Preview and look at the results.
<P>
   The state of California or a blank will be all that is displayed in
   this field because it is the top field. If the field expression
   that has Texas in it is put on top, then the word TEXAS or a blank
   will appear in page preview.

<P><LI>Print out the report and the results will be Texas, California, or
   a blank printed in the fields, depending on the condition of the
   fields.
<P>
</OL>Normally, placing IIF fields on top of one another is not the
preferred way to use the IIF command. Instead of coding separate
fields as shown above, one field could be used with the command:
<P>
<PRE>   IIF(CUSTOMER.STATE = 'TX','TEXAS',IIF(CUSTOMER.STATE =
'CA','CALIFORNIA',''))

     Note: Type this command all on one line.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 preview buglist2.00<BR>
buglist2.50<BR>
fixlist2.50a<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory:<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
