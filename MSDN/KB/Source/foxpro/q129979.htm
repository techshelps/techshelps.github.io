

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Reinstall Win32s with Visual FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129979">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/05/09">
<META NAME="Keywords" CONTENT="kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro uses the Microsoft Setup program. It provides flexibility by letting you install Visual FoxPro as well as remove parts of the application components once the application has been installed. To reinstall Win32s, it is necessary to remo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QAEF,QBWO,QDIZ,QDL9,QBWQ,QBWN,QDKD,QDH6,QA9N,QA56,QA55,QANJ,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Reinstall Win32s with Visual FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129979</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual FoxPro uses the Microsoft Setup program. It provides flexibility by
letting you install Visual FoxPro as well as remove parts of the
application components once the application has been installed. To
reinstall Win32s, it is necessary to remove the subsystem first. Then
invoke the maintenance mode of the Microsoft Setup. This article explains
the process of reinstalling Win32s in detail.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual FoxPro is a 32-bit application, so it requires a 32-bit operating
system. The Microsoft Setup system installs the Win32s operating system
under Windows and Windows for Workgroups to provide a 32-bit environment.
<P>
If you receive a Win32s error such as "Improper Installation," you might
need to reinstall the subsystem. However, you should use extreme caution
when proceeding. If you believe you have a faulty installation of the
Win32s operating system, and need to reinstall it, use the following
step-by-step procedure.

<OL><P><LI>Remove Win32s from your system.
<P>
   a. Remove the following line in the [386Enh] section of the SYSTEM.INI
<P><PRE>      file:
</PRE><P>
<PRE>         device=&lt;WINDOWS&gt;\&lt;SYSTEM&gt;\win32s\w32s.386

      Here &lt;WINDOWS&gt; and &lt;SYSTEM&gt; are where the Windows and System
      directories are located.

   b. Modify the following line in the [BOOT] section of the SYSTEM.INI
      file:

         drivers=mmsystem.dll, winmm16.dll

      to the following (remove winmm16.dll):

         drivers=mmsystem.dll

   c. Delete the following files from the &lt;WINDOWS&gt;\&lt;SYSTEM&gt; subdirectory
      or from the SYSTEM directory in network installations:

         W32SYS.DLL
         WIN32S16.DLL
         WIN32S.INI

      NOTE: In some instances the file WINMM16.DLL, located in the System
      subdirectory, will also need to be deleted.

   d. Delete all the files in the &lt;WINDOWS&gt;\&lt;SYSTEM&gt;\WIN32S subdirectory
      or the &lt;SYSTEM&gt;\WIN32S subdirectory in network installations.
      Then delete subdirectory itself.

   e. Restart Windows.

   NOTE: &lt;WINDOWS&gt; refers to the windows installation directory. On a
   networked Windows installation, the system directory may be located on a
   remote share. If you are only removing Win32s from your machine, then
   you do not need to remove the shared files (in &lt;SYSTEM&gt; and
   &lt;SYSTEM&gt;\WIN32S). Before removing these files from the network share,
   make sure all users that use Win32s have removed the references to
   Win32s from the SYSTEM.INI file.

</PRE><P><LI>Reinstall Win32s.
<P>
   Because the maintenance mode of the Microsoft Setup program is also
   designed to reinstall system files, you can run the SETUP program to
   reinstall Win32s. The maintenance mode of SETUP is started when SETUP
   detects that a version of Visual FoxPro has been installed. When the
   Setup Dialog is displayed, select the Add/Remove option, click the
   Change Option button, and click the Win32s and OLE 2.02 check box option
   to add Win32s.
<P>
   If you prefer to have a clean installation of Visual FoxPro, you can
   bypass the maintenance mode of the Visual FoxPro Setup by deleting the
   FOXSET16.STF, FOXSET32.STF, or FOXSET95.STF files located in the
   VFP\SETUP directory. Setup Table Files (STF) are text files that contain
   information about your Setup. In particular, they report at which point
   a maintenance mode installation should begin. Deleting the STF file will
   force a new installation of Visual FoxPro.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin uninstall<BR>
KBCategory: kbsetup<BR>
KBSubcategory: FxsetupGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
