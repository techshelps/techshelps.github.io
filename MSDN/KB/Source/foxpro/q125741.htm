

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Sum the Averages of Report Groups </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125741">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/02/02">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  For a sum or any other calculation to be performed on a calculated field that is located in a report group footer, you must use user-defined functions (UDFs). This article shows by example how to set up a report to have a calculated field in a page...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QABO,QA7O,QA7N,QAE5,QBCI,QDMW,QAKD,QAUJ,QAH4,QBUN,QBXS,QASR,QAGF,QADZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Sum the Averages of Report Groups</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125741</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
For a sum or any other calculation to be performed on a calculated field
that is located in a report group footer, you must use user-defined
functions (UDFs). This article shows by example how to set up a report to
have a calculated field in a page footer that performs a calculation on
another calculated field that is also in the group footer.
<P>
For example, say you wanted to calculate the average of a field of your
table based on a group. To produce the average, you would add a calculated
field or a calculated report variable to the group footer. If you then
wanted to put a sum of all the group averages into a page footer or Summary
Band of your report, you must use Report UDFs to do the calculations.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The report created below uses the CUSTOMER table that shipped with FoxPro.
The CUSTOMER table should be located in the \tutorial directory.

<OL><P><LI>Group the data. Create a Data Grouping on the STATE field.

<P><LI>Add a field in the group footer that calls a UDF. Use the ab tool to add
   a field to the group footer of the group created in step 1. In the
   "Report Expression" dialog box, type SumAve() in the Expression field.
   The SumAve() line tells the Report Writer to execute the function
   named SumAve, and display the value returned from the function for
   each group.

<P><LI>Add a calculated report variable to the variable list. From the Report
   menu, choose the Variables... bar. Select the Add... button in the
   Report Variables dialog box. Add the following to the appropriate fields
   of the "Variable Definition" dialog box:
<P>
   Variable Name : Ave
   Value to Store: &lt;fieldname&gt; where fieldname is the name of the field
<PRE>                   you want to average. This example uses YTDPURCH.
   Initial Value:  0
   Reset        :  &lt;datagrouping&gt;  Where datagrouping is the name of the
                   data group created in step 1.

   Choose the Average radio button under the Calculate section, and click
   the OK button.

</PRE><P><LI>Add a dummy variable to the variable list. The variable created in this
   step will be used in the UDF to store the results of the summary
   calculation. First, create a report variable following the procedure
   outlined in the previous step. But this time add the following to the
   appropriate fields of the "Variable Definition" dialog box:
<P>
   Variable Name : Avetotal
   Value to Store: Avetotal
   Initial Value : 0
<PRE>   Reset         : End of Report

   Choose the Nothing radio button under the Calculate section, and click
   the OK button.

</PRE><P><LI>Add a field in the page footer, and type the name of the variable
   created in the previous step into the report expression. Add a field in
   the page footer, and type Avetotal into the Expression... field. The
   value of Avetotal will now print at the bottom of each page.

<P><LI>Create a new program that has the same name as that given in step 2.
   Choose New|Program from the File Menu. Save the file as SUMAVE.PRG.

<P><LI>Add the code that performs the summary calculation to the program. Here
   is where the code that performs the sum or any other calculation is
   written. This example adds (sums) all of the group averages, so you want
   to add to the variable Avetotal the value of the variable Ave and return
   the value Ave to the report.
<P>
   Avetotal=Avetotal+Ave
   Return Ave

<P><LI>Save and run the report.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60a<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolRwriter<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
