

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Printing the Screen from Within a Program in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98750 ">
<META NAME="KBModify" CONTENT="1995/04/17">
<META NAME="KBCreate" CONTENT="1993/05/12">
<META NAME="Keywords" CONTENT="kbprint kbdisplay kbui kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Sometimes the need arises to make a hard copy of each screen being processed for remote confirmation, or to provide a quick audit trail for data entry. Rather than rely on the operator remembering to press the PRINT SCREEN button at the proper mome...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAOX,QAGI,QAA8,QAY2,QAPF,QANE,QAEF,QAFR,QAIF,QA5A,QAVX,QAUD,QBWJ,QA0J V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Printing the Screen from Within a Program in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98750 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes the need arises to make a hard copy of each screen being
processed for remote confirmation, or to provide a quick audit trail for
data entry. Rather than rely on the operator remembering to press the PRINT
SCREEN button at the proper moment, the following method allows the screen
to be printed automatically from within the program.
<P>
NOTE: The following information requires experience in writing .BIN
routines using the MS-DOS Debug program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following code to create the .BIN routine. Do not type the hyphens,
semicolons, or explanations following the semicolons.
<P>
<PRE>   C:\&gt;debug             ; At the MS-DOS prompt, type DEBUG.
   -nPR_OUT.BIN          ; Provide a filename with a BIN extension.
   -a 100                ; Assemble at address 100.
                         ;
                         ; The address segment after the colon is
                         ; significant--the first 4 numbers may differ.
   2883:0100 INT 05      ; Call the ROM BIOS print screen interrupt.
   2883:0103 RETF        ; All FoxPro-called routines use far returns.
   2883:0104             ; Press ENTER at the blank line.
                         ;
   -rcx                  ; Access the count register.
   cx 0000               ; Disregard whatever's here because it will
   :3                    ; be changed to 3 bytes.
   -w                    ; Write the program to disk.
   Writing 0003 bytes    ; Message confirms write.
   -q                    ; Quit to MS-DOS.

</PRE>To use PR_OUT.BIN, load it early in the program, and then call it at
the points where output to the printer is completed. For example:
<P>
<PRE>   CLEAR
   LOAD pr_out             &amp;&amp; Loads PR_OUT.BIN.
   *
   &amp;&amp; Represents code in program that produces display screen--
   &amp;&amp; this example uses direct output to the screen with a ?.
   *
   ? "SCREEN OUTPUT EXAMPLE..."
   *
   &amp;&amp; The call to print could be placed in the VALID clause of a Save
   &amp;&amp; push button--in this case, the screen is printed immediately.
   *
   CALL pr_out             &amp;&amp; Begin printing screen.
   *
   &amp;&amp; Loop to process more screens if needed, but this example is done.

   RELEASE MODULE pr_out   &amp;&amp; Remove PR_OUT.BIN from memory when done.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a print screen<BR>
KBCategory: kbprint kbdisplay kbui kbprg kbcode<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
