

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Visual FoxPro Creates Public Variable for ControlSource </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145929">
<META NAME="KBModify" CONTENT="1996/02/12">
<META NAME="KBCreate" CONTENT="1996/02/11">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a form, the scope of a variable set as a control source is public. This variable is declared in a program. By default, a variable declared in a procedure is private, so you would expect this variable to be private.  CAUSE =====  The form is runn...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAH4,QBT6,QBV4,QAI2,QAPN,QAHP,QBVV,QA7O,QA56,QA55,QAOE,QAMN,QAB5,QADN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual FoxPro Creates Public Variable for ControlSource</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145929</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a form, the scope of a variable set as a control source is public. This
variable is declared in a program. By default, a variable declared in a
procedure is private, so you would expect this variable to be private.
<P>
<P><h2>CAUSE</h2>
 
<P>
The form is running in a modeless environment. When the form is modeless,
program execution does not pause after the form is displayed. When the
program is completed, control is returned to the Command window. If the
form is still displayed when you return to the Command window, users can
input data. This means that the input variables need to be accessible. To
prevent errors, Visual FoxPro automatically scopes input variables as
public when the Command window is active. So, if the source of the data of
a control is a variable, its scope is changed to PUBLIC when the Command
window is accessed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use a modal form or a READ EVENTS to pause program execution and prevent
the scope of the variable from changing.
<P>
You can also declare the ControlSource variable as a property of a form to
scope it to the form object.
<P>
<P><h2>STATUS</h2>
 
<P>
This is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form.

<P><LI>Add a text box to the form.

<P><LI>Change the ControlSource property of the text box to cCity.

<P><LI>Create a program that contains the following code:
<P>
   cCity="Atlanta"
   DO FORM &lt;form name&gt;
   DISPLAY MEMORY like cCity

<P><LI>Run the program. The variable cCity is private.

<P><LI>When control is back in the Command window, type:
<P>
   DISPLAY MEMORY like cCity
<P>
   The variable is public.
<P>
</OL>To execute a form, you can use the syntax DO FORM &lt;form name&gt; LINKED. The
LINKED keyword causes the form to be released when the variable that
references the form object goes out of scope. By not including the LINKED
keyword, you ensure that the form is visible when the variable that
references it goes out of scope. In the example, the reference to the form
is released, but the form is still visible.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgClassoop<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
