

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create a Builder That Changes the Font of Form Objects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138979">
<META NAME="KBModify" CONTENT="1995/11/09">
<META NAME="KBCreate" CONTENT="1995/10/31">
<META NAME="Keywords" CONTENT="kbtool kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to create a builder that you can use to change change the font of several selected form objects at once.  MORE INFORMATION  Use the following steps to create a builder that will change the font of all the selected ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QADF,QAW6,QA2Q,QABI,QA01,QAH4,QAGX,QBWS,QAUJ,QAUD,QAG2,QAD7,QABB,QAJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Builder That Changes the Font of Form Objects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 9, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138979</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to create a builder that you can use to
change change the font of several selected form objects at once.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to create a builder that will change the font of
all the selected form objects on the current form. The builder will use the
standard Windows font dialog by using the GETFONT() function.

<OL><P><LI>Create a new program named Fntbldr.prg.

<P><LI>Add the following code to the new builder:
<P>
   ** Builders must accept three parameters
   PARAMETERS a,b,c
<P>
   ** Create an array of object references for the selected objects
   numobjs=ASELOBJ(aobjlist)
<P>
   ** Bring up the standard Windows font dialog
   newfont=GETFONT()
<P>
   ** Make sure that the user chose a font
   IF ! EMPTY(newfont)
<P>
   ** Parse the string returned by GETFONT() to get name, size, and style
<P><PRE>     newname=SUBSTR(newfont,1,AT(',',newfont,1)-1)
     newsize=VAL(SUBSTR(newfont,AT(',',newfont,1)+1,AT(',',newfont,2)-1))
     newstyle=SUBSTR(newfont,AT(',',newfont,2)+1)
</PRE><P>
   ** Loop through the array
<P><PRE>     FOR i=1 TO numobjs
</PRE><P>
   ** Make sure the current object has font properties
<P><PRE>     =AMEMBERS(aobjprops,aobjlist(i))
     IF ASCAN(aobjprops,'FONTNAME')&gt;0
</PRE><P>
   ** Change the current object's font properties
<PRE>          aobjlist(i).FontName=newname
          aobjlist(i).FontSize=newsize
          DO CASE
          CASE newstyle=="N"
               aobjlist(i).FontBold=.F.
               aobjlist(i).FontItalic=.F.
          CASE newstyle=="B"
               aobjlist(i).FontBold=.T.
               aobjlist(i).FontItalic=.F.
          CASE newstyle=="I"
               aobjlist(i).FontBold=.F.
               aobjlist(i).FontItalic=.T.
          CASE newstyle=="BI"
               aobjlist(i).FontBold=.T.
               aobjlist(i).FontItalic=.T.
          ENDCASE
     ENDIF
     ENDFOR
   ENDIF

</PRE><P><LI>Save the program Fntbldr.prg in the \Vfp\Wizards directory.

<P><LI>Open and browse the Builder.dbf table in the \Vfp\Wizards directory.

<P><LI>Append a new record to the Builder.dbf table.

<P><LI>Enter the following text in the appropriate fields:
<P>
   Name - &lt;enter a descriptive name for the builder&gt;
   Descript - &lt;enter a description for the builder&gt;
   Type - MULTISELECT
   Program - Fntbldr.prg

<P><LI>Close the Builder.dbf table.
<P>
</OL>To test the builder:

<OL><P><LI>Create a new form, and add several objects to the form.

<P><LI>Select several objects on the form, and click the Builder button on the
   Properties sheet.

<P><LI>Select the new builder from the Builder Selection dialog box, and click
   OK.

<P><LI>Select the font you want to apply from the font dialog box, and click
   OK. All the selected objects that have font properties will change to
   the font you chose in the font dialog box.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 vfoxwin<BR>
KBCategory: kbtool kbcode kbhowto<BR>
KBSubcategory: FxtoolBuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 9, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
