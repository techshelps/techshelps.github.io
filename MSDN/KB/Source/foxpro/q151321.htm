

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Implement Generic Error Trapping in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151321">
<META NAME="KBModify" CONTENT="1997/11/18">
<META NAME="KBCreate" CONTENT="1996/05/21">
<META NAME="Keywords" CONTENT="FxprgGeneral kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro provides the ON ERROR command to allow programmers to trap for specific errors that occur within applications. This article describes how to use a generic error trapping routine and shows an example in the context of testing a table for excl...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAB9,QAH4,QBV8,QAGU,QAY5,QDL9,QBWQ,QBWO,QBWN,QAPF,QAKP,QDO9,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Implement Generic Error Trapping in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151321</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>3.00 3.00b | 2.60a      | 2.60a | 2.60a
WINDOWS    | MACINTOSH  | UNIX  | MS-DOS
</PRE>kbprg kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
<LI>Visual FoxPro for Macintosh 3.0a
<LI>Microsoft FoxPro for Macintosh, version 2.6a
<LI>Microsoft FoxPro for UNIX, version 2.6
<LI>Microsoft FoxPro for Windows, version 2.6a
<LI>Microsoft FoxPro for MS-DOS, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxPro provides the ON ERROR command to allow programmers to trap for
specific errors that occur within applications. This article describes how
to use a generic error trapping routine and shows an example in the context
of testing a table for exclusive use.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If certain FoxPro commands attempt to use a table that is not opened
exclusively, these commands generate the error "Exclusive open of file is
required." There are several Xbase commands that require the target table
be opened exclusively. These commands include INDEX, INSERT [BLANK] (not
INSERT SQL), PACK, REINDEX, MODIFY STRUCTURE, ALTER TABLE, and ZAP. The
code example below illustrates a simple method of trapping this error and
returning a custom message to the user. This basic example can be modified
to handle other errors.
<P>
While the default FoxPro error contains useful information for a
programmer, its appearance may be disconcerting to an end user. Since there
is no command or function in FoxPro to report if a table is opened in
shared mode by another machine, the user must attempt to open the table
exclusively and trap for the error if the procedure is unsuccessful.
<P>
The following code example shows how to set up an ON ERROR routine to trap
for error "110-Exclusive Open of File is Required", and report a more user-
friendly error message. If the code runs on Microsoft Visual FoxPro for
Windows, the MESSAGEBOX() function returns the message to the user. If the
code executes on FoxPro for Macintosh, MS-DOS, or UNIX, a WAIT WINDOW
appears with the programmer's message. This example creates a table named
Junk to demonstrate the concept, and then deletes it after trapping the
error.
<P>
For more information on the options and parameters available with the
MESSAGEBOX() function, see the Visual FoxPro Help file.
<P>
<P><h3>Code Example</h3>
 
<P>
<PRE>   CREATE TABLE junk  (fld1 C(20))
      FOR x = 1 to 2
         INSERT INTO junk VALUES ("This is test data")
      ENDFOR

   ON ERROR DO errhand WITH error()  &amp;&amp;  Activates ON ERROR routine

   CLOSE ALL
   USE junk SHARE
   ZAP

   PROCEDURE errhand
   PARAMETERS merror

   IF merror =110
   IF _windows=.t. and ATC("Visual",VERSION())&gt;0
   =MESSAGEBOX("This procedure requires exclusive use of the table. ;
   Please try again ;
   later.",48,"My Custom Messagebox Title")
   ELSE
   WAIT WINDOW "This procedure requires exclusive use of the table. ;
   Try again later."
   ENDIF
   ENDIF

   USE
   DELETE FILE Junk.dbf
   ON ERROR  &amp;&amp; Turns off ON ERROR routine

</PRE>The user can use the MESSAGEBOX() function in FoxPro for Windows 2.x.
However, the programmer must use the SET LIBRARY TO command to direct
FoxPro to the FoxTools.fll file. Additionally, the user can use the
FXALERT() function to display the message on FoxPro for the Macintosh 2.x.
For more information about the MESSAGEBOX() and FXALERT()functions in
FoxPro 2.x versions, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q124717.htm">Q124717</A></B>
   TITLE     : How to Use the FXALERT() Function in FOXTOOLS.MLB

   ARTICLE-ID: <B><A HREF="../FOXPRO/Q105006.htm">Q105006</A></B>
   TITLE     : How to Use the MsgBox() Function in FOXTOOLS.FLL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b 2.60a FoxDos FoxWin VFoxWin<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kbhowto kbprg<BR>
Version           : 3.00 3.00b | 2.60a      | 2.60a<BR>
Platform          : MACINTOSH MS-DOS UNIX WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
