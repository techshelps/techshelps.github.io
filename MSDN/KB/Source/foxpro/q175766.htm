

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: WAIT WINDOW NOWAIT Problem with Top-Level Forms </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175766">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/10/28">
<META NAME="Keywords" CONTENT="FxprgGeneral FxtoolFormdes vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When running a Visual FoxPro program that displays a WAIT WINDOW on activation of a Top-Level form, the Top-Level form stops responding. The Top-Level form does not close. The WAIT WINDOW does not close. If the Visual FoxPro desktop is not hidden, ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QADN,QAI2,QA56,QA55,QAGQ,QDL9,QBWQ,QBWO,QBWN,QAEF,QBWS,QAB9,QAVX,QAVW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: WAIT WINDOW NOWAIT Problem with Top-Level Forms</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175766</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When running a Visual FoxPro program that displays a WAIT WINDOW on
activation of a Top-Level form, the Top-Level form stops responding. The
Top-Level form does not close. The WAIT WINDOW does not close. If the
Visual FoxPro desktop is not hidden, it can be activated to access the
Command window either by clicking it or by clicking the button on the
Windows Taskbar. Upon reactivating the Top-Level form by clicking the
Windows Taskbar button for the Top-Level form, a transparent copy of the
Top-Level form appears but the Top-Level form is still unresponsive. Quit
Visual FoxPro to eliminate the Top-Level form.
<P>
<P><h2>CAUSE</h2>
 
<P>
There is a WAIT WINDOW "some message" NOWAIT command in the Activate method
of the Top-Level form, which is followed by the Thisform.Release command.
The problem still occurs if there is other code between the WAIT WINDOW
command and the Thisform.Release command.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are three possible workarounds, depending on what is desired:

<UL><LI>Use WAIT WINDOW "some message" TIMEOUT 1.
<P>
   -or-
<P>
   Use a number greater than one.

<LI>Remove the WAIT WINDOW completely.

<LI>Use WAIT WINDOW "some message" TIMEOUT 0.
<P>
   -or-
<P>
   Remove the TIMEOUT clause completely. Clicking the mouse is
   necessary in this case though.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Place the following code in a new program file, save the code and run
   The program. The code below is from a form created in the Form Designer
   that was opened in the Class Browser. Note the PROCEDURE Activate.
<P>
<P><PRE>      ***Start of program code
      PUBLIC oform1
</PRE><P>
<P><PRE>      oform1=CREATEOBJECT("form1")
      oform1.Show
      RETURN
</PRE><P>
<P>
<P><PRE>      **************************************************
<PRE></PRE>      *-- Form:         form1 (d:\dchou\test\test.scx)
      *-- ParentClass:  form
      *-- BaseClass:    form
      *
      DEFINE CLASS form1 AS form

         ShowWindow = 2
         DoCreate = .T.
         AutoCenter = .T.
         Caption = "Form1"
         Name = "Form1"

         PROCEDURE Activate
            WAIT WINDOW "Some Message" NOWAIT
            Thisform.Release
         ENDPROC

      ENDDEFINE
      *
      *-- EndDefine: form1
      **************************************************

</PRE><P><LI>Click the form or WAIT WINDOW. There should be no response.

<P><LI>Click the Windows Taskbar button for Visual FoxPro. The Top-Level form
   should disappear behind Visual FoxPro. Click the Windows Taskbar button
   for the Top-Level form; it should be labeled Form1. The border and
   title bar of the form may sometimes reappear. If the form appears, it
   will look transparent.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SDI Single Document Interface<BR>
Keywords          : FxprgGeneral FxtoolFormdes vfoxwin<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
