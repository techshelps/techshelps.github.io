

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Play an .AVI File Using FoxPro for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124775">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1995/01/11">
<META NAME="Keywords" CONTENT="FxprgFoxtools kbcode kbdisplay kbmm kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to play a video .AVI file using FoxPro for Windows.  MORE INFORMATION  The code example below employs the FOXTOOLS.FLL library to register a Windows system function, MMSYSTEM.DLL. MMSYSTEM.DLL ships with Windows ve...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QAYA,QAH4,QAGQ,QADN,QBE7,QBE6,QAI4,QDM6,QBHQ,QAGB,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Play an .AVI File Using FoxPro for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124775</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.60a 3.00
WINDOWS
kbprg kbdisplay kbmm kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to play a video .AVI file using FoxPro
for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code example below employs the FOXTOOLS.FLL library to register a
Windows system function, MMSYSTEM.DLL. MMSYSTEM.DLL ships with Windows
versions 3.1 and later. The library is usually located in the
\WINDOWS\SYSTEM subdirectory. After the REGFN() function registers the
multimedia function, MciSendString, the AVI file plays within a window
defined by the program.
<P>
<P><h3>Sample Code</h3>
 

<OL><P><LI>Install Video for Windows on the computer that will be used to run the
   sample code.

<P><LI>Create a program containing the following code, and run it:
<P>
   IF ! 'FOXTOOLS' $ SET('LIBRARY')
<P><PRE>      SET LIBRARY TO SYS(2004)+"FOXTOOLS.FLL" ADDITIVE
</PRE>   ENDIF
<P>
   x=""
   avi=REGFN("MciSendString","@C@CII","I","mmsystem")
<P>
   foxwh=mainhwnd()
   cmd="open c:\fpw26\tazmovie.avi type AVIVideo alias "+ ;
<P><PRE>       "Animation parent "+LTRIM(STR(foxwh))+" style "+LTRIM(STR(12345))
</PRE><P>
   *open the avi file
   ret = CALLFN(avi,@cmd,@x, 0, 0)
   IF ret &gt; 0
<P><PRE>      WAIT WINDOW "Problems"
</PRE>   ENDIF
<P>
   * Put the window at location 10 10 relative to the parent window
   * with a size of 200 200
   cmd="put Animation window at 20 20 200 200"
   ret = CALLFN(avi,@cmd,@x, 0, 0)
   IF ret &gt; 0
<P><PRE>      WAIT WINDOW "Cannot create child window"
</PRE>   ENDIF
<P>
   * The wait tells the MCI command to complete before returning
   * control to the application.
   cmd="play Animation wait"
   ret = CALLFN(avi,@cmd,@x, 0, 0)
   IF ret &gt; 0
<P><PRE>      WAIT WINDOW "Cannot play AVI"
</PRE>   ENDIF
<P>
   * Close windows so they don't crash when you exit the application.
   cmd="close Animation"
   ret = callfn(avi,@cmd,@x, 0, 0)
   IF ret &gt; 0
<P><PRE>      WAIT WINDOW "Cannot close AVI window"
</PRE>   ENDIF
<P>
   SET LIBRARY TO
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin 2.60a<BR>
KBCategory: kbprg kbdisplay kbmm kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>
Keywords            : FxprgFoxtools kbcode kbdisplay kbmm kbprg<BR>
Version             : 2.60a 3.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
