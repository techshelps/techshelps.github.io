

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Store the Value of Check Boxes in a Grid to an Array </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138095">
<META NAME="KBModify" CONTENT="1995/10/15">
<META NAME="KBCreate" CONTENT="1995/10/11">
<META NAME="Keywords" CONTENT="kbtool kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Sometimes you may find it useful to place a check box on a grid. There will be a check box for each record in the grid, so you need a place to store the value of each check box. Usually the value of the check box is stored in a field in the table t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QAPN,QA5V,QARR,QACI,QANX,QAM9,QALX,QAKD,QAKC,QAW6,QAEF,QAG8,QAK3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Store the Value of Check Boxes in a Grid to an Array</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 15, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138095</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes you may find it useful to place a check box on a grid. There will
be a check box for each record in the grid, so you need a place to store
the value of each check box. Usually the value of the check box is stored
in a field in the table that the grid is based on. If a user doesn't want
the value of the check boxes stored in the table, then an array can be
created to store the check box values. This works well, but keep in mind
that an array can only hold 65,000 elements. This would not work on a table
with more records than that.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Procedure</h3>
 

<OL><P><LI>Create a form and add a table to the data environment. Place a grid on
   the form.

<P><LI>Right-click the grid, and then click Builder. Add two fields to the
   grid.

<P><LI>On the Properties sheet, add 1 to the ColumnCount of the grid. This
   makes the ColumnCount property equal to 3. While in the Properties
   sheet, select the Text1 object from the third column. Click the form
   title bar to allow the focus to stay on the Text1 object. Then press
   the DELETE key to delete the Text1 object from the grid.

<P><LI>While the grid is still in edit mode, choose a check box object from the
   Forms Control toolbar and place it under the third column header where
   the Text1 object was just deleted. The check box should now be part of
   the grid.

<P><LI>In the Properties sheet, choose the third Column object and change the
   Bound and Sparse properties to False (.F.).

<P><LI>On the Form menu, click New Property. Type xyz(1) in the property box,
   and save it.

<P><LI>In the Load event of the form, place this code:
<P>
   DIMENSION thisform.xyz(RECCOUNT())
   FOR x = 1 TO RECCOUNT()
<P><PRE>       thisform.xyz(x) = 0
</PRE>   ENDFOR
<P>
   This dimensions the array xyz to the number of records in the open
   table. The FOR loop initializes the elements of the array, which clears
   the value of the check boxes so that they are not checked.

<P><LI>Set the ControlSource for the check box to thisform.xyz(RECNO()). This
   places a 1 or 0 in the array element that relates to that particular
   record.

<P><LI>To check that this works correctly, place the command WAIT WINDOW
   STR(thisform.xyz(RECNO())) in the Valid clause of the check box. Every
   time the check box is selected or cleared, the value of 0 (unchecked) or
   1 (checked) appears in the wait window.
<P>
</OL>If the number of records in the grid that are checked need to be counted,
use a FOR loop to count the number of array elements that contain 1. The
following code placed in the Click Event of a command button will count the
number of checked boxes in the grid:
<P>
<PRE>   counter=0
   FOR x = 1 TO RECCOUNT()
         IF thisform.xyz(x) = 1
            counter = counter + 1
        ENDIF
   ENDFOR
   WAIT WINDOW STR(counter)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbhowto<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 15, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
