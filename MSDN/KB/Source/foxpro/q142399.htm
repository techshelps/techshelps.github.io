

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Line Drawn with Line Method Is Behind Form's Objects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142399">
<META NAME="KBModify" CONTENT="1996/01/15">
<META NAME="KBCreate" CONTENT="1996/01/11">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the form's Line method to draw a line over an object during the form's initialization causes the line to be behind the object.  CAUSE =====  If the Line method is called from either the form's Init event, or any other event that fires when th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBXT,QA5V,QAIB,QAW6,QAGI,QAI2,QAH4,QAR8,QAO4,QACR,QBXS,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Line Drawn with Line Method Is Behind Form's Objects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142399</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the form's Line method to draw a line over an object during the
form's initialization causes the line to be behind the object.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the Line method is called from either the form's Init event, or any
other event that fires when the form is initially started, the line will
actually be drawn prior to the placement of the form's objects. On slower
computers, this can be easily visualized. Because the line that is produced
by using the Line method of a form is not an object and therefore lacks any
properties that can be manipulated, it is not possible to force it to the
front of the object.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Following are three possible workarounds, in order of preference:

<UL><LI>Use either a Line or Shape object. These objects have properties that
   can be manipulated at either design time or run time.
<P>
   -or-

<LI>Create a new property of the form to contain a logical false value: For
   example, zLineDraw. Within the GotFocus Event of the first object in the
   form's tab order, check the value of zLineDraw. If it is false, call the
   form's Line method. Then set the zLineDraw property to true as in the
   following example:
<P>
   IF !ThisForm.zLineDraw
<P><PRE>      ThisForm.Line(&lt;nXCoord2&gt;, &lt;nYCoord2&gt;)
      ThisForm.zLineDraw = .T.
</PRE>   ENDIF
<P>
   -or-

<LI>Use a Timer to call the Line method of the form. In this case, the
   Interval can be set initially to 500 (milliseconds) and the Timer Event
   that calls the form's Line method should reset the Interval to 0 so
   that it is triggered only once.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form, and use the Form Controls toolbar to place a Shape on
   the form and create a large rectangular area.

<P><LI>Set the DrawWidth property of the form to 10. This will cause the line
   width to be large enough to fully visualize the affect.

<P><LI>With the Shape as the selected object on the form, change its BackColor
   property to red (255,0,0).

<P><LI>In the form's Init event, add the following code:
<P>
   * The following code determines the x and y coordinates
   * of the Shape1 object.
   xLeft = This.Shape1.Left
   yTop = This.Shape1.Top
   xRight = This.Shape1.Left + This.Shape1.Width
   yBottom = This.Shape1.Top + This.Shape1.Height
<P>
   * The following code draws an "X" in the area of the Shape1 object.
   ThisForm.Line(xLeft,yTop,xRight,yBottom)
   ThisForm.Line(xRight,yTop,xLeft,yBottom)

<P><LI>Save the form as linetest. Then close the form, and use the DO FORM
   command to run it. Depending on the speed of the computer running the
   form, it may be possible to see that the X appears before the red shape.
   The DrawWidth property of 10 should result in a portion of the X
   protruding from each of the shape's four corners.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
