

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Special Character Causes ODBC Update Syntax Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142191">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1996/01/07">
<META NAME="Keywords" CONTENT="kbinterop kbprb kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using Visual FoxPro with ODBC to update a remote view designed visually with a Microsoft Access 2.0 or Microsoft Access 7.0 table with a tilde (~) character as the first character in a field name may generate either of the two following error messa...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAXB,QDN9,QAC1,QBD2,QAB4,QAA5,QAAP,QA9E,QA7O,QA7N,QA56,QA55,QAUD,QAML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Special Character Causes ODBC Update Syntax Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142191</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using Visual FoxPro with ODBC to update a remote view designed visually
with a Microsoft Access 2.0 or Microsoft Access 7.0 table with a tilde (~)
character as the first character in a field name may generate either of the
two following error messages:
<P>
<PRE>   [Microsoft][ODBC Microsoft Access 7.0 Driver] Syntax error in
   update statement.

   -or-

   Connectivity Error: [Microsoft][ODBC Microsoft Access 7.0 Driver] Syntax
   error in query expression '&lt;tablename&gt;.~&lt;fieldname&gt;'.

</PRE><h2>CAUSE</h2>
 
<P>
The updatable field contains a tilde (~) character, which Visual FoxPro
converts to an underscore.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The following code demonstrates how to use SQL passthrough to accomplish
the update to the Microsoft Access table. This example uses a Microsoft
Access table named Family that contains these two fields:
<P>
<PRE>   Field 1 = ~first
   Field 2 = ~last

</PRE>Also, ~first is the primary key of the table. Add one record where ~first =
"Adam" and ~last = "Smith."

<OL><P><LI>Create a datasource to a Microsoft Access database.

<P><LI>Establish a connection.
<P>
   chandle=SQLCONNECT()
   * Select available datasources. Select datasource for Microsoft Access.
   IF chandle &lt; 0
<P><PRE>      WAIT WINDOW "Bad connection"
      RETURN
</PRE>   ENDIF

<P><LI>Process the update statement, and display a wait window with result.
<P>
   x=SQLEXEC(chandle,;
<P><PRE>      "Update family set [~first]='Eve' where [~first]='Adam'")
</PRE>   IF x &gt; 0
<P><PRE>      WAIT WINDOW "Successful update"
</PRE>   ELSE
<P><PRE>      WAIT WINDOW "Update failed"
      =SQLDISCONNECT(chandle)
      RETURN
</PRE>   ENDIF

<P><LI>View changes, if the update was successful.
<P>
   x=SQLEXEC(chandle,"SELECT * FROM family")
   IF x &gt; 0
<P><PRE>      BROWSE
</PRE>   ELSE
<P><PRE>      WAIT WINDOW "Select statement failed"
      =SQLDISCONNECT(chandle)
      RETURN
</PRE>   ENDIF

<P><LI>Disconnect the connection handle
<P>
   =SQLDISCONNECT(chandle)
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Visual FoxPro the tilde (~) is not a valid character for a field name,
although this is acceptable in Microsoft Access. Therefore, use of a Visual
FoxPro ODBC Remote View to Microsoft Access, converts this special
character to an underscore (_) character. The update using the Remote View
then fails because Visual FoxPro sends an underscore instead of the tilde
that Microsoft Access is expecting.
<P>
For more information about Remote View Syntax, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q138501.htm">Q138501</A></B>
   TITLE     : Modifying a Remote View Results in a Syntax Error
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbinterop kbprb kbhowto kbcode<BR>
KBSubcategory: FxinteropAccess<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
