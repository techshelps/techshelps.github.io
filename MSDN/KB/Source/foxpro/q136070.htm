

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOC: Incorrect Examples on Pages 69-75 of Developer's Guide </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136070">
<META NAME="KBModify" CONTENT="1997/01/30">
<META NAME="KBCreate" CONTENT="1995/08/31">
<META NAME="Keywords" CONTENT="kbprg kbdocerr kbdocfix">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The example that create a VCR control in the Visual FoxPro  Developer's Guide  on pages 69-75 creates a subclass of the VCR control. When an instance of VCR2 is created on a form, the container is not sized correctly; it is much wider than the form...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAW6,QAPN,QAU4,QBVV,QAPF,QAR4,QA56,QA55,QAYL,QAAP,QAIW,QA7O,QAUF,QAOE,QAM1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: Incorrect Examples on Pages 69-75 of Developer's Guide</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136070</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The example that create a VCR control in the Visual FoxPro "Developer's
Guide" on pages 69-75 creates a subclass of the VCR control. When an
instance of VCR2 is created on a form, the container is not sized
correctly; it is much wider than the form.
<P>
The following conditions lead to this problem:

<UL><LI>The ScaleMode of the form is in foxels.

<LI>The width of the VCR2 container, expressed in foxels, is decimal.

<LI>The width of the VCR2 container is used as a variable in the body of the
   class definition (in the DEFINE part). In this example, the specific
   lines are:
<P>
<P><PRE>      Left=This.Width+.2
      Width=This.Width+This.CmdQuit.Width+.2
</PRE><P>
</UL>If all these conditions are true, then when an instance of the class is
created, Visual FoxPro sees that the width of the container is in foxels.
It converts the number to pixels, using the font of the form as the basis
for conversion. That number is in turn used to size the container on the
form, but it is not converted back to foxels. In this example, the Width of
the container is converted from 6.2 foxels to 61 pixels. When the container
is placed on the form, the same measure is used. However, the unit is no
longer pixels, it is foxels. So the width of the container is 61 foxels.
<P>
<P><h3>Fix Status</h3>
 
<P>
This documentation error has been fixed in Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To work around this problem, ensure that one of the conditions listed in
the "Cause" section of this article is not met. In particular:

<UL><LI>You can use the pixel unit instead of foxels to dimension the form and
   the object it contains. This way, pixel is the default scale unit, so
   no conversion occurs.
<P>
   -or-

<LI>If the value of a property depends on another member variable, do not
   define this property in the body of the class. You can use Init event
   handler for this purpose.
<P>
</UL>Using the second alternative, the following definition of the VCR2 class
ensures that the width of the VCR2 container is correct:
<P>
<PRE>   DEFINE CLASS vcr2 as vcr
   ADD OBJECT cmdQuit AS COMMANDBUTTON WITH ;
      Caption="Quit", ;
      Height=2, ;
      Width=6.8

   PROCEDURE INIT
   This.CmdQuit.Left=This.Width+.2
   This.Width=This.Width+This.CmdQuit.Width+.2
   ENDPROC

   PROCEDURE cmdQuit.CLICK
     Release Thisform
   ENDPROC

   ENDDEFINE

</PRE>In addition to the problem listed above, the example contains another
inaccuracy that should not affect your form. Pages 69 and 71 define the
Scalemode property as a property of a CommandButton and a Container.
However, the Scalemode property applies to forms and toolbars only. It does
not apply to control or container objects.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about foxels and pixels, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q106161.htm">Q106161</A></B>
   TITLE     : How to Convert Screen Object Positions Between Platforms

   ARTICLE-ID: <B><A HREF="../FOXPRO/Q129208.htm">Q129208</A></B>
   TITLE     : Pixel Replaces Foxel as Default Scale Value in Design Mode
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbdocerr kbdocfix<BR>
KBSubcategory: FxotherDochelp VFoxWin buglist3.00 5.00<BR>
buglist3.00b<BR>
Additional reference words: docerr 3.00 3.00b navigation buttons<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
