

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Runtime Changes to the Grid Not Saved Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134251">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1995/08/02">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxtoolAccessory vfoxwin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The AddColumn method allows a column to be added to a grid at runtime. However, if a column is added between two existing columns and the form is saved using the Thisform.Saveas method, the column order of the grid is not saved correctly. Altough, ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE1,QBE7,QBE6,QDMN,QAUR,QAH4,QAYV,QAU7,QAR4,QARR,QBWS,QAUJ,QAI2,QBVV,QAML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Runtime Changes to the Grid Not Saved Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134251</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The AddColumn method allows a column to be added to a grid at runtime.
However, if a column is added between two existing columns and the form is
saved using the Thisform.Saveas method, the column order of the grid is not
saved correctly. Altough, at runtime the column appears in the correct
order. The column added between the existing columns becomes the last
column on the grid when the saved screen is modified.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use this command:
<P>
<PRE>   Thisform.&lt;gridname&gt;.column(n).colunmnorder = &lt;number&gt;

</PRE>Here &lt;number&gt; is the column position you want the newly created column to
be. Issue this command after you have inserted the column and before using
the ThisForm.SaveAs command.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form called x.

<P><LI>In the data environment, add any table.

<P><LI>Drag the table from the data environment to the form to create a grid on
   the form.

<P><LI>Save the form.

<P><LI>Create a program called Testobj.prg, and add this code:
<P>
   set safety off
   do form x
<PRE>   x.grid1.name='mygrid'      &amp;&amp; change the default grid name to "mygrid"
   x.mygrid.columncount=2     &amp;&amp; dimension the column count to 2
   x.mygrid.column1.width=8
   x.mygrid.addcolumn(2)      &amp;&amp; add a new column between existing columns
   x.mygrid.column3.header1.name='HdrItem' &amp;&amp; change the header name
   x.mygrid.column3.name='colItem'         &amp;&amp; change the column name
   x.mygrid.colItem.hdrItem.caption='Item' &amp;&amp; change the caption name
   x.saveas('y')                           &amp;&amp; save the Form as "y"
   modify form y

</PRE><P><LI>Run the program. When the program is running, observe the difference
   between the grid column order of the running form (x) and the modified
   form (y). The running form contains the new column (ColItem) in the
   correct order as required by the program, but the modified form doesn't.
<P>
</OL><h3>Example Workaround</h3>
 
<P>
To correct the problem, add the following line of code to Testobj.prg
before the x.savas('y') command. Then run the program again.
<P>
<PRE>   x.mygrid.colItem.columnorder = 2
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 3.00 3.00b<BR>
Keywords            : buglist3.00 buglist3.00b buglist5.00 FxtoolAccessory vfoxwin vfpbug5.0a kbbuglist<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
