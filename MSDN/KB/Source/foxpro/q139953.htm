

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: DATETIME Datatype Rounds Fractions of a Second </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139953">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1995/11/20">
<META NAME="Keywords" CONTENT="buglist3.00 buglist5.00 FxprgGeneral vfoxwin vfpbug5.0a kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Repeatedly adding (or subtracting) a fraction of a second to (or from) a variable that contains a DATATIME data type results in an unexpected value being stored in the variable.  CAUSE =====  Visual FoxPro rounds the fraction of a second being adde...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QAH4,QAYL,QAVX,QAVW,QAK2,QADN,QAX0,QAUD,QACE,QBXT,QA5V,QASR,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: DATETIME Datatype Rounds Fractions of a Second</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139953</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Repeatedly adding (or subtracting) a fraction of a second to (or from) a
variable that contains a DATATIME data type results in an unexpected value
being stored in the variable.
<P>
<P><h2>CAUSE</h2>
 
<P>
Visual FoxPro rounds the fraction of a second being added (or subtracted)
up (or down) to the nearest whole second and stores the rounded value in
the variable.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Type the following line of code in the Command window:
<P>
   X = {1/1/95 12:00:00PM}

<P><LI>Type the following line of code in the Command window:
<P>
   Y = X + .1

<P><LI>Type the following line of code in the Command window:
<P>
   ? Y == X
<P>
</OL>The return value is True (.T.) even though you added a tenth of a second to
x.
<P>
<P><h3>Another Demonstration of the Problem</h3>
 

<OL><P><LI>Type the following line of code in the Command window:
<P>
   MODIFY COMMAND test

<P><LI>In the program window produced by the previous command, type the
   following lines of code:
<P>
   *---------------------
   *-- BEGIN PROGRAM TEST
   *---------------------
   CLEAR
<P>
   LOCAL X, Y
   X = {1/1/95 12:00:00pm}
   FOR I = 1 to 5
<P>
<P><PRE>     *-- Show which iteration you are on
     DO CASE
<PRE></PRE>          CASE I = 1
               WAIT WINDOW "Iteration 1" TIMEOUT .75
          CASE I = 2
               WAIT WINDOW "Iteration 2" TIMEOUT.75
          CASE I = 3
               WAIT WINDOW "Iteration 3" TIMEOUT.75
          CASE I = 4
               WAIT WINDOW "Iteration 4" TIMEOUT.75
          OTHERWISE
               WAIT WINDOW "Last Iteration" TIMEOUT.75
     ENDCASE

     *-- Add 1 tenth of a second to Y
     Y = X + .1

     *-- Display X
     WAIT WINDOW "X = " + TTOC(X) TIMEOUT 1

     *-- Compare Y and X
     *-- One would think the following comparison would return .F.
     WAIT WINDOW "Y == X is " + IIF(Y==X,".T.",".F.") + ;
          "  &lt;&lt;= First Test" + CHR(13) + ;
          "Y has been incremented" + CHR(13) + CHR(13) +;
          "Press any key to continue"

     *-- Add 1 tenth of a second to X
     X = X + .1

     *-- Compare Y and X
     *-- One would think the following comparison would return .T.
     WAIT WINDOW "Y == X is " + IIF(Y==X,".T.",".F.") + ;
          "  &lt;&lt;= Second Test" + CHR(13) + ;
          "X has been incremented" + CHR(13) + CHR(13) + ;
          "Press any key to continue"

     *-- Display Y
     WAIT WINDOW "Y = " + TTOC(Y) + ;
          CHR(13) + ;
          "Y has been incremented by .1 seconds" ;
          TIMEOUT 2
   ENDFOR
   *---------------------
   *-- END PROGRAM TEST
   *---------------------

</PRE><P><LI>Run the program. A one-second increase in time is displayed after five
   tenths of a second have accumulated. The incremented tenths are held by
   the variable but are never displayed until rounding the accumulated
   number of tenths results in a full second. Additionally, the comparison
   appears to be based on the rounding of the fractions of a second, not on
   the actual number stored to the variable.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral vfoxwinbuglist5.00 buglist3.00<BR>
Additional reference words: 5.00 3.00<BR>
Keywords          : buglist3.00 buglist5.00 FxprgGeneral vfoxwin vfpbug5.0a kbprg kbbuglist<BR>
Version           : 3.0 5.0 5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
