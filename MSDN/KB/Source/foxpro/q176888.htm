

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Using "!=" in a Join Statement Does Not Return Records </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176888">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/11/18">
<META NAME="Keywords" CONTENT="FxprgGeneral FxprgSql vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you specify a JOIN condition in a SQL Select statement using the ON clause, and you use the not equal sign (!=) with one empty table, the statement does not return any records.  STATUS ======  This behavior is by design.  MORE INFORMATION  ON ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBMW,QDNC,QDNA,QAH4,QAUD,QBVV,QAY2,QAPN,QA2Q,QBWS,QAY4,QACI,QAG2,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Using "!=" in a Join Statement Does Not Return Records</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176888</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you specify a JOIN condition in a SQL Select statement using the ON
clause, and you use the not equal sign (!=) with one empty table, the
statement does not return any records.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>ON Clause with !=</h3>
 
<P>
The following syntax does not return all the records from one table that do
not have a matching record in the other table:
<P>
<PRE>   SELECT * FROM tbl1 INNER JOIN tbl2 ON tbl1.fld1 != tbl2.fld1

</PRE>This creates a Cartesian product that excludes records that do match.
<P>
<P><h3>Where Clause with !=</h3>
 
<P>
To create a result set that includes all records from one table that do not
exist in a second table, use the following syntax:
<P>
<PRE>   SELECT * FROM tbl1 WHERE tbl1.fld1 != tbl2.fld1

</PRE>In conclusion, the following statements are not equivalent:
<P>
<PRE>   SELECT * FROM tbl1 inner join tbl2 on tbl1.fld1 != tbl2.fld1

   SELECT * FROM tbl1 WHERE tbl1.fld1 != tbl2.fld1

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
Place the following code in a program file and run the code. Note that
there are no records returned in the cursor.
<P>
<PRE>   CREATE DATABASE MyTest
   CREATE TABLE tbl1 (fld1 c(10),fld2 c(20))
   CREATE TABLE tbl2 (fld1 c(10), fld2 c(20))
   INSERT INTO tbl1 VALUES('1','Rec1')
   INSERT INTO tbl1 VALUES ('2','Rec2')
   SELECT * INTO CURSOR MyCurse FROM tbl1 inner JOIN tbl2 ON ;
   tbl1.fld1 != tbl2.fld1

</PRE>For a demonstration of the Cartesian product, run the following code with
the database created in the code above open:
<P>
<PRE>   INSERT INTO tbl2 VALUES ('1','tbl2Rec1')
   INSERT INTO tbl2 VALUES ('2','tbl2Rec2')
   SELECT * INTO CURSOR MyCurse FROM tbl1 inner JOIN tbl2 ON ;
   tbl1.fld1 != tbl2.fld1

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q124589.htm">Q124589</A></B>
   TITLE     : How to Create a Left-Right Outer Join in FoxPro for Windows
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SQL Select<BR>
Keywords          : FxprgGeneral FxprgSql vfoxwin<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
