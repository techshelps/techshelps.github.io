

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Creating Form Letter Programmatically in Word with OLE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155751">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1996/09/06">
<META NAME="Keywords" CONTENT="kbinterop kb3rdparty kbole kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following example shows you how to programmatically create a mail merge form letter with Microsoft Word 6.0 or greater using OLE automation.  MORE INFORMATION  1. Create a table with the following fields: name, address, city, state,    and ZIP ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBTO,QALI,QDME,QA5V,QBTS,QA9Q,QAUR,QAUJ,QAB9,QACI,QAH4,QAUD,QBWS,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Creating Form Letter Programmatically in Word with OLE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155751</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following example shows you how to programmatically create a mail merge
form letter with Microsoft Word 6.0 or greater using OLE automation.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Create a table with the following fields: name, address, city, state,
   and ZIP code. Enter a few records and save it as Testdata.dbf in the
   Visual FoxPro directory.

<P><LI>Create a program with the following lines of code:
<P>
<P><PRE>    oMyform=CREATEOBJECT('new_form')
    oMyform.SHOW
    READ EVENTS
</PRE><P>
<P><PRE>    * Form class definition. The form contains two command buttons.
</PRE><P>
<P><PRE>    DEFINE CLASS new_form AS FORM
       AutoCenter=.T.
       BackColor=RGB(192,192,192)
       Width= 180
       Height= 150
       Caption= "Using OLE Automation"
       ADD OBJECT olecmd AS cmdOLE WITH Top=50, Left=60
       ADD OBJECT mycmd AS cmdquit WITH Top=80, Left=60
    ENDDEFINE
</PRE><P>
<P><PRE>    * Class definition for the command button. When the user clicks the
    * command button, OLE Automation begins.
</PRE><P>
<P><PRE>    DEFINE CLASS cmdOLE AS COMMANDBUTTON
       Width=50
       Height=25
       Caption = "OLE"
</PRE><P>
<P><PRE>       PROCEDURE CLICK
<PRE></PRE>         PUBLIC oWord
         oWord = CREATEOBJECT("Word.Basic")
         WITH oWord
           .AppShow        &amp;&amp; Makes Word Visible
           .FileNewDefault &amp;&amp; Opens up blank Word document
           .MailMergeMainDocumentType(0) &amp;&amp;the active window a document

           * Open the data source
           * The following command uses C:\VFP as the path
           * to the data source

         .MailMergeOpenDataSource("C:\VFP\testdata.dbf",0,0,1,0,"", ;
         "",0, "","","DSN=FoxPro Files;DBQ=C:\VFP;DefaultDir=C:\VFP ;
             Deleted=1;DriverId=24;JetIniPath=odbcddp.ini;Statistics=0;", ;
             "SELECT * FROM testdata.dbf","")

           * Activates the mail merge main document
           .MailMergeEditMainDocument

           * The following Insert commands place text into the Word
           * document. You can change these commands to place any text in
           * the document. This example uses a typical business letter
           * format.

           .Insert("550 College Terrace")    &amp;&amp; Inserts a string
           .InsertPara                       &amp;&amp; Inserts a carriage return
           .Insert("Orangeburg, SC 29915")
           .InsertPara
           .InsertPara
           .InsertMergeField("name")
           .InsertPara
           .InsertMergeField("address")
           .InsertPara
           .InsertMergeField("city")
           .Insert(", ")
           .InsertMergeField("state")
           .InsertPara
           .InsertMergeField("zipcode")
           .InsertPara
           .InsertPara
           .InsertPara
           .Insert("Dear ")
           .InsertMergeField("name")
           .Insert(",")
           .InsertPara
           .InsertPara
           .Insert("Thank You For Your Support.")
           .InsertPara
           .InsertPara
           .InsertPara
           .Insert("Sincerely,")
           .InsertPara
           .InsertPara
           .InsertPara
           .Insert("Your Name")

           * Merges data records with the main document
           .MailMergeToDoc

           * Saves the active document with the specified name
           .FileSaveAs("c:\lett.doc")
         ENDWITH
       ENDPROC
    ENDDEFINE

    * Class definition for the command button. When the user clicks
    * the command button, the form is released.

    DEFINE CLASS cmdquit AS COMMANDBUTTON
       Width=50
       Height=25
       Caption = "Quit"

       PROCEDURE CLICK
          ThisForm.Release
          CLEAR EVENTS
       ENDPROC
    ENDDEFINE

</PRE><P><LI>Save and run the program.
<P>
</OL><h3>Syntax for MailMergeOpenDataSource</h3>
 
MailMergeOpenDataSource(Name[,ConfirmConversions][,ReadOnly]
[,LinkToSource][,AddToMru][,PasswordDoc][,PasswordDot][,Revert][,WritePassw
ordDoc][,WritePasswordDot][,Connection][SQLStatement][,SQLStatement1])
<P>
If you do not know the information needed for the parameters in the
MailMergeOpenDataSource, you can record a macro in Word to get the correct
values.
<P>
<P><h2>REFERENCE</h2>
 
<P>
Microsoft Word, Help; search on: "mail merge"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kb3rdparty kbprg kbole kbhowto<BR>
KBSubcategory: FxinteropOle vfoxwin<BR>
Additional reference words: 3.00 3.00b 5.00 kbstream mailmerge<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
