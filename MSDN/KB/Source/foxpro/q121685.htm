

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: RETURN TO &lt;Filename&gt;.SPR Does Not Work in .APPs or .EXEs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121685">
<META NAME="KBModify" CONTENT="1996/02/16">
<META NAME="KBCreate" CONTENT="1994/10/16">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The RETURN TO           .SPR command does not work if it is executed within an .APP or .EXE file.  WORKAROUND  The RETURN TO           .SPR command will work if it is changed to RETURN TO           .PRG. However, this method has a drawback: Every t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAVX,QAVW,QBV8,QAB9,QAAP,QAB4,QBT6,QAKJ,QBV4,QAMA,QALW,QAH4,QA2S,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: RETURN TO &lt;Filename&gt;.SPR Does Not Work in .APPs or .EXEs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121685</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The RETURN TO &lt;filename&gt;.SPR command does not work if it is executed within
an .APP or .EXE file.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The RETURN TO &lt;filename&gt;.SPR command will work if it is changed to RETURN
TO &lt;filename&gt;.PRG. However, this method has a drawback: Every time you
modify and regenerate your screen (.SCX), you have to issue the RENAME
command to rename the newly generated screen to a .PRG file.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In the FoxPro Command window, issue the following command:
<P>
   MODIFY COMMAND MAIN

<P><LI>Type the following code in MAIN.PRG and save it:
<P>
   ON ERROR DO errhand WITH ERROR( )
<PRE>   DO test.spr    &amp;&amp; GET field should cause an error

   PROCEDURE errhand
   PARAMETER merror
   WAIT WINDOW "Error occured: "+STR(merror)
   RETURN TO test.spr

</PRE><P><LI>In the FoxPro Command window, issue the following command:
<P>
   CREATE SCREEN TEST

<P><LI>Add an input field with M.CHOICE in the Input text box and the
   following code in the VALID clause:
<P>
   IF !EMPTY(m.choice)
<P><PRE>      WAIT WINDOW "Something in field" &amp;&amp; cause error to occur
</PRE>   ENDIF

<P><LI>Add a push button with OK as the prompt and the Terminate READ On
   Selection option selected. Enter any variable in the Variable text
   box.

<P><LI>Save the screen.

<P><LI>In the FoxPro Command window, issue the following command:
<P>
   CREATE PROJECT MYTEST

<P><LI>Click the Add button to add MAIN.PRG as a Program type. FoxPro
   automatically mark MAIN.PRG as the main program.

<P><LI>Click the Add button again to add TEST.SCX as a Screen type.

<P><LI>Build an application called MYTEST.APP.

<P><LI>Run MYTEST.APP.

<P><LI>Type "123" (without the quotation marks) in the input field on the
   screen and press ENTER.
<P>
   Note that a WAIT window containing the text "Error occured: 16" will be
   displayed in the top-right corner. Press any key. RETURN TO TEST.SPR in
   the error routine will return to the Command window instead of to the
   OK button.

<P><LI>Run MAIN.PRG.

<P><LI>Repeat step 13.
<P>
</OL>Note that RETURN TO TEST.SPR returns to the OK button on the screen. The
READ is still active.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin buglist2.50 buglist2.50a buglist2.50b<BR>
buglist2.60 buglist2.60a 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
