

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Filtered POPUP Displays Improperly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108671">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1993/12/15">
<META NAME="Keywords" CONTENT="kbdisplay kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you move to the bottom of a popup based on a filtered set of data, there appear to be a series of blank lines. If you move the highlight bar, additional records appear in the popup. When you move to the very top of the popup, a record that is ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QACI,QA9N,QAKP,QAVX,QAVW,QDMH,QAAF,QAKC,QAKD,QAH4,QAG2,QBXS,QBVV,QBER V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Filtered POPUP Displays Improperly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108671</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you move to the bottom of a popup based on a filtered set of data,
there appear to be a series of blank lines. If you move the highlight bar,
additional records appear in the popup. When you move to the very top of
the popup, a record that is not in the filter condition will appear. This
is the record prior to the first record in the filter condition. These
symptoms will also appear in an @ ... GET-List that is based on a filtered
popup.
<P>
NOTE: This display problem does not occur in FoxPro for MS-DOS.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
One workaround to this problem is to replace the following code
<P>
<PRE>   SET FILTER TO listitem="This is test2"

</PRE>with an SQL-SELECT command that creates a temporary cursor on which the
popup is based. For example:
<P>
<PRE>   SELECT * FROM testlist ;
            WHERE testlist.listitem="This is test2" ;
            INTO CURSOR tmptable

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Copy the following code into a program and execute it:
<P>
<P><PRE>      *\\ Create a temporary table
      CREATE CURSOR testlist (listitem C(20))
</PRE><P>
<P><PRE>      *\\ Insert 770 records with a value of "This is a test"
      FOR i = 1 TO 770
<PRE></PRE>           INSERT INTO testlist (listitem) ;
                         VALUES ("This is a test")
      ENDFOR

      *\\ Insert 770 records with a value of "This is test2"
      FOR i = 1 TO 770
           INSERT INTO testlist (listitem) ;
                         VALUES ("This is test2")
      ENDFOR

      *\\ Set a filter for records containing "This is test2"
      SET FILTER TO listitem="This is test2"

      *\\ Define and activate the popup
      DEFINE POPUP listpop ;
             FROM 2, 1 TO 15,20 ;
             PROMPT FIELD listitem ;
              SCROLL

      ACTIVATE POPUP listpop

</PRE><P><LI>Move to the bottom of the visible list of records in the popup. You
   should see a blank area. If you use the mouse to highlight the bar
   following the last visible record, another record becomes visible.
   Several of these "invisible" records may become visible as you highlight
   them.

<P><LI>Move to the top of the list of records. A blank line should appear as
   the first "record" in the list. If you use the mouse to highlight this
   bar, you should see "This is a test." This record should not appear
   because it is outside the filter condition.
<P>
</OL>NOTE: When the number of iterations in both FOR loops is changed from 770
to 502, the problem does not occur. When the value in one of the FOR loops
is changed from 502 to 503, the problem occurs. This seems to indicate that
the problem is related to the number of records in the table. However, when
tested on different machines, the number of iterations needed in the FOR
loops to resolve the problem varied.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxWin 2.50 2.50a 2.50b list listbox<BR>
empty 2.60<BR>
2.60a<BR>
buglist2.50 buglist2.50a buglist2.50b buglist2.60 buglist2.60a<BR>
KBCategory: kbdisplay kbprg kbbuglist<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
