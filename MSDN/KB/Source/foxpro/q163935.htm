

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Error "Invalid Page Fault" When Connecting to Sybase </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163935">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1997/02/20">
<META NAME="Keywords" CONTENT="BUGLIST3.00 BUGLIST3.00b BUGLIST5.00 FxprgClientsvr kb3rdparty vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following error occurs after disconnecting from Sybase server and reconnecting:      VFP caused an invalid page fault in module LIBCOMN.DLL   This error occurs if the SQLCONNECT() function is used for connecting, and two or more connections hav...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QAAP,QAJW,QAB4,QANY,QAML,QAO4,QAKC,QAKP,QBE7,QBE6,QAY5,QAH4,QBC6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error "Invalid Page Fault" When Connecting to Sybase</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163935</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error occurs after disconnecting from Sybase server and
reconnecting:
<P>
<PRE>   "VFP caused an invalid page fault in module LIBCOMN.DLL"

</PRE>This error occurs if the SQLCONNECT() function is used for connecting, and
two or more connections have been made to Sybase 10 or 11. When any
connection that was created before the last connection is terminated and
then another connection is created, the error occurs. However, it only
occurs with Sybase and the Sybase ODBC driver from Intersolv. Other
database servers, such as SQL Server and Oracle, work correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If an SQL connection is created with the SQLCONNECT() function, a numerical
value is stored to the connection handle of the connection. If the value is
greater than zero, then the connection is valid. The first connection
usually has a value of one, and the second of two, and so forth. When one
of the connections before the last connection is terminated, that
termination leaves a lower number available for a future connection to use.
Creating a new connection that uses one of these lower numbers causes the
error.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Issuing the following code in a program (.PRG) file or from the Command
window will cause the error to occur. After issuing each SQLCONNECT()
function, you need to select the data source for Sybase and enter the
correct UserId and password in the Logon dialog box. Note that x and y must
return numbers greater than zero to ensure a valid connection:
<P>
<PRE>      x = SQLCONNECT()
      ? x
      y = SQLCONNECT()
      ? y
      = SQLDISCONN(x)
      z = SQLCONNECT()
      ? z
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : BUGLIST3.00 BUGLIST3.00b BUGLIST5.00 FxprgClientsvr kb3rdparty vfpbug5.0a kbbuglist<BR>
Version             : 5.0a 3.0 3.0b 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
