

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: DBSETPROP() for DataType Gives Incorrect Results </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140303">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/11/29">
<META NAME="Keywords" CONTENT="buglist3.00 DBGETPROP fixlist5.00 FxotherGeneral vfoxwin kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the DBSETPROP command to change the datatype property of a field for a remote view gives incorrect results for the number(N) and float(F) fields. Attempting to change the number of decimal positions for type float(F) results in asterisks appe...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QACI,QAKC,QBC6,QAL3,QAJP,QAG8,QBWT,QAR4,QADK,QAB4,QAGI,QBV8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: DBSETPROP() for DataType Gives Incorrect Results</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140303</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the DBSETPROP command to change the datatype property of a field for
a remote view gives incorrect results for the number(N) and float(F)
fields. Attempting to change the number of decimal positions for type
float(F) results in asterisks appearing in the field. Changing the number
of decimal positions displayed for a numeric field changes only the results
in the active cell in a Browse window. You can change the numbers of
positions displayed in Double (B) fields, and the Browse window will
reflect the correct number of positions displayed for active and inactive
cells. Currency (Y) fields always display four decimal places. Attempts to
change this result in the following error message when the BROWSE command
is issued:
<P>
<PRE>   Datatype property for field 'fieldname' is invalid

</PRE><h2>WORKAROUND</h2>
 
<P>
Float fields and numeric fields behave the same way. Use N instead of F
when trying to change the number of displayed positions for a float field.
However, the new number of decimal positions displayed only effects the
active cell in a browse.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Type the following commands in the Command window:
<P>
   CREATE DATABASE decimal
   CREATE TABLE decimal (afloat f(10,5), anumeric n(10,5), ;
<P><PRE>      adouble b(5), acurrency y(10,4))
</PRE>
<P><LI>Use the Upsizing Wizard to upsize the table to SQL Server.

<P><LI>Type the following command in the Command window:
<P>
   SET DECIMALS to 3

<P><LI>Create a remote view of the table called rem_dec.
<P>
   Notice all fields come in with three decimals except currency, which
   comes in with four decimals.

<P><LI>For each of the following DBSETPROP() function calls, close the view,
   issue the function call, and then browse the view.
<P>
   =DBSETPROP("rem_dec.anumeric","field","datatype","N(10,2)")
   * The number of decimal positions displayed is still three. If the
   * insertion point is placed on that field, the record highlighted will
   * show two decimal positions.
<P>
   =DBSETPROP("rem_dec.adouble","field","datatype","B(10,2)")
   * The number of decimal positions displayed changes to two.
<P>
   =DBSETPROP("rem_dec.acurrency","field","datatype","Y(10,2)")
   * Trying to browse the view will produce the error message "Datatype
   * property for field 'acurrency' is invalid." Resetting the number of
   * decimals to four will allow the view to be browsed again.
<P>
   =DBSETPROP("rem_dec.afloat","field","datatype","F(10,2)")
   * The field displays asterics. Using N instead of F allows the field
   * to be viewed, but the results will be the same as they were for the
   * numeric field.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxotherGeneral VFoxWin DBGETPROP buglist3.00 fixlist5.00<BR>
Additional reference words: 3.00<BR>
Keywords          : buglist3.00 DBGETPROP fixlist5.00 FxotherGeneral vfoxwin kbbuglist kbfixlist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
