

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: DDE with Word 97 Returns 'Ambiguous Name Detected: TmpDDE' </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174966">
<META NAME="KBModify" CONTENT="1997/12/26">
<META NAME="KBCreate" CONTENT="1997/10/10">
<META NAME="Keywords" CONTENT="FoxWin FxinteropDde FxinteropWinword vfoxwin kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using the DDEExecute() function to send a WordBasic command to Word 97 from FoxPro, Visual Basic for Applications returns the following error message:     Ambiguous Name Detected: TmpDDE  CAUSE =====  This message is returned by Visual Basic f...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QBS0,QDKX,QAUJ,QABA,QA36,QAUD,QAN1,QA7H,QANG,QBJZ,QBWS,QDO7,QDH3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: DDE with Word 97 Returns 'Ambiguous Name Detected: TmpDDE'</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174966</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the DDEExecute() function to send a WordBasic command to Word 97
from FoxPro, Visual Basic for Applications returns the following error
message:
<P>
<PRE>   Ambiguous Name Detected: TmpDDE

</PRE><h2>CAUSE</h2>
 
<P>
This message is returned by Visual Basic for Applications when the Word
Global Template (Normal.dot) contains a macro named TmpDDE, and an attempt
is made to execute a Word command using the FoxPro DDEExecute( ) function.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This problem may be resolved by any of the following methods:

<UL><LI>Deleting the TmpDDE macro from the MS Word Global Template (Normal.dot)
   file.
<P>
 -or-

<LI>Renaming the Microsoft Word Global Template (Normal.dot) file.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When DDEExecute(nChannel,"[WordCommand]") is used to pass a command to Word
97, Word 97 attempts to create a new TmpDDE macro in the Global Template
(Normal.dot) file. The TmpDDE macro is released after the Word Command
passed by DDEExecute() is executed. Word 97 is unable to create the TmpDDE
macro if the Global Template (Normal.dot) contains an existing macro of the
same name. This behavior is not observed when macros with names other than
TmpDDE are present in the Global Template (Normal.dot) file
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open Microsoft Word 97.

<P><LI>Create a Word document named Testdoc.doc and save it in the
   c:\program files\microsoft office\office folder.

<P><LI>From the File menu, select Open and select Normal.dot usually located
   in the c:\program files\microsoft office\templates folder.

<P><LI>From the Tools menu, select Macro, and click Macros.

<P><LI>In the "Macros in" box of the Macros dialog box, select
   Normal.dot(global template).

<P><LI>Enter TmpDDE in the Macro Name Field.

<P><LI>Click Create to open the Visual Basic for Applications Code window.

<P><LI>Save the macro.

<P><LI>Exit Visual Basic for Applications and Word 97.

<P><LI>Open FoxPro for Windows 2.x or Visual FoxPro 3.0x or 5.0x.

<P><LI>Create a program file called test, containing the following code:
<P>
<P><PRE>      RUN /n "c:\program files\microsoft office\office\winword.exe"
      wordchannel = DDEInitiate("Winword","System")
      docname = "c:\program files\microsoft office\office\testdoc.doc"
      =DDEExecute(wordchannel, '[FileOpen .name="'+docname+'"]')
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q165860.htm">Q165860</A></B>
   TITLE     : OFF97 Err Msg: "Ambiguous Name Detected" Appears When Faxing
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 WORD97 DDE<BR>
Keywords          : FoxWin FxinteropDde FxinteropWinword vfoxwin kberrmsg<BR>
Version           : WINDOWS:2.5,2.5a,2.5b,2.6,2.6a,3.0,3.0b,5.0,5.0a,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
