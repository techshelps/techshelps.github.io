

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: SHOW GETS Does Not Clear List Box on Empty Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105587">
<META NAME="KBModify" CONTENT="1997/10/14">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The SHOW GETS command does not clear a list box when a SET FILTER command is used to simulate a parent-child relationship.  This behavior occurs only when you are moving from a record in the  parent  database that has a matching  child  record to a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAEF,QA5V,QAJX,QADR,QACI,QA9N,QAEN,QAKD,QAKC,QBXS,QA2Q,QAY4,QAR4,QAXC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: SHOW GETS Does Not Clear List Box on Empty Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105587</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SHOW GETS command does not clear a list box when a SET FILTER
command is used to simulate a parent-child relationship.
<P>
This behavior occurs only when you are moving from a record in the
"parent" database that has a matching "child" record to a parent
record that does not have a matching child record. The list box
displaying the child record should clear, but instead continues to
display the previous values.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro 2.5 for
Windows. This problem was corrected in FoxPro 2.5a for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
NOTE: In the following program, a filter is set on the INVOICES
database in order to display the INO field for all INVOICES related to
the current customer.

<OL><P><LI>Create and run a program with the following code:
<P>
<P><PRE>      CREATE TABLE customer (cno C(5), contact C(35))
      CREATE TABLE invoices (ino N(4), cno C(5))
</PRE><P>
<P><PRE>      INSERT INTO customer (cno, contact) VALUES ;
<PRE></PRE>         ('10000', '1st Computers')
      INSERT INTO customer (cno, contact) VALUES ;
         ('20000', 'A. Arts Computers')
      INSERT INTO customer (cno, contact) VALUES ;
         ('30000', 'Balance Computing Systems')

      INSERT INTO invoices (ino, cno) VALUES ;
         (1111, '10000')
      INSERT INTO invoices (ino, cno) VALUES ;
         (3333, '30000')

      SELECT customer
      GO TOP
      SELECT invoices
      SET FILTER TO invoices.cno = customer.cno
      *   (The filter controls what appears in the list box.)
      SELECT customer

      DEFINE WINDOW test ;
         FROM 0, 0 ;
         TO 10, 60

      DEFINE POPUP lpop ;
         PROMPT FIELD invoices.ino ;
         SCROLL ;
         MARGIN

      ACTIVATE WINDOW test

      @ 1, 1 SAY "Customer# "
      @ 1, 13 GET customer.cno ;
         SIZE 1,5 ;
         DEFAULT " "

      @ 2, 1 SAY "Contact"
      @ 2,13 GET customer.contact ;
         SIZE 1, 35 ;
         DEFAULT " "

      @ 4,30 GET x ;
         PICTURE "@*HN next" ;
         SIZE 2,14,1 ;
         DEFAULT 1 ;
         VALID xval()

      @ 4,7 GET y ;
         PICTURE "@&amp;N" ;
         POPUP lpop ;
         SIZE 4, 15 ;
         DEFAULT " "

      READ CYCLE
      CLEAR ALL

      FUNCTION xval
      SELECT customer
      SKIP
      SELECT invoices
      GO TOP     &amp;&amp; Move record pointer to update filter in INVOICES.
      SHOW GETS  &amp;&amp; This doesn't always properly refresh the list box.

   Note that the first Customer#, "10000," and Contact, "1st
   Computers," are displayed, along with the matching Invoice number,
   "1111," in the list box.

</PRE><P><LI>Choose the Next button. The next Customer#, "20000," and Contact,
   "A. Arts Computers," display, but the invoice number is still
<PRE>   '1111.' The expected behavior is for the list box to clear.

</PRE><P><LI>Choose the Next button again. The last Customer#, "30000," and
   Contact, "Balance Computing Systems," display along with the
   matching invoice number, "3333."
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 buglist2.50 fixlist2.50a empty<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
