

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Enforce Uniqueness in Visual FoxPro Memo Fields </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148894">
<META NAME="KBModify" CONTENT="1996/04/01">
<META NAME="KBCreate" CONTENT="1996/03/25">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to enforce uniqueness in memo fields.  MORE INFORMATION  Example Scenario  When you have a long character field that happens to be rarely filled, it might be better to store the data in a memo field instead of a ch...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QATJ,QA28,QAZV,QAJQ,QBWS,QBJZ,QBWA,QBFY,QA56,QA55,QA2Q,QAMB,QALQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Enforce Uniqueness in Visual FoxPro Memo Fields</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148894</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to enforce uniqueness in memo fields.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example Scenario</h3>
 
<P>
When you have a long character field that happens to be rarely filled, it
might be better to store the data in a memo field instead of a character
field. The memo field takes up only four bytes in the table, and the large
character field can now be removed from the structure.
<P>
You can use the following step-by-step procedure to create a unique index
tag on just a portion of the data in the memo field. The benefits of this
process are:

<UL><LI>Guaranteed uniqueness in large data sets.

<LI>The tag size remains the same as it was.

<LI>The size of the .dbf file shrinks dramatically.
<P>
</UL><h3>Step-by-Step Procedure</h3>
 

<OL><P><LI>Create a new database (.dbc file):
<P>
   a. On the File menu, click New.
   b. Select Database, and then click the New File button.
   c. Place the new database (.dbc file) in the directory of your choice.

<P><LI>Add a table to the database:
<P>
   a. Right-click the Database Designer, and select New Table.
   b. Click the New Table button.
   c. Create the table in the directory of your choice.
   d. In the Table Designer, add a memo field.

<P><LI>Add a Unique Index Tag to the Table:
<P>
   a. Click the Index tab.
   b. Under Name, type the name of your memo field.
   c. Under Type, select Primary or Candidate (Unique won't work).
   d. For the expression, enter the following where MaxLen is any value up
<P><PRE>      to the maximum of 240:
</PRE><P>
<P><PRE>      PADR(MemoField, MaxLen)
</PRE>
<P><LI>Add several records to the table with exactly the same content in the
   memo field to verify a proper setup.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgGeneral
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
