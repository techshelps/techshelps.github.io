

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: View Not Accurate with One-to-Many Grandchild Relation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139183">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxotherGeneral vfoxwin vfpbug5.0a kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use the SET RELATION TO and SET SKIP TO commands to relate a parent table into many records in a child table that relates to many records in a grandchild table, the view window may actually indicate that a one-to-one relationship exists fr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWI,QBXS,QAY4,QAGB,QACI,QADK,QA9N,QBWA,QA28,QATJ,QAMB,QAKD,QAEN,QDI1,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: View Not Accurate with One-to-Many Grandchild Relation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139183</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SET RELATION TO and SET SKIP TO commands to relate a
parent table into many records in a child table that relates to many
records in a grandchild table, the view window may actually indicate that a
one-to-one relationship exists from the child table into the grandchild
table.
<P>
<P><h2>CAUSE</h2>
 
<P>
The display of the relation between the child and grandchild table in the
view window is incorrect.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To determine if the relation is constructed properly, use the BROWSE FIELDS
or LIST FIELDS command with fields from the parent, child, and grandchild
tables to verify that the relation is correct.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code to Demonstrate Problem</h3>
 
<P>
*beginning of code
WAIT WINDOW "For the following to work," + ;
<PRE>    CHR(13) + "Please take your hand off the mouse" ;
    TIMEOUT 2

</PRE>CLOSE DATA
<P>
* create the testing tables
SET SAFETY OFF
CREATE TABLE customer (cno c(5), company c(20))
INSERT INTO customer (cno, company) VALUES ("B9278","1st record")
CREATE TABLE invoices (cno c(5), ino N(4,0))
INSERT INTO invoices (cno, ino) VALUES ("B9278",1106)
INSERT INTO invoices (cno, ino) VALUES ("B9278",1107)
CREATE TABLE detail (ino N(4,0), pno c(5))
INSERT INTO detail (ino, pno) VALUES (1107,"AAAAA")
INSERT INTO detail (ino, pno) VALUES (1107,"BBBBB")
INSERT INTO detail (ino, pno) VALUES (1107,"CCCCC")
INSERT INTO detail (ino, pno) VALUES (1106,"AAAAA")
INSERT INTO detail (ino, pno) VALUES (1106,"BBBBB")
SET SAFETY ON
CLOSE ALL
<P>
USE detail.DBF EXCLUSIVE IN 0
SELECT detail
DELETE TAG ALL
INDEX ON ino TAG ino
SET ORDER TO ino
<P>
USE invoices.DBF EXCLUSIVE IN 0
SELECT invoices
DELETE TAG ALL
INDEX ON cno TAG cno
SET ORDER TO cno
SET RELATION TO ino INTO detail
SET SKIP TO detail
USE customer.DBF IN 0
SELECT customer
SET RELATION TO cno INTO invoices
SET SKIP TO invoices
WAIT WINDOW "Notice how the relation looks in the view"+ ;
<PRE>    CHR(13)+"Press ESC to continue" NOWAIT
</PRE>ACTIVATE WINDOW VIEW
BROWSE FIELDS customer.cno, invoices.ino, detail.pno
CLOSE ALL
<P>
CLOSE DATA
USE detail.DBF EXCLUSIVE IN 0
SELECT detail
DELETE TAG ALL
INDEX ON ino TAG ino
SET ORDER TO ino
USE invoices.DBF EXCLUSIVE IN 0
SELECT invoices
DELETE TAG ALL
INDEX ON cno TAG cno
SET ORDER TO cno
SET RELATION TO ino INTO detail
<P>
*set skip to detail
USE customer.DBF IN 0
SELECT customer
SET RELATION TO cno INTO invoices
SET SKIP TO invoices, detail
WAIT WINDOW "NOW notice how the relation looks in the view"+ ;
<PRE>    CHR(13)+"Press ESC to continue" NOWAIT
</PRE>ACTIVATE WINDOW VIEW
BROWSE FIELDS customer.cno, invoices.ino, detail.pno
CLOSE ALL
<P>
<PRE>KEYBOARD("{ESC}")     &amp;&amp; to remove view window

</PRE>*end of code
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxotherGeneral vfoxwinbuglist3.00 buglist5.00 buglist3.00b<BR>
Additional reference words: 5.00 3.00 3.00b<BR>
Keywords          : buglist3.00 buglist3.00b buglist5.00 FxotherGeneral vfoxwin vfpbug5.0a kbprg kbbuglist<BR>
Version           : 3.0 3.0b 5.0 5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
