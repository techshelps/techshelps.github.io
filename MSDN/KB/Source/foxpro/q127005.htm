

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: UP/DOWN Arrow Keys Call Click Event in Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127005">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/03/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Pressing the UP or DOWN arrow in a list box triggers the Click event.  CAUSE =====  This behavior is by design. When the arrow keys are pressed to navigate through a list, the value associated with the list is modified. This triggers the Click even...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBVR,QAO4,QAUD,QAO2,QBWS,QAHP,QATP,QAML,QAKD,QAH4,QABI,QAJD,QAE1,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: UP/DOWN Arrow Keys Call Click Event in Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Pressing the UP or DOWN arrow in a list box triggers the Click event.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is by design. When the arrow keys are pressed to navigate
through a list, the value associated with the list is modified. This
triggers the Click event.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you do not want to execute the code in the Click event handler, you can
verify the value of the last keypress when the Click event is triggered. If
the LASTKEY() function returns the value of the UP or DOWN arrow keys,
issue a RETURN in your routine.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Click event handler routine is also executed in the following
scenarios:
<P>
- When the Spacebar is pressed on a command button, check box, or option
<PRE>  button.

</PRE>- When the Enter key is pressed on a command button, check box, text box,
<PRE>  or option button.

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following code will demonstrate that the Click event is triggered when
the UP or DOWN arrows are pressed in a list box. It also illustrates the
alternative of verifying the value of the last key pressed.
<P>
<PRE>   ofrm1 = CREATEOBJECT('frm1')
   ofrm1.show
   READ EVENTS

   ***********************
   ** Class definitions **
   ***********************

   DEFINE CLASS frm1 AS for form
      ScaleMode=3
      ADD OBJECT lsttest AS lstclick
      ADD OBJECT cmdtest AS cmdquit
      Caption = "Press the Up and Down Arrow keys"
   ENDDEFINE

   DEFINE CLASS lstclick AS list box
   * Defines a list with hard coded values

      RowSourceType = 1    &amp;&amp; Value
      RowSource = "1,2,3"  &amp;&amp; List of numbers to be displayed
      Height = 85
      Left = 84
      Top = 60

      PROCEDURE Click
      IF LASTKEY()= 5  OR LASTKEY()=24 &amp;&amp;Traps for the Up or Down arrow
        RETURN .T.
      ELSE
        WAIT WINDOW "Click has been pressed in the list box"
      ENDIF
      ENDPROC
   ENDDEFINE

   * Define a Quit command button that releases the form
   DEFINE CLASS cmdquit AS Commandbutton
      Top=150
      Left=84
      Caption= "Quit"

      PROCEDURE click
      RELEASE Thisform
      CLEAR EVENTS
      ENDPROC
   ENDDEFINE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
