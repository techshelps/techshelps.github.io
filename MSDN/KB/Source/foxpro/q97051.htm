

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Report Variables Calculated Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97051 ">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1993/04/06">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Variables defined in the Report Writer appear to be calculated incorrectly.  CAUSE =====  The variable that appears to be calculated incorrectly is making reference to another, as yet undefined, variable. This is because variables are defined and c...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QBXS,QA50,QAY2,QAE1,QBWS,QAE5,QAG2,QA5V,QAAP,QAD7,QAP2,QA5D,QAHP,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Report Variables Calculated Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97051 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Variables defined in the Report Writer appear to be calculated
incorrectly.
<P>
<P><h2>CAUSE</h2>
 
<P>
The variable that appears to be calculated incorrectly is making
reference to another, as yet undefined, variable. This is because
variables are defined and calculated in the order they are listed in
the variable list.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In the variable list, change the order of the variables so that if a
variable (mvarA) makes reference to another variable (mvarB) in the
Value To Store box, the referenced variable (mvarB) appears earlier in
the variable list. See below for a detailed explanation of the problem
and its resolution.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In the Command window, type the following:
<P>
<P><PRE>      USE \FOXPRO2\TUTORIAL\CUSTOMER.DBF
</PRE><P>
   (The directory specified will depend on the version of FoxPro and
   where it is stored on the system.)

<P><LI>In the Command window, type:
<P>
<P><PRE>      CREATE REPORT VARTEST.FRX
</PRE>
<P><LI>Create three variables as follows:
<P>
   a. From the Report menu, choose Variables.
   b. Choose the Add button.
   c. In the Variable Name box, type "maverage" (without the quotation
<P><PRE>      marks).
</PRE>   d. In the Value To Store box, type "msum/mcount" (without the
<P><PRE>      quotation marks).
</PRE>   e. Choose the OK button.
   f. Choose the Add button.
   g. In the Variable Name box, type "msum" (without the quotation
<P><PRE>      marks).
</PRE>   h. In the Value To Store box, type "customer.ytdpurch" (without the
<P><PRE>      quotation marks).
</PRE>   i. Under Calculate, select the Sum option button.
   j. Choose the OK button.
   k. Choose the Add button.
   l. In the Variable Name box, type "mcount" (without the quotation
<P><PRE>      marks).
</PRE>   m. In the Value To Store box, type "customer.ytdpurch" (without the
<P><PRE>      quotation marks).
</PRE>   n. Under Calculate, select the Count option button.
   o. Choose the OK button.
   p. In the Report Variables dialog box, choose the OK button.

<P><LI>Move to a Detail line and add the following fields:
<P>
<P><PRE>    - customer.ytdpurch (from database field list)
    - msum (from variable list)
    - mcount (from variable list)
    - maverage (from variable list)
</PRE>
<P><LI>From the Report menu, choose Page Preview.
<P>
   Note that the first "Average" is ******** (it should be equal to
   the sum). Also note that the second average uses the sum and count
   from the first record instead of the second record.
<P>
</OL>To correct the problem in this case:

<OL><P><LI>From the Report menu, choose Variables.

<P><LI>In the Variables list, highlight maverage.

<P><LI>Drag maverage to the end of the list (or hold down the CTRL key
   while pressing the DOWN ARROW key).

<P><LI>Choose the OK button.

<P><LI>From the Report menu, choose Page Preview.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a RWriter<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxtoolRwriter<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
