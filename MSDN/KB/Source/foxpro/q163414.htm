

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Cannot Specify Icon or SmallIcon for ListView Visually </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163414">
<META NAME="KBModify" CONTENT="1997/06/17">
<META NAME="KBCreate" CONTENT="1997/02/10">
<META NAME="Keywords" CONTENT="FxinteropOcx FxinteropOle FxprgClassoop vfoxwin kbinterop kbole kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A form containing the ListView control suddenly loses the images shown in the listview. This happens after the form has been modified and any property of the ListView has been changed.  CAUSE =====  Right-clicking on the ListView control in the For...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QAB5,QAOE,QAMN,QBBI,QA56,QA55,QA01,QABA,QAE1,QBWC,QDL9,QBXS,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Specify Icon or SmallIcon for ListView Visually</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163414</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00
WINDOWS
kbinterop kbole kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A form containing the ListView control suddenly loses the images shown in
the listview. This happens after the form has been modified and any
property of the ListView has been changed.
<P>
<P><h2>CAUSE</h2>
 
<P>
Right-clicking on the ListView control in the Form Designer will reveal a
context menu. The bottom bar of that menu opens the ListViewCtrl Properties
dialog box that holds a pageframe with four pages. Page 2 has the caption
"Image Lists." It holds two combo box controls labeled "Normal" and "Small"
(without the quotes.)
<P>
Comctl32.dll contains both the Imagelist control and the ListView control.
<P>
With the version of Comctl32.dll that originally came with Visual FoxPro
5.0, the Imagelists to be used for normal and small icons with the ListView
control could be selected from those combo boxes on the "Image List" page
of the ListViewCtrl Properties dialog box. You could drop either combo box
down and see all of the Imagelist controls on the current form. Typically,
there would be two, but the application design might require even more. A
ListView for each size icon can be associated with only one Imagelist and
different Imagelists must be used for each size.
<P>
Several Microsoft developer products released since Visual FoxPro version
5.0 install a revised Comctl32.dll.
<P>
In the Form Designer of Visual FoxPro 5.0, the new version of ListView no
longer lists in the ListViewCtrl properties dialog "Image Lists" page, the
ImageLists that reside on the current form. For each size icon, it shows
the expression [none].
<P>
Clicking the "Apply" button at the bottom of the page sets all of the
properties to the settings shown, so the new ImageList properties are
"none."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The ImageLists must be specified in code. For example, if the form has an
Imagelist for normal-sized icons in the OLE container control
"OleControl1," and one for small icons in "OleControl2," then you need to
add two commands similar to the following in the init event method for the
OLE container control that holds the ListView:
<P>
<PRE>      This.object.icon = thisform.olecontrol1.object
      This.object.smallicon = thisform.olecontrol2.object

</PRE>The above is only a suggestion. The specifics of the application will
determine where to make the modification and the appropriate syntax to use.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
In Microsoft Visual FoxPro for Windows version 5.0:

<OL><P><LI>In the Form Designer, modify a form using the ListView control. The form
   should have been designed using the ListViewCtrl Properties dialog.

<P><LI>Modify any property of the ListView in the ListViewCtrl Properties
   dialog box.

<P><LI>Choose Apply and then choose OK.
<P>
</OL>The value "[none]" is now saved as the Imagelist "Icon" and "SmallIcon"
properties. Consequently, no ImageList is specified for either the Icon or
SmallIcon source of the ListView.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbole kbprb<BR>
KBSubcategory: FxinteropOle FxinteropOcx FxprgClassoop vfoxwin<BR>
Additional reference words: 5.00<BR>
Keywords            : FxinteropOcx FxinteropOle FxprgClassoop vfoxwin kbinterop kbole kbprb<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
