

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Multiple Iterations of ACTIVATE POPUP Cause GP Fault </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108718">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1993/12/16">
<META NAME="Keywords" CONTENT="kbenv kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Performing many iterations of the ACTIVATE POPUP command in a loop causes an  Insufficient Memory  error to occur. In addition, the arrows in the scroll bars of the Command window may disappear and GDI memory will be exhausted.  CAUSE =====  ACTIVA...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QAAF,QA7R,QAB4,QBXS,QAX0,QANE,QAKP,QDNY,QDL9,QBW6,QBWQ,QBWO,QBWN,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Multiple Iterations of ACTIVATE POPUP Cause GP Fault</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108718</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, and 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Performing many iterations of the ACTIVATE POPUP command in a loop causes
an "Insufficient Memory" error to occur. In addition, the arrows in the
scroll bars of the Command window may disappear and GDI memory will be
exhausted.
<P>
<P><h2>CAUSE</h2>
 
<P>
ACTIVATE POPUP uses Window's graphic device interface (GDI) resources.
DEACTIVATE POPUP does not release GDI resources. Once the GDI resources are
exhausted, Windows will return an "Insufficient Memory" error message or
may even cause a general protection (GP) fault.
<P>
There is no set number of iterations of ACTIVATE POPUP that will trigger an
"Insufficient Memory" message.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid the "Insufficient Memory" message, use a RELEASE POPUP &lt;popupname&gt;
command after the DEACTIVATE POPUP &lt;popupname&gt;.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro versions 2.5, 2.5a,
2.5b, and 2.6 for Windows. We are researching this problem and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
WARNING: Close all running applications and save your data before running
this code.
<P>
<PRE>   FOR pops = 1 TO 100
      WAIT WINDOW "Popup Number "+LTRIM(STR(pops)) NOWAIT
      popname = "pop" + LTRIM(STR(pops))
      DEFINE POPUP (popname) FROM 2, SCOL()/3

      FOR bars = 1 TO 50
         barname = "bar" + LTRIM(STR(bars))
         DEFINE BAR bars OF (popname) PROMPT barname
      ENDFOR

      ACTIVATE POPUP (popname) NOWAIT
      DEACTIVATE POPUP (popname)
   ENDFOR
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b buglist2.50<BR>
buglist2.50a<BR>
buglist2.50b gpf errmsg err msg buglist2.60 2.6<BR>
KBCategory: kbenv kbprg kbbuglist<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
