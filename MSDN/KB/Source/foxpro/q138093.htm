

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Can't Use SET DEFAULT command to Set Default to UNC Path </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138093">
<META NAME="KBModify" CONTENT="1997/07/03">
<META NAME="KBCreate" CONTENT="1995/10/11">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use the SET DEFAULT TO       command where UNC is a network connection using the universal naming convention in Windows 95, the following error occurs:     Invalid path or file name.  Or if you click Do on the Program menu and select a pro...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QAH4,QAC9,QBXS,QABA,QBWS,QDL9,QBWQ,QBWO,QBWN,QAUJ,QBG2,QA56,QA55,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Can't Use SET DEFAULT command to Set Default to UNC Path</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138093</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbnetwork kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SET DEFAULT TO &lt;UNC&gt; command where UNC is a network
connection using the universal naming convention in Windows 95, the
following error occurs:
<P>
<PRE>   Invalid path or file name.

</PRE>Or if you click Do on the Program menu and select a program that has a path
to a network connection not mapped to any drive letter, the following error
occurs:
<P>
<PRE>   File '&lt;program name&gt;' does not exist.

</PRE><h2>CAUSE</h2>
 
<P>
The Visual FoxPro SET DEFAULT command does not support UNC paths used by
Windows 95.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Before attempting to use the SET DEFAULT command to set the default to a
network connection, first map the connection to a drive letter. For
example, say you have a program named Test.prg located in a directory named
Programs on a network node named Shared.

<OL><P><LI>Open the Windows 95 Explorer.

<P><LI>On the Tools menu, click Map Network Drive.

<P><LI>From the Map Network Drive dialog box, select a default drive letter.
   For this example, assume it is drive F: and the Path dialog box has this
   UNC:
<P>
   \\SHARED\PROGRAMS

<P><LI>Set the path to this drive in the Visual FoxPro by typing the following
   in the Command window:
<P>
   SET PATH TO F:\
<P>
</OL><h3>Other Ways to Map the Network Drive</h3>
 
<P>
In this example, the Windows 95 Explorer is not the only way to map the
network drive. On the Start menu, click Find, and then click Computer. In
the dialog box, type:
<P>
<PRE>   \\SHARED

</PRE></OL>Then click the Program directory to highlight it. On the File menu, click
Map Network Drive, and select a drive letter. The Map Network Drive option
is also available in the Network Neighborhood.
<P>
You can resolve the problem by mapping the network drive to a drive letter,
or by adding and removing network connections programmatically from within
Visual FoxPro by using the Windows application programming interface (API)
through Foxtools.fll (a library file included with Visual FoxPro). In this
way, you can programmatically create a connection and map it to a logical
drive letter. For more information about using Foxtools.fll to make a
network connection, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q105042.htm">Q105042</A></B>
   TITLE     : How to Add/Remove Network Connections in FoxPro

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design in Visual FoxPro 3.0. In Visual FoxPro 5.0, the
SET DEFAULT TO command can handle UNC's.
<PRE> \*

</PRE><h2>MORE INFORMATION</h2>
 
<P>
If a shortcut has been created on the Windows 95 desktop that uses a UNC to
locate a program, the following error will also occur if on the Program
menu, you click Do, locate the desktop, and then select the desired
shortcut.
<P>
<PRE>   File &lt;program name&gt; does not exist.

</PRE>To resolve this, you must map the shortcut to a network drive. That network
drive letter must remain the same during all Windows 95 sessions in order
for the shortcut to be successful.
<P>
<P><h3>Steps to Reproduce "Invalid path or filename" Error</h3>
 
<P>
From the Command window type:
<P>
<PRE>   SET DEFAULT TO \\SHARED\PROGRAMS

</PRE>Here SHARED represents the computer or node name and PROGRAMS is a shared
directory on that computer or node.
<P>
<P><h3>Steps to Reproduce "File &lt;Program name&gt; does not exist" Error</h3>
 
<P>
In Visual FoxPro, click Do on the Program menu. In the Do dialog box, click
the Network Neighborhood, locate a network computer where a shared program
is located. Locate the directory and program, double-click the program
file. The error appears at this point.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbnetwork kbprb<BR>
KBSubcategory: FxprgSet<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
