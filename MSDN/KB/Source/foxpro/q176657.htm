

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SET FILTER Command Behaves Differently in a Method or Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176657">
<META NAME="KBModify" CONTENT="1997/11/26">
<META NAME="KBCreate" CONTENT="1997/11/12">
<META NAME="Keywords" CONTENT="FxprgSet FxtoolFormdes vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use the SET FILTER command to control data while in a form, most of the objects in the form disappear or do not display data properly after the SET FILTER command is issued. This problem occurs when you use a variable in the evaluation cla...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAYL,QBXS,QBVR,QBT6,QAO4,QBV4,QBV8,QAB9,QAHP,QA5V,QAH4,QBVV,QAW6,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SET FILTER Command Behaves Differently in a Method or Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176657</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SET FILTER command to control data while in a form, most
of the objects in the form disappear or do not display data properly after
the SET FILTER command is issued. This problem occurs when you use a
variable in the evaluation clause of the SET FILTER command and the command
is executed in an object's method or event. Text and combo boxes may
disappear while grids and list boxes do not show any records. Tabbing or
clicking the location of the objects on the form restores them to their
original values.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you use a variable in a method or event, the variable goes out of
scope unless the variable was available before the form was run.
<P>
<P><h2>RESOLUTION</h2>
 

<UL><LI>Use macro substitution in the SET FILTER command. An example is below:
<P>
<PRE>   xyz = "'M'"             &amp;&amp; Use double quotation marks outside of single
                           &amp;&amp; quotation marks.
   SET FILTER TO &lt;fieldname&gt; = &amp;xyz    &amp;&amp; Using macro substitution.

-or-

</PRE><LI>Create the variable as public before you use it so that the variable
   does not go out of scope after leaving the event that it was created in.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Normally, a query would be used to create a subset of a table based on some
value. The SET FILTER command can also be used to view that subset of data.
Using a variable in the SET FILTER command in one of the object's methods
or events is a problem because the variable goes out of scope after
returning from the method or event. Therefore, the filter is invalid and
the data resets back to all the records.
<P>
Trying to use a property of the form in the SET FILTER command results in
this error:
<P>
<PRE>   Property &lt;property name&gt; is not found.

</PRE>The SET FILTER command does not recognize a property of the form;
therefore, a variable must be used.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form with a text box and a list box.

<P><LI>Add a table into the form's DataEnvironment.

<P><LI>Set the following properties of the list box:
<P>
<P><PRE>      RowSource = &lt;tablename&gt;
      RowSourceType = Alias
</PRE>
<P><LI>Set the ControlSource of the text box to a field in the table.

<P><LI>Create a command button and place the following code in the Click event:
<P>
<P><PRE>      xyz = "M"  &amp;&amp; Depending upon you filter, "M" is just an example.
      SET FILTER TO &lt;fieldname&gt; = xyz &amp;&amp; Use a character field.
      Thisform.List1.Requery
      Thisform.Refresh
</PRE>
<P><LI>Run the form and click the command button. The text box may disappear
   and the list box has no records showing. Click each object to populate
   them with the original data.

<P><LI>Change the code in the Click event to one of the two options described
   in the Resolution section and run the form. The text and list box
   are now populated with the new data.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : FxprgSet FxtoolFormdes vfoxwin<BR>
Version           : WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
