

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: TreeView Control HitTest Method Returns Empty String </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168060">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/05/05">
<META NAME="Keywords" CONTENT="FxinteropOcx vfoxwin kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The TreeView control that is contained within the COMCTL32.OCX, version 1.0.2908, returns NULL from the TreeView HitTest method when there is no Node at the specified coordinates. Version 5.00.3714 of the OCX returns an empty string in Visual FoxPr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAHV,QAPN,QA56,QA55,QALW,QA7O,QAOE,QAMN,QAB5,QAI4,QDIJ,QBXS,QBBS,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: TreeView Control HitTest Method Returns Empty String</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168060</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The TreeView control that is contained within the COMCTL32.OCX, version
1.0.2908, returns NULL from the TreeView HitTest method when there is no
Node at the specified coordinates. Version 5.00.3714 of the OCX returns an
empty string in Visual FoxPro.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The best resolution to this is to disable ActiveX dual interface (VTABLE
binding) support. Issue the =SYS(2333,0) command prior to the instantiation
of the TreeView control. After the control is instantiated, ActiveX dual
interface support can be turned back on if desired. See the SYS(2333)
Online Help topic in Visual FoxPro for more information. Microsoft
Technical Support has found that it is usually best to leave ActiveX dual
interface support disabled.
<P>
If disabling the ActiveX dual interface support is not desired, the
ISBLANK() function can be used in the TreeView HitTest method to return a
NULL value. For example, =IIF(ISBLANK(xHitTest),.NULL.,xHitTest). See the
More Information section below for an example of using this technique.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Comctl32.ocx, version 1.0.2908, returns NULL in the TreeView HitTest method
when there is no Node at the specified coordinates. Version 5.00.3714
returns an empty string. In Visual Basic, both versions of the OCX return
nothing (NULL). Visual FoxPro appears to be handling the return value
differently. The behavior occurs in both Visual FoxPro 5.0 and Visual
FoxPro 5.0a. The newest version of the OCX ships with Visual FoxPro 5.0a.
The following code illustrates the behavior:
<P>
<P>
<PRE>   =SYS(2333,1)                &amp;&amp; to make sure VTABLE binding is on
   *=SYS(2333,0)               &amp;&amp; as a test, unremark this and rerun code
   frmOLEForm=CREATEOBJECT('form')
   frmOLEForm.Show
   =MessageBox('In the next dialog box, choose the "Insert Control" '+ ;
      'button and then the "Microsoft TreeView Control" from the list.',0)
   frmOLEForm.AddObject('OLETree1','olecontrol')
   frmOLEForm.OLETree1.Visible = .T.
   =SYS(2333,1)                &amp;&amp; this is optional

   ACTIVATE SCREEN

   xHitTest=frmOLEForm.OLETree1.HitTest(1,1)
   ? TYPE("xHitTest")
   ? IIF(ISBLANK(xHitTest), 'Empty', xHitTest)
   * The following is the workaround if VTABLE binding is not disabled
   ? IIF(ISBLANK(xHitTest), .NULL., xHitTest)

</PRE>TYPE("xHitTest") should return "O" for object, because, according to the
Help file, the HitTest method returns an object reference. In the newest
version of the OCX and with ActiveX Dual Interface support enabled,
xHitTest will return a Character type ("C") with a value of blank or
"empty."
 
<PRE>Keywords          : FxinteropOcx vfoxwin kbprb
Version           : 5.0 5.0a
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
