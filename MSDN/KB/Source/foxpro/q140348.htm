

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Indent Outline Items Without Using the Indent Property </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140348">
<META NAME="KBModify" CONTENT="1995/12/03">
<META NAME="KBCreate" CONTENT="1995/11/29">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article provides a method that illustrates how to build an outline control and indent the elements in it without using the Indent property. The example code builds a list of program names displayed by extension.  MORE INFORMATION  The sample p...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAIB,QACI,QA9N,QBCD,QAO7,QA2Q,QAKC,QAY4,QAE1,QAG2,QA7O,QAPN,QAOE,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Indent Outline Items Without Using the Indent Property</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 3, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140348</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides a method that illustrates how to build an outline
control and indent the elements in it without using the Indent property.
The example code builds a list of program names displayed by extension.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The sample program included in this article uses two tables and an array.
The first table (MSCodeType) stores file categories (extensions) such as
.prg, .exe, or .app. The second table (MSCodeExamples) lists file names by
category. The array has two dimensions; it records the program categories
and the number of items with this category.
<P>
<P><h3>The Technique Used by the Code Sample</h3>
 
<P>
The code sample uses the following technique.

<OL><P><LI>Build a list of types. The code first builds the list of files from the
   MSCodeType table. It scans the MSCodeType table and places the elements
   in the outline control and in the laNumAdded array.

<P><LI>Add an item. To add an item to the list, the code uses the AddItem
   method. Only one parameter, the string to add to the list, is passed to
   the Additem method. Because no index number is specified, the new item
   is added as a subordinate item, at the end of the list of subordinates
   for the element selected. The ListIndex property is called to select an
   item in the list before inserting a new item.

<P><LI>Select an item in the list. The sample code scans the MSCodeExamples
   table. It locates the program type in the array and increments the
   number of programs with this type. It also selects the parent of the
   item to insert. The ListIndex property is not absolute for an element;
   it varies as elements are inserted into the list, so it is necessary to
   calculate the position of the item in the list each time an element is
   added. The code loops from the current element in the array to the first
   element in the array, summing the number of files to estimate the
   position of the current element to select. The number of file categories
   (the parent in the outline control) is then summed to calculate the list
   position of the current element. For example, if you want to add a .prg
   type file name in the outline control, PRG is stored in the third row
   in the array, so the array appears as follows:
<P>
<PRE>   Row   Program_type  Number_of_Files
   -----------------------------------
   1       EXE             2
   2       HLP             3
   3       PRG             4

   The Outline looks like this:

        EXE
          Exe1
          Exe2
          Exe3
        HLP
          Hlp1
          Hlp2
          Hlp3
        PRG
          Prg1
          Prg2
          Prg3

   The item to select is the PRG category type. The ListIndex of the item
   to select is:

      3+ 2 = 5 (go through the array in descending order, and calculate the
               number of files above).

      5+ 3-1 = 7 (adds the number of categories).

</PRE></OL><h3>Code Sample</h3>
 
<P>
Follow the step-by-step procedure to run this program

<OL><P><LI>Create the data. Copy and paste the following code in a program to
   create a database and two tables.
<P>
   CLOSE ALL
   CREATE DATABASE mscodedbc
<P>
   CREATE TABLE MSCODETYPE (code_description C(3))  &amp;&amp; Adds table to mydbc1
   INSERT INTO mscodetype values ('PRG')
   INSERT INTO mscodetype values ('HLP')
   INSERT INTO mscodetype values ('APP')
   CREATE TABLE MSCodeExamples (program_type C(3), Program_name M)
   INSERT INTO mscodeExamples VALUES ('PRG', 'prgProgram1')
   INSERT INTO mscodeExamples VALUES ('APP', 'appTest1')
   INSERT INTO mscodeExamples VALUES ('HLP','hlpHelp1')
   INSERT INTO msCodeExamples VALUES ('PRG', 'prgProgram2')
   INSERT INTO msCodeExamples VALUES ('HLP','hlpHelp2')

<P><LI>Create a form.

<P><LI>Open the data environment of the form, and add the MSCodeType and the
   MSCodeexamples tables to the Data Environment.

<P><LI>Select the OleContainer from the Form Controls toolbar. Click Select
   control, then click Outline Control. An outline control is placed on the
   form.

<P><LI>Copy the following code and paste it into the Init event of the outline
   control.
<P>
   SELECT MSCodeType
   DIMENSION laNumAdded(RECCOUNT(),2)
<P>
   SCAN
   * Build the code types- the first indent of the outline
<P><PRE>     This.AddItem(MSCodeType.Code_Description)
     laNumAdded(RECNO(),1) = 0
     laNumAdded(RECNO(),2) = MSCodeType.Code_Description
</PRE>   ENDSCAN
   * The table that contains file names
   SELECT MSCodeExamples
   SCAN
<P><PRE>     nIsTypeInArray=ASCAN(lanumadded,MSCodeExamples.Program_type)
     nRow=ASUBSCRIPT(lanumadded,nIsTypeInArray,1)
</PRE>   * Find the position of the category in the array
<P><PRE>     laNumAdded(nRow,1) =laNumAdded(nrow,1) + 1
     This.ListIndex = 0  &amp;&amp; No item selected
</PRE>   * Loop through the array
<P><PRE>     FOR I = nrow-1 TO 1 STEP - 1
       IF MSCodeExamples.Program_Type=lanumadded(1,2)
       *aNumAdded(MSCodeExamples.Program_Type,2) = 0
<PRE></PRE>         This.ListIndex = 0
         EXIT
         ELSE
   * Increment the index
          This.ListIndex = This.ListIndex + laNumAdded(i,1)

       ENDIF
     ENDFOR
   * Add the number of file categories to the ListIndex
     This.ListIndex = This.ListIndex +nrow-1

     lcProgram_Name = MLINE(MSCodeExamples.Program_Name,1)
   * Add the item to the outline. It is added to the end of the subitems of
   * the item currently selected.
     This.AddItem(lcProgram_Name)
     This.PictureType(This.ListIndex + ;
        laNumAdded(MSCodeExamples.Program_Type,1)) = 2
   ENDSCAN

   This.ListIndex = 0
   This.Parent.ReFresh
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin OCX<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 3, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
