

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Modify DDEWORD.SCX to Run with Word 6.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113923">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/04/20">
<META NAME="Keywords" CONTENT="kbinterop kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The dynamic data exchange (DDE) samples (located in the SAMPLES\DDE directory) in FoxPro 2.6 are unchanged from those that shipped with FoxPro 2.5 for Windows.  The DDEWORD.SCX sample will not run with Word 6.0 because the Word 2.0 command  FilePri...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QALI,QBXS,QA4B,QBWS,QA5V,QDME,QDO7,QAG2,QAPF,QBJZ,QAGS,QAUR,QBUG,QBUF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Modify DDEWORD.SCX to Run with Word 6.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113923</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5x, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The dynamic data exchange (DDE) samples (located in the SAMPLES\DDE
directory) in FoxPro 2.6 are unchanged from those that shipped with FoxPro
2.5 for Windows.
<P>
The DDEWORD.SCX sample will not run with Word 6.0 because the Word 2.0
command "FilePrintMergeToDoc" has been replaced in Word 6.0 with
"MailMergeToDoc". The error "Unknown Command, Subroutine, or Function" will
occur. This article explains how to modify DDEWORD.SCX so that it will work
with Word 6.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use the DDEWORD.SCX sample with Word 6.0, change the VALID clause of the
iChoice push button to contain the following code:
<P>
<PRE>   DO CASE
     CASE iChoice = 1   &amp;&amp; Next record
       SKIP 1
       IF EOF()
          GO TOP
       ENDIF
     CASE iChoice = 2   &amp;&amp; Previous record
       SKIP -1
     CASE iChoice = 3   &amp;&amp; Print merge this record
       DELETE FILE "mergelst.dbf"
       COPY NEXT 1 FIELDS client_id, company, contact, address, city, ;
       state, zip TO "mergelst.dbf"

       iChannel = DDEInitiate("WinWord", "System")
       = DDEExecute(iChannel, "[AppMaximize]")
       = DDEExecute(iChannel, ;
       '[FileOpen "c:\foxprow\sample\dde\letter.doc"]')
       = DDEExecute(iChannel, "[FilePrintMergeToDoc]")  &amp;&amp; This is the
       *line that changed.
       = DDEExecute(iChannel, "[MailMergeToDoc]")
       = DDEExecute(iChannel, "[File1]")
       = DDEExecute(iChannel, "[FileClose 2]")
       = DDEExecute(iChannel, "[FilePrintPreview 1]")
       = DDETerminate(iChannel)

     CASE iChoice = 4   &amp;&amp; Quit
       CLEAR READ
   ENDCASE
   SHOW GETS

</PRE>Besides changing FilePrintMergeToDoc to MailMergeToDoc, you must also
convert LETTER.DOC from a Word 2.0 document to a Word 6.0 Mail Merge
document. Once these steps are followed, the DDEWORD screen program should
function properly.
<P>
<P><h3>Steps to Convert LETTER.DOC to a Word 6.0 Mail Merge Document</h3>
 

<OL><P><LI>Start Word 6.0 for Windows.

<P><LI>Open LETTER.DOC (from the C:\&lt;foxpro_directory&gt;\SAMPLE\DDE directory).

<P><LI>In the Convert File dialog box, choose OK. (It does not matter which
    item in the list is selected.)

<P><LI>At each Header Record Delimiters dialog box that appears, just choose
    OK until the document opens.

<P><LI>From the Tools menu, choose Mail Merge.

<P><LI>Choose the Create button, and in the drop-down list that appears,
    select Restore To Normal Word Document. At the "Do you wish to
    continue?" prompt, choose Yes. This will restore LETTER.DOC to a
    normal Word document.

<P><LI>Choose the Create button again, and in the drop-down list that
    appears, select Form Letters. At the dialog box that follows, choose
    the Active Window button.

<P><LI>Choose the Get Data button, and in the drop-down list that appears,
    select Open Data Source. In the File Name box, type the following and
    then choose OK:
<P>
<PRE>        C:\FPW26\SAMPLE\DDE\MERGELST.DBF

</PRE><P><LI>In the Confirm Data Source dialog box that appears, select "FoxPro
    Files via ODBC (*.dbf)" and choose OK.

<P><LI>Choose the Close button.

<P><LI>From the File menu, choose Save. In the Save Format dialog box, choose
   the Word button to save LETTER.DOC in the Word 6.0 format.

<P><LI>Quit Word for Windows.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60<BR>
KBCategory: kbinterop kbcode<BR>
KBSubcategory: FxinteropOdbc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
