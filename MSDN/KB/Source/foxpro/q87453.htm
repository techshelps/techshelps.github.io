

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using FoxPro Data in a WordPerfect Mail Merge </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87453 ">
<META NAME="KBModify" CONTENT="1995/04/17">
<META NAME="KBCreate" CONTENT="1992/07/30">
<META NAME="Keywords" CONTENT="kbinterop kb3rdparty kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To print form letters from WordPerfect using data from FoxPro, you must export the data into a standard WordPerfect mail merge file. To create this file, use the label generator in FoxPro.  MORE INFORMATION  A standard .SDF or delimited file is not...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALI,QDME,QAMB,QAC2,QBEQ,QAUD,QBRZ,QABB,QAVS,QAKS,QA5V,QADX,QDO0,QAYC,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using FoxPro Data in a WordPerfect Mail Merge</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87453 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To print form letters from WordPerfect using data from FoxPro, you must
export the data into a standard WordPerfect mail merge file. To create this
file, use the label generator in FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A standard .SDF or delimited file is not compatible with a mail merge file
in WordPerfect. A WordPerfect mail merge file marks the end of a field with
a ^R character and the end of a record with a ^E character followed by a
hard page break.
<P>
The easiest way to create a text file for a WordPerfect mail merge is to
use the FoxPro label generator. The following label format generates a
standard WordPerfect mail merge file:
<P>
<PRE>   ALLTRIM(fname)+ALLTRIM(CHR(18))
   ALLTRIM(lname)+ALLTRIM(CHR(18))
   ALLTRIM(address)+ALLTRIM(CHR(18))
   ALLTRIM(city)+ALLTRIM(CHR(18))
   ALLTRIM(state)+ALLTRIM(CHR(18))
   ALLTRIM(zip)+ALLTRIM(CHR(18))
   CHR(5)+CHR(12)

   Label size:    4" x 1 7/16"
   Number across: 1
   Left margin:   0
   Height:        7
   Width:        80

</PRE>Note the following items in particular:

<UL><LI>The label definition must not contain any blank lines.
<LI>No spaces are allowed between labels.
<LI>One label should be on each line.
<LI>Using the ALLTRIM function is critical to generate the correct
   file for mail merge in WordPerfect.
<LI>Specify one field per line. WordPerfect interprets each line as a
   field.
<P>
</UL>After creating a label format, create the labels in a text file using
the following command:
<P>
<PRE>   LABEL FORM &lt;filename&gt; TO FILE &lt;text filename&gt;

</PRE>Exit FoxPro and load WordPerfect. Press CTRL+F5 to activate the TEXT IN/OUT
menu. Choose item number 1, MS-DOS Text. From this menu, select item number
2 to import the text file created with the LABEL FORM command.
<P>
Make the following five modifications to the imported file:

<OL><P><LI>At the top of the file, delete the first carriage return/linefeed
   (CR/LF).
</OL>2. Press ALT+F2 to invoke the search and replace function.
3. Press N when prompted to confirm each replacement.
4. When asked what to search for, press CTRL+ENTER and ENTER, and then
<PRE>   press F2.
</PRE></OL>5. When asked what to replace with, press CTRL+ENTER, then F2.
<P>
This procedure searches for, and removes, an extra carriage return inserted
after each page break. Save the resulting file in standard WordPerfect
format. The file is then ready to be merged into a WordPerfect primary
merge file.
<P>
After the modifications, the mail merge file looks like the following:
<P>
<PRE>   Dr. David^R
   Fulton^R
   One Microsoft Way^R
   Redmond^R
   WA^R
   98052^R
   ^E
   ======================================================================
   William H.^R
   Gates III^R
   One Microsoft Way^R
   Redmond^R
   WA^R
   98052^R
   ^E
   ======================================================================

</PRE>The following template file can be used with this mail merge file:
<P>
<PRE>   ^F1^ ^F2^
   ^F3^
   ^F4^, ^F5^ ^F6^

   Dear ^F1^,

   This could be your lucky day! ^F1^ ^F2^, your name has been chosen
   as a finalist in our newest contest...

</PRE>When the template is merged with the mail merge file, a letter such as
the following results:
<P>
<PRE>   Dr. David Fulton
   One Microsoft Way
   Redmond, WA 98052

   Dear Dr. David,

   This could be your lucky day! Dr. David Fulton, your name has been
   chosen as a finalist in our newest contest...

</PRE>WordPerfect is manufactured by a vendor independent of Microsoft; we make
no warranty, implied or otherwise, regarding this product's performance or
reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a 2.x word perfect print<BR>
form letter mailmerge<BR>
KBCategory: kbinterop kb3rdparty kbprg kbtool<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
