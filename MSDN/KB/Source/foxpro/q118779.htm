

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calling Microsoft Excel Macro from FoxPro for Macintosh </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118779">
<META NAME="KBModify" CONTENT="1996/05/21">
<META NAME="KBCreate" CONTENT="1994/07/27">
<META NAME="Keywords" CONTENT="kbinterop kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are developing an application in FoxPro for Macintosh, you may sometimes need to tap into the functionality of another application. This article demonstrates how to execute a macro written in Microsoft Excel version 4.0 for Macintosh and r...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAUD,QDNQ,QBCF,QDO9,QBWS,QAUJ,QAB9,QBXN,QBV8,QA2Q,QAUR,QAM9,QALX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Calling Microsoft Excel Macro from FoxPro for Macintosh</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118779</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you are developing an application in FoxPro for Macintosh, you may
sometimes need to tap into the functionality of another application. This
article demonstrates how to execute a macro written in Microsoft Excel
version 4.0 for Macintosh and return a result.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To run a Microsoft Excel macro, three components are necessary: the
Microsoft Excel macro, the AppleScript script, and the FoxPro Command
window.
<P>
To create a simple Microsoft Excel macro that fills in the first 50 cells
of the first column of a worksheet, do the following:

<OL><P><LI>In Microsoft Excel, open a new worksheet.

<P><LI>Open a new macro sheet.

<P><LI>Beginning in cell A1 of the macro sheet, enter the following commands:
<P>
<P><PRE>      =FOR("counter",1,50)
      =FORMULA(counter)
      =SELECT(,"R[1]C")
      =NEXT()
      =SELECT(,"R[-1]C")
      =RETURN(CELL("contents"))
</PRE><P>
   NOTE: The macro must return a value or the following error message will
   occurs:
<P>
<P><PRE>      Microsoft Excel got an error:
      "RUN(\"FILLCOL!FILLCOL\")" doesn't
      understand the do script message.
</PRE>
<P><LI>Define the name FILLCOL for the macro. To define a name for a macro,
   select the first cell of the macro, in this case A1, and choose Define
   Name from the Formula menu. In the Define Name dialog box, type the name
   FILLCOL and select the Command option button at the bottom of the dialog
   box.

<P><LI>Save the macro sheet with the name FILLCOL.
<P>
</OL>To create the AppleScript, do the following:

<OL><P><LI>Open the AppleScript Script Editor.

<P><LI>Enter the following code for the script:
<P>
<P><PRE>      tell application "Macintosh HD:Excel:Microsoft Excel"
<PRE></PRE>         make new document
         set retVal to Evaluate "RUN(\"FILLCOL!FILLCOL\")"
         return (retVal as string)
      end tell

</PRE><P><LI>Save the script with the name RunXLMacro and close it.
<P>
</OL>In the FoxPro Command window, execute the following commands:
<P>
<PRE>   RUNSCRIPT RunXLMacro TO ret
   WAIT WINDOW ret

</PRE></OL>The macro is executed synchronously. This means that control is not
returned to the user until after the macro has completed execution. If the
FoxPro desktop and Command windows are not maximized, you should see the
macro execute in the background, filling in the first fifty cells of a new
worksheet with the numbers 1 through 50. If you can't see the macro
executing, switch to Microsoft Excel once control returns to FoxPro and
look at the new worksheet.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Excel "Function Reference"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: vFoxMac 3.00b FoxMac 2.50b 2.50c Ascript Apple<BR>
Script<BR>
Scripting<BR>
KBCategory: kbinterop kbcode<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
