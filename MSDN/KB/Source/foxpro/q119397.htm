

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create an Object That Performs a Sequential Search </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119397">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/08/15">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article explains how to create a screen (.SCX) object that will accept character input, SEEK, and refresh screen objects and Browse windows on a character-for-character basis as each character is entered in the object. The basic process used i...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QBXS,QAH4,QAUD,QDL9,QBWQ,QBWO,QBWN,QAPN,QAW6,QACI,QAGX,QAA8,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create an Object That Performs a Sequential Search</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119397</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft FoxPro for Windows, versions 2.5x, 2.6
- Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6
- Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to create a screen (.SCX) object that will accept
character input, SEEK, and refresh screen objects and Browse windows on a
character-for-character basis as each character is entered in the object.
The basic process used in this article is to trap for keyboard input while
simulating input into a GET field.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Open the TUTORIAL\CUSTOMER database supplied with FoxPro.
<P>
  2. Make certain there is an index tag called COMPANY based on the
    COMPANY field. The code that performs the sequential search is case
    sensitive. If you want the search process to ignore case, base the
    index on the COMPANY field on the UPPER value of the field, then also
    SEEK the UPPER value of mComp.

<P><LI>Create a new screen.

<P><LI>Place the following code in the Setup code snippet:
<P>
       DEFINE WINDOW x FROM 20,0 TO 30,50 FLOAT GROW
       BROWSE WINDOW x NOWAIT
       mComp = ''  &amp;&amp; null
       SET ORDER TO company
<P>
    This will create a Browse window in addition to the main GET screen
    that is used to visually display the searched records.

<P><LI>In FoxPro for Windows and Macintosh, use the Field tool to place an
    input field on the screen with COMPANY as its input expression. (In
    FoxPro for MS-DOS, choose Field from the Screen menu.) Mark the field
    as initially disabled. This field will demonstrate the screen
    expressions being updated as you enter the search expression.

<P><LI>In FoxPro for Windows and Macintosh, use the Field tool again to place
    another input field on the screen with the variable mComp as its input
    expression. (In FoxPro for MS-DOS, choose Field from the Screen menu.)

<P><LI>In the WHEN clause of mComp, place the following code:
<P>
       mComp = ''
       SHOW GET mComp
       DO WHILE .T.
<PRE>          mlast = INKEY(0)
          DO CASE
             CASE mlast = 13  &amp;&amp; RETURN Key pressed
                _CUROBJ= OBJNUM(mdone)    &amp;&amp; or any object you want next
                SHOW GET mdone
                EXIT
             CASE mlast = 127 &amp;&amp; BACKSPACE Key pressed
                mcomp = SUBSTR(mcomp,1,LEN(mcomp)-1)
                SET NEAR ON
                SEEK mcomp
                SET NEAR OFF
                SHOW WINDOW customer REFRESH
                SHOW GETS
             CASE mlast &gt;= 48 AND mlast &lt;= 57  OR;
                   mlast &gt;= 65 AND mlast &lt;= 90  OR;
                   mlast &gt;= 97 AND mlast &lt;= 122 OR;
                   mlast =  32 &amp;&amp; 0-9, A-Z, a-z, or Spacebar
                mcomp = mcomp+CHR(mlast)
                SET NEAR ON
                SEEK mcomp
                SET NEAR OFF
                SHOW WINDOW customer REFRESH
                SHOW GETS
             OTHERWISE  &amp;&amp; Do nothing, no character to process
          ENDCASE
       ENDDO

</PRE><P><LI>Place a Quit push button on the screen.

<P><LI>From the Program menu, choose Generate.

<P><LI>In FoxPro for Windows or Macintosh, choose the More button to display
   additional generation options. One of those options is a push button
   labeled "Associated Windows". In FoxPro for MS-DOS, this option appears
   as a check box in the dialog box that opens right after you choose
   Generate.

<P><LI>Select the Associated Windows option. Type "customer" (without the
   quotation marks) as the name of the associated window.

<P><LI>Finish generating the screen and run it.
<P>
</OL>To begin entering the name of a company to search for, click the MCOMP
field. To leave the input process, you must press the ENTER key.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.50 2.50a 2.50b 2.60 jkey<BR>
incremental<BR>
sequential<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
