

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Save and Restore Grid Column Order and Widths </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163794">
<META NAME="KBModify" CONTENT="1997/07/14">
<META NAME="KBCreate" CONTENT="1997/02/18">
<META NAME="Keywords" CONTENT="FxprgGrid FxprgTable vfoxwin kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article demonstrates how to save and restore changes made to the Grid column order and width. The suggested method is to store the Grid column order and width to a table upon exit of the form and restore the information to Grid at form load.  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUR,QAE1,QARR,QDMN,QAH4,QA9N,QAU7,QAO2,QA5V,QA2Q,QAB6,QAUY,QBWS,QAG2,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Save and Restore Grid Column Order and Widths</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163794</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to save and restore changes made to the Grid
column order and width. The suggested method is to store the Grid column
order and width to a table upon exit of the form and restore the
information to Grid at form load.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Procedure</h3>
 

<OL><P><LI>Create and save a new project, Proj1.

<P><LI>Create a new database, Data1, within the project.

<P><LI>Define a new table, Table1, with the following fields:
<P>
<PRE>      ID    (Character, 10)
      STATE (Character, 2)
      CITY  (Character, 20)

</PRE><P><LI>Add the following records to Table1:
<P>
<P><PRE>      ID STATE CITY
      -- ----- --------------
<PRE></PRE>      1  IL   CHICAGO
      2  CA   SAN FRANCISCO
      3  WA   REDMOND

</PRE><P><LI>Define a new table, Table2, for storing Grid column order and width:
   (Records will not be added to this table at this time.)
<P>
<P><PRE>      FldName (Character, 10)
<PRE></PRE>      Width   (Numeric,10)
      ColOrder(Numeric,10)

</PRE><P><LI>Add a regular index named ColOrder on field ColOrder.

<P><LI>Create a new form, Form1. Add Table1 and Table2 to the Data Environment.

<P><LI>Drag Table1 from the Data Environment to Form1 to create a grid.

<P><LI>Paste the following code to Form1.Init procedure:
<P>
<P><PRE>      SET SAFETY OFF
      SELECT Table2
      IF BOF() AND EOF()
<PRE></PRE>        * Grid column order/width default setting
      ELSE
        SET ORDER TO ColOrder
        RecCnt = RECCOUNT()
        GO TOP
        FOR i = 1 to RecCnt
           THISFORM.GRID1.COLUMNS(i).WIDTH = TABLE2.Width
           TEMP = "TABLE1." + ALLTRIM(TABLE2.FLDNAME)
           THISFORM.GRID1.COLUMNS(i).CONTROLSOURCE = TEMP
           THISFORM.GRID1.COLUMNS(i).HEADER1.CAPTION = ;
             TABLE2.FldName
           IF NOT EOF()
            SKIP
            ENDIF
        ENDFOR
      ENDIF

</PRE><P><LI>Add a Command Button, Command1, to Form1.

<P><LI>Change the Command1.caption property to "Exit." Paste the following
   code into the Command1.Click method:
<P>
<P><PRE>      SELECT TABLE2
      USE TABLE2 EXCLUSIVE
      ZAP
      FOR i = 1 TO THISFORM.GRID1.COLUMNCOUNT
<PRE></PRE>        APPEND BLANK
        REPLACE TABLE2.Width WITH THISFORM.GRID1.COLUMNS(i).WIDTH
        theControlSource = THISFORM.GRID1.COLUMNS(i).CONTROLSOURCE
        theFldName=SUBSTR(theControlSource, AT(".", theControlSource)+1)
        REPLACE TABLE2.FldName WITH theFldName
        REPLACE TABLE2.ColOrder WITH ;
        THISFORM.GRID1.COLUMNS(i).COLUMNORDER
        IF NOT EOF()
          SKIP
        ENDIF
      ENDFOR
      SELECT TABLE1
      USE
      SELECT TABLE2
      USE
      THISFORM.RELEASE

</PRE><P><LI>Run the program.
<P>
</OL>NOTE: The grid column order can be changed by dragging and dropping the
column header or adjusting the grid column width by dragging the right
border of the column header when the mouse pointer becomes a double arrow.
Clicking the EXIT button saves the changes made to the Grid by updating
Table2 before exiting the program.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FxprgGrid FxprgTable vfoxwin kbhowto<BR>
Version             : 3.0 3.0b 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
