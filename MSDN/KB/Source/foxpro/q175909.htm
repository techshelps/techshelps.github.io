

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: How to Hide an Executable from the Taskbar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175909">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/10/29">
<META NAME="Keywords" CONTENT="FxprgFoxtools FxprgGeneral vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a Visual FoxPro executable is running, it appears on the Windows or Windows NT 4.0 taskbar. This code provides a programmatic method of removing the Visual FoxPro executable from the taskbar while it is executing. This code emulates behavior s...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBWP,QBRT,QA56,QA55,QDL9,QBWQ,QBWO,QBWN,QAY2,QAPN,QAGB,QBWS,QDIR,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: How to Hide an Executable from the Taskbar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175909</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a Visual FoxPro executable is running, it appears on the Windows or
Windows NT 4.0 taskbar. This code provides a programmatic method of
removing the Visual FoxPro executable from the taskbar while it is
executing. This code emulates behavior similar to setting the ShowInTaskbar
property to false (.F.) in Visual Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This code does not work with Single Document Interface forms (SDI) because
the mainhwnd() function gets the Windows handle (HWND) of the Visual FoxPro
desktop. SW_HIDE serves to hide the executable from both the taskbar and
the tasklist. However, the executable is not totally hidden from the
operating system. When running an executable created with Visual FoxPro
3.0b, the Close Program window in Windows 95 and the Processes tab of the
Windows NT 4.0 Task Manager both show the Vfp300.esl file. With a Visual
FoxPro 5.0x executable running under Windows NT 4.0 or Windows 95, the
executable's name appears in the Processes tab of the Windows NT Task
Manager or in the Close Program window.

<OL><P><LI>Create a project called Zhide and add a program named Zhide.prg.

<P><LI>In Zhide.prg, add the following code:
<P>
<P><PRE>      DO FORM Zhide.scx
      READ EVENTS
</PRE><P>
   Zhide.prg should be marked as the main file of the project.

<P><LI>Add a form named Zhide to the project. Place the following code in the
   Load event of the form:
<P>
<P><PRE>      Declare Integer ShowWindow in Win32API Integer hWnd, Integer nCmdShow
      SET LIBRARY TO c:\vfp3\foxtools.fll
      * The name of the Visual FoxPro folder may vary between machines.
</PRE>
<P><LI>Add a command button and place the following code in the Click event:
<P>
<P><PRE>      #DEFINE SW_HIDE 0
      m.retval = ShowWindow(mainhwnd(), SW_HIDE)
</PRE>
<P><LI>Add a timer control to the form with an interval set to 10000
   millisecond. Place the following code in the Timer event and close
   the form:
<P>
<P><PRE>      m.retval = MessageBox("Click OK to quit", 0 + 48 + 0)
      #DEFINE SW_SHOW 5
      m.retval = ShowWindow(mainhwnd(), SW_SHOW)
      CLEAR EVENTS
      ThisForm.Release
</PRE><P>
   NOTE: This code is important. Without this code the window does
   not reappear and you cannot quit the application.

<P><LI>Build the executable and close Visual FoxPro. From Explorer, double-
   click Zhide.exe and within 10 seconds click the command button. The form
   should disappear from the taskbar and the tasklist. Check the tasklist
   by pressing the CTRL+ALT+DEL keys. In Windows 95 the Close Program
   window appears. In Windows NT 4.0 the Windows NT Security dialog box
   appears. Click Task Manager and then click the Applications tab. The
   Visual Foxpro executable is not listed in the Task Manager of the
   operating systems.

<P><LI>When the Messagebox appears, click OK to restore Visual Foxpro.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : FxprgFoxtools FxprgGeneral vfoxwin<BR>
Version           : WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
