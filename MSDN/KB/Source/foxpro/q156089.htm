

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Closing SDI (Top-Level) Form Does Not Release Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156089">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/17">
<META NAME="Keywords" CONTENT="kbtool kbui kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a Top-Level, or single document interface (SDI), form uses a menu, this menu is not automatically released when the form is released.  WORKAROUND  In order for a menu to be released, you must issue the RELEASE MENUS command. If you want the menu...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QBWS,QAI2,QBWR,QAPF,QBJZ,QAA5,QBB1,QA56,QA55,QAH4,QAPN,QAGB,QA1S,QAVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Closing SDI (Top-Level) Form Does Not Release Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156089</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a Top-Level, or single document interface (SDI), form uses a menu, this
menu is not automatically released when the form is released.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In order for a menu to be released, you must issue the RELEASE MENUS
command. If you want the menu to be released when the form is closed, issue
the command as follows in the Destroy method of the form:
<P>
<PRE>   RELEASE MENUS &lt;menuname&gt; EXTENDED

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With Visual FoxPro 5.0 you can create forms that appear outside of (or in
lieu of) the FoxPro desktop and that appear in the task list or on the task
bar. These forms are called Top-Level, or SDI, forms and require setting
the form's ShowWindow property to "2 - As Top-Level Form." You can add
menus, toolbars, and child forms to these forms the same way you add them
to the Visual FoxPro desktop in this and previous versions of Visual
FoxPro.
<P>
There is a sample SDI form in the Solution sample application that displays
these new capabilities.
<P>
Access the Solution sample by clicking Sample Applications from the Help
menu in the Visual FoxPro 5.0. This brings up the Sample Applications
Overview help topic. Start the Solution sample by clicking Run, which is to
the right of Solutions Sample under Access.
<P>
You can access the SDI form example within the Solution application by
clicking Forms to expand the folder tree in the Visual FoxPro Solutions
dialog box. Then click "Create an SDI form" and the Run Sample button to
run the form. Alternately, you can click the See Code button to display the
form in the Form Designer.
<P>
You must explicitly release the menu so you can reuse the menu if desired.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form called Test.

<P><LI>Set its ShowWindow property to "2 - As Top-Level Form" in the Form
   Designer.

<P><LI>In the Init method of the form, add the following code:
<P>
<P><PRE>      DO TESTMENU.MPR with THIS, .T.
</PRE>
<P><LI>Create a new menu. Click the Menu button, rather than the Shortcut
   button.

<P><LI>On the Menu menu, click Quick Menu to create a default quick menu.

<P><LI>On the View menu, click General Options. In the General Options dialog
   box, select the Top-Level Form check box, then click OK.

<P><LI>On the Menu menu, click Generate and Save the menu as Testmenu. Click
   the Generate button to generate the default .mpr file.

<P><LI>Run the Test form. Notice that the menu appears in the form itself.

<P><LI>Close the form. Issue a DISPLAY MEMORY command, and notice that the menu
   definition remains in memory.
<P>
</OL>You can place the following code in the form's Destroy method, which causes
the menu to be released when the form is closed:
<P>
<PRE>   RELEASE MENUS (This.Name) EXTENDED

</PRE></OL>NOTE: This technique is explained in more detail in the header of any .mpr
file created when you generate a Top-Level menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbui kbprb<BR>
KBSubcategory: FxtoolFormdes FxtoolMbuilder<BR>
Additional reference words: 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
