

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>When to Use Buffering, Referential Integrity, and Triggers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136855">
<META NAME="KBModify" CONTENT="1996/06/01">
<META NAME="KBCreate" CONTENT="1995/09/14">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article explains the differences between buffering, referential integrity (RI), and triggers, and it describes when each should be used.  MORE INFORMATION  Buffering ---------  To directly update tables or records in a multiuser environment, u...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATP,QA5V,QAXB,QACI,QAC1,QBD2,QAPN,QA9N,QATQ,QAK9,QAE6,QAEF,QAB9,QBCT,QAYV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>When to Use Buffering, Referential Integrity, and Triggers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136855</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains the differences between buffering, referential
integrity (RI), and triggers, and it describes when each should be used.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Buffering</h3>
 
<P>
To directly update tables or records in a multiuser environment, use row
and table buffering. This eliminates the need to place the data from a
record into memory variables (memvars), edit the memvars, check the record
for changes, and then write the changes to the record. See the Buffering
topic in the Visual FoxPro Help file for more detailed information.
<P>
<P><h3>Referential Integrity (RI)</h3>
 
<P>
This refers to the rules that govern data integrity between related tables
(primary key/foreign key). In addition to using engine-level enforcement of
primary keys, you can create stored procedures that take certain actions
when a row is updated, deleted, or inserted.
<P>
The RI Builder will create one of the following stored procedures for each
action:

<UL><LI>Update: Ignore, Cascade, or Restrict
<LI>Delete: Ignore, Cascade, or Restrict
<LI>Insert: Ignore and Restrict
<P>
</UL>The names of these stored procedures are placed under the proper trigger in
the Table Properties section of the Table Designer.
<P>
<P><h3>Triggers</h3>
 
<P>
Record-level event code runs after an insert, update, or delete. triggers
run after rules, and they do not run when buffering is in effect until
TABLEUPDATE() is issued. In the case of row buffering, the record pointer
is moved.
<P>
Triggers can be created by using the CREATE TRIGGER command or by adding a
stored procedure to the Database Container and referencing the stored
procedure in the appropriate trigger in the Table Properties dialog box of
the Table Designer.
<P>
Buffering and RI can be used independently of each other, and the use of RI
does not necessarily mandate that buffering be used. In a multiuser
environment, you would typically use buffering whether or not any RI was in
place.
<P>
Although triggers are typically used to implement (by using the RI Builder)
Cascade or Restrict capabilities on Update and Delete, or Restrict
capabilities on Insert, these Triggers can also be used to call stored
procedures that undertake actions wholly unrelated to RI. For example, an
Update Trigger might call a stored procedure that sends an email message to
another department to notify them of a change.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxMac 3.00b 3.00 VFoxWin multi-user<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
