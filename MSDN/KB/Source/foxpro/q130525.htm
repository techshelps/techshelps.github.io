

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SetFocus Doesn't Work When Called in the Valid Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130525">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/05/22">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The SetFocus method does not set the focus to the specified control if placed in the Valid event procedure code of the following controls: list box, text box, combo box, spinner, and edit box. Instead, the focus is placed on the next control in the...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBV4,QAHP,QA7O,QAO4,QAOE,QAMN,QAB5,QAH4,QADO,QBT6,QBFM,QACI,QAGI,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SetFocus Doesn't Work When Called in the Valid Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130525</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SetFocus method does not set the focus to the specified control if
placed in the Valid event procedure code of the following controls: list
box, text box, combo box, spinner, and edit box. Instead, the focus is
placed on the next control in the Tab order.
<P>
This behavior happens only with list box, edit box, text box, spinner, and
combo box controls. The SetFocus method can be called from the Valid event
of command buttons, option buttons, and check boxes.
<P>
<P><h2>CAUSE</h2>
 
<P>
Control is passed from the current control to the control whose SetFocus
method is called, then returns to execute the LostFocus event of the
current control. Then the LostFocus by default sets the focus to the next
control in the Tab order.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Call the SetFocus method for the desired control in the LostFocus event of
the current control, rather than in the Valid event.
<P>
NOTE: The NODEFAULT command can be used to skip the default behavior in any
event or method code, including the LostFocus event. In the case of the
LostFocus event, use of NODEFAULT causes the focus to stay on the current
control rather than moving to the next control in the Tab order.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In FoxPro version 2.x, the _CUROBJ system variable was used to select the
object where the cursor was to be moved. This was often placed in the Valid
code snippet of an object. The SetFocus method is used in Visual FoxPro to
perform the same functionality, but will not work as expected in the Valid
event of certain controls.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new form, and place four text boxes on it.

<P><LI>Place the following command in the Valid event code for Text1:
<P>
   THISFORM.Text3.SETFOCUS

<P><LI>Save and run the form. Enter some text into Text1, and press ENTER.

<P><LI>The focus moves to Text2 rather than Text3. To set the focus to Text3,
   follow these steps:
<P>
   a. Open the form in design mode.
<P>
   b. Double-click the Text1 box.
<P>
   c. In the Object combo box, make sure Text1 is selected. In the
<P><PRE>      Procedure combo box, select LostFocus.
</PRE><P>
   d. Place the following command in the LostFocus event code for Text1:
<P>
<P><PRE>      THISFORM.Text3.SETFOCUS
</PRE><P>
   e. In the Procedure combo box, select Valid. Select all the code in the
<P><PRE>      Valid event, and choose Cut from the Edit menu.
</PRE><P>
   f. Save and run the form.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
