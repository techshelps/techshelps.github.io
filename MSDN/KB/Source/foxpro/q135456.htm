

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: How to Set Column Index Correctly for AddColumn Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135456">
<META NAME="KBModify" CONTENT="1995/12/06">
<META NAME="KBCreate" CONTENT="1995/08/22">
<META NAME="Keywords" CONTENT="kbprg kbdocerr kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Visual FoxPro Language Reference and Help file both list the following inaccurate information under the topic for the AddColumn method:     The existing Columns are moved to the right and are incremented by 1.  Although the columns do move to t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE1,QDMN,QA28,QATJ,QAPN,QAUR,QAUJ,QACI,QAH4,QAI2,QAKJ,QARR,QBXS,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: How to Set Column Index Correctly for AddColumn Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 6, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135456</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Visual FoxPro Language Reference and Help file both list the following
inaccurate information under the topic for the AddColumn method:
<P>
<PRE>   The existing Columns are moved to the right and are incremented by 1.

</PRE>Although the columns do move to the right on the screen, the column index
is not incremented.
<P>
NOTE: The Visual FoxPro 3.0b for Windows documentation is correct.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The column index is an internal array maintained by the grid object. Each
column is assigned a subscript within the array. New columns are appended
to the end of this array, and the array element number becomes the index
for the column.
<P>
The name of the column is determined by concatenating the word "Column"
plus the index number converted to a string.
<P>
If the AddColumn method is used to insert a column between columns 2 and 3
of a grid containing four columns, the name of the new column will be
Column5. This can be confusing when it is necessary to refer to the columns
later on because the column name does not reflect its position within the
grid.
<P>
If the Form.SaveAs method is used to save the form and the form is
modified, the new column will appear at the end of all columns.
<P>
<P><h3>Step-by-Step Procedure</h3>
 
<P>
The following method can be used to add a new column, set the order
appropriately, and change the name of each column to reflect the new
sequential order. If the Form.SaveAs method is used to save the form, the
form will reappear with the columns in the desired order.

<OL><P><LI>Create a new form, and add the C:\VFP\Samples\Mainsamp\Data\Customer.dbf
   table to the data environment of the form.

<P><LI>Add a grid to the form.

<P><LI>On the Form menu, click New Method. Name the method grdAddColumn and
   input the following code for the method:
<P>
   PARAMETERS lcMyGridName, lnNewColumnPosition
<P><PRE>      lnExistingColumns=ThisForm.&amp;lcMyGridName..ColumnCount
      IF lnExistingColumns = -1
<PRE></PRE>         lnExistingColumns=FCOUNT()
      ENDIF
      lcLastColumn = "Column" + ALLTRIM(STR(lnExistingColumns+1))
      ThisForm.&amp;lcMyGridName..AddColumn(lnNewColumnPosition)
      ThisForm.&amp;lcMyGridName..&amp;lcLastColumn..ColumnOrder ;
         = lnNewColumnPosition
      FOR I = 1 TO lnExistingColumns + 1
         thisform.&amp;lcMyGridName..Columns(i).Name = ;
            "Column" + ALLTRIM(STR(i))
      ENDFOR
      ThisForm.&amp;lcMyGridName..Refresh

</PRE><P><LI>Add a command button to the form, and put the following code in its
   Click event procedure:
<P>
<P><PRE>      frmAdd.grdAddColumn("grid1", 2)
</PRE>
<P><LI>Save the form as frmAdd, and run it.
<P>
</OL>A new column will be inserted as the second column each time you click the
the command button. All column names will be changed to reflect their
position within the grid.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbdocerr kbcode<BR>
KBSubcategory: FxprgGrid<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 6, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
