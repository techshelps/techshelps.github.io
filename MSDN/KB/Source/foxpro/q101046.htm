

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create a Dynamic SELECT Statement in an .EXE File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101046">
<META NAME="KBModify" CONTENT="1997/12/17">
<META NAME="KBCreate" CONTENT="1993/07/04">
<META NAME="Keywords" CONTENT="FxtoolRqbe kbcode kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A compiler cannot be accessed either in a stand-alone or compact executable file, so the Relational Query By Example (RQBE) screen is not available for the user to modify a query. However, the user can use macro substitution to modify an SQL SELECT...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAB9,QA2Q,QAG2,QBWS,QDL9,QBWQ,QBWO,QBWN,QARL,QBVV,QAY2,QAPN,QBXS,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Dynamic SELECT Statement in an .EXE File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101046</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.50 2.50a | 2.50 2.50a 3.00
<PRE>MS-DOS          | WINDOWS
</PRE>kbtool kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A compiler cannot be accessed either in a stand-alone or compact executable
file, so the Relational Query By Example (RQBE) screen is not available for
the user to modify a query. However, the user can use macro substitution to
modify an SQL SELECT statement as needed within an executable file.
<P>
This technique will work in FoxPro for Windows with some modification.
FoxPro for Windows does not create stand-alone executable files, but is
capable of providing stand-alone applications. However, the query builder
is not available in executable files built with the FoxPro for Windows
Distribution Kit because it is intended to be used in interactive mode.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This code example below uses the Clients table found in the
\Sample\Organize\dbfs folder of FoxPro 2.x. The code assumes the Clients
table resides in the current folder. If you use this code with Visual
FoxPro, then it is assumed that the Clients table from FoxPro 2.x was
copied into the current folder.
<P>
The following program, which can be compiled into a stand-alone executable
file, allows the user to dynamically change the SQL SELECT statement as
needed:
<P>
<PRE>   USE CLIENTS.DBF
   GETEXPR to x
   GETEXPR to y
   SELECT * FROM clients WHERE &amp;x HAVING &amp;y INTO CURSOR Test
   BROWSE


   PROCEDURE notcalled
   SELECT * FROM clients WHERE state="CA" HAVING city="Los Angeles"

</PRE>When the .EXE file is run, two expression boxes appear in succession.

<OL><P><LI>In the first, choose STATE from the Field Names box.

<P><LI>Type the following, and choose OK.
<P>
<P><PRE>      ="TX"
</PRE>
<P><LI>In the next expression box, choose CITY from the Field Names box.

<P><LI>Type the following, and choose OK.
<P>
<P><PRE>      ="Lubbock"
</PRE><P>
</OL>This query will produce one record.
<P>
NOTE: Because macro substitution is used, the stand-alone executable file
may not have the proper code included to perform the required function so
an error may occur. To avoid this problem, the notcalled procedure includes
code for an SQL SELECT statement. When the executable file is compiled,
FoxPro will include the necessary source code to execute the macro
substitution. The notcalled procedure is not executed by the program.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Developer's Guide," version 2.0, page D16-11
"Commands &amp; Functions," version 2.0, page C3-10
"Language Reference," version 2.5, page L3-9
"Developer's Guide," version 2.5, page 14-11
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin FoxDos FoxWin 2.00 2.50 2.50a 2.x<BR>
standalone memvar memory variable variables replaceable replacement<BR>
KBCategory: kbtool kbprg kbcode<BR>
KBSubcategory: FxtoolRqbe<BR>
Keywords          : FxtoolRqbe kbcode kbprg kbtool<BR>
Version           : 2.00 2.50 2.50a | 2.50 2.50a 3.0<BR>
Platform          : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
