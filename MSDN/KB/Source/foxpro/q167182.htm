

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: FPSQL Compiles With SET LIBRARY TO Instead Of Loading </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167182">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1997/04/21">
<META NAME="Keywords" CONTENT="FoxWin FxenvOs FxtoolCk kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing the SET LIBRARY TO HOME()+ FPSQL.FLL  command in FoxPro for Windows and then checking to see what library is loaded shows that Fpsql.fxp is the library that is loaded. In other words, the FLL compiles into an FXP file.  In Windows NT, the m...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWQ,QDL9,QBWN,QBWO,QBWP,QA9E,QBHQ,QAFI,QAA1,QABI,QDI2,QBXS,QAHT,QDNN,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: FPSQL Compiles With SET LIBRARY TO Instead Of Loading</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167182</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
   on the following platforms: NT, Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing the SET LIBRARY TO HOME()+"FPSQL.FLL" command in FoxPro for Windows
and then checking to see what library is loaded shows that Fpsql.fxp is the
library that is loaded. In other words, the FLL compiles into an FXP file.
<P>
In Windows NT, the message "Cannot find ODBC.DLL" may appear.
<P>
In FoxPro for Windows 2.5x, the message "Library file is invalid" may be
displayed along with the above message.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is caused by a missing DLL file. Usually the missing DLL file is
Odbc.dll but sometimes the FLL could compile if another required DLL is
missing from the Windows\System folder.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure the Odbc.dll file is located in the Windows\System folder if
using Windows 95 or Windows 3.x. If using Windows NT, the Odbc.dll file
should be in the WinNT\System folder rather than the WinNT\System32 folder.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. An FLL cannot be loaded if all of the DLLs that
it depends on do not exist.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Fpsql.fll and Odbc.dll files are provided with the FoxPro Connectivity
Kit. The Fpsql.fll is on Disk 1 along with the CKSample.app and some other
files. It is not a compressed file so it can be copied directly from the
disk. The Odbc.dll is on the ODBC Setup disk. It is a compressed file so
setup for ODBC should be run to install it.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Copy the Fpsql.fll file from the FoxPro for Windows Connectivity Kit
   disK #1 if it isn't already in the FoxPro folder.

<P><LI>Verify that the Odbc.dll is not in the Windows\System folder.

<P><LI>In the FoxPro Command window issue the following commands:
<P>
<P><PRE>      SET LIBRARY TO HOME()+"fpsql.fll"
      ? SET("library")
</PRE><P>
   The path of the FoxPro folder followed by Fpsql.fxp should be displayed
   on the FoxPro desktop. The DISPLAY STATUS command also showS if the
   Fpsql.fll file loads as a library or has compiled.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information on other files installed with the FoxPro
Connectivity Kit, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q101052.htm">Q101052</A></B>
   TITLE     : Disk Directory and Installation of the Connectivity Kit

</PRE></OL>For a utility program that can be used to test if a FLL file will load, see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q153525.htm">Q153525</A></B>
   TITLE     : SAMPLE: Flltest.exe Determines If FLL File Loads
               Successfully
</PRE> 
<PRE>Keywords          : FoxWin FxenvOs FxtoolCk kbtool
Version           : 2.5 2.5a 2.5b 2.6 2.6a
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
