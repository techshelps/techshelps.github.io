

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ODBC Error 01000 (-1): ConnectionOpen (sopen()) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115995">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/06/09">
<META NAME="Keywords" CONTENT="kbprg kberrmsg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are trying to connect to an SQL Server machine with a DBConnect() function, you receive the following error message from DBError():     ODBC error 01000 (-1): [Microsoft][ODBC SQL Server Driver][dbnmp3]    ConnectionOpen (sopen()).  RESOLU...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAAP,QAA1,QAB4,QA9E,QAGU,QDI2,QBTX,QAVX,QAVW,QAU9,QAH5,QABM,QAUJ,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ODBC Error 01000 (-1): ConnectionOpen (sopen())</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115995</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
<LI>Microsoft FoxPro Connectivity Kit, version 2.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are trying to connect to an SQL Server machine with a DBConnect()
function, you receive the following error message from DBError():
<P>
<PRE>   ODBC error 01000 (-1): [Microsoft][ODBC SQL Server Driver][dbnmp3]
   ConnectionOpen (sopen()).

</PRE><h2>RESOLUTION</h2>
 
<P>
The error is caused by an incorrect server name in the ODBC Driver
Manager's Setup application in the Control Panel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps and code reproduce the problem using an SQL Server:

<OL><P><LI>In the Control Panel, open the ODBC Driver Manager and set up a SQL Data
   Source with the following information:
<P>
<P><PRE>      Data Source Name: test
      Description: test
      Server: WRONG_SRV
</PRE><P>
   NOTE: WRONG_SRV is a nonexistent server name; if the correct server name
   appears in the ODBC Driver Manager's Setup for the driver, the example
   below will return a valid connection.
<P>
   The server name will vary depending upon the network and the actual name
   that the server's administrator has given the server. For more
   information about setting up the correct server name for the network in
   use, choose the Help button and look under the section for "Server."

<P><LI>Type in the following program and run it:
<P>
<P><PRE>      SET LIBRARY TO SYS(2004)+"fpsql.fll"
      PUBLIC errval
      PUBLIC errmsg
      PUBLIC handle
</PRE><P>
<P><PRE>      errval=0
      errmsg=' '
<PRE></PRE>      sourcename= 'test      '  &amp;&amp; This is the source name specified
                                &amp;&amp; in the ODBC Driver Manager.

      user= 'sa'                &amp;&amp; This is your user ID for SQL
                                &amp;&amp; Server.

      passwd=''                 &amp;&amp; Password for the user ID on the
                                &amp;&amp; line above.

      ********CONNECT

      handle=DBConnect(sourcename,user,passwd)
      IF handle &gt; 0
         WAIT WINDOW 'Successfully Connected' nowait
      ELSE
         error=DBError(0,@errmsg,@errval)
         WAIT WINDOW STR(error)+' '+STR(errval)+' '+errmsg
      ENDIF
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.60 ODBC CK 01000 errmsg err msg<BR>
KBCategory: kbprg kberrmsg kbprb kbcode<BR>
KBSubcategory: FxtoolCk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
