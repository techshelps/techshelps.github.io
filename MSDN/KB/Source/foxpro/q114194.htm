

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Cannot Access Selected Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114194">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1994/04/26">
<META NAME="Keywords" CONTENT="FxinteropDbase kberrmsg kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro produces a  Cannot access selected table  error message when a table is closed and that table is participating in a POPUP ... PROMPT FIELDS command that is active when the table is closed.  CAUSE =====  When the PROMPT FIELDS clause of a POP...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAAF,QAB9,QAGB,QACF,QBV8,QAUD,QBNG,QAB4,QA7O,QA7N,QAYV,QAFX,QBME,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Access Selected Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114194</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.60 3.00 | 2.60
<PRE>WINDOWS   | MS-DOS
</PRE>kbprg kberrmsg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, version 2.6
<LI>Microsoft FoxPro for Windows, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
FoxPro produces a "Cannot access selected table" error message when a table
is closed and that table is participating in a POPUP ... PROMPT FIELDS
command that is active when the table is closed.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the PROMPT FIELDS clause of a POPUP command is used to define a popup,
FoxPro establishes a link between the POPUP command and the table from
which the POPUP command derives its data. If the table on which the popup
is based is closed while the POPUP command is active, the link between the
POPUP command and the data is severed. FoxPro, therefore, cannot continue
to display the popup.
<P>
In dBASE IV, a popup created with the PROMPT FIELDS clause is loaded into
memory. Since dBASE does not maintain a link between the POPUP command and
the table from which the POPUP command derives data, it is possible to
close a table on which a popup is based while that POPUP command is active.
Therefore, the sample code in the "More Information" section below will not
generate an error if it is executed in dBASE IV.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If a popup is created with the PROMPT FIELDS clause, do not close the table
from which that popup derives its data while that POPUP command exists. Use
the RELEASE POPUP command to release the POPUP command before closing any
tables from which that popup obtains its data. Once the POPUP command has
been released, close the desired tables.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. FoxPro cannot accommodate the behavior found in
dBASE in this instance due to differences in the way this type of popup is
internally managed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
Place the following code in a .PRG file and execute the code. When the
popup appears, press the ENTER key to cause the "getname" procedure to be
executed.
<P>
<PRE>  USE c:\&lt;FoxPro_directory&gt;\sample\catalog\CUSTOMER
        * In Visual FoxPro use c:\vfp\samples\data\customer

  DEFINE POPUP testpop FROM 2,20 TO 21,25 PROMPT FIELD state
       * In Visual FoxPro use the 'country' field instead of  'state'

  ON SELECTION POPUP testpop DO getname
  ACTIVATE POPUP testpop

  RELEASE POPUP testpop

  RETURN

  PROCEDURE getname
    USE

    * The 'Cannot access selected table' error message
    * will occur here because the table on which this
    * popup was based has already been closed.

    DEACTIVATE POPUP

  RETURN
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxDos FoxWin 2.60 differences<BR>
errmsg err msg error 1152<BR>
KBCategory: kbprg kberrmsg kbprb<BR>
KBSubcategory: FxinteropDbase<BR>
Keywords          : FxinteropDbase kberrmsg kbprb kbprg<BR>
Version           : 2.60 3.00 | 2.60<BR>
Platform          : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
