

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Report Wizard Shows Surplus Data Sources for Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156937">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1996/10/03">
<META NAME="Keywords" CONTENT="FxtoolQueryvwdes FxtoolReportdes FxtoolWizother kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using the Query Designer to select a limited number of fields from a limited number of tables, if the Destination is a report and the Report Wizard is invoked, the Step 1 - Select Fields dialog box displays the names of all tables and cursors ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIK,QA7O,QA7N,QBWS,QAY2,QA2Q,QACF,QAG2,QAO2,QAYY,QA01,QBXS,QA5A,QAZV,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Report Wizard Shows Surplus Data Sources for Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156937</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b 5.00
WINDOWS
kbtool kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the Query Designer to select a limited number of fields from a
limited number of tables, if the Destination is a report and the Report
Wizard is invoked, the Step 1 - Select Fields dialog box displays the names
of all tables and cursors open in work areas and all of the tables in the
currently open database, with the fields of the first table listed the
Available Fields list box.
<P>
Because the query has already been designed and the selected fields have
already been specified, you might expect the Report Wizard to show only
those fields in the Select Fields dialog form.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Wizard can be called from a number of locations (menus, and so forth).
When it is called it has no idea that it was called from the Output
Destination dialog box of the Query Designer.
<P>
To make it easier for the user, the Wizard displays the open Databases to
gather information on tables, views, and so forth. It also reads all the
tables open in work areas.
<P>
When calling the Report Wizard from the Query Designer, unless you actually
run the query before you choose the Output Destinations options, there is
no way for the Wizard to gather this information. If you do run the query
first, the Wizard picks up these fields as well, as the result set is in an
active cursor.
<P>
For the Report Wizard to display only the fields selected from the queried
table, the behavior of the Query Designer has to be changed to run the
Query before you specify an output destination.
<P>
Another aspect of the issue is that the Report Wizard saves the original
table as the data source in the report's data environment if the query
hasn't been run. If the query has been run and the cursor that it created
is still open, this cursor, normally named "query," is saved in the
report's data environment. Usually this isn't a problem. But the best way
to set this up is to modify the report after its creation and remove any
and all tables or cursors from the data environment. Then when the report
is run from the query it will always use the correct data. The report
wizard does not add the table or cursor alias to the report expressions for
the fields. For instance, it uses CUST_ID for the report expression to
print the CUST_ID field rather than CUSTOMER.CUST_ID or QUERY.CUST_ID. This
is the best way to setup the report expressions and should not be changed.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the Samples\Data\Testdata database
</OL>2. Create a new query, selecting two fields from the Customer table.
3. In the Output Destination dialog box, choose the Report button, and then
<PRE>   the Wizard button, which is at the right end of the Open Report text
   box, and then the Report Wizard. Select the "Report Wizard" from the
   Wizard Selection dialog box.

</PRE></OL>The fields listed are from the first table in the database, Customers. The
remaining tables are also listed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolWizother FxtoolQueryvwdes FxtoolReportdes<BR>
Additional reference words: 3.00 3.00b 5.00 kbdsd vFoxWin<BR>
Keywords          : FxtoolQueryvwdes FxtoolReportdes FxtoolWizother kbprb kbtool<BR>
Version           : 3.00 3.00b 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
