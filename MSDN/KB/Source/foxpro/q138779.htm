

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Make a Lookup Combo Box in a Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138779">
<META NAME="KBModify" CONTENT="1996/10/17">
<META NAME="KBCreate" CONTENT="1995/10/26">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  There are times when a developer may want to limit the user's choices for data entry by using a lookup table in a combo box. This allows the user to pick a value from a list and have it inserted into the data table. This article shows how to use a ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALS,QAGU,QARR,QA5V,QBV3,QA7O,QAUD,QAPN,QAH4,QAHP,QBFY,QA7N,QAUJ,QAC2,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Make a Lookup Combo Box in a Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 17, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138779</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are times when a developer may want to limit the user's choices for
data entry by using a lookup table in a combo box. This allows the user to
pick a value from a list and have it inserted into the data table. This
article shows how to use a combo box in a grid to let the users pick a
state to be stored in a State field. The combo box will show the state's
full name but will only store the two-letter abbreviation in the table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you are not familiar with creating tables, using the grid, or using
combo box controls, please see chapters 7 and 11 in the Developer's Guide.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create two tables by using the following commands:
<P>
   CREATE TABLE Friends (Name C(40), Address C(30), State C(2))
   CREATE TABLE States (Fullname C(20), Abbrev C(2))

<P><LI>Enter the following data in the States table:
<P>
<PRE>   Full Name   Abbreviation
   ------------------------
   Alaska      AK
   Colorado    CO
   Florida     FL
   Idaho       ID
   Maine       ME
   Ohio        OH
   Texas       TX

</PRE><P><LI>Enter five records into the Friends table using State abbreviations from
   the States table.

<P><LI>Create a new form, and add the Friends and States tables to the
   data environment.

<P><LI>Drag the Friends table from the data environment to the form to create
   a grid.

<P><LI>Set the following properties for the grid:
<P>
   ColumnCount = 3
   Height = 200
   Width = 448
   RowHeight = 30

<P><LI>Right-click the grid, and click Edit. Select the ComboBox control from
   the Form Controls toolbar and place a combo box in the third column of
   the grid.

<P><LI>Set the following Properties for each column in the grid:
<P>
   Column1: ControlSource = Friends.Name
<PRE>            Width = 152
   Column2: ControlSource = Friends.Address
            Width = 166
   Column3: ControlSource = Friends.State
            Bound = .F.
            Width = 93
            CurrentControl = Combo1

</PRE><P><LI>Set the following Properties for the combo box in column 3:
<P>
   BoundColumn = 2
   ColumnCount = 2
   ColumnWidths = 75,0
   ControlSource = Friends.State
   RowSourceType = 6-Fields
   RowSource = States.Fullname,Abbrev
   Style = 0 Dropdown Combo

<P><LI>Enter the following code in the GotFocus event of the combo box:
<P>
<P><PRE>    IF !EMPTY(Friends.State)
<PRE></PRE>        This.Value = Friends.State
    ELSE
        This.DisplayValue = This.List(1)
    ENDIF
    ** This lets you see the current state value in the combo box
    ** or if it is a new record it displays the first state in the list.

</PRE><P><LI>In the Init event of the form, enter the following line of code:
<P>
<P><PRE>    ON KEY LABEL F10 APPEND BLANK IN Friends
    ** Allows you to enter new records in the Grid.
</PRE>
<P><LI>In the Destroy event of the form, enter the following line of code:
<P>
<P><PRE>    ON KEY LABEL F10
</PRE>
<P><LI>Save and run the Form.
<P>
</OL>When you enter the State field of the grid, you will see the combo box come
up with the name of the current state. If you change the state and move off
of the state field, you will see the new two letter abbreviation for the
state. If you press F10 to add a record and then move to the state field,
you will see the name of the first state displayed in the combo box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxMac 3.00b 3.00 VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 17, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
