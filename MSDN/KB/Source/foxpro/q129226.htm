

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Controls Not Correctly Updated in a Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129226">
<META NAME="KBModify" CONTENT="1996/04/04">
<META NAME="KBCreate" CONTENT="1995/04/20">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a grid, as soon as you change the value of one control, the new value appears throughout the whole column. The expected behavior is that only one row displays the new value. Modifying the value of the Sparse property for this column has no effec...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QAB5,QAOE,QAMN,QABH,QABI,QAPN,QAKD,QAE1,QDMN,QAW6,QARR,QAH4,QAY5,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Controls Not Correctly Updated in a Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129226</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a grid, as soon as you change the value of one control, the new value
appears throughout the whole column. The expected behavior is that only one
row displays the new value. Modifying the value of the Sparse property for
this column has no effect on this behavior.
<P>
<P><h2>CAUSE</h2>
 
<P>
The control that is added to the column of the grid has no ControlSource.
Therefore, when the value of the control is modified, there's no underlying
variable, so the data is stored in the control itself. The same check box
is populating the whole column in the grid. For example, one column of a
grid contains a check box. If you click the check box on one row, the value
of the check box will be modified. If the control does not have a
controlsource, the new value will be propagated across all of the rows in
the column.
<P>
The SPARSE property of the column object affects the display in the column.
It does not control the value associated with the control.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Controls that are to display different values across a column of a grid
need to be bound to data. You can set the Controlsource property of either
the control or the column that contains the control to a field that will
hold the value of the control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample program reproduces the behavior described in this
article. To run this example, copy and paste the code into a program file.
When the grid is displayed, click the check box. As you navigate through
the grid, all of the rows will display the same value for the check box.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Run the following code:
<P>
<PRE>   USE SYS(2004)+"SAMPLES\DATA\CUSTOMER"
   oMyform=CREATE ('MYFORM')
   oMyform.SHOW
   READ EVENTS

   DEFINE CLASS MYFORM AS FORM
     ADD OBJECT grdChecbox AS MYGRID
     ADD OBJECT cmdquit AS COMMANDQUIT
   ENDDEFINE

   DEFINE CLASS MYGRID AS GRID
     ADD OBJECT COLUMN1 AS COLUMN
     ADD OBJECT clmChk1 AS COLUMNCHECK
   ENDDEFINE

   DEFINE CLASS COLUMNCHECK AS COLUMN
     Bound=.f.
     Sparse=.f.
     ADD OBJECT CHK1 AS CHECKBOX
      CURRENTCONTROL="CHK1"
   ENDDEFINE

   DEFINE CLASS COMMANDQUIT as COMMANDBUTTON
     Caption="Quit"
     Top=208
     Left=58
     Height=20
     Width=45
     PROCEDURE  Click
       RELEASE thisform
       CLEAR EVENTS
     ENDPROC
   ENDDEFINE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 Vfoxwin browse command bind<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
