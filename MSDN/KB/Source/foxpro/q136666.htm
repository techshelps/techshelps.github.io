

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Make a Day Date Spinner </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136666">
<META NAME="KBModify" CONTENT="1995/09/14">
<META NAME="KBCreate" CONTENT="1995/09/12">
<META NAME="Keywords" CONTENT="kbui kbprg kbcode kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The  Using Spinners  section in chapter 11 of the Visual FoxPro Developer's Guide gives the following incorrect information:     If you want a user to be able to spin through a range of dates,    you could size the spinner so that only the buttons ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QACE,QAGJ,QAPN,QAH4,QBNX,QBWS,QBXS,QA7O,QAY2,QAW6,QAUR,QAOE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Make a Day Date Spinner</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 14, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136666</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "Using Spinners" section in chapter 11 of the Visual FoxPro Developer's
Guide gives the following incorrect information:
<P>
<PRE>   If you want a user to be able to spin through a range of dates,
   you could size the spinner so that only the buttons are visible and
   position a text box beside the spinner buttons.

</PRE>It is not possible to size a spinner so that only the buttons are visible.
The example in this article shows how to make a Day Date spinner and make
it appear to be a single control.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Create a new class called DayDateSpin based on Container.

<P><LI>Store it in MyLib.vcx.

<P><LI>Set the following properties for the DayDateSpin container:
<P>
   BackStyle = 0 - Transparent
   BorderWidth = 0
   Height = 24
   Width = 164

<P><LI>Add a text box to the container, and set these properties:
<P>
<PRE>   FontName = Courier New   &amp;&amp; Or any nonproportional font
   FontSize = 9
   Format = k    &amp;&amp; Highlights the text box when the focus gets set to it.
   Height = 22
   Left = 0
   ReadOnly = .T. &amp;&amp; Keeps the user from editing the text box
   Top = 1
   Width = 148

</PRE><P><LI>In the Init event procedure of the text box, add this code:
<P>
   THIS.Value = PADR(CDOW(DATE()),11) + DTOC(DATE())
   ** This puts current day and date in the text box when the form starts

<P><LI>Add a spinner to the container and set these properties:
<P>
   FontSize = 1
   Height = 24
   Left = 146
   Top = 0
   Width = 18

<P><LI>On the Format menu, click Send to Back

<P><LI>Add the following code to the spinner's DownClick event procedure:
<P>
   dMyDate = CTOD(RIGHT(ALLTRIM(THIS.PARENT.Text1.Value),8))
   ** Gets the Date from the text box
   dMyDate = dMyDate - 1  &amp;&amp; Decrease the date by one
   THIS.PARENT.Text1.Value = PADR(CDOW(dMyDate),11) + DTOC(dMyDate)
   **Stores the new day of the week and date back into the text box
   THIS.PARENT.Text1.SetFocus

<P><LI>Add the following code to the spinner's UpClick event procedure:
<P>
   dMyDate = CTOD(RIGHT(ALLTRIM(THIS.PARENT.Text1.Value),8))
   ** Gets the Date from the text box
   dMyDate = dMyDate + 1  &amp;&amp; Increment the date by one
   THIS.PARENT.Text1.Value = PADR(CDOW(dMyDate),11) + DTOC(dMyDate)
   **Stores the new day of the week and date back into the text box
   THIS.PARENT.Text1.SetFocus

<P><LI>Save and close the class.

<P><LI>Create a new form. Then click the View Classes Icon on the Form
<P><PRE>    Controls toolbar. Click Add, and select MyLib.vcx.
</PRE>
<P><LI>Pick the DayDateSpin class from the Form Controls toolbar, and place it
<P><PRE>    on the form.
</PRE>
<P><LI>Save and run the form. Click the up arrow or down arrow to see the day
<P><PRE>    and date go up or down.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more infromation about creating classes and working with Visual FoxPro
controls, please see chapters 10 and 11 in the Developer's Guide.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbui kbprg kbcode kbdocerr<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 14, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
