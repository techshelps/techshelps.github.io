

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Using COM Port Communication with FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87808 ">
<META NAME="KBModify" CONTENT="1997/05/27">
<META NAME="KBCreate" CONTENT="1992/08/06">
<META NAME="Keywords" CONTENT="FoxDos">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro supports communicating through COM1 and COM2 using the following low-level file I/O functions:     FCHSIZE()    FCLOSE()    FGETS()    FOPEN()    FPUTS()    FREAD()    FWRITE()  MORE INFORMATION  NOTE: On some peer-to-peer networks, a path m...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKG,QANE,QDJ9,QDJP,QBV8,QAVX,QAVW,QAB9,QBBI,QACF,QBVV,QA5W,QAUD,QAR4,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Using COM Port Communication with FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87808 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxPro supports communicating through COM1 and COM2 using the following
low-level file I/O functions:
<P>
<PRE>   FCHSIZE()
   FCLOSE()
   FGETS()
   FOPEN()
   FPUTS()
   FREAD()
   FWRITE()

</PRE><h2>MORE INFORMATION</h2>
 
<P>
NOTE: On some peer-to-peer networks, a path must be prepended to the file
name for the COM port.
<P>
Communications port I/O is supported only through the MS-DOS file I/O
functions. This means that the communications parameters for the port must
be specified at the MS-DOS level using the MODE command before FoxPro is
run. The following MODE command demonstrates how to specify 9600 baud, no
parity, 8 data bits, and 1 stop bit for the COM1 communications port:
<P>
<PRE>   MODE COM1: 9600,N,8,1

</PRE>For more information on the MODE command, see your MS-DOS user's guide.
<P>
To test a communications port at the MS-DOS level, issue the following
command at the MS-DOS prompt of the host computer. Substitute the port
number for &lt;x&gt; in the command below:
<P>
<PRE>   COPY COM&lt;x&gt; CON

</PRE>This command echoes the information sent to the port to the screen.
<P>
If the screen does not show the correct information, communications at the
MS-DOS level are not occurring correctly. Correct communications at the
MS-DOS level are required before communications can occur in FoxPro.
<P>
Once the communications parameters have been properly specified, the FoxPro
low-level I/O functions provide access to the port. The code sample below
reads a message terminated by a CTRL+Z character:
<P>
<PRE>   FIL = FOPEN("COM1",12)       &amp;&amp; Open COM1 port.
   IF (FIL &lt; 0)
      ? "Error opening COM1"
      RETURN
   ENDIF
   done = .F.
   st = ""
   DO WHILE !DONE
      CH = FREAD(FIL,1)        &amp;&amp; Read one character from COM1
      IF (CH != CHR(26))       &amp;&amp;  while not CTRL+Z.
         ST = ST + CH          &amp;&amp; Add character to string.
      ELSE
         DONE = .T.
      ENDIF
   ENDDO

   ? "Result string is: "
   ?? ST

   =FCLOSE(FIL)                &amp;&amp; Close port.

</PRE>To test whether communications are working properly, do the following:

<OL><P><LI>Find a telephone number to test. Add a "9" if necessary to get an
   outside line. To add a pause after the 9, add a comma (","). If the
   number is long distance, add a "1". For example, you could use
   9,12065551212 (the number for information).

<P><LI>Type the following commands at the MS-DOS prompt, where &lt;x&gt; is the port
   number, and press ENTER at the end of each line:
<P>
<P><PRE>      COPY CON COMx
      ATDT telephone_number_to_test
      CTRL+Z
</PRE><P>
</OL>If the communication is successful, you will receive the message "1 file
copied" and then be returned to an MS-DOS prompt. Then, you will hear the
modem dialing.
<P>
NOTE: FoxPro does not provide a method to determine whether a character is
waiting in the COM port buffer.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FoxDos<BR>
Version             : 2.0 2.5 2.5a<BR>
Platform            : MS-DOS<BR>
Issue type          : kbkeyword<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
