

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Determine the Shape of the Mouse Cursor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106661">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/11/11">
<META NAME="Keywords" CONTENT="kbui kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In FoxPro for Windows, the cursor (mouse pointer) can change shape depending on where it is located on the screen. There isn t a function in FoxPro that tells you the current shape of the cursor. The code example below shows one method of determini...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QDL9,QBWO,QBWN,QAR8,QBWQ,QAY5,QADL,QBV8,QAKC,QAB9,QBC6,QAIM,QAH4,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Determine the Shape of the Mouse Cursor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106661</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In FoxPro for Windows, the cursor (mouse pointer) can change shape
depending on where it is located on the screen. There isn t a function in
FoxPro that tells you the current shape of the cursor. The code example
below shows one method of determining the cursor's shape.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Several functions in the Microsoft Windows Software Development Kit (SDK)
can be used to control and get information about the current Windows
cursor. The two that this program (IBEAM.PRG) uses are LoadCursor() and
GetCursor(). The REGFN() and CALLFN() routines within FOXTOOLS.FLL are used
to call the SDK cursor functions.
<P>
<PRE>   * IBEAM.PRG starts here:

   #DEFINE idc_arrow       (32512)
   #DEFINE idc_ibeam       (32513)
   #DEFINE idc_wait        (32514)
   #DEFINE idc_cross       (32515)
   #DEFINE idc_uparrow     (32516)
   #DEFINE idc_size        (32640)
   #DEFINE idc_icon        (32641)
   #DEFINE idc_sizenwse    (32642)
   #DEFINE idc_sizenesw    (32643)
   #DEFINE idc_sizewe      (32644)
   #DEFINE idc_sizens      (32645)

   SET LIBRARY TO SYS(2004)+'foxtools.fll'

   * Register the LoadCursor function to find out the resource
   * number for IDC_IBEAM.

   fnhand=regfn('LoadCursor',"IL","I")
   cursor_res=callfn(fnhand,0,idc_ibeam)

   * Find out what the current cursor resource number is.

   fn2hand=regfn('GetCursor',"","I")
   CURSOR=callfn(fn2hand)

   * Test to see if the current cursor resource number equals
   * that of IDC_IBEAM (or whatever we change it to).

   IF cursor_res = CURSOR
      WAIT WINDOW "That's the I-Beam Cursor!"
   ELSE
      WAIT WINDOW "That's not an I-Beam Cursor!"
   ENDIF

</PRE>To run IBEAM.PRG, type the following line in the Command window. When you
press F4, IBEAM.PRG will be called and will tell you whether the cursor is
in the I-beam shape or not, depending on the position of the mouse.
<P>
<PRE>   ON KEY LABEL F4 DO IBEAM.PRG

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Windows SDK "Programmer's Reference, Volume 2: Functions"
<P>
FOXTOOLS.WRI in the FoxPro version 2.5 for Windows FOXPROW\GOODIES\FOXTOOLS
directory
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin 2.50 2.50a 2.50b arrow<BR>
foxtools<BR>
foxtools.fll<BR>
KBCategory: kbui kbtool kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
