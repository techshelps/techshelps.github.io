

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Print Headings Vertically Down Left Edge of .FRX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124422">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/01/01">
<META NAME="Keywords" CONTENT="kbprg kbprint kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to create a vertical columnar report in FoxPro that assigns a heading to each line of the report and prints the headings vertically down the left edge of the report rather than printing them horizontally across the...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWS,QAMB,QAWI,QANS,QALW,QAY2,QBXS,QBV8,QAB9,QAE1,QAG2,QA5V,QA2Q,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Print Headings Vertically Down Left Edge of .FRX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124422</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to create a vertical columnar report in
FoxPro that assigns a heading to each line of the report and prints the
headings vertically down the left edge of the report rather than printing
them horizontally across the top.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can't print the headings down the left edge by using the Print When
dialog of Report Writer because the 'Print Once Per Band' and 'Also Print'
options do not sufficiently control the row headings in the Detail band;
these options don't allow you to print the headings more than once per
page.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
Work around this behavior and print vertical headings by following
these steps:

<OL><P><LI>From the Command window, enter the following command lines:
<P>
   SET DEFAULT TO C:\FPW26\TUTORIAL
   USE customer
<P>
   NOTE: Replace the drive letter and FoxPro directory name with the actual
   names from your computer.

<P><LI>Enter the following command line in the Command window:
<P>
   MODIFY REPORT column.frx

<P><LI>Maximize the COLUMN.FRX report when it appears. Grab the Detail band
   button, and drag the Detail band down to about the three-inch mark.

<P><LI>Click Report on the menu bar, and select the Quick Report option. From
   the Quick Report dialog, choose the vertical Field Layout button, and
   click OK.

<P><LI>Click Report again. Then click the Page Layout option. Increment the
   column spinner to 3, and set the Print Order so that the report's output
   will print across the page (that is, select the right button of the two
   buttons under Print Order:). Then click OK.

<P><LI>From the toolbox on the left edge of the report, choose the Field
   button. Then click the cursor directly under the last field created in
   the Detail band. If there is not enough room under the last field in the
   Detail band, open up more detail area by dragging the Detail band button
   further down the page.

<P><LI>When the Report Expression dialog box appears, type coltrac() as the
   user-defined function (UDF) name in the text box located to the right
   of the Expression button. Then choose the OK button.

<P><LI>Minimize COLUMN.FRX, and enter the following line of code in the Command
   window:
<P>
   MODIFY COMMAND coltrac.prg

<P><LI>Insert the following code in the COLTRAC.PRG file:
<P>
   nulstrng = ""
   numocols = 3
<P>
   IF (colnum/numocols)=1
<P><PRE>      colnum=0
</PRE>   ENDIF
<P>
   RETURN nulstrng

<P><LI>Save the file and minimize COLTRAC.PRG
<P>
<P><PRE>    NOTE: numocols should be assigned a value equal to the number of
    columns set up in the .FRX file's Page Layout. If the number of columns
    in the .FRX file ever changes, you'll need to also change the value
    assigned to numocols in this program (COLTRAC.PRG).
</PRE>
<P><LI>Go back to the COLUMN.FRX report. Click Report from the menu bar and
<P><PRE>    choose the Variables... option. Then select the Add button. Type the
    variable name as "colnum" (without the quotation marks).
</PRE>
<P><LI>In the text box under the Value to Store... button, type the variable
<P><PRE>    name (colnum). Now the value in the box under the Initial Value...
    button should be 0 (zero).
</PRE>
<P><LI>Select the Count radio button, and click two OK buttons to get back to
<P><PRE>    the report. Process these steps:
</PRE><P>
<P><PRE>    a. Double-click a row heading (for example, cno) within the Detail
       band. When the text dialog box appears, select the Print When
       check box.
</PRE><P>
<P><PRE>    b. From the Print When dialog box, select the Print Only When
       Expression is True check box.
</PRE><P>
<P><PRE>    c. When the Expression Builder dialog appears, double-click colnum from
       the variables list, and when colnum appears in the Print Text When
       expression box, assign a value of 1 to colnum (that is, colnum=1).
       Then click OK three times to return to the report.
</PRE>
<P><LI>Repeat step 13 for each row heading in the Detail band. Then select
<P><PRE>    Report from the menu bar, and choose Page Preview to view the result of
    this process.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbprint kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
