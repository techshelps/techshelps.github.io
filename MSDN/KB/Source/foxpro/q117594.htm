

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_DBReplace() Function Requires Record to Be Locked </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117594">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/06/30">
<META NAME="Keywords" CONTENT="kbinterop kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are attempting to use the _DBReplace() function to place a new value in a field, _DBReplace() will return a negative integer if the current record is not locked.  _DBReplace() provides functionality similar to the FoxPro REPLACE command, b...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA4Q,QDO0,QABT,QAY5,QAUD,QAH6,QAH4,QACI,QBUJ,QAKD,QBVV,QA7O,QA7N,QA5E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>_DBReplace() Function Requires Record to Be Locked</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117594</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro Library Construction Kit for MS-DOS,
   versions 2.0, 2.5, 2.6
<LI>Microsoft FoxPro Library Construction Kit for Windows,
   versions 2.5, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you are attempting to use the _DBReplace() function to place a new
value in a field, _DBReplace() will return a negative integer if the
current record is not locked.
<P>
_DBReplace() provides functionality similar to the FoxPro REPLACE command,
but replaces the value of only one record at a time. When you attempt to
use _DBReplace() to place a new value in a field, _DBReplace() will return
a 0 if the replacement was successful or a negative integer whose absolute
value is a FoxPro error number if the replacement was unsuccessful. Unlike
the FoxPro REPLACE command, _DBReplace() must lock the current record in
order to perform the replacement.
<P>
The sample code below illustrates how the _DBReplace() function works.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To run the sample code below, you will need to use the following syntax:
<P>
<PRE>   USE &lt;FoxPro_directory&gt;\TUTORIAL\CUSTOMER
   =DBLOCK1(@&lt;fieldname&gt;,"&lt;info_to_replace&gt;",&lt;work_area_number&gt;)

</PRE>When you are using _DBReplace(), you must pass the name of the field that
contains the information you want to replace.
<P>
NOTE: To see the error, you must comment (remark) out the following line of
code as shown (this line is used to lock the record):
<P>
<PRE>   /*if(_DBLock((int)parm-&gt;p[2].val.ev_long,DBL_RECORD) &lt;= 0)
   _Execute("Wait Window 'Could not lock record'");*/

</PRE><h3>Sample Code</h3>
 
<P>
<PRE>   #include &lt;pro_ext.h&gt;

   void FAR dbfunc(ParamBlk FAR *parm)
   {
      int retval=0;
      _DBUnwind((int)parm-&gt;p[2].val.ev_long);
      _DBAppend((int)parm-&gt;p[2].val.ev_long,0);

      if(_DBLock((int)parm-&gt;p[2].val.ev_long,DBL_RECORD) &lt;= 0)
         _Execute("Wait Window 'Could not lock record'");

         /*_Execute("=RLOCK()") can also be used*/

      retval=_DBReplace(&amp;parm-&gt;p[0].loc,&amp;parm-&gt;p[1].val);

      if(retval&lt;=-1)
         _Error(retval);

      _DBUnlock((int)parm-&gt;p[2].val.ev_long);
      /*_Execute("UNLOCK") can also be used*/
   }

   FoxInfo myFoxInfo[] =
   {
   {"DBLOCK1", (FPFI) dbfunc, 3, "R,C,I"}
   };

   FoxTable _FoxTable =
   {
   (FoxTable FAR *) 0, sizeof(myFoxInfo)/sizeof(FoxInfo), myFoxInfo
   };
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos 2.00 2.50 2.60 API LCK<BR>
KBCategory: kbinterop kbtool kbprg kbcode<BR>
KBSubcategory: FxtoolLck<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
