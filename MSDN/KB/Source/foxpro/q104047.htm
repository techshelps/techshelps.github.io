

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Determine the Current DO Nesting Level </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104047">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/09/05">
<META NAME="Keywords" CONTENT="kbenv kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxBASE+ and FoxPro allow DO programs to be nested. The maximum number of nesting levels for FoxBASE+ is 24, while FoxPro allows a maximum of 32 levels and Visual FoxPro allows a maximum of 128 levels. Exceeding this limit results in error number 1...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAA3,QAB9,QA62,QAUD,QAGI,QAC1,QBV8,QAUJ,QAJ8,QAJH,QAKJ,QASR,QAPN,QADK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Determine the Current DO Nesting Level</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104047</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
<LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5, and 2.5a
<LI>Microsoft FoxBASE+ for MS-DOS, version 2.01
<LI>Microsoft FoxBASE+ for the Macintosh, version 2.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxBASE+ and FoxPro allow DO programs to be nested. The maximum number of
nesting levels for FoxBASE+ is 24, while FoxPro allows a maximum of 32
levels and Visual FoxPro allows a maximum of 128 levels. Exceeding this
limit results in error number 103, "DO nesting too deep."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
DO levels are incremented as follows:

<OL><P><LI>When a DO program1 command is issued in the Command window, the DO level
   is set to 1.

<P><LI>If program1 includes a DO program2 statement, the DO level is
   incremented to 2. The DO level is incremented each time another DO
   program statement is executed. In this scenario, program1 would be
   referred to as the calling program, and program2 as the called called
   program.

<P><LI>If a called program returns to a calling program, either by executing
   all commands in the called program, or by explicitly issuing a RETURN
   command, the DO level is decremented by 1.
<P>
</OL>The following procedure allows you to determine the current DO level
through use of the SYS(16) function. The SYS(16) function returns the name
of the currently executing program. It also allows an optional numeric
argument that indicates from how many levels back the program name should
be fetched.

<OL><P><LI>Create a program named DOLVL.PRG with the following commands:
<P>
<P><PRE>      * Memory variable used:
      * current - name of currently executing program
      * do_ctr - counter which indicates current do level
</PRE><P>
<P><PRE>      current = SYS(16)
      do_ctr = 1
      DO WHILE .T.
<PRE></PRE>         IF SYS(16,do_ctr) &lt;&gt; current
            do_ctr = do_ctr + 1
          ELSE
             * In FoxBASE+ or FoxPro 1.02, remove the word WINDOW
             * in the following command
             WAIT WINDOW "Current DO level is " + STR(do_ctr,1,0)
             EXIT
          ENDIF
      ENDDO

</PRE><P><LI>Save and execute the program. A message will be displayed as follows:
<P>
<P><PRE>      Current DO level is 1
</PRE>
<P><LI>Create a program named TEST.PRG with the following command and execute
   the program:
<P>
<P><PRE>      DO dolvl.prg
</PRE>
<P><LI>A message will be displayed as follows:
<P>
<P><PRE>      Current DO level is 2
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxDos FoxWin 1.02 2.00 2.50<BR>
2.50a foxbase+/mac<BR>
KBCategory: kbenv kbprg<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
