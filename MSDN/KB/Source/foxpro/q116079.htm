

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Connectivity Kit to Connect to ASCII Text Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116079">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/06/09">
<META NAME="Keywords" CONTENT="kbinterop kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how to use the FoxPro Connectivity Kit and ODBC to access data that resides in an ASCII text file.  MORE INFORMATION  This article assumes that you have the Text ODBC driver that is available as a part of the Microsoft ODBC D...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QATX,QBRZ,QAU9,QAA1,QAI5,QA9E,QDI2,QBXB,QATJ,QAK6,QAFI,QBWO,QBVV,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using the Connectivity Kit to Connect to ASCII Text Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116079</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
<LI>Microsoft FoxPro Connectivity Kit, versions 2.5, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to use the FoxPro Connectivity Kit and ODBC to
access data that resides in an ASCII text file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article assumes that you have the Text ODBC driver that is
available as a part of the Microsoft ODBC Desktop Database Driver Kit
(DDDK). This driver is also included with some Microsoft products, such as
Microsoft Word for Windows and Microsoft Excel for Windows.
<P>
Support for drivers that are included in the DDDK but not shipped with
FoxPro is provided by the Microsoft Advanced Systems group at:

<UL><LI>(900) 555-2100 (charges appear on your telephone bill)
<P>
   -or-

<LI>(800) 936-5900 (charges billed to your credit card)
<P>
</UL>To connect to a Text data source, you must install the Text ODBC Driver and
set up a Text data source through  the ODBC Text Setup dialog box in the
Windows Control Panel. Since  this is a level 1 ODBC driver, the data
source is a directory name or the current directory, as indicated in the
Setup dialog box. The Options dialog box in the Text Driver Setup provides
users with the ability to select and define various text formats, such as
comma-separated values (CSV), tab delimited, and so on.
<P>
The following is a code sample that "connects" to a Text data source:
<P>
<PRE>   *-- Connect to a Text Data Source
   PRIVATE lcSource, lcUser, lcPwd, hDBHdle, lnDBRes

   *-- Init memvars
   STORE 0 TO hDBHdle, lnDBRes
   lcSource = "Text"      &amp;&amp; Text Data Source Name from ODBC Dialog
   lcUser = ""            &amp;&amp; Not needed for single-tier drivers
   lcPwd = ""             &amp;&amp; Not needed for Text

   *-- Load Library if not already
   IF !"FPSQL" $ SET('library')
        SET LIBRARY TO FPSQL.FLL
   ENDIF
   WAIT WINDOW "Attempting connection ..." NOWAIT
   hDBHdle = dbConnect(lcSource, lcUser, lcPwd, "")
   IF hDBHdle &gt; 0
      WAIT WINDOW ;
    "Connected to Text File -  Handle:"+STR(hDBHdle,1,0) TIMEOUT 2
   ELSE
      WAIT WINDOW ;
    "Unable to connect to Text File .."
   ENDIF

   * If the Text data source does not point to a specific directory
   * (Use Current Directory is checked in Setup dialog box), the
   * following DBExec() will place the user in the desired directory:

   lnDbRes = DBExec(hDBHdle, "USE f:\smpldata\text\csv")
   *(change drive and directory to suit)

   * The Text ODBC driver can be useful in the many situations where
   * PC users need to interact with various forms of ASCII data.

   * The following example creates a cursor in FoxPro containing the
   * drivers in the SYSTEM.INI file:

   lnDbRes = ;
     DBExec(hDBHdle, "use c:\wfw31.466")  &amp;&amp; Select desired directory
   lnDbRes = ;
     DBExec(hDBHdle, ;
     "select * from system.ini where field_1 like 'device=%'")

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft ODBC Desktop Database Driver Kit Text Driver online Help file
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 ck<BR>
KBCategory: kbinterop kbtool kbprg kbcode<BR>
KBSubcategory: FxtoolCk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
