

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: List from Array May Display Incorrect Number Of Elements </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137179">
<META NAME="KBModify" CONTENT="1995/09/25">
<META NAME="KBCreate" CONTENT="1995/09/21">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When an array that is the RowSource for a list box is redimensioned to a lower number of elements than originally displayed in the list box, there will be blank rows in the list representing elements from the previous array.  RESOLUTION  Issue one ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAKC,QAG8,QBWS,QAE1,QBC6,QA2Q,QAVX,QAVW,QAPN,QAH4,QAB9,QBV8,QAY2,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: List from Array May Display Incorrect Number Of Elements</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137179</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When an array that is the RowSource for a list box is redimensioned to a
lower number of elements than originally displayed in the list box, there
will be blank rows in the list representing elements from the previous
array.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Issue one of the following (assuming the list box is placed on the form and
is named List1) after redimensioning the array to allow the list box to
display the correct number of elements:
<P>
<PRE>   Thisform.List1.NumberOfElements=_TALLY
   * This can be used only if _TALLY is updated when the array is
   * redimensioned, with SELECT... INTO ARRAY or COPY TO ARRAY

   -or-

   Thisform.List1.Requery

   -or-

   Thisform.List1.RowSource=Thisform.List1.RowSource

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Type OPEN DATA in the Command window and select the
   Vfp\Samples\Data\Testdata.dbc database.

<P><LI>Type the following command in the Command window:
<P>
   SELECT country FROM CUSTOMER INTO ARRAY test

<P><LI>Create a new form, and put a list box object as well as a command button
   on the form.

<P><LI>In the properties for the list box, set the RowSource property to test
   and the RowSourceType to Array.

<P><LI>Place the following code in the command button's Click event procedure:
<P>
   SELECT country FROM CUSTOMER WHERE country="Germany" INTO ARRAY test
   Thisform.Refresh
<P>
   This code will change the size and contents of the array and allow the
   new contents to be displayed in the list box.

<P><LI>Run the form. Click the command button, and note "Germany" will appear
   in the list box, but a number of empty rows will appear at the bottom of
   the list. These empty rows correspond to the difference in the number of
   array elements created by the first and second SELECT commands.
<P>
</OL><h3>Example Resolution</h3>
 
<P>
Modify the code in the click event of the command button, and add any one
of the following after the SELECT command. This will allow the list box
to display the array elements without the blank rows at the bottom of
the list:

<UL><LI>Thisform.List1.NumberOfElements=_TALLY
<P>
   -or-

<LI>Thisform.List1.Requery
<P>
   -or-

<LI>Thisform.List1.RowSource=Thisform.List1.RowSource
<P>
</UL>NOTE: There may be performance differences between the above methods with
large arrays. Use whichever technique provides the best performance.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
