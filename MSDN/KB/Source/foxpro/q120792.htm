

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: GP Fault or No Records Returned If Invalid Dates in RQBE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120792">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/09/19">
<META NAME="Keywords" CONTENT="FxtoolRqbe kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using the RQBE tool, if you select a date field in the Selection Criteria section and the BETWEEN clause contains an invalid date, FoxPro may return a query with zero records found. If the first date in the EXAMPLE section is invalid, FoxPro r...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QA5V,QACE,QAUD,QBE7,QBE6,QBWS,QAGB,QBN4,QAYV,QDL9,QBWQ,QBWO,QBWN,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: GP Fault or No Records Returned If Invalid Dates in RQBE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120792</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.6x | 2.00 2.5x 2.6x
<PRE>WINDOWS   | MS-DOS
</PRE>kbtool kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, version 2.0, 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the RQBE tool, if you select a date field in the Selection
Criteria section and the BETWEEN clause contains an invalid date, FoxPro
may return a query with zero records found. If the first date in the
EXAMPLE section is invalid, FoxPro returns an "Invalid Date" error. If the
second date is invalid, FoxPro runs the query but returns zero records.
<P>
When you enter the SELECT statement in the command window or in a program
and that SELECT statement contains invalid dates in the BETWEEN clause, no
error is returned regardless whether the invalid date is the first or
second date.
<P>
In addition, FoxPro for Windows can cause a general protection (GP) fault
if the second date is invalid. After pressing the ESC key to exit from the
browse mode when running DO QUERY, if you press the LEFT ARROW or RIGHT
ARROW key, the browse comes back up again with zero records. Then if you
press the ESC key to exit from the browse and click the mouse one or more
times, a GP fault occurs.
<P>
NOTE: This behavior does not occur when using the Visual FoxPro Query
Designer.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the RQBE tool with a database that has a date in it.

<P><LI>In the selection Criteria section, choose the date field and the
   BETWEEN clause.

<P><LI>Type a valid date as the first date and an invalid date as the second
   date.

<P><LI>Run the Query in Browse mode.

<P><LI>Note that the query will have zero records.

<P><LI>If running FoxPro for Windows, press the ESC key to exit from browse
   mode.

<P><LI>Press the LEFT ARROW or RIGHT ARROW key. The browse will reappear.

<P><LI>Press the ESC key again, and click the mouse one or more times. A GP
   fault will occur.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin fixlist3.00 FoxWin FoxDos 2.00 2.50<BR>
2.50a 2.50b 2.60 2.60a GPF buglist2.50 buglist2.50a buglist2.50b<BR>
buglist2.60 buglist2.60a<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolRqbe<BR>
Keywords          : FxtoolRqbe kbprb kbtool<BR>
Version           : 2.5x 2.6x | 2.00 2.5x 2.6x<BR>
Platform          : MS-DOS WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
