

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Calculate Lowest on Date Field in Group Returns Number </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100567">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="FxprgGeneral kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are using the Calculate Lowest option on a date field that is in the Group band of a report, the lowest date in that grouping should be returned, but a number is returned instead.  CAUSE =====  Calculate Lowest is returning the Julian date...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QABO,QA7O,QA7N,QBWS,QAUD,QBJZ,QAG2,QAY2,QACE,QBE7,QBE6,QA2Q,QAR4,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Calculate Lowest on Date Field in Group Returns Number</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100567</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.6x
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are using the Calculate Lowest option on a date field that is
in the Group band of a report, the lowest date in that grouping should
be returned, but a number is returned instead.
<P>
<P><h2>CAUSE</h2>
 
<P>
Calculate Lowest is returning the Julian date instead of the character
type date.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Workaround 1</h3>
 
<P>
To work around this problem, create the following user-defined function
(UDF):

<OL><P><LI>Create a field in the Group band.

<P><LI>In the field, type:
<P>
<P><PRE>      MYUDF()
</PRE>
<P><LI>Create a program named MYUDF.PRG that contains the following
   commands:
<P>
<P><PRE>      mrecno=RECNO()
      CALCULATE MIN(datefield) TO x
      GOTO mrecno
      RETURN x
</PRE><P>
</OL><h3>Workaround 2</h3>
 

<OL><P><LI>From the Report Menu, choose Variables.

<P><LI>Choose Add.

<P><LI>For the Variable Name, type "mindate" (without the quotation marks).

<P><LI>For the value you want to store, select the date field for which you
   want the minimum value.

<P><LI>For the Initial Value, select the date field again.

<P><LI>Choose Lowest.

<P><LI>At the end of the report, choose Reset. Or, if you are using a group,
   choose Group.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a database with a character field called NAME and a date
    field called ZDATE.

<P><LI>Enter the following three records:
<P>
<PRE>       NAME           ZDATE
       -----------------------

       Paul           01/19/19
       Paul           04/28/68
       Paul           05/15/93

</PRE><P><LI>Save the database.

<P><LI>From the File menu, choose New, select Report, and then choose
    New.

<P><LI>From the Report menu, choose Quick Report, and choose OK.

<P><LI>From the Report menu, choose Data Grouping.

<P><LI>Choose Add and select the date field to group on. Choose OK three
    times.

<P><LI>Stretch the group footer to open a line.

<P><LI>Click the ZDATE field in the Detail band.

<P><LI>From the Edit menu, choose Copy.

<P><LI>From the Edit menu, choose Paste.

<P><LI>Move the new ZDATE field into the Group Footer band.

<P><LI>Double-click the new ZDATE field in the Group Footer band.

<P><LI>Select Calculate, select Lowest, and then choose OK twice.

<P><LI>From the Report menu, choose Page Preview, and then choose Zoom In.
<P>
</OL>The result in the group footer is 2421978; it should be 01/19/19. If you
type ?SYS(11,'01/19/19') in the Command window, FoxPro returns 2421978,
which is the Julian date for 01/19/19.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 2.60a VFoxWin<BR>
fixlist3.00 buglist2.50 buglist2.50a buglist2.50b buglist2.60 buglist2.60a<BR>
minimum report<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kbbuglist kbfixlist kbprg<BR>
Version           : 2.5x 2.6x<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
