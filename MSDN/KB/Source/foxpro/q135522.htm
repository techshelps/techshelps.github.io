

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error Occurs When Using DynamicCurrentControl Property </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135522">
<META NAME="KBModify" CONTENT="1995/08/24">
<META NAME="KBCreate" CONTENT="1995/08/22">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When setting the DynamicCurrentControl property of a column contained within a grid, you may get the error message  Expression is invalid. Use a valid expression for DynamicCurrentControl property.   CAUSE =====  This error message may occur if you...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAB4,QAB9,QBXS,QBWC,QAJQ,QA56,QA55,QAEF,QAAP,QAE1,QBDM,QA9N,QAY5,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Occurs When Using DynamicCurrentControl Property</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 24, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135522</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When setting the DynamicCurrentControl property of a column contained
within a grid, you may get the error message "Expression is invalid. Use a
valid expression for DynamicCurrentControl property."
<P>
<P><h2>CAUSE</h2>
 
<P>
This error message may occur if you used the Expression Builder to create
your DynamicCurrentControl property expression. The DynamicCurrentControl
property sets the active control of a column based on a certain condition.
This is typically accomplished with an in-line if (IIF) statement. When you
add an IIF statement to the DynamicCurrentControl property, Visual FoxPro
assumes that an equal sign (=) resides at the beginning of the statement.
If you have the Expression Builder creates your IIF statement, it adds an
equal sign as the first character and thus cause the error message.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Remove the equal sign inserted by the Expression Builder, or do not use the
expression builder to create your IIF statements for the
DynamicCurrentControl property.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open or switch to Microsoft Visual FoxPro.

<P><LI>Open a new form and add a grid to it.

<P><LI>Add the Employee.dbf table, located in the \Samples\Data subdirectory of
   Visual FoxPro, to the data environment of the form.

<P><LI>In the form's Property window, set the grid's ColumnCount property to 1,
   and set the Bound property of Column1 to false (.F.).

<P><LI>Add a text frame to the Column (this will be Text2 as there will be a
   text frame called Text1 in the Column by default).

<P><LI>In the form's Property window, set the Value property of Text2 to Test.

<P><LI>Set the ControlSource property of Text1 to Employee.emp_id.

<P><LI>Use the Expression Builder to create the following statement for the
   DynamicCurrentControl property of Column1:
<P>
   IIF((LEFT(ALLTRIM(EMPLOYEE.EMP_ID),1) = "1"), "TEXT1", "TEXT2")

<P><LI>Close the Expression Builder. Note that it adds an equal sign (=) to the
   beginning of the statement.

<P><LI>Save and run the Form. Note that the error "Expression is invalid. Use
<P><PRE>    a valid expression for DynamicCurrentControl property" appears.
</PRE>
<P><LI>Remove the equal sign added by the Expression Builder, and run the
<P><PRE>    form. Note that if now functions as expected.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 24, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
