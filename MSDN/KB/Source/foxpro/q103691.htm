

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Problems with Windows Sound System (QRECORD.EXE) &amp; FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103691">
<META NAME="KBModify" CONTENT="1995/06/26">
<META NAME="KBCreate" CONTENT="1993/08/29">
<META NAME="Keywords" CONTENT="kbsound kbole kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Executing an @ ... SAY VERB  Play  command on a general field that contains a sound object causes FoxPro to lose the focus and appear to hang (lock up) on a system that has the Microsoft Windows Sound System installed. Specifically, FoxPro loses th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHR,QAYS,QDL9,QBWO,QBWN,QBXS,QA9Q,QBJZ,QBIT,QBWQ,QDKW,QAPN,QAGB,QAJ6,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Problems with Windows Sound System (QRECORD.EXE) &amp; FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103691</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Executing an @ ... SAY VERB "Play" command on a general field that
contains a sound object causes FoxPro to lose the focus and appear to
hang (lock up) on a system that has the Microsoft Windows Sound System
installed. Specifically, FoxPro loses the focus, the hourglass
appears, the sound plays, and then the system appears to hang.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the Windows Sound System is installed, it replaces the default
Windows Sound Recorder application and OLE server (SOUNDREC.EXE) with
its own specialized version (QRECORD.EXE) and updates the registration
database accordingly.
<P>
Because FoxPro's default mode for OLE transactions is synchronous, the
OLE server must notify FoxPro that its task (playing the sound) is
complete before FoxPro will continue processing. Normally, this
notification is made by the action of the server closing the OLE
object. Sound Recorder properly closes the object, but Quick Recorder
does not. As a result, FoxPro appears to lock up because it is waiting
for the server to release the object. If the Quick Recorder task is
terminated (by pressing ALT+TAB and choosing Close from the Control
menu or by choosing End Task in the Task List), FoxPro will continue
processing normally.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two ways to work around this problem:

<UL><LI>The simplest workaround is to instruct FoxPro to conduct its OLE
   transactions asynchronously. To do this, append the NOWAIT keyword
   to the @ ... SAY VERB "Play" command. If the OLE transaction is
   asynchronous, FoxPro will continue processing immediately after
   posting the "Play" transaction and will not wait for that
   transaction to complete. This solution may work in some simple
   cases, but it is not a complete workaround.
<P>
   -or-

<LI>The more complex workaround involves replacing QRECORD.EXE with
   SOUNDREC.EXE. The biggest difficulty involved here is that the
   registration database must be manually modified to execute the OLE
   server reassignment. A step-by-step description of the replacement
   procedure follows:
<P>
   1. In Windows Program Manager, choose Run from the File menu.
<P>
   2. In the Command Line box, type:
<P>
<PRE>         REGEDIT.EXE -V

   3. In the Registration Editor, choose Find Key from the Search
      menu.

   4. In the Find What box, type "sound" (without the quotation
      marks), and choose the Find Next button.

   5. Under the Sound key, there should be a subsection labeled
      "StdFileEditing"; under that, there should be an entry labeled
      "server".

   6. Click the "server" line.

   7. In the Value box, change the text to SOUNDREC.EXE.

   8. From the File menu, choose Exit.

   9. When you asked if you want to save changes, choose Yes.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin wss 2.50 2.50a Windows Sound System<BR>
QRECORD quick Recorder OLE SAY<BR>
KBCategory: kbsound kbole kbprg kbprb<BR>
KBSubcategory: FxinteropOle<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
