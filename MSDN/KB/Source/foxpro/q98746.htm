

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SET DEVICE TO PRINTER PROMPT Does Not Open Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98746 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/05/12">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing the SET PRINTER ON PROMPT or SET DEVICE TO PRINTER PROMPT command immediately after issuing the same command does not produce the expected Microsoft Windows Print dialog box.  CAUSE =====  Once the printer has been defined, FoxPro does not ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QANE,QBXS,QACF,QACT,QAKJ,QAFX,QBVV,QA01,QAH4,QDL9,QBWO,QBWN,QAB5,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SET DEVICE TO PRINTER PROMPT Does Not Open Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98746 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing the SET PRINTER ON PROMPT or SET DEVICE TO PRINTER PROMPT
command immediately after issuing the same command does not produce
the expected Microsoft Windows Print dialog box.
<P>
<P><h2>CAUSE</h2>
 
<P>
Once the printer has been defined, FoxPro does not display the Print
dialog box again until the printer is once again in an undefined
state. For example, this problem will occur if the previous print job
has not yet been released by Print Manager or the network spooler.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, do one of the following:

<UL><LI>Add the command SET PRINTER TO to the end of your program so the
   print job will be released each time the program is run and
   consequently, the Print dialog box will appear every time.
<P>
   -or-

<LI>Use the following code sequence after the print job is completed:
<P>
<PRE>   SET PRINTER OFF        &amp;&amp; disables output to the printer.
   SET PRINTER TO         &amp;&amp; resets output to default MS-DOS PRN print
                          &amp;&amp; utility

   NOTE: The SET PRINTER TO command causes a page to be ejected from
   the printer. A workaround to this behavior is not known at this
   time.

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To reproduce the problem, run the following program twice:
<P>
<PRE>   SET DEVICE TO PRINTER PROMPT
   @ 3,3 SAY 'HELLO,WORLD'
   SET DEVICE TO SCREEN

</PRE>The first time the program is run, the Print dialog box will appear as
expected. The second time the program is run, the dialog box will not
appear although both print jobs are in the print queue.
<P>
NOTE: Both jobs will print if you quit FoxPro for Windows or if you issue
the SET PRINTER TO command in the Command window. Also, if the Cancel
button on the prompt is selected, FoxPro ignores this action and sends the
@...SAY commands to the printer anyway.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Language Reference," version 2.5, page L3-973
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
no output device to print prompt<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprintNet<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
