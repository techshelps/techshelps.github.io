

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Cursor's ReadOnly Property Carried to Other Data Sessions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141557">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use the same table in separate forms that have Private Data Sessions, the ReadOnly property of a cursor is carried over from the first session.  STATUS ======  Microsoft has confirmed this to be a problem in the Microsoft products listed a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBWS,QAPN,QA2Q,QAX1,QAYY,QAG2,QARA,QAI2,QAH4,QARR,QAR4,QAJQ,QBDM,QA3J V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Cursor's ReadOnly Property Carried to Other Data Sessions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141557</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the same table in separate forms that have Private Data
Sessions, the ReadOnly property of a cursor is carried over from the first
session.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps demonstrate the behavior. The behavior is specific to
the order in which you launch these forms. If you launch the ReadWrite form
first, issuing the APPEND BLANK command does in fact append a blank record
to the table and the record is visible in the grid on the ReadOnly form. On
the other hand, if you launch the ReadOnly form first, issuing the APPEND
BLANK command causes an error. Both these behaviors show that the Data
Session is not truly private.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a form and call it ReadWrite. Right-click the form, and select
   Data Environment. Then right-click the Data Environment window, and
   select Add.

<P><LI>Select a table and add it to the Data Environment. Then select the table
   in the Data Environment, and change its ReadOnly property to false (.F.)
   in the Property Sheet.

<P><LI>Select the form and change its DataSession property to 2 - Private Data
   Session.

<P><LI>Place a command button on the form, and change its Caption property to
   Append. Then add the following code to its Valid event:
<P>
   APPEND BLANK

<P><LI>Create a second form, and name it ReadOnly. Right-click the new form,
   and select Data Environment. Then right-click the Data Environment
   window and select Add. Select the same table selected in step 2 and add
   it to the Data Environment.

<P><LI>Select the table in the Data Environment and change its ReadOnly
   property to true (.T.) in the Property Sheet. Select the form and change
   its DataSession property to 2 - Private Data Session. Drag the table
   from the Data Environment to the ReadWrite form to create s grid.

<P><LI>Run the ReadWrite form. Then run the ReadOnly form. Click the Append
   button in the ReadWrite form. Then click the first blank record in the
   grid on the ReadOnly form. Note that although you can click into the new
   record and see the caret blinking there, you cannot enter data into the
   blank record.

<P><LI>Close both forms. With the USE command, open the table and delete the
   added record. Then pack the table.

<P><LI>Run the ReadOnly form. Then run the ReadWrite form. Note that you
   reversed the order in which the forms were launched. Click the Append
   button in the ReadWrite form. Note that the Trace window appears with
   the Valid code of the command button exposed highlighting the line of
   code that states:
<P>
   APPEND BLANK
<P>
   Also, an error occurs that states:
<P>
<P><PRE>      Cannot update cursor.
</PRE><P>
   After you click Ignore, note that the grid does not have a blank record.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: FxprgGeneral VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
