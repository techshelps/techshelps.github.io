

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Error Writing to File" Error Using a Table on a CD-ROM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177143">
<META NAME="KBModify" CONTENT="1997/12/04">
<META NAME="KBCreate" CONTENT="1997/11/21">
<META NAME="Keywords" CONTENT="FxenvOs vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When closing a table or executing a COPY TO or APPEND FROM command on a table that has no code page located on a CD-ROM, the following error message appears:     Error Writing To File  This error occurs only under Windows 95. Windows NT version 4.0...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QAB4,QAAP,QDLP,QANE,QAH4,QBXM,QA9N,QAKP,QA56,QA55,QBWQ,QASB,QAO4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Error Writing to File" Error Using a Table on a CD-ROM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177143</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
   on the following platform: Win95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When closing a table or executing a COPY TO or APPEND FROM command on a
table that has no code page located on a CD-ROM, the following error
message appears:
<P>
<PRE>   Error Writing To File

</PRE>This error occurs only under Windows 95. Windows NT version 4.0 does not
produce the error message. This message is most likely to happen with a CD-
ROM drive installed on the local computer. If the CD-ROM drive is mapped
over a network, the message may not occur.
<P>
<P><h2>CAUSE</h2>
 
<P>
Visual FoxPro tries to write the code page selected in the Code Page dialog
box back to the table. However, since the CD-ROM is read-only, the error
occurs. Visual FoxPro versions 3.0x and 5.0x running on Windows 95 cannot
detect that the CD-ROM is a read-only device.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Here are four workarounds for this problem:

<UL><LI>Copy the file from the CD-ROM to a read/write medium and remove the
   Read-Only attribute on the file. Once copied, use Cpzero.prg to set the
   code page to zero or another code page value. Use CPDBF() to check the
   table's current code page.
<P>
   -or-

<LI>Click on the Option menu bar under the Tools menu pad and click the
   Data tab. Clear the "Prompt for Code Page" check box.
<P>
   -or-

<LI>Type SET CPDIALOG OFF in the Command window before opening the table.
<P>
   -or-

<LI>Click Cancel when Visual FoxPro prompts for a code page. This solution
   may only be practical if you mainly use the table interactively through
   the interface.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This error is more difficult to invoke when using the COPY TO and APPEND
FROM commands. Depending on the size of the table, the error occurs only
after many hundreds or thousands of records are copied. Therefore, the
message may appear as an intermittently occurring error that is difficult
to reproduce. This makes troubleshooting the problem extremely difficult.
<P>
The problem does not appear to be linked to the read-only attribute on the
file. If a read-only table without a code page is located on the hard
drive, Visual FoxPro does not prompt for a code page.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Insert a CD-ROM that contains a Visual FoxPro table without a code page
   in the CD-ROM drive.

<P><LI>Type the following in the Visul FoxPro Command window and navigate to
   the CD-ROM drive and open the table:
<P>
<P><PRE>      USE ?
</PRE>
<P><LI>When the Code Page dialog box appears, select the 1252-Windows ANSI code
   page.

<P><LI>Close the table by issuing the USE command in the Command window and the
   error appears.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: error writing file append copy cd-rom<BR>
Keywords          : FxenvOs vfoxwin<BR>
Version           : WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
