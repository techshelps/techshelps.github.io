

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SET REPROCESS and ON ERROR Routines; "Attempting to Lock" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98920 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/05/18">
<META NAME="Keywords" CONTENT="kbprg kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The automatic locking commands call an ON ERROR routine depending upon the setting of SET REPROCESS, but the manual locking commands do not call an ON ERROR routine.  When SET REPROCESS is set to 0 (the default), an ON ERROR routine will be called ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBXS,QAGB,QAAP,QABT,QAGI,QA5V,QA5E,QAGC,QAD2,QBVV,QAVX,QAVW,QAKP,QAJ6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SET REPROCESS and ON ERROR Routines; "Attempting to Lock"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98920 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The automatic locking commands call an ON ERROR routine depending upon
the setting of SET REPROCESS, but the manual locking commands do not
call an ON ERROR routine.
<P>
When SET REPROCESS is set to 0 (the default), an ON ERROR routine will
be called when you attempt to lock a record or file instead of the
error message "Attempting to Lock...Press escape to cancel" being
generated.
<P>
If SET REPROCESS is set to AUTOMATIC or -2 and the initial lock fails,
the system message "Attempting to Lock...Press escape to cancel" will
be displayed. When ESC is pressed, the ON ERROR routine is called.
<P>
When manual locks [LOCK(), FLOCK(), RLOCK()] are used, if SET
REPROCESS is set to 0, the system message "Attempting to Lock...Press
escape to cancel" is not displayed and the ON ERROR routine is not
called.
<P>
If SET REPROCESS is set to -2 and manual locking commands are being
used, the system message "Attempting to Lock...press escape to cancel"
will be displayed. If ESC is pressed, the ON ERROR routine will not be
called. The manual locking commands do not call an ON ERROR routine
because they simply return a logical .T. or .F. value indicating
whether the file is locked or not.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start two sessions of FoxPro running on a single machine, either in
   Windows or another multitasking environment, or run it on two
   different machines on a network.

<P><LI>Issue the SET EXCLUSIVE OFF command in both sessions.

<P><LI>Issue the SET STATUS ON command in both sessions.

<P><LI>Open a .DBF file and browse it in the first session of FoxPro and
   then type something in the first record so that the status bar
   shows the record as locked. Then open the same .DBF file in the
   second session of FoxPro and try to type something in the same
   record that is currently locked.

<P><LI>To create an ON ERROR routine, type the following in the Command
   window:
<P>
<P><PRE>      MODIFY COMMAND test
</PRE>
<P><LI>In the Test program window, type:
<P>
<P><PRE>      WAIT WINDOW
</PRE>
<P><LI>Press CTRL+W to save the program.

<P><LI>To execute the ON ERROR routine, type the following in the Command
   window:
<P>
<P><PRE>      ON ERROR DO test.prg
</PRE>
<P><LI>Repeat steps 1-4 to reproduce with the problem the ON ERROR routine
   active.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a err msg<BR>
errmsg<BR>
KBCategory: kbprg kberrmsg kbprb<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
