

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Creating a SQL Server Stored Procedure </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141140">
<META NAME="KBModify" CONTENT="1997/02/21">
<META NAME="KBCreate" CONTENT="1995/12/12">
<META NAME="Keywords" CONTENT="kbinterop kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article explains how to create a SQL Server stored procedure. The example uses the Pubs database and the Authors table that ships with Microsoft SQL Server. It is assumed that a valid data source has been created, so the article doesn't discus...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAN0,QABH,QABI,QAB9,QA1E,QBXR,QAVX,QAVW,QAPF,QBSO,QAK6,QADN,QAYY,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Creating a SQL Server Stored Procedure</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141140</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to create a SQL Server stored procedure. The
example uses the Pubs database and the Authors table that ships with
Microsoft SQL Server. It is assumed that a valid data source has been
created, so the article doesn't discuss how to create a data source.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Creating a server-based stored procedure for frequently called queries will
dramatically improve performance. Once a stored procedures has been
successfuly created on the server, the server doesn't have to parse, check
syntax, and compile prior to executing. Parameters can be passed so that
specific information is retrieved. The following examples shows how to
retrieve authors from a specific state. To create a stored procedure on SQL
Server, you must have the authority to do so. Check with the DBA to ensure
that you have proper authority. The following example uses a data source
called test and will create a stored procedure to retrieve only those
authors who live in California.
<P>
<P><h3>Code Sample</h3>
 
<P>
<PRE> hand = sqlconnect("test","sa","")

 ************************************
 * Check for good connection handle *
 ************************************
 IF hand &gt; 0

   z = SQLEXEC(hand, "create procedure pick_state @mystate char(2) as " + ;
          "Select * from authors where state = @mystate")

    *******************************
    *Check for good SQL execution *
    *******************************
    IF z &gt; 0
       WAIT WINDOW "Stored Procedure created"
    ELSE
       WAIT WINDOW "Stored Procedure failed"
       =SQLDISCONNECT(hand)
       CANCEL
    ENDIF

    ****************************
    * Execute Stored Procedure *
    ****************************
    =SQLEXEC(hand, "execute pick_state CA")
    * Display Result Set *
    BROWSE

    =SQLDISCONNECT(hand)

 ELSE
    WAIT WINDOW "Bad connection"
 ENDIF
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbhowto kbcode<BR>
KBSubcategory: FxinteropOdbc VFoxWin<BR>
Additional reference words: 3.00 5.00 speed up quicker faster<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
