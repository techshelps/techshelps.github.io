

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Menu Appears, Then Application Exits to Operating System </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87694 ">
<META NAME="KBModify" CONTENT="1997/01/27">
<META NAME="KBCreate" CONTENT="1992/08/05">
<META NAME="Keywords" CONTENT="kbtool kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Microsoft FoxPro menu program works in the development version of FoxPro. However, if you are using the distribution version of the files (a stand-alone executable), the menu appears, then the application exits to the main operating system envi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBFN,QDIR,QBE7,QBE6,QA56,QA55,QAPN,QAGB,QAF0,QAJH,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Menu Appears, Then Application Exits to Operating System</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87694 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6x
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft FoxPro menu program works in the development version of
FoxPro. However, if you are using the distribution version of the files (a
stand-alone executable), the menu appears, then the application exits to
the main operating system environment, either MS-DOS, Windows or the
Macintosh desktop.
<P>
<P><h2>CAUSE</h2>
 
<P>
When a menu is generated, running the .MPR file does not put you in an
event loop or a wait state.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Incorporate a Foundation READ command into the application.
<P>
NOTE: Although the Foundation READ can be used in Visual FoxPro, the
preferred method is to incorporate a READ EVENT.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Foundation READ</h3>
 
<P>
To incorporate a foundation READ command in an application, do the
following:

<OL><P><LI>In FoxPro 2.x, in the Setup section of the menu or program, include the
   following code:
<P>
<P><PRE>      PUBLIC m.xxx
      m.xxx = .F.
</PRE><P>
   In Visual FoxPro, in the Cleanup section of the menu or program, include
   the following code prior to any other code:
<PRE>              READ EVENTS

</PRE><P><LI>In FoxPro 2.x, in the Cleanup section of the menu or program, include
   the following code prior to any other code:
<P>
<P><PRE>      READ VALID m.xxx
</PRE><P>

<P><LI>In FoxPro 2.x, execute the following code when the user chooses the Quit
   menu option:
<P>
<P><PRE>      m.xxx = .T.
      CLEAR READ ALL
</PRE><P>
   In Visual FoxPro, execute the following code when the user chooses the
   Quit menu option:
<P>
<PRE>              CLEAR EVENTS

</PRE></OL>For additional information, see the EX1.PJX example in the GOODIES\FNDATION
subdirectory and the section on the READ command in the FoxPro version 2.0
"Commands &amp; Functions" or the FoxPro version 2.5 "Language Reference"
manual.
<P>
<P><h2>REFERENCES</h2>
 
<P>
FoxPro for Windows Distribution Kit "User's Guide," page 12.
FoxPro for MS-DOS Distribution Kit "User's Guide," page 10.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxMac 3.00b FoxDos FoxWin FoxMac VFoxWin 2.00<BR>
2.50 2.50a<BR>
2.50b 2.50c 2.60 2.60a 3.00 dos prompt .exe dk<BR>
KBCategory: kbtool kbprg kbprb<BR>
KBSubcategory: FxtoolDk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
