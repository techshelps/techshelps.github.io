

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Applying Different Font Styles in the Report Writer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88444 ">
<META NAME="KBModify" CONTENT="1995/04/17">
<META NAME="KBCreate" CONTENT="1992/08/26">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In the FoxPro report writer, to apply different font styles to objects that are printed on a non-PostScript printer, you must modify the GEN_PD.PRG and DRIVER.PRG printer drivers and the P_CODES.DBF database file. The text below describes the modif...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QADF,QA7O,QAB5,QAOE,QAMN,QABG,QAOX,QAHP,QAJQ,QAGU,QACT,QA7N,QAPN,QAN0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Applying Different Font Styles in the Report Writer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88444 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the FoxPro report writer, to apply different font styles to objects
that are printed on a non-PostScript printer, you must modify the
GEN_PD.PRG and DRIVER.PRG printer drivers and the P_CODES.DBF database
file. The text below describes the modifications required. General
knowledge about printer drivers and specific knowledge about FoxPro
printer drivers is required in order to use the procedures in this
article.
<P>
NOTE: This can also be done by placing the escape sequences (control codes)
directly into the report expression.  They can be added to the field that
is output or placed in a field of their own.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In version 2.0 of the FoxPro report writer, the user can assign
various font styles to objects using the Style check box in the Report
Expression Dialog box. To access the Report Expression dialog box,
choose Field from the Report menu. The various font styles are bold,
italic, underline, subscript, and superscript.
<P>
When the user selects a style, the report writer automatically places
the associated code in the Code edit control. For example, when the
Bold check box is selected, the letter "B" appears in the Code edit
control. Alternatively, the user can type "B" in the Code edit control
to apply the bold formatting attribute. When the user runs the report,
FoxPro sends the style code associated with the object to the PDOBJECT
procedure in the DRIVER.PRG file, where it is interpreted for the
chosen printer. When the report runs, the control code or escape
sequence is sent to the printer to enable the selected font style.
<P>
While version 2.0 of the FoxPro report writer supports assigning
various font styles to objects, it does not support assigning
different fonts to various objects. To extend the report writer to
support this feature, you must define the style codes for the
different fonts that the PDOBJECT procedure can interpret to send
appropriate control codes to the printer. The user interface should be
the same; to assign a font (Helvetica, Times, New Century Schoolbook,
and so on) to an object, the user enters in the Code edit control the
style code that corresponds to the font type. The programmer defines
the appropriate syntax. For example "F25P12" is an intuitive method
for the user to specify a font type and point size.
<P>
To implement this functionality, do the following:

<OL><P><LI>In the GENPD.PJX project, modify the main program, GEN_PD.PRG, to
   specify the user of the XBase, non-PostScript printer driver.
   Remove the comment from the following line:
<P>
<P><PRE>      _PDRIVER = "DRIVER.PRG"
</PRE><P>
   And add a comment to the following line:
<P>
<P><PRE>      _PDRIVER = "DRIVER2.PLB"
</PRE>
<P><LI>Modify the PDOBJECT procedure in the XBase, non-PostScript printer
   driver program, DRIVER.PRG, to recognize the entered style codes.
   The translations for these codes (the control codes or escape
   sequences sent to the printer) can be specified in the program.
   However, for additional flexibility, the program code should be
   general enough to accommodate using different font types with
   different printers.

<P><LI>If the program uses variables instead of containing the actual
   printer control codes, add new fields that contain the control
   codes to P_CODES.DBF, the printer control code database. The number
   of additional fields required depends on how the codes are sent to
   the printer, which varies between printers and is also impacted by
   the program design.
<P>
   For the Hewlett-Packard Printer Control Language (HP-PCL), for
   example, the font ID and font size are known only at run time.
   Therefore, the program code must be written such that the font ID
   and font size are distinct. To do this, specify a start code and an
   end code for both the font ID and the font size. In this case, four
   new fields must be added to P_CODES.DBF.

<P><LI>If new fields are added to P_CODES.DBF, modify the declaration of
   the global _pdparms array to reflect the new number of array
   elements.

<P><LI>Define the new elements of the _pdparms array at the end of the
   array.

<P><LI>Press CTRL+F1 until the GENPD.PJX window is on top.

<P><LI>Select BUILD from the project. Then, select both BUILD APPLICATION
   and REBUILD ALL. Choose OK to have the changes take effect.

<P><LI>Save any changes to the project, if prompted to do so.

<P><LI>Save the .APP file (GENPD.APP) in the same directory as
   FoxPro version 2.0 (C:\FOXPRO2 is the default) by changing values in
   the Directory menu popup.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 pdparms<BR>
KBCategory: kbprg<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
