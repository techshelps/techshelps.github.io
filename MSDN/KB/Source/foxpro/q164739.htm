

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: "Invalid Coordinates" Error Sending @ SAYs to Text File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164739">
<META NAME="KBModify" CONTENT="1997/05/09">
<META NAME="KBCreate" CONTENT="1997/03/06">
<META NAME="Keywords" CONTENT="buglist5.00 FxprgGeneral FxprintGeneral vfoxwin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The  Invalid coordinates  error message is received when sending @..SAYs to a text file when the coordinates for the @..SAY reach a certain number. The certain number is dependent on the FontSize property of _SCREEN. The smaller the _SCREEN.FontSiz...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABK,QAB4,QBRZ,QBXS,QAVX,QAVW,QAH4,QAAP,QAA8,QAB5,QAKP,QAOX,QAKC,QACT,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: "Invalid Coordinates" Error Sending @ SAYs to Text File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164739</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The "Invalid coordinates" error message is received when sending @..SAYs
to a text file when the coordinates for the @..SAY reach a certain number.
The certain number is dependent on the FontSize property of _SCREEN. The
smaller the _SCREEN.FontSize, the larger the coordinate values can be.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The "Invalid coordinates" error message is error number 1959. The Help
file states that the coordinate values must be between -32768 and 32767.
Visual FoxPro 3.x for Windows and Macintosh, and FoxPro for Windows, can
use coordinates within the range specified by the Help file without error.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Enter the following commands in the Visual FoxPro Command window:
<P>
<P><PRE>      SET DEVICE TO PRINTER
      SET PRINTER TO test.txt
<PRE></PRE>      @ 32700,1 SAY "Hello"     &amp;&amp; This line will cause the error
      SET PRINTER TO
      SET DEVICE TO SCREEN

   Although these few lines of code are all that is needed to reproduce
   the error, it may be useful to find out what the maximum coordinate
   can be in a particular situation. Continue with the next few steps to
   determine the maximum coordinate that can be used.

</PRE><P><LI>Place the following code in a new program file and save it.
<P>
<P><PRE>      IF FILE("test.txt")
<PRE></PRE>           DELETE FILE "test.txt"
      ENDIF

      _SCREEN.FONTNAME="Arial"
      _SCREEN.FONTSIZE=10

      SET DEVICE TO PRINTER
      SET PRINTER TO test.txt
      FOR i=1 TO 32770
      @ i, 1 SAY "Hello "+ STR(i)
      ENDFOR

      SET PRINTER TO
      SET DEVICE TO SCREEN
      MODIFY FILE test.txt

</PRE><P><LI>Run the program. Because you should get the "Invalid coordinates"
   error, cancel the program when the error dialog box comes up.

<P><LI>Finish out the program by entering the following commands in the
   Visual FoxPro Command window:
<P>
<P><PRE>      SET PRINTER TO
      SET DEVICE TO SCREEN
      MODIFY FILE test.txt
</PRE>
<P><LI>If the text file is not at the bottom, scroll down until the end is
   reached. The maximum coordinate should be listed. With _SCREEN.FontSize
   set to 10, the maximum coordinate should be about 2,047. If the
   _SCREEN.FontSize is set to 4, the maximum coordinate should be about
   5,461. _SCREEN.FontSize won't accept sizes less than 4 point. The
   program code in step 2 above has a command for changing the FontSize
   property of _SCREEN.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : buglist5.00 FxprgGeneral FxprintGeneral vfoxwin vfpbug5.0a kbbuglist<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
