

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Manipulate DateTime Fields in a Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131254">
<META NAME="KBModify" CONTENT="1995/11/17">
<META NAME="KBCreate" CONTENT="1995/06/06">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Microsoft Visual FoxPro introduces a new data type (DateTime) that allows a date and time value to be stored in a single field. By default, Visual FoxPro displays the data stored in a DateTime field in a  MM/DD/YY HH:MM:SS XM  format. This article ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QALQ,QA7O,QA7N,QAUD,QACE,QARR,QAU3,QAMR,QAY2,QAH4,QAFH,QA56,QA55,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Manipulate DateTime Fields in a Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131254</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Visual FoxPro introduces a new data type (DateTime) that allows a
date and time value to be stored in a single field. By default, Visual
FoxPro displays the data stored in a DateTime field in a "MM/DD/YY HH:MM:SS
XM" format. This article shows by example how to display just the date or
just the time portion of a DateTime field in a Visual FoxPro Grid.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual FoxPro does not offer a command or function to automatically
retrieve just the Date or just the Time portion of a DateTime field. The
code provided below creates two new methods (GetTime and GetDate) that can
be called by the Grid Column ControlSource property to display just the
date or just the time of a DateTime field.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example assumes that a table already exists with a DateTime
field named tDateTime.

<OL><P><LI>Create a new form by using this command:
<P>
   CREATE FORM newform

<P><LI>Add the proper table to the Data Environment by choosing Data
   Environment from the Form menu.

<P><LI>Add a Grid to the form by dragging the Grid control from the Form
   Controls toolbar to the form.

<P><LI>Change the ColumnCount property of the Grid to 2 (any number greater
   than zero will work).

<P><LI>From the Form menu, choose New Method. Name the new method GetTime.

<P><LI>Create a second new method named GetDate.

<P><LI>From the Properties sheet, select the Form1 object, and then select the
   Methods tab. Open the GetTime method.

<P><LI>Place the following code in the GetTime method:
<P>
   PARAMETERS tField
   justtime = SUBSTR(TTOC(tField),10)
   RETURN justtime
<P>
   The tDateTime field will be passed to the GetTime method from the Grid
   Column. The TTOC() function converts the field to character so that
   SUBSTR() can retrieve just the time portion of the field and return it
   to the grid.

<P><LI>Place the following code in the GetDate method:
<P>
   PARAMETERS tField
   justdate = SUBSTR(TTOC(tField),1,8)
   RETURN justdate
<P>
   The tDateTime field will be passed to the GetDate method from the Grid
   Column. The TTOC() function converts the field to character so that
   SUBSTR() can retrieve just the date portion of the field and return it
   to the grid.

<P><LI>Using the Properties sheet, select the Header1 object, and change
<P><PRE>    the caption property to Just Time.
</PRE>
<P><LI>Select the Header2 object, and change the caption property to Just
<P><PRE>    Date.
</PRE>
<P><LI>Change the ControlSource property of Column1 to:
<P>
<P><PRE>    thisform.gettime(tDateTime)
</PRE>
<P><LI>Change the ControlSource property of Column2 to:
<P>
<P><PRE>    thisform.getdate(tDateTime)
</PRE>
<P><LI>Save and run the form. The time portion of the tDateTime field displays
<P><PRE>    in Column1 and the date portion displays in Column2. Note that the
    fields are read-only.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
