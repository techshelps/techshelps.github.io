

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Use the OpenComm() Function with FOXTOOLS.FLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105010">
<META NAME="KBModify" CONTENT="1996/12/31">
<META NAME="KBCreate" CONTENT="1993/10/05">
<META NAME="Keywords" CONTENT="kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  OpenComm() is a function that can be called using FOXTOOLS.FLL to open the COM or LPT ports. Below is a complete description of OpenComm().  MORE INFORMATION  Purpose -------  The OpenComm() function opens a communications device.  Function Syntax ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAY5,QAUD,QDJP,QAKG,QBV8,QAB9,QDL9,QBWO,QBWN,QAKD,QBBI,QAHE,QBWS,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Use the OpenComm() Function with FOXTOOLS.FLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 31, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105010</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
OpenComm() is a function that can be called using FOXTOOLS.FLL to open
the COM or LPT ports. Below is a complete description of OpenComm().
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Purpose</h3>
 
<P>
The OpenComm() function opens a communications device.
<P>
<P><h3>Function Syntax</h3>
 
<P>
<PRE>   OpenComm(&lt;port&gt;, &lt;in_q&gt;, &lt;out_q&gt;)

   Argument       Description
   -----------------------------------------------------------------

   &lt;port&gt;         Points to a null-terminated string that specifies
                  the device in the form COM&lt;n&gt; or LPT&lt;n&gt;, where &lt;n&gt;
                  is the device number.

   &lt;in_q&gt;         Specifies the size, in bytes, of the receiving
                  queue. This parameter is ignored for LPT devices.

   &lt;out_q&gt;        Specifies the size, in bytes, of the transmission
                  queue. This parameter is ignored for LPT devices.

</PRE><h3>Returns</h3>
 
<P>
The return value identifies the open device if the function is
successful. Otherwise, it is less than zero.
<P>
<P><h3>Errors</h3>
 
<P>
If the function fails, it may return one of the following error
values:
<P>
<PRE>   Value     Meaning
   --------------------------------------------------------------------

   -12       The device's baud rate is unsupported.
   -11       The specified byte size is invalid.
   -10       The hardware is not available (is locked by another device).
    -5       The default parameters are in error.
    -4       The function cannot allocate the queues.
    -3       The device is not open.
    -2       The device is already open.
    -1       The device identifier is invalid or unsupported.

</PRE>If this function is called with both queue sizes set to zero, the
return value is -2 if the device is already open, or -4 if the device
is not open.
<P>
<P><h3>Comments</h3>
 
<P>
Windows allows COM ports 1 through 9 and LPT ports 1 through 3. If the
device driver does not support a communications port number, the
OpenComm() function will fail.
<P>
<P><h3>Sample Code</h3>
 
<P>
The following code example uses the OpenComm() function and
FOXTOOLS.FLL to open COM1. (This example can be found in
FOXPROW\GOODIES\FOXTOOLS\DIALER.PRG.)
<P>
<PRE>   *-------------------- dialer.prg ------------------------

   * Sample program to output to comm port
   * Uses FoxTools library for generic DLL access

   SET LIBRARY TO SYS(2004)+"foxtools.fll" ADDITIVE

   opencomm = REGFN("OpenComm", "CII", "I")
   writecomm = REGFN("WriteComm", "ICI", "I")
   closecomm = REGFN("CloseComm", "I", "I")

   com1 = CALLFN(opencomm, "COM1:", 100, 100)
   s = "ATDT 5551212" + chr(13)
   =CALLFN(writecomm, com1, s, len(s))

   WAIT WINDOW "Press any key to hang up"
   s = "ATH0" + chr(13)
   =CALLFN(writecomm, com1, s, len(s))

   =CALLFN(closecomm, com1)

   RELEASE LIBRARY SYS(2004)+"foxtools.fll"

</PRE>NOTE: In reference to the applicability of the OpenComm() function to
Visual FoxPro for Windows, the 32-bit Foxtools.fll returns a  handle to the
RegFN() call provided that it passes the optional 4th argument, which is
"USER.DLL." Here is an example:
<P>
<PRE>   hnd = RegFN("OpenComm","CCC","I","User.dll")

</PRE><h2>REFERENCES</h2>
 
<P>
The above information can also be found in the Microsoft Windows
Software Development Kit (SDK) "Programmer's Reference Volume 2:
Functions" [describes OpenComm()] and the "Programmer's Reference
Volume 3: Messages, Structures, and Macros" (describes the returned
values). The online Help file for the Professional Version of Visual
C++ also contains this information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a<BR>
KBCategory: kbtool kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 31, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
