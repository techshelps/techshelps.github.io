

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Structure Contains Underscore When Running Crosstab </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138978">
<META NAME="KBModify" CONTENT="1995/11/09">
<META NAME="KBCreate" CONTENT="1995/10/31">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you run the Crosstab option in a query, special characters show up such as an underscore character for the name of the field. Special characters specified here are  ~`!@#$%^**()+{}[ ]\ ':;?/&gt;.               happens if the special character is ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QA49,QBWS,QATM,QAWN,QACI,QAUJ,QACF,QAKE,QDPA,QAY5,QAK0,QABH,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Structure Contains Underscore When Running Crosstab</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 9, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138978</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Crosstab option in a query, special characters show up
such as an underscore character for the name of the field. Special
characters specified here are "~`!@#$%^&amp;*()+{}[ ]\"':;?/&gt;.&lt;,". This only
happens if the special character is located in one of the fields of the
table that is queried.
<P>
<P><h2>CAUSE</h2>
 
<P>
The reason this happens is that the Query Builder cannot place a special
character in the structure of the query or table that is created when the
query is run. The only special character that is allowed in the structure
of a query or table is the underscore character. It takes the place of any
of the other special characters when the crosstab creates a new field from
the contents of the original field. For example, if a field in the table
has a percent sign (%) in it and nothing else, the name of the field in the
query or table will be C_. The C means character, and the underscore takes
the place of the percent sign. If the field contains any regular character
plus a special character, such as ABC#, the field name will be Abc_.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a table that consists of two character fields named Field1 and
   Field2.

<P><LI>Add three records containing this data:
<P>
<PRE>   Field1    Field2
   ----------------
   Special   Data
   Special   Data
   Special   %

</PRE><P><LI>Create a query by using the Query Builder and add the two fields to the
   query in the Fields tab. Create a third field by using the COUNT()
   function located in the Functions/Expressions box. Set it up as
   COUNT(Field2). Note that the Cross Tabulate check box is not available
   until the third field is added. Be sure to select the Cross Tabulate
   check box when it becomes available.

<P><LI>Run the query, and look at the name of the third column of the Browse
   window. It should have the heading of C__.

<P><LI>Exit out of the Browse window, and select the original table (on the
   Window menu, click View Window). Then Click the Browse button, and
   change the field containing the percent sign (%) sign to ABC*.

<P><LI>Run the query, and note that the heading of the third field is Abc_.
<P>
</OL>All special characters are replaced with the underscore character in the
structure of the created query or table.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolRqbe<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 9, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
