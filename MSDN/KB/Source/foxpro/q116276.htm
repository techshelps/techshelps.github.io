

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Selecting BIT Field in SQL Server Returns All True Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116276">
<META NAME="KBModify" CONTENT="1997/03/10">
<META NAME="KBCreate" CONTENT="1994/06/15">
<META NAME="Keywords" CONTENT="FoxMac FoxWin FxinteropOdbc KBQ kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are using a SELECT command to select a field of type BIT from a SQL Server database, the resulting cursor file contains all TRUE (.T.) values.  RESOLUTION  Change the SELECT command so that it selects the BIT field as a calculated field. S...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QAR4,QA2Q,QAUD,QAAP,QA7O,QA7N,QADN,QACI,QAG2,QA9N,QAB4,QABM,QAI5,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Selecting BIT Field in SQL Server Returns All True Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116276</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>2.60    | 2.60a
</PRE>WINDOWS | MACTINTOSH
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6
<LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are using a SELECT command to select a field of type BIT from a
SQL Server database, the resulting cursor file contains all TRUE (.T.)
values.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the SELECT command so that it selects the BIT field as a calculated
field. See the program below for an example.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A BIT type field in a SQL Server database is a column that holds the value
1 or 0.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
Run the following program (substituting the correct data source name, user
name, and password). Notice that the first Browse window will contain all
"T" values (representing True or .T.). The second Browse window will
contain the correct numeric values.
<P>
<PRE>   CLOSE DATABASES
   CLEAR

   **Load Library
   IF !"FPSQL"$SET("LIBRARY")
      PRIVATE m.err
      m.err=.F.
      ON ERROR m.err=.T.
      SET LIBRARY TO ;
         LOCFILE("FPSQL","FLL","Where is FPSQL.FLL?") ADDITIVE
      ON ERROR
      IF m.err
         RETURN
      ENDIF
   ENDIF

   **Connect to SQL Server
   WAIT WINDOW "Connecting..." NOWAIT
   * On the following command line, substitute the correct data source
   * name for 'test', the correct user name for 'sa', and the correct
   * password for ''.
   m.handle=DBCONNECT('test','sa','')
   IF m.handle &gt; 0
      WAIT WINDOW "Connected Successfully" NOWAIT
   ELSE
      WAIT WINDOW "No connection made" NOWAIT
      RETURN
   ENDIF

   **Create table with 'bit' type field
   WAIT WINDOW "Creating Table ..." NOWAIT
   m.retval=DBEXEC(m.handle,'CREATE TABLE bitjunk (thebit bit)')
   m.retval=DBEXEC(m.handle,'INSERT bitjunk VALUES (1)')
   m.retval=DBEXEC(m.handle,'INSERT bitjunk VALUES (0)')
   m.retval=DBEXEC(m.handle,'INSERT bitjunk VALUES (1)')
   m.retval=DBEXEC(m.handle,'INSERT bitjunk VALUES (1)')
   m.retval=DBEXEC(m.handle,'INSERT bitjunk VALUES (0)')
   m.retval=dbexec(m.handle,'SELECT * FROM bitjunk','one')
   WAIT WINDOW "Notice all values are True" NOWAIT
   BROWSE
   m.retval=dbexec(m.handle,'SELECT thebit*1 FROM bitjunk','two')
   WAIT WINDOW "Notice values are Correct" NOWAIT
   BROWSE
   m.retval=dbdisconn(m.handle)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxMac 2.60 2.60a ODBC<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxinteropOdbc
<P>

Keywords            : FoxMac FoxWin FxinteropOdbc KBQ kbprg<BR>
Technology          : odbc<BR>
Version             : 2.6 2.6a<BR>
Platform            : MACINTOSH WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
