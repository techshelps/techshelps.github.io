

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Control Printer Attributes for a Report at Run Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133163">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/07/25">
<META NAME="Keywords" CONTENT="kbprg kbprint kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When designing a report, a developer does not always know which printer will be used. As a result, the developer needs to give the user a way to change the printer and printer attributes at run time. This article shows by example how to write code ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACT,QAOX,QAH4,QBWO,QBJZ,QAA1,QBXS,QBAO,QABA,QBRZ,QDL9,QDI2,QBWQ,QBWN,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Control Printer Attributes for a Report at Run Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133163</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When designing a report, a developer does not always know which printer
will be used. As a result, the developer needs to give the user a way to
change the printer and printer attributes at run time. This article shows
by example how to write code that does this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual FoxPro has enhanced and added commands and functions for controlling
and getting printer information. Please see the Help menu for more
information on these commands:
<P>
<PRE>   SET PRINTER TO
   APRINTER()
   PRTINFO()
   GETPRINTER()

</PRE>The following example shows that a report can be sent to an HP LaserJet
IIID on LPT2 with print duplex and landscape selected, and then the same
report can be sent to a Panasonic KX-P1180 on LPT1 using a custom paper
size.
<P>
To run the example code, you must have the printers installed in Windows.
If you don't, you need to install them, and set up a user-defined paper
size under printer setup in Windows for the Panasonic. Set the user-defined
size using Millimeters (MM) as the measuring unit with the Width at 2159
and the Length at 1778.
<P>
For testing purposes, you may connect the printers to FILE instead of LPT1
or LPT2. If you do connect to FILE, make sure that you also substitute FILE
for LPT1 or LPT2 in the following example code.
<P>
For more information on installing or changing Printer settings in Windows,
please see Windows' Help menu.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
This example works on the following platforms:
<P>
<PRE>   Windows 3.1
   Windows for Workgroups 3.11
   Windows 95
   Windows NT 3.5

</PRE>If you have trouble setting custom paper sizes or other printer attributes,
verify that you have the latest printer driver for your specific platform,
and check the printer documentation or contact the manufacturer to find out
more about your printer's capabilities.

<OL><P><LI>Open Testdata.dbc in the Vfp\Samples\Data directory.

<P><LI>Create a new report by using Quick Report. Choose the Customer table and
   add the Cust_id and Company fields to the report. Save the report as
   Myreport, and then close the report.

<P><LI>Create a text file called Panprint.txt that contains these lines:
<P>
   DEVICE=Panasonic KX-P1180
   OUTPUT=LPT1:
   ORIENTATION=0
   PAPERSIZE=256
   PAPERLENGTH=1778
   PAPERWIDTH=2159
   DEFAULTSOURCE=8
<P>
   NOTE: Most dot-matrix printers use PAPERSIZE=256 to define a custom
   paper size. If you use a custom paper size, you must include PAPERLENGTH
   and PAPERWIDTH.

<P><LI>Create a second text file called Hpprint.txt that contains these lines:
<P>
   DEVICE=HP LaserJet IIID
   OUTPUT=LPT2:
   ORIENTATION=1
   PAPERSIZE=1
   DEFAULTSOURCE=7
   DUPLEX=2
<P>
   NOTE: For more information about the different printer settings, please
   see PRTINFO() in Visual FoxPro Help menu.

<P><LI>Create a program called Runrpt.prg, and enter the following code:
<P>
   USE Myreport.frx  &amp;&amp; Open the FRX as a table
   LOCATE FOR Objtype = 1 AND Objcode = 53  &amp;&amp; find the record that holds
   ** the printer information. For more information on the Table Structure
   ** of an .FRX file, see 'Table Structures of Table Files' in Help.
<P>
   REPLACE Tag WITH ""  &amp;&amp; Remove any Printer codes that may be stored in
   ** the Tag memo
<P>
   REPLACE Tag2 WITH ""  &amp;&amp; Remove any Printer codes that may be stored in
   ** the Tag2 memo
<P>
   APPEND MEMO Expr FROM Hpprint.txt OVERWRITE  &amp;&amp; Replace any printer
   ** setting already there with the HP IIID Settings
<P>
   USE  &amp;&amp; Close Myreport.frx
   SET PRINTER TO NAME 'HP LaserJet IIID'
   REPORT FORM Myreport TO PRINT NEXT 60  &amp;&amp; Send the report to the
   ** HP IIID printer using the printer attributes specified in the
   ** Expr memo field.
<P>
   USE Myreport.frx  &amp;&amp; Open the FRX as a table
   LOCATE FOR Objtype = 1 AND Objcode = 53  &amp;&amp; find the record that holds
   ** the printer information
<P>
   APPEND MEMO Expr FROM Panprint.txt OVERWRITE  &amp;&amp; Replace any printer
   ** setting already there with the Panasonic KX-P1180 Settings
<P>
   USE  &amp;&amp; Close Myreport.frx
   SET PRINTER TO NAME 'Panasonic KX-P1180'
   REPORT FORM Myreport TO PRINT NEXT 60  &amp;&amp; Send the report to the
   ** Panasonic KX-P1180 printer using the printer attributes
   ** specified in the Expr memo field.

<P><LI>Save and run the program.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 VFoxWin<BR>
KBCategory: kbprg kbprint kbcode<BR>
KBSubcategory: FxprintGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
