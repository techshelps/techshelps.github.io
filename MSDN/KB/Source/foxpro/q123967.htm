

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Code Example Shows How to Manage Navigation Buttons </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123967">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/12/13">
<META NAME="Keywords" CONTENT="kbprg kbui kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When creating a screen, most developers need to add navigation buttons to move through the database. You can easily put a push button on a screen to go forward one record, but you also need to control button behavior when reaching the beginning or ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA4P,QBXS,QAH4,QAXC,QA5V,QA5D,QAJD,QAEF,QAGX,QAPF,QAML,QACI,QANS,QAFQ,QABG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Code Example Shows How to Manage Navigation Buttons</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123967</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.5b, 2.5c, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When creating a screen, most developers need to add navigation buttons to
move through the database. You can easily put a push button on a screen to
go forward one record, but you also need to control button behavior when
reaching the beginning or the end of a database.
<P>
For example, if the user is navigating through a table and reaches the end
of that table, you might want to have the Next and Bottom buttons disabled.
Likewise, when the user reaches the top of the table, you might want to
have the Top and Prior buttons disabled. This article shows by example how
to do this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code sample in this article moves the pointer before or after the next
or prior record you really want to display, thus allowing you to test for
BOF() and EOF() conditions and have your program respond accordingly by
disabling or enabling the appropriate buttons.
<P>
<P><h3>Code Sample</h3>
 
<P>
NOTE: While this code can serve as a solid base for use in your own work,
it is by no means necessarily the only or best way of handling buttons. In
its present form, the code does not check the status of a record to see if
it is deleted. If deleted is OFF (the default), this code has the potential
to misbehave, so you need to check for and handle deleted records and other
types of exceptions.
<P>
You might want to add code to the "On Screen Entry" or "When" clause code
snippet, because "Top" and "Prior" are not valid at the beginning of a
database. You may need to add this code:
<P>
<PRE>   &amp;&amp; Disable Top and Prior buttons on startup.
   SHOW GET Buttnvar,1 DISABLE   &amp;&amp; Disable "Top"
   SHOW GET Buttnvar,2 DISABLE   &amp;&amp; Disable "Prior"

</PRE>Place the following code in the VALID clause of your button array, and
change the name of the "Buttnvar" variable to the name of the variable you
are actually using:
<P>
DO CASE
<PRE>  CASE Buttnvar = 1         &amp;&amp; 'TOP' button
    GO TOP
    SCATTER MEMVAR
    SHOW GET Buttnvar,1 DISABLE   &amp;&amp; Disable "Top"
    SHOW GET Buttnvar,2 DISABLE   &amp;&amp; Disable "Prior"

    IF (RECCOUNT() &gt; 1)
      SHOW GET Buttnvar,3 ENABLE  &amp;&amp; Enable  "Next"
      SHOW GET Buttnvar,4 ENABLE  &amp;&amp; Enable  "Bottom"
    ELSE
      SHOW GET Buttnvar,3 DISABLE   &amp;&amp; Disable "Next"
      SHOW GET Buttnvar,4 DISABLE   &amp;&amp; Disable "Bottom"
    ENDIF
    SHOW GETS
    WAIT WINDOW "At first record" TIMEOUT 1
    _CUROBJ = OBJNUM(Buttnvar)+3  &amp;&amp; Transfer focus to "Next" button

  CASE Buttnvar = 2         &amp;&amp; 'PRIOR' button
    SKIP - 1
    IF NOT BOF()
      SCATTER MEMVAR
    ELSE
      WAIT WINDOW "At first record" TIMEOUT 1
      SHOW GET Buttnvar,1 DISABLE   &amp;&amp; Disable "Top"
      SHOW GET Buttnvar,2 DISABLE   &amp;&amp; Disable "Prior"
    ENDIF

    IF (RECCOUNT() &gt; 1)
      SHOW GET Buttnvar,3 ENABLE  &amp;&amp; Enable  "Next"
      SHOW GET Buttnvar,4 ENABLE  &amp;&amp; Enable  "Bottom"
    ELSE
      SHOW GET Buttnvar,3 DISABLE   &amp;&amp; Disable "Next"
      SHOW GET Buttnvar,4 DISABLE   &amp;&amp; Disable "Bottom"
    ENDIF
    SHOW GETS

  CASE Buttnvar = 3         &amp;&amp; 'NEXT' button
    IF  NOT EOF()
      SKIP 1
    ENDIF

     IF  EOF()
      SKIP - 1
      WAIT WINDOW "At last record" TIMEOUT 1
      SHOW GET Buttnvar,3 DISABLE   &amp;&amp; Disable "Next"
      SHOW GET Buttnvar,4 DISABLE   &amp;&amp; Disable "Bottom"
    ELSE
      SHOW GET Buttnvar,1 ENABLE  &amp;&amp; Enable  "Top"
      SHOW GET Buttnvar,2 ENABLE  &amp;&amp; Enable  "Prior"
      SCATTER MEMVAR
    ENDIF
    SHOW GETS

  CASE Buttnvar = 4         &amp;&amp; 'BOTTOM' button
    GO BOTTOM
    SCATTER MEMVAR
    SHOW GET Buttnvar,3 DISABLE   &amp;&amp; Disable "Next"
    SHOW GET Buttnvar,4 DISABLE   &amp;&amp; Disable "Bottom"

    IF (RECCOUNT() &gt; 1)
      SHOW GET Buttnvar,1 ENABLE  &amp;&amp; Enable  "Top"
      SHOW GET Buttnvar,2 ENABLE  &amp;&amp; Enable  "Prior"
    ELSE
      SHOW GET Buttnvar,1 DISABLE   &amp;&amp; Disable "Top"
      SHOW GET Buttnvar,2 DISABLE   &amp;&amp; Disable "Prior"
    ENDIF
    _CUROBJ = OBJNUM(Buttnvar)+1  &amp;&amp; Transfer focus to "Prior" button
    SHOW GETS
    WAIT WINDOW "At last record" TIMEOUT 1

  CASE Buttnvar = 5      &amp;&amp; 'QUIT' button
    CLEAR READ
</PRE>ENDCASE
<P>
You could place the "Show Gets" command at the end of the CASE statement.
However, sometimes it provides a snappier response when placed at the end
of a given instruction.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin FoxMac FoxDos 2.00 2.50<BR>
2.50a 2.50b<BR>
2.50c 2.60 2.60a<BR>
KBCategory: kbprg kbui kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
