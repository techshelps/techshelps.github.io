

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Convert Memo Fields into Embedded Word Documents </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137295">
<META NAME="KBModify" CONTENT="1996/06/03">
<META NAME="KBCreate" CONTENT="1995/09/25">
<META NAME="Keywords" CONTENT="kbinterop kbole FxinteropOle">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to take the text from a memo field and create a Microsoft Word document that can be embedded in a general field to allow easy use of the data within Word. The sample code in this article does it by by scanning thro...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAVX,QAVW,QA5V,QAH4,QA7O,QA7N,QAG8,QBXS,QAEF,QA9N,QAKC,QACI,QDO9,QAY4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Convert Memo Fields into Embedded Word Documents</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137295</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft FoxPro for Macintosh, version 2.6a
<LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to take the text from a memo field and
create a Microsoft Word document that can be embedded in a general field to
allow easy use of the data within Word. The sample code in this article
does it by by scanning through the table and replacing the general field
for the record with a word document containing the memo text for each
record that contains data in the memo field.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For the code samples in thie article to work, you must have Microsoft Word
version 6.0 installed and properly registered for OLE support. For the
Macintosh code sample to work, you must run Microsoft Word 6.0 to set the
file Creator and Type, and you must specify the class for the document in
the APPEND GENERAL command.
<P>
<P><h3>Macintosh Code Sample</h3>
 
<P>
* This code creates a .dbf file that holds a memo and a
* general field and creates an embedded Microsoft Word 6.0 document
* in the corresponding general field (mygen) for any record where
* the memo field (mymemo) contains text. It also reports the number
* of converted memo values in the statusbar as it goes.
* In the fname="MacHD:TEMPSTUF.TXT" line, replace MacHD with the
* actual name of your Mac hard disk drive volume.
<P>
CREATE TABLE test ;
<PRE>     (mymemo M, mygen G)
</PRE>INSERT INTO test (mymemo ) ;
<PRE>     VALUES ('Hello, this is a test')
</PRE>INSERT INTO test (mymemo) ;
<PRE>     VALUES ('Test record number 2')
</PRE>COUNT=0
SET LIBRARY TO foxtools
* Use the following line in Visual FoxPro for Macintosh
* SET LIBRARY TO foxtools.slm
<P>
SET SAFETY OFF
<PRE>fname="MacHD:TEMPSTUF.TXT"                &amp;&amp; temporary file
 name
</PRE>GO TOP
SCAN
<PRE>     IF MEMLINES(mymemo )&gt;0               &amp;&amp; text in the memo?
          COPY MEMO mymemo TO (fname)     &amp;&amp; macro sub the filename

          B=fxsettype(fname,"W6BN","MSWD")
          * W6BN,MSWD is the Type and Creator for a Word 6 document
          IF B!=0
               WAIT WINDOW "problem with FxSetType()"
          ENDIF
     * Replaces the general field (mygen) with an embedded Word Doc
          APPEND GENERAL mygen FROM (fname) CLASS word.document.6

          COUNT=COUNT+1          &amp;&amp; increment number created
          SET MESSAGE TO STR(COUNT)     &amp;&amp; display count on statusbar
     ENDIF
</PRE>ENDSCAN
<PRE>DELETE FILE (fname)                         &amp;&amp; remove temp file

</PRE><h3>Windows Visual Foxpro Code Sample</h3>
 
<P>
<P>
*  This code creates a .dbf file that has a memo and a
*  general field. It creates an embedded Microsoft Word document
*  in the corresponding general field (mygen) for any record where
*  the memo field (mymemo) contains text. It also shows the number
*  of converted memo values in the statusbar as it goes. A temporary
*  file is created and then deleted from the FoxPro startup directory.
<P>
CREATE TABLE test ;
<PRE>     (mymemo M, mygen G)
</PRE>INSERT INTO test (mymemo) ;
<PRE>     VALUES ('Hello, this is a test')
</PRE>INSERT INTO test (mymemo) ;
<PRE>     VALUES ('Test record number 2')

</PRE>COUNT=0
maindir=sys(2004)
OLD=SET('SAFETY')
SET SAFETY OFF
<PRE>FNAME=maindir+"tempdoc.doc"               &amp;&amp; Tempfile
</PRE>GO TOP
SCAN
<PRE>     IF !EMPTY(mymemo)                    &amp;&amp; Anything in the Memo?
          DELETE FILE maindir+"tempdoc.doc"
          COPY MEMO mymemo TO &amp;fname
          APPEND GENERAL mygen FROM &amp;fname
          COUNT=COUNT+1
          SET MESSAGE TO STR(COUNT)
     ENDIF
</PRE>ENDSCAN
<PRE>DELETE FILE maindir+"tempdoc.doc"          &amp;&amp; remove temp file
</PRE>SET SAFETY &amp;old
SET MESSAGE TO
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: vFoxMac 3.00b VFoxWin FoxMac 2.60a 3.00<BR>
KBCategory: kbinterop kbole<BR>
KBSubcategory: FxinteropOle<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
