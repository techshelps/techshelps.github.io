

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: WCOLS() and WROWS() Do Not Match SIZE Clause </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117234">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/06/23">
<META NAME="Keywords" CONTENT="kbenv kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The value returned by WCOLS() or WROWS() is not consistent with the values specified after the SIZE clause of a DEFINE WINDOW command.  CAUSE =====  When the SIZE clause of the DEFINE WINDOW command is used to define a window, the resulting window ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBBI,QAKD,QAPN,QAH4,QAKC,QAU4,QADF,QAGQ,QAPF,QAJQ,QAYV,QAVX,QAVW,QAUD,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: WCOLS() and WROWS() Do Not Match SIZE Clause</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117234</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for Macintosh, version 2.5b, 2.5c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The value returned by WCOLS() or WROWS() is not consistent with the values
specified after the SIZE clause of a DEFINE WINDOW command.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the SIZE clause of the DEFINE WINDOW command is used to define a
window, the resulting window will be one pixel higher and one pixel wider
than expected. The difference between the values reported by WCOLS() or
WROWS() and the specified size will vary if the window contains a scroll
bar or if clauses other than SIZE, FROM, and FONT are specified after the
DEFINE WINDOW command.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When the SIZE clause is used with the DEFINE WINDOW command, the resulting
window will always be one pixel higher and one pixel wider than specified.
If the additional pixel is not desired, you must specify lower values after
the SIZE clause so a window of the desired height and width can be defined.
Since the FONTMETRIC() function can be used to determine the size of the
differential, you can calculate the values that must be used to compensate
for this behavior. For examples of how to perform these calculations, see
the "More Information" section below.
<P>
NOTE: This solution applies only to windows that are defined with the
DEFINE WINDOW clause and for which no clauses other than SIZE, FROM, and
FONT are specified. This solution does not apply to windows with scroll
bars.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code sample demonstrates and explains the difference between
the values returned by WCOLS() and WROWS() and the values specified after
the SIZE clause of the DEFINE WINDOW command:
<P>
<PRE>   mfont = "Courier New"
   msize = 10

   mbegcol = 2
   mbegrow = 2
   msizerow = 30
   msizecol = 50

   * A window is defined. This window will have the size,
   * coordinates, and font attributes specified above.

   DEFINE WINDOW test ;
        FROM mbegcol,mbegrow ;
        SIZE msizerow,msizecol ;
        FONT mfont,msize

   ACTIVATE WINDOW test

   * The value returned by WROWS() will be larger than the
   * value specified for the size of the window. In this
   * particular example, WROWS() will be 30.063. This is
   * larger than the specified size by a value of 0.063.

   ? "WROWS()    = "+STR(WROWS(),10,3)
   ? "SIZE ROWS  = "+STR(msizerow,10,3)
   ? "DIFFERENCE = "+STR(WROWS()-msizerow,10,3)
   ?

   * The value returned by WCOLS() will be larger than the
   * value specified for the size of the window. In this
   * particular example, WCOLS() will be 50.125. This is
   * larger than the specified size by a value of 0.125.

   ? "WCOLS()    = "+STR(WCOLS(),10,3)
   ? "SIZE COLS  = "+STR(msizecol,10,3)
   ? "DIFFERENCE = "+STR(WCOLS()-msizecol,10,3)
   ?

   * These lines are used to show the height and width for
   * the font that was specified after the FONT clause of
   * the DEFINE WINDOW command for this window. In this
   * example, we see that Courier New has a width of 8 pixels
   * and a height of 16 pixels.

   ? "WIDTH(Pixels)  = "+STR(FONTMETRIC(6,mfont,msize),2,0)
   ? "HEIGHT(Pixels) = "+STR(FONTMETRIC(1,mfont,msize),2,0)
   ?

   * The "DIFFERENCE" numbers shown above were calculated by
   * subtracting the value returned by WROWS() from the number
   * of rows specified after the SIZE clause and by subtracting
   * the value returned by WCOLS() from the number of columns
   * specified after the SIZE clause.  The same difference
   * values can be calculated with the formulas shown below.
   * The difference between the value returned by WROWS() and
   * the value specified after the SIZE clause is equal to
   * 1/pixel width. In this case, 1/8 = .125, which is
   * precisely the value shown as the "row difference" above.

   ? "DIFFERENCE/ROWS (1/Pixels) = " + ;
        STR(1/FONTMETRIC(1,mfont,msize),10,3)
   ? "DIFFERENCE/COLS (1/Pixels) = " + ;
        STR(1/FONTMETRIC(6,mfont,msize),10,3)

   ?

   = INKEY(0)

   RELEASE WINDOW test

</PRE>The following code samples can be used to convert between the expected
values and the actual values. The code samples shown below assume that a
window is defined in the manner illustrated above; that is, the memory
variable names used in the example above are used in these code samples.
Actual numeric or character values can be used instead of variables.
<P>
To determine the number of rows that were specified after the SIZE clause
of the DEFINE WINDOW command, this code can be executed when the window is
active:
<P>
<PRE>   ? WROWS() - 1/FONTMETRIC(1,mfont,msize)

</PRE>To determine the number of columns that were specified after the SIZE
clause of the DEFINE WINDOW command, this code can be executed when the
window is active:
<P>
<PRE>   ? WCOLS() - 1/FONTMETRIC(6,mfont,msize)

</PRE>The following code produces a window of the desired size when the SIZE
clause of the DEFINE WINDOW command is used to specify the size of the
window:
<P>
<PRE>   mfont = "Courier New"
   msize = 10
   mbegcol = 2
   mbegrow = 2
   msizerow = 30
   msizecol = 50

   msizerow = msizerow - 1/FONTMETRIC(1,mfont,msize)
   msizecol = msizecol - 1/FONTMETRIC(6,mfont,msize)

   DEFINE WINDOW test ;
        FROM mbegcol,mbegrow ;
        SIZE msizerow,msizecol ;
        FONT mfont,msize
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxWin 2.50 2.50a 2.50b 2.50c 2.60<BR>
buglist2.50<BR>
buglist2.50a buglist2.50b buglist2.50c buglist2.60<BR>
KBCategory: kbenv kbprg kbbuglist<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
