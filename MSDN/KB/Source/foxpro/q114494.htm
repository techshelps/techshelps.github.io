

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Refreshed SAY Field Does Not Clear Previous Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114494">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/05/04">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When the value displayed by an @ ... SAY object is refreshed, the previously displayed text is not completely cleared from the screen. This behavior will be most obvious when a short text string is displayed immediately after a long text string.  C...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QADR,QAJX,QAEF,QAY2,QAVX,QAVW,QATX,QAPN,QBVV,QAXB,QAW6,QAMB,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Refreshed SAY Field Does Not Clear Previous Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114494</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the value displayed by an @ ... SAY object is refreshed, the
previously displayed text is not completely cleared from the screen. This
behavior will be most obvious when a short text string is displayed
immediately after a long text string.
<P>
<P><h2>CAUSE</h2>
 
<P>
The values may not be completely cleared if either of the following
conditions is true:

<UL><LI>The font of the window in which the text is being displayed is
   smaller than the font of the text itself.
<P>
   -or-

<LI>The text is being displayed in Transparent mode rather than Opaque mode.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
There are two ways to correct the problem of not properly clearing
previous SAY values:

<UL><LI>Change the font of the window to be the same font as, or a larger font
   than the font used in the @ ... SAY objects that will be refreshed. For
   example, you could change the DEFINE WINDOW command from the program in
   the "More Information" section below to:
<P>
<P><PRE>      DEFINE WINDOW test FROM 1,1 TO 15,50 ;
<PRE></PRE>         FONT "TIMES NEW ROMAN",18 STYLE "N"

   In the Screen Builder, you can change the window font by choosing Layout
   from the Screen menu, choosing the Font push button from the Screen
   Layout dialog box, and then selecting the new font for the window.

   -or-

</PRE><LI>Change the @... SAY objects from transparent to opaque (in the STYLE
   clause). For example, change the @... SAY commands in the program below
   to the following (both in the main procedure and in the READ LEVEL SHOW
   procedure):
<P>
<P><PRE>      @ 1,8 SAY customer.company ;
<PRE></PRE>         FONT "TIMES NEW ROMAN", 18 STYLE "BQ" ;
         SIZE 1,30

   Note that the STYLE clause has been changed from "BT" (Bold,
   Transparent) to "BQ" (Bold, Opaque).

   In the Screen Builder, you can change the mode of the object by
   first selecting the object, choosing Mode from the Object menu,
   and then selecting Opaque.

</PRE></UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Run the following program:
<P>
<P><PRE>      USE (SYS(2004)+'tutorial\customer.dbf') &amp;&amp; (FoxPro 2.x)
      * In Visual FoxPro, substitute the following line instead of the line
      * above:
      * USE (SYS(2004)+'samples\data\customer.dbf') &amp;&amp; (Visual FoxPro)
      CLEAR
      DEFINE WINDOW test FROM 1,1 TO 15,50 ;
<PRE></PRE>         FONT "COURIER NEW",12 STYLE "N"
      ACTIVATE WINDOW test

      @ 1,8 SAY customer.company ;
         FONT "Times New Roman",18 STYLE "BT" ;
         SIZE 1,30
      @ 5,10 GET choice ;
         PICTURE "@*HN refresh" SIZE 2,8,1 ;
         DEFAULT 1 VALID choiceval()

      READ CYCLE SHOW rdshow()

      RELEASE WINDOW test
      CLOSE DATABASES

      FUNCTION choiceval     &amp;&amp;  choice VALID
         SKIP
         SHOW GETS
      RETURN                 &amp;&amp; END FUNCTION choiceval

      FUNCTION rdshow        &amp;&amp; Read Level Show
         @ 1,8 CLEAR TO 2,38
         @ 1,8 SAY customer.company ;
            FONT "TIMES NEW ROMAN", 18 STYLE "BT" ;
            SIZE 1,30
      RETURN                 &amp;&amp; END FUNCTION rdshow

</PRE><P><LI>When the window is activated, choose the Refresh push button several
   times. Note that longer company names and the lower portion of the
   company names are not cleared completely.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxWin VFoxWin 2.50 2.50a 2.50b 2.50c<BR>
2.60 2.60a 3.00<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgUdwindow<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
