

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Text in Edit Region Is Double Spaced After a READ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112185">
<META NAME="KBModify" CONTENT="1997/05/16">
<META NAME="KBCreate" CONTENT="1994/03/02">
<META NAME="Keywords" CONTENT="FoxMac kbcode VFoxMac">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Text in an edit region appears double-spaced after changes are made to the text during a READ.  CAUSE =====  When changes are made to the text in the edit region, FoxPro for Macintosh adds a CHR(13)--a carriage return--immediately following any CHR...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QATX,QABO,QAEF,QBFN,QAUD,QAHH,QADN,QANY,QDO9,QAY5,QAPN,QAWN,QAKC,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Text in Edit Region Is Double Spaced After a READ</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112185</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, version 2.5b
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Text in an edit region appears double-spaced after changes are made to
the text during a READ.
<P>
<P><h2>CAUSE</h2>
 
<P>
When changes are made to the text in the edit region, FoxPro for Macintosh
adds a CHR(13)--a carriage return--immediately following any CHR(10)--a
linefeed--within the text.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the edit region's VALID clause to remove the CHR(13) characters from
the text. For example, the following statement uses the STRTRAN() function
to remove all CHR(13) characters from the text memory variable called
m.notes:
<P>
<PRE>   m.notes=STRTRAN(m.notes,CHR(13))

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
To illustrate the problem of FoxPro adding CHR(13) characters in text, run
the following program, which counts the number of CHR(13) characters in the
edit region's VALID clause.
<P>
<PRE>   CLEAR
   m.notes="Line1"+CHR(10)+"Line2"+CHR(10)+"Line3"+CHR(10)+"Line4"
   WAIT WINDOW "There are "+cntchr13(m.notes)+ ;
               " CHR(13) characters in    m.notes"
   @2,2 edit m.notes size 10,25 scroll
   READ
   WAIT WINDOW "There are "+cntchr13(m.notes)+ ;
               " CHR(13) characters in m.notes"

   FUNCTION cntchr13
   PARAMETER teststring
   chrcount=0
   DO WHILE AT(CHR(13),teststring)&lt;&gt;0
     chrcount=chrcount+1
     teststring=STRTRAN(teststring,CHR(13),"",1,1)
   ENDDO
   RETURN ALLTRIM(STR(chrcount))

</PRE>When the above program is executed, if a change is made in the edit region,
the wait window following the READ command will return a number greater
than zero. If no changes are made (for example, the TAB key is pressed), no
CHR(13) characters will be shown in the wait windows.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: CR LF line feed modify alter modified<BR>
Keywords            : FoxMac kbcode VFoxMac<BR>
Version             : 2.5b 3.0b<BR>
Platform            : MACINTOSH<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
