

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Sum or Count Specific Fields in a Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106659">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/11/11">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can use a report variable in conjunction with the Immediate IF function (IIF) to count or sum a specific report field.  MORE INFORMATION  The IIF function returns one of two values, depending on the value of a logical expression. If the logical...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAUD,QBXS,QAKD,QAVX,QAVW,QBWS,QA7O,QA7N,QDMW,QAP2,QAG2,QAB9,QAEN,QA50 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Sum or Count Specific Fields in a Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106659</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use a report variable in conjunction with the Immediate IF
function (IIF) to count or sum a specific report field.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The IIF function returns one of two values, depending on the value of
a logical expression. If the logical expression is true, the first
value is returned. If the logical expression is false, the second IIF
return value is returned.
<P>
NOTE: To count or sum ALL possible values of a field, do not use this
report variable technique. Instead, sort the database on the field,
and then create a data grouping in the report for the field.
<P>
<P><h3>To Count Fields</h3>
 

<OL><P><LI>Create a report variable containing an IIF function.

<P><LI>In the logical expression of the IIF function, type the condition
   you want to count. In the first IIF return value, type "1" (without
   the quotation marks). In the second IIF return value, type "0"
   (without the quotation marks).

<P><LI>In the Variable Definition dialog box, under Calculate, select Sum.
<P>
</OL><h3>To Sum Fields</h3>
 

<OL><P><LI>Create a report variable containing an IIF function.

<P><LI>In the logical expression of the IIF function, type the condition
   you want to test for when summing. In the first IIF return value,
   type the name of the value (which must be numeric) you want to sum.
   In the second IIF return value, type "0" (without the quotation
   marks).

<P><LI>In the Variable Definition dialog box, under Calculate, select Sum.
<P>
</OL><h3>Example Using FoxPro for Windows</h3>
 
<P>
This example creates a database of different types of computers and
their prices. The report variable, DESKTOPCT, created in steps 5
through 8, counts the number of records whose type equals 'DESKTOP.'
The report variable, DESKTOPSUM, created in steps 9 through 11, sums
the price of all records whose type equals 'DESKTOP.'

<OL><P><LI>Use the following code to create the database:
<P>
       CREATE TABLE test ;
<PRE>          (type C(20), price N(5))

       INSERT INTO test (type, price) ;
          VALUES ('DESKTOP', 1500)
       INSERT INTO test (type, price) ;
          VALUES ('LAPTOP', 2000)
       INSERT INTO test (type, price) ;
          VALUES ('DESKTOP', 4000)

</PRE><P><LI>Use the Report Builder to create a new report.

<P><LI>From the Report menu, choose Quick Report, then the OK button.

<P><LI>From the Report menu, choose Title/Summary. Under Report
    Summary, select Summary Band. Choose OK.

<P><LI>From the Report menu, choose Variables, then choose the Add
    button.

<P><LI>In the Variable Name text book, type "desktopct" (without the
    quotation marks).

<P><LI>Choose the Value To Store button, which opens the Expression Builder
    dialog box. Under Value To Store In Variable Desktopct, type the
    following:
<P>
       IIF(test.type = 'DESKTOP',1,0)
<P>
    Choose OK.

<P><LI>In the Variable Definition dialog box, under Calculate, select
    Sum. Choose OK. (This variable counts the number of records whose
    type equals 'DESKTOP').

<P><LI>In the Report Variables dialog box, choose the Add button. In the
    Variable Name text book, type "desktopsum" (without the quotation
    marks).

<P><LI>Choose the Value To Store button, which opens the Expression
    Builder dialog box. Under Value To Store In Variable Desktopsum,
    type the following:
<P>
       IIF(test.type = 'DESKTOP',test.price,0)
<P>
    Choose OK.

<P><LI>In the Variable Definition dialog box, under Calculate, select
    Sum. Choose OK twice to return to the Report Layout window. (This
    variable sums the PRICE field for all records whose type equals
    'DESKTOP').

<P><LI>From the toolbox, select the Field tool.

<P><LI>Place a field object in the Summary band. In the Report Expression
    dialog box, choose the Expression button. Under Variables, double-
    click DESKTOPCT. Choose OK to return to the Report Layout window.

<P><LI>From the toolbox, select the Field tool again.

<P><LI>Place a field object in the Summary band. In the Report Expression
    dialog box, choose the Expression button. Under Variables, double-
    click DESKTOPSUM. Choose OK to return to the Report Layout window.

<P><LI>From the Report menu, choose Page Preview. Note that the variable
    DESKTOPCT displays "2," and DESKTOPSUM displays "5500."
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxDos FoxWin 2.00 2.50 2.50a<BR>
2.50b<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
