

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: @...GET...NAME Object References Change with Read Level </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156178">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/18">
<META NAME="Keywords" CONTENT="kbusage kbui kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You may see the following error when referencing objects created using READ- type code with the NAME keyword (DEFINE WINDOW...NAME and @...GET...NAME):      Unknown member                This occurs in situations with multiple READ levels.  CAUSE =...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAUJ,QBFN,QAY5,QAW6,QAXC,QBV8,QAPF,QAA3,QAB9,QAB3,QARM,QAA8,QABG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: @...GET...NAME Object References Change with Read Level</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156178</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may see the following error when referencing objects created using READ-
type code with the NAME keyword (DEFINE WINDOW...NAME and @...GET...NAME):
<P>
<PRE>   "Unknown member &lt;objectname&gt;"

</PRE>This occurs in situations with multiple READ levels.
<P>
<P><h2>CAUSE</h2>
 
<P>
When objects are created using the NAME keyword, each one is added to a
page within a PageFrame control. The page number corresponds to the READ
level.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Reference objects in the following manner:
<P>
<PRE>   &lt;FormName&gt;.Pageframe1.Page&lt;rdlevel()&gt;.&lt;ObjectName&gt;.Property

</PRE>See the MORE INFORMATION section below for details.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The NAME keyword creates an object reference for controls created with the
DEFINE WINDOW, @ ... GET, and @ ... EDIT commands, allowing you to
manipulate these objects' properties, events, and methods.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run the following code from a program (.prg) file:
<P>
   * Start of code example
   *
   DEFINE WINDOW Wind1 AT 0, 0 SIZE 15, 50 TITLE "1st Screen" ;
<P><PRE>      SYSTEM FLOAT NAME oForm1
</PRE>   ACTIVATE WINDOW Wind1
   @ 1, 10 SAY "Press Enter to go to 2nd screen"
   @ 3, 11 SAY "1st screen get " GET lcGet1 SIZE 1, 17 ;
<P><PRE>      DEFAULT " " WHEN when1() VALID valid1() NAME loGet1
</PRE>   READ
<P>
   RELEASE WINDOW Wind1
<P>
   FUNCTION when1
<P><PRE>      oForm1.Pageframe1.Page1.loGet1.Value = "123"
</PRE>   ENDFUNC
<P>
   FUNCTION valid1
<P><PRE>      DO Screen2
</PRE>   ENDFUNC
<P>
   FUNCTION Screen2
<P>
<P><PRE>      DEFINE WINDOW Wind2 AT 0, 0 SIZE 10,55 TITLE "2nd Screen ";
<PRE></PRE>         SYSTEM FLOAT NAME oForm2
      ACTIVATE WINDOW Wind2
      @ 3, 6  SAY "2nd screen get " GET lcGet2 SIZE 1, 17 ;
         DEFAULT " " WHEN When2() NAME loGet2
      READ

      RELEASE WINDOW Wind2
      CLEAR READ ALL
   ENDFUNC

   FUNCTION When2
      oForm2.Pageframe1.Page1.lo_Get2.Value = "123"
   ENDFUNC
   *
   * End of code example

</PRE><P><LI>Note that code in the When1 function successfully references the Value
   property of the @...GET command in the first screen. Press enter from
   1st Screen to go to the second Screen.

<P><LI>The error "Unknown member LO_GET2" occurs as 2nd Screen appears. The
   following code refers to a nonexistant member since the object loGet2 is
   actually contained in oForm2.Pageframe1.Page2:
<P>
<P><PRE>      oForm2.Pageframe1.Page1.loGet2.Value = "123"
</PRE><P>
</OL>A generic workaround for this behavior is to use the following code to
determine the current READ level and insert the current READ level into the
object reference with Macro Substitution. For example, change the code for
the function When2 in the code sample above to read as follows:
<P>
<PRE>   * Start of code example
   *
   FUNCTION When2
      LOCAL lcPageNumber
      lcPageNumber=ALLTR(STR(RDLEVEL()))
      oForm2.Pageframe1.Page&amp;lcPageNumber..loGet2.Value = "456"
   ENDFUNC
   *
   * End of code example

</PRE></OL>This stores the current READ level to lcPageNumber and substitutes it back
into the object reference. This allows the object loGet2 to be referenced
regardless of READ level.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using the NAME keyword with the DEFINE WINDOW
and @ GET commands, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q138780.htm">Q138780</A></B>
   TITLE     : How to Use the Name Argument of an @...GET in Visual FoxPro
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbui kbprg kbprb<BR>
KBSubcategory: FxprgClassoop FxprgRead<BR>
Additional reference words: 3.00 3.00b 5.00 kbdse VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
