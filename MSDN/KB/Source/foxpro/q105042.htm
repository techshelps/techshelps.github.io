

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Add/Remove Network Connections in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105042">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1993/10/06">
<META NAME="Keywords" CONTENT="kbnetwork kbinterop kbprg kbtool kbnetwork kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can add and remove network connections from within a FoxPro for Windows application by using the Windows application programming interface (API) through FOXTOOLS.FLL, a library file included with FoxPro. To do this, see below.  NOTE: For backwa...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QDL9,QBWO,QBWN,QBG2,QAVZ,QAI5,QBSO,QBWQ,QBV8,QBHQ,QBBI,QAY5,QAEF,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Add/Remove Network Connections in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105042</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can add and remove network connections from within a FoxPro for
Windows application by using the Windows application programming
interface (API) through FOXTOOLS.FLL, a library file included with
FoxPro. To do this, see below.
<P>
NOTE: For backward compatibility, Visual FoxPro still supports FOXTOOLS.FLL
(included in earlier FoxPro versions), the Visual FoxPro API library that
allows calls to 16-bit .DLL functions. However, in Visual FoxPro, the
DECLARE command is the preferred method for calling .DLL functions.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>In a program, you must open the FOXTOOLS.FLL external library
   first. To do this, use the SET LIBRARY TO command as follows to
   ensure that the program finds the FOXTOOLS.FLL library in the
   FoxPro directory:
<P>
<P><PRE>      SET LIBRARY TO SYS(2004)+'FOXTOOLS.FLL' ADDITIVE
</PRE>
<P><LI>Register the Windows API functions that you would like to call. In
   this case, use WNetAddConnection() and WNetCancelConnection().
<P>
<P><PRE>      addconn=RegFn('WNetAddConnection','CCC','I')
      delconn=RegFn('WNetCancelConnection','CI','I')
</PRE>
<P><LI>To make a connection to a network device, issue the following
   command:
<P>
<P><PRE>      =CallFn(addconn,"\\SERVER\SHARE","password","&lt;drive&gt;:")
</PRE>
<P><LI>To disconnect a network connection, issue the following command:
<P>
<P><PRE>      =CallFn(delconn,"&lt;drive&gt;:",0)
</PRE><P>
</OL><h3>WNetAddConnection()</h3>
 
<P>
The WNetAddConnection() function redirects the specified local device
(either a disk drive or a printer port) to the given shared device or
remote server. It takes the following parameters:
<P>
<PRE>   Parameter         Description
   -------------------------------------------------------------------

   lpszNetPathName   A pointer to a null-terminated string specifying
                     the shared device or remote server, such as
                     \\SERVER\SHARE.

</PRE></OL>NOTE: Novell users should not use the double-colon syntax to reference a
server and directory, as they may be accustomed to doing. For example, do
not try referencing a directory using the following syntax:
<P>
<PRE>   \\server\volume::\mydirectory

</PRE>Instead use this syntax: \\server\volume\mydirectory
<P>
<PRE>   lpszPassword      A pointer to a null-terminated string specifying
                     the network password for the given device or
                     server. If there is no password, you must still
                     include a placeholder, as follows:

                        =CallFn(addconn,"\\SERVER\SHARE","","&lt;drive&gt;:")

   lpszLocalName     A pointer to a null-terminated string specifying
                     the local drive or device to be redirected. All
                     lpszLocalName strings (such as LPT1) are
                     case-independent. Only the drive names A through
                     Z and the device names LPT1 through LPT3 are
                     used.

</PRE><h3>WNetCancelConnection()</h3>
 
<P>
The WNetCancelConnection() function cancels a network connection. It
takes the following parameters:
<P>
<PRE>   Parameter         Description
   -------------------------------------------------------------------

   lpszName          A pointer to the name of the redirected local
                     device (such as LPT1: or D:).

   fForce            A Boolean value that specifies whether any open
                     files or open print jobs on the device should be
                     closed before the connection is canceled.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about WNetAddConnection() and
WNetCancelConnection(), see the Microsoft Windows Software Development
Kit (SDK) "Programmer's Reference, Volume 2: Functions," which
contains more information about the functions' return values and their
meanings.
<P>
NOTE: These return values will not be interpreted by FoxPro for
Windows.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxWin 3.00 FoxWin 2.50 2.50a 2.50b 2.60<BR>
2.60a change net connection<BR>
KBCategory: kbnetwork kbinterop kbprg kbtool kbcode<BR>
KBSubcategory: FxprintNet<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
