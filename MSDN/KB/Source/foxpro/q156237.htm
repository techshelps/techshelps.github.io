

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Report Designer/Preview Needs VFP Desktop to Display </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156237">
<META NAME="KBModify" CONTENT="1998/01/13">
<META NAME="KBCreate" CONTENT="1996/09/19">
<META NAME="Keywords" CONTENT="FxtoolFormdes FxtoolReportdes kbprb kbprg kbtool kbui">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If REPORT FORM            PREVIEW or MODIFY REPORT            is called from an SDI or top-level form (form with the ShowWindow property set to 2), the Report Preview or Report Designer does not appear if the Visual FoxPro desktop is hidden.  WORKA...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QAH4,QA0J,QAK5,QA56,QA55,QAJX,QAGB,QAEF,QADR,QAB9,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Report Designer/Preview Needs VFP Desktop to Display</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156237</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00
WINDOWS
kbtool kbui kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If REPORT FORM &lt;formname&gt; PREVIEW or MODIFY REPORT &lt;formname&gt; is called
from an SDI or top-level form (form with the ShowWindow property set to 2),
the Report Preview or Report Designer does not appear if the Visual FoxPro
desktop is hidden.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Make the Visual FoxPro desktop visible (_SCREEN.Visible = .T.) and display
the Report Designer or preview and hide the Visual FoxPro desktop
(_SCREEN.Visible = .F.) after the Report Designer or Preview has been
closed.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Page Preview and Report Designer windows are being created as a child
window of the Visual FoxPro desktop. Since the desktop is not visible, the
Page Preview and Report Designer windows cannot be visible. Each of these
windows has toolbars that require the Visual FoxPro desktop in order for
them to be displayed.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run the following code from a program (.prg) file:
<P>
   * Start of code example
   *
   PUBLIC oform
   LOCAL lnI
   CLOSE ALL
   CREATE TABLE table_1 (field1 C(10))
   FOR lnI=1 TO 3
<P><PRE>      INSERT INTO table_1 VALUES ('xx')
</PRE>   ENDFOR
<P>
   CREATE REPORT report_1 FROM table_1
<P>
   oform=CREATEOBJECT("SDI_form")
   oform.SHOW()
   READ EVENTS
   CLOSE TABLES
<P>
   DEFINE CLASS sdi_form AS FORM
<P>
<P><PRE>      SHOWWINDOW = 2
      AUTOCENTER = .T.
      lIsFormUp=.F.
</PRE><P>
<P><PRE>      ADD OBJECT commandpreview AS COMMANDBUTTON WITH ;
<PRE></PRE>         TOP = 180, ;
         LEFT = 80, ;
         HEIGHT = 27, ;
         WIDTH = 95, ;
         CAPTION = "Report Preview", ;
         NAME = "Commandpreview"

      ADD OBJECT commanddesign AS COMMANDBUTTON WITH ;
         TOP = 180, ;
         LEFT = 202, ;
         HEIGHT = 27, ;
         WIDTH = 95, ;
         CAPTION = "Modify Report", ;
         NAME = "Commanddesign"

      PROCEDURE DESTROY
         CLEAR EVENTS
         _SCREEN.VISIBLE=.T.
      ENDPROC

      PROCEDURE ACTIVATE
         IF !THIS.lisformup
            _SCREEN.VISIBLE = .F.   &amp;&amp; We wait till now to hide desktop
                                    &amp;&amp; to ensure SDI form is active window
            THIS.lIsFormUp = .T.
         ENDIF
      ENDPROC

      PROCEDURE commandpreview.CLICK
         REPORT FORM report_1 PREVIEW
      ENDPROC

      PROCEDURE commanddesign.CLICK
         MODIFY REPORT report_1
      ENDPROC

   ENDDEFINE
   *
   * End of code example

</PRE><P><LI>Click on either command button. The preview or Report Designer does not
   appear.
<P>
   NOTE: You may need to double-click the [-] or fox head in the upper left
   corner to close the form after doing this.
<P>
</OL><h3>How to Get It Working</h3>
 

<OL><P><LI>Modify the Click procedure code for the two command buttons above to
   read as follows:
<P>
   * Start of code example
   *
   PROCEDURE commandpreview.CLICK
<PRE>      _SCREEN.VISIBLE = .T.           &amp;&amp; Show VFP desktop
      KEYBOARD '{ctrl+f10}' CLEAR     &amp;&amp; Maximixe Preview window
      REPORT FORM report_1 PREVIEW
      _SCREEN.VISIBLE = .F.           &amp;&amp; Hide VFP desktop
   ENDPROC

   PROCEDURE commanddesign.CLICK
      LOCAL lcOldShutDown
      lcOldShutDown = ON('shutdown')  &amp;&amp; Saves existing ON SHUTDOWN
      ON SHUTDOWN _SCREEN.VISIBLE=.F. &amp;&amp; Traps for closing desktop
      _SCREEN.VISIBLE = .T.           &amp;&amp; Show VFP desktop
      KEYBOARD '{ctrl+f10}' CLEAR     &amp;&amp; Maximixe Designer window
      MODIFY REPORT report_1
      _SCREEN.VISIBLE = .F.           &amp;&amp; Hide VFP desktop
      ON SHUTDOWN &amp;lcOldShutDown      &amp;&amp; Restores existing ON SHUTDOWN
   ENDPROC
   *
   * End of code example

</PRE><P><LI>Click on either command button. The preview or Report Designer appears.
   When the preview or Report Designer is closed, the desktop is again
   hidden and the SDI form regains the focus.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbui kbprg kbprb<BR>
KBSubcategory: FxtoolFormdes FxtoolReportdes<BR>
Additional reference words: 5.00 kbdse VfoxWin print preview<BR>
Keywords          : FxtoolFormdes FxtoolReportdes kbprb kbprg kbtool kbui<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
