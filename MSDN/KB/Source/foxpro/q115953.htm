

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: #IF &lt;System Memvar&gt; Returns "Invalid Preprocessor..." </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115953">
<META NAME="KBModify" CONTENT="1996/02/16">
<META NAME="KBCreate" CONTENT="1994/06/07">
<META NAME="Keywords" CONTENT="kbenv kbprg kberrmsg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The compiler directives #IF ... #ENDIF used with the _DOS, _WINDOWS, _MAC, and _UNIX system memory variables generate an  Invalid preprocessor expression  error message when compiled under FoxPro for Windows and FoxPro for Macintosh. FoxPro for MS-...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QBWS,QDO9,QAB4,QALQ,QAH4,QAUD,QBVV,QABI,QAJQ,QAYL,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: #IF &lt;System Memvar&gt; Returns "Invalid Preprocessor..."</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115953</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The compiler directives #IF ... #ENDIF used with the _DOS, _WINDOWS, _MAC,
and _UNIX system memory variables generate an "Invalid preprocessor
expression" error message when compiled under FoxPro for Windows and FoxPro
for Macintosh. FoxPro for MS-DOS does not produce any error messages when
the same code is compiled. Instead, it compiles the statement following #IF
_DOS and displays "This displays only when running under DOS".
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To obtain the desired results when using preprocessor directives, run the
following code in all three products:
<P>
<PRE>   #IF 'WINDOWS' $ UPPER(VERSION())
            ? "This should display only when running under Windows"
   #ELIF 'MAC' $ UPPER(VERSION())
        ? "This should display only when running on the Macintosh"
   #ELSE
        ? "This should display only when running under DOS"
   #ENDIF

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Both FoxPro for Windows and Macintosh return the expected results because
the _DOS, _WINDOWS, _MAC, and _UNIX system memory variables are not
considered preprocessor definitions since they are evaluated at run time,
not compile time.
<P>
The online help system for FoxPro for Windows, MS-DOS, and Macintosh
contains the following warning:
<P>
NOTE: Do not use system memory variables for &lt;expN1&gt; or &lt;expL1&gt;. System
memory variables are not evaluated until run time.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Load FoxPro for Windows and run the following program:
<P>
<P><PRE>      #IF _WINDOWS
<PRE></PRE>             ? "This displays only when running under Windows"
      #ENDIF

      #IF _MAC
            ? "This displays only when running on the Macintosh"
      #ENDIF

      #IF _DOS
           ? "This displays only when running under DOS"
      #ENDIF

</PRE><P><LI>Issue the MODIFY FILE &lt;filename.ERR&gt; command. Note that there are three
   compile errors (for example, "Invalid preprocessor expression") listed
   in the .ERR file. Close FoxPro for Windows.

<P><LI>Load FoxPro for MS-DOS and run the same program. Make sure that the .FXP
   file does exist before you issue the DO &lt;filename.prg&gt; command. This
   will ensure that FoxPro for MS-DOS will recompile the program.
<P>
</OL>FoxPro for MS-DOS will display the following message:
<P>
<PRE>   This displays only when running under DOS
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.50 2.50a 2.50b 2.60<BR>
2.50c<BR>
buglist2.50<BR>
buglist2.50a buglist2.50b buglist2.60 buglist2.50c memvar<BR>
KBCategory: kbenv kbprg kberrmsg kbbuglist<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
