

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: "Invalid Library" When Rebuilding an Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113798">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/04/17">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you attempt to rebuild an application with the Rebuild All option in the Build dialog box of the Project Manager, an  Invalid Library  error message will occur if there is an application programming interface (API) library included in the proj...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBHQ,QDL9,QBWQ,QBWO,QBWN,QAR4,QDIT,QAB4,QAJN,QAAP,QBXS,QAVX,QAVW,QAJH,QDO9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: "Invalid Library" When Rebuilding an Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113798</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.60 | 2.5x 2.60 | 2.50b 2.60
<PRE>WINDOWS   | MS-DOS    | MACINTOSH
</PRE>kbother kbbuglist kbfixlist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro Library Construction Kit for Windows and MS-DOS,
   versions 2.5x, 2.6
<LI>Microsoft FoxPro Library Construction Kit for Macintosh, version 2.5b,
   2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to rebuild an application with the Rebuild All option in
the Build dialog box of the Project Manager, an "Invalid Library" error
message will occur if there is an application programming interface (API)
library included in the project that does not belong to the current
platform.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Remove the API libraries from the project.
<P>
You should not explicitly add API libraries to your project. When creating
cross-platform applications, use the #IF ... #ENDIF structure to specify
the correct API library based on the current platform.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
FoxPro version 2.6a for MS-DOS, Windows, and Macintosh.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Load FoxPro for Windows.

<P><LI>Create a project called TEST.

<P><LI>Add a new program called MAIN and type the following commands:
<P>
<P><PRE>      #IF "WINDOWS" $ UPPER(VERSION(1))
<PRE></PRE>           SET LIBRARY TO foxtools.fll
      #ELSE
           SET LIBRARY TO pdrivers.plb
      #ENDIF

</PRE><P><LI>Add the API library FOXTOOLS.FLL as a Library type. This file will
   automatically be marked as External.

<P><LI>Save the project and quit FoxPro for Windows.

<P><LI>Load FoxPro for MS-DOS.

<P><LI>Open the TEST project.

<P><LI>Choose the Build option in the open project and choose Rebuild All. The
   error "Invalid Library" will occur. This error occurs because FoxPro for
   MS-DOS does not recognize FoxPro for Windows API libraries.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos FoxMac 2.50 2.50a 2.50b 2.60<BR>
buglist2.50 buglist2.50a buglist2.50b buglist2.60 fixlist2.60a errmsg err<BR>
msg refresh<BR>
KBCategory: kbother kbbuglist kbfixlist kberrmsg<BR>
KBSubcategory: FxprgFoxtools<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
