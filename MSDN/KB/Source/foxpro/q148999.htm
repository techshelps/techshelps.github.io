

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: ON ERROR Not Called When Update Conflict Occurs in Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148999">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 FxprgGrid vfoxwin vfpbug5.0a kbnetwork kbprg kbbug">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use row or table buffering in a form, an update conflict could occur if a user attempts to make changes to data that has already been updated by another user. In this situation, Visual FoxPro will display a standard update conflict error m...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAB4,QAAP,QBD2,QAC1,QA5V,QAM9,QAHC,QARR,QAKP,QAH4,QBT6,QAA5,QBV4,QDIX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ON ERROR Not Called When Update Conflict Occurs in Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148999</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use row or table buffering in a form, an update conflict could
occur if a user attempts to make changes to data that has already been
updated by another user. In this situation, Visual FoxPro will display a
standard update conflict error message, which allows the user to revert
their changes. You can use an ON ERROR routine to trap for this error to
more gracefully handle potential update conflicts. However, when you use an
ON ERROR routine to trap for these update conflicts, the error routine will
not be called correctly if the error occurs while interacting with a grid.
This is a bug.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Using the Valid event of the text box object in the columns of a grid, you
can check for potential update conflicts before actually performing the
updates. Place the following code in the Valid event of the text box in
every column of a grid:
<P>
<PRE>   IF InList(GetFldState(This.ControlSource),2,4) AND ;
      OldVal(This.ControlSource)&lt;&gt;CurVal(This.ControlSource)
        WAIT WINDOW 'Value has been changed by another user.'
        =TableRevert(.t.)
        RETURN 0
   ENDIF

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new form. Add a table to the data environment of the form and
   set the BufferModeOverride property to 3. Drag the table from the data
   environment to the form to create a grid. Save the form as Test.scx.

<P><LI>Create a new program that contains the following code:
<P>
   SET EXCLUSIVE OFF
   ON ERROR WAIT WINDOW 'This is my error handler'
   DO FORM Test

<P><LI>Save and run the program.

<P><LI>Start a second instance of Visual FoxPro, and run the program under this
   second instance of Visual FoxPro.

<P><LI>Make a change to a field on the first record in the grid, and move off
   that record to update the table.

<P><LI>Switch back to the first instance of Visual FoxPro.

<P><LI>Make a change to the same field on the first record of the grid, and
   move off that record to update the table. Note that the standard update
   conflict error appears instead of the WAIT WINDOW.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the grid and the ON ERROR command, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q130131.htm">Q130131</A></B>
   TITLE     : PRB: ON ERROR Not Called When Trigger Fails in Browse
               or Grid
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbbuglist<BR>
KBSubcategory: FxprgGrid vfoxwinbuglist3.00 buglist3.00b buglist5.00<BR>
Additional reference words: 5.00 3.00 3.00b multiuser<BR>
Keywords          : buglist3.00 buglist3.00b buglist5.00 FxprgGrid vfoxwin vfpbug5.0a kbnetwork kbprg kbbuglist<BR>
Version           : 3.0 3.0b 5.0 5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
