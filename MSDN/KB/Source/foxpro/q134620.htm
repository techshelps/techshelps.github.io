

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Error in Converter: Variable Gendircount Not Found </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134620">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/08/08">
<META NAME="Keywords" CONTENT="FxinteropPrevfox kbbuglist kbfixlist kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a screen built in FoxPro version 2.x that contains a #REGION statement is converted, the converter halts, and displays this error message:     Variable 'GENDIRCOUNT' is not found  CAUSE =====  This is an error in the Converter. The error occur...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAYL,QAAP,QBWS,QAR4,QAPN,QAB4,QAEQ,QAUR,QBTI,QBJZ,QBVV,QA56,QA55,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Error in Converter: Variable Gendircount Not Found</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134620</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbinterop kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a screen built in FoxPro version 2.x that contains a #REGION statement
is converted, the converter halts, and displays this error message:
<P>
<PRE>   Variable 'GENDIRCOUNT' is not found

</PRE><h2>CAUSE</h2>
 
<P>
This is an error in the Converter. The error occurs when the #REGION
statement is located in an object's code or in the Cleanup code - but not
in the Setup code. This causes the GENDIRCOUNT variable to be passed to a
method when it was not initialized.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Edit the Converter code to initialize the GENDIRCOUNT variable. The source
code to the Converter application is included with the Professional Edition
of Visual FoxPro. The following step-by-step procedure illustrates the
method to correct the error.
<P>
<P><h3>Step-by-Step Workaround</h3>
 

<OL><P><LI>Open the Convert.pjx project located in the Tools\Convert directory.

<P><LI>Select the Code tab. Drill down to view the Program, and select the
   Convert program. Click the Modify button to edit the file.

<P><LI>On the Edit menu, click Find, and in the Look For area of the dialog
   box, type FUNCTION AddMethods. Click Find. The Addmethods method is the
   one to modify.

<P><LI>The second line of code in the Addmethods method is this LOCAL
   statement:
<P>
<P><PRE>      LOCAL cTmp, savearea, gendir, m.newmethod2
</PRE><P>
   Add the GENDIRCOUNT variable to this statement. It should now read:
<P>
<P><PRE>      LOCAL cTmp, savearea, gendir, m.newmethod2, Gendircount
</PRE>
<P><LI>Close the Program, and save changes. Rebuild the Converter application.

<P><LI>In the Project Manager, click the Build button, and then click Build
   Application. The Save As dialog box is displayed.

<P><LI>In the Save As dialog box, select the main Visual FoxPro directory
   (VFP).

<P><LI>Click Save. The new application is built in your VFP directory.
<P>
</OL>You can verify the value of the _CONVERTER system memory variable to ensure
that it points to the correct location of the application.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0b for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In FoxPro for Windows, version 2.6, issue this command:
<P>
   CREATE SCREEN

<P><LI>In the screen's Cleanup code, place this code:
<P>
   #REGION 1
   Mvar1=2
<P>
   #REGION 2
   Mvar2=3

<P><LI>Save the screen.

<P><LI>In Visual FoxPro, on the File menu, click Open, and try to open the
   screen as a form.

<P><LI>The Converter is invoked. Select Functional Conversion, and Click the
   Continue button. The error is displayed and the screen is not
   converted.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 Fixlist3.00b buglist3.00<BR>
KBCategory: kbinterop kbfixlist kbbuglist<BR>
KBSubcategory: FxinteropPrevfox<BR>
Keywords          : FxinteropPrevfox kbbuglist kbfixlist kbinterop<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
