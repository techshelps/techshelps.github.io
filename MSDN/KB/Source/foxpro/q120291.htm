

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How Position &amp; Size of @...SAY/GET Fields Are Calculated </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120291">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/09/07">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Based on the position and size of GET (input) and SAY (output) objects in the Screen Builder, FoxPro calculates the vertical and horizontal coordinates and the size of the field. Then it writes these coordinates and sizes to the .SCX file. These nu...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QADF,QAY2,QAPN,QACI,QBTL,QABA,QBXS,QAW6,QAKC,QAU4,QAJP,QAXC,QAE5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Position &amp; Size of @...SAY/GET Fields Are Calculated</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120291</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Based on the position and size of GET (input) and SAY (output) objects in
the Screen Builder, FoxPro calculates the vertical and horizontal
coordinates and the size of the field. Then it writes these coordinates and
sizes to the .SCX file. These numbers are then used by GENSCRN.PRG (invoked
by choosing Generate from the Program menu) to create the corresponding
.SPR file. This article describes the algorithm used by FoxPro to calculate
these numbers on simple GET fields, not controls such as popups or push
buttons.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can see the numbers on which FoxPro bases its calculations. While in
the Screen Builder, choose Show Position from the Screen menu. Then choose
Ruler/Grid from the Screen menu, and select the Pixels radio button from
the Ruler group.
<P>
Use the Field tool to draw an input (GET) or output (SAY) field, and note
the pixel values of Top, Left, Height, and Width displayed in the status
bar when the field is selected.
<P>
Assuming a GET field was created, the corresponding .SPR file is generated
with the following command:
<P>
<PRE>   @&lt;vpos&gt;,&lt;hpos&gt; GET &lt;variable&gt; ;
     SIZE fHeight, fWidth ; ...
     FONT &lt;fontname&gt;,&lt;fontsize&gt;

</PRE>The coordinates &lt;vpos&gt; and &lt;hpos&gt; are taken from the VPOS and HPOS fields
from the corresponding record in the underlying .SCX file. The fHeight and
fWidth values are the HEIGHT and WIDTH fields in that file.
<P>
The numbers written to the .SCX and .SPR files are calculated by using the
following formulas:
<P>
<PRE>   VPOS = (&lt;Top&gt; + 1)/FONTMETRIC(1,&lt;WindowFont&gt;,&lt;pointsize&gt;)

   HPOS = (&lt;Left&gt; + 2)/FONTMETRIC(6,&lt;WindowFont&gt;,&lt;pointsize&gt;)

   HEIGHT = (&lt;Height in pixels&gt; - 2)/FONTMETRIC(1,&lt;ObjectFont&gt;,&lt;pointsize&gt;)

   WIDTH = (&lt;Width in pixels&gt; - 5)/FONTMETRIC(6,&lt;ObjectFont&gt;,&lt;pointsize&gt;)

</PRE>&lt;Top&gt;, &lt;Left&gt;, &lt;Height&gt;, and &lt;Width&gt; are the pixel values displayed in the
status bar when the field is selected in the Screen Builder.
<P>
&lt;WindowFont&gt; is the font in which the window was defined. You can see this
either by choosing Layout from the Screen menu and then choosing the Font
push button, or by looking at the DEFINE WINDOW command in the .SPR file.
<P>
&lt;ObjectFont&gt; is the font in which the field was defined. By default, this
is the same font as &lt;WindowFont&gt;. However, you can change it by selecting
the object and choosing Font from the Object menu or by looking at the FONT
clause for that object in the .SPR file.
<P>
NOTE: The above formulas assume you are using a "normal" (or "regular" or
"plain") font style. If this is not the case, you must add a fourth
argument to the FONTMETRIC function to specify the font style.
<P>
<P><h2>REFERENCES</h2>
 
<P>
FoxPro "Developer's Guide," Appendix A
FoxPro "Language Reference," FONTMETRIC function
<P>
For information about converting screen object positions between platforms,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q106161.htm">Q106161</A></B>
   TITLE     : How to Convert Screen Object Positions Between
               Platforms
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxWin 2.50 2.50a 2.50b 2.50c 2.60 2.60a<BR>
foxels<BR>
KBCategory: kbother<BR>
KBSubcategory: FxtoolSbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
