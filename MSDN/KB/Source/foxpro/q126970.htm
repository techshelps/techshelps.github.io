

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Crosstab Query Returns Empty String When STR() Used </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126970">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/03/07">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When creating a crosstab query, if the third field (numeric field) is specified as STR(             ), an empty string is returned when the query is generated.  STATUS ======  Microsoft has confirmed this to be a problem in the Microsoft products l...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAEF,QAR4,QDPA,QAUD,QDIJ,QBWS,QBFY,QBE7,QBE6,QAGB,QACF,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Crosstab Query Returns Empty String When STR() Used</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126970</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.60 | 2.5x 2.60
<PRE>WINDOWS   | MS-DOS
</PRE>kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5x, 2.6
<LI>Microsoft FoxPro for MS-DOS, version 2.5x, 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When creating a crosstab query, if the third field (numeric field) is
specified as STR(&lt;third field&gt;), an empty string is returned when the query
is generated.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
FoxPro version 2.6a for Windows and FoxPro version 2.6a for MS-DOS.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a table with the following structure:
<P>
<PRE>   Field Name  Type       Width
   ----------------------------
   MYROWS      Character     3
   MYCOLS      Character     3
   MYCELL      Numeric       3

</PRE><P><LI>Add the following data to the Table:
<P>
   MYROWS  MYCOLS  MYCELL
   ----------------------
<PRE>     A      A           1
     A      B           2
     A      C           3
     B      A           4
     B      B           5
     B      C           6

</PRE><P><LI>Create a crosstab query by typing "Create Query XTAB" (without the
   quotation marks) in the Command Window. In the resultant RQBE, click
   Fields. Then in the Select Fields dialog, click the Cross Tabulate box.
   Run the query and you will get the correct output.
<P>
<PRE>   MYROWS    A   B    C
   --------------------
     A       1   2    3
     B       4   5    6

</PRE><P><LI>In the Select Fields dialog of the RQBE, remove MYCELL from the field
   list. Type STR(MYCELL) into the function/expression section and move the
   expression into the Selected Output list. Run the query and the
   resulting cursor shows a blank or empty value in MYCELL:
<P>
<PRE>   MYROWS    A   B    C
   --------------------
     A
     B
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos fixlist2.60a buglist2.50<BR>
buglist2.50a buglist2.50b buglist2.50c buglist2.60 2.50 2.50a 2.50b 2.50c<BR>
2.60 genxtab.prg<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxotherGeneral<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
