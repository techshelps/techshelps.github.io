

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use the DECLARE-DLL Command to Call Win32 SDK Functions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136566">
<META NAME="KBModify" CONTENT="1995/09/12">
<META NAME="KBCreate" CONTENT="1995/09/11">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to use the DECLARE-DLL command in Visual FoxPro to call functions that are part of the WIN32 Software Development Kit (SDK). The example code shows you how to use DECLARE-DLL to set up functions that you can use to...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAKR,QAIH,QAGI,QAGQ,QAY5,QAUD,QBV8,QAB9,QAUJ,QADN,QA56,QA55,QA4Q,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use the DECLARE-DLL Command to Call Win32 SDK Functions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136566</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to use the DECLARE-DLL command in Visual
FoxPro to call functions that are part of the WIN32 Software Development
Kit (SDK). The example code shows you how to use DECLARE-DLL to set up
functions that you can use to swap the Foreground window to another
application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<P>
* DECLARE is used to make connections to two SDK functions. It
* uses the keyword WIN32API for the LibraryName to tell Visual FoxPro
* to search for the 32-bit Windows .dll function in Kernel32.dll,
* Gdi32.dll, User32.dll, Mpr.dll, and Advapi32.dll.
*
* FindWindow takes two parameters and returns the HWND of the application
* window if found.
<P>
DECLARE INTEGER FindWindow IN WIN32API AS findw STRING,STRING
<P>
* SetForegroundWindow takes one parameter and returns true(1) or false(0)
* depending upon its ability to switch to the other window.
<P>
DECLARE INTEGER SetForegroundWindow IN WIN32API INTEGER
<P>
* GetFocus takes no parameters and returns the HWND
* of the window that currently has the focus.
<P>
DECLARE INTEGER GetFocus IN WIN32API
<P>
<PRE>mynull = .NULL.       &amp;&amp; You need a NULL when you do not know the
                      &amp;&amp; the class name of the window.

</PRE>winname = "File Manager"  &amp;&amp; This should be the name of another window that
<PRE>                          &amp;&amp; is open on the Windows desktop.

</PRE>* First call FindWindow to get the HWNDs for the application you want
* to switch to. It is important that Visual FoxPro has the focus when this
* is run and that you know the exact name of the window that you want to
* switch to. For more info Please see the Note later in this code.
<P>
foxhand= getfocus()
pmhand = findw(mynull,winname)
<P>
<PRE>IF pmhand&lt;&gt;0   &amp;&amp; If you have an HWND, switch
   WAIT WINDOW "Press Any Key to Switch to another window and then back;
                after a short interval."
   switched = setforegroundwindow(pmhand)
   IF switched = 1  &amp;&amp; If switched, count for a while and switch back
      ii=1
      DO WHILE ii&lt;50000
         ii=ii+1
      ENDDO
      switched = setforegroundwindow(foxhand)
      WAIT WINDOW "I'm back now"
   ELSE
      WAIT WINDOW  "Switch failed"
   ENDIF
</PRE>ELSE
<PRE>   WAIT WINDOW "Cannot find that window"
</PRE>ENDIF
<P>
NOTE: Under Windows NT and Windows 95, if a child window is maximized, its
name is added to the name of the parent window in the Title Bar of the
Parent Window. For example, when you run Microsoft Word it automatically
opens an empty document. If this document (call it Document1), is not
maximized, the title of the main Microsoft Word window is "Microsoft Word."
If Document1 is maximized, the title is "Microsoft Word - Document1." In
the example code, if you want to switch to the Microsoft Word session, set
the winname variable to "Microsoft Word - Document1."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
