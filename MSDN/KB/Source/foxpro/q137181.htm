

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Simulate Date Spinners by Using a Set of Buttons </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137181">
<META NAME="KBModify" CONTENT="1995/09/26">
<META NAME="KBCreate" CONTENT="1995/09/21">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro for Windows includes the data entry object called a Spinner control to help users enter numeric data. This article shows you how to create a simulated Date Spinner control to help users choose a date. The technique involves using a set of bu...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QBXS,QA7O,QANE,QA5D,QAEF,QA7N,QAJD,QDIJ,QAGB,QANS,QACF,QBFY,QAKC,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Simulate Date Spinners by Using a Set of Buttons</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137181</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxPro for Windows includes the data entry object called a Spinner control
to help users enter numeric data. This article shows you how to create a
simulated Date Spinner control to help users choose a date. The technique
involves using a set of buttons with a date field to create the simulated
Date Spinner control. A third button is included to allow the user to clear
the date or set it to the current system date.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The main function of the Date Spinner buttons is to increase or decrease
the value of the date by one or more days. FoxPro supports date arithmetic.
Adding a whole number to a date changes the date to the date that is that
number of days in the future. Subtracting a whole number from a date
changes the date to the date that is that number days in the past.
<P>
The example in this article uses three buttons. The Plus and Minus buttons
add or subtract one from the date field. If the date field is empty, the
buttons set it to the current system date.
<P>
The optional third button has two functions. When the date field has a
value, the third button displays the letter C to indicate that it will
clear the date value. When the date field is empty, the third button
displays the letter T to indicate that it will set the day to today's date.
This is not a feature you would normally find with a Spinner object, but it
can be a handy one for data entry.
<P>
<P><h3>Steps to Create Date Spinners by Using Buttons</h3>
 

<OL><P><LI>Create a screen in FoxPro that contains a date field.

<P><LI>To the right of the date field, place a button set of three buttons, and
   label the buttons +, -, and C. Adjust the size of the button set by
   clicking the lower-right corner of the set and dragging it up and to the
   left until it becomes as small as possible. You may want to choose a
   smaller font size as well. In this example, the name of the date field
   is m.lddate and the name of the button set is m.lnspinner.

<P><LI>Place the following code in the WHEN for the m.lnspinner button set:
<P>
   IF EMPTY(m.lddate)
<P><PRE>      SHOW GET m.lnspinner, 3 PROMPT "T"
</PRE>   ELSE
<P><PRE>      SHOW GET m.lnspinner, 3 PROMPT "C"
</PRE>   ENDIF
<P>
   This adjusts the prompt for the third push button. When the date field
   is empty, the prompt for the third push button will be T, otherwise it
   will remain as C.

<P><LI>Place the following code in the VALID for the m.lnspinner button set :
<P>
   DO CASE
<P><PRE>      CASE m.lnspinner = 1  &amp;&amp; clicked + button
<PRE></PRE>         IF EMPTY(m.lddate)
            m.lddate = DATE()
         ELSE
            m.lddate = m.lddate + 1
         ENDIF
         SHOW GET m.lddate
      CASE m.lnspinner = 2  &amp;&amp; clicked - button
         IF EMPTY(m.lddate)
            m.lddate = DATE()
         ELSE
            m.lddate = m.lddate - 1
         ENDIF
         SHOW GET m.lddate
      CASE m.lnspinner = 3  &amp;&amp; clicked C or T button
         IF EMPTY(m.lddate)
            m.lddate = DATE()
         ELSE
            m.lddate = {}
         ENDIF
         SHOW GET m.lddate
   ENDCASE

   When the first button (+) is clicked, the date is increased by one day.
   When the second button (-) is clicked, the date is decreased by one day.
   In either case, if the date field is empty, it is set to the current
   system date. When the third button (C or T) is clicked, if the date
   field is empty, it is set to the current system date, otherwise it is
   set to an empty date value.

</PRE><P><LI>Save the screen, and generate the screen program. When you run the
   program you will now have buttons that act like a Spinner control for
   your date field.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.50 2.50a 2.50b 2.60 2.60a date spinner FoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 26, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
