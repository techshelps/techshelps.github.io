

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Execution of REPORT FORM Command Sets Focus to Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177260">
<META NAME="KBModify" CONTENT="1997/12/04">
<META NAME="KBCreate" CONTENT="1997/11/24">
<META NAME="Keywords" CONTENT="FxprintGeneral vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Executing a REPORT FORM command while an application is running minimized, sets focus to the application and restores the application's window. After the REPORT FORM command finishes executing, the application loses focus and continues running mini...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QBNK,QADO,QBWS,QAJH,QBV8,QAB9,QBW1,QAO4,QAI2,QBXS,QATK,QAA8,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Execution of REPORT FORM Command Sets Focus to Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177260</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Executing a REPORT FORM command while an application is running minimized,
sets focus to the application and restores the application's window. After
the REPORT FORM command finishes executing, the application loses focus and
continues running minimized.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Setting the visible property of the form to false before the REPORT FORM
command is executed prevents the form from being restored and displayed on
screen.
<P>
The following code snippet illustrates changing the visible property before
and after a REPORT FORM command is encountered. In the example below, this
code would appear in the Timer Event method of the timer object.
<P>
<PRE>   ThisForm.Visible=.F.
   REPORT FORM prtsrv FOR RECNO() &lt; 5 TO PRINT NOCONSOLE NOWAIT
   ThisForm.Visible=.T.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When an application compiled with Visual FoxPro version 5.0 is running as a
minimized background process and a REPORT FORM command is encountered, the
application's window is restored from its minimized state and displayed on
screen. After the REPORT FORM command has finished executing, the
application's window is minimized and the application continues executing
as a background process.
<P>
Applications compiled with Visual FoxPro version 3.0 that are running as a
minimized background process remain minimized when a REPORT FORM command is
encountered.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Using Visual FoxPro version 5.0, create a new project called Prtsrv.

<P><LI>Click Data, Databases and add the Testdata database from the
   VFP\Samples\Data folder.

<P><LI>Click Documents, Reports and create a new quick report using the
   Customer table of the Testdata database. Save the report as Prtsrv.

<P><LI>Click Code, Programs and create a new program file named Prtsrv with the
   following code:
<P>
<P><PRE>      PUBLIC rollcounter
      rollcounter=0
      DO FORM prtsrv
      READ EVENTS
</PRE><P>
<P><PRE>      _SCREEN.WINDOWSTATE=2
      _SCREEN.VISIBLE=.T.
      _SCREEN.SHOW
      ZOOM WINDOW SCREEN MAX
</PRE>
<P><LI>Set Prtsrv.prg as the main program file.

<P><LI>Click Documents, Forms and create a new form called Prtsrv with the
   following properties:
<P>
<P><PRE>      AutoCenter = .T.
<PRE></PRE>      Height     = 130
      ShowWindow = 2
      Width      = 192

</PRE><P><LI>In the form's Activate event, add the following code:
<P>
<P><PRE>      _SCREEN.WINDOWSTATE=1
      _SCREEN.VISIBLE=.f.
      HIDE WINDOW SCREEN
      thiswin=WONTOP()
      ZOOM WINDOW &amp;thiswin MIN
</PRE>
<P><LI>Add a Timer control to the form with the following properties:
<P>
<P><PRE>      Interval=3000
</PRE>
<P><LI>Add the following code to the Timer Event method of the timer object:
<P>
<P><PRE>      rollcounter=rollcounter+1
      REPORT FORM prtsrv FOR RECNO()  &lt; 5 TO PRINT NOCONSOLE NOWAIT
      IF rollcounter=3
      ThisForm.Command1.Click
      ENDIF
</PRE>
<P><LI>Add a command button to the form with the following code in the Click
<P><PRE>    event of the command button:
</PRE><P>
<P><PRE>      RELEASE THISFORM
      CLEAR EVENTS
</PRE>
<P><LI>From the Project Manager, build an executable file. Open Windows
<P><PRE>    Explorer and double-click the executable file. At 30 second
    intervals, the Prtsrv form is restored and visible on screen.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: VFoxWin form print visible timer<BR>
Keywords          : FxprintGeneral vfoxwin<BR>
Version           : WINDOWS:5.0,5.0a<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
