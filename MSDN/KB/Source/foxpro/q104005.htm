

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Coordinate Parent Data Window with Child Browse </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104005">
<META NAME="KBModify" CONTENT="1996/07/09">
<META NAME="KBCreate" CONTENT="1993/09/02">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This procedure below describes how to coordinate a parent data window with a child Browse window using the power tools. The screen and its controls are designed in such a way that as you move through the parent database, the parent's data is update...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QAH4,QBWS,QAG2,QAUR,QA2Q,QAA8,QAY2,QA5V,QAZV,QAGX,QBJZ,QAGQ,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Coordinate Parent Data Window with Child Browse</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This procedure below describes how to coordinate a parent data window with
a child Browse window using the power tools. The screen and its controls
are designed in such a way that as you move through the parent database,
the parent's data is updated and so is the Browse window that displays the
related records in the child database. In this example, the CUSTOMER and
INVOICES databases are used to establish a one-to-many relationship. Both
the CUSTOMER and INVOICES databases are located in the FoxPro TUTORIAL
subdirectory.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Use the View window to set up a one-to-many relationship between the
    CUSTOMER (parent) database and the INVOICES (child) database. Select
    the parent database by clicking it.

<P><LI>Create a quick screen.

<P><LI>Save the environment and add the following code into the following
    code options in the Screen Layout dialog box:
<P>
       Setup Code
       ----------
<P>
       DEFINE WINDOW child FROM 17,1 to 24,70 PANEL;
       FLOAT GROW
       ACTIVATE WINDOW child
       SELECT INVOICES
       BROWSE IN WINDOW child NOWAIT SAVE NOMODIFY LAST
       SELECT CUSTOMER
<P>
       Cleanup Code
       ------------
<P>
       RELEASE WINDOW child
<P>
       Activate Code
       -------------
<P>
       SELECT CUSTOMER

<P><LI>If you are using FoxPro for MS-DOS, choose Layout from the Screen
    menu, then set the screen type to Window. (In FoxPro for Windows, this
    step is unnecessary because the screen is a window by default.)

<P><LI>Resize the window so that it fits around the fields without
    leaving a lot of empty space.

<P><LI>Save the screen as TEST.SCX and then close it.

<P><LI>From the File menu, choose Open, and set the file type to Screen.
<P>
    NOTE: Before proceeding with this next step, make a backup of the
    CONTROL3.SCX and CONTROL3.SCT files (if you are using FoxPro for
    MS-DOS) or the CONTROL1.SCX and CONTROL1.SCT files (if you are
    using FoxPro for Windows).

<P><LI>In FoxPro for MS-DOS, select CONTROL3.SCX (located in your FoxPro
    TUTORIAL subdirectory) and then choose Open. In FoxPro for
    Windows, select CONTROL1.SCX (located in your FoxPro
    SAMPLE\ORGANIZE\SCREENS subdirectory) and then choose Open.

<P><LI>Double-click one of the push buttons on the screen and select the
    Valid code snippet check box.

<P><LI>The Valid code snippet is shown below. Modify the code by adding
    the two designated lines. The code below is from FoxPro for MS-DOS
    and looks slightly different in FoxPro for Windows.
<P>
<PRE>       SET SKIP TO          &amp;&amp; Add this line

       DO CASE
          CASE act2 = 1
             GO TOP
          CASE act2 = 2
             SKIP -1
             IF BOF()
               GO TOP
             ENDIF
          CASE act2 = 3
             SKIP 1
             IF EOF()
               GO BOTTOM
             ENDIF
          CASE act2 = 4
               GO BOTTOM
          CASE act2 = 5
               APPEND BLANK
          CASE act2 = 6
               CLEAR READ
       ENDCASE

       SET SKIP TO invoices     &amp;&amp; This line is optional.

       SHOW GETS
       RETURN 0

</PRE><P><LI>Save the screen as MYCONTRL.SCX.

<P><LI>From the File menu, choose Open, and then set the type to Screen.

<P><LI>Select TEST.SCX and then choose Open.

<P><LI>From the Program menu, choose Generate.

<P><LI>Choose Add.

<P><LI>Select MYCONTRL.SCX and then choose OK.

<P><LI>Choose Arrange and arrange the two screens to be toward the top of
    the window. Try not to overlap the screens.

<P><LI>In FoxPro for MS-DOS, choose Save from the Arrange menu. In FoxPro
    for Windows, choose OK.

<P><LI>Choose Generate.

<P><LI>In the Command window, issue the following command:
<P>
       DO  test.spr
<P>
</OL>Notice the three screens come up. Choosing Next from the control screen
displays the updated parent screen. The related records of the child in the
browse are also updated.
<P>
NOTE: You can also use FOXAPP to relate two tables and accomplish the same
goal.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a foxmac<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgBrowse<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
