

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: After FLUSH, Loss of Power May Still Corrupt Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115290">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/05/23">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Even after the FLUSH command is issued, if the system loses power, a table that has just been written to may become corrupted, causing the following error message to appear:     Memo file is damaged.  When you choose either the Cancel or Repair but...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QDO9,QDI1,QAZZ,QBFD,QAB4,QAR4,QBB2,QAY2,QAH4,QA7T,QAC9,QBXS,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: After FLUSH, Loss of Power May Still Corrupt Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115290</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50b
MACINTOSH
kbprg kbfixlist kbbuglist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Even after the FLUSH command is issued, if the system loses power, a table
that has just been written to may become corrupted, causing the following
error message to appear:
<P>
<PRE>   Memo file is damaged.

</PRE>When you choose either the Cancel or Repair button, the following message
is displayed:
<P>
<PRE>   Not a table/DBF.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro 2.5b for Macintosh.
This problem was corrected in FoxPro 2.5c for Macintosh.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: In FoxPro 2.5c for Macintosh, the FLUSH command makes an additional
system call that writes closed files to the volume (hard disk).
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
CAUTION: TURNING OFF YOUR MACINTOSH IN THE MANNER DESCRIBED BELOW MAY
DAMAGE OR CORRUPT DATA ON YOUR VOLUME (HARD DISK).
<P>
These steps assume the following:

<UL><LI>FoxPro is installed in a folder (directory) named "FoxPro".
<LI>The volume (disk) name is "Macintosh HD".
<LI>A folder named "TEST" exists on the volume.

</UL><OL><P><LI>Create a program containing the following code:
<P>
<P><PRE>      USE "Macintosh HD:\FoxPro\Sample\Laser\DATA\LASER.DBF" NOUPDATE
      COPY TO "Macintosh HD:\TEST\test.dbf"
      SET DEFAULT TO "Macintosh HD:\TEST"
      USE test.dbf
      COPY TO test2.dbf
      APPEND FROM test2.dbf
      APPEND FROM test2.dbf
      APPEND FROM test2.dbf
      APPEND FROM test2.dbf
      APPEND FROM test2.dbf
      FLUSH
      USE
</PRE>
<P><LI>Run the program.

<P><LI>As soon as the program finishes, and the Command window becomes active
   (has the focus) again, turn off the power. If your Macintosh has an Off
   button, press it. Otherwise, disconnect the power cord.

<P><LI>Restart the Macintosh, and then start FoxPro.

<P><LI>Type the following in the Command window:
<P>
<P><PRE>      SET DEFAULT TO "Macintosh HD:\TEST"
      USE test.dbf
</PRE><P>
</OL>You will see the error messages described in the "Symptoms" section above.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac 2.50b buglist2.50b fixlist2.50c errmsg<BR>
err<BR>
msg quit damaged<BR>
KBCategory: kbprg kbfixlist kbbuglist kberrmsg<BR>
KBSubcategory:<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
