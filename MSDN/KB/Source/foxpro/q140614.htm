

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SYS(2004) Returns Incorrect Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140614">
<META NAME="KBModify" CONTENT="1996/01/22">
<META NAME="KBCreate" CONTENT="1995/12/04">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  SYS(2004) returns incorrect information. According to the online Help file, SYS(2004) should return the name of the directory or folder from which Visual FoxPro was started. However, if you are running several instances of Visual FoxPro, the SYS(20...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QBXB,QAFI,QAUD,QAIJ,QBWS,QAY5,QAJQ,QA56,QA55,QADX,QALW,QDIV,QAH4,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SYS(2004) Returns Incorrect Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 22, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140614</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SYS(2004) returns incorrect information. According to the online Help file,
SYS(2004) should return the name of the directory or folder from which
Visual FoxPro was started. However, if you are running several instances of
Visual FoxPro, the SYS(2004) function returns only the directory from which
the first instance was started.
<P>
<P><h2>CAUSE</h2>
 
<P>
Executable files created in Visual FoxPro are not standalone applications.
They rely on the Vfp300.esl as a runtime library. The SYS(2004) function
returns the location of this file during run time. Even if you have
multiple copies of this run-time library, the operating system will not
load several instances into memory; it only opens one copy. That is why the
SYS(2004) function only reports the location of the first one that was
started.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can use one of the following alternate methods to obtain the startup
directory:

<UL><LI>Use the CURDIR() function to retrieve the working directory.

<LI>Store the name of the startup directory in a lookup table.

<LI>Write the location of the directory to an .ini file by using API calls.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P>
For information about an alternative method of obtaining the path to the
installation, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q138937.htm">Q138937</A></B>
   TITLE     : How to Tell Which Directory Holds a Visual FoxPro App's .Exe

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program file that contains the following line repeated twice:
<P>
   WAIT WINDOW SYS(2004)

<P><LI>Add this program to a new project, and build an executable.

<P><LI>Create a second, new project and add the same program to it.
   Create this executable with a different name and save it into
   a different directory.

<P><LI>Copy the Vfp300.esl file into both of the directories, or place the
   Windows\System directory in your PATH statement.

<P><LI>Create icons for each of the executables, and set the working
   directories to the executable's location.

<P><LI>Try running each application separately. The WAIT WINDOW will
   report the correct directory for each program.

<P><LI>Close the executables if they are open.

<P><LI>Start one of the executables. While it is waiting for you to press a
   key, start the other executable. You will now see that the second
   instance reports the same starting directory as the first one.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 22, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
