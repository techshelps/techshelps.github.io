

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: @ ... GET List Box Does Not Redraw Properly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113208">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/03/29">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Under FoxPro for Windows, an @ ... GET List will not refresh properly after another window has been called in front of it.  CAUSE =====  The combination of the following two conditions causes this problem to occur:   - The @ ... GET LIST items are ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACI,QBVR,QAW9,QAUJ,QAO2,QBWS,QA2Q,QAG2,QAH4,QAGB,QAE1,QABA,QBLX,QAY4,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: @ ... GET List Box Does Not Redraw Properly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113208</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Under FoxPro for Windows, an @ ... GET List will not refresh properly after
another window has been called in front of it.
<P>
<P><h2>CAUSE</h2>
 
<P>
The combination of the following two conditions causes this problem to
occur:

<UL><LI>The @ ... GET LIST items are from table or cursor fields.

<LI>The table or cursor that provides the fields for the @ ... GET LIST
   items is inadvertently closed.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following cases will inadvertently close the original table or cursor:

<UL><LI>The environment of the second screen is saved and is different than the
   current environment.
<P>
   -or-

<LI>When the second window was generated, the Open Files and Close Files
   check boxes in the Generate Screen dialog box were selected.
<P>
   NOTE: You must choose the More button to see these check boxes.
<P>
   -or-

<LI>The second window reissues the SELECT statement, thereby overwriting the
   original cursor.
<P>
</UL><h3>Steps to Reproduce Problem</h3>
 
<P>
This is an example of reissuing the SELECT statement in the second window,
thereby overwriting the original cursor.

<OL><P><LI>Create a new screen.

<P><LI>Place the following code in the Setup Code for the screen:
<P>
<P><PRE>      CLOSE ALL
</PRE><P>
<P><PRE>      CREATE TABLE places (name C(15))
      INSERT INTO places (name) VALUE ("Reading")
      INSERT INTO places (name) VALUE ("London")
      INSERT INTO places (name) VALUE ("Oxford")
      SELECT * FROM places ORDER BY name INTO CURSOR QUERY
</PRE>
<P><LI>Using the List tool, add a list box to the screen, making it at least
   six rows in height.

<P><LI>For List Items, choose From Field and for the field name, type
   "Query.name" (without the quotation marks).

<P><LI>For the variable, type "m.choice" (without the quotation marks).

<P><LI>In the VALID clause, place the following code:
<P>
<P><PRE>      DEFINE WINDOW cover FROM 10,10 TO 20,30 SYSTEM FLOAT
      ACTIVATE WINDOW cover
      @ 3,5 GET m.choice ;
<PRE></PRE>        PICTURE "@*HT Clear" ;
        DEFAULT 1
      READ CYCLE
      RELEASE WINDOW cover
      * (The following SELECT statement closes the original cursor.)
      SELECT * FROM places ORDER BY name INTO CURSOR QUERY
      SHOW GETS

</PRE><P><LI>Generate and run the screen.

<P><LI>Double-click one of the names to activate the window "cover." After
   placing the window over some portion of the list box that is empty,
   choose the Clear push button.

<P><LI>Repeat this step until the problem appears. It may be more likely to
   appear if you select the second or third items in the list box.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin buglist2.50 buglist2.50a buglist2.50b<BR>
buglist2.60 2.50 2.50a 2.50b 2.60 database<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
