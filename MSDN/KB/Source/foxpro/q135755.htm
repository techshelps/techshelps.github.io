

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Use the OLE MAPI Control to Send Mail Messages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135755">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1995/08/27">
<META NAME="Keywords" CONTENT="kbole kbinterop kbwebcontent">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Professional Edition of Microsoft Visual FoxPro for Windows includes a MAPI OLE container control, so the developer can incorporate mail messaging capabilities into a Visual FoxPro application. This article gives the steps necessary to create a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QA7O,QAB5,QAOE,QAMN,QAL7,QA9Q,QAH6,QBWO,QBV4,QA4S,QA4R,QAPN,QAH4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Use the OLE MAPI Control to Send Mail Messages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135755</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Professional Edition of Microsoft Visual FoxPro for Windows includes a
MAPI OLE container control, so the developer can incorporate mail messaging
capabilities into a Visual FoxPro application. This article gives the steps
necessary to create a Visual FoxPro form that starts a MAPI session and
allows a user to send a mail message to a specified e-mail address.
<P>
NOTE: The MAPI OLE container controls are not installed on operating
systems that use the Win32s subsystem (Windows 3.x and Windows for
Workgroups 3.x).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Proceure</h3>
 
<P>
Follow these steps to create a form to send mail messages using the OLE
MAPI control.

<OL><P><LI>Create a new form.

<P><LI>Add the OLE MAPI Session control to the form. Select the OLE Container
   control from the Form Controls toolbar, and then click the form. Select
   the Insert Control option, and select the MAPI Session control. Change
   the Name property of the control to OLEMAPISession.

<P><LI>Repeat step two, this time adding the OLE MAPI Message control to the
   form and changing the Name property to OLEMAPIMsg.
<P>
   NOTE: The location of these controls is not important, as they will not
   appear at runtime.

<P><LI>In the form's Init event procedure, add this code:
<P>
   This.OLEMAPISession.SignOn

<P><LI>Add two text boxes to the form. Name the first one SendTo, and the
   second Subject.

<P><LI>Add an edit box to the form and name it MsgTxt.

<P><LI>Add a command button to the form. Set its Caption property to Send, and
   then add the following code to its Click event procedure:
<P>
   With This.Parent.OLEMAPIMsg
<P><PRE>      .MsgIndex=-1
      .RecipDisplayName=ALLTRIM(This.Parent.SendTo.Value)
      .MsgSubject=This.Parent.Subject.Value
      .MsgNoteText=This.Parent.MsgTxt.Value
      .SessionID=This.parent.olemapisession.sessionid
      .Send
</PRE>   Endwith

<P><LI>In the form's Destroy event procedure, add this code:
<P>
   Thisform.OLEMAPISession.SignOff

<P><LI>Save and run the form. If the mail application is not already running,
   the sign-on dialog box will appear and prompt for a password.

<P><LI>Enter a valid e-mail address in the SendTo box. Enter text for the
<P><PRE>    subject in the Subject box. Enter the actual message text in the MsgTxt
    box.
</PRE>
<P><LI>Click the Send button. The mail message will be delivered to the
<P><PRE>    specified e-mail address.
</PRE>
<P><LI>Close the form.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 3.00 VFoxWin OCX<BR>
KBCategory: kbole kbinterop kbwebcontent<BR>
KBSubcategory: FxinteropOcx<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
