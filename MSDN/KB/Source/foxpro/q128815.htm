

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error Message: "No bars have been defined for this popup" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128815">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/04/11">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If the PROMPT FIELD clause of a DEFINE POPUP command contains empty records, the following error message occurs:     No bars have been defined for this popup  CAUSE =====  This error can be caused by any one of the following:   - The field used in ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QANE,QAB4,QAH4,QAGB,QAEF,QAB9,QAAF,QBV8,QBXS,QA7O,QA7N,QACF,QDIJ,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Message: "No bars have been defined for this popup"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128815</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the PROMPT FIELD clause of a DEFINE POPUP command contains empty
records, the following error message occurs:
<P>
<PRE>   No bars have been defined for this popup

</PRE><h2>CAUSE</h2>
 
<P>
This error can be caused by any one of the following:

<UL><LI>The field used in the PROMPT FIELD expression is from an empty permanent
   or temporary table.
<P>
   -or-

<LI>A SET FILTER command was issued, and no records satisfied the filter
   condition.
<P>
   -or-

<LI>An SQL SELECT command resulted in an empty cursor or table.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Check for the following:

<OL><P><LI>Existing records in permanent or temporary tables.

<P><LI>Misspellings in the filtering or query command lines.

<P><LI>Field values containing upper- or lower-case characters.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In some cases it may be necessary to check for empty records before
defining and activating the popup. The code provided below uses the _TALLY
system memory variable to determine if the result of an SQL SELECT command
is greater than one before it populates the popup. Add the following code
after the SQL SELECT command:
<P>
<PRE>   IF _TALLY &lt; 1
      WAIT WINDOW "No Records Available"
   ELSE
      *(insert DEFINE POPUP command line)
      *(insert ACTIVATE POPUP command line)
   ENDIF

</PRE></OL><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create and run the following program:
<P>
<PRE>   *** Begin Program ***

   CLOSE DATABASES
   USE C:\FPW26\TUTORIAL\CUSTOMER
   SET FILTER TO state = "nc"    &amp;&amp; 'nc' must be in lowercase

   DEFINE POPUP cities FROM 5,5 TO 15,25 PROMPT FIELD city SCROLL
   ACTIVATE POPUP cities

   DEACTIVATE POPUP cities
   SET FILTER TO
   CLOSE DATABASES

   *** End Program ***

</PRE>In this program, the State field in the Customer table contains all
uppercase characters, so no records match the filter condition. This
results in an empty work area. There are no values to populate the popup,
so the error message ("No bars have been defined for this popup") occurs
when the popup is defined and activated.
<P>
You can modify the program to produce the same error using the SQL SELECT
statement. For example, change the SET FILTER TO command line into a
comment. Then below that command line, add this code:
<P>
<PRE>      SELECT * FROM customer WHERE state = "nc" INTO CURSOR temp

</PRE>NOTE: When the current work area points to the temporary table (Temp)
rather than the permanent table (Customer), the PROMPT FIELD clause will
read the values of temp.city to populate the popup. This behavior is
different from the SET FILTER command, which reads its values from
customer.city.
<P>
The error also occurs if no records have been added to the permanent table
or if the records in the permanent table have been removed using the ZAP,
PACK, or DELETE (if SET DELETED is ON) commands.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgSet<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
