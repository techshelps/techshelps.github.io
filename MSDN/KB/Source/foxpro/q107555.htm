

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Report Variables Return Incorrect Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107555">
<META NAME="KBModify" CONTENT="1997/10/14">
<META NAME="KBCreate" CONTENT="1993/11/23">
<META NAME="Keywords" CONTENT="FxprgGeneral kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Report variables initialized through a user-defined function (UDF) in a self-referential fashion (for example, memvar = memvar + 1) return improper values.  STATUS ======  Microsoft has confirmed this to be a problem in the Microsoft products liste...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QBXS,QAUD,QAYL,QAR4,QAH4,QAWH,QDMW,QA28,QATJ,QACI,QAA1,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Report Variables Return Incorrect Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107555</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50 2.50a
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Report variables initialized through a user-defined function (UDF) in a
self-referential fashion (for example, memvar = memvar + 1) return improper
values.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
FoxPro 2.5b for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>From the Command window or a program, execute the following code. It
   will create two sample tables and indexes, populate them with data, and
   set up a one-to-many relationship.
<P>
<P><PRE>      ***Start sample code***
      CLOSE DATABASES
      SET SAFETY OFF
      CREATE TABLE parent (id_num C(3))
      INSERT INTO parent (id_num) VALUES ('001')
</PRE><P>
<P><PRE>      SELECT 0
      CREATE TABLE child (id_num C(3) ,chld_total N(4,2))
      INDEX ON id_num TAG id_num
      FOR i=1 TO 5
<PRE></PRE>         INSERT INTO child (id_num, chld_total) VALUES ('001',i)
      NEXT

      SELECT parent
      SET ORDER TO TAG id_num OF child.cdx IN child
      SET RELATION TO id_num INTO child ADDITIVE
      SET SKIP TO child
      SET SAFETY ON
      ***End sample code***

</PRE><P><LI>Create a report with the parent.id_num and child.chld_total fields in
   the Detail band.

<P><LI>Create a data grouping based on parent.id_num.

<P><LI>Create a report variable with these properties:
<P>
<P><PRE>      Name: memvar
      Value to store: memvar
      Initial value: memvar + child.chld_total
      Release after report: Checked
      Reset: parent.id_num
      Calculate: Nothing
</PRE>
<P><LI>Create a Summary band and place a field in it based on memvar.

<P><LI>Save the report and the environment and name the report SELF_REF.FRX.
<P>
   NOTE: Saving the environment doesn't affect the behavior of the report.

<P><LI>Issue the following commands in the Command window:
<P>
<P><PRE>     GO TOP
     REPORT FORM self_ref.frx PREVIEW ENVIRONMENT
</PRE><P>
</OL>Note the value in the Summary band--it is 3 when it should be 1.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a buglist2.50a<BR>
fixlist2.50b<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kbbuglist kbfixlist kbprg<BR>
Version           : 2.50 2.50a<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
