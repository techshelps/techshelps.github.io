

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Last Page in Report with New Page Option Says "Page 1" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100551">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In the Report Writer, the  New Page (Page No. = 1)  option does not function correctly. When you select the  New Page (Page No. = 1)  option in the Group Info dialog box (to open the dialog box, choose Data Groupings from the Report menu, then choo...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTP,QBXV,QBWA,QABO,QAGI,QA50,QAR4,QBXS,QA7O,QA7N,QBV8,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Last Page in Report with New Page Option Says "Page 1"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100551</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the Report Writer, the "New Page (Page No. = 1)" option does not
function correctly. When you select the "New Page (Page No. = 1)"
option in the Group Info dialog box (to open the dialog box, choose
Data Groupings from the Report menu, then choose the Add button), the
page number is set back to 1 on the last page of a group that spans
more than one page.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, do the following:

<OL><P><LI>Create the following user-defined functions (UDFs):
<P>
   a. Type the following in a file called SMYPAGE.PRG:
<P>
<PRE>         mypage = 1
         RETURN " "

   b. Type the following in a file called IMYPAGE.PRG:

         mypage = mypage + 1
         RETURN " "

</PRE><P><LI>Create a memory variable called "mypage" (without the quotation marks).
   You can do this by executing the following command
<P>
<P><PRE>      mypage = 0
</PRE><P>
   either in the Command window or in the program that calls the report.

<P><LI>In the Group Header band, create a field called "smypage()"
   (without the quotation marks).

<P><LI>In the Page Footer band, create a field called "mypage" (without
   the quotation marks).

<P><LI>To the right of the mypage field, create another field called
   "imypage()" (without the quotation marks).
<P>
</OL>The mypage field will display the correct page number. It is important
to follow these steps in order because the fields will be called in
the order they are created. Otherwise, mypage could be incremented
prior to displaying the page number.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro 2.5 for
Windows. This problem was corrected in FoxPro 2.5a for Windows.
<P>
This problem does not occur in FoxPro 2.5 for MS-DOS.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Use the CUSTOMER.DBF file and set the order to STATE.

<P><LI>Create a quick report in FoxPro for Windows using CUSTOMER.DBF.

<P><LI>Set up a data grouping on STATE.

<P><LI>In the Group Info dialog box, under "When Group Changes, Begin",
   select the "New Page (Page No. = 1)" option.

<P><LI>From the Report menu, choose Page Preview.

<P><LI>Zoom in on the page number. On groups that span more than one page,
   the page number on the last page of the group is set to 1 instead
   of incrementing again.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 buglist2.50 fixlist2.50a RWriter<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxtoolRwriter<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
