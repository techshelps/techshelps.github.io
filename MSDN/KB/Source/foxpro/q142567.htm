

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Filter a Child Grid Using a Parent Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142567">
<META NAME="KBModify" CONTENT="1997/11/12">
<META NAME="KBCreate" CONTENT="1996/01/16">
<META NAME="Keywords" CONTENT="FxprgGrid kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a one-to-many relationship, you can filter child records displayed in a Grid by using the Value property of a combo box. One method is to use the RelationalExpr and LinkMaster properties of a grid. This article gives you another method, which us...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAY2,QBXS,QA5V,QARR,QBWS,QAB9,QA2Q,QAH4,QBV3,QAG2,QA7O,QBV8,QAI2,QAHP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Filter a Child Grid Using a Parent Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142567</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbprg kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In a one-to-many relationship, you can filter child records displayed in a
Grid by using the Value property of a combo box. One method is to use the
RelationalExpr and LinkMaster properties of a grid. This article gives you
another method, which uses a SET FILTER command along with a SELECT-SQL
statement as the row source of a combo box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To filter the records from the child grid, use the related field from the
parent table as the RowSource of a combo box, and use the SET FILTER
command.
<P>
<P><h3>Step-by-step Example</h3>
 

<OL><P><LI>Create a new form by typing the following command in the Command window:
<P>
   CREATE FORM &lt;form name&gt;.

<P><LI>Open the Data Environment, and add the Customer and Orders tables from
   the Testdata.dbc database located in the Vfp\Samples\Data subdirectory.

<P><LI>From the Form menu, choose New Property, and in the Name box, type MVAR.
   Then click OK.

<P><LI>Set the Properties window to the Form1 object. The MVAR property will
   be located at the bottom of the list on the All tab. Set the value of
   MVAR to "". This will initalize MVAR to a Character Data Type.

<P><LI>Drag the Orders table to the form to create a grid.

<P><LI>Place a combo box on the form after selecting it from the Form Controls
   toolbar. Type the following statement in the RowSource property for the
   combo box:
<P>
   SELECT CUST_ID FROM CUSTOMER INTO CURSOR TEMP

<P><LI>Choose 3-SQL Statement in the RowSourceType property.

<P><LI>Open the Code window for the combo box, and add the following code its
   InteractiveChange event:
<P>
   SELECT ORDERS
   THISFORM.MVAR=THIS.VALUE
   SET FILTER TO CUST_ID = THISFORM.MVAR
   GO TOP
   THISFORM.Grid1.RecordSource=THISFORM.Grid1.RecordSource

<P><LI>Save and run the form. When you select an item from the combo box, the
   grid should refresh and display the related child records.
<P>
</OL>NOTE: An index must exist on the filtered field from the child table to
take advantage of the Rushmore technology.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgGrid<BR>
Keywords          : FxprgGrid kbhowto kbprg<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
