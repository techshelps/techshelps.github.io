

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Prevent "Too Many READs in Effect" Error Message </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106697">
<META NAME="KBModify" CONTENT="1996/09/06">
<META NAME="KBCreate" CONTENT="1993/11/14">
<META NAME="Keywords" CONTENT="kbenv kbprg kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If a screen runs another screen, the current number of READs in effect is increased by one. One way to avoid nesting is to have a main program run the next screen. The EX1 application in the GOODIES\FNDATION subdirectory illustrates this idea.  MOR...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA8,QAH4,QBE7,QBE6,QAUR,QBWS,QAFR,QBXS,QANE,QAGX,QADX,QAB4,QA0J,QAG2,QBFN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Prevent "Too Many READs in Effect" Error Message</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 6, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106697</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If a screen runs another screen, the current number of READs in effect is
increased by one. One way to avoid nesting is to have a main program run
the next screen. The EX1 application in the GOODIES\FNDATION subdirectory
illustrates this idea.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps create a group of screens that can run one another
without increasing READ levels. This example is a simplified version of the
EX1 application.

<OL><P><LI>Create a new project and name it HANDLER.

<P><LI>Create a program called Handler.prg containing the following lines of
    code:
<P>
       * This is the main handler program that keeps from building
       * READ levels.
<P>
       * The following variable controls which screen is called, and
       * it is changed globally by each screen.
<P>
       screen_to_call="one.spr"
<P>
       * The following loop calls the screens.
<P>
       DO WHILE screen_to_call &lt;&gt; "Quit"
<PRE>          DO (screen_to_call)
       ENDDO

</PRE><P><LI>Add Handler.prg to the project.

<P><LI>Save the program.

<P><LI>Add a new screen to the project and name it ONE.

<P><LI>Change the screen type to a window.
<P>
    NOTE: In FoxPro for MS-DOS, when you choose Screen Layout from the
    Screen menu, you are presented with a choice of Desktop or Window.
    Select Window. In FoxPro for Windows, choose Layout from the Screen
    menu, choose the Window Style button in the Screen Layout dialog box,
    and select User from the Type list box.

<P><LI>Title the window Screen 1.

<P><LI>Create a SAY object with "RDLEVEL()" as the expression.

<P><LI>Select Refresh Output Field in FoxPro for Windows or Refresh in
    FoxPro for MS-DOS.

<P><LI>Create a two-button push button set. Type "Screen 2" and "Quit" for the
    push button prompts, enter "X" in Variable text box, and select the
    Terminate READ On Selection check box.

<P><LI>Enter the following code in the Valid Code Snippet window:
<P>
       DO CASE
<PRE>          CASE x = 1
             screen_to_call="two.spr"
          CASE x = 2
             screen_to_call="Quit"
       ENDCASE
       CLEAR READ

</PRE><P><LI>Save the screen without saving the environment.

<P><LI>Save the screen again as TWO.

<P><LI>Change the window title to Screen 2.

<P><LI>Select the push buttons created in step 10 above.

<P><LI>Change the first push button prompt to Screen 1.

<P><LI>Change the code in the Valid Code Snippet as follows:
<P>
       DO CASE
<PRE>          CASE x = 1
             screen_to_call="one.spr"
          CASE x = 2
            screen_to_call="Quit"
       ENDCASE
       CLEAR READ

</PRE><P><LI>Save the screen.

<P><LI>Add the screen TWO.SCX to the project.

<P><LI>Build the project by choosing the Rebuild Project option.

<P><LI>Run the HANDLER.PRG program.
<P>
</OL>Note that the RDLEVEL() command never returns a value greater than 1,
even when you are switching between screens 1 and 2.
<P>
For additional information about this topic, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q106696.htm">Q106696</A></B>
   TITLE     : Single Screen Set to Prevent "Too Many READs in Effect"

</PRE></OL>The method described in <B><A HREF="../FOXPRO/Q106696.htm">Q106696</A></B> is slower, but requires less memory and
fewer resources.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin FoxMac 2.00 2.50 2.50a<BR>
2.50b 2.50c 2.60 2.60a errmsg err msg<BR>
KBCategory: kbenv kbprg kberrmsg<BR>
KBSubcategory: FxenvMemory<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 6, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
