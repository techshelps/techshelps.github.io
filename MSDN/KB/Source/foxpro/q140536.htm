

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "TDS buffer length too large" Error with SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140536">
<META NAME="KBModify" CONTENT="1997/10/21">
<META NAME="KBCreate" CONTENT="1995/12/03">
<META NAME="Keywords" CONTENT="FxnetworkNetware kbnetwork kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you try to connect to a data source on a SQL Server, you may receive an error, which may be intermittent, that is similar to this:     [Microsoft][ODBC SQL Server Driver]TDS buffer length too large(#0)  CAUSE =====  This often shows up on work...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QDL9,QBWQ,QBWN,QAM5,QAXB,QAVZ,QATR,QABM,QAC1,QBD2,QALZ,QAB4,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "TDS buffer length too large" Error with SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140536</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbnetwork kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to connect to a data source on a SQL Server, you may receive
an error, which may be intermittent, that is similar to this:
<P>
<PRE>   [Microsoft][ODBC SQL Server Driver]TDS buffer length too large(#0)

</PRE><h2>CAUSE</h2>
 
<P>
This often shows up on workstations running Windows for Workgroups 3.11,
servers that were originally running Windows NT 3.1 but have been upgraded
to Windows NT 3.5 or 3.51, and on systems using named pipes over
Microsoft's NWLINK network redirector.
<P>
NWLINK is Microsoft's IPX/SPX compatible network redirector. Windows NT 3.5
introduced a new feature called Direct Hosting, where the workstation and
server bypass the NETBIOS layer of the protocol. This allows the two to
talk more directly, eliminates a layer of overhead, and generally speeds
workstation/server interactions. However, when direct hosting is used with
older versions of the redirector, communications become unreliable.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are basically two resolutions, either replace the redirector or turn
off direct hosting. It is best to update the redirector to retain the speed
of direct hosting and to use the most recent versions of the drivers.
<P>
To replace the redirector, you need to find the files that comprise it and
copy them to the Windows\System subdirectory. The updated files are:
<P>
<PRE>   NDIS.386
   NET.EXE
   NETAPI.DLL
   NWNBLINK.386
   VNETSUP.386
   VREDIR.386

</PRE>They can be found on the Windows NT compact disc. For Windows NT 3.5, they
are located in \Clients\Wfw\Update. Note that these files are only for
Windows for Workgroups 3.11.
<P>
To turn off direct hosting, open the System.ini file on the Windows for
Workgroups client, find the [network] section, and add this line:
<P>
<PRE>   DirectHost=off

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 connection VFoxWin<BR>
KBCategory: kbnetwork kbprb<BR>
KBSubcategory: FxnetworkNetware<BR>
Keywords          : FxnetworkNetware kbnetwork kbprb<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
