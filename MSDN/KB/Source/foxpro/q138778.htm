

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Numeric Value Not Written to Table from Text Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138778">
<META NAME="KBModify" CONTENT="1995/10/29">
<META NAME="KBCreate" CONTENT="1995/10/26">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you place the insertion point in the middle of numerical field on a form and press ENTER, the displayed value becomes the integer value of the digits to the left of the insertion point. For example, if the displayed field value is 12345.678, a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QAKD,QACI,QA7O,QA7N,QAYV,QBC9,QBC8,QANO,QAY2,QAPN,QAUD,QDO0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Numeric Value Not Written to Table from Text Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138778</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you place the insertion point in the middle of numerical field on a
form and press ENTER, the displayed value becomes the integer value of the
digits to the left of the insertion point. For example, if the displayed
field value is 12345.678, and you place the insertion point between the 2
and the 3 and press ENTER, the new displayed value becomes 12.000. However,
unlike the behavior when directly editing a table in FoxPro 2.6, the value
is not written to the table after you press the ENTER key.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
A numerical field from a table added to a FoxPro for Windows, version 2.6
screen displays the truncated results and writes the changes to the table
as soon as you move off of the field. In Visual FoxPro, if you manually
change the field, the ControlSource updates and changes are written to the
table. To force Visual FoxPro to behave as FoxPro 2.6 does, you must either
use the REPLACE command or enable data buffering. Both methods are
discussed below.
<P>
<P><h3>Using the REPLACE Command to Edit the Table Directly</h3>
 

<OL><P><LI>Add a text box to a form, and set its ControlSource property to a
   numerical field from a table.

<P><LI>In the LostFocus event of the text box, add these commands:
<P>
   REPLACE &lt;fieldname&gt; WITH This.Value
   This.Refresh
<P>
</OL><h3>Data buffering</h3>
 

<OL><P><LI>Set the BufferMode property of the form to either Optimistic or
   Pessimistic buffering.

<P><LI>Add a text box to a form, and set its ControlSource property to a
   numerical field from a table.

<P><LI>In the LostFocus event of the text box, add these commands:
<P>
   REPLACE &lt;fieldname&gt; WITH This.Value
   =TABLEUPDATE(.T.)
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you don't want to have Visual FoxPro write the changes to the table or
display the changed value, place the following code in the LostFocus event
of the textbox:
<P>
<PRE>   This.Refresh

</PRE></OL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Add a numeric field from a table to a form.

<P><LI>Set the ControlSource of the text box to a numeric field from a table.

<P><LI>Add a two command buttons, one for Skip and one for Prior. For an
   example showing how to add navigation buttons or a toolbar to a form,
   please see the following article in the Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../FOXPRO/Q130683.htm">Q130683</A></B>
<PRE>   TITLE     : How to Create a General Purpose Reusable Navigation Toolbar

</PRE><P><LI>Run the form.

<P><LI>Place the insertion point between two numbers in the field, and press
   ENTER.

<P><LI>The value displayed in the field will truncate to the integer value that
   lies to the left of the insertion point.

<P><LI>To see the display value revert to previous value, move back onto the
   field.

<P><LI>To see that the new value was not written to table, move the record
   pointer by clicking Skip and then clicking Prior.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
