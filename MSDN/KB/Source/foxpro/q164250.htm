

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: FoxPro and Mac Lock with ODBC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164250">
<META NAME="KBModify" CONTENT="1997/02/26">
<META NAME="KBCreate" CONTENT="1997/02/26">
<META NAME="Keywords" CONTENT="foxmac FxinteropOdbc FxprgClientsvr vfoxmac kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When returning a result set of more than four records from SQL Server running on Windows NT 4.0 with an ODBC data source using the AppleTalk protocol, FoxPro for the Macintosh locks up.  RESOLUTION  Use the TCP/IP protocol for the data source if po...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDO9,QDI2,QABM,QA9E,QAK6,QBXS,QAJ6,QAYY,QA5V,QASR,QAN0,QAVZ,QBTX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: FoxPro and Mac Lock with ODBC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164250</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.60a 3.00b
MACINTOSH
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft FoxPro for Macintosh, version 2.6a
   on the following platforms: Macintosh, Power PC
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When returning a result set of more than four records from SQL Server
running on Windows NT 4.0 with an ODBC data source using the AppleTalk
protocol, FoxPro for the Macintosh locks up.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the TCP/IP protocol for the data source if possible. It should be
faster also.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The same code that locks up FoxPro when querying SQL Server when SQL Server
is on a Windows NT 4.0 Server runs fine against SQL Server on a Windows NT
3.51 Server.
<P>
The following steps to reproduce the problem assume working knowledge of
Visual FoxPro for Macintosh, setting up ODBC data sources on the Macintosh,
and SQL Server running on Windows NT. Security considerations are ignored.
See the administrator of the Windows NT computer for security information.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Set up an ODBC data source on the Macintosh using the ODBC Setup PPC
   control panel. Make sure the Network Library is set to AppleTalk and
   the default Database Name is pubs(in the Options button).

<P><LI>SQL Server should be set up on a Windows NT 4.0 Server. It should have
   the Apple Talk ADSP network protocol installed. The SQL Server's setup
   will also likely have the Named Pipes and TCP/IP Sockets network
   protocols installed also.

<P><LI>In the Visual FoxPro Command window, issue the following commands:
<P>
<PRE>      ? SQLCONNECT()    &amp;&amp; choose the ODBC data source from step #1
      *           the number 1 should appear on the FoxPro desktop
      ? SQLEXEC(1,"SELECT * FROM Authors")  &amp;&amp; this should lockup the Mac

</PRE><P><LI>Try the above using an ODBC data source set to use the TCP/IP Network
   Library (if your network supports this protocol). If SQL Server is
   available on a Windows NT 3.51 Server, try the above steps with that. In
   both cases, 23 records should be returned assuming the sample
   Pubs!Authors table in SQL Server has not been modified.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgClientsvr FxinteropOdbc vfoxmac foxmac<BR>
Additional reference words: 2.60a 3.00b<BR>
Keywords            : foxmac FxinteropOdbc FxprgClientsvr vfoxmac kbprb kbprg<BR>
Version             : 2.60a 3.00b<BR>
Platform            : MACINTOSH<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
