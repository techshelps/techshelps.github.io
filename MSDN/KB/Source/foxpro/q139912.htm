

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Saving Programmatically-Created Form &amp; Data Environment to SCX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139912">
<META NAME="KBModify" CONTENT="1996/01/09">
<META NAME="KBCreate" CONTENT="1995/11/19">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When creating a form programmatically, you may want to add a data environment to the form. This article illustrates one method you can use to create a form and add a data environment to that form programmatically.  MORE INFORMATION  When you create...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAX1,QAPN,QAUR,QAI2,QAYY,QAU7,QAH7,QAH6,QAD7,QDMW,QAW6,QAPF,QAH8,QBXR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Saving Programmatically-Created Form &amp; Data Environment to SCX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139912</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When creating a form programmatically, you may want to add a data
environment to the form. This article illustrates one method you can use to
create a form and add a data environment to that form programmatically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you create a form programmatically, the DataEnvironment property
cannot be used to pass a table to the form because it is a read-only
property. Therefore, to add a data environment to a form programmatically,
you must create the data environment object separately during the creation
of the form. Then, you must use the SaveAs method to save both the form and
the data environment in the new form (.scx) file. The following code
illustrates this technique.
<P>
<P><h3>Code Sample</h3>
 
<P>
*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
<PRE>     BEGIN CODE SEGMENT
</PRE>*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
<P>
SET DEFAULT TO C:\VFP\SAMPLES\DATA
<P>
oMyForm1=CREATEOBJECT('Form')
oMyDE1  =CREATEOBJECT('DataEnvironment')
<P>
oMyDE1.ADDOBJECT('Curs1', 'Cursor')
oMyDE1.Curs1.DataBase='TESTDATA.DBC'
oMyDE1.Curs1.CursorSource='Customer'
<P>
oMyForm1.ADDOBJECT('Txt1', 'TextBox')
oMyForm1.Txt1.ControlSource='Customer_ID'
oMyForm1.Txt1.Visible=.T.
<P>
*-- You can add as many objects as you want.
*-- Use the form's SaveAs method to save everything
*-- to an .scx File. This is actually how the DE
*-- is associated to the form.
<P>
oMyForm1.SaveAs('MyForm2', oMyDE1)
<P>
*-- Note that the second parameter specifies the
*-- associated Data Environment
<P>
RELEASE oMyForm1
<P>
DO FORM MyForm2
<P>
*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
<PRE>     END CODE SEGMENT
</PRE>*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
<P>
You can also use the following command to open the form in design mode:
<P>
<PRE>   MODIFY FORM MyForm2
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
