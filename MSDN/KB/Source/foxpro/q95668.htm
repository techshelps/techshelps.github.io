

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Trim Format on GET Field Causes Nonterminating Loop </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95668 ">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1993/02/21">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are attempting to append a record to a database, a trim format applied to a GET field in a screen will cause nonterminating looping to occur, when the trim format is used in conjunction with a VALID clause that returns false when the field...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAZQ,QABI,QAUD,QAR4,QAPN,QDNG,QAXC,QBVV,QBFM,QA5V,QABH,QAA8,QAZV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Trim Format on GET Field Causes Nonterminating Loop</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95668 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
MS-DOS
kbprg kbfixlist kbbuglist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are attempting to append a record to a database, a trim format
applied to a GET field in a screen will cause nonterminating looping to
occur, when the trim format is used in conjunction with a VALID clause that
returns false when the field is empty. This behavior occurs both when the
GETs are memory variables as well as database fields.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This looping will not occur if the Trim picture clause is not used or if
the VALID clause is not used.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro 2.0 for MS-DOS. This
problem was corrected in FoxPro 2.5 for MS-DOS.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a database with one field.

<P><LI>Create a quick screen using the Screen Builder.

<P><LI>Double-click the GET field. Choose the Format button.

<P><LI>Select the Trim check box. Choose OK.
<P>
   The format will now contain @T.

<P><LI>Select the VALID clause check box for the GET field. Place the following
   code in the VALID clause.
<P>
<P><PRE>      IF EMPTY(fieldname)
<PRE></PRE>        RETURN .F.
      ENDIF

</PRE><P><LI>On the screen, place a push button that appends a record.

<P><LI>Save and generate the screen program (.SPR).

<P><LI>In the Command window, type:
<P>
<P><PRE>      DO &lt;screen name&gt;.spr
</PRE><P>
</OL>If the Append push button is chosen, the error message "Invalid Input Press
Space" will appear at the bottom of the screen once the other GET field has
been entered and exited. Pressing the SPACEBAR will not allow the GET field
to be edited. The .SPR file will continue to loop until you press the ESC
key or reboot your machine.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 buglist2.00 fixlist2.50 hang errmsg<BR>
err<BR>
msg<BR>
KBCategory: kbprg kbfixlist kbbuglist kberrmsg<BR>
KBSubcategory:<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
