

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Expand is not an array" Error When Using Outline Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139872">
<META NAME="KBModify" CONTENT="1995/11/20">
<META NAME="KBCreate" CONTENT="1995/11/19">
<META NAME="Keywords" CONTENT="kbole kbprb kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The Outline control has an Expand property and an Expand event. According to Visual FoxPro Help, you can expand an item of an Outline control (Outline1) by using this code:     THISFORM.Outline1.Expand(       ) = .T.  However, this code produces th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIB,QAPN,QAH4,QA7O,QAOE,QAMN,QAB5,QAAP,QBVV,QA56,QA55,QAW6,QAB4,QBXT,QA9Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Expand is not an array" Error When Using Outline Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139872</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Outline control has an Expand property and an Expand event. According
to Visual FoxPro Help, you can expand an item of an Outline control
(Outline1) by using this code:
<P>
<PRE>   THISFORM.Outline1.Expand(&lt;Item#&gt;) = .T.

</PRE>However, this code produces this error:
<P>
<PRE>   'Expand' is not an array

</PRE><h2>CAUSE</h2>
 
<P>
Visual FoxPro is interpreting Expand as a property of the Outline container
object. The syntax is similar to referencing Expand as an array. That is
why Visual FoxPro reports this error. You need to tell Visual FoxPro that
this is a property of the OLE control that the container is holding. The
Help documentation is incomplete.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The Object property provides access to the OLE server properties and
methods for an OLE object. Therefore, to expand an item, you can use this
code:
<P>
<PRE>   THISFORM.Outline1.Object.Expand(&lt;Item#&gt;) = .T.

</PRE>This assumes that the &lt;item#&gt; of the Outline control contains subordinate
items and that it is currently collapsed.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Outline control (Msoutl32.ocx) is a special type of list box that you
can use to display items in a list hierarchically. This is useful for
showing directories and files in a file system; it is the technique used by
the Windows File Manager.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the Debug window, and enter this line:
<P>
   _SCREEN.ACTIVEFORM.ACTIVECONTROL.ListIndex

<P><LI>Use the DO FORM command to run the Outline1.scx form in the Samples\Ole
   directory.

<P><LI>Click the Select a Database button, and select the Testdata.dbc (from
   the Samples\Data directory)

<P><LI>Click different lines on the Outline Sample form to see that the
   ListIndex changes. Make sure the Customer line (ListIndex 0) is
   selected but not expanded (collapsed) before you perform the next step.

<P><LI>To expand the Customer item programmatically, type the following command
   in the Command window:
<P>
   _SCREEN.ACTIVEFORM.OLEControl1.Expand(0) = .T.
<P>
   This will return the error noted above: "'Expand' is not an array."

<P><LI>To get the correct behavior, use the following line of code instead:
<P>
   _SCREEN.ACTIVEFORM.OLEControl1.Object.Expand(0) = .T.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbole kbdocerr kbprb<BR>
KBSubcategory: FxinteropOcx<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 20, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
