

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Place Totals on Report's Last Page in Page Footer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130865">
<META NAME="KBModify" CONTENT="1998/01/23">
<META NAME="KBCreate" CONTENT="1995/05/30">
<META NAME="Keywords" CONTENT="FxtoolRwriter kbcode kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using the Report Writer, you can use the Summary band to place information at the end of the report on the bottom of the last page where the page footer is located.  By design, the Summary band places information at the end of a report, but th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QDMW,QAML,QBV4,QACI,QBCI,QA5V,QAB9,QBWA,QAYL,QAHP,QAOX,QAGY,QAWH,QBT3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Place Totals on Report's Last Page in Page Footer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130865</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50x 2.60 2.60a 3.00 | 2.50x 2.60 2.60a | 2.50b 2.50c 2.60a
<PRE>WINDOWS               | MS-DOS           | MACINTOSH
</PRE>kbtool kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using the Report Writer, you can use the Summary band to place
information at the end of the report on the bottom of the last page where
the page footer is located.
<P>
By design, the Summary band places information at the end of a report, but
the information is positioned right after the last record printed. However,
you may want to place the information at the bottom of the page where the
page footer is located. This article describes how to accomplish this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Do not use the Summary band. Instead, place the expressions that hold the
summary information on the page footer with a conditional IIF statement in
the expression that checks for the last record of the table. Below are the
steps needed to place the summary information in the page footer section.
<P>
Before creating or running the report, ensure that the rectotal variable
used in the conditional IIF below is already set to the total number of
records that need to be printed. To do this, type the following command in
the Command window to get the total number of records in a table:
<P>
<PRE>   rectotal=RECCOUNT()

</PRE>If the report is going to use a FOR clause, use the same FOR condition in
the COUNT command to store the number of records to be printed in the
rectotal variable. For example, use this command:
<P>
<PRE>   COUNT FOR fieldname="whatever" TO rectotal

</PRE><h3>Step-by-Step Example</h3>
 
<P>
<P><h3>Method 1 for FoxPro for Windows versions 2.x</h3>
 

<OL><P><LI>Open the report.

<P><LI>Make a field expression by choosing the AB tool that enables you to make
   a report expression.

<P><LI>In the report expression box, type:
<P>
<P><PRE>      IIF(rectotal=counter, "Yes we are at the end!","")
</PRE>
<P><LI>Select Variables from the Report menu.

<P><LI>In the variable text box, type this variable name:
<P>
<P><PRE>      counter
</PRE>
<P><LI>In the Value to Store text box, type this number:
<P>
<P><PRE>      1
</PRE>
<P><LI>Select the Sum option in the Calculate text box.

<P><LI>Make sure that the Reset selection is at "End of Report."

<P><LI>From the Report menu, select Page Review.
<P>
</OL>You will see the phrase "Yes we are at the end!" located in the page footer
of the last page only. This simulates a Summary band that puts information
at the bottom of the last page of a report.
<P>
NOTE: If you are using Visual FoxPro and the Print Area is set to "Whole
Page" in the Page Setup dialog box, the information in the page footer may
not appear. Sliding the Page Footer bar down one or more lines in the
Report Designer makes the Page Footer information appear.
<P>
Method 2 for FoxPro for Windows version 3.x
 

<OL><P><LI>Open the report.

<P><LI>Create a field expression by selecting the AB tool from the Report
   Controls toolbar that allows you to create a report expression.

<P><LI>In the report expression box, type the following:
<P>
<P><PRE>      "Yes we are at the end of this Visual FoxPro 3.0 report!"
</PRE>
<P><LI>Select the Print When command button.

<P><LI>In the Print Only When Expression Is True text box, type:
<P>
<P><PRE>      recno()=reccount()
</PRE><P>
   NOTE: This expression does not work in FoxPro 2.x.

<P><LI>From the Report Menu, select Page Review and you now see the phrase "Yes
   we are at the end of this Visual FoxPro 3.0 report!" located in the page
   footer of the last page only.
<P>
   NOTE: This simulates a Summary band that puts information at the bottom
   of the last page of a report.
<P>
</OL>To print a calculation you may substitute a calculation expression for the
text expression.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin  2.50 2.50a 2.50b 2.50c<BR>
2.60 2.60a<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolRwriter<BR>
Keywords          : FxtoolRwriter kbcode kbtool<BR>
Version           : 2.50x 2.60 2.60a 3.00 | 2.50x 2.<BR>
Platform          : MACINTOSH MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
