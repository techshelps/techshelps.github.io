

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Queries Return Incorrect Number of Records </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128771">
<META NAME="KBModify" CONTENT="1995/06/02">
<META NAME="KBCreate" CONTENT="1995/04/10">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Queries that run correctly in FoxPro on the MS-DOS, Windows, and Macintosh platforms might not return the same results in FoxPro for UNIX.  The problem occurs while querying records that have been indexed in a .CDX file using queries with AND or OR...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAML,QAUD,QAZV,QAHH,QDNQ,QAJQ,QDMH,QATJ,QAR4,QAKP,QAI4,QBXN,QBVV,QAL3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Queries Return Incorrect Number of Records</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128771</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for UNIX, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Queries that run correctly in FoxPro on the MS-DOS, Windows, and Macintosh
platforms might not return the same results in FoxPro for UNIX.
<P>
The problem occurs while querying records that have been indexed in a .CDX
file using queries with AND or OR. When the size of the database in number
of records is 0, 1, or 2 modulo 32 and the right side of the AND or OR in
the query expression matches the last, next to last, or third to the last
record respectively, then the query could return erroneous data in one of
two ways:

<UL><LI>If the operator is OR, records at the end of the database that match
   the query may not be caught by the query; some records that match the
   WHERE condition are left out.

<LI>If the operator is AND, records at the end of the database that match
   the left side of the AND may be selected even when the right side is
   false; some records that do not match the WHERE condition would be
   selected.
<P>
</UL><h2>CAUSE</h2>
 
<P>
This problem happens only with .CDX indices and affects only the last one
to three records in the file when the database contains 0 to 2 modulo 32
records and is queried with the AND or OR operators. The problem does not
occur if the database is not indexed on the fields being queried or if it
is indexed with an .IDX file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following patches may be applied to the FoxPro for UNIX binary
(FoxPro.pr) or the FoxPro for UNIX runtime binary (foxr.pr) as appropriate.
Make sure you back up your existing FoxPro binary file before applying
either of these patches. It is very important that you apply the correct
patch to the appropriate binary. Failure to apply the patch correctly could
result in a serious problem with your FoxPro binary.
<P>
Script to patch FoxPro for UNIX binary:
<P>
:
#
# This script patches the foxpro.pr binary and must be executed as root
# in the same directory as the binary, e.g.
<PRE>#         su
#         cd /usr/lib/foxpro
#         cp foxpro.pr foxpro.pr.00
#         sh &lt;whatever_you_name_this_file&gt;
#
</PRE>echo Patching foxpro.pr ...
/etc/_fst -w foxpro.pr &lt;&lt; EOF
0x17:0x18957e?x
?w 0x28c0
$q
EOF
echo Replaced 0x20c0 with 0x28c0
<P>
Script to patch FoxPro for UNIX runtime binary:
<P>
:
#
# This script patches the foxr.pr runtime binary and must be executed as
# root in the same directory as the binary, e.g.
<PRE>#         su
#         cd /usr/lib/foxpro
#         cp foxr.pr foxr.pr.00
#         sh &lt;whatever_you_name_this_file&gt;
#
</PRE>echo Patching foxr.pr ...
/etc/_fst -w foxr.pr &lt;&lt; EOF
0x17:0x10bfd6?x
?w 0x28c0
$q
EOF
echo Replaced 0x20c0 with 0x28c0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples use the CUSTOMER database from the
/usr/lib/foxpro/tutorial directory. Twelve records have been added to the
database to make the number of records in the database mod 32 equal zero.
<P>
The STATE field in the last record, for the purposes of this example,
should contain CO. For testing, you could append the first twelve records
in the database to the end of the database. This was the method used to
obtain these results.
<P>
The first query works correctly, and returns 27 records:
<P>
<PRE>   SELECT * FROM Customer WHERE state = "CO" OR state = "NC"

</PRE>The next query returns only 26 records. It misses the last record in the
database:
<P>
<PRE>   SELECT * FROM Customer WHERE state = "NC" OR state = "CO"

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxUnix buglist2.60 2.60<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 2, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
