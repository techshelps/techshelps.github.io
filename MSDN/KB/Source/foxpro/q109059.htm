

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Prevent Multiple Instances of an Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109059">
<META NAME="KBModify" CONTENT="1998/02/18">
<META NAME="KBCreate" CONTENT="1993/12/21">
<META NAME="Keywords" CONTENT="FxprgFoxtools kbcode kbhowto kbinterop kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The program shown below demonstrates how to stop a second instance of the same FoxPro window from being started by using the Windows application programming interface (API) function FindWindow() to test if a given window name already exists. The Fi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWN,QBWQ,QAGI,QAIJ,QAGQ,QAH4,QAJH,QBVV,QBE7,QBE6,QBWS,QBXS,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Prevent Multiple Instances of an Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109059</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.6x 3.00 5.00
WINDOWS
kbinterop kbtool kbprg kbcode kbhowto
<P>
 
The information in this article applies to:
<P>
- Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
- Microsoft FoxPro for Windows, versions 2.5x, 2.6x
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The program shown below demonstrates how to stop a second instance of the
same FoxPro window from being started by using the Windows application
programming interface (API) function FindWindow() to test if a given window
name already exists. The FindWindow() function can be accessed by including
FOXTOOLS.FLL, the library file that is supplied with FoxPro for Windows and
documented in the Foxtools.hlp file.
<P>
NOTE: This method does not prevent multiple instances of FoxPro for Windows
from starting.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This works in Windows for Workgroups 3.00, Windows 95, and Windows
NT.
<P>
Copy this code into a program file in FoxPro for windows. The first time
you call the program, you will notice the main FoxPro window title change.
The second time you run it, you will get the message that you cannot start
another instance of the window.
<P>
NOTE: Set the window name after you check for its existence.
<P>
<PRE>   SET LIBRARY TO SYS(2004)+"foxtools.fll" ADDITIVE
   * FindWindow() takes two parameters and returns the handle of the
   * window, HWND, if it was found.
   GetWind = RegFn("FindWindow", "CC", "I")
   *Set the first parameter of the call to getwind to 0, null.
   wclass=0
   winname="My Application"
   apphand=CallFn(GetWind,wclass ,winname)
   *If the call was successful, stop processing.
   IF apphand&lt;&gt;0
      WAIT WINDOW ;
        "You cannot start another instance of the window 'My Application'!"
      QUIT
   ENDIF
   MODIFY WINDOW screen TITLE "My Application"
   WAIT WINDOW ;
     "The first instance of the window 'My Application' is running."

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Windows Software Development Kit, "Programmer's Reference,
Volume 2: Functions," page 309
<P>
Foxtools.hlp, located in the C:\Vfp\Tools
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 FoxWin VFoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
3.00 foxtools sdk fll api recursive recursion loaded twice<BR>
KBCategory: kbinterop kbtool kbprg kbcode kbhowto<BR>
KBSubcategory: FxprgFoxtools<BR>
Keywords          : FxprgFoxtools kbcode kbhowto kbinterop kbprg kbtool<BR>
Version           : 2.5x 2.6x 3.00 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
