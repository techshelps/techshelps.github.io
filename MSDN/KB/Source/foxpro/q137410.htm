

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Determine Whether a Record Is Blank or Empty </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137410">
<META NAME="KBModify" CONTENT="1995/09/29">
<META NAME="KBCreate" CONTENT="1995/09/26">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro supplies functions to determine if the contents of a single field is blank (with ISBLANK()) or empty (with EMPTY()). This article will show how to use these functions to create user-defined functions (UDFs) that will return True (.T.) or Fal...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAUD,QAB9,QBV8,QAY5,QAGB,QAI4,QA7O,QA7N,QDIJ,QAEF,QAVX,QAVW,QAL3,QDMH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Determine Whether a Record Is Blank or Empty</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137410</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxPro supplies functions to determine if the contents of a single field is
blank (with ISBLANK()) or empty (with EMPTY()). This article will show how
to use these functions to create user-defined functions (UDFs) that will
return True (.T.) or False (.F.) to indicate if the entire record is blank
or empty.
<P>
For more information about the ISBLANK() function, please see the FoxPro
Help file or the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q99095.htm">Q99095</A></B>
   TITLE     : ISBLANK() Function Provides Additional Null Value Support

   ARTICLE-ID: <B><A HREF="../FOXPRO/Q102453.htm">Q102453</A></B>
   TITLE     : How to Test for a Blank Character Variable

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Create a program/procedure file containing the following UDF:
<P>
<PRE>   * Function: IsBlankRec
   *
   * Parameter: &lt;expN&gt; | &lt;expC&gt; - optional
   *
   * where &lt;expN&gt; is the number of the work area to check if record is
   *  blank or, where &lt;expC&gt; is the name of the alias to check if record is
   *  blank
   *
   FUNCTION IsBlankRec
   PARAMETER lAlias
   PRIVATE llSeleBack, lnSeleBack, llResult, lcFieldName, I

   llSeleBack = .F.
   lnSeleBack = SELECT(0)
   llResult = .T.

   IF PARAMETERS() = 1
      llSeleBack = .T.
      SELECT (lAlias)
   ENDIF

   FOR I = 1 TO FCOUNT()
      lcFieldName = FIELD(I)
      IF ! ISBLANK( &amp;lcFieldName )
         llResult = .F.
         EXIT
      ENDIF
   ENDFOR

   IF llSeleBack
      SELECT (lnSeleBack)
   ENDIF

   RETURN llResult

</PRE>This function tests to see if it needs to change work areas by the number
of parameters passed to the UDF. It then loops through all the fields in
the current work area, testing each field with the ISBLANK() function. The
first field that returns NOT BLANK causes the memory variable llResult to
be set to false (.F.) and exits the For loop. If necessary, the UDF changes
back to the original work area and then return the results of the search
for blank fields. If all fields in the record are blank, the UDF returns
True (.T.).
<P>
NOTE: To test for an empty record, you may change the name of the function
to IsEmptyRec and replace the following line:
<P>
<PRE>   IF ! ISBLANK( &amp;lcFieldName )

</PRE>with:
<P>
<PRE>   IF ! EMPTY( &amp;lcFieldName )

</PRE><h3>Testing the Results</h3>
 

<OL><P><LI>Place both functions in a .prg file.

<P><LI>In the Command window, type the following where &lt;myproc&gt; is the name of
   the .prg file created in step 1:
<P>
   SET PROCEDURE TO &lt;myproc&gt;

<P><LI>Open the Customer.dbf file located in the Tutorial directory, located
   in your Foxprow, Fpd26, or Fpw26) directory.

<P><LI>While on record number 1, enter the following command in the Command
   Window:
<P>
   ? IsBlankRec(), IsEmptyRec()
<P>
   Your results should be:
<P>
   .F. .F.

<P><LI>Type the command APPEND BLANK in the Command window.

<P><LI>While on the new record, enter the following command in the Command
   Window:
<P>
   ? IsBlankRec(), IsEmptyRec()
<P>
   Your results should be:
<P>
   .T. .T.

<P><LI>Edit the new record by entering zeros in the fields: Ytdpurch, Lat, and
   Long.

<P><LI>While on the new record, enter the following command in the Command
   window:
<P>
   ? IsBlankRec(), IsEmptyRec()
<P>
   Your results should be:
<P>
   .F. .T.
<P>
   The results are different because the fields Ytdpurch, Lat, and Long
   contain the value 0. ISBLANK() does not consider numeric fields
   containing zeros to be blank, but EMPTY() does consider them to be
   empty.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
