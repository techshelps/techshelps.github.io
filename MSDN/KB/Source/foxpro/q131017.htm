

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use Data Sessions in a Toolbar to Show Changes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131017">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/06/02">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes two methods you can use to use data sessions in a toolbar to reflect changes among multiple instances of both parent and child forms. Multiple instances of both parent and child forms can be reflected in the toolbar and menu ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAF0,QANS,QABI,QAH4,QAYY,QATK,QAMN,QAI2,QBVV,QAO4,QADK,QAA8,QA62,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use Data Sessions in a Toolbar to Show Changes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131017</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes two methods you can use to use data sessions in a
toolbar to reflect changes among multiple instances of both parent and
child forms. Multiple instances of both parent and child forms can be
reflected in the toolbar and menu as focus shifts from one form to another.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The main reason the DataSessionID property is read/write is so you can set
non-databound forms or toolbars to link up with another private data
session's form, formset, or toolbar. The toolbar can query the
_Screen.Activeform property to determine which form is currently active.
Each form can have a property identifying whether it's in the process of an
edit or not.
<P>
<P><h3>Method One</h3>
 
<P>
Make sure the toolbox class has DataSessions=2. Then within a method of
a toolbox subclass, try the following logic to manipulate data of the
active form:
<P>
<PRE>   Thisform.DataSessionID=_screen.ActiveForm.DataSessionID

</PRE><h3>Method Two</h3>
 
<P>
Use a timer to determine the status of the active form, enabling or
disabling controls on the toolbar as appropriate. In the toolbar's INIT
event, add a Timer to the screen as follows:
<P>
<PRE>   _Screen.AddObject("ToolBartimer" MyTimerClass)

</PRE>If you want the toolbar and the form to share data sessions, place the
following code in the Timer event method:
<P>
<PRE>   MyToolBar.DataSessionID = IIF(TYPE("_Screen.ActiveForm") == "O",;
      _Screen.ActiveForm.DataSessionID,1)

</PRE>In the Timer event code, use the GETFLDSTATE(-1) function to determine
if the data on the active form has been changed or deleted as in this
example code:
<P>
IF ( ("2" $ GETFLDSTATE(-1)) OR ;
<PRE>     ("3" $ GETFLDSTATE(-1)) OR ;
     ("4" $ GETFLDSTATE(-1)) )
   MyToolBar.cmdNewButton.Enabled  = .F.
   MyToolBar.cmdSaveButton.Enabled = .T.
   MyToolBar.cmdUndoButton.Enabled = .T.
</PRE>ELSE
<PRE>   MyToolBar.cmdNewButton.Enabled  = .T.
   MyToolBar.cmdSaveButton.Enabled = .F.
   MyToolBar.cmdUndoButton.Enabled = .F.
</PRE>ENDIF
<P>
NOTE: Make sure your toolbar does not contain any bound controls. Changing
the datasession of a bound form is not recommended.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
