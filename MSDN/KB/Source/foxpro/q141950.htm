

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: GP Fault When Change RecordSource of a Column in a Grid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141950">
<META NAME="KBModify" CONTENT="1996/01/08">
<META NAME="KBCreate" CONTENT="1996/01/02">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A general protection (GP) fault occurs when you change the RecordSource property of a column in a grid.  CAUSE =====  The GP fault may be caused by opening a table in area 256 or greater. For example:  USE TEST IN SELECT(1)  This uses the last avai...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QAML,QAVX,QAVW,QAH4,QAPN,QAO4,QBWS,QARR,QALZ,QAE1,QA7O,QA7N,QA59,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: GP Fault When Change RecordSource of a Column in a Grid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141950</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A general protection (GP) fault occurs when you change the RecordSource
property of a column in a grid.
<P>
<P><h2>CAUSE</h2>
 
<P>
The GP fault may be caused by opening a table in area 256 or greater. For
example:
<P>
USE TEST IN SELECT(1)
<P>
This uses the last available work area, usually 32767.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a free table called Test with two fields named First and Last.
   Make both fields Character(10). Enter a couple of rows of sample data.

<P><LI>Create a blank form.

<P><LI>Add a grid to your form and change its ColumnCount property to 1.

<P><LI>Add a command button to your form, and place the following code in its
   Click event:
<P>
   THISFORM.Grid1.Column1.ControlSource = "last"

<P><LI>Add the following code to the Init event of your form:
<P>
   USE TEST IN 256
   THISFORM.Grid1.RecordSource = "test"

<P><LI>Run the form, and click the command button.
<P>
</OL>The GP fault occurs with details similar to the following information:
<P>
<PRE>   VFP caused an invalid page fault in
   module KERNEL32.DLL at 0137:bff858c0.
   Registers:
   EAX=7fd89e61 CS=0137 EIP=bff858c0 EFLGS=00010202
   EBX=009dfe28 SS=013f ESP=008e0000 EBP=008e03bc
   ECX=00000000 DS=013f ESI=815958c0 FS=3be7
   EDX=c001ebf0 ES=013f EDI=815a8f08 GS=0000
   Bytes at CS:EIP:
   55 a1 78 c2 fb bf 8b ec 83 ec 70 8b 08 53 56 89
   Stack dump:
   ffecbad7 008e0030 008e0014 0000000e
   00000004 c0000005 00000000 00000000
   7fd89e61 00000002 00000000 7fd89e61
   0001001f 00000000 00000000 00000000
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
