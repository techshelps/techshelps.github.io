

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Commands in dBASE Format File Ignored During BROWSE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112471">
<META NAME="KBModify" CONTENT="1995/06/28">
<META NAME="KBCreate" CONTENT="1994/03/09">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro version 2.6 ignores some commands in a dBASE IV created format file if a BROWSE FORMAT command is issued.  NOTE: The extra commands in a format file are ignored only during a BROWSE FORMAT command. The EDIT, CHANGE, APPEND, and READ commands...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QDNG,QAB9,QBV8,QDI1,QABM,QAH7,QAHT,QAH4,QAVI,QAXC,QBWT,QAY5,QAY4,QAY0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Commands in dBASE Format File Ignored During BROWSE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112471</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, version 2.6
<LI>Microsoft FoxPro for Windows, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
FoxPro version 2.6 ignores some commands in a dBASE IV created format file
if a BROWSE FORMAT command is issued.
<P>
NOTE: The extra commands in a format file are ignored only during a BROWSE
FORMAT command. The EDIT, CHANGE, APPEND, and READ commands do not ignore
the extra commands in the format file.
<P>
<P><h2>CAUSE</h2>
 
<P>
FoxPro and dBASE format files differ in functionality. FoxPro allows only
@ ... SAY, @ ... GET, and COLOR commands in a format file, whereas dBASE
allows other program commands.
<P>
FoxPro provides for the use of other commands through the Screen Builder
power tool, which is the replacement for the dBASE format file. The FoxPro
Migration tool, MIGRATE.APP, will convert dBASE .FMT files into FoxPro .SCX
files. To run the Migration tool, choose Convert dBASE Files from the Run
menu in FoxPro version 2.6.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a file named CUSTOMER.FMT with the following commands:
<P>
<P><PRE>      *------------------------------------------------------------------
      * Name.......: CUSTOMER.FMT
      * Version....: dBASE IV, Format 2.0
      * Notes......: Format files use "" as delimiters!
      *------------------------------------------------------------------
</PRE><P>
<P><PRE>      *-- Format file initialization code -------------------------------
</PRE><P>
<P><PRE>      *-- Some of these PRIVATE variables are created based on CodeGen
      *-- and may not be used by your particular .FMT file
      PRIVATE ll_talk, ll_cursor, lc_display, lc_status, ll_carry, ;
<PRE></PRE>         lc_proc

      IF SET("TALK") = "ON"
        SET TALK OFF
        ll_talk = .T.
      ELSE
        ll_talk = .F.
      ENDIF
      ll_cursor = SET("CURSOR") = "ON"
      SET CURSOR ON
      lc_display = SET("DISPLAY")
      lc_status = SET("STATUS")
      *-- SET STATUS was ON when you went into the Forms Designer.
      IF lc_status = "OFF"
         SET STATUS ON
      ENDIF

      *-- @ SAY GETS Processing. ----------------------------------------
      *--  Format Page: 1
      @ 1,0 SAY "CNO"
      @ 1,4 GET cno PICTURE "XXXXXX"
      @ 2,0 SAY "CONTACT"
      @ 2,4 GET contact PICTURE "XXXXXXXXXXXXXXXXXXXX"
      @ 3,0 SAY "COMPANY"
      @ 3,4 GET company PICTURE "XXXXXXXXXXXXXXXXXXXXXXXXX"
      *-- Format file exit code -----------------------------------------

      *-- SET STATUS was ON when you went into the Forms Designer.
      IF lc_status = "OFF"  &amp;&amp; Entered form with status off
         SET STATUS OFF     &amp;&amp; Turn STATUS "OFF" on the way out
      ENDIF
      IF .NOT. ll_cursor
        SET CURSOR OFF
      ENDIF

      IF SET( "DISPLAY" ) &lt;&gt; lc_display
        SET DISPLAY TO &amp;lc_display.      &amp;&amp; Reset Screen size if changed
      ENDIF

      RELEASE lc_fields,lc_STATUS
</PRE></OL> 
<P>
<PRE>   IF TYPE( "ll_echo" ) = "L"
        IF ll_echo
          SET ECHO ON
        ENDIF
      ENDIF
      IF ll_talk
        SET TALK ON
      ENDIF
      *-- EOP: CUSTOMER.FMT

</PRE><P><LI>Issue the following commands in the Command window:
<P>
<P><PRE>      USE customer
      SET FORMAT TO customer.fmt
      BROWSE FORMAT
</PRE><P>
</OL>FoxPro will ignore all commands except @ ... SAY, @ ... GET, and COLOR
commands.
<P>
This behavior is by design to eliminate the "Syntax error" message that
occurs in previous versions of FoxPro.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.60<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxinteropDbase<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 28, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
