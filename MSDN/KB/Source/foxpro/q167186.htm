

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SET CENTURY ROLLOVER Ignores Setting of SET CENTURY OFF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167186">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1997/04/21">
<META NAME="Keywords" CONTENT="FxprgGeneral vfoxwin kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using the ROLLOVER parameter of SET CENTURY, the SET CENTURY OFF setting is ignored. This results in a date display consisting of either two digits or four digits for the year portion of the date.  RESOLUTION  The reason for the display of the...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QBXS,QAH4,QAMB,QAC2,QBT6,QANY,QBV4,QAUD,QAHP,QAPN,QBDM,QA4F,QAXB,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SET CENTURY ROLLOVER Ignores Setting of SET CENTURY OFF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167186</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the ROLLOVER parameter of SET CENTURY, the SET CENTURY OFF
setting is ignored. This results in a date display consisting of either two
digits or four digits for the year portion of the date.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The reason for the display of the year in either a two or four-digit format
is to differentiate which century the date belongs to.
<P>
It is possible to create a custom display format, which presents the date
in the 'MM/DD/YY' format along with another field to display which century.
<P>
The following program demonstrates a sample method to do this.
<P>
<P><h3>Steps to Reproduce Solution</h3>
 

<OL><P><LI>Save the following code as Daterev.prg:
<P>
<P><PRE>      *** Begin code ***
      ON  KEY  LABEL f2 CLEAR EVENTS
      ON KEY LABEL f3 DO refresh
      SET CENTURY to 19 ROLLOVER 60
      SET CENTURY off
      dateform=CREATEOBJECT('form')
      WITH dateform
<PRE></PRE>         .width=300
         .height=65
         .ADDOBJECT('text1','textbox')
         WITH .text1
            .format='K'
            .inputmask='99/99/99'
            .left=1
            .top=10
            .width=60
            .value=DTOC(date())
            .visible=.t.
         ENDWITH   &amp;&amp; text1
         .ADDOBJECT('label1','label')
         WITH .label1
            .top=50
            .left=90
            .width=120
            .fontbold=.t.
            .caption="Press &lt;F2&gt; to exit form"
            .visible=.t.
         ENDWITH   &amp;&amp; label1
         .ADDOBJECT('label2','label')
         WITH .label2
            .caption="Year of date shown is  "+ ;
               ALLTRIM(STR(YEAR(CTOD(dateform.text1.value))))
            .top=32
            .left=10
            .width=160
            .fontbold=.t.
            .visible=.t.
         ENDWITH   &amp;&amp; label2
         .ADDOBJECT('label3','label')
         WITH .label3
            .caption='Press &lt;f3&gt; to refresh after entering new date'
            .top=10
            .left=65
            .width=250
            .fontbold=.t.
            .visible=.t.
         ENDWITH   &amp;&amp; label3
         .show
      ENDWITH   &amp;&amp; dateform
      READ EVENTS
      ON KEY LABEL f2
      ON KEY LABEL f3

      PROCEDURE refresh
         dateform.label2.caption="Year of date shown is: "+ ;
             ALLTRIM(STR(YEAR(CTOD(dateform.text1.value))))
         dateform.refresh
      RETURN
      *** End code ***

</PRE><P><LI>Run the program.
   NOTE: The four-digit display of the date shown is shown below the
   text box.

<P><LI>Enter a valid date for the 21st century, such as "02/12/55."

<P><LI>Press F3 to refresh the display.
   NOTE: In the line below the text box, the year is shown as "2055."
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ROLLOVER clause of SET CENTURY command permits ease of entering dates,
which may cross century boundaries, for example:
<P>
<PRE>   SET CENTURY to 19 ROLLOVER 60

</PRE></OL>This means that when a two-digit value for a year "60" and greater falls
within the 21st century. Two-digit values less than 60 fall into the 20th
century.
<P>
Using the information above, "02/15/97" is deemed the year "1997." And
"02/15/55" is interpreted as the year 2055.
<P>
To better understand the implications of the ROLLOVER parameter, the
following program demonstrates its effect on how dates are displayed.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Save the following code as Formdate.prg:
<P>
<P><PRE>      *** Begin code ***
      ON  KEY  LABEL f2 CLEAR EVENTS
      SET CENTURY to 19 ROLLOVER 60
      SET CENTURY off
      dateform=CREATEOBJECT('form')
      WITH dateform
<PRE></PRE>         .width=120
         .height=65
         .ADDOBJECT('text1','textbox')
         WITH .text1
            .format='K'
            .left=35
            .top=10
            .width=75
            .value=date()
            .visible=.t.
         ENDWITH   &amp;&amp; text1
         .ADDOBJECT('label1','label')
         WITH .label1
            .top=35
            .left=1
            .width=120
            .fontbold=.t.
            .caption="Press &lt;F2&gt; to exit form"
            .visible=.t.
         ENDWITH   &amp;&amp; label1
         .show
      ENDWITH   &amp;&amp; dateform
      READ EVENTS
      ON KEY LABEL f2
      *** End code ***

</PRE><P><LI>Run the program.
   NOTE: The current date appears with two digits for year.

<P><LI>In the text box, enter a date with a year less than 60,
   such as 01/10/56.
   Note: As soon the "56" is entered, the year is displayed as "2056."

<P><LI>Enter a date with a year greater than 60, such as 12/01/99.
   NOTE: The date is shown with only the last two digits of the year
   omitting the century.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about SET CENTURY, search for CENTURY in the Visual
FoxPro Help file.
 
<PRE>Keywords          : FxprgGeneral vfoxwin kbprg
Version           : 5.0 5.0a
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
