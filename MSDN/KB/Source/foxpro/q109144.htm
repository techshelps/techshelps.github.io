

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Specifying Path for Cursor with DBExec() Causes Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109144">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1993/12/22">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After you execute a DBExec() function and specify a path and table name for the result of an SQL SELECT statement, the DBError() function returns an error number of 200 or 295 and an error message of null/nothing.  CAUSE =====  DBExec() was execute...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAL3,QBXS,QBBI,QAUD,QADN,QAVX,QAVW,QAG2,QAY5,QAKP,QAJZ,QAB9,QBHQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Specifying Path for Cursor with DBExec() Causes Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109144</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro Connectivity Kit, version 2.5
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you execute a DBExec() function and specify a path and table name for
the result of an SQL SELECT statement, the DBError() function returns an
error number of 200 or 295 and an error message of null/nothing.
<P>
<P><h2>CAUSE</h2>
 
<P>
DBExec() was executed and the DBSetOpt() function was not set to have the
results returned to a table; DBSetOpt() was set to return the results to a
cursor. Error 200 will be received if the path is set to a local drive and
error 295 will be received if it is set to a network drive.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Prior to executing the DBExec() function with the SQL statement, execute
DBSetOpt(handle,'UseTable',1), where the 1 indicates that the results
should be put into a table.
<P>
By default, the result from a DBExec() function will be placed in a cursor
instead of a table unless it is specifically indicated, using
=DBSetOpt(handle,'UseTable',1), that the results should be put into a
table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code reproduces the problem:
<P>
<PRE>   ** Set Library to the ODBC Library
   SET LIBRARY TO SYS(2004)+"FPSQL.FLL"

   ** errval=ERROR NUMBER, errmsg=ERROR MESSAGE
   ** If an error is received then DBERROR()
   ** will be called and the error number will be
   ** stored in errval and the message in errmsg.

   errval=0
   errmsg=' '

   ** Specify source name as seen in ODBC Manager in the Control Panel.
   ** Specify user and password for server.
   sourcename="test"
   user="sa"
   passwd=""

   ** Get a connection handle.
   handle=DBConnect(sourcename,user,passwd)

   IF handle &gt; 0
      WAIT WINDOW "Successfully Connected"
   ELSE
      error=DBError(0,@errmsg,@errval)
      WAIT WINDOW STR(errval)+" "+errmsg
      =DBDisconn(handle)
   ENDIF

   ** Set various options for session handle.
   =DBSetOpt(handle,'Asynchronous',0)  &amp;&amp; Turn synchronous on
   =DBSetOpt(handle,'BatchMode',1)     &amp;&amp; Return all results at once
   =DBSetOpt(handle,'ConnTimeout',0)   &amp;&amp; wait forever if need be
   =DBSetOpt(handle,'Transact',1)      &amp;&amp; Turn Auto on
   ** We should have specified here
   **  =DBSetOpt(handle,'UseTable',1)      &amp;&amp; Put results into table
   ** so that the results would be put into a table.


   ** Use the PUBS database (a standard database that comes
   ** with SQL Server).
   a=DBExec(handle,"use pubs")
   IF a &gt; 0
      WAIT WINDOW "NOW USING PUBS DATABASE"
   ELSE
      error=DBError(handle,@errmsg,@errval)
      WAIT WINDOW STR(errval)+" "+errmsg
   ENDIF


   ** Perform an SQL SELECT and put the results in C:\TEST.DBF.
   ** The line below will cause the error because we are
   ** specifying a path instead of just a name.
   a=DBExec(handle,"select * from stores","c:\test.dbf")
   IF a &gt; 0
      WAIT WINDOW "SELECT * FROM STORES EXECUTED"
      BROWSE
   ELSE
      error=DBError(handle,@errmsg,@errval)
      WAIT WINDOW STR(errval)+" "+errmsg
   ENDIF

   ** Release the connection handle.
   =DBDisconn(handle)
   SET LIBRARY TO
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.50 2.50a 2.50b CK ODBC<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxtoolCk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
