

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB:Feature Not Available Error If EXE Uses Macro Substitution </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133358">
<META NAME="KBModify" CONTENT="1995/11/21">
<META NAME="KBCreate" CONTENT="1995/07/30">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When running a stand-alone EXE (regular or extended) and executing a line of code that uses macro substitution to reference a command verb, a  Feature Not Available  error is encountered.  CAUSE =====  When FoxPro creates a stand-alone executable f...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAB9,QBV8,QBET,QBXS,QBVV,QAB3,QAVI,QAG9,QAVX,QAVW,QAB4,QAAP,QA59,QA0N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB:Feature Not Available Error If EXE Uses Macro Substitution</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133358</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When running a stand-alone EXE (regular or extended) and executing a line
of code that uses macro substitution to reference a command verb, a
"Feature Not Available" error is encountered.
<P>
<P><h2>CAUSE</h2>
 
<P>
When FoxPro creates a stand-alone executable file, the project files are
scanned for FoxPro commands. The interpretations for these commands are
then built into the executable. However, if macro substitution is used to
directly reference a command verb, FoxPro does not evaluate the literal
text stored to the variable as a FoxPro command. Thus, the interpretation
for that command verb is not built into a FoxPro stand-alone executable.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Here are four techniques you can use to avoid the problem:

<UL><LI>Use macro substitution in a command expression instead of in a line of
   code. If you use macro substitution in an expression, there is no
   reference to the command verb, so the "Feature Not Available" error is
   avoided.
<P>
   -or-

<LI>Use a macro-substituted reference to a command verb if there is a
   non-macro substituted reference to that command verb within the project.
<P>
   -or-

<LI>Within a dummy program that never gets called (or within a dummy
   procedure that never gets called within an existing program), include a
   non-macro substituted reference to the subject command verb.
<P>
   -or-

<LI>Use this last-resort technique. It is extreme and should be reserved for
   use by a developer who is unable to determine which command verb is
   resulting in a conflict. Incorporate the Prowords.fxd document (located
   in the FoxPro root directory) into the Project as a Program. This
   contains a reference to all of the FoxPro command verbs, so it will
   cause the size of the stand-alone .EXE file to grow beyond what it might
   otherwise be. It is strongly suggested that this option be avoided if at
   all possible. If you use this technique, note that during the Build EXE
   process, you'll see many errors associated with the Prowords.fxd file;
   ignore them.
<P>
</UL>See examples for the first two of these techniques are shows in the "More
Information" section of this article.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is possible to avoid problems associated with the use of macro-
substituted references to command verbs without taking any direct action to
avoid it. But, in these cases, one of the following has occurred:

<UL><LI>The developer has used a non-Macro-Substituted reference to that command
   at some place within their Project.
<P>
   -or-

<LI>While building the .EXE file, the compiler incorporates command
   translations in blocks (or clusters). In other words, when you build an
   .EXE file that contains a SET command, the block that contains the'
   translation for the SET command is added to the .EXE file. But this
   block also contains the translation for other commands. So, if you
   happen to add a macro-substituted reference to a command that has
   already had its translation built in when the translation for the SET
   command was build in, then no problem is encountered. This is the one
   scenario where a "Feature Not Available" error can be avoided for a
   particular command verb even though a non-macro-substituted reference to
   it does not exist.
<P>
</UL><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example uses the SET command to demonstrate this behavior:

<OL><P><LI>Create a program (for the sake of example, call it Test) that contains
   this code:
<P>
   a="SET "  &amp;&amp; The space between SET and the closing quote is needed
   b="COLOR TO GR+/R"
<PRE>   &amp;a&amp;b             &amp;&amp; "a" is the command verb, "b" is the command clause
   CLEAR
   WAIT

</PRE><P><LI>Add the Test program to a new project and build a stand-alone .EXE file.

<P><LI>Run the .EXE file independent of FoxPro to see the "Feature Not
   Available" error display.
<P>
</OL><h3>Example Resolution - Using an Expression</h3>
 
<P>
This example demonstrates how to use macro substitution in a command
expression instead of in a line of code. If you use macro substitution in
an expression, there is no reference to the command verb, so the "Feature
Not Available" error is avoided.

<OL><P><LI>Modify the Test program so that it contains this code:
<P>
   b="COLOR TO GR+/R"
<PRE>   SET &amp;b           &amp;&amp; The command verb SET is not macro substituted
   CLEAR
   WAIT

</PRE><P><LI>Save the changes to the Project, rebuild the .EXE file, and run it
   independent of FoxPro.
<P>
</OL>In this case, you are still using macro substitution to reference a portion
of the command expression, but not the SET command verb. You should see the
screen background color change to red, and the wait message pen color
appear as yellow. Because the SET command verb has not been macro-
substituted, the translation is built into the .EXE file.
<P>
<P><h3>Example Resolution - Reference that Command Verb Elsewhere in the Code</h3>
 
<P>
This example shows that you can use a macro-substituted reference to a
command verb if there is a non-macro-substituted reference to that command
verb within the project.

<OL><P><LI>Modify the Test program so that it contains this code:
<P>
   SET TALK OFF
<PRE>   a="SET "   &amp;&amp; The space between SET and the closing quote is needed
   b="COLOR TO GR+/R"
   &amp;a&amp;b
   CLEAR
   WAIT

</PRE><P><LI>Save the changes to the Project, rebuild the .EXE file, and run it
   independent of FoxPro.

<P><LI>Again, you have used a non-Macro-Substituted reference to the SET
   command, so the translation is built into the .EXE files.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxprgMacrosub<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
