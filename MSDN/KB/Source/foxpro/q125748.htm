

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Prevent Screen Dropping Out with Disabled Button </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125748">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/02/05">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If the screen you are running suddenly stops running after you click an object like a button, you may have code running that is disabling the object you have just clicked.  For example, when you leave a GET field either by pressing the TAB or ENTER...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUR,QAPN,QAW6,QAU7,QAH4,QBXS,QA4P,QADO,QAEF,QBFM,QA5V,QA5D,QAXC,QAFQ,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Prevent Screen Dropping Out with Disabled Button</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125748</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If the screen you are running suddenly stops running after you click an
object like a button, you may have code running that is disabling the
object you have just clicked.
<P>
For example, when you leave a GET field either by pressing the TAB or ENTER
key or by clicking with the mouse, the VALID clause of that object is
evaluated. If the VALID code snippit disables the next object that gets the
focus, the screen will stop running. The reason you are dropping out of
your screen is because the object that receives the focus has been
disabled, and then receives the focus anyway.
<P>
A common situation for this dilemma is where you want to allow your users
to click a "Next" button to move to the next record in the table, however,
if the information has been modified in one of the input objects on the
screen, you want to force the user to choose to save or cancel those
changes by clicking different buttons.
<P>
The solution is to move the focus to an object that has not been disabled.
In this case, move the focus to the Save button, diverting the focus from
the Next button, even after clicking the Next button.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The example steps below demonstrate a simple solution. This example uses
the names "m.fieldname" for an input object, "next" and "save" for push
buttons and a variable called "old_fieldname" to store the previous value
of the input object. It also loads the library Foxtools, for use of the
MSGBOX() function.

<OL><P><LI> Create a screen with three objects on it. Write code for the WHEN and
<P><PRE>    VALID code snippets, substituting your table, field and variable names
    as wanted.
</PRE>
<P><LI>Put the following code in the Setup code snippit:
<P>
   m.fieldname = table.fieldname
   old_fieldname = m.fieldname
   SET LIBRARY TO C:\fpw26a\foxtools.fll

<P><LI>Add an input or GET object (called m.fieldname) with the following code
   snippets:
<P>
   * get when clause
   old_fieldname = m.fieldname
   SHOW OBJECT OBJNUM(save) DISABLED
<P>
   * get valid clause
   IF m.fieldname &lt;&gt; old_fieldname
<P><PRE>      SHOW OBJECT OBJNUM(save) ENABLED
</PRE>   ENDIF

<P><LI>Add a "Next" button (called next) that will move the record pointer to
   the next record when clicked.
<P>
   * next when clause
   IF m.fieldname &lt;&gt; old_fieldname
<P><PRE>      =MsgBox("You must Save","ALERT",0)
      SHOW OBJECT OBJNUM(save) ENABLED
      SHOW OBJECT OBJNUM(next) DISABLED
      _CUROBJ=OBJNUM(save)
</PRE>   ENDIF
<P>
   * next valid clause
   SKIP
   m.fieldname = table.fieldname
   old_fieldname = m.fieldname
   SHOW OBJECT OBJNUM(save) DISABLED
   SHOW GETS

<P><LI>Add a "Save" button (called save) that will write the GET field to the
   table only if the content of the GET object has changed, when the Save
   button is clicked.
<P>
   * save when clause
   SHOW OBJECT OBJNUM(next) DISABLED
<P>
   * valid clause
   SHOW OBJECT OBJNUM(next) ENABLED
   SHOW OBJECT OBJNUM(save) DISABLED
   REPLACE tablename.fieldname WITH m.fieldname
   old_fieldname = m.fieldname
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
