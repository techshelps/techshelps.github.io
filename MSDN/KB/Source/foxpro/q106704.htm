

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: General Protection Fault When Using FOXTOOLS.FLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106704">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/11/14">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A general protection (GP) fault occurs when you are using FOXTOOLS.FLL.  CAUSE =====  RegFn() or CallFn() is incorrectly declared. The argument type and return argument type must be the same; otherwise, a general protection (GP) fault may possibly ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QDL9,QBWO,QBWN,QAY5,QBKN,QAHE,QAPN,QAJ6,QAJQ,QBWQ,QBV8,QAB9,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: General Protection Fault When Using FOXTOOLS.FLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106704</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A general protection (GP) fault occurs when you are using
FOXTOOLS.FLL.
<P>
<P><h2>CAUSE</h2>
 
<P>
RegFn() or CallFn() is incorrectly declared. The argument type and
return argument type must be the same; otherwise, a general
protection (GP) fault may possibly occur.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make the argument type and return argument type the same. For example,
the following function is incorrectly declared:
<P>
<PRE>   SET LIBRARY TO SYS(2004)+'FOXTOOLS.FLL'
   x=REGFN('GetDriveType','I','C')
   y=CALLFN(x,1)

</PRE>To correct the problem, modify the function as follows:
<P>
<PRE>   SET LIBRARY TO SYS(2004)+'FOXTOOLS.FLL'
   x=REGFN('GetDriveType','I','I')
   y=CALLFN(x,1)

</PRE><h2>MORE INFORMATION</h2>
 
<P>
FOXTOOLS.FLL is a library that is supplied with FoxPro for Windows.
FOXTOOLS.FLL allows FoxPro programs to call any Windows DLL functions
that meet the following requirements:

<OL><P><LI>Take the following arguments: integer, long, float, double,
   string/buffer. These can be passed by reference or by value.

<P><LI>Return the following types: integer, long, float, double,
   string/buffer. These are returned by value only.
<P>
</OL>Two FLL functions are used provide this functionality:
<P>
<PRE>   RegFn() - registers a function and the arguments it takes
   CallFn() - calls a registered function

</PRE></OL>RegFn() and CallFn() have the following syntax:
<P>
<PRE>   RegFn(FunctionName, ArgTypes, ReturnType, DLLName) returns FnHandle

   CallFN(FnHandle, Arg1, Arg2, ....) returns a value

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Windows Software Development Kit (SDK), "Programmer's
Reference, Volume 2: Functions," pages 350-354, 785
<P>
FOXTOOLS.WRI located in the C:\FOXPROW\GOODIES\FOXTOOLS subdirectory
<P>
WINDOWS.H located in the C:\C700\INCLUDE subdirectory
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b FOXTOOLS GPF dynamic<BR>
link library API application programming interface<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
