

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: TYPE Function Does Not Indicate Character(Binary) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157194">
<META NAME="KBModify" CONTENT="1996/10/29">
<META NAME="KBCreate" CONTENT="1996/10/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The TYPE() function does not differentiate between Character and Character(binary) or Memo and Memo(binary) field types. The Type() function simply returns a  C  or an  M,  respectively.  WORKAROUND  Use the AFIELDS() function to create an array th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAVW,QAVX,QAP2,QAB9,QAY5,QAH4,QBV8,QAWP,QBVV,QAUD,QADF,QBFY,QAWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: TYPE Function Does Not Indicate Character(Binary)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157194</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The TYPE() function does not differentiate between Character and
Character(binary) or Memo and Memo(binary) field types. The Type() function
simply returns a "C" or an "M," respectively.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use the AFIELDS() function to create an array that contains information on
each field in the table. The procedure listed below, bin_fld, contains code
that determines whether a character or memo field is binary. Before
executing this code, issue the CREATE TABLE syntax provided in step 1 of
the "Steps To Reproduce Behavior" section below.

<OL><P><LI>Create a program called Test that contains the following code:
<P>
   **** Begin Program Example ****
   PROC bin_fld
   PARAMETER a
   IF TYPE(a)= "C" OR TYPE(a) ="M"
<PRE>         =AFIELDS(test)
         IF ASCAN(test,UPPER(a)) &gt; 0
            fldtype=ASCAN(test,UPPER(a))+1
               IF test(ASCAN(test,UPPER(a))+5)=.T.
                  retvalu= "Field Type: "+ test[fldtype]+ " Binary"
               ELSE
                  retvalu= "Field Type: "+ test[fldtype]+ ' Not Binary'
               ENDIF
         ENDIF
   ELSE
         retvalu= TYPE(a)
   ENDIF
   RETURN retvalu
   **** End program example ****

</PRE><P><LI>Type "SET PROCEDURE TO Test" (without quotes) in the Command window.

<P><LI>Type "? Bin_fld("memo1")" (without quotes) in the Command window.
<P>
</OL>The values returned from the bin_fld procedure for character and memo
fields indicate not only the field's type but also whether the field is
binary.
<P>
The AFIELDS() function creates an array with specific information on each
field in a chosen table. For example, the sixth element of the array
created by the AFIELDS() function shows whether code page translation is
allowed. This field contain a true (.T.) or false (.F.) value. If this
element contains a true value in a Character or Memo field type, the field
is binary. The TYPE() command handles any other field types. Entry of a
nonexistent field name produces a "U," indicating undefined.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Character(Binary) or Memo (Binary) are not separate data types, as are
Date, Currency, or Numeric types. The Binary versions of these fields
prevent the field from conversion into another code page.
<P>
The NOCPTRANS clause on the CREATE TABLE or ALTER TABLE commands creates a
binary Character or Memo field. This clause prevents a Character or Memo
field from being translated into another code page. Since the NOCPTRANS
clause works only on character or memo fields, these are the only field
types in Visual FoxPro that can be either binary or non-binary. Some
fields, however, are binary by design, such as Integer and General types.
Therefore, the TYPE() function provides adequate information.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In the Command window, type the following command as one line:
<P>
<P><PRE>      CREATE TABLE Test (char1 C(10), char2 C(10) NOCPTRANS, memo1 M(4),
      memo2 M(4) NOCPTRANS)
</PRE>
<P><LI>Type the following four lines in the Command window:
<P>
<P><PRE>      ? TYPE("char1")
      ? TYPE("char2")
      ? TYPE("memo1")
      ? TYPE("memo2")
</PRE><P>
</OL>The commands all return either "C" or "M" depending on the field type
without indicating whether or not it is binary.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgTable<BR>
Additional reference words: 5.00 kbdsd VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
