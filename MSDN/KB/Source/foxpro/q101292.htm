

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create a WordPerfect Merge File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101292">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/07/11">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  WordPerfect secondary merge files use specific codes to separate data items. Because these codes differ from the standard delimiters used in text files, you must use FoxPro's low-level file functions to create the file with the appropriate codes.  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QBEQ,QAUD,QAH4,QBWS,QAGX,QATX,QAMB,QA2Q,QAY2,QATZ,QATY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a WordPerfect Merge File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101292</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
WordPerfect secondary merge files use specific codes to separate data
items. Because these codes differ from the standard delimiters used in
text files, you must use FoxPro's low-level file functions to create
the file with the appropriate codes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>File Conversions</h3>
 
<P>
WordPerfect 6.0 for MS-DOS:
<P>
In WordPerfect 6.0 for MS-DOS, when prompted, choose one of the following
two conversions:

<UL><LI>ASCII text (Standard)
<LI>ASCII text (CR/LF to SRt)
<P>
</UL>NOTE: If you create your WordPerfect merge file in FoxPro for Windows and
then import it into WordPerfect for MS-DOS, you may see control characters.
<P>
WordPerfect 5.2 for Windows:
<P>
When you import data from FoxPro for Windows into WordPerfect 5.2 for
Windows, you will be asked to convert the file format when you choose Open
from the File menu. Choose any of the ANSI options for Windows:

<UL><LI>ANSI Text (Windows)
<LI>ANSI Delimited Text (Windows)
<LI>ANSI Text CR/LF to SRt (Windows)
<P>
</UL>NOTE: If you try to import the file from FoxPro for Windows as an ASCII
file, you will see double-headed vertical arrows and spade characters. Use
ANSI when using the Windows products.
<P>
<P><h3>Cross-Platform Program</h3>
 
<P>
The following program is provided as an example of using FoxPro's low-level
file functions to create a WordPerfect merge file.
<P>
<PRE>   *     WPMRG.PRG - Creates a WordPerfect merge file.
   *     Pass it the database name and output filename.
   *     This procedure uses database fields
   *     FNAME, LNAME, ADDRESS, CITY, STATE, and ZIP.
   *     It returns a negative number if an error occurs;
   *     otherwise, it returns a 1.

   PARA fil_name, out_file
   IF USED(fil_name)
      m.env=SELECT()
      m.dbf_open=.F.
      SELECT (fil_name)
   ELSE
      IF FILE(ALLTRIM(fil_name)+".DBF")
         m.env=SELECT()
         m.dbf_open=.T.
         SELECT 0
         USE (fil_name)
      ELSE
         reason="            NO INPUT FILE!"
         DO NOTIFY WITH reason
         RETURN -1
      ENDIF
   ENDIF

   handle=FCREATE(out_file)
   IF handle&lt;0
      DO CASE
      CASE FERROR()=4
         reason="CAN'T CREATE FILE - OUT OF FILE HANDLES"
      CASE FERROR()=5
         reason="CAN'T CREATE FILE - ACCESS DENIED"
      CASE FERROR()=8
         reason="CAN'T CREATE FILE - OUT OF MEMORY"
      CASE FERROR()=29
         reason="CAN'T CREATE FILE - DISK FULL"
      CASE FERROR()=31
         reason="CAN'T CREATE FILE - GENERAL FAILURE"
      ENDCASE
      DO NOTIFY WITH reason
      RETURN -2
   ELSE
      SCAN
         alldata=ALLTRIM(fname)+" "+ALLTRIM(lname)+CHR(18)+ ;
            ALLTRIM(address)+CHR(18)+ALLTRIM(city)+CHR(18)+ ;

         ALLTRIM(state)+CHR(18)+ALLTRIM(zip)+CHR(18)+CHR(5)+CHR(12)
         =FWRITE(handle,alldata)
         =FSEEK(handle,0,2)
      ENDSCAN
      =FCLOSE(handle)
   ENDIF
   SELECT (m.env)
   IF m.dbf_open
      USE
   ENDIF
   RETURN 1     &amp;&amp; End of main procedure

   PROCEDURE NOTIFY
   PARAMETER reason
   DEFINE WIND alert FROM 7,17 TO 12,60 DOUBLE COLOR SCHEME 7
   ACTIVATE WIND alert
   @1,7 SAY "UNABLE TO CREATE FILE"
   @2,7 SAY reason
   @3,7 SAY "PRESS A KEY TO EXIT"
   =INKEY(0)
   DEACTIVATE WIND alert
   CANCEL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxDos FoxWin 2.00 2.50 2.50a WP<BR>
WPD WPW SIX.0<BR>
merge<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxinteropWordproc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
