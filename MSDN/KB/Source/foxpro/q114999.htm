

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Creators and Types Are Reset After Transport to Macintosh </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114999">
<META NAME="KBModify" CONTENT="1996/06/03">
<META NAME="KBCreate" CONTENT="1994/05/18">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After you have transported an application from FoxPro for Windows or FoxPro for MS-DOS to FoxPro for Macintosh, the icons, file types, and creators appear to be incorrect for all the files in the application.  NOTE: This behavior does not occur und...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGX,QAH4,QDO9,QAFI,QAN0,QAP2,QAJH,QA2S,QASC,QAPF,QAH6,QABB,QBXS,QART,QAOG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Creators and Types Are Reset After Transport to Macintosh</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114999</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you have transported an application from FoxPro for Windows or FoxPro
for MS-DOS to FoxPro for Macintosh, the icons, file types, and creators
appear to be incorrect for all the files in the application.
<P>
NOTE: This behavior does not occur under Visual FoxPro for Macintosh.
<P>
<P><h2>CAUSE</h2>
 
<P>
The creator, type, and subsequent icon are determined by the application
that created the file on the Macintosh. When an application is transported,
the creator may become Apple File Exchange or another program instead of
FoxPro for Macintosh.
<P>
However, using the code example below, you can programmatically change the
creator and type for an entire folder of files at a time.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following program will change all files with standard FoxPro
extensions, within a single folder, to a creator of "FOXX". Files without
standard FoxPro extensions will be ignored.
<P>
The code example below uses the FxSetType() function in FOXTOOLS.MLB to
change the creator and type for the files. The SYS(2027) syntax returns the
filenames in Macintosh notation. Both FxFileType() and FxSetType() require
the filename to be specified in Macintosh notation.
<P>
<PRE>   *********************************************************************
   * Begin Code Example
   * Variables used
   * dochange        Logical     Flag to indicate whether to change
   * filetype        Character   New type of file
   * filecreator     Character   FOXX as new creator type
   * i               Numeric     Counter for FOR loop
   * filearray       Array       File information for folder
   * searchfld       Character   Name of folder to search
   * fileext         Character   File extension for comparison
   *********************************************************************

   SET LIBRARY TO foxtools
   filetype = ""
   filecreator = "FOXX"
   dochange = .T.
   searchfld = ""
   fileext = ""

   * Obtain folder name
   searchfld = GETDIR("Folder to search")

   * Create array of filenames in folder
   =ADIR(filearray,searchfld + "*.*")

   * Replace filename if necessary
   FOR i = 1 TO ALEN(filearray,1)
      fileext = RIGHT(filearray(i,1),4)
      dochange = .T.
      DO CASE
         CASE fileext = ".FPT"
         * FoxPro Memo file
              filetype = "F+DT"
         CASE fileext = ".DBF"
         * DBF file
              filetype = "F+DB"
         CASE fileext = ".SCX"
         * screen file
              filetype = "F+FR"
         CASE fileext = ".SCT"
         * screen memo file
              filetype = "FSCT"
         CASE fileext = ".FRX"
              filetype = "F+RP"
         * Report File
         CASE fileext = ".FRT"
              filetype = "FFRT"
         * report memo file
         CASE fileext = ".MNX"
              filetype = "FMNX"
         * menu file
         CASE fileext = ".MNT"
         * menu memo file
              filetype = "FMNX"
         CASE fileext = ".PJX"
         * project file
              filetype = "FPJX"
         CASE fileext = ".PJT"
         * project memo file
              filetype = "FPJT"
         CASE fileext = ".CDX"
         * compound index file
              filetype = "FCDX"
         CASE fileext = ".PRG"
         * program source code
              filetype = "F+PR"
         CASE fileext = ".FXP"
         * compiled .PRG
              filetype = "FFXP"
         CASE fileext = ".QPR"
         * Query program
              filetype = "F+QU"
         CASE fileext = ".APP"
         * compiled application
              filetype = "FAPP"
         CASE fileext = ".SPX"
         * compiled screen program
              filetype = "FSPX"
         CASE fileext = ".MPX"
         * compiled menu program
              filetype = "FMPX"
         OTHERWISE
              dochange = .F.
      ENDCASE
      IF dochange = ;
         FxSetType(SYS(2027,searchfld+filearray(i,1)), ;
               filetype,filecreator)
      ENDIF
   ENDFOR

   * End Code Example
   ************************************************************************

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about FOXTOOLS.MLB, see the FoxTools ReadMe file in
the GOODIES:MISC folder.
<P>
"Developer's Guide," version 2.5b, pages 402-403
<P>
"Language Reference," version 2.5b, pages 868-869
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac 2.50b 2.50c<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
