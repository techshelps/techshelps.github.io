

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: DBF() &amp; RECCOUNT() Return Wrong Info About SQL Cursor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117265">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/06/23">
<META NAME="Keywords" CONTENT="FxprgGeneral kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the RECCOUNT() or DBF() functions against a cursor returns information pertinent to the source data file instead of the currently selected cursor.  CAUSE =====  If a WHERE clause is used that references a field that is used as a key field in ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QA5V,QAB9,QAO2,QBE7,QBE6,QA2Q,QBV8,QDI1,QAZZ,QALW,QAEF,QAG2,QBDM,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: DBF() &amp; RECCOUNT() Return Wrong Info About SQL Cursor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117265</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.6x | 2.5x 2.6x
<PRE>WINDOWS   | MS-DOS
</PRE>kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the RECCOUNT() or DBF() functions against a cursor returns
information pertinent to the source data file instead of the currently
selected cursor.
<P>
<P><h2>CAUSE</h2>
 
<P>
If a WHERE clause is used that references a field that is used as a key
field in a .CDX index tag, the DBF() and RECCOUNT() functions will return
data about the source data file instead of the cursor. This is because, in
this case, the SQL-SELECT performs a SET FILTER on the current table, and
returns the filtered information. Use the _TALLY variable to return the
number of records processed by the SQL-SELECT command.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This behavior will occur regardless of the status of the SET ORDER command.
However, this behavior does NOT occur under Microsoft Windows NT.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
In the steps below, you will be using the CUSTOMER database (which contains
500 records) in the TUTORIAL subdirectory. Make certain that the .CDX file
is active, and that it includes a tag built on CNO.

<OL><P><LI>In the Command window, issue the following commands:
<P>
<P><PRE>      CLEAR ALL
      USE &lt;FoxPro_directory&gt;\tutorial\customer.dbf
      SELECT * FROM customer WHERE customer.cno = 'A'
</PRE><P>
   Note that 29 records are selected.

<P><LI>In the Command window, issue the following command:
<P>
<P><PRE>      ? DBF()
</PRE><P>
   Note that it returns the name of the source file, not the temporary
   cursor name.

<P><LI>In the Command window, issue the following command:
<P>
<P><PRE>      ? RECCOUNT()
</PRE><P>
</OL>Note that the RECCOUNT() of the source file, not the cursor, is returned.
Note also that the status bar shows 500 records in the cursor even though
the SELECT command reported that only 29 records were selected.
<P>
For comparison, do the following:

<OL><P><LI>In the Command window, issue the following command:
<P>
<P><PRE>      CLEAR ALL
</PRE>
<P><LI>Remove the tag on the CNO field.

<P><LI>Repeat steps 1-3 above, but change the SELECT statement to:
<P>
<P><PRE>      SELECT * FROM customer WHERE customer.cno = 'A'
</PRE><P>
</OL>Note that the SELECT statement returns 29 records, ? DBF() returns the name
of the temporary file (cursor), and ? RECCOUNT() returns 29.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin fixlist3.00 FoxDos FoxWin 2.50 2.50a<BR>
2.50b 2.60 2.60a buglist2.50 buglist2.50a buglist2.50b buglist2.60<BR>
buglist2.60a<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FxprgGeneral<BR>
Keywords          : FxprgGeneral kbbuglist kbprg<BR>
Version           : 2.5x 2.6x | 2.5x 2.6x<BR>
Platform          : MS-DOS WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
