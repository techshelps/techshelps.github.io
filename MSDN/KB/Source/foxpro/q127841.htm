

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Multiuser Updates Do Not Flush Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127841">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/03/19">
<META NAME="Keywords" CONTENT="FxprgMultiuser kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After you use the REPLACE or UPDATE commands in a multiuser environment, the modified records are not written back to the .DBF file correctly.  RESOLUTION  Perform one of the following to work around this problem:   - Use the FLUSH command immediat...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAJZ,QBXS,QBFD,QA5V,QAKJ,QAJQ,QBVV,QAR4,QALQ,QAC1,QBV8,QAB9,QDI1,QBD2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Multiuser Updates Do Not Flush Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127841</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50 2.50a 2.50b 2.60 2.60a
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you use the REPLACE or UPDATE commands in a multiuser environment,
the modified records are not written back to the .DBF file correctly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Perform one of the following to work around this problem:

<UL><LI>Use the FLUSH command immediately after the REPLACE or UPDATE command
   to write all buffers to the .DBF file.
<P>
   -or-

<LI>Keep a BROWSE window open at all times on one of computers that has the
   multiuser table open. A BROWSE window kept open all the time causes
   FoxPro to write back its buffers after the interval set by the SET
   REFRESH command.
<P>
   -or-

<LI>Use the REPLACE ALL command only when a .DBF file is opened in exclusive
   mode.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Visual FoxPro 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This problem does not occur in FoxPro for MS-DOS.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
CAUTION: Performing these steps changes all records of the CUSTOMER.DBF
table located in the TUTORIAL subdirectory.

<OL><P><LI>Start two instances of FoxPro on the same or different computers. If
   both instances are on the same computer, arrange the screen so you can
   see both instances at the same time.

<P><LI>In the first instance, type the following in the Command window:
<P>
   SET EXCLUSIVE OFF
   SET REFRESH TO 1,1
   USE SYS(2004)+"\Tutorial\Customer"
   BROWSE

<P><LI>In second instance, type the following in the Command window, but do not
   perform a BROWSE.
<P>
   SET EXCLUSIVE OFF
   SET REFRESH TO 1,1
   USE SYS(2004)+"\Tutorial\Customer"
   REPLACE ALL contact WITH "Test"
<P>
</OL>Notice that only the first record in the BROWSE window of the first
instance has changed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: Fixlist3.00 vFoxwin 2.50 2.50a 2.50b 2.60 2.60a<BR>
FoxWin buglist2.50 buglist2.50a buglist2.50b buglist2.60 buglist2.60a<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxprgMultiuser<BR>
Keywords          : FxprgMultiuser kbbuglist kbfixlist kbprg<BR>
Version           : 2.50 2.50a 2.50b 2.60 2.60a<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
