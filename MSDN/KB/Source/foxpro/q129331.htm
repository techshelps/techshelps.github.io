

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Preserve Index Expressions to Rebuild CDX and Tags </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129331">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/24">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Often, a utility menu is included in an application that enables the user to perform functions such as reindexing or backing up files. One very useful function to include on such a utility menu is a way to recreate the .CDX file with all of the tag...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QAB9,QBWA,QAMB,QAKD,QACI,QBFY,QBCU,QA2Q,QAY5,QAY4,QAH4,QBWS,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Preserve Index Expressions to Rebuild CDX and Tags</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
<LI>Microsoft FoxPro for UNIX, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Often, a utility menu is included in an application that enables the user
to perform functions such as reindexing or backing up files. One very
useful function to include on such a utility menu is a way to recreate the
.CDX file with all of the tags rebuilt programatically. This keeps the .CDX
file in optimum condition if done routinely. This article shows by example
how to do this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You first need to store the tag names and index expressions in a utility
table. Then you need some code to read the utility file that will use the
values to reindex the table.
<P>
<P><h3>Sample Code</h3>
 
<P>
The following sample code uses the tutorial table CUSTOMER.DBF to
demonstrate how to create a utility file, read it, and use the values to
reproduce the .CDX file.
<P>
* Make the CDX Expression table.
<P>
CREATE TABLE cdxexp ;
<PRE>   (TAG C(10),expression C(254))

</PRE>* Insert three index expressions into the table.
* Below is a simple index expression on one field.
<P>
INSERT INTO cdxexp ;
<PRE>   (TAG,expression) ;
   VALUES ;
   ("COMPANY","company")

</PRE>* Below is a concantenated index expression.
<P>
INSERT INTO cdxexp ;
<PRE>   (TAG,expression) ;
   VALUES ;
   ("STATE_CO","ALLTRIM(UPPER(state))+ALLTRIM(company)")

</PRE>* Below is a complex index expression that correctly orders a numeric
* field concantenated with a character field. Indexing on the STR() of
* a numeric alone will yield incorrect ordinal values of the numeric
* field. This expression uses PADL and ALLTRIM with STR to put the
* numeric characters into the correct location in the string.
<P>
INSERT INTO cdxexp ;
<PRE>   (TAG,expression) ;
   VALUES ;
   ("YTDP_ST","PADL(ALLTRIM(STR(ytdpurch,20,2)),20,'0') + ;
   ALLTRIM(UPPER(state))")

</PRE>* Use the library FoxTools for the MessageBox function.
<P>
SET LIBRARY TO foxtools
SET DEFAULT TO c:\fpw26a\tutorial
<P>
* Delete the current CDX file in order to rewrite the header.
<P>
IF USED('CUSTOMER')
<PRE>   SELECT CUSTOMER
   USE
</PRE>ENDIF
DELETE TAG ALL
<P>
* Open the table to reindex (CUSTOMER.DBF) in the second Workarea.
<P>
SELECT B
USE C:\FPW26A\TUTORIAL\CUSTOMER
<P>
* Call the MsgBox function from FoxTools with "Yes/No" buttons, option 4.
* The MsgBox function will need to be replaced with a GET object for
* versions other than Windows.
<P>
msg="Ready to rebuild the CDX file?"
answer=MSGBOX(msg,"",4)
<P>
* If the user clicks the Yes button, the return value will be 6.
<P>
IF answer=6
<PRE>   SELECT A                  &amp;&amp; index expression file called "cdxexp"
   GO TOP
   DO WHILE NOT EOF()        &amp;&amp; process the whole file
      mtag=cdxexp.tag        &amp;&amp; read the values from the record
      mexp=cdxexp.expression
      SELECT B
      INDEX ON &amp;mexp TAG &amp;mtag   &amp;&amp; index on the variable expressions
      SELECT A
      SKIP                   &amp;&amp; go to the next record
   ENDDO
</PRE>ENDIF
<P>
* End of program.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin FoxDos FoxMac FoxUnix 2.50<BR>
2.50a 2.50b<BR>
2.50c 2.60 2.60a<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
