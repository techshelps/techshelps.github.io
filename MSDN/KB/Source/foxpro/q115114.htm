

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Different ON BAR Behavior in FoxPro for MS-DOS &amp; Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115114">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/05/18">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The ON BAR command has been enhanced in FoxPro version 2.6 to ensure compatibility with other xBase languages. However, the behavior of this command differs between FoxPro for MS-DOS and FoxPro for Windows.  MORE INFORMATION  In versions 2.0 and 2....">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAF0,QANS,QAGB,QDL9,QBWQ,QBWO,QBWN,QADN,QACF,QAB9,QAFX,QAY5,QAH4,QBWR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Different ON BAR Behavior in FoxPro for MS-DOS &amp; Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115114</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
<PRE>  - Microsoft FoxPro for Windows, version 2.6
  - Microsoft FoxPro for MS-DOS, version 2.6
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ON BAR command has been enhanced in FoxPro version 2.6 to ensure
compatibility with other xBase languages. However, the behavior of this
command differs between FoxPro for MS-DOS and FoxPro for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In versions 2.0 and 2.5 of FoxPro, the ON BAR command is used only to
activate a second popup when a menu bar is chosen. In version 2.6, this
command has been enhanced to execute a procedure upon movement to a menu
bar. A new command, ON EXIT BAR, has been added to execute a procedure upon
movement from a menu bar.
<P>
In FoxPro for MS-DOS, the ON BAR command will work with the system menu,
_MSYSMENU, or a user-defined menu. In FoxPro for Windows, the ON BAR
command will work only with a user-defined menu. The ON BAR command will be
ignored in FoxPro for Windows if it is used with the system menu.
<P>
This behavior is by design. When you are using _MSYSMENU in FoxPro for
Windows, Windows is in control of the menu, instead of FoxPro. Altering the
behavior of the system menu could cause adverse consequences, including
crashing Windows entirely.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following code example illustrates the different behavior of ON BAR
when it is run in FoxPro for Windows and FoxPro for MS-DOS. To quit the
program, press F8.
<P>
<PRE>   * Begin Code Example
   ON KEY LABEL f8 DO getout

   ***********************************************
   * Redefine system menu to use an ON BAR routine
   ***********************************************

   SET SYSMENU TO
      DEFINE PAD p1 OF _msysmenu PROMPT "p1"
      ON PAD p1 OF _msysmenu ACTIVATE POPUP pp1
      DEFINE POPUP pp1
      DEFINE BAR 1 OF pp1 PROMPT "b1"
      DEFINE BAR 2 OF pp1 PROMPT "b2"
      ON BAR 1 OF pp1 WAIT WINDOW  "on bar 1 of system menu"
      ON BAR 2 OF pp1 WAIT WINDOW  "on bar 2 of system menu"
      ON EXIT BAR 1 OF pp1 WAIT WINDOW  "on exit bar 1 in sysmenu"
      ON EXIT BAR 2 OF pp1 WAIT WINDOW  "on exit bar 2 in sysmenu"
   WAIT WINDOW "Now using ON BAR in _MSYSMENU"
   ACTIVATE MENU _msysmenu

   *****************************************************
   * Define a user-defined menu to use an ON BAR routine
   *****************************************************

   SET SYSMENU TO DEFAULT
   DEFINE MENU main
      DEFINE PAD p1 OF main PROMPT "p1"
      ON PAD p1 OF main ACTIVATE POPUP pp1
      DEFINE POPUP pp1
      DEFINE BAR 1 OF pp1 PROMPT "b1 of user menu"
      DEFINE BAR 2 OF pp1 PROMPT "b2 of user menu"
      ON BAR 1 OF pp1 WAIT WINDOW  "on bar 1"
      ON BAR 2 OF pp1 WAIT WINDOW  "on bar 2"
      ON EXIT BAR 1 OF pp1 WAIT WINDOW  "on exit bar 1 in user menu"
      ON EXIT BAR 2 OF pp1 WAIT WINDOW  "on exit bar 2 in user menu"
   WAIT WINDOW "Now using ON BAR in user defined menu"
   ACTIVATE MENU main

   **************************************************
   * Procedure to cancel menu using F8 key
   **************************************************

   PROCEDURE getout
      DEACTIVATE MENU main
      ACTIVATE MENU _msysmenu

   * End Code Example

</PRE>Note that the cursor does not highlight a menu bar until the ON BAR command
has been executed. Likewise, the cursor does not highlight the next menu
bar until the ON EXIT BAR command has been executed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.60<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
