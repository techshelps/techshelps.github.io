

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Fill a Combo Box with a Unique List of Items </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136640">
<META NAME="KBModify" CONTENT="1995/09/13">
<META NAME="KBCreate" CONTENT="1995/09/12">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To have a combo box display unique values from a field of a database that contains multiple occurrences of each of those values, use the DisplayValue property in combination with the ListIndex property of the combo box.  MORE INFORMATION  Placing a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAH4,QAE1,QAKH,QAKD,QBV3,QBCF,QA7O,QA7N,QBWC,QBXN,QAUJ,QAO4,QAHH,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Fill a Combo Box with a Unique List of Items</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136640</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To have a combo box display unique values from a field of a database that
contains multiple occurrences of each of those values, use the DisplayValue
property in combination with the ListIndex property of the combo box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Placing a string in the combo box DisplayValue property automatically sets
the combo box ListIndex property to zero (0) if no match is found or to the
index position of a matching string within the created list. Therefore, you
can loop through until the ListIndex property is 0, and then add the new
list item by using the AddItem method. By using a SCAN...ENDSCAN looping
structure, you can create a completely unique list as the following example
code illustrates.
<P>
<P><h3>Sample Code</h3>
 
<P>
Place the following code in the combo box Init event to create a unique
list of the &lt;field name&gt; contents before displaying the combo box:
<P>
<PRE>   * Init Code
   SCAN
      THIS.DISPLAYVALUE = &lt;field name&gt;
      IF THIS.LISTINDEX = 0      &amp;&amp; not already in the list
         THIS.ADDITEM(&lt;field name&gt;)
      ENDIF
   ENDSCAN
   THISFORM.REFRESH

</PRE>If a new item is typed into the combo box, it must be verified as unique
before being added to the current list. To force the ListIndex property to
change automatically, add the following code to the Valid event procedure
of the combo box:
<P>
<PRE>   * Valid Code
   THIS.VALUE = THIS.DISPLAYVALUE
   IF THIS.LISTINDEX = 0      &amp;&amp; Not already in the list
      THIS.ADDITEM(THIS.VALUE)
      THIS.DISPLAYVALUE = THIS.VALUE
   ENDIF

</PRE>The code assigns the DisplayValue property to the Value property for the
combo box. Then it checks the value of ListIndex. If ListIndex is 0, the
item is added as before. When this comparison is made, the DisplayValue
property loses its contents, so the Value property is reassigned to the
DisplayValue property in the IF...ENDIF structure.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
