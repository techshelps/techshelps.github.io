

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Visual FoxPro Automation Servers and Active Server Pages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168053">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1997/05/05">
<META NAME="Keywords" CONTENT="FxinteropOle vfoxwin kbinterop kbtool kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Microsoft Internet Information Server (IIS) 3.0 supports Active Server Pages (ASP). ASPs allow you to perform server-side processing and scripting through the use of automation servers, including automation servers that were created in Visual FoxPr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2K,QA56,QA55,QAUD,QBWA,QA62,QDNQ,QBVX,QACE,QAA1,QAU3,QAMR,QAGI,QAFH,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Visual FoxPro Automation Servers and Active Server Pages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168053</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Internet Information Server (IIS) 3.0 supports Active Server
Pages (ASP). ASPs allow you to perform server-side processing and scripting
through the use of automation servers, including automation servers that
were created in Visual FoxPro 5.0. This article demonstrates how to use a
Visual FoxPro automation server with Active Server Pages.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are primarily two components:

<UL><LI>Visual FoxPro Automation Server.

<LI>Active Server Page that instantiates the server.
<P>
</UL><h3>The Visual FoxPro Automation Server</h3>
 
<P>
For this example, you can create a simple automation server in Visual
FoxPro. This automation server has two methods: one called GetTime(), which
will return the current time and one called GetDate(), which will return
the current date.
<P>
Creating the automation server:

<OL><P><LI>Create a new project named ASPSrv in Visual FoxPro.

<P><LI>Add a new program to the project with the following code:
<P>
<PRE>        DEFINE CLASS WristWatch AS Custom OLEPUBLIC

      PROCEDURE GetTime()
         RETURN Time()
      ENDPROC

      PROCEDURE GetDate()
         RETURN Date()
      ENDPROC

        ENDDEFINE

</PRE><P><LI>Build the project into an OLE DLL automation server.

<P><LI>Install the automation server onto your IIS 3.0 server.
<P>
   NOTE: It is recommended that you use the Setup Wizard in Visual FoxPro
   as a distribution method. Files that will be included for distribution
   are the Visual FoxPro runtime, the OLE server .DLL, .TLB, and .VBR
   files.
<P>
</OL><h3>The Active Server Page</h3>
 
<P>
The ASP file is the component that instantiates the automation server and
calls the methods of the automation server.

<OL><P><LI>Create the following file in a text editor, such as Notepad:
<P>
<P><PRE>     &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
     &lt;!-- Ensure that there is a space before LANGUAGE and
<PRE></PRE>          after "VBSCRIPT" --&gt;
     &lt;HTML&gt;
     &lt;HEAD&gt;
     &lt;TITLE&gt; VFP and ASP &lt;/TITLE&gt;
     &lt;/HEAD&gt;

     &lt;BODY&gt;
     &lt;H2&gt;Active Server Pages and Visual FoxPro Automation Servers&lt;/H2&gt;

     &lt;%Set VFPSrv = Server.CreateObject("ASPSrv.WristWatch")%&gt;

     Today's Date is &lt;%=VFPSrv.GetDate()%&gt;
     &lt;P&gt;
     The Current Time is &lt;%=VFPSrv.GetTime()%&gt;

     &lt;/BODY&gt;
     &lt;/HTML&gt;

</PRE><P><LI>Save this file to your IIS WWWROOT directory as VFPSrv.ASP, and make
   certain that this directory has Execute privileges.

<P><LI>You should now be able to access this Active Server Page from your Web
   browser. The page should show the current date and time from the server.
</OL> 
<PRE>Keywords          : FxinteropOle vfoxwin kbinterop kbtool kbhowto
Technology        : kbole
Version           : 5.0 5.0a
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
