

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: LCK Functions Do Not Work in a Private Data Session </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180903">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1998/02/11">
<META NAME="Keywords" CONTENT="FxprgGeneral FxtoolLck vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  An ActiveX control (.ocx) has been written in Visual C++ that also makes use of the Visual FoxPro Library Construction Kit (LCK) functions. The control may work properly on forms that use the default DataSession but the control fails when the form ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QAY5,QA7O,QAB5,QAOE,QAMN,QAHV,QBHQ,QAGI,QBV8,QAB9,QBW7,QAI5,QAK7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: LCK Functions Do Not Work in a Private Data Session</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180903</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An ActiveX control (.ocx) has been written in Visual C++ that also makes
use of the Visual FoxPro Library Construction Kit (LCK) functions. The
control may work properly on forms that use the default DataSession but the
control fails when the form uses a private DataSession.
<P>
<P><h2>CAUSE</h2>
 
<P>
Library Construction Kit function calls do not occur in the DataSession
context of the form that made the call to the .ocx. There is only one
global context in which the Library Construction Kit function can call into
Visual FoxPro, no matter where the call originated.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If a private DataSession is necessary, write the ActiveX control completely
in Visual C++ or Visual Basic and expose properties and methods that can be
accessed by Visual FoxPro.
<P>
If it is absolutely necessary to use some of the Visual FoxPro LCK
functions in an .ocx that will access tables in a private DataSession, it
may be possible to get the .ocx to work by making the private DataSession
the active DataSession by using the SET DATASESSION TO &lt;nDataSessionNumber&gt;
command. However, this approach is not recommended. Writing the
functionality into the control with another language is a better solution.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
FoxPro and Visual FoxPro have included the Library Construction Kit for
many versions. The Library Construction Kit functions allow developers to
write libraries in C that can be loaded by FoxPro or Visual FoxPro to
extend its functionality by accessing the FoxPro API. Starting with Visual
FoxPro version 5.0, the Developer's Guide has included information to help
developers get a start on creating ActiveX controls to access the Visual
FoxPro API. ActiveX controls can make use of the LCK functions if used
within the global context of Visual FoxPro.
<P>
Library Construction Kit functions that access tables that may be open in
private DataSessions, such as _DBRead and the other _DBxxxx functions,
_Load, _FindMemo and _FindVar, are some of the functions to avoid in
ActiveX controls that need to work in private DataSessions. However,
depending on what the ActiveX control does and how it does it, other LCK
functions may also fail in private DataSessions. A good test is to try the
control in the default DataSession. If it works there and not a private
DataSession, this article probably applies.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Visual FoxPro "Developer's Guide," version 5.0, pages 645-647.
<P>
Examples.dbf located in the \API\Samples folder of Visual FoxPro.
<P>
Microsoft Visual FoxPro Help: Library Construction Kit.
<P>
 
<PRE>Keywords          : FxprgGeneral FxtoolLck vfoxwin
Version           : WINDOWS:5.0,5.0a
Platform          : WINDOWS
Issue type        : kbprb
Solution Type     : kbnofix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
