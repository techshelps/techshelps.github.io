

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Record validation rule is violated" Error in a Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137682">
<META NAME="KBModify" CONTENT="1995/10/15">
<META NAME="KBCreate" CONTENT="1995/10/03">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Moving off a record that has row-level validation and invalid entries causes the form to produce this error message:     Record validation rule is violated  CAUSE =====  Issuing a SKIP or SKIP-1 while positioned on a record that has invalid entries...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QACI,QAH4,QA5V,QAPN,QBJZ,QAKR,QA2Q,QAZV,QAPF,QAO4,QANF,QAMB,QAG9,QABH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Record validation rule is violated" Error in a Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 15, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137682</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moving off a record that has row-level validation and invalid entries
causes the form to produce this error message:
<P>
<PRE>   Record validation rule is violated

</PRE><h2>CAUSE</h2>
 
<P>
Issuing a SKIP or SKIP-1 while positioned on a record that has invalid
entries fires an implicit TABLEUPDATE() function call, which tries to write
your invalid data to the table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Incorporate buffering in the form, and control the use of the TABLEUPDATE()
function and navigation buttons. For example, remove the asterisk from the
code in steps 7 and 12 in the "Steps to Reproduce Behavior" section of this
article to resolve the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to create a form that appends a record to a table
using a row-level validation rule entered in the Table Designer.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>On the File menu, click New. Then select the Table check box, and click
   New File. Create a new Table called Table1 that has this structure:
<P>
<PRE>   Field Name   Type       Width
   -----------------------------
   FLD1         Character  10
   FLD2         Character  10

</PRE><P><LI>On the File menu, click New. Select the Database check box, and click
   New File. Create a new Database called Data1. Right-click inside the
   gray DataBase Designer window. Click Add Table, and select Table1.

<P><LI>Right-click Table1, which was just added to the database, and click
   Modify. Click the Table Properties button located in the top-right
   corner of the Table Designer dialog box. In the Validation Rule field,
   type ! EMPTY(fld1). In the Validation Text field, type: "FLD1 must have
   a value."

<P><LI>Click OK, and then click OK in the Table Designer dialog box. Click Yes
   to make structure changes permanent. Double-click the top-left corner of
   the DataBase Designer window to close it.

<P><LI>On the File menu, click New, select the Form check box, and then click
   New File. Right-click the form, and then click Data Environment.
   Right-click the gray Data Environment window, click Add. Then in the Add
   Table or View dialog box, click Other, and then select Table1.dbf.

<P><LI>When the table has been added to the data environment, drag both fields
   from the data environment onto the form. Double-click the top-left
   corner of the gray Data Environment window to close it.

<P><LI>Double-click the form, and place the following code in the form's
   Activate event:
<P>
   APPEND BLANK
   * THISFORM.Command1.Enabled=.F.
   * THISFORM.Command2.Enabled=.F.
   * THISFORM.Command3.Enabled=.F.
   OPEN DATABASE data1.dbc EXCLUSIVE

<P><LI>Place the following code in the form's Load event:
<P>
   SET MULTILOCKS ON
   =CURSORSETPROP("Buffering",2)

<P><LI>Place first of four command buttons (Command1) on the form. Set its
   Caption property to Next, and place the following code in its Click
   event:
<P>
   SKIP
   THISFORM.Refresh

<P><LI>Place another command button (Command2) on the form. Set its Caption
<P><PRE>    property to Previous, and place the following code in its Click event:
</PRE><P>
<P><PRE>    SKIP -1
    THISFORM.Refresh
</PRE>
<P><LI>Place a third command button (Command3) on the form. Set its Caption
<P><PRE>    property to Quit, and place the following code in its Click event:
</PRE><P>
<P><PRE>    RELEASE THISFORM
</PRE>
<P><LI>Place a fourth command button (Command4) on the form. Set its Caption
<P><PRE>    property to Write, and place the following code in its Click event:
</PRE><P>
<P><PRE>    lsuccess=TABLEUPDATE(.T.)
    IF ! lsuccess
       =AERROR(aErrors)
       DO CASE
<PRE></PRE>          CASE aErrors[1,1] = 1583
             SELECT table1
             cRuleText=dbgetprop("table1","TABLE","RuleText")
             =MESSAGEBOX(cRuleText,48)
       ENDCASE
    ELSE
       *   THISFORM.Command1.Enabled=.T.
       *   THISFORM.Command2.Enabled=.T.
       *   THISFORM.Command3.Enabled=.T.
    ENDIF

</PRE><P><LI>Run the form, and click the Previous button.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q129537.htm">Q129537</A></B>
   TITLE     : APPEND BLANK Fires Field-Level Validation
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgMultiuser<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 15, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
