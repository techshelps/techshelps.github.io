

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Clicking Scroll Bar in Grid Writes Data to Wrong Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139196">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b fixlist5.00 FxotherGeneral vfoxwin kbbugfix kbbuglist kbui">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you create an edit box in a grid column, enter data in that edit box, and then click the scroll bar of the grid without exiting the edit box, any of the following may occur:   - Data may be written to the wrong record.  - Data may be lost.  - Re...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QAHP,QA5V,QA7O,QAO4,QBXQ,QARR,QAYY,QA7N,QAPN,QAAP,QBWS,QAR4,QDMH,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Clicking Scroll Bar in Grid Writes Data to Wrong Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139196</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbui kbbuglist kbbugfix
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create an edit box in a grid column, enter data in that edit box,
and then click the scroll bar of the grid without exiting the edit box, any
of the following may occur:

<UL><LI>Data may be written to the wrong record.
<LI>Data may be lost.
<LI>Record locking errors may occur.
<LI>Data may be truncated.
<P>
</UL><h2>CAUSE</h2>
 
<P>
The edit box does not close automatically when it loses the focus to the
scroll bar. In some cases, it acts as if it were never open. In other
cases, it acts as if it were open on the record to which the record pointer
moved. Odd behavior may occur if the control source of the edit box is set
to either a character field or a memo field. These behaviors do not occur
if you click another cell in the grid or click an object outside the grid.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Trap for the MouseDown event while in the edit box. This can be done by
placing the following code in the MouseDown event of the grid, which fires
before the Scroll event fires:
<P>
<PRE>   IF this.activecolumn = 2    &amp;&amp; or whatever column the edit box is in
      keyboard '{TAB}'         &amp;&amp; or SHIFT-TAB
   ENDIF

</PRE>This forces the edit box to close properly before the scroll can be run.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a table called Test, and give it a memo field and a text field.

<P><LI>Append a few blank records to the table.

<P><LI>Create a new form, and add the table to the form's data environment.

<P><LI>Drag the table from the data environment onto the form to create a grid.

<P><LI>In the grid, set column one's ControlSource property to the text field
   of the table, and set column two's ControlSource property to the memo
   field of the table.

<P><LI>Create an edit box for column two, and make the edit box the active
   control.

<P><LI>Run the form, and edit or add data to the edit box. Then click the
   scroll bar without using the TAB key to move out of the edit box. At
   this point, the data may be written to the wrong record, or it may not
   be written to any record. Scroll through the edit box controls to see
   where the data was written. You may receive a record locking error when
   you click the record that seems to have received the data. These
   behaviors do not occur in every single instance nor do all of them
   occur together.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbui kbbuglist kbbugfix<BR>
KBSubcategory: FxotherGeneral VFoxWin buglist3.00 buglist3.00b fixlist5.00<BR>
Additional reference words: 3.00 3.00b vfp scrollbar<BR>
Keywords          : buglist3.00 buglist3.00b fixlist5.00 FxotherGeneral vfoxwin kbbugfix kbbuglist kbui<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
