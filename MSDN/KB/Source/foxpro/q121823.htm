

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: RUN Command Won't Work with Variables Prefixed with "M." </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121823">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/10/19">
<META NAME="Keywords" CONTENT="kbprg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Attempting to use a variable with an  M.  prefix doesn't work when you use the variable and macro substitution in conjunction with the RUN command.  CAUSE =====  In FoxPro, the period is used as the macro termination character when used in combinat...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAB9,QAUD,QBWS,QBV8,QAH4,QAUJ,QAY5,QAGI,QAG0,QA5E,QATX,QAB4,QDKW,QAVI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: RUN Command Won't Work with Variables Prefixed with "M."</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121823</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to use a variable with an "M." prefix doesn't work when you use
the variable and macro substitution in conjunction with the RUN command.
<P>
<P><h2>CAUSE</h2>
 
<P>
In FoxPro, the period is used as the macro termination character when used
in combination with literal strings. FoxPro sees the "M." in the variable
name as indicating a request to expand the contents of a variable called M
and concatenate it with the rest of the string it follows. Because there is
no variable named M, the command fails.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When a macro directly precedes a literal string, use the terminator. If you
don't, the evaluator attempts to look for a variable name matching the
characters between the ampersand and the first character that would be
invalid in a variable name, such as a space or a quotation mark.
<P>
To work around this behavior, declare a working variable as PRIVATE within
your procedure or function that executes the RUN command and use an
indirect approach to achieve the same result. The following code
demonstrates this:
<P>
<PRE>   PROCEDURE MYPROC
   PRIVATE TOBERUN

   TOBERUN = M.SOMEVAR
   RUN &amp;TOBERUN

</PRE>STATUS
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To demonstrate this behavior, create a batch file called A.BAT in the
FoxPro directory. Then type the following in the command window:
<P>
<PRE>   TOBERUN = "A.BAT" &lt;Enter&gt;
   RUN &amp;TOBERUN &lt;Enter&gt;

</PRE>This command will work as expected. Now, modify the variable assignment by
typing the following:
<P>
<PRE>   M.TOBERUN = "A.BAT" &lt;Enter&gt;
   RUN &amp;M.TOBERUN &lt;Enter&gt;

</PRE>MS-DOS returns the error message, "Bad command or file name," and the batch
file fails to execute.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a 2.50b 2.50c 2.60<BR>
2.60a<BR>
memory variables m. prefix<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: FxprgMacrosub<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
