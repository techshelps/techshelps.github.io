

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: TabIndex Setting Does Not Activate Selected Form First </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134312">
<META NAME="KBModify" CONTENT="1995/08/04">
<META NAME="KBCreate" CONTENT="1995/08/03">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Setting the TabIndex property of a form within a formset changes the activation order of the forms. However, the first form added to the formset will always be activated first although its TabIndex property is set to a value other than one.  The Ta...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBXS,QAI2,QAR4,QAH4,QBWC,QDNY,QABA,QBVV,QAY5,QBWS,QBJZ,QBXT,QBAO,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: TabIndex Setting Does Not Activate Selected Form First</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 4, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134312</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Setting the TabIndex property of a form within a formset changes the
activation order of the forms. However, the first form added to the formset
will always be activated first although its TabIndex property is set to a
value other than one.
<P>
The TabIndex property of a form within a formset can be used to determine
the activation order of forms within a formset. By default, the first form
added in a formset is activated first, the second form added is activated
second, and so on. By changing around the TabIndex properties for all the
forms within a formset, the activation order is changed and the form which
has a TabIndex property of 1, is expected to be activated first.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
By incorporating a few changes in the formset, it is possible to have the
correct form be activated as the first form within a formset. Using the
formset configuration as described below in the "More Information" section,
the following changes correct the behavior.
<P>
<P><h3>Steps to Follow to Correct Behavior</h3>
 

<OL><P><LI>Create a new property for the formset called FirstTime.

<P><LI>In the Init method of the formset, add the following line of code:
<P>
   FirstTime=.T.

<P><LI>In the Activate method of Form1 of the formset (Form1 is the first form
   added to the formset), add the following lines of code:
<P>
   IF thisformset.firsttime=.T.
<P><PRE>      NODEFAULT
      ThisFormSet.FirstTime=.F.
      ThisFormSet.Form4.Command1.SetFocus
</PRE>   ENDIF
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following formset configuration illustrates resetting the TabIndex
property does not result in the desired form being activated first.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>On the File menu, click New. Then click Form and New File.

<P><LI>On the Form menu, click Create Form Set.

<P><LI>On the Form menu, click Add New Form three times. Form4 is the last form
   added to the formset.

<P><LI>Change the TabIndex property of each form as follows:
<P>
   Form1 (TabIndex Property set to 2)
   Form2 (TabIndex Property set to 4)
   Form3 (TabIndex Property remains at 3)
   Form4 (TabIndex Property set to 1)

<P><LI>Add a command button to each form.

<P><LI>In the click method of Form1, add the following line of code:
<P>
   ThisFormset.Release

<P><LI>Run the formset, and note that Form4 is not the first form activated as
   expected. However, the forms do cycle in their TabIndex order from that
   point on.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 4, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
