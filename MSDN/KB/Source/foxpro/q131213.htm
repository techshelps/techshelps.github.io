

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Grid Behavior Isn't Consistent w/ that of List/Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131213">
<META NAME="KBModify" CONTENT="1998/01/08">
<META NAME="KBCreate" CONTENT="1995/06/05">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b FxtoolFormdes VFoxMac vfoxwin kbtool kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Visual FoxPro allows list boxes, combo boxes, and grids within a form to be based on the output of a query (.QPR) file. The list box and combo box controls support a Requery method that causes the query to be updated. The grid does not support a Re...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QARR,QAPN,QAH4,QBXS,QAY5,QAE1,QAXB,QAUY,QABA,QAYY,QBV8,QAB9,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Grid Behavior Isn't Consistent w/ that of List/Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131213</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Visual FoxPro allows list boxes, combo boxes, and grids within a form to be
based on the output of a query (.QPR) file. The list box and combo box
controls support a Requery method that causes the query to be updated. The
grid does not support a Requery method to update the results of a query.
Therefore, if the list box or combo box and the grid are populated with the
results of the QPR file, the grid looses its data when the Requery method
is used on the list box or combo box.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Set the RecordSource of the grid back to itself as shown in the code below:
<P>
<PRE>   Thisform.Grid1.RecordSource = Thisform.Grid1.RecordSource

</PRE>NOTE: By changing the RecordSource of the grid, all the properties of the
grid and its columns are set back to their default. Please follow the
workaround listed in the REFERENCES section of this article if custom
properties of the grid need to be saved.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the C:\Vfp\Samples\Mainsamp\Data\Tastrade.dbc database.

<P><LI>Create a new form named Frmmyfrm.

<P><LI>Add a list box to the form. Set the following properties in the
   properties sheet:
<P>
<P><PRE>      List1.RowSourceType = 4 (QPR)
      List1.RowSource = qryTest.qpr
</PRE>
<P><LI>Add a grid to the form. Set the following properties in the properties
   sheet:
<P>
<P><PRE>      Grid1.RecordSourceType = 3 (QPR)
      Grid1.RecordSource = qryTest.qpr
</PRE>
<P><LI>Add two command buttons to the form. Set the caption of the first button
   to "List Requery", and the caption of the second to "Grid RecordSource".

<P><LI>Add the following code to the Click event of the List Requery command
   button:
<P>
<P><PRE>      Thisform.List1.Requery()
</PRE>
<P><LI>Add the following code to the Click event of the Grid RecordSource
   command button:
<P>
<P><PRE>      Thisform.Grid1.RecordSource = Thisform.Grid1.RecordSource
</PRE>
<P><LI>Close and save the form. Create a new program file with the following
   code. Save this file as Qrytest.qpr (be sure to add the .QPR extension)
   and close the file.
<P>
<P><PRE>      SELECT contact_name, customer_id FROM customer INTO CURSOR curTest
</PRE>
<P><LI>Enter the following command in the FoxPro Command window:
<P>
<P><PRE>       DO FORM frmmyfrm
</PRE><P>

<P><LI>Click the List Requery button and note that the data in the grid
   disappears. Click the Grid RecordSource button and the data reappears.
<P>
   NOTE: Do not base your grid on a .QPR file if the data in the grid needs
   to be modified. Data created with a .QPR file is read-only. Creating a
   view would be a better alternative if data needs to be modified. This
   requires setting the RecordSourceType of the grid to "2 - Alias" and the
   RecordSource to the name of the view. The data in the grid could then be
   refreshed using the REQUERY() function. This is a Visual FoxPro function
   that can be issued on a command line by itself. The function should be
   preceded by an equal sign, as in the following example, to update the
   view with new data:
<P><PRE>       
<PRE></PRE>          =REQUERY()

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Visual FoxPro Developer’s Guide, Chapter 8
<P>
For more information on this topic, please see the following article in the
Microsoft Knowledge Base:
<PRE>       
   ARTICLE-ID:  <B><A HREF="../FOXPRO/Q140653.htm">Q140653</A></B>
   TITLE     :  Cursor-Based Grid Goes Blank If SQL SELECT Resets Cursor

</PRE> 
<PRE>Keywords          : buglist3.00 buglist3.00b FxtoolFormdes VFoxMac vfoxwin kbtool kbbuglist
Version           : 3.0 3.0b
Platform          : MACINTOSH WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
