

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: LUPDATE() Does Not Report Correct Century for Year 2000 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176481">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1997/11/07">
<META NAME="Keywords" CONTENT="FoxDos FoxMac FoxUnix FoxWin FxenvGeneral FxprgTable VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you use SET CENTURY ON with a computer that has the system date set to the year 2000 and a modification is made to the structure of a table (.dbf) file, or a copy of the table file is made, the LUPDATE() function incorrectly displays the centu...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAML,QAY5,QACE,QAXB,QAC1,QBV8,QAB9,QBD2,QAUD,QBVV,QAR4,QAAP,QBXS,QDO9,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: LUPDATE() Does Not Report Correct Century for Year 2000</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176481</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft FoxPro for Windows, versions 2.6, 2.6a
<LI>Microsoft FoxPro for MS-DOS, versions 2.6, 2.6a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
<LI>Microsoft FoxPro for UNIX, version 2.6
<LI>Microsoft FoxBASE+ for MS-DOS, version 2.1
<LI>Microsoft FoxBASE+ for Macintosh, version 2.01
<LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use SET CENTURY ON with a computer that has the system date set to
the year 2000 and a modification is made to the structure of a table (.dbf)
file, or a copy of the table file is made, the LUPDATE() function
incorrectly displays the century as 1900.
<P>
<P><h2>CAUSE</h2>
 
<P>
The date of the last update is stored in the header of the .dbf file. The
LUPDATE() function reads the date of last update from the header of the
.dbf file. This problem is caused by the manner in which FoxPro writes the
date into the table's file header.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Here are two workarounds:

<UL><LI>Use the FDATE() function to obtain the correct date. With SET CENTURY
   ON, this function returns the correct year.
<P>
 -or-

<LI>Create a program subroutine with the ADIR() function to obtain the file
   date parameter as illustrated by the following program code:
<P>
<P><PRE>      SET CENTURY ON
      =ADIR(afileinfo, "CUSTOMER.DBF")
      x = afileinfo(1, 3)
      ? x
</PRE><P>
</UL>NOTE: Because FoxBase does not support either the FDATE() or ADIR()
function, these workarounds do not apply to FoxBase.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The LUPDATE() function returns the date of the last update to the table in
the currently selected work area or in a specified work area. The "last
updated" date and time are not updated by the operating system until the
file is closed. When you close a modified table, FoxPro writes the current
system date of the computer into the header of the table file.
<P>
With a network, there is no guarantee that all the computers have a
synchronized date and time. If the LUPDATE() function makes it appear that
the table has not been updated today and then new information is entered
into the table, you could be overwriting new data entered from a computer
that has the wrong system date.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Change the computer's system date to 02/01/2000 (the specific date is
   not critical as long as the year is 2000 or higher).

<P><LI>In the FoxPro Command window, type the following without the comments:
<P>
<P><PRE>      SET CENTURY ON
<PRE></PRE>      USE &lt;tablename&gt;     &amp;&amp; Name of the table.
      ?LUPDATE()          &amp;&amp; Checks the current value of the last updated
                          &amp;&amp; date.
      APPEND BLANK        &amp;&amp; Appends a blank record to the table.
      USE                 &amp;&amp; This closes the table.
      USE &lt;tablename&gt;     &amp;&amp; Open the table again.
      ?LUPDATE()          &amp;&amp; Check the last updated date again.

   An incorrect answer is returned: 02/01/1900.

</PRE></OL>NOTE: Remember to reset your computer system date back to today's date.
(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Perry
Newton, Microsoft Corporation
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the LUPDATE(), FDATE(), and ADIR() functions,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q130165.htm">Q130165</A></B>
   TITLE     : PRB: LUPDATE() Does Not Return Date of Last Update

   ARTICLE-ID: <B><A HREF="../FOXPRO/Q113943.htm">Q113943</A></B>
   TITLE     : New and Enhanced Commands and Functions in FoxPro Ver 2.6

   ARTICLE-ID: <B><A HREF="../FOXPRO/Q100554.htm">Q100554</A></B>
   TITLE     : Using ADIR() Function to Obtain MS-DOS File Information

</PRE>Microsoft FoxPro Help, "LUPDATE() Function"
Microsoft FoxPro Help, "FDATE() Function"
Microsoft FoxPro Help, "ADIR() Function"
<P>
Additional query words
 
<PRE>Keywords          : FoxDos FoxMac FoxUnix FoxWin FxenvGeneral FxprgTable VFoxMac vfoxwin
Version           : MACINTOSH:2.01,2.6a,3.0b; MS-DOS:2.1,2.6,2.6a; UNIX:2.6; WINDOWS:2.6,2.6a,3.0,3.0b,5.0,5.0a
Platform          : MACINTOSH MS-DOS UNIX WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
