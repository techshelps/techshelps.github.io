

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Restart the Macintosh from Within FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140694">
<META NAME="KBModify" CONTENT="1996/06/01">
<META NAME="KBCreate" CONTENT="1995/12/05">
<META NAME="Keywords" CONTENT="kbinterop kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In some cases, you may need to provide a FoxPro application with the ability to restart the computer. FoxPro doesn't have the capability to do this directly, so it needs to call functions at the operating system level.  On the Macintosh, this can b...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QDK2,QAIJ,QAY2,QAXB,QDO9,QAGI,QAH4,QDKA,QBWS,QBSO,QAJQ,QAIF,QBV8,QBHQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Restart the Macintosh from Within FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140694</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, versions 2.5b, 2.5c, 2.6a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In some cases, you may need to provide a FoxPro application with the
ability to restart the computer. FoxPro doesn't have the capability to do
this directly, so it needs to call functions at the operating system level.
<P>
On the Macintosh, this can be done with either Apple Script commands or by
using C code in a shared library (MLB) or external command (XCMD).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method One</h3>
 

<OL><P><LI>Launch the Script Editor, which is an Apple application used to create
   scripts. Type the following in the script:
<P>
   Tell application "Finder"
<P><PRE>      restart
</PRE>   End tell

<P><LI>Save the script in your Microsoft FoxPro folder as RestartMe.

<P><LI>Call the script from within FoxPro with this command:
<P>
   RUNSCRIPT "MyHardDrive:Microsoft FoxPro 2.6:restartme"
<P>
   This does the same thing as clicking Restart on the Special menu.

<P><LI>To turn off the Macintosh from within FoxPro, use these commands:
<P>
   Tell application "Finder"
<P><PRE>      shutdown
</PRE>   End tell
<P>
</OL><h3>Method Two</h3>
 
<P>
You can get similar performance from an XCMD or from an MLB that calls
routines in the Shutdown Manager (in particular ShutDwnStart() to restart,
and ShutDwnPower() to shut down the machine).
<P>
The following C code can be used to create an MLB that can be called from
within FoxPro:
<P>
<PRE>#include &lt;pro_ext.h&gt;
#include &lt;shutdown.h&gt;

void FAR goodbye( ParamBlk FAR *parm )
</PRE></OL>{
<PRE>     ShutDwnStart();
</PRE>}
<P>
FoxInfo myFoxInfo[]={
<PRE>     {"GOODBYE", (FPFI) goodbye, 0, ""}
</PRE>};
<P>
FoxTable _FoxTable={
<PRE>     (FoxTable FAR *) 0,
     sizeof(myFoxInfo) / sizeof(FoxInfo),
     myFoxInfo
</PRE>};
<P>
Once this is created, placed in a Shared Library such as Restart.mlb, and
saved to the Extensions Folder in the System Folder, it can be called with
the following code in FoxPro:
<P>
<PRE>   SET LIBRARY TO restart.mlb
   =goodbye()

</PRE>NOTE: Under Windows, you can co this with the ExitWindows API as referenced
in the the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q109607.htm">Q109607</A></B>
   TITLE     : How to Reboot the System from Within FoxPro

   ARTICLE-ID: <B><A HREF="../FOXPRO/Q110254.htm">Q110254</A></B>
   TITLE     : How to Restart Windows from Within FoxPro
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxMac 3.00b 2.50b 2.50c 2.60a FoxMac MAC<BR>
shutdown shut down<BR>
KBCategory: kbinterop kbhowto kbcode<BR>
KBSubcategory: FxinteropGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
