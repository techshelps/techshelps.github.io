

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Easily Give a Screen Its Own User-Defined Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123157">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/11/22">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to create a screen and give it an active menu while also keeping the main system menu active. For example, the Trace window has its own menu and is active while the main FoxPro system menu is active.  MORE INFORMAT...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAF0,QBWR,QAA8,QAO2,QAUJ,QBXT,QA5V,QAPF,QANE,QAIB,QAFR,QABG,QBXS,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Easily Give a Screen Its Own User-Defined Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123157</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for MS-DOS, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, version 2.5x, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to create a screen and give it an active
menu while also keeping the main system menu active. For example, the Trace
window has its own menu and is active while the main FoxPro system menu is
active.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For information about how to attach a menu to a Visual FoxPro 3.0 form,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q135517.htm">Q135517</A></B>
   TITLE     : How to Attach a Menu to a Form

</PRE><h3>FoxPro 2.x Instructions</h3>
 
<P>
You could create a menu to be included with a screen by hand coding the
menu. But it is easier to use FoxPro's menu generator to generate menu
code. Then you can identify and copy the appropriate sections of generated
code (.MPR), and paste these sections into the screen code (.SCX).
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a screen file, and give the screen a name in the screen layout.

<P><LI>Create a menu to go with the screen by using the menu builder. Then
   generate it by using the menu generator.

<P><LI>Create a #SECTION2 in the setup code of the screen. On the last line of
   the Setup snippet of your screen, type in the following:
<P>
   #SECTION2

<P><LI>Copy the "Menu Definitions" section of the generated menu file (the .MPR
   file) to the line below the #SECTION2 section created in the previous
   step. But do not copy any of the menu procedure code; this code will be
   placed in the cleanup code of the screen.

<P><LI>Copy the menu procedures labeled on the selection bar to the screen
   cleanup and procedures section of the screen. From this point on all
   reference in this article to menu code will refer to the menu code
   copied to the screen (.SCX) file.

<P><LI>In the menu code, replace the first line (SET SYSMENU TO) with "define
   menu &lt;menu name&gt; in window &lt;screen name&gt;" where menu name is any name
   you want and screen name is the name you gave the screen in the screen
   layout dialog box.
<P>
   For example, if the menu generator generated the following first two
   lines of code:
<P>
<P><PRE>      SET SYSMENU TO
      SET SYSMENU AUTOMATIC
</PRE><P>
   Replace the above lines with the following;
<P>
<P><PRE>      SET SYSMENU AUTOMATIC
      DEFINE MENU mymenu IN WINDOW test
</PRE>
<P><LI>In the menu code, replace all occurrences of _MSYSMENU with your menu
   name. For example, one line of the menu code might look like this:
<P>
<P><PRE>      DEFINE PAD _qt00iyosr OF _MSYSMENU PROMPT "file" COLOR SCHEME 3
</PRE><P>
   Change the _MSYSMENU to your menu name (for example, mymenu):
<P>
<P><PRE>      DEFINE PAD _qt00iyosr OF mymenu PROMPT "file" COLOR SCHEME 3
</PRE>
<P><LI>Change the following lines:
<P>
<P><PRE>      ON SELECTION BAR 1 OF file ;
<PRE></PRE>                   DO _qt00iyovc ;
                   IN LOCFILE(...

   To this:

      ON SELECTION BAR 1 OF file ;
                   DO _qt00iyovc

</PRE><P><LI>Add the following line to the ON WINDOW ACTIVATE clause of the screen
   code:
<P>
   ACTIVATE MENU mymenu NOWAIT

<P><LI>Generate the screen code, and execute the .SPR file.
<P>
</OL>NOTE:  The menu created in the above example isn't a true system menu, so
the menu does not look or behave exactly like a system menu. For example,
if you select a menu pad you must execute "DEACTIVATE POPUP padname" to
close up the pad. Clicking with the mouse off the menu pad will not
deactivate the menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos FoxMac 2.50 2.50a 2.50b 2.50c<BR>
2.60 2.60a<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolMBuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
