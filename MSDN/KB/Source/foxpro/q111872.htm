

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Character Field Transferred to Microsoft Excel as Numeric </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111872">
<META NAME="KBModify" CONTENT="1995/06/26">
<META NAME="KBCreate" CONTENT="1994/02/22">
<META NAME="Keywords" CONTENT="kbinterop kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A FoxPro character type field that contains numbers is converted to a numeric field in Microsoft Excel when the FoxPro dynamic data exchange (DDE) functions are used.  RESOLUTION  To avoid this situation, do one of the following:   - Add a single q...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA7N,QA7O,QA50,QBUG,QBUF,QAB9,QA6A,QAK9,QABC,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Character Field Transferred to Microsoft Excel as Numeric</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111872</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A FoxPro character type field that contains numbers is converted to a
numeric field in Microsoft Excel when the FoxPro dynamic data exchange
(DDE) functions are used.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this situation, do one of the following:

<UL><LI>Add a single quotation mark to the beginning of the field; for example:
<P>
<P><PRE>      =DDEPOKE(mchan,"R1C1","'"+fld1)
</PRE><P>
   NOTE: This method will transfer the FLD1 field as character but will add
   an additional single quotation mark toward the beginning of the field.
   This extra quotation mark can be removed manually or with the help of a
   Microsoft Excel macro.
<P>
   -or-

<LI>Add '="' to the beginning of the field and '"' to the end; for example:
<P>
<P><PRE>      =DDEPOKE(CHAN,"R1C1",'="'+fld1+'"')
</PRE><P>
   With this method, Microsoft Excel will treat the contents of FLD1 as an
   expression.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open Microsoft Excel with Sheet1 as the active worksheet.

<P><LI>Open FoxPro for Windows and issue the following commands from the
   Command window:
<P>
<P><PRE>      CREATE TABLE xddetst.dbf (fld1 C(8))
      APPEND BLANK
      REPLACE fld1 WITH "12345678"
      mchan = DDEINITIATE("EXCEL","SHEET1")
      =DDEPOKE(mchan,"R1C1",fld1)
</PRE><P>
   With the above DDEPOKE() command FoxPro will send the FLD1 field
   contents to cell A1 in Sheet1 of Microsoft Excel.

<P><LI>Press ALT+TAB to switch to Microsoft Excel. Here you will see that the
   contents of FLD1 were transferred to cell A1 in Sheet1 as a numeric
   field.
<P>
</OL>In Microsoft Excel, to enter a number, string, or formula as text, you have
to prefix the data with a single quotation mark. If you select cell A1, you
will see that the Formula Bar does not display a single quotation mark
before the cell's contents.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b number format
<P>

KBCategory: kbinterop kbprg<BR>
KBSubcategory: FxinteropDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
