

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: COUNT TO Can't Count Parent Records in One-to-Many Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124386">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/12/29">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The COUNT TO command does not return a true count of records when tables are set up in a one-to-many relationship (one parent record to many child records) because it can't exclude the child records.  WORKAROUND  There are several possible workarou...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAG8,QDMH,QAB9,QBXS,QBV8,QAKC,QAPN,QBC6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: COUNT TO Can't Count Parent Records in One-to-Many Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124386</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The COUNT TO command does not return a true count of records when tables
are set up in a one-to-many relationship (one parent record to many child
records) because it can't exclude the child records.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are several possible workarounds for this situation. The first, and
perhaps the best, alternative is to use an SQL SELECT command with a WHERE
clause on the table that has the records you want to count. Here's an
example:
<P>
<PRE>   SELECT * FROM INVOICES WHERE CNO = CUSTOMER.CNO INTO CURSOR TEMP

</PRE>Once the information is in the cursor TEMP, you can derive the total number
of records that met the WHERE clause condition by checking the _TALLY
variable. _TALLY holds the number of records returned by the SQL SELECT
statement.
<P>
As an alternative, you can determine how many parent records meet the FOR
clause by using the SET SKIP TO command to break the one-to-many
relationship before executing the COUNT TO command. After you get the
count, re-establish the relationship.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
According to Help in FoxPro for Windows, the COUNT TO command:
<P>
<PRE>   ... counts the records within a scope of records for which
   the FOR or WHILE conditions are true. If SET TALK is ON, the
   record count is displayed in this form

   nnnnnn records

   Records marked for deletion are included in the count if SET
   DELETED is OFF.

</PRE>The COUNT TO command supports a FOR clause to limit the scope of records
counted. If the command includes a scope clause, it will only operate on
the table in the active work area. However, if that table is engaged in a
one-to-many relationship (one parent record to many child records), the
COUNT TO command can't count just the parent records because the child
records are part of the active work area scope.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create and run a program containing this code:
<P>
CLOSE ALL
SET SAFETY OFF
USE SYS(2004)+"\Tutorial\Customer" IN 1
USE SYS(2004)+"\Tutorial\Invoices" IN 2
SELECT 2
INDEX ON cno TAG cno ADDITIVE
SET ORDER TO TAG cno OF SYS(2004)+"\tutorial\invoices.cdx"
SELECT 1
SET RELATION TO cno INTO invoices ADDITIVE
SET SKIP TO invoices
DEFINE WINDOW browwin FROM 0,0 TO 20,70
MOVE WINDOW browwin CENTER
BROWSE WINDOW browwin NOWAIT
LOCATE FOR customer.cno = "A2695"
IF (FOUND())
<PRE>   WAIT WINDOW "Found record ok."
</PRE>ENDIF
COUNT TO myvar FOR customer.cno = "A2695"
LOCATE FOR customer.cno = "A2695"
WAIT WINDOW "COUNT shows " + ALLTRIM(STR(myvar))+" records for A2695"
<P>
The COUNT TO command reports that there are five records in the parent
table that meet the FOR clause, not one, which is really the case. The
COUNT TO command includes the child records that are displayed in the one-
to-many relationship in the parent table. While the number returned
is, in fact, valid for the number of records in the child table, it is not
valid for the number of records in the parent table.
<P>
NOTE: If you use the COUNT TO command to find out how many child records
each parent has, the number returned by the COUNT TO command will be valid
only if there are two or more child records. In a one-to-many relationship,
FoxPro doesn't show a single child record in the parent table. As a result,
you can't use COUNT TO to determine if there is one and only one child
record for any given parent.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60a COUNT TO SUM<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
