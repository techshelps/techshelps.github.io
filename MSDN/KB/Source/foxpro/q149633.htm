

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Automate a Word Mail Merge with Applescript </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149633">
<META NAME="KBModify" CONTENT="1996/04/08">
<META NAME="KBCreate" CONTENT="1996/04/08">
<META NAME="Keywords" CONTENT="kbinterop kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article shows by example how to automate a Microsoft Word for Macintosh mail merge that relies on FoxPro for the data. An AppleScript program does a FoxPro SQL select and calls Word to perform the merge using an existing form letter. The Scrip...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAIH,QALI,QDME,QBTO,QBWS,QAH4,QALS,QAUR,QA2Q,QDO9,QAU7,QAYV,QAG2,QDO7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Automate a Word Mail Merge with Applescript</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149633</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Macintosh, version 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to automate a Microsoft Word for
Macintosh mail merge that relies on FoxPro for the data. An AppleScript
program does a FoxPro SQL select and calls Word to perform the merge using
an existing form letter. The Script is run by double-clicking its icon if
it is saved as a runtime script.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example</h3>
 
<P>
Use the Customer database, and make the selection criteria a state. The
form letter is an invitation to a demo and uses the fields contact,
company, address, city, state, and zip as follows:
<P>
<PRE>   Microsoft Macintosh Group
   Jan 2,1996

   &lt;COMPANY&gt;
   &lt;ADDRESS&gt;
   &lt;CITY&gt;,    &lt;STATE&gt;  &lt;ZIP&gt;

   Dear &lt;CONTACT&gt;,

   Please come to see us at our new show room. On Mondays, Wednesdays, and
   Fridays, we will be doing demos on the AppleScript Advantage.

   Yours truly,

   John Smith

</PRE><h3>Step-by-Step Procedure</h3>
 
<P>
Create a form letter using Word and save it as a mail_merge_doc in the
Macintosh HD:Microsoft FoxPro 2.6:Tutorial folder. Use the saved name in
the following script:

<OL><P><LI>On the Tools menu, select Mail Merge. (For instructions on how to set
   up a mail merge, see Word Help.)

<P><LI>In the Mail Merge dialog box, click Open Data Source to open a table.
   If tables do not display when FoxPro/dBase is selected under List Files
   of Type, choose All Files, and select a table. Once a data source is
   selected, two new buttons appear in Word. Use the Insert Merge Field
   button to place fields in the document. (See the note at the end of this
   article before closing the form letter or Word.)

<P><LI>Using the Script Editor, create the following AppleScript program:
<P>
   NOTE: In the following code, the semicolon is used as a line
   continuation character. This is not the line continuation character in
   AppleScript which you create by pressing the option key and the return
   key. The &amp; is the concatenation symbol. (*  *) and -- indicate comments.
   The "do Script" command executes FoxPro or Word commands from
   AppleScript.
<P>
   AppleScript Program
   -------------------
<P>
   set state to text returned of ;
<P><PRE>    (display dialog "What state would you like to print" default answer "";
<PRE></PRE>         buttons {"OK"})

   (* When the dialog window displays, enter a state abbreviation. The
      state variable will contain the results *)

   tell application "Microsoft FoxPro"
   Activate
   Do Script "SET SAFETY OFF"
   Do Script "SET DEFAULT TO 'Macintosh HD:Microsoft FoxPro 2.6:Tutorial'"
     Do Script ;
         "SELECT contact,company,address,city,state,zip FROM customer
               WHERE state='" &amp; state &amp; "' INTO TABLE
              ' Macintosh HD:Microsoft FoxPro 2.6:Tutorial:Mailinglist'"

   (* When writing this code in AppleScript, all three of the previous
      lines must be on a single line. Continuation characters cannot be
      placed in the middle of a command string following a do script. *)

     Do Script "USE"          --close mailinglist.dbf so Word can open it.
     Do Script "SELECT customer"
     Do Script "USE"
   end tell

   tell application "Microsoft Word"
     Activate
     open file "Macintosh HD:Microsoft FoxPro 2.6:Tutorial:mail_merge_doc"

   (* The previous line opens the Word mail merge document *)

     do script "MailMergeToDoc"       --issue Word's mail merge command
     activate
   end tell

</PRE></OL>If saved as a runtime script, this code can be run by double-clicking
its icon without opening the Script Editor. If saved as a compiled script,
it can be run from the Script Editor.
<P>
NOTE: The code does not close the Word document. The table produced by the
FoxPro select statement is Mailinglist.dbf. When prompted to save the .dbf
document in Word, choose no. Choosing yes creates a Word document that can
no longer be opened in FoxPro. For more information about this, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q142795.htm">Q142795</A></B>
   TITLE     : PRB: FoxPro DBF Opened/Saved by MacWord Alters File Type
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.60a FoxMac<BR>
KBCategory: kbinterop kbhowto<BR>
KBSubcategory: FxotherGeneral
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
