

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Data Type Mismatch Error with Combo Box or List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156550">
<META NAME="KBModify" CONTENT="1997/01/10">
<META NAME="KBCreate" CONTENT="1996/09/25">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Setting the ControlSource property of a combo or list box to a Date type field produces the following error at run time:     Error with            -Value: Data Type Mismatch.    Unbinding object              CAUSE =====  Combo boxes and list boxes ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAPN,QAP2,QAAP,QAB4,QBV3,QAYY,QAY5,QACI,QACE,QA7O,QA7N,QAHP,QDKW,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Data Type Mismatch Error with Combo Box or List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156550</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Setting the ControlSource property of a combo or list box to a Date type
field produces the following error at run time:
<P>
<PRE>   Error with &lt;comboname&gt;-Value: Data Type Mismatch.
   Unbinding object &lt;comboname&gt;

</PRE><h2>CAUSE</h2>
 
<P>
Combo boxes and list boxes handle only Character, Numeric, and Null data
types. Other field types produce an error when the form runs.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can work around by using a SELECT - SQL statement to create an array,
instead of setting the ControlSource property of a combo box or list box to
a Date type field. Use the array in the RowSource property of the combo or
list box. The DTOC() function changes the data type from Date to Character.
For instance, to fix the example illustrated in the STEPS TO REPRODUCE
BEHAVIOR section below, you can use the following code in the Init method
of the form:
<P>
<PRE>   SELECT DTOC(order_date) FROM orders INTO ARRAY adates
   THISFORM.combo1.RowSource=THISFORM.combo1.RowSource

</PRE>In the Valid event of the combo box or list box, use a REPLACE statement,
instead of the ControlSource property, to place the value in the other
table:
<P>
<PRE>   REPLACE employee.hire_date WITH CTOD(THISFORM.combo1.Value)

</PRE>The CTOD() function converts the selection back into a Date data type.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Combo box and list box objects do not handle all data types in the
ControlSource property. The ControlSource property of a combo box or list
box object can contain only data types of Character, Numeric, or Null.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form called test.
</OL>2. Place the orders and employee tables from the Testdata database in the
<PRE>   data environment of the form. Testdata is located in the
   Vfp\Samples\Data folder.
</PRE></OL>3. Add a combo box or list box to the form and set the following
<PRE>   properties:

      ControlSource=employee.hire_date
      RowSource=orders.order_date
      RowSourceType=Fields

</PRE><P><LI>Run the form and the error appears.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>
Additional reference words: 3.00 3.00b 5.00 kbdsd VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
