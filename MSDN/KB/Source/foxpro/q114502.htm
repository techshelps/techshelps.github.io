

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Error Occurs When Previewing an Untransported DOS Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114502">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1994/05/04">
<META NAME="Keywords" CONTENT="fixlist5.00 FoxMac FoxWin FxtoolTransprt vfoxwin kbbuglist kberrmsg kbfixlist kbprg kbt">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In a FoxPro for Windows .EXE file, untransported FoxPro for MS-DOS reports will cause an  Internal Consistency Error  message when the report is being previewed and the horizontal scroll bar is clicked.  RESOLUTION  Transport the report to the curr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QBLD,QABH,QAB4,QDL9,QBWQ,QBWO,QBWN,QBP6,QBWS,QAUR,QARJ,QAR4,QANE,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Error Occurs When Previewing an Untransported DOS Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114502</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50b 2.60 2.60a 3.00 | 2.50b
<PRE>WINDOWS               | MACINTOSH
</PRE>kbprg kbbuglist kbfixlist kbtool kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5b, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a FoxPro for Windows .EXE file, untransported FoxPro for MS-DOS reports
will cause an "Internal Consistency Error" message when the report is being
previewed and the horizontal scroll bar is clicked.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Transport the report to the current platform.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>At the MS-DOS prompt, type the following commands:
<P>
       C:
       CD\
       MD rpt_test

<P><LI>Start FoxPro 2.0 or 2.5x for MS-DOS.

<P><LI>Create a table with one memo field and populate the field with data.
    In FoxPro for MS-DOS, type the following commands in the Command
    window:
<P>
       SET DEFAULT TO c:\rpt_test
       CREATE TABLE test_tbl (field1 M)
       INSERT INTO test_tbl (field1);
<PRE>           VALUES (REPLICATE('W',500))
       CREATE REPORT test_rpt.frx

</PRE><P><LI>From the Report menu, choose Page Layout. In the Page Layout dialog
    box, set the right margin column to 200.
<P>
    NOTE: Setting the Right margin column to 200 is not necessary to
    generate the error. However, it guarantees that the Preview mode will
    display a horizontal scroll bar using video drivers with resolutions
    up to 1024 x 768.

<P><LI>From the Report menu, choose Quick Report, and choose the OK button to
    create a quick report.

<P><LI>Move the mouse cursor to the right edge of TEST_TBL.FIELD1 and hold
    down the CTRL key. Drag the mouse to the right edge of the report. You
    probably won't be able to see the right edge of the report form by
    default. However, when the mouse is moved to the right edge of the
    report, the report will scroll until the far edge is reached.

<P><LI>Save the report. When prompted to save the environment, choose Yes.

<P><LI>Quit FoxPro for MS-DOS and start FoxPro for Windows.

<P><LI>Type the following commands in the Command window:
<P>
       SET DEFAULT TO c:\rpt_test
       CREATE PROJECT test_app
       MODIFY COMMAND main.prg

<P><LI>Enter the following line of code in MAIN.PRG. Then save and close
    MAIN.PRG.
<P>
      REPORT FORM test_rpt PREVIEW ENVIRONMENT

<P><LI>Add MAIN.PRG to the TEST_APP project by choosing the Add button.
    Choose the Build button.

<P><LI>In the Build Option dialog box, select the Build Executable radio
    button. Then choose the OK button. Accept the defaults, and choose the
    Build button.

<P><LI>After the build process has been completed, quit FoxPro for Windows.

<P><LI>Go to Program Manager and choose Run from the File menu. In the Command
    Line field, type the following, and then choose OK:
<P>
      c:\rpt_test\test_app.exe

<P><LI>When the Page Preview window appears, click the horizontal scroll bar
    at the bottom of the window.
<P>
</OL>The error message appears, followed by a general protection (GP) fault.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbtool kbbuglist kbfixlist kberrmsg<BR>
KBSubcategory: FxtoolTransprt fixlist5.00 VFoxWin FoxWin FoxMac<BR>
buglist2.50b buglist2.60 buglist2.60a<BR>
Additional reference words: 2.50b 2.60 2.60a gpf ice errmsg err msg<BR>
Keywords          : fixlist5.00 FoxMac FoxWin FxtoolTransprt vfoxwin kbbuglist kberrmsg kbfixlist kbprg kbtool<BR>
Version           : 2.50b 2.60 2.60a 3.00 | 2.50b<BR>
Platform          : MACINTOSH WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
