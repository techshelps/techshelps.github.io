

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cases Where Failed ALTER TABLE Doesn't Revert </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136851">
<META NAME="KBModify" CONTENT="1995/09/18">
<META NAME="KBCreate" CONTENT="1995/09/14">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes circumstances that change the table structure even if the ALTER TABLE command fails.  MORE INFORMATION  In general, any failure reported by either the ALTER TABLE command or the MODIFY STRUCTURE dialog box should result in th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKR,QAPF,QA7O,QA7N,QAL2,QAIB,QARR,QBXS,QBV8,QBVV,QAY5,QAL3,QABA,QAH6,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cases Where Failed ALTER TABLE Doesn't Revert</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136851</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes circumstances that change the table structure even
if the ALTER TABLE command fails.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In general, any failure reported by either the ALTER TABLE command or the
MODIFY STRUCTURE dialog box should result in the source table remaining
unchanged from its state prior to the action.
<P>
One exception to this is when a new primary key is created or an existing
key is promoted to being a primary key. An error message is displayed if
the key creation fails because Visual FoxPro detects a duplicate key.
However, all other changes to the table remain intact.
<P>
The SET SAFETY ON/OFF command also affects some of the validation performed
by the ALTER TABLE and MODIFY STRUCTURE operations. The following
information applies to the table validation rules, table validation text,
field validation rules, field validation text, and field default values.
<P>
Regardless of the setting of safety, the syntax of the information entered
is validated. However, if SAFETY is ON, then the information is also
evaluated before any attempt is made to alter the table. Therefore, setting
SAFETY ON provides an extra level of validation that can occur even if the
the NOVALIDATE clause is used to avoid a lenthgy rule verification phase.
<P>
Example: For a field rule for FIELD1 where MEMVAR1 is not in scope:
<P>
<PRE>   ALTER TABLE Table1 ALTER Field1 CHECK Field1 !=memvar1 NOVALIDATE

</PRE>This succeeds if SAFETY is OFF, but fails evaluation because MEMVAR1 is not
in scope.
<P>
NOTE: If a user-defined function (UDF) is recognized during the validation
phase, the function is not called and the validation passes.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin sql<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
