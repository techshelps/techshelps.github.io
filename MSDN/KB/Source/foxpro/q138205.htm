

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Using OLE Automation with Microsoft Word </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138205">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/10/15">
<META NAME="Keywords" CONTENT="FxinteropOle vfoxwin kbcode kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article demonstrates using OLE Automation in Visual FoxPro to send data from a table to a Microsoft Word document. The example requires that Microsoft Word 6.0 or later be installed on the same computer as Visual FoxPro. This example consists ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QBTO,QAPF,QBJZ,QALI,QBWS,QA56,QA55,QAYY,QDME,QA9Q,QA2K,QAY2,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Using OLE Automation with Microsoft Word</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138205</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates using OLE Automation in Visual FoxPro to send
data from a table to a Microsoft Word document. The example requires that
Microsoft Word 6.0 or later be installed on the same computer as Visual
FoxPro. This example consists of two basic steps: creating the mail merge
document in Microsoft Word and writing the program to perform the OLE
automation in Visual FoxPro.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Create the mail merge document in Microsoft Word. Start with a new
   document in Microsoft Word. Format the Document as follows:
<P>
<P><PRE>      Contact
      Company
      Phone
</PRE><P>
<P><PRE>      Dear greeting,
</PRE><P>
<P><PRE>      &lt;This is the body of the form letter.&gt;
</PRE><P>
<P><PRE>      Sincerely,
</PRE><P>
<P><PRE>      &lt;Your Company Name&gt;
</PRE><P>
   Create bookmarks for Contact, Company, Phone, and greeting. To do this,
   select the item in the document (for example, Contact), choose the Edit
   menu pad (it’s the View menu pad in Word 97), and click the Bookmark
   menu item. Enter the bookmark name (for example, contact), and click
   Add. The bookmark name should be the same as the item selected. Repeat
   this for all four items. Save the Microsoft Word Document as Wordole.doc
   in the Vfp\Samples\Data directory.

<P><LI>Create the OLE Automation program in Visual FoxPro. Create a new program
   in Visual FoxPro with the following code:
<P>
   NOTE: In Word 6.0 and Word 95, use the following code:
<P>
<P><PRE>      PUBLIC oWordObj
</PRE><P>
<P><PRE>      OPEN DATA SYS(2004)+"\samples\data\TestData.dbc"
      USE Customer
</PRE><P>
<P><PRE>      oWordObj=CREATEOBJECT("Word.Basic")
</PRE><P>
<P><PRE>      oWordObj.FileOpen (SYS(2004)+"samples\data\wordole.doc")
</PRE><P>
<P><PRE>      oWordObj.EditGoto ("contact")
      oWordObj.Insert (Customer.Contact)
      oWordObj.EditGoTo ("company")
      oWordObj.Insert (Customer.Company)
      oWordObj.EditGoTo ("phone")
      oWordObj.Insert (Customer.Phone)
      oWordObj.EditGoTo ("greeting")
      oWordObj.Insert (Customer.Contact)
</PRE><P>
<P><PRE>      oWordObj.FilePrint
</PRE><P>
   NOTE: In Word 97, use the following code:
<P>
<P><PRE>      PUBLIC oWordObj
</PRE><P>
<P><PRE>      OPEN DATA SYS(2004)+"\samples\data\TestData.dbc"
      USE Customer
</PRE><P>
<P><PRE>      oWordObj=CREATEOBJECT("Word.Basic")
</PRE><P>
<P><PRE>      oWordObj.FileOpen (SYS(2004)+"samples\data\wordole.doc")
</PRE><P>
<P><PRE>      oWordObj.ww7_EditGoto ("contact")
      oWordObj.Insert (Customer.Contact)
      oWordObj. ww7_EditGoTo ("company")
      oWordObj.Insert (Customer.Company)
      oWordObj. ww7_EditGoTo ("phone")
      oWordObj.Insert (Customer.Phone)
      oWordObj. ww7_EditGoTo ("greeting")
      oWordObj.Insert (Customer.Contact)
</PRE><P>
<P><PRE>      oWordObj.FilePrint
</PRE><P>
   Save and run the program. When the program is run, the form letter
   should print using data from record one in the Customer table.
<P>
   By removing the Open Data and Use Customer commands, you could call this
   program from a form that was based on the customer table. If the program
   is called from the click event of a command button, the form letter
   would be printed using data from the current record in the customer
   table.
<P>
</OL> 
<PRE>Keywords          : FxinteropOle vfoxwin kbcode kbinterop
Technology        : kbole
Version           : 3.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
