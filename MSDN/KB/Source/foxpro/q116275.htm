

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "S1000 Connection Failed" with Connectivity Kit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116275">
<META NAME="KBModify" CONTENT="1995/10/26">
<META NAME="KBCreate" CONTENT="1994/06/15">
<META NAME="Keywords" CONTENT="kbinterop kbtool kbprg kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are trying to connect to a SQL Server machine using the Connectivity Kit's DBConnect() function, the following error message appears:     S1000 Connection failed [Microsoft][ODBC SQL Server driver]Unable to    load Communication module. Dr...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAA1,QBG2,QAU9,QAB9,QDI2,QAZV,QAI5,QA9E,QBE7,QBE6,QAUJ,QAB4,QBVX,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "S1000 Connection Failed" with Connectivity Kit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116275</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro Connectivity Kit, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are trying to connect to a SQL Server machine using the
Connectivity Kit's DBConnect() function, the following error message
appears:
<P>
<PRE>   S1000 Connection failed [Microsoft][ODBC SQL Server driver]Unable to
   load Communication module. Driver has not been correctly installed.

</PRE><h2>CAUSE</h2>
 
<P>
This error may be caused by one of the following situations:

<UL><LI>SQL Server has been configured to used named pipes instead of SPX/IPX or
   vice versa.

<LI>The required set of stored procedures required for ODBC to work have
   not been installed on the SQL Server machine.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To change SQL Server's configuration from named pipes to SPX/IPX or vice
versa, see the SQL Server documentation or contact Microsoft SQL Server
Product Support Services, or the following Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q137635.htm">Q137635</A></B>
   TITLE     : INF: ODBC SQL Server Connection Parameters

</PRE>The SQL Server driver uses a set of system stored procedures, known as the
catalog stored procedures, to obtain information from the SQL Server system
catalog. If the version of the Microsoft SQL Server ODBC driver you are
using is newer than the SQL Server to which you are connecting, you will
need to have the SQL Server system administrator upgrade the catalog stored
procedures.
<P>
For more information about determining if the stored procedures need to be
upgraded, and instructions for doing the upgrade, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SQLSERVER/Q137636.htm">Q137636</A></B>
   TITLE     : INF: Relationship of the ODBC Driver to INSTCAT.SQL

</PRE>To install the catalog stored procedures:

<OL><P><LI>Insert the disk the SQL Server driver was shipped on in drive A.

<P><LI>Run the INSTCAT.SQL batch file in the isql utility. For example
<P>
<P><PRE>      C:&gt; ISQL /U sa /P &lt;sa-password&gt; /S &lt;server-name&gt; /i A:\INSTCAT.SQL
</PRE><P>
   where &lt;sa-password&gt; is the system administrator's password, and &lt;server-
   name&gt; is the name of the server on which SQL Server resides.
<P>
</OL>NOTE: To run isql, your computer must be installed as a client workstation
for SQL Server. If you are using a version of SQL Server earlier than 4.2a,
you must install the system stored procedures (catalog procedures) by
running the INSTCAT.SQL file, which is a batch file in the isql utility on
SQL Server.
<P>
<P><h2>REFERENCES</h2>
 
<P>
The instructions on how to install the catalog procedures come directly
from the Help file that comes with the SQL Server driver. For more
information, see the "Installing the Catalog Stored Procedures" topic in
the Help file that comes with the SQL Server driver.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 2.60a CK errmsg<BR>
KBCategory: kbinterop kbtool kbprg kberrmsg kbprb<BR>
KBSubcategory: FxtoolCk<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 26, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
