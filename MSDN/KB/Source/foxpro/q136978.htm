

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Refresh a Formset by Using Commands Outside of the Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136978">
<META NAME="KBModify" CONTENT="1995/09/21">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When moving the record pointer in a table whose fields belong to an active form, the form will not refresh if the command that moved the record pointer was issued from a menu or the Command window. For example, if there is a menu item issues a SKIP...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVI,QAXB,QAB9,QBV8,QA5V,QACI,QAI2,QANJ,QBVV,QA9N,QAO3,QAO2,QAMO,QAH7,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Refresh a Formset by Using Commands Outside of the Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136978</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When moving the record pointer in a table whose fields belong to an active
form, the form will not refresh if the command that moved the record
pointer was issued from a menu or the Command window. For example, if there
is a menu item issues a SKIP command, the record pointer will move but the
form will not refresh.
<P>
To have your application menu item move the record pointer and refresh the
form, use the SKIP command to move the record pointer. and then use the
_SCREEN.FORMCOUNT and _SCREEN.FORMS().REFRESH commands to refresh a form or
formset correctly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the active form on the screen is a form and not a formset, you can use
the _SCREEN.ACTIVEFORM.REFRESH command alone from the menu or Command
window to refresh the form. However, if the form could be a form
or a formset, it is best to make your refresh code generic, so it fits both
cases.
<P>
The _SCREEN.FORMCOUNT command returns the number of forms on the screen, so
it allows you to refresh each form whether a single form or a formset. Then
you can use the FORMS() array to refresh each form if a formset is active.
The FORMS() array is created when the forms start up. It is internal to
Visual FoxPro. By putting these commands in a FOR loop, you can refresh a
form or formset from a menu action.
<P>
For additional information about a form that uses toolbars, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q136277.htm">Q136277</A></B>
   TITLE     : FormCount Property Does Not Count Toolbars in a Formset

</PRE><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a formset with two pages, and place a field from a table on each
   page.

<P><LI>Run the form, and place the two forms side by side.

<P><LI>Type the SKIP command in the Command window and press ENTER. Note that
   the fields on each form do not change.

<P><LI>Type the _SCREEN.FORMS(1).REFRESH command in the Command window and
   press ENTER. Note that the second form refreshes. This is because the
   name of the last form in the formset is placed in the first FORMS array
   element. Issuing the _SCREEN.FORMS(2).REFRESH command will refresh the
   other form.

<P><LI>If the SKIP command is used in a menu, place the following code in the
   menu item's procedure:
<P>
   SKIP
   FOR x = 1 TO _SCREEN.FORMCOUNT
<P><PRE>      _SCREEN.FORMS(x).REFRESH
</PRE>   ENDFOR
<P>
   This will refresh any form or formset that is active at the time when
   the user clicks that menu item.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
