

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Alternative to Using the _CUROBJ Variable with Forms </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129573">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/30">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The _CUROBJ system memory variable indicates the number of the currently active objects in a screen. Because _CUROBJ is active only when a READ is in effect, this system memory variable does not return any value in a Visual FoxPro form. However, Vi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAPN,QADO,QAYL,QAW6,QAUD,QAI2,QAHV,QBXS,QA62,QABA,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Alternative to Using the _CUROBJ Variable with Forms</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129573</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The _CUROBJ system memory variable indicates the number of the currently
active objects in a screen. Because _CUROBJ is active only when a READ is
in effect, this system memory variable does not return any value in a
Visual FoxPro form. However, Visual FoxPro provides ways to control the
current object. This article describes the properties of a form that you
can use to set the tab order of objects on a form, refer to the active
control on a form, and set the focus to a control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The _CUROBJ system memory variable returns a value when a READ is active,
and it is not used in the Visual FoxPro event model. However, the form
object exposes methods and properties that provide information about the
current control.
<P>
<P><h3>Retrieving or Setting the Access Order of an Object</h3>
 
<P>
By default, controls are accessed in the order they are created on a form.
You can alter this default with the TABINDEX property. The TABINDEX
property specifies the tab order of controls on a form or specifies the
order of forms in a form set. It returns a numeric value. You can read or
write it at both design and run time.
<P>
For example, to ensure that a command button called CMDBUTTON3 in a form
called TEST is the third control accessed on a form, you can type:
<P>
<PRE>   TEST.CmdButton3.Tabindex= 3

</PRE>NOTE: setting the TABINDEX property will not move the focus to a control.
<P>
<P><h3>Referencing the Active Control on a Form</h3>
 
<P>
The ACTIVECONTROL property references the active control on a form. It
returns a reference to the object that currently has the focus on a form.
You can use the ACTIVECONTROL property to refer to and manipulate a control
on a form or form page generically.
<P>
For example, to change the font of the active control to bold, you can type
the following in the Refresh method of the form:
<P>
<PRE>   IF TYPE('THISFORM.ActiveControl')="O"
      THISFORM.ActiveControl.FontBold= .F.
   ELSE
      =MESSAGEBOX('There is no Control active on this form')
   ENDIF

</PRE>The ACTIVECONTROL property is read-only at run time. It cannot be used to
set the focus to a specific control.
<P>
<P><h3>Setting the Focus on a Control in a Form</h3>
 
<P>
Use the SETFOCUS method to move the focus to a specific control in a form.
The SETFOCUS method is a method of a control. It requires that you
reference the object to which you want to move. You can use the SETFOCUS
along with the CONTROLS collection of a form to access controls on a form
generically.
<P>
For example, if you want to move the focus to the previous control on the
form, you can type the following in the Click event handler of the control:
<P>
<PRE>   ncontrol=This.Tabindex
   THISFORM.CONTROLS(ncontrol-1).SETFOCUS

</PRE>This assumes that the CONTROLS array is in the same order as the TABINDEX
and that the form does not contain a page frame. A page frame is a
container for controls, so it uses its own controls array.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin<BR>
KBCategory: kbtool<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
