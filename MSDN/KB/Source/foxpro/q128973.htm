

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Create a Vertical Caption in Label Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128973">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/16">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The label control is a graphical control that displays text. The label presents a horizontal caption by default. This article provides a sample program that creates a vertical label and displays it on the form.  MORE INFORMATION  The text displayed...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAC2,QAVS,QAPN,QAUD,QAAL,QAYG,QAH4,QAEB,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Create a Vertical Caption in Label Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128973</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The label control is a graphical control that displays text. The label
presents a horizontal caption by default. This article provides a sample
program that creates a vertical label and displays it on the form.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The text displayed in a label is presented horizontally by default, and the
label control does not expose a vertical property that would allow you to
vertically align a label. However, typing a CHR(13) in the caption of a
label inserts a carriage return and the string is displayed vertically. For
example, the following property assignment displays the word 'Test'
vertically.
<P>
<PRE>   label.Caption="T"+chr(13)+"e"+chr(13)+"s"+chr(13)+"t"

</PRE>The following sample program displays a modal form that prompts the user to
enter a caption. The text entered is then used in another form to display a
vertical label. The same technique could be used to create a visual class
that would implement a VERTICAL property. To run this example, copy and
paste the code to a program (.PRG) file.
<P>
<P><h3>Sample Code</h3>
 
<P>
*:*************************************************************************
*: Code to instantiate the forms
*:*************************************************************************
*: VERTICAL
<PRE>   cText=""
   oTxtLabel=CREATEOBJECT('formlabel')
   oTxtLabel.Show
   oMyform=CREATE('myform')
   oMyform.Show
   READ EVENTS

</PRE>*:*************************************************************************
*: Class: FORMLABEL  BaseClass: FORM
*: Modal form to input the label caption
*:*************************************************************************
<PRE>   DEFINE Class FORMLABEL AS Form
     WindowType=1
     Width=125
     AutoCenter=.T.
     ADD OBJECT lblCaption AS Label WITH ;
       Caption="Enter your caption", AutoSize=.T., BackStyle=0
     ADD OBJECT CMDQUIT AS CommandButton WITH Caption="Quit", Top =80
     ADD OBJECT txtLabelCaption AS TextBox WITH ;
       ControlSource='cText',Top=34,Left=3
     PROCEDURE CMDQUIT.Click
       RELEASE Thisform
     ENDPROC
   ENDDEFINE

</PRE>*:*************************************************************************
*: Class: MYFORM
*: Form that displays the label. It contains the vertical label and a QUIT
*: command button.
*:*************************************************************************
<PRE>   DEFINE Class MYFORM AS Form
     ADD OBJECT lblvertical AS VERTLABEL WITH Left=Thisform.Width/2
     Top=5
     Left=5
     Caption="See your Label"
     ADD OBJECT CMDQUIT AS CommandButton WITH Caption="Quit", Top =10, ;
        Height=20
     PROCEDURE CMDQUIT.Click
       RELEASE Thisform
       CLEAR EVENTS
     ENDPROC
   ENDDEFINE

</PRE>*:*************************************************************************
*: Class: VERTLABEL  BaseClass: LABEL
*: Creates the vertical caption. Takes the caption as a parameter, and
*: processes the string to add a CHR(13) between each character.
*: Also adjusts the height of the label. The code in the Rotate method can
*: be modified to use in a visual class definition.
*:*************************************************************************
<PRE>   DEFINE Class VERTLABEL AS Label
     BackStyle=0
     Alignment=2
     Width=FONTMETRIC(7)  &amp;&amp;Adjusts the Width of the Label to 1 character
     BackColor=rgb(255,0,0)
     PROCEDURE Init
       This.Caption=This.Rotate(CTEXT) &amp;&amp;Text entered in the previous form

     PROCEDURE Rotate
        PARAMETERS tCaption
        nNewheight=0    &amp;&amp; Holds the new height
        cNewcaption=""  &amp;&amp; Holds the new caption
        DO CASE
          CASE TYPE('tCaption')= "C"
            FOR I=1 TO LEN(tCaption)
              nNewheight=nNewheight+FONTMETRIC(1)
              cNewCaption=cNewCaption+SUBSTR(tCaption,I,1)+CHR(13)
            ENDFOR
               This.Height=nNewheight
               RETURN cNewcaption
            OTHERWISE
               =MESSAGEBOX('Caption of the label must be a character')
         ENDCASE
   ENDPROC
</PRE>ENDDEFINE
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin tabs<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
