

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Modal Form Fails to Close with Focus on Check Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162684">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1997/01/27">
<META NAME="Keywords" CONTENT="buglist3.00b buglist5.00 FxprgGeneral kbprg vfoxwin vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  With the focus on a check box in a modal form, the form does not close, although code to close the form has been executed.  STATUS ======  Microsoft has confirmed this to be a bug in the Microsoft products listed at the beginning of this article. W...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QABI,QADO,QABH,QAMB,QAH4,QAUJ,QBV4,QAW6,QAPN,QAGB,QAEB,QAHP,QAAW,QAI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Modal Form Fails to Close with Focus on Check Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162684</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With the focus on a check box in a modal form, the form does not close,
although code to close the form has been executed.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Place and run the following code in a program called Boxfocus.prg
<P>
<P><PRE>      * Begin boxfocus.prg
      PUBLIC oform1
</PRE><P>
<P><PRE>      oForm1=CREATEOBJECT("Form1")
      oForm1.SHOW
      RETURN
</PRE><P>
<P><PRE>      *-- ParentClass:  form
<PRE></PRE>      *-- BaseClass:    form

      DEFINE CLASS Form1 AS form
         DoCreate = .T.
         Caption = "Form1"
         WindowType = 1
         Name = "Form1"

         ADD OBJECT Check1 AS checkbox WITH ;
             Top = 84, ;
             Left = 36, ;
             Caption = "Check1", ;
             TabIndex = 2, ;
             Name = "Check1"

         ADD OBJECT Command1 AS commandbutton WITH ;
             Top = 134, ;
             Left = 68, ;
             Caption = "Command1", ;
             Default = .T., ;
             TabIndex = 4, ;
             Name = "Command1"

         ADD OBJECT Text1 AS textbox WITH ;
             Left = 132, ;
             TabIndex = 3, ;
             Top = 84, ;
             Name = "Text1"

         ADD OBJECT Label1 AS label WITH ;
             AutoSize = .T., ;
             Caption = "Press [CTRL+ENTER] on check box and " + ;
               "form will not close", ;
             Left = 36, ;
             Top = 12, ;
             TabIndex = 1, ;
             Name = "Label1"

         ADD OBJECT Label2 AS label WITH ;
             AutoSize = .T., ;
             Caption = "Press [CTRL+ENTER] on textbox and " + ;
               "form will dismiss", ;
             Left = 36, ;
             Top = 36, ;
             TabIndex = 1, ;
             Name = "Label2"

         PROCEDURE Unload
             RETURN 5
         ENDPROC

         PROCEDURE Command1.Click
             RELEASE THISFORM
         ENDPROC

     ENDDEFINE

     * EndDefine: form1

     * End code for boxfocus.prg

</PRE><P><LI>With the focus on the check box, execute a CTRL+ENTER key combination.
<P>
   NOTE: The program ends, but the form is still on the screen.

<P><LI>Run Boxfocus.prg again and execute a CTRL+ENTER key combination with the
   focus on the text box.
<P>
   NOTE: The form disappears as the program ends.
<P>
</OL>NOTE: The CTRL+ENTER key combination activates the default command button.
The same behavior does not occur, however, in a form that is created
visually (that is, with the Form Designer).
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist3.00b buglist5.00 FxprgGeneral kbprg vfoxwin vfpbug5.0a kbbuglist<BR>
Version             : 5.0a 3.0b 5.00<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
