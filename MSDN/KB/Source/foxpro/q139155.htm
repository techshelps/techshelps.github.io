

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Current Edit Not Saved with TABLEUPDATE() from Toolbar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139155">
<META NAME="KBModify" CONTENT="1995/11/12">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the TABLEUPDATE() command in a toolbar command button click event while row or table buffering is enabled does not save the current object's value.  CAUSE =====  When you click a toolbar command button, the focus never leaves the object on th...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QAHP,QAH4,QBT6,QANS,QAF0,QAPN,QBV8,QAB9,QAUR,QBWS,QBVV,QAW6,QAU7,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Current Edit Not Saved with TABLEUPDATE() from Toolbar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139155</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the TABLEUPDATE() command in a toolbar command button click event
while row or table buffering is enabled does not save the current object's
value.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you click a toolbar command button, the focus never leaves the object
on the form. Therefore, any changes that are made to that object are not
sent to the buffer.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following code sample is very generic and only handles edit and text
boxes. The code must be modified for combo boxes and grids containing text
boxes, edit boxes, and combo boxes. Note that with combo boxes, you will
have to use the DisplayValue instead of Value.
<P>
Add the following code to the Click event of the Toolbar command button:
<P>
*-- Code begins here
IF ;
<PRE>   INLIST(_screen.ActiveForm.ActiveControl.BaseClass,'Textbox','Editbox')
   REPLACE (_screen.ActiveForm.ActiveControl.ControlSource) ;
      WITH _screen.ActiveForm.ActiveControl.Value
</PRE>ENDIF
<PRE>   =TABLEUPDATE()
   _screen.ActiveForm.Refresh
</PRE>*-- Code ends here
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When  editing data in a text box, edit box, or combo list box, you must
leave the object to force the data to be written to the buffer or table if
you are using table or row buffering.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a Toolbar Class.

<P><LI>Add a command button to the toolbar.

<P><LI>In the click event of that command button, add this code:
<P>
   =TABLEUPDATE()
   _Screen.ActiveForm.ActiveControl.Refresh

<P><LI>Save and close the toolbar.

<P><LI>Create the table. Type the following in the Command window:
<P>
   CREATE TABLE temp (myfield C(10))
   INSERT INTO temp VALUES ("Hello")

<P><LI>Create the form:
<P>
   a. Type the following command in the Command window:
<P>
<P><PRE>      CREATE FORM ztest
</PRE><P>
   b. Add the Temp table to the Data Environment (DE) of the form.
<P>
   c. Set the BufferModeOverride of Cursor1 to 3, optimistic row buffering
<P><PRE>      in the DE.
</PRE><P>
   d. Click and drag myfield from the DE to the form.

<P><LI>Run the test.
<P>
   a. Instantiate the toolbar with CREATEOBJECT().
<P>
   b. Type the following in the Command window:
<P>
<P><PRE>      DO FORM ztest
</PRE><P>
   c. Type "TESTING" in the field.

<P><LI>Click the Toolbar command button. Notice that the value has changed back
   to "Hello."
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgToolbar<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
