

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Variable Not Found" Error Occurs with Filter Expression </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119898">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1994/08/29">
<META NAME="Keywords" CONTENT="kbprg kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are performing a SEEK, a LOCATE, or a FIND, the following error message occurs:     Variable '               ' not found.  CAUSE =====  A filter expression has been set, and it uses the variable that can no longer be found. When the filter...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAH4,QBE7,QBE6,QAB9,QAB4,QBVV,QAO4,QAAP,QBXS,QA28,QATJ,QALS,QAJX,QAHE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Variable Not Found" Error Occurs with Filter Expression</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119898</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.00, 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5x
<LI>Microsoft FoxPro for UNIX, version 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are performing a SEEK, a LOCATE, or a FIND, the following error
message occurs:
<P>
<PRE>   Variable '&lt;variable name&gt;' not found.

</PRE><h2>CAUSE</h2>
 
<P>
A filter expression has been set, and it uses the variable that can no
longer be found. When the filter expression is reevaluated during the
search, FoxPro reports that the variable cannot be found.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
While every case is likely to be different, the problem illustrated below
could be resolved in one of the following ways:

<OL><P><LI>Make the variable used in the filter expression PUBLIC.
<P>
   NOTE: Verify that the code does not contain a PRIVATE command that makes
   the variable in question private.
<P>
   -or-

<P><LI>Change the SetFilter procedure to the following:
<P>
<P><PRE>      PROCEDURE SetFilter
      PARAMETER x
      cExpr = 'state ="'+ x + '"'
      SET FILTER TO &amp;cExpr
</PRE><P>
</OL>In the second case, the use of macro substitution eliminates the dependency
of the filter upon the variable.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Enter the following code in a program:
<P>
<P><PRE>      USE customer
      INDEX ON cno TAG cno
</PRE><P>
<P><PRE>      DO SetFilter WITH 'CA'
      SEEK 'A2695'
</PRE><P>
<P><PRE>      PROCEDURE SetFilter
      PARAMETER x
      SET FILTER TO state=x
</PRE>
<P><LI>Run the program.
<P>
</OL>In the code above, the error occurs because the variable used in the filter
expression loses its scope when the SetFilter procedure terminates. FoxPro
senses this and clears the filter because it is no longer valid.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxUnix FoxMac FoxDos FoxWin 2.00 2.50 2.50a<BR>
2.50b<BR>
2.50c 2.60<BR>
2.60a<BR>
KBCategory: kbprg kberrmsg kbprb<BR>
KBSubcategory: FxprgMacrosub<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
