

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: TextBox Value in Grid Column Using Numeric ControlSource </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162256">
<META NAME="KBModify" CONTENT="1997/02/20">
<META NAME="KBCreate" CONTENT="1997/01/16">
<META NAME="Keywords" CONTENT="kbprg kbfixlist kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you enter numeric data of a number greater than 10 into a text box within a grid on a FoxPro form, it is correctly entered into the table. However, if the Grid1.Column1.Text1 value is referenced, it appears as zero. This behavior only occurs i...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QBV4,QA5V,QANY,QAHP,QAKC,QAMB,QAKD,QAC2,QAUD,QAR4,QAH4,QAE1,QARR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: TextBox Value in Grid Column Using Numeric ControlSource</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162256</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you enter numeric data of a number greater than 10 into a text box
within a grid on a FoxPro form, it is correctly entered into the table.
However, if the Grid1.Column1.Text1 value is referenced, it appears as
zero. This behavior only occurs in version 3.0b.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Set each Grid TextBox InputMask property as follows:
<P>
<PRE>  Grid1.TextBox1.InputMask = 9999.99
  Grid1.TextBox2.InputMask = 9999.99

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Steps to Reproduce Problem
 

<OL><P><LI>Copy the following code to a test program and run it to create a
   Test.dbf that contains two sample records:
<P>
<P><PRE>      ***** Table setup for TEST *****
      CREATE TABLE 'test.dbf' ;
<PRE></PRE>         (DISCOUNT N(10, 2) NOT NULL, ;
         AMOUNT N(10, 2) NOT NULL, ;
         OTHER N(10, 2) NOT NULL)

      ***** Add two records for testing *****
      INSERT INTO test (DISCOUNT, AMOUNT, OTHER) ;
         VALUES (7.00, 4.00, 0.00)
      INSERT INTO test (DISCOUNT, AMOUNT, OTHER) ;
         VALUES (9.00, 15.00, 10.00)


</PRE><P><LI>Create a new form, and add the Test table to the data environment.

<P><LI>Drag the Test table from the data environment to the form to create a
   grid.

<P><LI>Set the following grid properties:
<P>
<P><PRE>      Grid1.ColumnCount = 2
      Column1.ControlSource = test.discount
      Header1.Caption = "Discount" (without the quotes)
      Column2.ControlSource = test.amount
      Column2.Header1.Caption = "Amount" (without the quotes)
</PRE>
<P><LI>On the Form Controls toolbar, click Label and place three Label
   controls on the form to the right of the grid.

<P><LI>Set the following Caption properties on the three Labels (without the
   quotes):
<P>
<P><PRE>      Label1.Caption = "Value"
      Label2.Caption = "IsZero?"
      Label3.Caption = "Field"
</PRE>
<P><LI>On the Form Controls toolbar, click TextBox and place three TextBoxes
   on the form, one to the right of each label.

<P><LI>Set the following Name properties on the three TextBoxes:
<P>
<P><PRE>      Text1.Name = txtNewValue
      Text2.Name = txtZero
      Text3.Name = txtNewField
</PRE>
<P><LI>Enter the following code in the LostFocus event of the (Discount
   column) Grid1.Column1.Header1.Text1:
<P>
<P><PRE>      THISFORM.txtNewvalue.Value = THIS.Value
      IF THIS.Value = 0
<PRE></PRE>         THISFORM.txtZero.Value = "Yes"
      ELSE
         THISFORM.txtZero.Value = "No"
      ENDIF
      THISFORM.txtNewField.Value = test.discount

</PRE><P><LI>Enter the following code in the LostFocus event of the (Amount column)
   Grid1.Column2.Header1.Text1:
<P>
<P><PRE>       THISFORM.txtNewvalue.Value = THIS.Value
       IF THIS.Value = 0
<PRE></PRE>          THISFORM.txtZero.Value = "Yes"
       ELSE
          THISFORM.txtZero.Value = "No"
       ENDIF
       THISFORM.txtNewField.Value = test.amount

</PRE><P><LI>Run the form.

<P><LI>Enter a new number in the first record of the form's Discount column
   and notice that if the number entered is less than 10 that the number
   is displayed correctly in the TextBox beside "Value" and the answer
   displayed in the TextBox beside "IsZero?" is correct.

<P><LI>Repeat step 12 for the first record of the Amount column.

<P><LI>Enter a new number that is greater than 10 in the first record of the
   Discount column. Notice that the number displayed in the "Value"
   TextBox is "0" and the answer displayed in the "IsZero?" TextBox is
   incorrect.

<P><LI>Repeat step 14 for the first record of the Amount column.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
If you are not familiar with creating forms, or using the grid control,
please see:
<P>
Visual FoxPro Developer's Guide, chapters 9 and 11
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Perry Newton, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxprgGrid vfoxwin vfoxmac buglist3.00 buglist3.00b<BR>
fixlist5.00<BR>
Additional reference words: 3.00 3.00b<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
