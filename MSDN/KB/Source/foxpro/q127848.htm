

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: RELEASE Command Does Not Release a Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127848">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/03/19">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing the RELEASE command to release an instance variable does not release the object referenced by the variable. If the variable holds a reference to a form that is displayed, the form is not closed.  CAUSE =====  Another reference to the object...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA5,QAW6,QAPN,QAYL,QAB3,QBVV,QAI2,QAVX,QAVW,QAHD,QBV8,QAB9,QANY,QAPF,QA4F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: RELEASE Command Does Not Release a Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127848</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing the RELEASE command to release an instance variable does not
release the object referenced by the variable. If the variable holds a
reference to a form that is displayed, the form is not closed.
<P>
<P><h2>CAUSE</h2>
 
<P>
Another reference to the object exists. An object is released from memory
when all of the references to this object have been released.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can use the AINSTANCE() function to verify that all the references to
an object have been released. AINSTANCE() builds an array of object
references.
<P>
A reference to the specified object still exists if the length of the array
is greater than 0. Another alternative is to maintain a table or an array
that updates the reference count to an object.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Following are two examples that create a reference to a form.
<P>
<P><h3>Example One</h3>
 

<OL><P><LI>Create a form, and save it as TEST.

<P><LI>From the Command window, type:
<P>
   DO FORM TEST NAME ofrmTest1 LINKED &amp;&amp;Displays a form
<PRE>   ofrmTest2=ofrmTest1       &amp;&amp;Creates a reference to ofrmTest1
   * The following command releases the variable ofrmTest1. However, the
   * form is not released because a reference exists.
   RELEASE ofrmtest1
   RELEASE ofrmtest2  &amp;&amp; Releases the Form

</PRE></OL><h3>Example Two</h3>
 

<OL><P><LI>Copy and paste the following sample code into a PRG
<P>
   OFORM1=CREATE('testclass')
<PRE>   OFORM2=OFORM1   &amp;&amp;Creates a reference to OFORM1
   OFORM2.SHOW     &amp;&amp; Displays the Form

   nobject= AINSTANCE(atest1,'testclass')
   DISPLAY MEMORY LIKE atest1 &amp;&amp; Two references to the object exist

   RELEASE OFORM2          &amp;&amp; Form not released
   WAIT WINDOW "After OFORM2 has been released"

   RELEASE oForm1          &amp;&amp; Form is released.
   WAIT WINDOW "After OFORM1 has been released"

   DEFINE CLASS TESTCLASS AS FORM
      Caption="Hello"
   ENDDEFINE

</PRE><P><LI>Execute the PRG.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin  close<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgClassoop<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
