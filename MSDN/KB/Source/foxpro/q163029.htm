

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Default Value Does Not Update Table in Local/Remote View </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163029">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="buglist3.00b fixlist5.00 FxprgTable vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In Visual FoxPro 3.0b, when a view is created and default value is set using DBSETPROP, the newly-appended records contain the default value in a Browse/Append window; but the default values disappear after TABLEUPDATE() and REQUERY().  RESOLUTION ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABA,QA5V,QAKD,QAXB,QADK,QA56,QA55,QAR4,QBWT,QBWS,QDIX,QBXS,QBFY,QA9N,QAM1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Default Value Does Not Update Table in Local/Remote View</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163029</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0b
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Visual FoxPro 3.0b, when a view is created and default value is set
using DBSETPROP, the newly-appended records contain the default value in a
Browse/Append window; but the default values disappear after TABLEUPDATE()
and REQUERY().
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Instead of using default value in a view, manually code some ON KEY LABEL
that inserts the default values when appending a new record. Since this bug
is fixed in Visual FoxPro 5.0, the best way to avoid it is upgrading to
Visual FoxPro 5.0.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Visual
FoxPro 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Copy and Paste the following code, and save this file as Prog1.prg under
   C:\KBTEST
<P>
<P><PRE>      CLOSE DATABASES
      SET DEFAULT TO C:\KBTEST
</PRE><P>
<P><PRE>      * Create a database and open it
</PRE><P>
<P><PRE>      IF NOT FILE('Table1.dbf')
<PRE></PRE>         CREATE DATA Data1
         CREATE TABLE Table1 (ID C (8) Primary Key, State C (2))
         SET MULTILOCKS ON
         =CURSORSETPROP('Buffering', 5, 'Table1' )
      ELSE
         OPEN DATABASE Data1 EXCLUSIVE
      ENDIF

      * Create a view based on Table1

      CREATE SQL VIEW View1 AS SELECT * FROM Table1

      = DBSETPROP('View1.ID', 'Field', 'KeyField', .T.)
      = DBSETPROP('View1.ID', 'Field', 'UpdateName','Table1.ID')
      = DBSETPROP('View1.ID', 'Field', 'Updatable', .T.)
      = DBSETPROP('View1.State', 'Field', 'Updatable', .T.)
      = DBSETPROP('View1', 'View', 'SendUpdates', .T.)

      * Set the view DefaultValue property
      = DBSETPROP('View1.State', 'Field', 'DefaultValue', "'WA'")

      SELECT 0
      USE View1
      BROWSE

</PRE><P><LI>Run Prog1.prg.

<P><LI>With the View1 Browse window open, append a records by pressing CTRL+Y,
   and then enter a unique ID value. Add several records this way. The
   default value of field STATE is automatically inserted as "WA."

<P><LI>Close the View1 Browse window.

<P><LI>In the Command window, issue the following commands to refresh the
   update to Table1, and refresh View1 by retrieving data from Table1:
<P>
<P><PRE>      = TABLEUPDATE(.T.)
      = REQUERY()
</PRE>
<P><LI>Open the Table1 and View1 Browse windows. The STATE field value, "WA,"
   of the newly appended records turns into blank.
</OL> 
<PRE>Keywords          : buglist3.00b fixlist5.00 FxprgTable vfoxwin
Version           : 3.0b
Platform          : MACINTOSH WINDOWS
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
