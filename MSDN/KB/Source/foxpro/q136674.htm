

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Can't Print GrandChild Records in One-to-Many Relation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136674">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1995/09/12">
<META NAME="Keywords" CONTENT="FxtoolRwriter VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A report for three tables, where the tables have a parent, child, and grandchild one-to-many relation, does not display all the related records in the grandchild table for each of the records in the child table. Only the first related grandchild re...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBXS,QAPN,QAX1,QARR,QABO,QACI,QAB6,QAYY,QAOX,QA4H,QDMH,QABI,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Can't Print GrandChild Records in One-to-Many Relation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136674</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Visual FoxPro for Macintosh, version 3.0b
<P>
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A report for three tables, where the tables have a parent, child, and
grandchild one-to-many relation, does not display all the related records
in the grandchild table for each of the records in the child table. Only
the first related grandchild record prints.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To list all the related records in the grandchild table for each of the
records in the child table:

<UL><LI>Use the SET SKIP command. Place it in the Init event of the report's
   data environment to set the one-to-many relation from child and
   grandchild into the parent.
<P>
   -or-

<LI>Set the IntitialSelectedAlias property of the report's data environment
   to the child table.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the Testdata Database that should be in the \Samples\Data directory
   under the Main Visual FoxPro directory.

<P><LI>Create a new report, and call it Test.

<P><LI>Open the data environment of the report and add the Customer, Orders,
   and OrdItems tables to it. Make sure the relation is set among these
   tables so that the Orders table is a child of the Customer table, and
   the OrdItems table is a child of the Orders table. The OrdItems table is
   the grandchild of Customer table.

<P><LI>Set the OneToMany property of both the relations in the report data
   environment to true (.T.-True).

<P><LI>Set the Order property of the Customer table to Cust_Id and the Order
   property of the Orders table to Order_Id.

<P><LI>Set the InitialSelectedAlias property of the report data environment
   to the Customer table.

<P><LI>Create a report group for Customer.Cust_Id and another report group for
   Orders.Order_Id.

<P><LI>Place the Cust_Id and Company fields of the Customer table in the first
   group header (Customer.Cust_Id).

<P><LI>Place the Order_Id and Order_Amt fields of the Orders table in the
   second group header (Orders.Order_Id).

<P><LI>Place the Line_No,Product_ID, and Unit_Price fields of the OrdItems
<P><PRE>    table in the Detail band.
</PRE>
<P><LI>Add whatever titles you think are necessary to each of the Bands.

<P><LI>Preview the Report. Only one OrdItems record related to each of the
<P><PRE>    Orders record appears.
</PRE><P>
</OL><h3>Example Resolution</h3>
 
<P>
To fix this behavior:

<UL><LI>Add the following code to the Init event of the report data environment:
<P>
   SELECT Customer
   SET SKIP TO Orders,OrdItems
<P>
   -or-

<LI>Set the InitialSelectedAlias of the report data environment to Orders.
<P>
</UL> 
<PRE>Keywords          : FxtoolRwriter VFoxMac vfoxwin
Version           : Win:3.0,3.0a,5.0,5.0a; Mac:3.0
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
