

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Write to Windows-Style .INI Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95720 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/02/21">
<META NAME="Keywords" CONTENT="kbenv kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following examples show how to write specific information to Windows- style .INI files. The first example shows how to write information to the WIN.INI file, and the second example shows how to write information to any other Windows-style .INI ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBQU,QAUJ,QAH4,QA0B,QAPF,QA8T,QDL9,QBWQ,QBWO,QBWN,QBXT,QA5V,QAKD,QAIB,QAD7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Write to Windows-Style .INI Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95720 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following examples show how to write specific information to Windows-
style .INI files. The first example shows how to write information to the
WIN.INI file, and the second example shows how to write information to any
other Windows-style .INI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example 1</h3>
 
<P>
The following code will write to the Load= line in the [Windows] section of
the WIN.INI file:
<P>
<PRE>   SET LIBRARY TO SYS(2004)+"FOXTOOLS.FLL"
   MAPPNAME="WINDOWS"
   MKEYNAME="LOAD"
   MSETTING="CLOCK.EXE"
   MREGISTER=REGFN("WRITEPROFILESTRING","CCC","I")
   MCALL=CALLFN(MREGISTER,MAPPNAME,MKEYNAME,MSETTING)

</PRE>MAPPNAME points to an application heading in the WIN.INI file. In this
case, it is pointing to the [Windows] application name.
<P>
MKEYNAME points to a key name that appears under the application name. The
above example points to the Load= line.
<P>
MSETTING is the string that contains the value to be assigned to the key
name.
<P>
NOTE: The code in Example 1 puts CLOCK.EXE on the Load= line. It does not
append CLOCK.EXE to any existing information for this key name. It simply
replaces the value. If the Load= line was not present in the [Windows]
section of the WIN.INI file, this code would have added it.
<P>
MREGISTER is the variable name that defines the function using the RegFn
function. The sample code above registers the function WriteProfileString
and will write information to the WIN.INI file.
<P>
MCALL is used to call the function defined in MREGISTER and pass it the
appropriate parameters.
<P>
To write to a different section of the WIN.INI, change the value of
MAPPNAME to the appropriate application name. Also, change the MKEYNAME
value to the key name that will hold the information, and change the
MSETTING value to the setting to store in the selected key name.
<P>
NOTE: The application name and key name are not case sensitive.
<P>
<P><h3>Example 2</h3>
 
<P>
The following code will change the COLOR SCHEMES= line in the [Current]
section of the CONTROL.INI file:
<P>
<PRE>   SET LIBRARY TO SYS(2004)+"FOXTOOLS.FLL"
   MAPPNAME="CURRENT"
   MKEYNAME="COLOR SCHEMES"
   MSETTING="FLUORESCENT"
   MFILENAME="CONTROL.INI"
   MREGISTER=REGFN("WRITEPRIVATEPROFILESTRING","CCCC","I")
   MCALL=CALLFN(MREGISTER,MAPPNAME,MKEYNAME,MSETTING,MFILENAME)

</PRE>The commands are almost the same as those in Example 1, except that Example
2 uses WritePrivateProfileString. This allows you to specify a Windows-
style .INI file other than the WIN.INI file. One other difference is the
addition of MFILENAME to specify the .INI file to write to. By default, if
no path is specified, Windows will look in the Windows program directory
for the .INI file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin 2.50 2.50a<BR>
KBCategory: kbenv kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
