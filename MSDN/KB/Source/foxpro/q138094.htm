

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create Updatable Views by Using SQL Passthrough </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138094">
<META NAME="KBModify" CONTENT="1996/06/01">
<META NAME="KBCreate" CONTENT="1995/10/11">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can create an updatable view cursor using SQL Passthrough by setting properties with the CURSORSETPROP() function.  MORE INFORMATION  Remote views provide the most common and easiest way to gain access to and update remote data. You can also us...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QADK,QAPN,QANN,QAC1,QBXS,QBD2,QAO2,QABM,QBWT,QAY5,QAB9,QAA5,QBWC,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Updatable Views by Using SQL Passthrough</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138094</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can create an updatable view cursor using SQL Passthrough by setting
properties with the CURSORSETPROP() function.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Remote views provide the most common and easiest way to gain access to and
update remote data. You can also use SQL passthrough technology to send SQL
statements directly to a server. By default, a SQL passthrough query always
returns a non-updatable snapshot of remote data, which is stored in an
active view cursor. You can make the cursor updatable by setting properties
with the CURSORSETPROP() function. An updatable remote view, in contrast,
usually doesn't require that you set properties before you can update
remote data.
<P>
To update remote data, use the CURSORSETPROP() function to set five
properties: Tables, KeyFieldList, UpdateNameList, UpdatableFieldList, and
SendUpdates. The update properties in a view definition (set by using
DBSETPROP() function) and an active cursor vary slightly. The table on page
60 in the Visual FoxPro Professional Features Guide shows the differences.
<P>
The following program is an example of how to create an updatable view
cursor:
<P>
<PRE>   ** This example is using SQL Server as the back-end.
   ** Your back-end server may vary.
   Handle = SQLCONNECT("SQL421","sa","")
   IF handle&lt;0
     WAIT WINDOW "connection not made"
     CANCEL
   ELSE
     =SQLEXEC(Handle, "select * from authors")
     =CURSORSETPROP("Tables", "dbo.authors")
     ** The next property must include every remote field matched with the
     ** view cursor field
     =CURSORSETPROP("UpdateNameList", "au_id dbo.authors.au_id, au_lname;
       dbo.authors.au_lname, au_fname dbo.authors.au_fname, phone;
       dbo.authors.phone, address dbo.authors.address,;
       city dbo.authors.city, state dbo.authors.state,;
       zip dbo.authors.zip, contract dbo.authors.contract")
     =CURSORSETPROP("KeyFieldList", "au_id")
     ** The next property specifies which fields can be updated.
     =CURSORSETPROP("UpdatableFieldList", "au_lname, au_fname, phone,;
       address, city, state, zip, contract")
     ** The next property enables the ability to send updates.
     =CURSORSETPROP("SendUpdates", .T.)

     BROWSE
     USE
     =SQLDISCONNECT(handle)
   ENDIF

</PRE>Any changes made to the data in the Browse window will update the table on
the remote server.
<P>
NOTE: If you are unsure of how to set the above properties you can create a
remote view. For more information about creating an updatable remote view,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q130413.htm">Q130413</A></B>
   TITLE     : How to Create an Updatable Cursor (View) to Update Table

</PRE>When you run the view, use the CURSORGETPROP() function in the Debug Window
to determine what the five properties are set to. For example, put
CURSORGETPROP("UpdateNameList") in the Debug window to see how the property
is set in the CURSORSETPROP() function.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxMac 3.00b 3.00 VFoxWin pass-through<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
