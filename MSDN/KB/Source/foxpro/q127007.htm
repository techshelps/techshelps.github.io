

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Cursor Skips GET Object(s) on New Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127007">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/03/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The following occurs when you enter data for a new record as you use a window that has GET objects for character variables:  1. The cursor skips past the GET objects.  2. The cursor won't move back to the GET objects when you press SHIFT+TAB.  3. T...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAPN,QAXC,QAW6,QA5V,QAKJ,QBFM,QAUD,QAWF,QAVX,QAVW,QAO2,QACI,QA7O,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cursor Skips GET Object(s) on New Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127007</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.6a
<LI>Microsoft FoxPro for MS-DOS, version 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following occurs when you enter data for a new record as you use a
window that has GET objects for character variables:

<OL><P><LI>The cursor skips past the GET objects.

<P><LI>The cursor won't move back to the GET objects when you press SHIFT+TAB.

<P><LI>The cursor skips the GET objects again when you press TAB enough times
   to cycle through all the objects on the screen and return to the skipped
   GET objects.

<P><LI>FoxPro processes the WHEN and VALID clause code of the skipped objects.
<P>
</OL><h2>CAUSE</h2>
 
<P>
This behavior occurs when all the the following conditions are true:

<UL><LI>The GET object displays a memory variable.

<LI>The GET size is smaller than the field in the record or smaller than the
   memory variable that originally initialized the data in the GET object,

<LI>The memory variable for the field or other memory variable was set to
   null ("") when you established that the next transaction was a new
   record or took some other action to re-initialize the GET object(s).
<P>
</UL>The GET object(s) may be smaller than the field or other memory variable
for the following reasons:

<UL><LI>Design reasons - for example, to place more GET objects on a single
   line.

<LI>The font is so large that the data in the GET must be scrolled to the
   right and left to be seen.
<P>
</UL><h2>WORKAROUND</h2>
 

<OL><P><LI>Re-initialize the memory variables with this command:
<P>
   SCATTER MEMVAR BLANK

<P><LI>Use a format Function/Picture mask to control the number of characters
   in the GET. Here's an example of a Format mask for a 15-character "Last
   Name" GET:
<P>
   AAAAAAAAAAAAAAA
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design. FoxPro sees the smaller GET object (one that
has a SIZE smaller than the maximum field or variable size) as one that
requires scrolling of the input data, as the variable is larger than the
space for data.
<P>
Accordingly, FoxPro re-measures the variable each time rather than
accepting its size at the first occurrence of the variable. Because the
variable was set to null subsequent to the first occurrence, FoxPro sees it
as having no dimension and skips over GET objects that use the variable.
<P>
When the GET object's size is defined as matching the size of the variable,
or as larger than the size of the variable on the first occurrence of the
variable, FoxPro does not resize the definition of the variable thereafter.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create and execute the following program:
<P>
   *: TEST PROGRAM - Entitled TEST1.PRG *****************************
   SET TALK OFF
   CREATE TABLE  x (field1 c(10), field2 c(10))
   APPEND BLANK
   REPLACE field1 WITH "xxxxxxxxxx"
   REPLACE field2 WITH "yyyyyyyyyy"
   SCATTER MEMVAR
   @ 1,1 SAY ;
<P><PRE>      "Tab through the objects on this screen and watch the WAIT WINDOWS,"
</PRE>   @ 2,1 SAY "Click the New Record button, and tab again"
   @ 4,1 SAY "Field1: " GET m.field1 SIZE 1,9 WHEN show1() VALID show2()
   @ 5,1 SAY "Field2: " GET m.field2 SIZE 1,9 WHEN show3() VALID show4()
   @ 6,1 SAY "Field1 again: " GET m.field1 SIZE 1,11
   test = 1
   test2 = 1
   @ 8,1 GET test PICTURE "@*N New Record" VALID new_rec()
   @ 9,1 GET test2 PICTURE "@* Exit"
   READ CYCLE
   CLEAR
   USE
   DELETE FILE x.dbf
<P>
   *:  **** PROCEDURES ****
<P>
   PROCEDURE new_rec
   m.field1=''
   m.field2=''
   SHOW GETS
   _CUROBJ=1
   RETURN
<P>
   PROCEDURE show1
   IF m.field1 == ''
<P><PRE>     WAIT WINDOW "Field1's WHEN " TIMEOUT .8
</PRE>   ENDIF
<P>
   PROCEDURE show2
   IF m.field1 == ''
<P><PRE>     WAIT WINDOW "Field1's VALID" TIMEOUT .8
</PRE>   ENDIF
<P>
   PROCEDURE show3
   WAIT WINDOW "Field2's WHEN " TIMEOUT .8
<P>
   PROCEDURE show4
   WAIT WINDOW "Field2's VALID " TIMEOUT .8
<P>
   *: End of Test1.prg *************************************

<P><LI>Click the "New Record" button. The cursor moves to the GET labelled
   "Field1 again: " and cannot be made to return to the GET labelled
   "Field1: " until an entry is made in the "Field1 again: " GET's edit
   region.

<P><LI>Make an entry in the "Field1 again: " GET's edit region. Then m.field1
   contains a non-null value that will be displayed in the "Field1: " edit
   region by the "Show Gets."
<P>
   M.field2 is still set to null, so the GET for "Field2: " will be
   skipped. Notice that even though a GET edit region is skipped, the WHEN
   and the VALID for that GET object are still activated.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos FoxMac 2.60a cursor pointer jump<BR>
bypass skip GET window field<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
