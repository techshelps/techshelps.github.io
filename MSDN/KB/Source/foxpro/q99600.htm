

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Resolving FoxPro Internal Memory Error Messages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99600 ">
<META NAME="KBModify" CONTENT="1996/05/29">
<META NAME="KBCreate" CONTENT="1993/06/02">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  After one of the following memory error messages is displayed, FoxPro closes all open files to preserve all data and exits to MS-DOS:     Internal consistency error.    Resource Manager Internal consistency error.    Menu Manager Internal consisten...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QANE,QDI1,QAZZ,QAAP,QASR,QABI,QATA,QAVX,QAVW,QACF,QA7Y,QA2S,QAJ9,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Resolving FoxPro Internal Memory Error Messages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99600 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After one of the following memory error messages is displayed, FoxPro
closes all open files to preserve all data and exits to MS-DOS:
<P>
<PRE>   Internal consistency error.
   Resource Manager Internal consistency error.
   Menu Manager Internal consistency error.
   1004 Use of invalid handle.
   1005 Use of unallocated handle.
   1006 Use of transgressed handle.
   1007 Transgressed node found during compaction.
   1008 Foreign node found during compaction.
   1009 Incorrect handle found during compaction.
   1010 Area size exceeded during compaction.
   1011 Area cannot contain handle.

</PRE><h2>CAUSE</h2>
 
<P>
One of the above error messages is displayed because of a memory conflict
or a corrupted FoxPro file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Perform the following troubleshooting steps to resolve this problem:

<OL><P><LI>If the .CDX file is corrupted, do the following; otherwise, go to step
   2.
<P>
   a. At the MS-DOS prompt, type the following command:
<P>
<PRE>         rename &lt;filename&gt;.cdx &lt;filename&gt;.cbk

   b. In the Command window, type the following command:

         USE &lt;filename&gt;.dbf

   c. Re-create the .CDX file.

</PRE><P><LI>If the .DBF file is corrupted, do the following; otherwise, go to step
   3.
<P>
   a. Restore the backup .DBF file if you have one. If you have no backup
<P><PRE>      file, go to step b.
</PRE><P>
   b. In the FoxPro Command window, type the following commands:
<P>
<PRE>         USE &lt;filename&gt;.dbf
         COPY STRUCTURE TO test.dbf WITH CDX
         USE
         SELECT &lt;an unused work area&gt;
         USE test.dbf
         SELECT test.dbf
         APPEND FROM &lt;filename&gt;.dbf

</PRE><P><LI>If the FOXUSER.DBF file is corrupted, do the following; otherwise, go to
   step 4.
<P>
   a. At the MS-DOS prompt, type the following command:
<P>
<PRE>         RENAME foxuser.dbf foxuser.dbk

   b. Restart FoxPro. A new FOXUSER.DBF file is automatically created.

</PRE><P><LI>If the problem is occurring with a distributed application, make sure
   the .ESO or .ESL files aren't corrupted. If they are, replace the
   support libraries. If the problem doesn't involve a distributed
   application, go to step 5.

<P><LI>To determine if there is a memory conflict, perform a clean boot of your
   computer. For more information on this topic, query on the following
   words in the Microsoft Knowledge Base:
<P>
<P><PRE>      clean and boot and unnecessary
</PRE>
<P><LI>Disable any video or system ROM shadowing.

<P><LI>To make sure there aren't any hard disk errors, type the following
   command at the MS-DOS prompt:
<P>
<P><PRE>      chkdsk /f
</PRE>
<P><LI>If steps 1-7 don't resolve the problem, reinstall FoxPro.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The error may have been caused by a corrupt file, and FoxPro, after
trapping for this error message, tries to close all open files in an
attempt to prevent further file corruption.
<P>
Another possibility is that there is an invalid SET TEMP in the
AUTOEXEC.BAT or CONFIG.FPW files.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 2.50a tshoot conflict<BR>
memory corrupt abnormal bnormal program termination ice<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxenvFoxuser<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
