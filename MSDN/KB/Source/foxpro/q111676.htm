

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: SHOW POPUP Does Not Work with Menu Popups </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111676">
<META NAME="KBModify" CONTENT="1997/05/06">
<META NAME="KBCreate" CONTENT="1994/02/15">
<META NAME="Keywords" CONTENT="buglist2.50 buglist2.50a buglist2.50b buglist2.50c vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The command SHOW POPUP will not show a popup defined as part of the system menu. The following example was taken from the FoxPro for Windows online help to illustrate this problem. This same code works correctly in FoxPro for MS-DOS.     *** CODE B...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QACF,QAFX,QAH4,QAEB,QAAF,QA05,QAMN,QAJX,QAEF,QADR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SHOW POPUP Does Not Work with Menu Popups</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111676</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0, 5.0a
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6x
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The command SHOW POPUP will not show a popup defined as part of the system
menu. The following example was taken from the FoxPro for Windows online
help to illustrate this problem. This same code works correctly in FoxPro
for MS-DOS.
<P>
<PRE>   *** CODE BEGINS HERE ***
   *** Name this program SHOW.PRG ***

   CLEAR

   SET SYSMENU SAVE
   SET SYSMENU TO
   DEFINE PAD cardpad OF _MSYSMENU PROMPT '\&lt;Card Info';
      COLOR SCHEME 3 KEY ALT+I, ''
   DEFINE PAD showpad OF _MSYSMENU PROMPT '\&lt;Show Card Info' ;
      COLOR SCHEME 3 KEY ALT+I, ''
   DEFINE PAD clearpad OF _MSYSMENU PROMPT 'C\&lt;lear Card Info' ;
      COLOR SCHEME 3 KEY ALT+I, ''

   ON PAD cardpad OF _MSYSMENU ACTIVATE POPUP cardinfo
   ON SELECTION PAD showpad  OF _MSYSMENU ;
      DO choice IN show WITH PROMPT( ), POPUP( )
   ON SELECTION PAD clearpad OF _MSYSMENU ;
      DO choice IN show WITH PROMPT( ), POPUP( )

   DEFINE POPUP cardinfo MARGIN RELATIVE SHADOW COLOR SCHEME 4
   DEFINE BAR 1 OF cardinfo PROMPT '\&lt;View Charges' ;
      KEY ALT+V, ''
   DEFINE BAR 2 OF cardinfo PROMPT 'View \&lt;Payments' ;
      KEY ALT+P, ''
   DEFINE BAR 3 OF cardinfo PROMPT 'Vie\&lt;w Users' ;
      KEY ALT+W, ''
   DEFINE BAR 4 OF cardinfo PROMPT '\-'
   DEFINE BAR 5 OF cardinfo PROMPT '\&lt;Charges '
   DEFINE BAR 6 OF cardinfo PROMPT '\-'
   DEFINE BAR 7 OF cardinfo PROMPT 'E\&lt;xit '

   ON SELECTION POPUP cardinfo;
      DO choice IN show WITH PROMPT( ), POPUP( )

   PROCEDURE choice
   PARAMETERS mprompt, mpopup

   IF mprompt = 'Show Card Info'
      SHOW POPUP cardinfo
      RETURN
   ENDIF

   IF mprompt = 'Clear Card Info'
      CLEAR
      RETURN
   ENDIF

   WAIT WINDOW 'You chose ' + mprompt + ;
      ' from popup ' + mpopup NOWAIT

   IF mprompt = 'Exit'
      SET SYSMENU TO DEFAULT
   ENDIF

   *** CODE ENDS HERE ***
   * Choosing "Show Card Info" from the menu does not show the popup, which
   * illustrates the problem.

</PRE><h2>RESOLUTION</h2>
 
<P>
To work around this problem, use the following syntax
<P>
<PRE>   ON SELECTION PAD cardpad OF _MSYSMENU DO choice IN show WITH PROMPT( ),;
    POPUP( )

</PRE>and place the appropriate code in CHOICE.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist2.50 buglist2.50a buglist2.50b buglist2.50c vfpbug5.0a kbbuglist<BR>
Version             : 2.5x 2.6x 3.0 5.0 5.0a<BR>
Platform            : MACINTOSH WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
