

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use Windows Larger Than Display Size </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106035">
<META NAME="KBModify" CONTENT="1995/04/18">
<META NAME="KBCreate" CONTENT="1993/10/31">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Windows generated with the Screen Builder that have dimensions larger than the display screen can be used effectively when they are accessed through ON KEY LABEL routines that use the MOVE WINDOW command, as shown below.  MORE INFORMATION  The ON K...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QAMB,QAMN,QAEF,QA5V,QAVS,QANJ,QACI,QBPL,QA9N,QAUJ,QAJQ,QAUD,QAGQ,QAQT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use Windows Larger Than Display Size</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106035</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows generated with the Screen Builder that have dimensions larger than
the display screen can be used effectively when they are accessed through
ON KEY LABEL routines that use the MOVE WINDOW command, as shown below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ON KEY LABEL routines are created in a separate .PRG file, allowing
them to be used with an unmodified existing window. If only one window is
to be used, the .SPR filename can be hard-coded; if multiple windows will
be used, the .SPR filename can be passed as a parameter. This example
illustrates using a PARAMETERS command to pass the window name; to hard-
code the window name, you can replace the variable in parentheses with the
literal window name. The .SPR file is called from within the program after
the ON KEY LABEL key traps are declared.
<P>
The following example uses two filenames: BIGWINDO.SPR and FOX_KROL.PRG.
The BIGWINDO.SPR file is used here to represent any window defined in the
Screen Builder with dimensions greater than 25 rows and 80 columns. The
FOX_KROL program contains the routines to move the window relative to the
display screen.
<P>
<P><h3>Program Assumptions</h3>
 

<UL><LI>The .SPR file and the window name are the same.
<LI>The .SPR window's upper-left corner is at 0,0 (not centered).
<LI>At least one GET field is defined within the .SPR file.
<LI>The .SPR window dimensions are larger than SROW()*SCOL().
<LI>The .SPR file is in the same directory (if not, remove the path before
   moving the window).
<P>
</UL><h3>Command-Line Syntax</h3>
 
<P>
<PRE>   DO fox_krol WITH 'bigwindo'
   * or
   * DO fox_krol  &amp;&amp; If window name is hard-coded.

</PRE><h3>FOX_KROL.PRG</h3>
 
<P>
<PRE>   *: In FOX_KROL.PRG
   *:
   PARAMETERS windo     &amp;&amp; Remove this line if window name is hard-coded.
   SET TALK OFF
   PUBLIC ROW,COL
   STORE 0 TO ROW,COL
   ON KEY LABEL alt+dnarrow DO down IN fox_krol
   ON KEY LABEL alt+uparrow DO up IN fox_krol
   ON KEY LABEL alt+rightarrow DO over IN fox_krol
   ON KEY LABEL alt+leftarrow DO back IN fox_krol

   *** FOLLOWING LINE ONLY NEEDED IF WINDOW NAME WAS PASSED IN
   **
   *
   windo=IIF('.SPR' $ UPPER(windo),windo,windo+'.spr')

   DO (windo)
   *
   ***
   **** If hard-coding the single big window name, remove both "windo"
   **** and the parentheses around it and replace them with the actual
   **** window name; do the same wherever else it is referenced below.

   ON KEY

   *:
   PROCEDURE down
   ON KEY LABEL alt+dnarrow
</PRE>&amp;&amp; turn trap off
<PRE>      IF ROW=(WROWS()-SROWS())+2
  &amp;&amp; test limits
         ON KEY LABEL alt+dnarrow DO down IN fox_krol &amp;&amp; reset key trap
         RETURN                                       &amp;&amp; can't do it
      ENDIF (row=(wrow()-srow())+2)                   &amp;&amp; already there
   MOVE WINDOW (windo) BY -1,0                        &amp;&amp; show next row
   ROW=ROW+1                                          &amp;&amp; update counter
   ON KEY LABEL alt+dnarrow DO down IN fox_krol       &amp;&amp; reset key trap

   *:
   PROCEDURE up
   ON KEY LABEL alt+uparrow                           &amp;&amp; documentation
      IF ROW=0                                        &amp;&amp; is essentially
         ON KEY LABEL alt+uparrow DO up IN fox_krol   &amp;&amp; the same as
         RETURN                                       &amp;&amp; above for all
      ENDIF (row=0)
             &amp;&amp; the routines
   MOVE WINDOW (windo) BY 1,0
   ROW=ROW-1
   ON KEY LABEL alt+uparrow DO up IN fox_krol

   *:
   PROCEDURE over
   ON KEY LABEL alt+rightarrow
   IF COL=(WCOLS()-SCOLS())+2
      ON KEY LABEL alt+rightarrow DO over IN fox_krol
      RETURN
   ENDIF (col=(wcol()-scol())+2)
   MOVE WINDOW (windo) BY 0,-1
   COL=COL+1
   ON KEY LABEL alt+rightarrow DO over IN fox_krol

   *:
   PROCEDURE back
   ON KEY LABEL alt+leftarrow
   IF COL&lt;=0
      ON KEY LABEL alt+leftarrow DO back IN fox_krol
      RETURN
   ENDIF (col&lt;=0)
   MOVE WINDOW (windo) BY 0,1
   COL=COL-1
   ON KEY LABEL alt+leftarrow DO back IN fox_krol


   *: EOF: FOX_KROL.PRG

</PRE>When this program is run, the user can move to the portions of the screen
not currently displayed by holding down the ALT key in combination with the
arrow key that points in the desired direction.
<P>
To avoid requiring the user to press ALT and an arrow key, you can
automatically advance the screen to the proper section by using KEYBOARD
commands in the WHEN or VALID clauses of the fields to call the appropriate
ON KEY LABEL routines.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a scroll<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
