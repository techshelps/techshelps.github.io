

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Code Sample to Find Application Path Using File Extension </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121441">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/10/05">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  If you know the file extension of a file type that an application uses, you can quickly determine the full path of that application by reading the [EXTENSIONS] section of the WIN.INI file (the Windows 3.x initialization file). To do this programmat...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOG,QAUD,QAH4,QDL9,QBWQ,QBWO,QBWN,QAGI,QBVP,QAML,QBIR,QAPF,QBE7,QBE6,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Code Sample to Find Application Path Using File Extension</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121441</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you know the file extension of a file type that an application uses, you
can quickly determine the full path of that application by reading the
[EXTENSIONS] section of the WIN.INI file (the Windows 3.x initialization
file). To do this programmatically from FoxPro, you can use the
FOXTOOLS.FLL library to make a call to the Windows API
GetPrivateProfileString() function, as the code example below demonstrates.
<P>
NOTE: For backward compatibility, Visual FoxPro still supports FOXTOOLS.FLL
(included in earlier FoxPro versions), the Visual FoxPro API library that
allows calls to 16-bit .DLL functions. However, in Visual FoxPro, the
DECLARE command is the preferred method for calling .DLL functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This example only works with Windows version 3.x (16-bit versions),
which use the WIN.INI file. Windows NT and Windows 95 use the Registry
instead of WIN.INI.
<P>
When you run this code, you will be prompted to enter the extension. For
example, enter a file extension such as "XLS" (without the quotation marks)
and press ENTER. If Microsoft Excel is installed, the full path to
Microsoft Excel will be returned.
<P>
<PRE>   SET LIBRARY TO SYS(2004)+"foxtools"
   @ 1,1 GET ext DEFAULT "     " SAY "Enter the extension: "
   READ
   ext=ALLTRIM(ext)
   IF LEN(ext)=0
      RETURN
   ENDIF
   mpath=REPLICATE(CHR(0),256)

   * Register and call the Windows API function.

   mregister=regfn("GetPrivateProfileString","CCC@CIC","I")
   mcall=callfn(mregister,"Extensions",ext,"",@mpath,256,"WIN.INI")

   mpath=ALLTRIM(mpath)
   CNT=OCCURS('\',mpath)  &amp;&amp; find the last backslash in the path
   IF CNT=0
      ? CHR(7)
      WAIT WINDOW "File Extension Not Found"  &amp;&amp; in the WIN.INI file
      RETURN
   ENDIF
   x=AT('\',mpath,CNT)  &amp;&amp; find the position of the last backslash
   mpath=SUBSTR(mpath,1,x-1)  &amp;&amp; extract just the path
   @ 2,1 SAY "The path to the executable is " + mpath
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00 FoxWin 2.50 2.50a 2.50b 2.50c 2.60<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
