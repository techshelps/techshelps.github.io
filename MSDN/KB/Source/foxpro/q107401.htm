

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Asynchronous UDF on DDEExecute() Is Passed Six Parameters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107401">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/11/18">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbdocerr kberrmsg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The  Language Reference  manual and the Help file incorrectly state that the asynchronous user-defined function (UDF) option of the DDEExecute() command is passed five parameters. In fact, this option requires six parameters.  MORE INFORMATION  The...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAAP,QAB9,QBBI,QAB4,QBV8,QAUD,QAH7,QAH6,QAD7,QAH4,QAGI,QAKC,QBC6,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Asynchronous UDF on DDEExecute() Is Passed Six Parameters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107401</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "Language Reference" manual and the Help file incorrectly state that
the asynchronous user-defined function (UDF) option of the DDEExecute()
command is passed five parameters. In fact, this option requires six
parameters.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The syntax of the DDEEXecute() command is:
<P>
<PRE>   DDEExecute(&lt;expN&gt;, &lt;expC1&gt;[, &lt;expC2&gt;])

</PRE>The third parameter of this command is an optional asynchronous UDF that
permits asynchronous command execution requests. It returns either a
transaction number or, if there is an error, it returns -1.
<P>
The "Language Reference" (page L3-364) and the Help file state that:
<P>
<PRE>   If &lt;expC3&gt; is omitted, a client waits for the period specified
   with DDESetOption( ). If you specify the name of a UDF with
   &lt;expC3&gt;, client program execution continues immediately after
   the command execution request is made.

   When the server application finishes executing the command,
   the UDF specified with &lt;expC3&gt; is executed. The UDF is
   passed five parameters... .

</PRE>NOTE: The syntax in the "Language Reference" and Help file incorrectly
adds an additional &lt;expCn&gt;, which is why the text refers to "&lt;expC3&gt;."
The syntax shown in this article is correct; wherever "&lt;expC3&gt;" is
mentioned in the manual and Help file, substitute "&lt;expC2&gt;."
<P>
However, the asynchronous UDF specified in the optional expression &lt;expC2&gt;
is actually passed six parameters in this order:
<P>
<PRE>     Channel Number
     Action
     Item
     Data
     Format
     Transaction Number

</PRE>The following code example demonstrates the problem with passing five
parameters to the asynchronous UDF. The code assumes that WINWORD.EXE and
the file, GRAPHICS.DOC, are located in the directory C:\WORD20C.
<P>
NOTE: The second parameter of the DDEExecute() function, '[FileOpen
"graphics.doc"]', requires single quotation marks for the outer delimiter
and double quotation marks for the inner delimiter.
<P>
<PRE>   RUN/N c:\word20c\WINWORD.EXE
   channel=DDEInitiate('WinWord','System')
   IF channel&gt;=0
      =DDEExecute(channel,'[FileOpen "c:\word20c\GRAPHICS.DOC"]',;
           'asyncUDF')
      WAIT WINDOW "Calling asynchronous UDF"
   ENDIF
   =DDETerminate(channel)

   PROCEDURE asyncUDF    &amp;&amp; asynchronous transaction UDF
   PARAMETERS mChannel, mAction, mItem, mData, mTransnum
   DISPLAY MEMORY LIKE m*
   WAIT
   RETURN .T.

</PRE>An error message, "Wrong number of parameters," will occur on the
PARAMETERS statement in the asynchronous UDF. When the error occurs, choose
the Cancel button in the error message box. To correct this error, add a
sixth parameter to the PARAMETERS statement above. For example,
<P>
<PRE>   PARAMETERS mChannel, mAction, mItem, mData, mFormat, mTransnum
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b DDE DDEExecute<BR>
asynchronous docerr errmsg err msg dynamic data exchange<BR>
KBCategory: kbinterop kbprg kbdocerr kberrmsg kbcode<BR>
KBSubcategory: FxinteropDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
