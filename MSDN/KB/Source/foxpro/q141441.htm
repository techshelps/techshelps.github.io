

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create Validation Rules on Views </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141441">
<META NAME="KBModify" CONTENT="1995/12/20">
<META NAME="KBCreate" CONTENT="1995/12/18">
<META NAME="Keywords" CONTENT="kbtool kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can easily create field and row level validation rules for Visual FoxPro Tables by using the Table Designer. For local and remote views, however, the View Designers do not give you a way to visually create validation rules. For views, validatio...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAPF,QA7O,QA7N,QAKR,QAIB,QBWT,QAML,QAEF,QBWS,QA2Q,QAXB,QAUJ,QBJZ,QBXR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Validation Rules on Views</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141441</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can easily create field and row level validation rules for Visual
FoxPro Tables by using the Table Designer. For local and remote views,
however, the View Designers do not give you a way to visually create
validation rules. For views, validation rules must be created
programmatically by using dbsetprop().
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create an Updatable Local View:
<P>
   a. Open the TestData database in Samples\Data under the main Visual
<P><PRE>      FoxPro directory.
</PRE><P>
   b. On the File menu, click New. Select View as the file type, and then
<P><PRE>      click New File.
</PRE><P>
   c. Select EMPLOYEE from the Add Table or View list.
<P>
   d. In the Fields tab of the View Designer, click Add All to move all
<P><PRE>      fields to selected output.
</PRE><P>
   e. In the Update Criteria tab, ensure that EMP_ID is marked as the key
<P><PRE>      field and all other fields are marked as Updatable (they should have
      a check mark in the pencil column). click the Send SQL Updates
      button.
</PRE><P>
   f. Under the SQL WHERE clause options, select Key Fields only, and then
<P><PRE>      save the view as EMP_VIEW.
</PRE>
<P><LI>Create a row-level Validation Rule to ensure that the Hire_date is later
   than the Birth_date:
<P>
   a. Type the following in the Command window:
<P>
<P><PRE>      =dbSetProp("Emp_view","View","RuleExpression",;
<PRE></PRE>          "Hire_date &gt;Birth_date")
      =dbSetProp("Emp_view","View","RuleText",";
          'Hire date must be after birth date' ")
      USE Emp_view
      BROWSE

   b. Change the value of hire_date to be earlier than birth_date, and then
      move off the record. The validation rule fires and the error message
      is displayed.

</PRE><P><LI>Create a field level Validation Rule to ensure that the Last_name is not
   empty by typing the following in the Command window:
<P>
   =dbSetProp("emp_view.last_name","field","RuleExpression",;
<P><PRE>      "not empty(last_name)")
</PRE>   =dbSetProp("emp_view.last_name","field","RuleText",;
<P><PRE>       " 'Last name cannot be blank' ")
</PRE>   USE Emp_view
   BROWSE
<P>
</OL>Deleting the contents of the last name field and moving to the next field
causes the validation rule to fire.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbhowto kbcode<BR>
KBSubcategory: FxtoolQueryvwdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 20, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
