

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Send an OLE Object in Mail from Within FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107831">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/11/29">
<META NAME="Keywords" CONTENT="kbole kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The FoxPro Extensions that come with the Workgroup templates enable FoxPro developers to tap into the mail messaging API (MAPI) and the Microsoft Schedule+ API (SPLUS). Below is a simple example of how to send an embedded OLE object in a mail messa...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAGI,QAH6,QACI,QAY5,QAB9,QAEV,QBHQ,QAW6,QAPN,QAJQ,QBV8,QBXS,QBBI,QA9Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Send an OLE Object in Mail from Within FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107831</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The FoxPro Extensions that come with the Workgroup templates enable FoxPro
developers to tap into the mail messaging API (MAPI) and the Microsoft
Schedule+ API (SPLUS). Below is a simple example of how to send an embedded
OLE object in a mail message from FoxPro for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The FoxPro Extensions come with FOXMAPI.FLL, MAPILIB.PRG, and MAPIERR.PRG.

<UL><LI>FOXMAPI.FLL is a DLL that is the interface between FoxPro and the
   MAPI.DLL and SPLUS.DLL.

<LI>MAPILIB.PRG is a file containing procedures that make calls to functions
   in the FOXMAPI.FLL. (Instead of calling the functions in FOXMAPI.FLL
   directly, you can pass parameters to MAPILIB.PRG, which does extra error
   checking.)

<LI>MAPIERR.PRG is called by MAPILIB.PRG if an error condition occurs when a
   procedure in MAPILIB.PRG is executing.
<P>
</UL>For more information about the functions used in this example, examine the
MAPILIB.PRG file to find the function that is called in MAPILIB.PRG and
then see what function MAPILIB.PRG calls in FOXMAPI.FLL. The Help file
located in WGTPLATE\APPENDIX\FOXPRO\FOXMAPI.HLP explains what the functions
in FOXMAPI.FLL do.
<P>
The example below will send the CARS.BMP bitmap file specified by the
variable M.PATHNAME to the person that is specified in the M.TONAMES
variable.
<P>
For the following example to work, you must have FOXMAPI.FLL, MAPILIB.PRG,
and MAPIERR.PRG. MAPILIB.PRG and MAPIERR.PRG should be located in the same
directory as the program below.
<P>
<PRE>   ** Unload any library that is in memory.
   SET LIBRARY TO

   ** SET THE LIBRARY TO FOXMAPI.FLL
   SET LIBRARY TO foxmapi.fll

   ** NOTE: MAPILIB.PRG and MAPIERR.PRG need to be in the same
   ** directory as this program for things to work properly.

   ** MAPILIB.PRG calls FOXMAPI.FLL
   ** Log on to mail and get session handle
   msession=MAPILIB('LOGON')

   ** Get info to send
   ** m.tonames- the e-mail name of the person the message is addressed
   ** to.
   ** m.subject- the subject line of the e-mail message.
   ** m.notetext- the text of the e-mail message.
   m.tonames="JOHN DOE"
   m.subject="ATTACH MAIL TEST"
   m.notetext=SPACE(200)

   m.position=1             &amp;&amp; This position is where to insert object
   m.pathname="c:\windows\cars.bmp"  &amp;&amp; Path and file of OLE object
   m.filename=""            &amp;&amp; Indicates to use pathname

   ** create mapiRecip cursor
   ** resolve name
   ** The MapiRecip cursor contains information about a message
   ** originator or recipient.
   =MAPILIB('resolve',msession,m.tonames)

   ** Create mapiFile and mapiMesg cursors.
   ** mapiFile contains information about a file attachment.
   ** mapiMesg contains information about a message.
   ** See the help file for more information.
   =MAPILIB('newcursor','mapiFile')
   =MAPILIB('newcursor','mapiMesg')

   ** Insert the needed information.
   INSERT INTO mapiFile VALUES(0,0,1,m.pathname,m.filename,;
      "")

   INSERT INTO mapiMesg VALUES(0,m.subject,m.notetext,'IPM.',;
      MAPILIB('getdate'),'',0,RECCOUNT('mapiRecip'),1)

   retval=mapilib("sendmail",msession,"mapiMesg","mapiRecip",;
      "mapiFile",0)

   ** Log off and cleanup
   ** Logging off by directly calling the mplogoff function in
   ** FOXMAPI.FLL
   =MPLogoff(msession,0,0,0)

   CLEAR ALL
   CLOSE ALL
   RELEASE ALL
   SET LIBRARY TO
   ** END OF PROGRAM
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b mapi ext<BR>
email<BR>
KBCategory: kbole kbprg kbcode<BR>
KBSubcategory: FxinteropOle<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
