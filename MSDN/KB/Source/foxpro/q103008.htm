

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create a Wait-Processing Program/Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103008">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1993/08/12">
<META NAME="Keywords" CONTENT="kbprg kbui kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In some cases, you may want to use a screen other than a thermometer bar to notify the user to wait while some commands are being executed.  The procedure below, which is divided into three parts, creates a window that specifies what commands are b...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV8,QA7N,QA7O,QAB9,QAH4,QBXS,QAUR,QAK4,QAEF,QBWS,QAG2,QA2Q,QANJ,QAGU,QAA8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a Wait-Processing Program/Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103008</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft FoxPro for Windows, version 2.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In some cases, you may want to use a screen other than a thermometer
bar to notify the user to wait while some commands are being executed.
<P>
The procedure below, which is divided into three parts, creates a
window that specifies what commands are being executed and animates a
wedge moving inside a circle. After all the commands are executed, the
window is cleared.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Creating the Bitmaps</h3>
 

<OL><P><LI>In the Accessories group in Program Manager, open Paintbrush.

<P><LI>From the Options menu, choose Image Attributes.

<P><LI>Set Width and Height to 2 inches, and choose OK.

<P><LI>Draw a circle that takes up the majority of this 2-inch square.

<P><LI>Draw two lines in a cross hair pattern so that the circle is split
    into four equal parts.

<P><LI>Save the image as SPIN.BMP.

<P><LI>Color the upper-right fourth of the circle and save it as
    SPIN1.BMP.

<P><LI>Color the lower-right fourth of the circle and save it as
    SPIN2.BMP.

<P><LI>Repeat step 8 for the next two wedges in clockwise order and save
    the next two pieces as SPIN3.BMP and SPIN4.BMP.

<P><LI>Minimize Paintbrush and start FoxPro for Windows.
<P>
</OL><h3>Creating the Database for the Bitmaps</h3>
 

<OL><P><LI>Create a database called SPIN.DBF that has one field named
    SPINPICT of type general.

<P><LI>Copy and paste bitmaps SPIN1.BMP, SPIN2.BMP, SPIN3.BMP, and
    SPIN4.BMP into the corresponding general fields in the database
    (order is important--SPIN1.BMP should be pasted into the first
    record, SPIN2.BMP should be pasted into the second record, and so
    on).
<P>
</OL><h3>Creating the Screen</h3>
 

<OL><P><LI>Create a new screen.

<P><LI>Use the Picture tool (see page U11-10 of the "User's Guide") to
    draw a graphic object that is 2 inches by 2 inches (use the
    ruler).

<P><LI>When the Screen Picture dialog box appears, choose Field.

<P><LI>In the Choose Field/Variable dialog box, select spin.spinpict, and
    choose OK.

<P><LI>Select the Scale Picture--Fill The Frame and Refresh Output Field
    options. Choose OK.

<P><LI>Select the Field tool (see page U11-10) and draw a field on the
    screen.

<P><LI>When the Field dialog box appears, select Output Field (Say) under
    Field and type "waittext" (without the quotation marks) in the box
    that is beside the Output button.

<P><LI>Under Options, select Refresh Output Field, and choose OK.

<P><LI>In the Screen Setup code for the screen, type:
<P>
       PUBLIC waittext
       waittext=" "

<P><LI>In the Cleanup and Procedures code for the screen, type:
<P>
<PRE>          PROCEDURE spinit
          FOR i=1 TO 3
             GOTO 1
             SHOW GETS
             GOTO 2
             SHOW GETS
             GOTO 3
             SHOW GETS
             GOTO 4
             SHOW GETS
          ENDFOR
          RETURN

</PRE><P><LI>In the On Screen Entry (When)... code for the screen, type:
<P>
<PRE>           waittext="Executing Command 1" &amp;&amp; Text that is displayed
                                          &amp;&amp; telling user what
                                          &amp;&amp; routine/command is being
                                          &amp;&amp; executed.

           DO spinit                      &amp;&amp; Animate the wedge moving.

           ** The WAIT WINDOW command below is for the purpose of
           ** demonstrating where to put a command to be executed and
           ** should be replaced with actual command.
           WAIT WINDOW 'Command 1'

           waittext="Executing Command 2" &amp;&amp; Text that is displayed
                                          &amp;&amp; telling user what
                                          &amp;&amp; routine/command is being
                                          &amp;&amp; executed.

           DO spinit                      &amp;&amp; Animate the wedge moving.

           ** The WAIT WINDOW command below is for the purpose of
           ** demonstrating where to put a command to be executed and
           ** should be replaced with actual command.
           WAIT WINDOW 'Command 2'
           CLEAR READ                     &amp;&amp; Clear Window/Read

</PRE><P><LI>Select the Center and Modal Screens options before generating the
    screen so that the window will come up centered and the user will
    not be able to access other menu options.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxWin 3.00 FoxWin 2.50<BR>
KBCategory: kbprg kbui kbcode<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
