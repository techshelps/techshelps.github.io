

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create Validation and Selection Popups for Fields </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119230">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/08/10">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  While the list popup available in the Screen Builder is adequate for many purposes, it lacks a number of features that are available only through programming. The following examples demonstrate two forms of popups; the first is activated when the f...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QA5V,QAH4,QAHH,QAUD,QBXS,QAAF,QBWS,QAKD,QAKC,QBXN,QAP2,QAUJ,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Validation and Selection Popups for Fields</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119230</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
While the list popup available in the Screen Builder is adequate for many
purposes, it lacks a number of features that are available only through
programming. The following examples demonstrate two forms of popups; the
first is activated when the field is entered to allow selection of
available values in a database, whereas the second is activated only after
an invalid entry is made. Both popups allow the user to type in the first
few letters to rapidly select a close match and then scroll up and down to
select the exact item. After a selection is made, the remaining fields are
filled in with the data from the selected record.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Functionality of the Popups</h3>
 
<P>
A key value created to uniquely identify a record (such as a customer
number) is usually short and cryptic, which is ideal for use with an index
and storage within a database. However, the cryptic nature of the key value
poses a problem when the value must be entered in a screen input field in
order to retrieve the matching record, as it becomes increasingly difficult
for the user to remember what the codes represent when the number of
different codes increases.
<P>
The two types of popups discussed below address this problem by presenting
a list of valid choices that correspond to the codes (such as company
names), rather than a list of valid codes.
<P>
The common code in both snippets performs the following actions:

<UL><LI>SET CONFIRM ON--Forces the user to press the ENTER key or click the
   mouse in order to select an item from the list. This prevents the first
   matching records after the user's keystrokes are acted on from being
   automatically selected.

<LI>_DBLCLICK=1.5--Sets the delay to 1.5 seconds between when the
   keystrokes are entered and when the popup attempts to find a match.
   Increase this value to allow a longer period for typing.

<LI>ACTIVATE POPUP cust--Brings up the popup for display and turns program
   control over to the popup, which awaits the selection of an item from
   the list.
<P>
</UL>The two commands following the ACTIVATE POPUP command undo the conditions
set up before activating the popup and return the settings to their
previous states.
<P>
The following steps use the TUTORIAL\CUSTOMER.DBF file to create a
screen named POPLIST.SPR for editing existing records:

<OL><P><LI>Close all databases, and then open the CUSTOMER.DBF database in the
   &lt;FoxPro_directory&gt;\TUTORIAL subdirectory.

<P><LI>Open a new screen in Screen Builder, and do one of the following:
<P>
<P><PRE>    - Create a quick screen.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - Manually place any desired fields on a new screen.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - Modify an existing screen.
</PRE>
<P><LI>Open the Setup snippet, define the popup as shown below, and set an
   event trap (ON SELECTION) to deactivate the popup after a selection has
   been made.
<P>
   In this example, a variable named CUSTNO is created to hold the CNO key
   value so that it can't be changed accidentally:
<P>
<P><PRE>      DEFINE POPUP cust FROM 1,15 PROMPT FIELDS company
      ON SELECTION POPUP cust DEACTIVATE POPUP
      custno=SPACE(5)
</PRE>
<P><LI>In the Screen Design window, double-click the CNO field and replace the
   "customer.cno" field expression name with "custno" (without the
   quotation marks). Then arrange the fields in the order of CUSTNO,
   CONTACT, COMPANY, with the remaining fields placed in whatever order is
   desired.

<P><LI>Open the Valid snippet of the CUSTNO field, and enter the following
   code:
<P>
<P><PRE>      LOCATE FOR custno=customer.cno
      *** IF SEEK(custno) instead of LOCATE if an index on CNO is set.
      IF !FOUND()
<PRE></PRE>          SET CONFIRM ON
       _DBLCLICK = 1.5
       ACTIVATE POPUP cust
       _DBLCLICK = .5
       SET CONFIRM OFF
      ENDIF
      custno=customer.cno
      SHOW GETS
      WAIT WINDOW 'Note changes...hit any key, then tab to Company'

</PRE><P><LI>Open the When snippet of the COMPANY field, and enter the following
   code:
<P>
<P><PRE>      SET CONFIRM ON
      _DBLCLICK = 1.5
      ACTIVATE POPUP cust
      _DBLCLICK = .5
      SET CONFIRM OFF
      custno=customer.cno
      SHOW GETS
</PRE>
<P><LI>Save the changes and generate POPLIST.SPR.
<P>
</OL><h3>Field Validation Popup</h3>
 
<P>
To demonstrate this type of popup, run POPLIST.SPR, and while in the CUSTNO
field, press ENTER (or type a customer number that does not exist in the
CUSTOMER database). The VALID clause attempts to locate a record whose
customer number matches the CUSTNO value you typed. If a match is found,
the record pointer is positioned on the matching record, and the SHOW GETS
command updates the screen with the new values. If no match is found, the
list of company names is presented. Type in the first few letters of a
company name, then scroll down or up to select the desired record. Press
ENTER, and then observe the new field values. The cursor should now be in
the CONTACT field.
<P>
<P><h3>Auto-Activate Popup</h3>
 
<P>
To demonstrate this type of popup, run POPLIST.SPR, and press the TAB key
to move from the CONTACT field to the COMPANY field. As soon as the cursor
leaves the CONTACT field, the company name popup list is activated. Once
the popup is open, its functionality is identical to that of the validation
popup.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50a 2.50b 2.60 picklist<BR>
getlist<BR>
listbox<BR>
list box pop-up pop up<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxtoolSbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
