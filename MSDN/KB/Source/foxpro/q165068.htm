

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: INDEX ON with Variable Length Tag May Behave Differently </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165068">
<META NAME="KBModify" CONTENT="1997/07/03">
<META NAME="KBCreate" CONTENT="1997/03/12">
<META NAME="Keywords" CONTENT="FxprgTable vfoxwin kbusage">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When attempting to create a variable length index tag in Visual FoxPro version 5.0, one of the following error messages may occur:      Cannot access characters beyond string  -or-     Invalid key length  This behavior does not occur in earlier ver...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QAYL,QAB4,QBWA,QAMB,QAH4,QBXS,QA56,QA55,QAAP,QAJH,QBVV,QAY5,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: INDEX ON with Variable Length Tag May Behave Differently</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165068</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to create a variable length index tag in Visual FoxPro
version 5.0, one of the following error messages may occur:
<P>
<P>
<PRE>   Cannot access characters beyond string

</PRE>-or-
<P>
<PRE>   Invalid key length

</PRE>This behavior does not occur in earlier versions of FoxPro.
<P>
According to the Visual FoxPro online Help, variable length index keys are
not supported in Visual FoxPro. As stated in the Help file:
<P>
<PRE>   If you attempt to build an index with a key that varies in length,
   the key will be padded with spaces. Variable-length index keys
   aren't supported in Visual FoxPro.

</PRE>In the case of Visual FoxPro 5.0, it appears that any variable length key
is not being padded.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following code creates an index tag from a variable length key but is
padded to a specific length:
<P>
<PRE>   SET TALK OFF  &amp;&amp; If TALK isn't turned off, an error will occur.
     SET SAFETY OFF
      CREATE TABLE oneproduct ;
           (PRODUCT c(15))
      SET SAFETY ON
      INSERT INTO oneproduct (PRODUCT) VALUES ("01PAN AG-1310")

       INDEX ON PADR(SUBSTR(product, AT(" ", product)+1), ;
          LEN(product)+2 ," ") TAG prod


</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following code illustrates the problem with creating a variable length
index tag:
<P>
<PRE>   SET SAFETY OFF
   CREATE TABLE oneproduct ;
        (PRODUCT c(15))
   SET SAFETY ON
   INSERT INTO oneproduct (PRODUCT) VALUES ("01PAN AG-1310")

   * The following code works without error in versions prior to 5.0
   INDEX ON SUBSTR(PRODUCT,AT(" ",PRODUCT)+1) TAG prod1
   INDEX ON RIGHT(PRODUCT,LEN(PRODUCT)-AT(" ",PRODUCT)) TAG prod2

   * The following code works without error:
   *!*   SET TALK OFF
   *!*   INDEX ON PADR(SUBSTR(product, AT(" ", product)+1), ;
   *!*     LEN(product)+2 ," ") TAG prod

</PRE>The first INDEX ON line causes the error message,
<P>
<PRE>   Cannot access characters beyond string.

</PRE>The second INDEX ON line causes the error message,
<P>
<PRE>   Invalid key length.

</PRE>This behavior does not occur in earlier versions of FoxPro and the indexes
are created without error.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: previous<BR>
Keywords            : FxprgTable vfoxwin kbusage<BR>
Version             : 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
