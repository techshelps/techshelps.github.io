

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Use of the ON SHUTDOWN Command </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110970">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/02/03">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The ON SHUTDOWN command specifies a command that executes when you try to exit FoxPro for Windows or Microsoft Windows.  MORE INFORMATION  The command specified in ON SHUTDOWN is executed if you try to exit FoxPro for Windows by double-clicking the...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QDL9,QBWO,QBWN,QBWQ,QDKA,QBV8,QAB9,QAH4,QAGQ,QAVI,QBBI,QAH8,QAJH,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Use of the ON SHUTDOWN Command</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110970</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, and 2.5b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ON SHUTDOWN command specifies a command that executes when you try to
exit FoxPro for Windows or Microsoft Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The command specified in ON SHUTDOWN is executed if you try to exit FoxPro
for Windows by double-clicking the FoxPro Control-menu box, by choosing
Exit from the FoxPro Control menu, or by issuing the QUIT command in the
Command window or in a program.
<P>
If you try to exit Microsoft Windows from the Windows Program Manager while
FoxPro for Windows is open, control is returned to FoxPro for Windows and
the command you specify in ON SHUTDOWN is executed.
<P>
The ON SHUTDOWN command is typically a DO command that executes a routine
to display a dialog box. The dialog box asks if you are sure you want to
exit the current application and FoxPro for Windows. If you want to exit
the application, the routine can close any open files, clean up the FoxPro
for Windows environment, and then execute the QUIT command. If you don't
want to exit the current application, the routine can return control to the
application.
<P>
NOTE: If you cannot exit the development version of FoxPro for Windows, try
typing "ON SHUTDOWN" (without the quotation marks) in the Command window to
clear the current ON SHUTDOWN command and allow FoxPro for Windows to exit
normally.
<P>
<P><h3>Command Window Example</h3>
 

<OL><P><LI>Type the following in the Command window:
<P>
<P><PRE>      ON SHUTDOWN DO cleanup.prg
</PRE>
<P><LI>Create a program named CLEANUP.PRG containing the following code:
<P>
<P><PRE>      WAIT WINDOW "Performing clean-up tasks" NOWAIT
      * Place the code here that you want FoxPro to execute when it
      * quits.
      QUIT  &amp;&amp; Force FoxPro to quit
</PRE>
<P><LI>Quit FoxPro using any method.
<P>
</OL>Note that the WAIT WINDOW message is displayed when you try to quit FoxPro.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxWin 2.50 2.50a 2.50b<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxtoolGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
