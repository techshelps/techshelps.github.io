

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: TYPE() Function Returns Wrong Value for Appended Records </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167406">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1997/04/24">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b FxprgTable vfoxwin kbcode kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The TYPE() function returns the wrong current value for appended records in a buffered table. The TYPE() function returns  L  for logical type for all field types in the table. This behavior occurs regardless of the type of data buffering applied t...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAP2,QA5V,QADF,QAUD,QAY5,QA7O,QA7N,QAR4,QAH4,QAMV,QAKD,QAGB,QAEF,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: TYPE() Function Returns Wrong Value for Appended Records</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167406</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The TYPE() function returns the wrong current value for appended records in
a buffered table. The TYPE() function returns "L" for logical type for all
field types in the table. This behavior occurs regardless of the type of
data buffering applied to the table.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Microsoft
Visual FoxPro version 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following program creates a table, set the data buffering property to
optimistic table buffering, and appends a blank record. Then a comparison
displays the difference between the field types of the new record and the
original table structure.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program that contains the following code:
<P>
<P><PRE>      CLEAR
      CLOSE DATA ALL
      SET MULTILOCKS ON
      CREATE TABLE TheTable (;
<PRE></PRE>        Char       C(40),;
        Date       D,;
        DateTime   T,;
        Numeric    N(20,9),;
        Double     B(9),;
        Currency   Y,;
        Logical    L,;
        Memo       M,;
        General    G,;
        Picture    P)

      ? "CURSORSETPROP('Buffer', 5)"
      = CURSORSETPROP('Buffer', 5)
      APPEND BLANK
      ? [TYPE("CURVAL('Char')") =], TYPE("CURVAL('Char')")
      ? [TYPE("OLDVAL('Char')") =], TYPE("OLDVAL('Char')")
      ? [TYPE("CURVAL('Date')") =], TYPE("CURVAL('Date')")
      ? [TYPE("OLDVAL('Date')") =], TYPE("OLDVAL('Date')")
      ? [TYPE("CURVAL('DateTime')") =], TYPE("CURVAL('DateTime')")
      ? [TYPE("OLDVAL('DateTime')") =], TYPE("OLDVAL('DateTime')")
      ? [TYPE("CURVAL('Numeric')") =], TYPE("CURVAL('Numeric')")
      ? [TYPE("OLDVAL('Numeric')") =], TYPE("OLDVAL('Numeric')")
      ? [TYPE("CURVAL('Double')") =], TYPE("CURVAL('Double')")
      ? [TYPE("OLDVAL('Double')") =], TYPE("OLDVAL('Double')")
      ? [TYPE("CURVAL('Currency')") =], TYPE("CURVAL('Currency')")
      ? [TYPE("OLDVAL('Currency')") =], TYPE("OLDVAL('Currency')")
      ? [TYPE("CURVAL('Logical')") =], TYPE("CURVAL('Logical')")
      ? [TYPE("OLDVAL('Logical')") =], TYPE("OLDVAL('Logical')")
      ? [TYPE("CURVAL('Memo')") =], TYPE("CURVAL('Memo')")
      ? [TYPE("OLDVAL('Memo')") =], TYPE("OLDVAL('Memo')")
      ? [TYPE("CURVAL('General')") =], TYPE("CURVAL('General')")
      ? [TYPE("OLDVAL('General')") =], TYPE("OLDVAL('General')")
      ? [TYPE("CURVAL('Picture')") =], TYPE("CURVAL('Picture')")
      ? [TYPE("OLDVAL('Picture')") =], TYPE("OLDVAL('Picture')")
      = TABLEREVERT(.T.)
      CLOSE DATA ALL
      DELETE FILE TheTable.DBF
      DELETE FILE TheTable.FPT
      SET MULTILOCKS OFF

</PRE><P><LI>Run the program.

<P><LI>Notice the current value of every field appears as a type logical
   (L). The TYPE() function reports the data type of each field in the
   newly appended record as a logical type. However, TYPE() reports the
   original field type correctly.
</OL> 
<PRE>Keywords          : buglist3.00 buglist3.00b FxprgTable vfoxwin kbcode kbbuglist kbfixlist
Version           : 3.0 3.0b
Platform          : MACINTOSH WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
