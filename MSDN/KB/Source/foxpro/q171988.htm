

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Passing Parameters to a Word 97 Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171988">
<META NAME="KBModify" CONTENT="1997/07/29">
<META NAME="KBCreate" CONTENT="1997/07/25">
<META NAME="Keywords" CONTENT="FxinteropWinword vfoxwin kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When using OLE automation to Microsoft Word 97, it is often desirable to pass parameters from Visual FoxPro to the Word 97 object. The Run method is normally used to execute a Word macro through OLE automation; however, the Run method cannot accept...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QBJZ,QBS0,QAD7,QBWS,QAH7,QAH6,QA36,QAHE,QDO7,QAUD,QAPN,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Passing Parameters to a Word 97 Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171988</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using OLE automation to Microsoft Word 97, it is often desirable to
pass parameters from Visual FoxPro to the Word 97 object. The Run method is
normally used to execute a Word macro through OLE automation; however, the
Run method cannot accept parameters. To pass parameters to the Word object,
there must be a public Word macro that is a method of a document or
template.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Word 97, documents and templates have their own Visual Basic for
Applications projects: a document project and a template project. Macros
can be added as a Public Sub to either the document or template project.
For illustration purposes, this article will create a public macro using
Word default Normal.dot. If the public macro is added to a document, that
document must be opened in order to call the macro.
<P>
If the public macro MainMacro is added to a user template, named
Testdot.dot stored in the Word directory on the C drive, for example, the
following code can be substituted for the oWordDoc=oWordObj.Documents.Add
in the Visual FoxPro code in the section below:
<P>
<PRE>   oWordDoc=oWordObj.documents.Add("C:\word\testdot.dot")

</PRE><h3>Steps to create the Public Word macro</h3>
 

<OL><P><LI>Start Microsoft Word 97.

<P><LI>Switch to the Visual Basic Editor by pressing ALT+F11 keys or point to
   Macro on the Tools menu, and click Visual Basic Editor.

<P><LI>On the View menu, click Project Explorer.

<P><LI>In the Project Explorer, open the Normal template project.

<P><LI>Open the Microsoft Word Objects\ThisDocument module within the
   template project.

<P><LI>Select the ThisDocument module.

<P><LI>On the View menu, click Code or right-click the ThisDocument module and
   select View Code.

<P><LI>In the code window for Normal-ThisDocument, enter the following macro:
<P>
<P><PRE>      Public Sub Mainmacro(str As String, int1 As Integer)
<PRE></PRE>         MsgBox str         'Display the string from VFP
         MsgBox int1        'Display the number from VFP
      End Sub

</PRE><P><LI>On the File menu, click Save Normal, then re-select the File menu
   and click "Close and Return to Microsoft Word."
<P>
</OL><h3>Visual FoxPro code</h3>
 
<P>
Create a new program and enter the following code:
<P>
<PRE>   CLEAR
   PUBLIC cname,nnum
   cname=SPACE(15)
   nnum=0
   @ 2,2 SAY "Enter a name to display" GET cname
   @ 4,2 SAY "Now enter a number     " GET nnum
   READ
   oWordObj=CREATEOBJECT('word.application')
   oWordDoc=oWordObj.Documents.Add
   oWordDoc.MainMacro(cname,nnum)
   oWordObj.QUIT

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Word Visual Basic Help
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Dean Christopher, Microsoft Corporation
<P>
 
<PRE>Keywords          : FxinteropWinword vfoxwin kbcode
Technology        : kbole
Version           : WINDOWS:3.0,3.0b,5.0,5.0a
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
