

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Add Controls to a Form Generated by the Form Wizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134704">
<META NAME="KBModify" CONTENT="1996/12/02">
<META NAME="KBCreate" CONTENT="1995/08/09">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You may sometimes need to add a control to a form generated by the Form Wizard. No additional coding is necessary if you're adding a text box. However, if you're adding another type of control, such as a combo box or a list box, additional coding i...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QAHP,QBT6,QAPN,QAH4,QBVR,QA7O,QAOE,QAMN,QAB5,QBV3,QBXS,QADZ,QAKJ,QA4P V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Add Controls to a Form Generated by the Form Wizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 2, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134704</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You may sometimes need to add a control to a form generated by the Form
Wizard. No additional coding is necessary if you're adding a text box.
However, if you're adding another type of control, such as a combo box or a
list box, additional coding is required.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Form Wizard uses the Wizstyle visual class library. Code for the
navigation buttons is stored in this library. When a text box is added to
the form, it functions exactly like the text boxes added by the wizard. It
is enabled and disabled by the edit/revert and add/save buttons. However,
if another control, such as a combo or list box, is added, it's not enabled
or disabled by these buttons, so it remains enabled all the time.
<P>
Listed below are two different methods to add this functionality. The first
one works on combo and list boxes. The second method, which is not
supported by Microsoft Technical Support applies to combo boxes only.
<P>
<P><h3>Method 1 - List and Combo Box</h3>
 
<P>
The list and combo box can be enabled and disabled in sync with the text
boxes by setting the enabled property of list or combo box to false and
adding the following code to the edit/revert and add/save buttons, assuming
combo1 is the name of the added combo box and text1 is the name of an
existing text box on the form:
<P>
<PRE>   txtbtns.cmdEdit::click     &amp;&amp; cmdEdit will be cmdAdd for the Add button
   thisform.combo1.enabled= thisform.text1.enabled   &amp;&amp; See following NOTE
   thisform.refresh

</PRE>NOTE: This code causes the combo box to become enabled and disabled in sync
with the text box. The first line of code with the scope resolution
operator ensures that the click method of the Edit button stored in the
WIZSTYLE.VCX is executed.
<P>
<P><h3>Method 2 - Combo Box</h3>
 
<P>
NOTE: Modifications to WIZSTYLE.VCX are not supported by Microsoft FoxPro
Technical Support. This information is provided for informational reasons
only.
<P>
Modify the SetAllProp method of the TxtBtns class in WIZSTYLE.VCX as
follows:
<P>
<PRE>   1. Change the line

      CASE ATC(m.oControlParent.Controls[m.i].BaseClass,
      "Checkbox,TextBox,OleBoun Control") # 0

   to

      CASE ATC(m.oControlParent.Controls[m.i].BaseClass,
      "CheckBox,TextBox,OleBoun Control,ComboBox") # 0

   NOTE: The CASE statements above should actually be continuous lines.
   They were broken into two lines here for display purposes only.

</PRE>This will allow combo boxes added to any Form Wizard-generated forms to
be enabled and disabled along with other objects, so long as the enabled
property is initially set to .F. for each new control.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxMac 3.00b 3.00 VFoxWin combobox<BR>
listbox Form Wizard<BR>
KBCategory: kbtool<BR>
KBSubcategory: FxtoolWizscreen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 2, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
