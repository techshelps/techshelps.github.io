

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Switching to PostScript on HP LaserJet IIISi </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95724 ">
<META NAME="KBModify" CONTENT="1995/04/17">
<META NAME="KBCreate" CONTENT="1993/02/21">
<META NAME="Keywords" CONTENT="kbprint">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To print from the Command window to a Hewlett-Packard (HP) LaserJet IIISi printer in PostScript mode when the printer's default setting is PCL mode, you must perform the procedure below before using the ? command.  MORE INFORMATION  Before running ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBXS,QACT,QADF,QAKR,QAHE,QAH4,QAN8,QA5W,QBE7,QBE6,QAUD,QAB9,QAY2,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Switching to PostScript on HP LaserJet IIISi</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95724 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To print from the Command window to a Hewlett-Packard (HP) LaserJet IIISi
printer in PostScript mode when the printer's default setting is PCL mode,
you must perform the procedure below before using the ? command.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Before running the code, make sure that the printer is configured for AUTO
CONT=ON *. This can be accomplished from the printer's control panel as
follows:

<OL><P><LI>Press the ON LINE key to take the printer off line. The  indicator light
   should turn off.

<P><LI>Hold the MENU key down for about 5 seconds. The message PCL  CONFIG MENU
   should appear first, followed by SYS=HP-PCL *.

<P><LI>Repeatedly press the MENU key until AUTO CONT=OFF * appears. If it is
   already set to ON, skip to step 6.

<P><LI>Press the + key. AUTO-CONT=ON should appear.

<P><LI>Press the ENTER key to save your choice. AUTO CONT=ON * should appear.

<P><LI>Press the RESET key, then the ON LINE key.
<P>
</OL>The printer is now set for automatic switching from PCL mode to PostScript
mode.
<P>
The following code must be run to automatically switch the printer from PCL
mode to PostScript mode:
<P>
<PRE>   SET TALK OFF
      ** talk is directed to the screen
   SET PDSETUP TO "postscript"
      ** loads the printer driver setup
   SET LIBRARY TO c:\foxpro2\goodies\pdrivers\psapi.plb
      ** specifies external library
   SET PRINTER TO
      ** specifies printer's default port
   SET PRINT ON
      ** enables printing

   x=set("pdset")
      ** initializes memory variable "x"
   SET PDSETUP TO
      ** unloads printer driver
   DO PS
      ** procedure call to switch printer
   ? pddocst(_plength, 128)
      ** loads PS code to start printing
   SET PDSETUP TO (x)
      ** loads driver to memory variable x"

   ? "this is a test of HPLJ IIISi PostScript"
      ** test sentence to print

   SET PDSETUP TO
      ** unloads printer driver
   ?pddocend()
      ** loads code to terminate print job
   DO PCL
      ** procedure call to switch printer back to PCL mode
   SET PRINT OFF
      ** disables output to the printer
   SET PRINTER TO
      ** sets printer port to default
   SET LIBRARY TO
      ** resets to default

   *** Procedure to send printer escape sequence to switch to
   *** PostScript

   PROCEDURE PS
   ??? CHR(27)+'%-12345X@PJL enter language=postscript'

   *** Procedure to send printer escape sequence to switch to PCL

   PROCEDURE PCL
   ??? CHR(27)+'%-12345X@PJL enter language=pcl'

   ***End of Program Code ***

</PRE></OL>When you are printing in PostScript mode, the left margin will occasionally
need to be adjusted to enable the first few characters to print in full.
Adjust the left margin in the PostScript printer driver setup dialog box by
choosing Printer Setup from the File menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos 2.00 2.50 2.50a Post Script III Si<BR>
pdparms<BR>
KBCategory: kbprint<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
