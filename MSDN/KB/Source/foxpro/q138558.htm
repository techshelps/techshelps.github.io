

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: INKEY() May Return Same ASCII Values for Different Keys </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138558">
<META NAME="KBModify" CONTENT="1995/10/25">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using INKEY() to trap for a keystroke can sometimes lead to unexpected results. For example, INKEY() will return the same value, 19, for the LEFT ARROW key and ALT+R. This effect may be altered by using the following command before using the INKEY(...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QBN4,QAM0,QAUD,QBWS,QAJQ,QAA7,QAGB,QAQT,QBV8,QAB9,QAH4,QAY5,QAMN,QAL3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: INKEY() May Return Same ASCII Values for Different Keys</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138558</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using INKEY() to trap for a keystroke can sometimes lead to unexpected
results. For example, INKEY() will return the same value, 19, for the LEFT
ARROW key and ALT+R. This effect may be altered by using the following
command before using the INKEY():
<P>
<PRE>   SET COMPATIBLE DB4

</PRE><h2>RESOLUTION</h2>
 
<P>
Use the SET COMPATIBLE DB4 command immediately before you use the INKEY()
function. Then use the SET COMPATIBLE OFF command after using INKEY(). This
may have side effects. Please see SET COMPATIBLE DB4 in the Help file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Certain commands and functions in FoxPro, including INKEY(), behave
differently depending on the SET COMPATIBLE setting. For more information,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q114752.htm">Q114752</A></B>
   TITLE     : Commands and Functions Affected by SET COMPATIBLE

</PRE><h3>Step-by-Step Resolution</h3>
 
<P>
Using INKEY(0,'M') to trap for a key or mouse click, you can distinguish
which key was pressed by using the following loop example.

<OL><P><LI>Place the following code into a program (.prg) file, and then run it.
<P>
   i=1
   tmpcompt=SET('COMPATIBLE')
   SET COMPATIBLE OFF
<PRE>   FOR i= 1 TO 2                         &amp;&amp; Sets up 2 passes in loop
      DEFINE WINDOW keypress FROM 4,4 TO 20,75 DOUBLE TITLE "This is with ;
          Set Compatible "+ IIF(SET('COMPATIBLE') ='ON','DB4','OFF')
      ACTIVATE WINDOW keypress
      @ 6,16 SAY 'Press a key to start or press the Esc key to quit'
      @ 8,16 SAY ':'
      keyvar = 0             &amp;&amp; Initialize inkey system memory variable


      *** Main program loop ***
      DO WHILE .T.
         keyvar = INKEY(0,'M')    &amp;&amp; Get INKEY() value
         IF keyvar = 0            &amp;&amp; No key press or mouse click
             LOOP                 &amp;&amp; Creates Wait State
         ENDIF
         IF keyvar = 27           &amp;&amp; ESC key pressed, exit main loop
             EXIT
         ENDIF
         IF keyvar # 151          &amp;&amp; Not a mouse click
             CLEAR
             @ 10,16 SAY 'The ASCII code for the key you hit is ' + ;
                 ALLTRIM(STR(keyvar))
         ENDIF
      ENDDO                       &amp;&amp; End of Main loop
      RELEASE WINDOW keypress
      SET COMPATIBLE DB4
   ENDFOR
   SET COMPATIBLE &amp;tmpcompt

</PRE><P><LI>Try pressing ALT+R and the LEFT ARROW key. Each will return an ASCII
   equivalent of 19 because the first time through, COMPATIBLE is set OFF.

<P><LI>Press the ESC key. The window will come back up with SET COMPATIBLE DB4.

<P><LI>Try pressing ALT+R, and the LEFT ARROW key again. ALT+R returns -418 and
   LEFT ARROW still returns 19.
<P>
</OL>You can use this technique to maintain a distinction between hot keys and
other keystrokes.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 25, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
