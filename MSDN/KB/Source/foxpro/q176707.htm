

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error "Not enough Diskspace" When Closing a Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176707">
<META NAME="KBModify" CONTENT="1997/11/26">
<META NAME="KBCreate" CONTENT="1997/11/13">
<META NAME="Keywords" CONTENT="FxprgTable VFoxMac vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  WARNING: The information in this article has not been confirmed or tested by Microsoft. Some or all of the information in this article has been taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS A...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QAB4,QBVV,QAAP,QA56,QA55,QAGB,QAH4,QDLP,QABA,QBWS,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error "Not enough Diskspace" When Closing a Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176707</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
<LI>Microsoft Visual FoxPro for Macintosh, version 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
WARNING: The information in this article has not been confirmed or tested
by Microsoft. Some or all of the information in this article has been taken
from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION
PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this
information "as is" without warranty of any kind, either expressed or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
When you try to close a table (.dbf) file located on a CD-ROM that is not
marked as read-only and also contains international characters, you may
receive this error:
<P>
<PRE>   Not enough diskspace.

</PRE>In Visual FoxPro for Macintosh the program may fail with the following
message:
<P>
<PRE>   The application Visual FoxPro for Macintosh has unexpectedly quit,
   because an error of type 3 occurred. You should save your work in
   other open applications and restart the computer.

</PRE><h2>CAUSE</h2>
 
<P>
The table is located on a CD-ROM and the file is not marked as read-only.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Add the NOUPDATE clause to the USE command that opens the table.
<P>
NOTE: Selecting the "Open As Read-Only" check box adds the NOUPDATE clause
to the USE command that is then executed.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Burn a custom CD-ROM to include a table file that meets the following
   conditions:
<P>
   - Table contains either a character field with international extended
<P><PRE>     characters (such as an umlaut) or contains a standard memo field with
     international extended characters.
</PRE><P>
   - Table codepage is marked as 0, which means that the table was saved
<P><PRE>     without a codepage tag.
</PRE><P>
   NOTE: FoxPro program Cpzero.prg will cause this error to occur.
<P>
   - Table is burned onto a CD-ROM without having its file attribute marked
<P><PRE>     as read only.
</PRE><P>
   NOTE: Most CD-ROM software sets the read-only attribute by default and
   there may not be an option to change this behavior.

<P><LI>Add the following environment settings in the Config.fpw:
<P>
<PRE>      CODEPAGE = AUTO    &amp;&amp; Without this setting problem will not occur.
      EXCLUSIVE = ON

</PRE><P><LI>Open the table.

<P><LI>An informational dialog is displayed entitled "Code Page" that
   contains the following message:
<P>
<P><PRE>      File &lt;filename.dbf&gt; is not marked with a code page. Please select the
      code page it was created in.
</PRE><P>
   By default the Platform option button is set to All and the Code Page
   list box is set to 1252 - Windows ANSI. Click the Select button.

<P><LI>Close the table with the following FoxPro command:
<P>
<P><PRE>      USE
</PRE><P>
   The error message below is displayed:
<P>
<P><PRE>      Not enough diskspace.
</PRE><P>
</OL>NOTE: This same test can be performed on a write-protected floppy disk.
However, the error message is worded differently depending on the operating
system being used.
<P>
On Windows NT 4.0 the following error messages appear, but on Windows 95
only the second error message appears.
<P>
<PRE>   Vfp.exe -  Write Protect Error
   The disk cannot be written to because it is write protected. Please
   Remove the write protection from the volume in Drive A:

      [Abort]  [Retry]  [Ignore]

   Selection of the [Abort] or [Ignore] button generates the error dialog
   box:

      Microsoft Visual FoxPro
      Error writing to file.

         [OK] [Help]

</PRE></OL>(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Perry Newton, Microsoft Corporation
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Visual FoxPro for Windows Online Help; 3.0, 3.0b, 5.0, 5.0a;
search on: Code Page Dialog Box
<P>
Microsoft Visual FoxPro for Macintosh Online Help; version 3.0b; search on:
Code Page Dialog Box
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : FxprgTable VFoxMac vfoxwin<BR>
Version           : MACINTOSH:3.0b; WINDOWS:3.0,3.0b,5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
