

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Inconsistant Results with SET RELATION TO Command </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158240">
<META NAME="KBModify" CONTENT="1997/01/13">
<META NAME="KBCreate" CONTENT="1996/10/25">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Issuing the SET RELATION TO command repeated times within a program causes inconsistent results to appear in Browse windows and in Grids. While cycling through the program, some iterations do not show the proper one-to- many relationships between r...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QAMB,QAH4,QA7O,QA7N,QA28,QATJ,QBWA,QA5V,QAJX,QAC2,QAGB,QAEF,QADR,QAAW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Inconsistant Results with SET RELATION TO Command</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158240</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Issuing the SET RELATION TO command repeated times within a program causes
inconsistent results to appear in Browse windows and in Grids. While
cycling through the program, some iterations do not show the proper one-to-
many relationships between records in the Browse window or Grid object. The
placeholder characters (asterisks) in the child record appear in different
columns when you repeatedly executes the program.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code example below illustrates this behavior.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a program called Test that contains the following code:
<P>
<P><PRE>      IF !(FILE('custfree.dbf') AND FILE('ordfree.dbf');
<PRE></PRE>         AND FILE('ordifree.dbf'))
      CLOSE ALL
      SET DEFAULT TO c:\vfp5\samples\DATA
      USE customer
      COPY TO custfree
      USE orders
      COPY TO ordfree
      USE orditems
      COPY TO ordifree
      USE ordifree
      INDEX ON order_id TAG order_id
      USE ordfree
      INDEX ON cust_id TAG cust_id
      USE custfree
      INDEX ON cust_id TAG cust_id
      ENDIF

      CLOSE ALL

      ON KEY LABEL f2 CLEAR EVENTS
      FOR i=1 TO 10

      CLOSE ALL

      OPEN DATABASE testdata

      USE customer

      SELECT 0
      USE ordifree
      SET ORDER TO TAG order_id

      SELECT 0
      USE ordfree
      SET ORDER TO TAG cust_id
      SET RELATION TO order_id INTO ordifree

      SET SKIP TO ordifree

      SELECT 0
      USE custfree
      SET RELATION TO cust_id INTO ordfree

      SET SKIP TO ordfree,ordifree
      BROW LAST FIELDS custfree.cust_id,ordfree.order_id, ;
         ordifree.line_no NOWAIT TITLE 'two'
      READ EVENTS

      NEXT
      ON KEY LABEL f2
      CLOSE ALL
      CLEAR ALL

</PRE><P><LI>Execute the program and note that asterisk characters appear in the
   Order_id field and data appears in the Line_no field.

<P><LI>Press F2 and note that the display reverses. The Line_no field now
   contains asterisk characters and the Order_id field contains data. As
   you continue to press F2 to reissue the SET RELATION TO command, these
   fields continue to alternate their contents.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: FxprgRelation<BR>
Additional reference words: kbdse 3.00 3.00b 5.00 VFoxWin
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
