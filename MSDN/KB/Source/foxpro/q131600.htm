

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Customize RightClick Behavior </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131600">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/06/14">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Under certain circumstances, you may want to customize the behavior of the right mouse button. In Visual FoxPro, you usually click the right mouse button to bring up additional popup menus. This article shows by example how to do the same thing in ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAMB,QAC2,QAH4,QAQ7,QAVX,QAVW,QACF,QBV8,QAY5,QAPF,QAGB,QAFX,QAAF,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Customize RightClick Behavior</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131600</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under certain circumstances, you may want to customize the behavior of
the right mouse button. In Visual FoxPro, you usually click the right mouse
button to bring up additional popup menus. This article shows by example
how to do the same thing in your applications. You can present the user
with a popup menu of choices (including a choice to Exit) when the user
clicks the right mouse button.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You cannot change the default behavior of the _Screen.RightClick method, so
instead of using the RightClick method, use an ON KEY LABEL RIGHTMOUSE
command to achieve the desired result.
<P>
For example, the following code sample defines a window for the popup,
builds the popup, and then executes a WAIT WINDOW showing the user's
choice.
<P>
To make the following code example work, type the following command in the
Command window:
<P>
<PRE>   ON KEY LABEL RIGHTMOUSE DO RightPop

</PRE>Note that for this example, when you press the ESC key, the ON KEY LABEL
definitions are reset, so this only works for a single pass as it is
written. To force the definition for the right mouse button to remain in
effect even after the ESC key is pressed, comment out the ON KEY LABEL
RIGHTMOUSE command in RelWind procedure.
<P>
NOTE: To place the popup at the mouse pointer's location, use the MCOL()
and MROW() functions to retrieve the X &amp; Y coordinates for use when
defining the popup's window.
<P>
<P><h3>Code Sample</h3>
 
<P>
*------------------------------------------------------------------------*
<PRE>* Program: RightPop                                                      *
* Purpose: Demonstrate how to mimic the behavior of the right mouse      *
*          button in Visual FoxPro.                                     *
</PRE>*------------------------------------------------------------------------*
ON KEY LABEL esc DO RelWind IN RightPop
<P>
DEFINE WINDOW test FROM 0,0 to 5,12 FLOAT CLOSE NOMINIMIZE
<P>
DEFINE POPUP conversion MARGIN RELATIVE SHADOW COLOR SCHEME 4 ;
<PRE>   IN WINDOW test
</PRE>DEFINE BAR 1 OF conversion PROMPT 'Ar\&lt;ea' KEY CTRL+E, '^E'
DEFINE BAR 2 OF conversion PROMPT '\&lt;Length' ;
<PRE>   KEY CTRL+L, '^L'
</PRE>DEFINE BAR 3 OF conversion PROMPT 'Ma\&lt;ss' ;
<PRE>   KEY CTRL+S, '^S'
</PRE>DEFINE BAR 4 OF conversion PROMPT 'Spee\&lt;d' ;
<PRE>   KEY CTRL+D, '^D'

</PRE>ON SELECTION POPUP conversion;
<PRE>   DO choice IN RightPop WITH PROMPT( ), POPUP( )
</PRE>ACTI WINDOW test
ACTIVATE POPUP conversion NOWAIT
<P>
PROCEDURE choice
PARAMETERS mprompt, mpopup
WAIT WINDOW 'You chose ' + mprompt + ;
<PRE>    ' from popup ' + mpopup NOWAIT

</PRE>PROCEDURE RelWind
On Key Label Esc
On Key Label RightMouse
Release Window Test
*----------------------------&lt; End program code &gt;------------------------*
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00  VFoxWin _SCREEN rightclick<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
