

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Obtaining Network User IDs from Within FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99921 ">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1993/06/10">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  To create unique filenames based on individual workstation operators, each user's identification (ID) must be obtained from the environment. Third-party API libraries that can interface with the network to provide this information are available; ho...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QA4H,QAVZ,QBW7,QAFI,QAH6,QABA,QAD7,QAYL,QAH7,QAB9,QAP2,QBV8,QAY2,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Obtaining Network User IDs from Within FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99921 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To create unique filenames based on individual workstation operators,
each user's identification (ID) must be obtained from the environment.
Third-party API libraries that can interface with the network to
provide this information are available; however, you can also use a
batch file to capture the user IDs during interactive logins if only
medium security is required.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To capture a user ID, you must create a batch file with the same name
as the command normally executed to log in. For example, if the normal
method is to type LOGIN followed by an ID, the batch file would be
named LOGIN.BAT.
<P>
To create the file:

<OL><P><LI>In a text editor, create a new file with the appropriate name.

<P><LI>Within the new file, type the following:
<P>
<P><PRE>      SET USER=%1
      CD NET
      LOGIN %1
</PRE>
<P><LI>Save the file in the root directory.
<P>
</OL>The next time the machine completes startup, LOGIN and the user ID are
typed in as normal, but at subsequent logins, the LOGIN.BAT file will
intercept the user ID and assign the ID (passed as the first parameter
on the command line, [%1]) to the MS-DOS environment variable USER and
then pass it to the original LOGIN program in the NET subdirectory.
<P>
If the network LOGIN file is found through the MS-DOS PATH statement,
place LOGIN.BAT in the root directory so that it will be executed
first. However, if the AUTOEXEC.BAT selects the subdirectory where the
original LOGIN program is found, you need to modify AUTOEXEC.BAT to
find LOGIN.BAT first. For added security, you can mark the LOGIN.BAT
file as Hidden with the MS-DOS ATTRIB command.
<P>
Once the login is finished and FoxPro is running, the ID can be
retrieved with the GETENV() function. The following commands
demonstrate its usage:
<P>
<PRE>   usrname=GETENV("USER")

</PRE></OL>The variable usrname contains the user ID.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxWin 3.00 FoxDos FoxWin 2.00 2.50 2.50a<BR>
password logon<BR>
KBCategory: kbnetwork kb3rdparty kbprg<BR>
KBSubcategory: FxinteropGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
