

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FoxPro for Windows Language Tips and Tricks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118524">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1994/07/21">
<META NAME="Keywords" CONTENT="FxprgFoxtools kbcode kbinterop kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This information is also available in FoxPro's online Help.  To go directly to this topic, choose the  Tips and Tricks  Help topic. Then do one of the following, depending on which online Help file is in use:   - FOXHELP.HLP: Choose the  Language T...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAB9,QBWS,QBV8,QBXS,QBSO,QBKX,QBVV,QATX,QAH4,QAUD,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FoxPro for Windows Language Tips and Tricks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118524</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.60
WINDOWS
kbinterop kbtool kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This information is also available in FoxPro's online Help.
<P>
To go directly to this topic, choose the "Tips and Tricks" Help topic. Then
do one of the following, depending on which online Help file is in use:

<UL><LI>FOXHELP.HLP: Choose the "Language Tips" jump text.

<LI>FOXHELP.DBF: Scroll to the "Language Tips" heading.
<P>
</UL>NOTE: Additional tips are available in the Microsoft FoxPro for Windows
Resource Kit. For more information about the Resource Kit, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q112311.htm">Q112311</A></B>
   TITLE     : FILE: Fw1003.exe FoxPro for Windows 2.5x Resource Kit

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Moving a Screen Object
 
<P>
Use _CUROBJ to move to a particular screen object. This object can even be
itself. You might want to do this in order to change the value of an
@...GET object while in that object's VALID clause.
<P>
The following example changes the value of x without leaving the @...GET.
When you set the value of _CUROBJ, try to avoid hard-coding an actual
number there because reordering fields in the Screen Builder can cause
unexpected results.
<P>
<PRE>   x = some_value
   _CUROBJ = _CUROBJ
   RETURN .T.

</PRE>To avoid hard coding a value, use an expression like:
<P>
<PRE>   _CUROBJ = OBJNUM(myvar)

</PRE><h3>RUN Command</h3>
 
<P>
The RUN command in FoxPro for Windows has a new /N parameter that allows
you to launch a Windows-based application:
<P>
<PRE>   RUN /N C:\WORD\WINWORD.EXE README.DOC

</PRE>The Microsoft Windows Control Panel contains many utilities that you can
use in your applications. You can also call these utilities using the RUN
command:
<P>
<PRE>   RUN /N CONTROL COLOR
   RUN /N CONTROL PRINTERS
   RUN /N CONTROL DESKTOP

</PRE><h3>Drives and Directories</h3>
 
<P>
Several FoxPro functions can be used to obtain information about drives and
directories. Compare the returned values after issuing the command SET
DEFAULT TO C:\FOXPROW.
<P>
Drive:
<P>
<PRE>   SYS(5) = C:
   SET('DEFAULT') = C:

</PRE>Directories:
<P>
<PRE>   CURDIR() = \FOXPROW\
   SYS(2003) = \FOXPROW
   FULL(SET('DEFA')) = C:\FOXPROW\

</PRE>You can also use the ADIR() function to see if a specific directory exists.
The following example returns 0 only if the path name does not exist.
Remember that the path to a network server may not exist if the network
connection is broken.
<P>
<PRE>   ADIR(temparr,'C:\FOXPROW\*.*','D')=0

</PRE><h3>USE Command</h3>
 
<P>
You can issue the command USE IN 0 to open a table/.DBF in the first
available work area. This command does not select that work area in which
it opened the table/.DBF. You must use the SELECT command to do this. You
can issue the command USE IN &lt;alias&gt; to close a table/.DBF without
selecting its work area.
<P>
A new SHARED clause for the USE command allows you to open a table/.DBF for
shared use without using the SET EXCLUSIVE command. For more information
about the USE command, refer to the USE topic.
<P>
<P><h3>Cross-Tab Output to Spreadsheets</h3>
 
<P>
Run the GENXTAB program to create cross-tabulated output that you can COPY
TO or EXPORT to a spreadsheet.
<P>
<P><h3>Custom Messages</h3>
 
<P>
You can display custom messages in the FoxPro status bar. To do this, SET
TALK OFF then use the SET MESSAGE TO &lt;expC&gt; command to specify a message.
(You can pass a null string to display nothing.) SET MESSAGE TO without a
parameter will restore the status bar to its normal functionality.
<P>
<P><h3>Preprocessor Directives</h3>
 
<P>
Do not use _WINDOWS, _DOS, _MAC, or _UNIX with preprocessor directives
(that is, #IF...#ENDIF). These are designed to be runtime variables. For
example the following will NOT work:
<P>
<PRE>   #define _DOS .t.
   #define _WINDOWS .f.

   * For code compiled in MS-DOS, the following would not work:

   DO CASE
       CASE _DOS
           ? "Running in MS-DOS"
       CASE _WINDOWS
           ? "Running in Windows"
   ENDCASE

</PRE>This code would not work because _DOS would be changed to .T. and _WINDOWS
would be changed to .F. so that the code could never work properly again.
Instead use the following:
<P>
<PRE>   #if "Win" $ VERS()
   #define WINDOWS_CODE .t.
   #elif "Mac" $ VERS()
   #define MAC_CODE .t.
   #elif "Unix" $ VERS()
   #define UNIX_CODE .t.
   #else
   #define DOS_CODE .t.
   #endif

   #if WINDOWS_CODE
   ? "Compiled under WINDOWS"
   #elif DOS_CODE
   ? "Compiled under MS-DOS"
   #endif

</PRE><h3>Prevent Preprocessor Substitution in Text Strings</h3>
 
<P>
#DEFINE prevents preprocessor substitution in text strings. Note that []
can be used to delimit text strings. This means that no substitution will
be made in the following:
<P>
<PRE>   #DEFINE nosub 1

   DECLARE an_array(3)

   ***This will cause a 'variable NOSUB not found' error because no
   ***substitution was made

   ? afunc[an_array[nosub]]

   FUNCTION afunc
   PARAMETER x
   RETURN x

</PRE><h3>Development Tools</h3>
 
<P>
The FOXTOOLS.FLL file, which is located in your FoxPro for Windows root
directory, contains a variety of functions that you can use to enhance your
applications. Many of these functions provide access to API routines and
Microsoft Windows functions. You can view these using the DISPLAY STATUS
command (after you SET LIBRARY TO foxtools).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.60 on-line<BR>
KBCategory: kbinterop kbtool kbprg kbcode<BR>
KBSubcategory: FxprgFoxtools<BR>
Keywords          : FxprgFoxtools kbcode kbinterop kbprg kbtool<BR>
Version           : 2.60<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
