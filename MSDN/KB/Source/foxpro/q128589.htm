

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Add Yearly Quarters to a Query for Use in Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128589">
<META NAME="KBModify" CONTENT="1995/06/27">
<META NAME="KBCreate" CONTENT="1995/04/04">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When doing a query with more then one table being output to a report, you may need to have one of the groups in the report be Yearly Quarters. This article shows by example how to use two tables in a query being output to a Report that is grouped b...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QABO,QA50,QBXS,QAB5,QAUD,QAGF,QBWS,QALS,QADZ,QAE5,QAB9,QAMB,QAWH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Add Yearly Quarters to a Query for Use in Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128589</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, version 2.6a
<LI>Microsoft FoxPro for Macintosh, version 2.6a
<LI>Microsoft FoxPro for MS-DOS, version 2.6a
<LI>Microsoft FoxPro for Unix, version 2.6
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When doing a query with more then one table being output to a report, you
may need to have one of the groups in the report be Yearly Quarters. This
article shows by example how to use two tables in a query being output to a
Report that is grouped by Yearly Quarter, Company, and State with Subtotals
for each group on the Invoices Amounts.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The CUSTOMER.DBF and INVOICES.DBF tables are in FoxPro's Tutorial
Directory. They are used in this example. You may want to change some of
the Invoice Dates in the INVOICES.DBF table so you'll have a broader date
range.

<OL><P><LI>Issue the following command:
<P>
   SET DEFAULT TO SYS(2004)+'\tutorial'

<P><LI>Issue the following command:
<P>
   MODIFY REPORT Qtr &amp;&amp; Creates a new Report named Qtr

<P><LI>Choose Data Grouping from the Report Menu.

<P><LI>Choose the Add Button, and Add a Group named Qtr. Then Click OK.

<P><LI>Choose the Add Button again, and add a Group named State. Click OK.

<P><LI>Choose the Add Button again, and add a Group named CNO. Click OK.

<P><LI>Click OK on the Data Grouping Dialog Box.

<P><LI>Use the Field Tool to add a field to the Qtr group header band.

<P><LI>Enter "year 19"+LEFT(qtr,2)+" qtr "+RIGHT(ALLTRIM(qtr),1) in the
   Expression Box for the Field. This will Print the Year and the Quarter.

<P><LI>Use the Field Tool to add a field to the State group header band.

<P><LI>Enter "State" without the quotation marks in the Expression Box for the
<P><PRE>    Field.
</PRE>
<P><LI>Use the Field Tool to add a field to the CNO group header band.

<P><LI>Enter "CNO" without the quotation marks in the Expression Box for the
<P><PRE>    Field.
</PRE>
<P><LI>Use the Field Tool to add a field to the Detail band.

<P><LI>Enter "INO" without the quotation marks in the Expression Box for the
<P><PRE>    Field.
</PRE>
<P><LI>Use the Field Tool to add a second field to the Detail band.

<P><LI>Enter "ITOTAL" without the quotation marks in the Expression Box for
<P><PRE>    the Field.
</PRE>
<P><LI>Use the Text Tool to add the text "Company Total" without the quotation
<P><PRE>    marks to the CNO group footer band.
</PRE>
<P><LI>Use the Field Tool to add a field to the CNO group footer band.

<P><LI>Enter "Itotal" without the quotation marks in the Expression Box for
<P><PRE>    the Field. Click the Calculate Box, and in the Calculate Field Window,
    choose Sum and reset on CNO.
</PRE>
<P><LI>Use the Text Tool to add the text "State Total" without the quotation'
<P><PRE>    marks to the STATE group footer band.
</PRE>
<P><LI>Use the Field Tool to add a field to the STATE group footer band.

<P><LI>Enter "Itotal" without the quotation marks in the Expression Box for
<P><PRE>    the Field. Click the Calculate Box, and in the Calculate Field Window,
    choose Sum and reset on STATE.
</PRE>
<P><LI>Use the Text Tool to add the text "Qtr Total" without the quotation
<P><PRE>    marks to the CNO group footer band.
</PRE>
<P><LI>Use the Field Tool to add a field to the QTR group footer band.

<P><LI>Enter "Itotal" without the quotation marks in the Expression Box for
<P><PRE>    the Field. Click the Calculate Box, and in the Calculate Field Window,
    choose Sum and reset on QTR.
</PRE>
<P><LI>Save the Report.

<P><LI>Enter MODIFY COMMAND Quarter in the Command window.

<P><LI>In the QUARTER.PRG Window, enter this code:
<P>
<P><PRE>    SELECT customer.cno, customer.company, customer.state, invoices.ino, ;
<PRE></PRE>        invoices.itotal, ;
        RIGHT(STR(YEAR(invoices.idate)),2)+ ;
        ALLTRIM(STR(INT((MONTH(invoices.idate)-1)/3)+1)) AS qtr ;
        FROM customer, invoices ;
        WHERE invoices.cno = customer.cno ;
        ORDER BY qtr, customer.state, customer.cno, invoices.ino ;
        INTO CURSOR qtr1
        REPORT FORM qtr.frx PREVIEW

</PRE><P><LI>Save and then Run the QUARTER.PRG program.
<P>
</OL>The results will show all the quarters to be from second quarter of 1990.
For a more descrptive analysis, modify some of the dates to other quarters
or years in the idate field of the table INVOICES.DBF in the Tutorial
subdirectory.
<P>
For more information about how to do a simple Report grouped by yearly
quarters, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q95313.htm">Q95313</A></B>
   TITLE     : How to Group Data by Yearly Quarters
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin FoxDos FoxMac FoxUnix 2.60a fourth<BR>
annual quad<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgSql<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
