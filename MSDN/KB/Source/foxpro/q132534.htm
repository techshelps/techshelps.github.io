

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Error Changing Grid s DynamicBackColor &amp; DynamicForeColor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132534">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/07/13">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b fixlist5.00 FxtoolSbuilder vfoxwin kbbuglist kbfixlist kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You get the following error when changing the DynamicBackColor and DynamicForeColor in a grid that has a class object added to a column and that class object is the active control with the Sparse Property set to false (.F.):     Expression evaluate...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAPN,QA7O,QAB5,QAOE,QAMN,QARR,QABH,QABI,QAQ7,QBXS,QA2Q,QAY2,QAG2,QAW6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Error Changing Grid s DynamicBackColor &amp; DynamicForeColor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132534</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbtool kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You get the following error when changing the DynamicBackColor and
DynamicForeColor in a grid that has a class object added to a column and
that class object is the active control with the Sparse Property set to
false (.F.):
<P>
<PRE>   Expression evaluated to an illegal value

</PRE><h2>RESOLUTION</h2>
 
<P>
Change either the DynamicBackColor or the DynamicForeColor but not both. Or
use the default controls that the Form Builder offers.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem has been fixed in
Visual FoxPro 5.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new class named CenterChk based on Container, and store it in
   Mylib.vcx.

<P><LI>In the Class Designer, set the following properties for the container:
<P>
   Height = 19
   Width = 68
   BackStyle = 0-Transparent
   BorderWidth = 0

<P><LI>From the Form Controls toolbar, select the check box Control, and place
   a check box in the container.

<P><LI>Set the following Properties for the check box:
<P>
   BackStyle 0-Transparent
   Height = 16
   Caption = ""
   Width = 14

<P><LI>With the check box selected, click Center Horizontally and Center
   Vertically on the Format menu. Then save and close the class.

<P><LI>Open the Tastrade.dbc in the VFP\Samples\Mainsamp\Data directory.

<P><LI>Create a new form called TestGrid, and add a new property to the form
   called nCurRec.

<P><LI>Using the right mouse button, click the form to bring up the Data
   Environment. Then using the right mouse button, click the Data
   Environment. Click Add, and add the Products table.

<P><LI>From the Form Controls toolbar, select the Grid control, and add a grid
   to the form.

<P><LI>Using the right mouse button, click the grid, and choose Builder. From
<P><PRE>    the Grid Builder, select the Products table. From the Available Fields,
    select Product_id, Product_name, and Discontinued.
</PRE>
<P><LI>Close the Builder by clicking OK.

<P><LI>Set the following Property for the grid:
<P>
<P><PRE>    RowHeight = 19
</PRE>
<P><LI>Using the right mouse button, click the grid, then click Edit.

<P><LI>From the Form Controls toolbar, click the View Classes button and
<P><PRE>    choose Add. Select Mylib.vcx from the Open dialog box. From the Form
    Controls Toolbar, select the CenterChk control, and add it to the
    Discontinued Column on the grid.
</PRE>
<P><LI>Set the following Properties for Column 3 in the grid:
<P>
<P><PRE>    CurrentControl CenterChk1
    Width = 68
    Sparse = .F.
</PRE>
<P><LI>Set the following Property for Column 3 CenterChk1 Check1 in the grid:
<P>
<P><PRE>    ControlSource = products.discontinued
</PRE>
<P><LI>Add the following code to the Init event of the grid:
<P>
<P><PRE>    THISFORM.nCurRec = RECNO()
    THISFORM.Grid1.SETALL('DynamicBackColor',;
       'IIF(THISFORM.nCurRec == RECNO(), rgb(0,0,128), rgb(255,255,0))',;
       'Column')
       THISFORM.Grid1.SETALL('DynamicForeColor', ;
<PRE></PRE>          'IIF(THISFORM.nCurRec == RECNO(), rgb(0,0,255), rgb(0,0,0))', ;
          'Column')
       THIS.REFRESH

</PRE><P><LI>Add the following code to the AfterRowColChange event of the grid:
<P>
<P><PRE>    THISFORM.nCurRec = RECNO()
    THIS.REFRESH
</PRE>
<P><LI>Save and run the form.
<P>
</OL>For more information on creating forms, please see Chapter 9 in the
Developer's Guide. For more information on creating classes, please see
Chapt1er 10 in the Developer's Guide. And for more information on using
controls on a form, please see Chapter 11 in the Developer's Guide.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbbuglist kbfixlist<BR>
KBSubcategory: FxtoolSbuilder fixlist5.00 VFoxWin buglist3.00 buglist3.00b<BR>
Additional reference words: 3.00 3.00b<BR>
Keywords          : buglist3.00 buglist3.00b fixlist5.00 FxtoolSbuilder vfoxwin kbbuglist kbfixlist kbtool<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
