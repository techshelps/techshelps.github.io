

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDE with Word Example in Developer's Guide Not Complete </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98689 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/05/12">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbdocerr kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  FoxPro can request a document from Microsoft Word for Windows using dynamic data exchange (DDE). The example on page D12-7 of the  Developer's Guide  shows how this can be done; however, the example is not complete.  MORE INFORMATION  The line incl...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBUG,QBUF,QA6A,QAPF,QDO7,QBVV,QA4B,QAYL,QAUF,QAB7,QDL9,QBXN,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DDE with Word Example in Developer's Guide Not Complete</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98689 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
FoxPro can request a document from Microsoft Word for Windows using dynamic
data exchange (DDE). The example on page D12-7 of the "Developer's Guide"
shows how this can be done; however, the example is not complete.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The line included in the "Developer's Guide" is as follows:
<P>
<PRE>   sWholeDoc = DDEREQUEST(iChannel, "\doc")

</PRE>However, in order for this line to work correctly, the topic that is used
in the DDEINITIATE() command should be the document title. The following
example copies the file C:\LETTER.DOC to the variable SWholeDoc:
<P>
<PRE>   **DOCTOVAR.PRG

   DEFINE WINDOW worddoc FROM 1,1 TO 25,70 FLOAT ;
      GROW TITLE "Word Document"
   MOVE WINDOW worddoc CENTER

   RUN /N c:\winword\winword.exe

   ** Store the name of the document to a variable.
   ** The document name and path MUST be in all caps, because
   ** it will be compared to the available topics in Word, which
   ** are all caps.

   document="C:\LETTER.DOC"

   ** Initiate a channel to Word for Windows.

   mchannel = DDEINITIATE("Winword","System")
   =DDEEXECUTE(mchannel,'[APPMinimize]')
   =DDEEXECUTE(mchannel,'[FileOpen .Name = "&amp;document"]')

   ** Storing a list of available topics to mtopic.

   mtopic=DDEREQUEST(mchannel,"topics")
   WAIT WINDOW mtopic

   ** Verifying the document is an available topic.

   IF document $ mtopic
      mchandoc = DDEINITIATE("Winword","&amp;document")
      SWholeDoc = DDEREQUEST(mchandoc,"\doc")
      ACTIVATE WINDOW worddoc
      @ 2,2 EDIT SWholeDoc SIZE 10,65 SCROLL FONT "Arial",12
      READ
      =DDETERMINATE(mchandoc)
   ELSE
      WAIT WINDOW "Document not transferred from Word to FoxPro."
   ENDIF

   =DDEEXECUTE(mchannel,'[FileExit 2]')
   =DDETERMINATE(mchannel)

</PRE><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a DDE Word Request<BR>
winword<BR>
documentation error docerr<BR>
KBCategory: kbinterop kbprg kbdocerr kbcode<BR>
KBSubcategory: FxinteropDde<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
