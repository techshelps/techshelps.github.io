

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Replace a Grid Cell's Value with Previous Cell's Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140295">
<META NAME="KBModify" CONTENT="1995/11/29">
<META NAME="KBCreate" CONTENT="1995/11/28">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You can replace the value in a grid cell with the value contained in the grid cell that lies above it. This article shows by example how to create a command button on a form that can perform this operation.  MORE INFORMATION  Step-by-Step Example  ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARR,QAKD,QACI,QDNZ,QAUY,QBWS,QAJP,QAY2,QAGB,QAEV,QBV8,QAB9,QAKC,QDMW,QBC9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Replace a Grid Cell's Value with Previous Cell's Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140295</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can replace the value in a grid cell with the value contained in the
grid cell that lies above it. This article shows by example how to create a
command button on a form that can perform this operation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Create a new form, and add a table to the data environment.

<P><LI>Drag the table from the data environment onto the form to create a new
   grid.

<P><LI>Place a command button on the form, and add the following code to its
   click event:
<P>
   ThisForm.Grid1.SetFocus
   ThisForm.LockScreen = .T.
   IF ThisForm.Grid1.RelativeRow = 1
<P><PRE>      =MESSAGEBOX("You cannot do this replacement from the top "+;
<PRE></PRE>         "of the Grid.",16,"")
      *: If the active grid cell is in the top row of the grid, this
      *: will display a message to the user.
   ELSE
      RepField = FIELD(ThisForm.Grid1.ActiveColumn)
      ColumnNumber = "Column"+ALLTRIM(STR(ThisForm.Grid1.ActiveColumn))
      ThisForm.GRID1.ACTIVATECELL(ThisForm.GRID1.RELATIVEROW-1,;
         ThisForm.GRID1.RELATIVECOLUMN)
      RepValue = ThisForm.Grid1.&amp;ColumnNumber..Text1.Value
      ThisForm.GRID1.ACTIVATECELL(ThisForm.GRID1.RELATIVEROW+1,;
         ThisForm.GRID1.RELATIVECOLUMN)
      yesno = MESSAGEBOX("Are you certain that you wish to replace "+;
         CHR(13)+"Field "+UPPER(repField)+" current value?",36,"")
      IF yesno = 6
         REPLACE &amp;RepField WITH RepValue
         ThisForm.REFRESH
      ELSE
         WAIT WINDOW "Replacement Canceled" NOWAIT
      ENDIF
   ENDIF
   ThisForm.LockScreen = .F.

</PRE><P><LI>Close, Save, and use the DO command to run the form. Place the insertion
   point in any cell of the grid, and click the command button. If the
   pointer has been placed in a cell that is in the top row of the grid,
   you should observe the "You cannot do this replacement from the top of
   the grid" message. Otherwise, you should see the "Are you certain..."
   message. If you click Yes, the replacement should occur. If you click
   No, a wait window indicating "Replacement Canceled" should appear.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGrid<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 29, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
