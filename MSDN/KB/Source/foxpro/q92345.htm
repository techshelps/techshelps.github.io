

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using File Locking and Record Locking in FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92345 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1992/11/04">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a command requires a file lock and the corresponding file is not already locked, FoxPro attempts to lock the file. Similarly, when a command requires a record lock and the corresponding record is not already locked, FoxPro attempts to lock the...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QABT,QAA8,QDMH,QAZV,QAK7,QAJ6,QA7O,QA7N,QAY2,QA62,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using File Locking and Record Locking in FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92345 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a command requires a file lock and the corresponding file is not
already locked, FoxPro attempts to lock the file. Similarly, when a command
requires a record lock and the corresponding record is not already locked,
FoxPro attempts to lock the record. If the lock attempt is successful,
FoxPro executes the command and releases the lock.
<P>
For a list of commands that automatically lock a file or individual
records, see the table below.
<P>
Use manual locking commands in the following situations:

<UL><LI>When you are editing a database with the CHANGE or EDIT command and a
   format file.

<LI>When you are editing a database using a memory variable and a command
   such as SCATTER. Note that the GATHER command locks each record as it
   updates the database; however, not locking the record during the editing
   process can introduce data-integrity problems.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The following commands automatically lock a file or individual records,
as indicated:
<P>
<PRE>   Command             Type of Locking
   -----------------------------------------------------------------------

   APPEND              Locks current record

   APPEND BLANK        Locks database header (briefly)

   APPEND FROM         Locks entire database

   APPEND FROM ARRAY   Locks database header

   APPEND MEMO         Locks current record

   BROWSE              Locks current record and all records from fields in
                       related databases (specified by an alias) once the
                       user begins editing a field

   CHANGE (without a   Locks current record and all records from fields in
   format file)        related databases (specified by an alias) once the
                       user begins editing a field

   DELETE              Locks current record

   DELETE NEXT 1       Locks current record

   DELETE RECORD &lt;n&gt;   Locks record &lt;n&gt;

   DELETE &lt;scope       Locks entire database
   beyond one&gt;

   EDIT (without a     Locks current record and all records from fields in
   format file)        related databases (specified by an alias) once the
                       user begins editing a field

   GATHER              Locks current record

   INSERT-SQL          Locks database header

   MODIFY MEMO         Locks current record when editing begins

   READ                Locks current record (and all records from aliased
                       fields)

   RECALL              Locks current record

   RECALL NEXT 1       Locks current record

   RECALL RECORD &lt;n&gt;   Locks record &lt;n&gt;

   RECALL &lt;scope       Locks entire database
   beyond one&gt;

   REPLACE             Locks current record (and all records from aliased
                       fields)

   REPLACE NEXT 1      Locks current record (and all records from aliased
                       fields)

   REPLACE RECORD &lt;n&gt;  Locks record &lt;n&gt; (and all records from aliased
                       fields)

   REPLACE &lt;scope      Locks entire database (and all files from aliased
   beyond one&gt;         fields)

   SHOW GETS           Locks current record (and all records from aliased
                       fields)

   UPDATE              Locks entire database
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxDos FoxWin 2.00 2.50 2.50a<BR>
2.x multi-user<BR>
multiuser network networking automatic<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgMultiuser<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
