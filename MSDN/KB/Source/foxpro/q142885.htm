

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Add the Data Environment to a Form Programmatically </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142885">
<META NAME="KBModify" CONTENT="1996/01/22">
<META NAME="KBCreate" CONTENT="1996/01/21">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When a form is created using the Form Designer, a DataEnvironment object is automatically added to the form. To simulate this behavior in a programmatically created form, a DataEnvironment property must be declared for the form. Then a pointer to a...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAH4,QAO2,QAI2,QAVX,QAUJ,QABO,QAB9,QARM,QDMW,QBWS,QAYY,QAX1,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Add the Data Environment to a Form Programmatically</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 22, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142885</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a form is created using the Form Designer, a DataEnvironment object is
automatically added to the form. To simulate this behavior in a
programmatically created form, a DataEnvironment property must be declared
for the form. Then a pointer to a DataEnvironment object may be stored in
the form's DataEnvironment property.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Create a new program and type the following code:
<P>
   oform1=CREATEOBJECT("Myform")  &amp;&amp; Instantiate the form
   oform1.SHOW(0)
   oform1.refresh
   READ EVENTS
   RETURN
<P>
<PRE>   DEFINE CLASS Data1 AS dataenvironment   &amp;&amp; DataEnvironment Class
     Name = "Dataenvironment"
     ADD OBJECT "Cursor1" AS MyCursor      &amp;&amp; ADD OBJECT for each
   ENDDEFINE                               &amp;&amp; cursor in dataenvironment

   DEFINE CLASS MyCursor AS cursor         &amp;&amp; Cursor Class
     Alias = "customer"
     Database = "C:\vfp\samples\data\testdata.dbc"
     CursorSource = "customer"
     Name = "Cursor1"
   ENDDEFINE

   DEFINE CLASS Myform AS form
     Top = 0
     Left = 0
     Height = 386
     Width = 587
     DoCreate = .T.
     Caption = "Form1"
     Name = "FORM1"
     DataEnvironment=""                &amp;&amp; DataEnvironment is a property
                                       &amp;&amp; of the form.
     PROCEDURE Destroy
       WAIT WINDOW PROGRAM() TIMEOUT 2
       THISFORM.DATAENVIRONMENT.CLOSETABLES  &amp;&amp; Close tables at the end
     ENDPROC                                 &amp;&amp; of destroy procedure.

     PROCEDURE Unload
       CLEAR EVENTS
     ENDPROC

     PROCEDURE Load
       * The DataEnvironment is instantiated and the form property
       * DataEnvironment references the object. The DataEnvironment
       * is never actually added to the form. THISFORM.DATAENVIRONMENT
       * is just a pointer to the DataEnvironment object.

       THISFORM.DATAENVIRONMENT=CREATEOBJECT("Data1")

       * Open the tables at the beginning of the LOAD.
       THISFORM.DATAENVIRONMENT.OPENTABLES

       WAIT WINDOW PROGRAM() TIMEOUT 2
     ENDPROC
   ENDDEFINE

</PRE><P><LI>Open the Debug window.

<P><LI>Type the following on the left side of the debug window
<P>
   _SCREEN.ACTIVEFORM.DATAENVIRONMENT.NAME

<P><LI>Run the program created in step 1.

<P><LI>Note that the debug window correctly displays Dataenvironment as the
   value of _SCREEN.ACTIVEFORM.DATAENVIRONMENT.NAME
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 22, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
