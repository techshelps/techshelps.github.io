

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Cannot Set ImageList Property of Treeview Visually </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163803">
<META NAME="KBModify" CONTENT="1997/06/17">
<META NAME="KBCreate" CONTENT="1997/02/18">
<META NAME="Keywords" CONTENT="FxinteropOcx FxinteropOle FxprgClassoop vfoxwin kbbuglist kbinterop kbole kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A form containing the Treeview control suddenly loses the images shown in the Treeview. This happens after any property of the Treeview control was modified in the Form Designer.  CAUSE =====  Right-clicking on the Treeview control in the Form Desi...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QAB5,QAOE,QAMN,QA56,QA55,QBV3,QBBI,QA01,QBWC,QAHV,QAHP,QDL9,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Cannot Set ImageList Property of Treeview Visually</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163803</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00
WINDOWS
kbinterop kbole kbbuglist kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A form containing the Treeview control suddenly loses the images shown in
the Treeview. This happens after any property of the Treeview control was
modified in the Form Designer.
<P>
<P><h2>CAUSE</h2>
 
<P>
Right-clicking on the Treeview control in the Form Designer reveals a
context menu. The bottom bar of that menu opens the TreeCtrl Properties
dialog box. That dialog box holds a PageFrame with three pages. Page 1 has
the caption "General." It holds a stack of nine ComboBox controls, plus
other objects. The fifth ComboBox from the top is labeled "ImageList"
(without the quotes).
<P>
Comctl32.ocx contains both the ImageList control and the Treeview control.
<P>
With the version of Comctl32.ocx that originally came with Visual FoxPro
5.0 the ImageList to be used with the Treeview control could be selected
from that ComboBox on the General page of the TreeCtrl Properties dialog
box. The developer could drop the ComboBox down and see all of the
ImageList controls on the current form. Typically that would be one, but
the application design might require multiple ImageLists. A Treeview can
be associated with any one of those, but only one.
<P>
Several Microsoft developer products that have been released since the
release of Visual FoxPro version 5.0 install a revised Comctl32.ocx.
<P>
In the Form Designer of Visual FoxPro 5.0, the new version of Treeview no
longer lists, in the TreeCtrl properties general page, the ImageLists that
reside on the current form. It shows the expression &lt;none&gt;.
<P>
Clicking the "Apply" button at the bottom of the page sets all of the
properties to the settings shown, so the new ImageList property is "none."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The ImageList must be specified in code. For example, if the form has an
ImageList in OLE container control "OleControl1," then in the Init event
method for the OLE container control that holds the Treeview, add a command
similar to the following:
<P>
<PRE>   This.Object.Imagelist = Thisform.Olecontrol1.Object

</PRE>The above is only a suggestion. The specifics of the application determines
where to make the modification and the appropriate syntax to use.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Use the following steps in Microsoft Visual FoxPro 5.0 for Windows:

<OL><P><LI>Modify a form that contains a TreeCtrl control.

<P><LI>Modify any property of the Treeview within the TreeCtrl properties
   dialog box

<P><LI>Click Apply, then OK. The value "&lt;none&gt;" is now saved as the ImageList
   property. Consequently no ImageList is specified for the Treeview
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbole kbbuglist kbprb<BR>
KBSubcategory: FxinteropOle FxinteropOcx FxprgClassoop vfoxwin<BR>
Additional reference words: 5.00<BR>
Keywords            : FxinteropOcx FxinteropOle FxprgClassoop vfoxwin kbbuglist kbinterop kbole kbprb<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
