

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error: Too Many Files Open </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148643">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1996/03/18">
<META NAME="Keywords" CONTENT="FxotherGeneral kberrmsg kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  You may receive the following error if Visual FoxPro reaches its file handle limit of 255:     Program Error    Too many files open.  This error can occur when you are close to the limit of 255 files being opened. The maximum number of files that c...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAAP,QAB4,QAAW,QA56,QA55,QAH4,QABN,QAKC,QBC6,QAO4,QAG8,QBVV,QAYL,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error: Too Many Files Open</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148643</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00b
WINDOWS
kbprg kbprb kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0 and 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive the following error if Visual FoxPro reaches its file
handle limit of 255:
<P>
<PRE>   Program Error
   Too many files open.

</PRE>This error can occur when you are close to the limit of 255 files being
opened. The maximum number of files that can be opened in Visual FoxPro is
255, but the error can occur before 255 because Visual FoxPro opens certain
files upon startup that use some of the file handles.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent the error from occurring, do not open that many files. If the
number of files that are being opened is close to the 255 file limit, open
and close files as necessary. To track how many files are open at any given
time, create a variable that can store the number of files that already
have been opened. For example, if you are opening a database container and
one table that has a memo field and an index, 6 files have been opened at
this time. They are the DBC, DCT, and DCX files of the database container,
and the DBF, CDX, and FPT files of the table. By adding and subtracting the
number of files that are opened and closed to the variable each time, you
can evaluate when to close any database containers and tables that are not
in use so the error will not occur.
<P>
NOTE: This error does not occur as quickly in Visual FoxPro 5.0 because it
has been designed to open as many files as the operating system allows
instead of the 255 file limit currently in Visual FoxPro 3.0.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. Visual FoxPro 3.0 can only open a maximum of
255 files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Run the following code sample to demonstrate this behavior:
<P>
<PRE>   FOR i = 1 TO 255
    = INKEY(.001)   &amp;&amp; Gives create cursor time to keep up
    SELECT (i)
    CREATE CURSOR ("T" + SUBSTR(SYS(2015), 3, 7)) (xyz c(10))
    WAIT WINDOW STR(i) + STR(SELECT()) NOWAIT
   NEXT

</PRE>When you run this code in a program (.prg) file, watch the Wait Window.
Note that the number count stops and the error occurs around 245 to 250.
The exact number in the display (Wait window) may be different depending on
how many files Visual FoxPro has open when you run the code sample.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbprg kbprb kberrmsg<BR>
KBSubcategory: FxotherGeneral<BR>
Keywords          : FxotherGeneral kberrmsg kbprb kbprg<BR>
Version           : 3.00 3.00b<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
