

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Link Command Failed" When Linking Stand-Alone .EXE File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99602 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1993/06/02">
<META NAME="Keywords" CONTENT="kbtool kbprg kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  When you are trying to link a stand-alone .EXE file, you receive a  Link Command Failed  error message.  CAUSE =====  This error is caused by insufficient conventional memory, which is probably occurring because other programs and/or drivers are ru...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QBW6,QAB4,QBQU,QDKI,QAYL,QACF,QA50,QBXT,QA5V,QAIB,QDKH,QBV8,QAB9,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Link Command Failed" When Linking Stand-Alone .EXE File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99602 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are trying to link a stand-alone .EXE file, you receive a
"Link Command Failed" error message.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error is caused by insufficient conventional memory, which is
probably occurring because other programs and/or drivers are running
simultaneously with FoxPro.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Make More Conventional Memory Available</h3>
 
<P>
To resolve this problem, you need to make more conventional memory
available. The easiest way to do this is by booting "clean" (that is,
booting with a minimal configuration).
<P>
The following batch files make it easy to switch between a clean
environment and your normal environment.
<P>
WARNING: Before you make any modifications to your CONFIG.SYS file,
you should make a bootable system disk (see your MS-DOS documentation)
so that the machine can be booted from a floppy disk if necessary.

<OL><P><LI>At the MS-DOS command prompt, type the following commands:
<P>
<P><PRE>      copy config.sys *.nrm
      copy autoexec.bat *.nrm
</PRE>
<P><LI>Use a text editor to add the following lines to a file named
   CONFIG.CLN:
<P>
<P><PRE>      files=40
      buffers=20
      (Add a disk driver, if needed)
</PRE>
<P><LI>Use a text editor to add the following lines to a file named
   AUTOEXEC.CLN:
<P>
<P><PRE>      path c:\;c:\dos
      prompt $p$g
      (add c:\mouse\mouse if desired)
</PRE>
<P><LI>Use a text editor to add the following lines to a file named
   CLENBOOT.BAT:
<P>
<P><PRE>      copy config.cln *.sys
      copy autoexec.cln *.bat
</PRE>
<P><LI>Use a text editor to add the following lines to a file named
   NORMBOOT.BAT:
<P>
<P><PRE>      copy config.nrm *.sys
      copy autoexec.nrm *.bat
</PRE><P>
</OL>NOTE: If SMARTDrive is running, add the following line to CLENBOOT.BAT
and NORMBOOT.BAT to ensure that the SMARTDrive memory cache is flushed
(written to disk) before the machine is rebooted:
<P>
<PRE>    smartdrv /c

</PRE></OL>Whenever you need a clean boot in order to link a file, type
"CLENBOOT" (without the quotation marks) at the MS-DOS command prompt,
press RETURN, and then reboot the machine. Once the .EXE file has been
linked, type "NORMBOOT" (without the quotation marks), press RETURN,
and reboot the machine again.
<P>
<P><h3>Additional Troubleshooting</h3>
 
<P>
If the steps above do not resolve this problem, try the following:

<OL><P><LI>Verify that FOXSWAP.COM is in the main FoxPro directory. This file
   allows FoxPro to swap memory out to a swap file on disk.

<P><LI>Verify that the configuration file (usually CONFIG.FP or CONFIG.FPW)
   does NOT contain the line DOSMEM=ON. If this line is present, it
   prevents FoxPro from using FOXSWAP.COM.

<P><LI>Verify that the MS-DOS environmental variable TEMP points to a valid
   directory.
<P>
   To test this, type "SET" (without the quotation marks) at an MS-DOS
   prompt, or run the Microsoft Diagnostic utility (MSD.EXE) included with
   Windows. This utility reports an error at start-up if the TEMP variable
   doesn't point to a valid directory.
<P>
   NOTE: Do not run MSD.EXE from Windows - quit Windows first and run it
   directly from MS-DOS.

<P><LI>Verify that the MS-DOS environmental variable COMSPEC points to a valid
   COMMAND.COM file. COMSPEC is sometimes reset by batch files or scripts
   when logging onto a network.
<P>
   Again, use the type "SET" (without the quotation marks) at the MS-DOS
   prompt to view this variable.

<P><LI>Try building the .EXE file directly from the Command window, bypassing
   the Project Manager, by typing the following in the Command window:
<P>
<P><PRE>      BUILD EXE &lt;exe_file&gt; FROM &lt;project_file&gt; EXTENDED
</PRE><P>
   The Project Manager uses up some memory, and sometimes not using it
   frees up enough memory to allow the .EXE file to be built.

<P><LI>Verify that WLINK8.EXE is in the main FoxPro directory.
<P>
   If this WLINK8.EXE isn't present, you will receive a "Bad command or
   file name" error message immediately before receiving the error that the
   link command failed.
<P>
   The easiest way to place WLINK8.EXE in the directory again is to
   reinstall the Distribution Kit.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxDos FoxWin 2.00 2.50 dkit distribution kit<BR>
wlink errmsg err msg low 2.50a tshoot<BR>
KBCategory: kbtool kbprg kberrmsg kbprb kbtshoot<BR>
KBSubcategory: FxtoolProjman<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
