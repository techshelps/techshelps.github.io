

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Providing Edit Menu Functions in a Top-Level Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157160">
<META NAME="KBModify" CONTENT="1997/08/06">
<META NAME="KBCreate" CONTENT="1996/10/07">
<META NAME="Keywords" CONTENT="FxtoolAccessory vfoxwin kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  This article describes how you can provide Edit menu functionality, such as Cut, Copy, and Paste, to a Top-Level form without actually using a visual menu bar and pad on the form.  If you do not include any of the System menu items, the Top-Level F...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV4,QA9N,QBT6,QBJZ,QAEF,QAF0,QAHP,QANS,QAMB,QAY5,QASB,QAQT,QA56,QA55,QAI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Providing Edit Menu Functions in a Top-Level Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157160</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how you can provide Edit menu functionality, such as
Cut, Copy, and Paste, to a Top-Level form without actually using a visual
menu bar and pad on the form.
<P>
If you do not include any of the System menu items, the Top-Level Form
loses the functionality of the System menu because it runs as a "separate"
application outside of the Visual FoxPro environment.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Sometimes, you may want to create an application that does not require a
main menu, but you want to have the ability to cut, copy, or paste in a
text box or edit box field from within the form. In previous versions of
the FoxPro, you need to include the Edit menu in your application. However,
this is no longer necessary in Visual FoxPro 5.0.
<P>
The following example shows how you can create a form that can invoke Cut,
Copy, or Paste functionality without having the Edit menu visible.

<OL><P><LI>Create a Quick Menu.

<P><LI>Delete all the menu pads and bars that you don't need and leave only
   Cut, Copy and Paste.

<P><LI>On the View menu, click General Options. Select the Top-Level Form
   check box in the General Options dialog box.

<P><LI>Generate the menu and save it as Sdieditmenu.mnx.

<P><LI>Create a form and name it Sdieditform1.scx.

<P><LI>Set the ShowWindow property for the form to "2 - As Top-Level Form" in
   the Properties window.

<P><LI>Add two text boxes to the form.

<P><LI>In the Init method of the form, add the following code:
<P>
<P><PRE>      * This menu defines the edit menu functions like Cut/Copy/Paste
      DO SdiEditMenu.mpr WITH THIS, .T.
</PRE><P>
<P><PRE>      * First you run the menu, then you DEACTIVATE it.
      * The menu definition remains in memory so the shortcut keys are
      * available
      DEACTIVATE MENU (THIS.Name)
</PRE>
<P><LI>Run the form. Type something in the first text box, then press Ctrl+X
   to cut whatever you typed in, and then press Ctrl+V to paste it in the
   second text box.
<P>
</OL>NOTE: Only menu options with shortcut keys in the Visual FoxPro system menu
work for the above example. In this case only Cut, Copy, and Paste have
shortcut keys.
<P>
Following is another example that uses the SYS(1500) function to accomplish
the same behavior as above. SYS(1500), a new function, allows you to call a
menu bar function without having the menu bar available:

<OL><P><LI> Create a form, set the ShowWindow property for the form to "2 - As
<P><PRE>    Top-Level Form", and name it SdiEditForm2.scx.
</PRE>
<P><LI> Add two text boxes to the form.

<P><LI> In the Init method of the form, add the following code:
<P>
<P><PRE>       *Activate the Paste menu bar when CTRL+V is press.
       ON KEY LABEL CTRL+V SYS(1500, '_MED_PASTE', '_MEDIT')
</PRE><P>
<P><PRE>       *Activate the Copy menu bar when CTRL+C is press.
       ON KEY LABEL CTRL+C SYS(1500,'_MED_COPY','_MEDIT')
</PRE><P>
<P><PRE>       *Activate the Cut menu bar when CTRL+X is press.
       ON KEY LABEL CTRL+X SYS(1500,'_MED_CUT','_MEDIT')
</PRE>
<P><LI>Run the form. Type something in the first text box, then press Ctrl+X
   to cut whatever you typed in, and then press Ctrl+V to paste it in the
   second text box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the SYS(1500) function, please see the
following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../FOXPRO/Q155847.htm">Q155847</A></B>
   TITLE     : How To Activate a System Menu Item in Visual FoxPro 5.0

</PRE></OL> 
<PRE>Keywords          : FxtoolAccessory vfoxwin kbtool
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
