

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Scope on Report Command Doesn't Work as in version 2.x </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135342">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1995/08/20">
<META NAME="Keywords" CONTENT="buglist3.00 buglist3.00b buglist5.00 kbtool vfpbug5.0a kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Specifying a scope for a report to print does not print the correct records from the table.  CAUSE =====  The problem is that the DataEnvironment object created when the report was created performs an implicit GO TOP command as it initializes, even...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAPN,QAOX,QAW6,QACI,QBE7,QBE6,QA9N,QAO2,QDMH,QAY4,QAO3,QAKD,QBV8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Scope on Report Command Doesn't Work as in version 2.x</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135342</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Specifying a scope for a report to print does not print the correct records
from the table.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem is that the DataEnvironment object created when the report was
created performs an implicit GO TOP command as it initializes, even if the
table is already open. This is necessary so that programmatic changes to
Cursor object properties, such as Filter, take effect. A unexpected side-
effect of this recent change is that the Scope clauses (ALL, NEXT, RECORD,
and REST) on the REPORT FORM command do not affect which the records are
printed.
<P>
For example, if you have a table open and the record pointer is sitting
at record 5, a REPORT FORM &lt;x&gt; NEXT 1 should print record number 5 only.
However, because the DataEnvironment object performs a GO TOP command, the
record pointer is re-positioned as the DataEnvironment object is initiated,
so record number 1 prints - not 5.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To use the REST, RECORD, and NEXT Scope clauses on the REPORT FORM command,
you must prevent the implicit GO TOP command performed by the
DataEnvironment object, which can be done in any one of these ways:

<UL><LI>Remove the table from the DataEnvironment object, and open it before
   running the report.
<P>
   -or-

<LI>Keep the table in the DataEnvironment object, but set the AutoOpenTables
   property to false, and open the table manually before running the
   report.
<P>
   -or-

<LI>Keep the table in the DataEnvironment object, and save and restore the
   record pointer before the report actually prints. To do this:
<P>
   1. Set AutoOpenTables to false for the DataEnvironment object.
<P>
   2. In the Init event, do the following:
<P>
<PRE>      x=0               &amp;&amp; Create a scoped variable
      this.opentables   &amp;&amp; Call the OpenTables method
      go (x)            &amp;&amp; Restore the Record pointer

   3. In the OpenTables method, save the record pointer:

      x=RECNO()

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Code to Reproduce Problem</h3>
 
<P>
create table repotest (mychar c(1))
insert into repotest values ('1')
insert into repotest values ('2')
insert into repotest values ('3')
insert into repotest values ('4')
insert into repotest values ('5')
create report repotest from repotest
<P>
goto 2
REPORT FORM repotest next 1  &amp;&amp;Record 2 should print but record 1 prints
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : buglist3.00 buglist3.00b buglist5.00 kbtool vfpbug5.0a kbbuglist<BR>
Version             : 3.0 3.0b 5.0 5.0a<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
