

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Set Up Relationship in Data Env for Concatenated Fields </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137952">
<META NAME="KBModify" CONTENT="1995/10/15">
<META NAME="KBCreate" CONTENT="1995/10/09">
<META NAME="Keywords" CONTENT="kbtool kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Use the following steps to create a relationship involving the concatenation of two or more fields in the parent and child tables in the data environment of a form or report:  1. Create an index tag in the child table from the concatenation of the ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QA7O,QA7N,QAPN,QAX1,QAA1,QA9N,QARR,QDI1,QAZZ,QAMB,QBT6,QAYY,QBV4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Set Up Relationship in Data Env for Concatenated Fields</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 15, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137952</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Use the following steps to create a relationship involving the
concatenation of two or more fields in the parent and child tables in the
data environment of a form or report:

<OL><P><LI>Create an index tag in the child table from the concatenation of the
   fields.

<P><LI>Add the parent and child tables to the data environment.

<P><LI>In the data environment, drag the first field of the concatenation from
   the parent table to the concatenated index tag in the child.

<P><LI>Bring up the Property sheet for the Relation object and set its
   RelationalExpr property to the concatenation of the fields
   (field1+field2 if the fields are both character data type).
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
This example uses a program that creates the parent and child tables.

<OL><P><LI>Run the following program to create the tables to be used:
<P>
   * Start of CREATABS.PRG
<P>
   * This program creates a parent table called PAR_TAB.DBF and a child
   * table called CHLD_TAB.DBF
<P>
   * Create and fill parent table
<P>
   CREATE TABLE par_tab FREE (cfield1 C (3), cfield2 C(3))
<P>
   FOR nI=1 TO 10
<P><PRE>      FOR nJ=1 TO 3
<PRE></PRE>        INSERT INTO par_tab (cfield1,cfield2) ;
          VALUES (CHR(64+nI), ALLTRIM(STR(nJ)))
      ENDFOR
   ENDFOR

   * Create and fill child table
   CREATE TABLE chld_tab FREE (cfield1 C (3), cfield2 C(3), cfield3 C(3))

   FOR nI=1 TO 10
      FOR nJ=1 TO 3
         FOR nK=1 TO nJ
           INSERT INTO chld_tab (cfield1,cfield2,cfield3) ;
             VALUES (CHR(64+nI),ALLTRIM(STR(nJ)),ALLTRIM(STR(nK)))
         ENDFOR
      ENDFOR
   ENDFOR

   * End of CREATABS.PRG

</PRE><P><LI>Modify the structure of Chld_tab.dbf and create the concatenated index
   tag. Name the index tag Cfld1cfld2, and in the index expression, enter
   Cfield1+Cfield2.

<P><LI>Create a form, and add Par_tab.dbf and Chld_tab.dbf to the data
   environment of the form.

<P><LI>Drag the first field in the concatenation (Cfield1) from Par_tab.dbf
   and drop it on the Cfld1cfld2 index tag of Chld_tab.dbf. This creates a
   relationship.

<P><LI>Right-click the relationship line in the data environment, and click
   Properties to bring up the Property sheet. Edit the RelationalExpr
   property of the Relation1 object. This will now contain Cfield1. Edit
   this to read Cfield1+Cfield2 -- the same thing entered as the index
   expression for the Chld_tab table. The relationship is now established.

<P><LI>Drag Cfield1 and Cfield2 from the parent table and onto the form to
   create text boxes. Drag the child table by its title bar onto the form
   to create a grid.

<P><LI>Add a command button to the form with the following code in its Click
   event:
<P>
   SKIP
   Thisform.Refresh

<P><LI>Save and run the form. Click the command button to move the record
   pointer through the parent table. Note that the values in the text boxes
   from the parent table match the first two columns of the grid, which are
   the corresponding fields in the child table.
<P>
</OL><h3>Additional Notes</h3>
 

<UL><LI>The first table added to the data environment is initially selected by
   default. If the child table is added to the data environment first, the
   InitialSelectedAlias property of the DataEnvironment object should be
   set to the parent table name.

<LI>After the relationship is established as previously described, the line
   representing the relationship in the data environment comes from the
   Fields heading in the parent.

<LI>The structure of each of the fields in the concatenation must be
   identical in the parent and the child.

<LI>Although the previous example uses a form, the data environment setup is
   the same for a report.

<LI>If numeric fields must be concatenated, they must be first converted to
   strings. For example, str(nfield1)+str(nfield2) could be used for two
   numeric fields in the index expression of the child table and the
   RelationalExpr of the Relation object. Likewise, a character and numeric
   field could be concatenated with the expression cfield1+str(nfield2).
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin<BR>
KBCategory: kbtool kbcode kbhowto<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 15, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
