

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Remove Records from a Table Without Using Delete/Pack </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135616">
<META NAME="KBModify" CONTENT="1995/08/25">
<META NAME="KBCreate" CONTENT="1995/08/23">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Using the DELETE or PACK commands to remove records can be very time consuming. ZAP is very fast, but removes all the records. With FoxPro's low-level file I/O, you can quickly remove a select number of unwanted records from the end of a table.  MO...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAEF,QDKD,QAGB,QBCT,QAGC,QDH6,QA9N,QANJ,QDMH,QAB9,QAA1,QAY2,QBV8,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Remove Records from a Table Without Using Delete/Pack</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135616</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5, 2.5a, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using the DELETE or PACK commands to remove records can be very time
consuming. ZAP is very fast, but removes all the records. With FoxPro's
low-level file I/O, you can quickly remove a select number of unwanted
records from the end of a table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Procedure</h3>
 

<OL><P><LI>Open a program file, name it Lowlevel.prg, and type the following
   function code:
<P>
   FUNCTION ZAPLAST
   PARAMETER lnY
   IF USED()
<P><PRE>     lnZ=RECCOUNT()
     IF lnY&lt;=lnZ
       lcFILENAME=DBF()
       USE
       lnHANDLE=FOPEN(lcFILENAME,2)
       IF lnHANDLE&gt;0
<PRE></PRE>         lcBYTE=FREAD(lnHANDLE,32)
         lnFLD_SIZE=ASC(SUBSTR(lcBYTE,11,1))+;
            (ASC(SUBSTR(lcBYTE,12,1))*256)
         lnFILESIZE=FSEEK(lnHANDLE,0,2)
         lnX=lnZ-lnY
         lcBYTE8=CHR(INT(lnX/(256*256*256)))
         lcBYTE7=CHR(INT(lnX/(256*256)))
         lcBYTE6=CHR(INT(lnX/256))
         lcBYTE5=CHR(MOD(lnX,256))
         lcBYTE=SUBSTR(lcBYTE,1,4)+lcBYTE5+;
            lcBYTE6+lcBYTE7+lcBYTE8+SUBSTR(lcBYTE,9)
         =FSEEK(lnHANDLE,0)
         =FWRITE(lnHANDLE,lcBYTE)
         =FCHSIZE(lnHANDLE,lnFILESIZE+(lnFLD_SIZE*lnX))
         =FCLOSE(lnHANDLE)
       ENDIF
       USE &amp;lcFILENAME
     ENDIF
   ENDIF

</PRE><P><LI>Save and close Lowlevel.prg

<P><LI>Test the function by removing a single record from a table. For this
   example, use the Customer.dbf table - but back up the table first.
   Records that are deleted with ZAPLAST() cannot be recovered.
<P>
   a. In the Command window, type:
<P>
<P><PRE>      SET PROCEDURE TO LOWLEVEL.PRG
      USE C:\FPW26\TUTORIAL\CUSTOMER EXCLUSIVE
</PRE><P>
   b. Take note of how many records are in the table. For this example,
<P><PRE>      there are 500 records.
</PRE><P>
   c. In the Command window, type:
<P>
<P><PRE>      =ZAPLAST(1)
</PRE><P>
   d. Note that there is one less record in the database. Originally there
<P><PRE>      were 500 records; now there are only 499.
</PRE>
<P><LI>Any number of records can be deleted. For example, to delete 27 records,
   change step 3.c. to =ZAPLAST(27)
<P>
</OL>NOTE: Only records at then end of the table can be deleted with ZAPLAST().
ZAPLAST() will not recognize index orders or Visual FoxPro triggers.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.50 2.50a 2.50b 2.60 2.60a 3.00 VFoxWin<BR>
FoxWin FoxDos<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FxprgTable<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 25, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
