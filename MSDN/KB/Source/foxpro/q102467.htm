

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using MAPI.DLL to Invoke MS Mail from FoxPro for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102467">
<META NAME="KBModify" CONTENT="1996/10/18">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="kbinterop kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  In FoxPro for Windows, you can use FOXTOOLS.FLL with MAPI.DLL to invoke Microsoft Mail version 3.0 so that you can send Mail messages while running your FoxPro program.  MORE INFORMATION  By using the RegFn() and CallFn() functions in FOXTOOLS.FLL ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QDL9,QBWO,QBWN,QBWQ,QAH6,QAL7,QBFY,QAY5,QBV0,QDKH,QAY2,QAYL,QAFY,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using MAPI.DLL to Invoke MS Mail from FoxPro for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102467</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 5.0
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In FoxPro for Windows, you can use FOXTOOLS.FLL with MAPI.DLL to
invoke Microsoft Mail version 3.0 so that you can send Mail messages
while running your FoxPro program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By using the RegFn() and CallFn() functions in FOXTOOLS.FLL to access
the MAPI.DLL from Mail 3.0, you can send attachments or messages from
within a FoxPro for Windows application.
<P>
The following sample code calls Microsoft Mail to bring up a Send Note
dialog box and attaches the AUTOEXEC.BAT file to the Mail message that
is going to be sent:
<P>
<PRE>   SET LIBRARY TO SYS(2004) + "FOXTOOLS.FLL" ADDITIVE
   GetSysDir = RegFn("GetSystemDirectory","@CI","I")
   bigstr = REPLICATE(chr(0),144) &amp;&amp;creates a big string
   retlen = CallFn(GetSysDir, @bigstr,144)
   winsys = LEFT(bigstr,retlen)
   SendMail=RegFn("MAPISendDocuments","L@C@C@CL", ;
      "L", winsys+"\MAPI.DLL")
   T1=";"
   T2="C:\AUTOEXEC.BAT"
   T3=""
   X=CallFn(SendMail,0,@T1,@T2,@T3,0)
   RELEASE LIBRARY SYS(2004) + "FOXTOOLS.FLL"

</PRE>GetSystemDirectory() is a Microsoft Windows application programming
interface (API) function used to retrieve the Windows SYSTEM
subdirectory. RegFn() returns a function handle to GetSysDir so that
the handle can be accessed by CallFn(). CallFn() is used to determine
the length of GetSysDir and assigns the numeric value to retlen. It
also puts the string value of GetSysDir in the variable bigstr. At
this point, the location of the MAPI.DLL file is known, and the
MAPISendDocuments() function is used to send a standard Microsoft Mail
message.
<P>
Now that MAPISendDocuments() has been registered, the SendMail
variable can be used to start Mail. T1 refers to the delimiter between
filenames. T2 is the list of files that you would like to send. T3 is
a null character and is not necessary for this program. Therefore, if
you want to send both the AUTOEXEC.BAT and CONFIG.SYS files in your
Mail message, you would use T2="C:\AUTOEXEC.BAT;C:\CONFIG.SYS". For
more information on the MAPISendDocuments() function, see the
Microsoft Mail "Technical Reference" manual.
<P>
<P><h2>REFERENCES</h2>
 
<P>
FOXTOOLS.WRI file
<P>
Microsoft Mail "Technical Reference," version 3.0, pages 76-81
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 VFoxWin 3.00  FoxWin 2.50 2.50a<BR>
KBCategory: kbinterop kbprg<BR>
KBSubcategory: FxprgFoxtools<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 18, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
