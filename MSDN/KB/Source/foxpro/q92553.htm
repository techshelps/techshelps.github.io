

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Combined Ascending and Descending Index </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92553 ">
<META NAME="KBModify" CONTENT="1996/04/29">
<META NAME="KBCreate" CONTENT="1992/11/09">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  By default, indexes are created in ascending order (for example, alphabetically from A to Z, or by date, from January to December). Indexes can also be created in reverse or descending order (for example, alphabetically from Z to A, or by date, fro...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QA7O,QA7N,QAYL,QAGC,QAPF,QAH4,QBXR,QAY2,QAUD,QALX,QBJQ,QAKJ,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Creating a Combined Ascending and Descending Index</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92553 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 1.02, 2.0, 2.5, and 2.5a
<LI>Microsoft FoxPro for Windows, versions 2.5 and 2.5a
<LI>Microsoft FoxBASE+ for MS-DOS, version 2.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default, indexes are created in ascending order (for example,
alphabetically from A to Z, or by date, from January to December).
Indexes can also be created in reverse or descending order (for
example, alphabetically from Z to A, or by date, from December to
January).
<P>
The character field example below demonstrates how to create an index
on the concatenation of two fields, where the first field is indexed
in ascending order and the second field is indexed in descending
order. These techniques also apply to more than two fields.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create an index on the concatenation of two fields (as described
above), do the following:

<OL><P><LI>Create the MCOMP.PRG file to contain the following code. MCOMP
   creates a 255 character string that contains the characters in
   descending order. For example:
<P>
<P><PRE>      PRIVATE char, mdescend
      char = 255
      mdescend = ""
      DO WHILE char &gt;= 1
<PRE></PRE>         mdescend = mdescend + CHR(char)
         char = char - 1
      ENDDO
      RETURN mdescend

   NOTE: The MCOMP.PRG file must be present on the system unless you
   delete the index created in this procedure.

</PRE><P><LI>Assign the results of the MCOMP program to a variable, as follows:
<P>
<P><PRE>      mdesc_ord = mcomp()
</PRE><P>
   NOTE: You must create this variable each time you use the
   descending index. Otherwise, FoxPro returns a "Variable not found"
   error.

<P><LI>Create the index using the first field, the results of a SYS(15)
   function, the variable, and the second field.
<P>
   For example, if the mdesc_ord variable is set as indicated in step
   2 above, FNAME is the first field to be indexed in ascending order,
   LNAME is the second field to be indexed in descending (reverse)
   order, and INDEXNAME is the name of the index, you can create the
   index using the following code:
<P>
<P><PRE>      INDEX ON fname + SYS(15, mdesc_ord, lname) TO file
</PRE><P>
   The SYS(15, &lt;expC1&gt;, &lt;expC2&gt;) function translates each character of
   the string &lt;expC2&gt; according to the string in &lt;expC1&gt;.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxDos FoxWin 2.00 2.50 2.50a<BR>
2.10 2.x<BR>
KBCategory: kbprg<BR>
KBSubcategory: FxprgGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
