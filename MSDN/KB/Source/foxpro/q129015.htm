

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Bypass the When Clause Default in a List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129015">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1995/04/17">
<META NAME="Keywords" CONTENT="kbtool kbcode">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Within a list box, the default behavior for the When Clause is to accept the default value of the variable for processing, even if another item was selected in the list box the first time through. This article shows by example how to bypass this be...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAH4,QABA,QDI1,QAZZ,QAYL,QAVX,QAVW,QANE,QAKR,QADN,QAY5,QAPN,QAFR,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Bypass the When Clause Default in a List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129015</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6, 2.6a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Within a list box, the default behavior for the When Clause is to accept
the default value of the variable for processing, even if another item was
selected in the list box the first time through. This article shows by
example how to bypass this behavior.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example Demonstrating the Default Behavior</h3>
 
<P>
Create a screen by following these steps:

<OL><P><LI>Initialize the variable Listchoice to a file in your default directory
   by placing the following command in the Setup code of the screen:
<P>
   Listchoice = "CUSTOMER.DBF"
<P>
   Replace CUSTOMER.DBF with the name of your database if you want.

<P><LI>Create a button with Donone as the variable and 'Nothing' as the prompt.

<P><LI>Create a list box in the screen from Files: *.DBF

<P><LI>Add the following command to the When Clause of the list box:
<P>
   WAIT WINDOW Listchoice

<P><LI>Generate and run the screen.

<P><LI>Because Listchoice is set equal to CUSTOMER.DBF (or whatever you called
   it), that is the file highlighted in the list box.

<P><LI>Click another file in the list, and watch as the Wait Window returns
   CUSTOMER.DBF. Then after you close the Wait Window, CUSTOMER.DBF is
   still highlighted. It is as if the other file was never selected.

<P><LI>You must click the new file again for it to display in the Wait Window.

<P><LI>From this point forward, the list box will update the Wait Window to
   display the name of the file as it is selected
<P>
</OL><h3>Step-by-Step Example Showing How to Change the Default Behavior</h3>
 
<P>
You can change this Default behavior to display the name of each file as it
is clicked by following these steps:

<OL><P><LI>Add the following code in the Setup Code section:
<P>
   SET DEFAULT TO SYS(2004)+"TUTORIAL"
   Toggle = .T.
   Listchoice = "customer.dbf"

<P><LI>In the screen, create a list box of prompt files like *.DBF. Make
   Listchoice the variable for the list box. In the WHEN Clause, add
   the following code:
<P>
<PRE>   IF Toggle                  &amp;&amp; Is this the first time through
      KEYBOARD '{leftmouse}'  &amp;&amp; If so, you want to come right back
      Toggle = .F.   &amp;&amp; Allows us to move to the ELSE section next time
   ELSE
      *&lt;This is where the code would go&gt;
      DO WHENTEST WITH Listchoice
   ENDIF

</PRE><P><LI>In the Cleanup Code, add the following:
<P>
<PRE>   PROCEDURE WHENTEST           &amp;&amp; A slight variation of the WAIT WINDOW
      PARAMETERS Lcvar
      DEFINE WINDOW TEST FROM 1,1 TO 5,24 DOUBLE
      MOVE WINDOW TEST CENTER
      ACTIVATE WINDOW TEST
      @2,2 GET Lcvar
      READ TIMEOUT 3
      CLEAR
      RELEASE WINDOW TEST
      toggle=.t.

</PRE><P><LI>Reset the Toggle to .T. upon activation of the screen to handle the case
   where the user leaves this screen and then return to it at a later time.
   Whenever this screen is reactivated, the Toggle can be reset to .T.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 2.60a<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: FxtoolSbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
