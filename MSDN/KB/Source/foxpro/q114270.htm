

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: CTOD() and VAL() Functions Are Not Saved in Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114270">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/04/28">
<META NAME="Keywords" CONTENT="FxtoolRqbe kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A query produced by the Relational Query By Example (RQBE) window that contained the VAL() or CTOD() functions when it was last saved is missing those functions the next time it is opened.  STATUS ======  Microsoft has confirmed this to be a proble...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAB9,QABM,QAY5,QAR4,QBV8,QBWS,QBVR,QAG2,QDO9,QDL9,QBXS,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: CTOD() and VAL() Functions Are Not Saved in Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114270</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50 2.50a 2.50b 2.60 | 2.50 2.50a 2.50b 2.60 | 2.50b
<PRE>WINDOWS               | MS-DOS                | MACINTOSH
</PRE>kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for MS-DOS, versions 2.5, 2.5a, 2.5b, 2.6
<LI>Microsoft FoxPro for Macintosh, version 2.5b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A query produced by the Relational Query By Example (RQBE) window that
contained the VAL() or CTOD() functions when it was last saved is missing
those functions the next time it is opened.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FoxPro versions 2.5, 2.5a,
and 2.5b for Windows, FoxPro versions 2.5, 2.5a, and 2.5b for MS-DOS, and
FoxPro version 2.5b for Macintosh. This problem was corrected in FoxPro
version 2.6a for Windows, FoxPro version 2.6a for MS-DOS, and FoxPro
version 2.6a for Macintosh.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Type the following in the Command window:
<P>
       CREATE TABLE test (chardate C(8))
       INSERT INTO test (chardate) VALUES ('02/20/94')
       MODIFY QUERY test

<P><LI>Click the box under Field Name. A list box appears. The choices in the
    list box are the field TEST.TESTDATE and the Expression Builder
    (&lt;expression...&gt;). Select the Expression Builder (&lt;expression...&gt;).

<P><LI>In the Expression Builder dialog box, under Expression, type the
    following, and then choose OK.
<P>
       CTOD(chardate)

<P><LI>Type the following in the text box under Example:
<P>
       {02/20/94}

<P><LI>Choose See SQL. Note that the generated SQL SELECT statement is
    correct. Close the See SQL window.

<P><LI>Close the RQBE window, saving changes to TEST.QPR.

<P><LI>Type "MODIFY QUERY test" (without the quotation marks) in the
    Command window to open TEST.QPR again.

<P><LI>Note that the CTOD() function is missing from the expression under
    Field Name.

<P><LI>Choose See SQL. Note that the CTOD() function still exists in the
    generated SQL SELECT statement. Close the See SQL window.

<P><LI>Change the LIKE operator to EXACTLY LIKE.

<P><LI>Choose See SQL. Note that the CTOD() function is now missing from
    the generated SQL SELECT statement.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxMac FoxDos FoxWin 2.50 2.50a 2.50b<BR>
buglist2.50 buglist2.50a buglist2.50b structured query language buglist2.60<BR>
fixlist2.60a<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: FxtoolRqbe<BR>
Keywords          : FxtoolRqbe kbbuglist kbfixlist kbprg<BR>
Version           : 2.50 2.50a 2.50b 2.60 | 2.50 2.5<BR>
Platform          : MACINTOSH MS-DOS WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
