

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SET INDEX TO Command Causes Error When Run from a Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140565">
<META NAME="KBModify" CONTENT="1995/12/04">
<META NAME="KBCreate" CONTENT="1995/12/03">
<META NAME="Keywords" CONTENT="kbtool kbprg kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  One of the following errors occurs occur when attempting to run the SET INDEX TO command programmatically from a running form:   - File must be opened exclusively.     -or-   - File is in use by another.  CAUSE =====  A table opened by the Data Env...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QBWS,QAB4,QAPN,QBXS,QAX1,QBVR,QAAP,QBV8,QAB9,QAYY,QAI2,QA3J,QA3I V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SET INDEX TO Command Causes Error When Run from a Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140565</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
One of the following errors occurs occur when attempting to run the SET
INDEX TO command programmatically from a running form:

<UL><LI>File must be opened exclusively.
<P>
   -or-

<LI>File is in use by another.
<P>
</UL><h2>CAUSE</h2>
 
<P>
A table opened by the Data Environment of a form is opened shared by
default. Therefore, when the form is running and you issue an INDEX ON
command, an error occurs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Set the Exclusive Property of the cursor to .T. at design time.
<P>
NOTE: Attempting to set this property at run-time causes the following
error message:
<P>
<PRE>   Property setting will not take effect until data environment reloaded

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a form.

<P><LI>Right-click the form, and then click Data Environment.

<P><LI>Right-click the Data Environment window, and then click Add.

<P><LI>Locate the Customer table in the Vfp\Samples\Data directory, and then
</OL>select and add it to the Data Environment of the form.

<OL><P><LI>Scroll down in the list box displaying the Customer table and note which
</OL>indexes which currently exist. This is so that an index that already exists
isn't recreated when the INDEX ON command is run in Step 7 later.

<OL><P><LI>Add a command button to the form.

<P><LI>Add the following code to the Click method of the command button
<P>
<P><PRE>     SELECT CUSTOMER
     INDEX ON &lt;field_name&gt; TAG &lt;field_name&gt;
</PRE><P>
   where field_name is the name of a field in the Customer table that does
   not already have an index tag, as noted earlier in Step 5.

<P><LI>Save and run the form.

<P><LI>Click the command button.
<P>
</OL><h3>Steps to Correct Form Created in Previous Example</h3>
 

<OL><P><LI>Close, and then edit the form.

<P><LI>Right-click the form, and then click Data Environment.

<P><LI>Right-click the Customer table list box, and then click Properties.

<P><LI>In the Properties window, click the Data tab, and then examine the
   Exclusive property. Note that the default value is .F.

<P><LI>Change the Exclusive value to .T., and then save and rerun the form.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.00b VFoxWin<BR>
KBCategory: kbtool kbprg kberrmsg<BR>
KBSubcategory: FxtoolFormdes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
