

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Program Error While Using Search in Wizard-Generated Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136279">
<META NAME="KBModify" CONTENT="1995/09/10">
<META NAME="KBCreate" CONTENT="1995/09/05">
<META NAME="Keywords" CONTENT="kbtool kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  Clicking the Find button on a Wizard-generated form and selecting an operator (or typing a value) that is not compatible with the data type of the selected field results in this error message:     Function argument value, type, or count is invalid ...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAH4,QAGI,QAPN,QAO4,QAB9,QAI2,QAYZ,QAUR,QAB5,QBXS,QA56,QA55,QAIK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Program Error While Using Search in Wizard-Generated Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 10, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136279</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Clicking the Find button on a Wizard-generated form and selecting an
operator (or typing a value) that is not compatible with the data type of
the selected field results in this error message:
<P>
<PRE>   Function argument value, type, or count is invalid

</PRE><h2>CAUSE</h2>
 
<P>
The Visual FoxPro Form Wizard does not implicitly call an error-handling
procedure.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The developer needs to implement an error-handling routine to trap for any
errors that occur, call it in the Init event procedure of the Wizard-
generated form, and set it back to the default in the Destroy event. The
procedure itself can be contained in a .prg file that also calls the form.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example shows how to implement a simple error-handling
routine similar to the FoxPro version 2.6 Screen Wizard.

<OL><P><LI>Create a form by using the Form Wizard.

<P><LI>Modify the form, and in the form's Init event procedure, add this code:
<P>
   On Error Do MyErrorHandler in CallProg

<P><LI>In the form's Destroy event procedure, add "On Error" (without the
   quotation marks). Now, closing the form will reset the error routine
   to the one Visual FoxPro uses by default.

<P><LI>Exit and save the form.

<P><LI>Create the following program, and name it CallProg:
<P>
   DO FORM &lt;formname&gt;
<P>
   PROCEDURE MyErrorHandler
<P><PRE>      WAIT WINDOW MESSAGE()
</PRE>
<P><LI>Close and save the program. Use the DO command to run it. Cause the
   the error. Now the error message is displayed in the Wait window. The
   user is no longer given options that could disable the form's
   functionality.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 VFoxWin handler<BR>
KBCategory: kbtool kbcode kbprb<BR>
KBSubcategory: FxtoolWizscreen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 10, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
