

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Application Tries to Locate Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111513">
<META NAME="KBModify" CONTENT="1996/04/30">
<META NAME="KBCreate" CONTENT="1994/02/14">
<META NAME="Keywords" CONTENT="kbtool kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  A procedure called from a menu may bring up a  Where is MENUNAME?  dialog box to locate the .MPR file.  CAUSE =====  A FoxPro application looks for an .MPX or .MPR file in the application when running a procedure. Therefore, it is necessary to have...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QBJZ,QANE,QBXS,QADN,QAB9,QBWS,QAJH,QAF0,QAUJ,QAH4,QAVI,QBV8,QBRD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Application Tries to Locate Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111513</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro for Windows, version 3.0
<LI>Microsoft FoxPro for MS-DOS, versions 2.0, 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Windows, versions 2.5, 2.5x, 2.6, 2.6a
<LI>Microsoft FoxPro for Macintosh, versions 2.5x, 2.6a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A procedure called from a menu may bring up a "Where is MENUNAME?" dialog
box to locate the .MPR file.
<P>
<P><h2>CAUSE</h2>
 
<P>
A FoxPro application looks for an .MPX or .MPR file in the application when
running a procedure. Therefore, it is necessary to have a valid .MPX or
.MPR file. In order for the application to find the .MPX or .MPR file, a
LOCFILE command is used in the system-generated code to locate the menu
program. It looks for the menu program files in the following order:
<P>
<PRE>   .MPX
   .MPR
   .FXP
   .PRG

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new project called TEST.

<P><LI>Create a new menu called TEST that is created using the Quick Menu
    command on the Menu menu.

<P><LI>From the File menu, choose Exit, and change the BAR# to PROCEDURE.
    Choose the Create button and type:
<P>
<PRE>        CLEAR READ ALL
        SET SYSMENU TO DEFAULT

</PRE><P><LI>Create an option on the File menu that has a prompt of 'First wait
    window'. Change BAR# to COMMAND. Type:
<P>
<PRE>        WAIT WINDOW 'One'

</PRE><P><LI>Create another option on the File menu that has a prompt of 'Second
    wait window'. Change BAR# to PROCEDURE. Choose the Create button and
    type:
<P>
<PRE>        WAIT WINDOW 'Two'

</PRE><P><LI>Build the .APP.

<P><LI>Compile TEST.MPR into TEST.MPX.

<P><LI>Go into Filer and rename TEST.MPR to TEST1.MPR. Also rename TEST.MPX
    to TEST1.MPX.

<P><LI>Run the application. Choose the item to run the first WAIT window.
    Then, choose the second WAIT window.
<P>
    In FoxPro for MS-DOS or Foxpro for Windows, the dialog box "Where is
    TEST" should appear.
<P>
    In FoxPro for Macintosh, the system error message "Procedure 'system
    generated procname' not found." should appear.

<P><LI>Press CTRL+F2 to open the Command window, and the issue the following
    command:
<P>
       SET SYSMENU TO DEFAULT

<P><LI>Go into Filer and rename TEST1.MPR to TEST.MPR and rename TEST1.MPX to
    TEST.MPX.
<P>
</OL>Rerun the application. The "Where is TEST" dialog box should not appear
now.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: VFoxWin 3.00  FoxMac FoxDos FoxWin 2.00 2.50<BR>
2.50a 2.50b<BR>
2.50c 2.60 2.60a "procedure not found" MBuilder<BR>
KBCategory: kbtool kbprg kbprb<BR>
KBSubcategory: FxtoolMbuilder<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
