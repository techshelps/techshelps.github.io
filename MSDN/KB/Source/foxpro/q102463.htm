

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Incorrect Group Footer Sum Using Previous in Preview </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102463">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="FxtoolRwriter kbbuglist kbfixlist kbprint kbtool">
<META NAME="KBArea" CONTENT="Support; KB; foxpro, crossnet, odbc">
<META NAME="Description" CONTENT="  The sum in a report group footer displays incorrectly when you choose Page Preview from the Report menu and use the Previous button to return to a page of the report that contains only one record in the group. However, the report does display corre...">
<META NAME="Product" CONTENT="Visual FoxPro">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QA5V,QABH,QBXS,QBCI,QAR4,QA7O,QA7N,QAUD,QAAP,QBWS,QACI,QAJQ,QAE5,QDN0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Incorrect Group Footer Sum Using Previous in Preview</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102463</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.5x 2.60
WINDOWS
kbtool kbprint kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FoxPro for Windows, versions 2.5x, 2.6
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The sum in a report group footer displays incorrectly when you choose
Page Preview from the Report menu and use the Previous button to
return to a page of the report that contains only one record in the
group. However, the report does display correctly when the Next button
is used, and it also prints correctly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, use a user-defined function (UDF)
instead. Below is an example of a simple UDF that returns a group sum
to the group footer of a report. The expression in the group footer is
"grpsum(company)" (without the quotation marks), where COMPANY is the
field that the report is being grouped on. YTDPURCH is the numeric
field that is being summed.
<P>
<PRE>   PARAMETER grpvar
   * Store the current record number to a variable because the SUM
   * command moves the record pointer to the end of the file.
   m.rec=RECNO()
   SUM ytdpurch FOR company=grpvar TO sumvar
   * Set the record pointer back to the correct record.
   GOTO m.rec
   RETURN sumvar

</PRE>To use this code, place it in a file called GRPSUM.PRG and save it in
the same directory as the report.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
FoxPro version 2.6a for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a report in FoxPro for Windows using CUSTOMER.DBF in the
   TUTORIAL subdirectory, and place the numeric field YTDPURCH on the
   detail line.

<P><LI>From the Report menu, choose Data Grouping, group on the COMPANY
   field, and have each group start on a new page.

<P><LI>Copy the YTDPURCH field on the detail line, and paste it into the
   group footer band. Double-click the field. In the Report Expression
   dialog box, select the Calculate option, then select Sum. In the
   Reset box, select Customer.Company.

<P><LI>From the Report menu, choose Page Preview, and use the Next button
   to move through the report one page at a time. Note that each group
   has only one record, so the ytdpurch and its subtotal on the group
   footer are the same. After choosing Next at least two times, choose
   Previous, and note that the subtotal is now incorrect for each
   group that contains only one record (except the first group). The
   subtotal displayed is actually the subtotal for the group on the
   preceding page.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FoxWin 2.50 2.50a 2.50b 2.60 fixlist2.60a<BR>
buglist2.50 buglist2.50a buglist2.50b buglist2.60 RWriter<BR>
KBCategory: kbtool kbprint kbfixlist kbbuglist<BR>
KBSubcategory: FxtoolRwriter<BR>
Keywords          : FxtoolRwriter kbbuglist kbfixlist kbprint kbtool<BR>
Version           : 2.5x 2.60<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
