

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Problem with ScrollBar Control While Activated In-place </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108942">
<META NAME="KBModify" CONTENT="1995/04/21">
<META NAME="KBCreate" CONTENT="1993/12/20">
<META NAME="Keywords" CONTENT="kbole kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  It is not possible to use a ScrollBar child control inside a window that will be used as the in-place window in a container application.   The ScrollBar control does not generate WM_VSCROLL or WM_HSCROLL messages to its parent window.  CAUSE ===== ...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAW6,QBXQ,QBAE,QA7O,QAB5,QAMN,QAOE,QAEV,QAHP,QBVV,QAJH,QAYC,QAPN,QAGQ,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Problem with ScrollBar Control While Activated In-place</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108942</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries for Windows and Win32s, versions 2.0 and 2.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
It is not possible to use a ScrollBar child control inside a window that
will be used as the in-place window in a container application.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The ScrollBar control does not generate WM_VSCROLL or WM_HSCROLL messages
to its parent window.
<P>
<P><h2>CAUSE</h2>
 
<P>
One way to understand this problem is to examine the case where you have
an OLE container application that inserts an in-place capable object into
itself using the Insert Object menu option.
<P>
When the object is created, and if the container application allows the
object to embed itself in-place in the container application, it will set
the parent of its editing window to be a window that belongs to the
container.
<P>
Therefore, a situation occurs where two applications are running; that is,
the container and the server. The server application created and owns the
window procedure for a window that the object lives in; however, the parent
of this window is a window of the container application.
<P>
Imagine now that the object's editing window (created by the server and
parented by the container) contains a ScrollBar child control. When the
user clicks the ScrollBar control by using the left mouse button, a
WM_LBUTTONDOWN message is generated that gets handled internally by
Windows's ScrollBar child control code.
<P>
This code makes a check to ensure that the message queue that has just
delivered this message is also owned by the current active application. If
they are not, the message will not be processed further and scroll bar
messages will not be sent to the ScrollBar control's parent.
<P>
This is the case with the in-place scenario described above, and the root
of the problem.
<P>
The active application is the container application but the message queue
that delivered the scroll bar message belongs to the server application.
<P>
Also note that this problem does not apply to in-place editing windows that
have scroll bars that were created using the WS_HSCROLL or WS_VSCROLL
style. The message processing for these scroll bars is slightly different
from ScrollBar child controls.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Instead of creating a child control with the "scrollbar" class, create a
new window class (for example, MYSCROLL) whose window procedure forwards
WM_VSCROLL and WM_HSCROLL messages to its parent.
<P>
Then you can create windows of this class with either WS_HSCROLL or
WS_VSCROLL. Then position these windows the same way you would position
ScrollBar controls. When you enable/disable the scroll bar, use the
SB_HORZ, SB_VERT flags in the call to EnableScrollBar.
<P>
NOTE: You must have one row of pixels of the little window's client area
visible or Windows will hide the horizontal scroll bar. This does not apply
to the vertical scroll bar; that is, you do not need to have a column of
pixels visible.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.01<BR>
KBCategory: kbole kbprg kbprb<BR>
KBSubcategory: LeTwoApp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
