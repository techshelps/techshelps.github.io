

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Menu Mnemonics Not Working During In-Place Activation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104460">
<META NAME="KBModify" CONTENT="1995/05/17">
<META NAME="KBCreate" CONTENT="1993/09/19">
<META NAME="Keywords" CONTENT="kbole kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  The menu mnemonics for an object do not operate properly, causing the system to hang.  CAUSE =====  The server application is not calling OleTranslateAccelerator inside of its message loop.  RESOLUTION  For menu commands to be dispatched properly d...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QAW6,QA9Q,QAGI,QBVV,QAYC,QAPN,QDL9,QBWO,QBWN,QAD7,QAH4,QAY5,QAJH,QBRD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Menu Mnemonics Not Working During In-Place Activation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104460</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries for Windows and Win32s, version 2.0
<LI>Microsoft OLE Libraries, included with:
<P><PRE>    - Microsoft Windows NT, versions 3.5 and 3.51
    - Microsoft Windows 95
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The menu mnemonics for an object do not operate properly, causing the
system to hang.
<P>
<P><h2>CAUSE</h2>
 
<P>
The server application is not calling OleTranslateAccelerator inside
of its message loop.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For menu commands to be dispatched properly during in-place editing,
OLE 2.0 needs to have the server application call
OleTranslateAccelerator, even if the server application does not have
accelerator support. This OLE application programming interface (API)
does the needed translation of key messages, and ensures that the
appropriate action occurs.
<P>
To be more efficient, a server application need only pass "keystroke"
messages to OleTranslateAccelerator. The following code demonstrates
what the message loop for an OLE server application should look like:
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE> // Message loop for an OLE server.
 //
 while (GetMessage(&amp;msg, NULL, NULL))
    {
    if (m_fInplaceActive)  // If currently active in place.
        if (msg.message &gt;= WM_KEYFIRST &amp;&amp; msg.message &lt;= WM_KEYLAST)
            // If it is a "keystroke" message.
            if (OleTranslateAccelerator(...) == NOERROR)
                continue; // OLE handled the message

    TranslateMessage(...);
    DispatchMessage(...);
    }

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When the object's server is a stand-alone .EXE and the in-place active
object gets a keystroke message that is not a recognized accelerator,
the object must check to see if the message is one that the container
recognizes by calling the OleTranslateAccelerator function. If the
container does not want the keystroke, then the
OleTranslateAccelerator function will return FALSE. In this case, the
object should continue using its normal TranslateMessage and
DispatchMessage code.
<P>
If the container accepts the keystroke, OLE will call the container's
IOleInPlaceFrame::TranslateAccelerator member function to translate
the message. The container may call the Windows TranslateAccelerator
and/or TranslateMDISysAccel functions to process the accelerator key,
or do its own special processing.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.50 4.00<BR>
KBCategory: kbole kbprg kbprb<BR>
KBSubcategory: LeTwoInp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
