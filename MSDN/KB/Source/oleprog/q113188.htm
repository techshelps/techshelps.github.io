

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: Text Corrections for Inside OLE 2 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113188">
<META NAME="KBModify" CONTENT="1995/04/21">
<META NAME="KBCreate" CONTENT="1994/03/29">
<META NAME="Keywords" CONTENT="kbole kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  This article contains a list of errors in the text of the book  Inside OLE 2,  by Kraig Brockschmidt (Microsoft Press).  Many of the errors listed below also affect the book's sample code; the descriptions for those errors include references to ano...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QA9Q,QAPF,QABA,QA2O,QAH4,QAAP,QAJ9,QBWA,QA6A,QAAX,QAML,QAGI,QAX6,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: Text Corrections for Inside OLE 2</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113188</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries for Windows and Win32s, version 2.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains a list of errors in the text of the book "Inside OLE
2," by Kraig Brockschmidt (Microsoft Press).
<P>
Many of the errors listed below also affect the book's sample code; the
descriptions for those errors include references to another Knowledge Base
article, which describes the problems (and their solutions) in more detail.
<P>
For additional information on these problems and their solutions, please
see the following article(s) in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A HREF="../OLEPROG/Q113255.htm">Q113255</A></B>
<PRE>TITLE     : SAMPLE: Corrections for Inside OLE 2 Sample Code

</PRE>The sample code for "Inside OLE 2" was originally written to be compatible
with OLE 2.0. This code has been updated to be compatible with OLE 2.01,
and also to fix some problems in the original code. The entire source tree
for the updated sample code is included in the INOLE2 Software Library
sample. INOLE2 can be found in the Microsoft Software Library by searching
on the word INOLE2.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>List of Text Errors</h3>
 
<P>
<PRE>Page 71:   The second line of the last paragraph should read "with all the
           functions in the preceding table...". The book has "tale"
           instead of "table".

</PRE>Pages 82-  The exact implementations of CImpIEnumRECT::Next on these pages
<PRE>83, 92-    are incorrect--for more information, see the section "Errors in
93:        Enumerator Samples" in the Knowledge Base article "SAMPLE:
           Corrections for Inside OLE 2 Sample Code."
           Also, on page 83 there should be no space between "book" and
           "1632" in the text "#include &lt;book 1632.h&gt;".

</PRE>Page 105:  The second use of QueryInterface in the Transitive property
<PRE>           should read "pInterface2-&gt;QueryInterface(IInterface3)". The
           book has IInterface2 as the parameter to QueryInterface,
           which is incorrect.

</PRE>Page 157:  A space is missing between "LPLPVOID" and "ppv" in the
<PRE>           last parameter of the declaration CKoala::QueryInterface.

</PRE>Page 161:  The prototype for WEP should return an int, not VOID.
<P>
Page 197:  The line of code under "if (IsEqual(riid, IID_IAnimal))"
<PRE>           should read "*ppv=(LPVOID)m_pAnimal". In the text the
           underscore is mistakenly a space, dash, and space.

</PRE>Page 199:  A space is missing between "LPLPVOID" and "ppv" in the
<PRE>           last parameter of the declaration CKoala::QueryInterface.

</PRE>Page 243:  The second sentence in the second paragraph should read:
<P>
<PRE>           "The Structured Storage definition of IStream allows streams
           to contain up to 2^64 (2 raised to the 64th power)
           addressable bytes of data."

            The text incorrectly reads "264" instead of "2^64."

</PRE>Pages 257- The code listings for CPages::DevModeSet, CPages::DevModeGet,
<PRE>259:       and CPages::ConfigureForDevice should be changed to correct a
           problem with certain printer drivers in Patron. For more
           information on this problem, see the section "Patron Does Not
           Work with Some Printer Drivers" in the Knowledge Base article
           "SAMPLE: Corrections for Inside OLE 2 Sample Code."

</PRE>Pages 289- Both LibMain and WEP functions should return an int.
<PRE>290:       For more information, see the section "Incorrect Prototypes for
           LibMain() and WEP()" in the Knowledge Base article "SAMPLE:
           Corrections for Inside OLE 2 Sample Code."

</PRE>Page 316:  The implementation of CImpIEnumFormatEtc::Next is incorrect.
<PRE>           For more information on this problem, see the section "Errors in
           Enumerator Samples" in the Knowledge Base article "SAMPLE:
           Corrections for Inside OLE 2 Sample Code."

</PRE>Page 331:  The description of IDataObject::GetCanonicalFormatEtc
<PRE>           is incorrect. For correct details, see the Microsoft Object
           Linking and Embedding version 2.0 "Programmer's Reference."

</PRE>Page 365:  The "const LPRECTL" parameter to IViewObject::Draw
<PRE>           should be of type "LPCRECTL" to match OLE 2.01. The book
           is correct for OLE 2.0. For more information, see the section
           "Compiler Errors on IViewObject::Draw()" in the Knowledge
           Base article "SAMPLE: Corrections for Inside OLE 2 Sample Code."

</PRE>Page 368:  The call to pIViewObject-&gt;Draw about should read:
<P>
<PRE>           "pIViewObject-&gt;Draw(dwAspect, -1, NULL, NULL, 0, hdcDraw,
           lprcBounds, NULL, NULL, 0);". In the book, the dwAspect and
           hDC parameters are incorrect.

</PRE>Page 399:  When CImpIDataObject::GetData calls AddRef() before returning,
<PRE>           it should also call AddRef on any IStorage or IStream pointer
           inside the STGMEDIUM, if that is the medium in use. For more
           information, see the section "Datatran Reference Counting
           Problem" in the Knowledge Base article "SAMPLE: Corrections
           for Inside OLE 2 Sample Code."

</PRE>Page 437:  The word "consumer" in the caption of Figure 8-6 should be
<PRE>           "target."

</PRE>Pages 544- In OLE 2.01 there is a new, additional parameter to
<PRE>546:       OleUIAddVerbMenu called "idVerbMax", which comes immediately
           after "idVerbMin." This parameter was not present in OLE 2.0.
           For information on how this change affects the sample code, see
           the section "Compiler Errors on OleUIAddVerbMenu" in
           the Knowledge Base article "SAMPLE: Corrections for Inside
           OLE 2 Sample Code."

</PRE>Page 554:  Under OLE 2.01 the OleStdGetObjectDescriptorFromOleObject
<PRE>           function (used in the Patron sample application) requires an
           additional LPSIZEL as the last parameter. For more information
           on how this change affects the sample code, see the section
           "Compiler Errors on OleStdGetObjectDescriptorFromOleObject()"
           in the Knowledge Base article "SAMPLE: Corrections for Inside
           OLE 2 Sample Code."

</PRE>Pages 614- No ellipsis ("...") is necessary to separate functions in
<PRE>622:       Listing 10-5. There is no code omitted from the listing in these
           places.

</PRE>Page 630:  The right curly brace just above the "else" at the bottom
<PRE>           of the page should be indented to align with the call
           to ModifyMenu above it.

</PRE>Pages 663- The bottom of page 663 mentions how a handler should hold
<PRE>665:       onto open streams for low-memory save situations. This is
           important ONLY for elements that are entirely manipulated
           by the handler and never touched by the server. The handler
           should not cache or hold pointers to the same elements the
           server must access. For more information on this problem, see
           the section "Component Cosmo Fails to Release Polyline Object"
           in the Knowledge Base article "SAMPLE: Corrections for Inside
           OLE 2 Sample Code."

           If a handler manipulates and changes data unaffected by
           the server, it must fulfill the IPersistStorage contract for
           only those formats. The server is responsible for all
           others that it modifies.

</PRE>Page 668:  The "const LPRECTL" parameter to IViewObject::Draw
<PRE>           should be of type "LPCRECTL" to match OLE 2.01. The book
           is correct for OLE 2.0. For more information on how this change
           affects the sample code, see the section "Compiler Errors on
           IViewObject::Draw()" of the Knowledge Base article "SAMPLE:
           Corrections for Inside OLE 2 Sample Code."

</PRE>Page 687:  There should not be "//" before the large bold "IOLEOBJ.CPP"
<PRE>           in this code listing. The label is not part of the code.

</PRE>Page 788:  Same problem with OleStdGetObjectDescriptorFromOleObject
<PRE>           as described above for page 554.

</PRE>Page 814:  Same problem with OleUIAddVerbMenu as described above for
<PRE>           pages 544-546.

</PRE>Page 817:  Remove the second parameter to pTenantCur-&gt;Close. It should
<PRE>           read "pTenantCur-&gt;Close(FALSE);". For more information on this
           problem, see the section "Patron GP Faults During Activate As"
           in the Knowledge Base article "SAMPLE: Corrections for Inside
           OLE 2 Sample Code."

</PRE>Page 817:  There should be a call to pIStorage-&gt;Commit(STGC_ONLYIFCURRENT)
<PRE>           immediately after the call to OleStdDoConvert and before
           the call to pIStorage-&gt;Release. For more information, see
           the section "Patron Convert To Fails" of the Knowledge Base
           article "SAMPLE: Corrections for Inside OLE 2 Sample Code."

</PRE>Page 819:  Remove the second parameter to pTenantCur-&gt;Close. It should
<PRE>           read "pTenantCur-&gt;Close(FALSE);". This matches the change
           necessary for a bug resolution described in the section "Patron
           GP Faults During Activate As" in the Knowledge Base article
           "SAMPLE: Corrections for Inside OLE 2 Sample Code."

</PRE>Page 846:  The parenthetical entry in the fourth line of the last
<PRE>           paragraph should read "(linked objects are NOT allowed...)".
           The book reads "now" instead of "not".

</PRE>Page 861:  The second sentence of the third paragraph under "Active
<PRE>           vs. UI Active and Inside-Out Objects" should read:

           "The answer...as they are visible-end users DO NOT have to
           double-click..."

           The DO NOT is important.

</PRE>NOTE: Versions of "Inside OLE 2" printed after March 1994 (third printing
or later) have been corrected.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.01 mspress docerr<BR>
KBCategory: kbole kbdocerr<BR>
KBSubcategory: LeTwoOth<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
