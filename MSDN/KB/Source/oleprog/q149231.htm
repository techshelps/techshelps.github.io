

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Marshaling Code for Connection Point Interfaces </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149231">
<META NAME="KBModify" CONTENT="1996/12/11">
<META NAME="KBCreate" CONTENT="1996/03/28">
<META NAME="Keywords" CONTENT="kbother kbfile">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  CXPRX provides 32-bit marshaling code for the IConnectionPoint, IConnectionPointContainer, IEnumConnections, and IEnumConnectionPoints interfaces. The next version of Windows and Windows NT will provide marshaling code for these interfaces, so be s...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAA1,QDI2,QBWP,QBBS,QAH6,QDL9,QBWO,QBWN,QBVV,QBXB,QBC9,QBC8,QATJ,QANO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Marshaling Code for Connection Point Interfaces</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149231</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE libraries included with:
<P><PRE>    - Microsoft Windows NT version 3.51
    - Microsoft Windows 95
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
CXPRX provides 32-bit marshaling code for the IConnectionPoint,
IConnectionPointContainer, IEnumConnections, and IEnumConnectionPoints
interfaces. The next version of Windows and Windows NT will provide
marshaling code for these interfaces, so be sure to follow the installation
instructions specified below to prevent accidental overwriting of the
system provided marshaling code.
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/CXPRX.EXE">CXPRX.EXE</A> <I>(size: 108514 bytes)</I> 
                      , a self-extracting file, on these services:

</PRE><LI>Microsoft's World Wide Web site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon
      Click Knowledge Base, and select the product
<PRE></PRE>      Enter kbfile <A HREF="http://support.microsoft.com/download/support/mslfiles/CXPRX.EXE">CXPRX.EXE</A> <I>(size: 108514 bytes)</I> 
                            , and click GO!
      Open the article, and click the button to download the file

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder
      Get <A HREF="http://support.microsoft.com/download/support/mslfiles/CXPRX.EXE">CXPRX.EXE</A> <I>(size: 108514 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A HREF="http://support.microsoft.com/download/support/mslfiles/CXPRX.EXE">CXPRX.EXE</A> <I>(size: 108514 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>After downloading the file, run it in an empty directory with the -d switch
to set up the directory structure:
<P>
<PRE>   CXPRX.EXE -d

</PRE>NOTE: The x86 directory contains a build of CXPRX.DLL that will work on
Windows 95 and the Intel x86 version of Windows NT 3.51. The MIPS and Alpha
directories contain builds of CXPRX.DLL for use on the MIPS and Alpha
versions of Windows NT 3.51. This code will not work with 16-bit
applications. Please do not modify the code or the version number. Change
the CPU variable in the makefile to build for different platforms.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The connection point interfaces (IConnectionPoint,
IConnectionPointContainer, IEnumConnections, and IEnumConnectionPoints) are
used by components to implement event handling. These interfaces are
documented in the OLE Controls documentation. Windows 95 and Windows NT
3.51 did not provide marshaling code for these interfaces. Consequently
these interfaces could only be used with inproc objects on these platforms.
The marshaling code provided here allows these interfaces to be used by out-
of-process objects on the Windows NT 3.51 and Windows 95 platforms.
<P>
The next version of Windows and Windows NT will provide marshaling code
for the connection point interfaces. To prevent the overwriting of this
system provided marshaling code, it is important that you follow the
following installation instructions when you install the marshaling code
provided here:
<P>
<P><h3>Installation Instructions</h3>
 
<P>
An installation program that installs the marshaling code should follow
these steps:

<OL><P><LI>The installation program should check the system directory (determined
   at installation time by using the GetSystemDirectory() Win32 API) for
   the existence of CXPRX.DLL. If it exists and if the standard version-
   checking APIs indicate that it is a later version than the CXPRX.DLL
   provided by the installation program, it should not be overwritten and
   installation is complete. The version of CXPRX.DLL provided here is
   1,0,0,3 (See CXPRX.RC). If CXPRX.DLL exists in the system directory but
   if it is an earlier version, overwrite it and installation is complete.
   If CXPRX.DLL does not exist in the system directory, go to step 2.

<P><LI>The installation program should check for the existence of the following
   registry key to determine whether to continue installation or not:
<P>
   if (ERROR_SUCCESS != RegQueryValueEx(
   HKEY_CLASSES_ROOT,
   "Interface\\{B196B285-BAB4-101A-B69C-00AA00341D07}\\ProxyStubClsid32",
   NULL, REG_SZ, NULL, NULL))
   {
<P><PRE>    ... go to step 3 ...
</PRE>   }
<PRE>   // else installation is complete;

   This check prevents accidental overwriting of the system's installed
   marshaling code when the system does provide marshaling of these
   interfaces in the future. So if this key is present, marshaling code for
   these interfaces exists and the installation is complete.

</PRE><P><LI>If installation gets past step 2, CXPRX.DLL should be copied to the
   system directory. Then the marshaling code must be registered in the
   registry by running REGSVR32.EXE CXPRX.DLL. REGSVR32.EXE will call the
   exported DllRegisterServer function in CXPRX.DLL to register the
   marshaling code. Installation is now complete.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00<BR>
KBCategory: kbother kbfile<BR>
KBSubcategory: LeTwoArc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
