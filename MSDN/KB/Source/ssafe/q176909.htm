

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Move a VSS Database or Project to New Location </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176909">
<META NAME="KBModify" CONTENT="1997/11/18">
<META NAME="KBCreate" CONTENT="1997/11/18">
<META NAME="Keywords" CONTENT="ssconfig">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  This article describes three common scenarios for moving Visual SourceSafe projects or databases to a new location. The steps necessary to successfully accomplish this are detailed in the MORE INFORMATION section below.  Scenario 1  Moving the enti...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDML,QA55,QA56,QANJ,QAZV,QA9N,QAEF,QAA1,QABI,QAFI,QAY2,QDI2,QAHT,QACI,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Move a VSS Database or Project to New Location</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176909</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows, versions
   4.0, 4.0a
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes three common scenarios for moving Visual SourceSafe
projects or databases to a new location. The steps necessary to
successfully accomplish this are detailed in the MORE INFORMATION section
below.
<P>
<P><h3>Scenario 1</h3>
 
<P>
Moving the entire Visual SourceSafe server installation from one machine to
another.
<P>
<P><h3>Scenario 2</h3>
 
<P>
Moving a project or projects from one database to another, while preserving
the project's history.
<P>
<P><h3>Scenario 3</h3>
 
<P>
Moving only the DATA directory to a machine other than the Visual
SourceSafe server. This scenario eliminates the need to modify clients
accessing the database.
<P>
IMPORTANT: Whichever method you use, make sure to do a full backup of your
data first.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The procedures within each scenario may vary depending on the version of
Visual SourceSafe you are running.
<P>
<P><h3>Scenario 1</h3>
 
<P>
Moving the entire VSS server installation from one machine to another.

<OL><P><LI>Copy the entire &lt;server&gt;\VSS installation directory to the new server
   location.

<P><LI>Make sure that the Visual SourceSafe clients can still access the
   data from the new location.

<P><LI>Step 3 varies according to what version of Visual SourceSafe you are
   using:
<P>
   For Visual SourceSafe 4.x clients:
<P>
   a. Locate the local copy of the Srcsafe.ini file (for example, &lt;local
<P><PRE>      drive&gt;\vssclient\Srcsafe.ini) and open it in a text editor.
</PRE><P>
   b. Edit the line containing the #include statement so that it points to
<P><PRE>      the new location of the server's Srcsafe.ini. For example:
</PRE><P>
<P><PRE>      Change:
</PRE><P>
<PRE>         #include \\oldserver\oldshare\vss\srcsafe.ini

      To:

         #include \\newserver\newshare\vss\srcsafe.ini

   For Visual SourceSafe 5.x clients:

   a. Open the Visual SourceSafe Explorer.  Click OK if you get the
      following error:

         File '\\oldserver\oldshare\srcsafe.ini' not found.


   b. From the Visual SourceSafe Login dialog box, click Browse.

   c. Click Browse from the Open SourceSafe Database dialog box.

   d. Type in the UNC path to the new location of the Visual SourceSafe
      server directory and open the srcsafe.ini. This will add a new entry
      in the Available Databases list for the newly located database.

   e. The old database reference can now be removed from this dialog box.

</PRE></OL>IMPORTANT: Be sure to add the correct operating system level privileges to
the new server directory.
<P>
For additional information about required network privileges, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SSAFE/Q131022.htm">Q131022</A></B>
   TITLE     : INFO: Required Network Rights for the SourceSafe Directories

</PRE>NOTE: If you have any shortcuts to this database, be sure to modify the
shortcut Target on the client that pointed to ssadmin.exe on the old
server.
<P>
<P><h3>Scenario 2</h3>
 
<P>
Moving a project or projects from one database to another, while preserving
the project's history.
<P>
NOTE: This process is for Visual SourceSafe 5.0 or greater only.
<P>
Use the SSARC and SSRESTOR utilities included in Visual SourceSafe 5.0.
With these utilities, you can archive projects, preserve their histories,
and restore them to a new database.
<P>
NOTE: You must have SourceSafe Admin privileges to use these utilities. For
more information on the use of SSARC and SSRESTORE, see the Visual
SourceSafe, version 5.0, "Visual SourceSafe User's Guide," Appendix B,
pages 216-220 or under the SSAdmin Online Help topic "Basic Administrator
Operations".
<P>
NOTE: In order to restore a project successfully your archive must include
the latest versions all the files in the project. If you use the -v switch
with SSARC to archive off earlier versions of your files, you will not be
able to restore that archive to a different database because it needs the
later versions.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SSAFE/Q173387.htm">Q173387</A></B>
   TITLE     : PRB: Restoring an Archive of an Entire Database

</PRE>NOTE: Because the physical file names get renamed when you restore a
project to a new database, it may be necessary to reconnect projects that
are integrated with Visual SourceSafe. Please refer to the following
article in the Microsoft Knowledge Base for additional information:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SSAFE/Q166305.htm">Q166305</A></B>
   TITLE     : HOWTO: Reconnecting a Visual C++ Project to Source Control

</PRE><h3>Scenario 3</h3>
 
<P>
Moving only the DATA directory to a machine other than the Visual
SourceSafe server. The following procedures apply to Visual SourceSafe 4.x
or 5.0x:

<OL><P><LI>Copy only the &lt;VSS server&gt;\DATA directory to its new location.
</OL>2. Edit the &lt;VSS server&gt;\srcsafe.ini file's data_path variable. For
<PRE>   example:

   Change:

      data_path = data

   To:

      data_path = \\&lt;new server path&gt;\data

</PRE></OL>Clients accessing this database do not need to be modified since the
server's Srcsafe.ini has not moved.
<P>
<P><h3>Additional Tips</h3>
 

<OL><P><LI>Remove permissions for all users at the operating system level for the
   old Visual SourceSafe installation to prevent them from checking their
   work in and out of the wrong database.

<P><LI>Once you are confident that the process is complete, delete the old
   Visual SourceSafe installation.

<P><LI>If there are shadow folders, journal files, or web deploy locations set
   up in the old installation, you need to make sure that all the paths
   correctly reference the new server location. These settings are in the
   srcsafe.ini file on the server copy of Visual SourceSafe.

<P><LI>When you start Visual SourceSafe from a client install, you might see
   the following errors:
<P>
<P><PRE>      Invalid DOS path: "&lt;path&gt;\scrsafe.ini"
</PRE><P>
   Indicates an incorrect path in the #include line of the client's
   srcsafe.ini.
<P>
</OL>-or-
<P>
<PRE>      Invalid filename: "&lt;path&gt;\scrsafe.ini"

   Indicates insufficient operating system rights.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SSAFE/Q175950.htm">Q175950</A></B>
   TITLE     : HOWTO: Change the Name of a Visual SourceSafe Database
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: relocate<BR>
Keywords          : ssconfig<BR>
Version           : WINDOWS:4.0,4.0a,5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
