

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Project Modification Not Reflected in Shadow Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162113">
<META NAME="KBModify" CONTENT="1997/01/15">
<META NAME="KBCreate" CONTENT="1997/01/14">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When you delete, share, or rename a project that is shadowed in Visual SourceSafe, the modification is not reflected in the shadow directory.  RESOLUTION  The following procedure rebuilds the shadow directory so that it accurately reflects the Visu...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA38,QABH,QABI,QBXB,QATJ,QAFI,QAEF,QDML,QA56,QA55,QBWS,QAGB,QBDM,QASW,QAGC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Project Modification Not Reflected in Shadow Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162113</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   versions 4.0, 4.0a
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you delete, share, or rename a project that is shadowed in Visual
SourceSafe, the modification is not reflected in the shadow directory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following procedure rebuilds the shadow directory so that it accurately
reflects the Visual SourceSafe database structure:

<OL><P><LI>Open or switch to the Visual SourceSafe Explorer and recursively undo
   all checkouts for the shadowed project.

<P><LI>On the Tools menu, click Options. On the General tab, set the "Check in
   unchanged files" option to Check In. Close the Options dialog box.

<P><LI>In the Windows Explorer, delete the shadow directory tree.

<P><LI>Right-click the shadowed project and click Check Out. Select the
   Recursive check box. (In version 5.0, click Advanced and clear the
   "Allow multiple checkouts" check box). Click OK. Answer "Yes All" when
   prompted to create the shadow directory.

<P><LI>Right-click the shadowed project and click Check In. Select the
   Recursive check box and click OK.
<P>
</OL>NOTE: When you follow this procedure, if appropriate, you may choose
additional options such as Remove Local Copy (during Check In) or OverRide
Working Directories (during Check Out and Check In).
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. However, please note that renaming, deleting,
or sharing a file within a shadowed project is immediately reflected within
the shadow directory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open or switch to the Visual SourceSafe Explorer. Create a Project named
   Shadow that has a subproject named Shadow1. Add two files, one to Shadow
   and the other to Shadow1.

<P><LI>Close the Visual SourceSafe Explorer and open the Visual SourceSafe
   Admin Utility. On the tools menu, click Options. Select the Shadow
   Folders tab (Shadow Directories tab in Version 4.0) and set the shadow
   directory for $/Shadow to C:\Shadow. Close the Admin Utility.

<P><LI>Open the Visual SourceSafe Explorer and do a recursive check-out on
   $/Shadow. Note that the shadow directory, C:\Shadow, contains the
   subproject and both of the added files. Undo the checkout, and then
   rename the file in $/Shadow/Shadow1. Note that this change is
   immediately reflected in the Shadow directory C:\Shadow\Shadow1.

<P><LI>Share the file from $/Shadow to $/Shadow/Shadow1. Note that this change
   is also immediately reflected in C:\Shadow\Shadow1.

<P><LI>Rename the project $/Shadow/Shadow1. Note that the shadow directory tree
   is unaffected.

<P><LI>Delete (but do not permanently destroy) the project $/Shadow/&lt;renamed&gt;.
   Note that the shadow directory tree is unaffected. Right-click the
   $/Shadow project, and choose Properties. Recover the deleted project
   from the Deleted Items tab.

<P><LI>Follow the procedure in the RESOLUTION section of this article. Note
   that the shadow directory now accurately reflects the Visual SourceSafe
   project structure.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: ssusage<BR>
Additional reference words: 4.00 4.00a 3.00b 5.00 kbdss
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
