

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Binary Files with Keyword Expansion Corrupted </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155888">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1996/09/11">
<META NAME="Keywords" CONTENT="ssafe ssusage">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  If Keyword Expansion is enabled for binary files, and a binary file containing a SourceSafe Keyword is checked in, that file will be corrupted.  RESOLUTION  1. Use Keyword Expansion in Binary Files.  Use two colons in the keyword, for example:  $Re...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEY,QABI,QDML,QABH,QA56,QA55,QAJQ,QBVP,QAYV,QAVA,QAUR,QAHT,QAEF,QBWS,QBV4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Binary Files with Keyword Expansion Corrupted</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155888</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   versions 4.0, 4.0a, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If Keyword Expansion is enabled for binary files, and a binary file
containing a SourceSafe Keyword is checked in, that file will be corrupted.
<P>
<P><h2>RESOLUTION</h2>
 

<OL><P><LI>Use Keyword Expansion in Binary Files.
<P>
</OL>Use two colons in the keyword, for example:
<P>
<PRE>$Revision::     $

</PRE></OL>NOTE: Make sure you leave enough space between the second colon and the
dollar sign for the revision number.
<P>
When you use one colon, SourceSafe puts its information between the colon
and the dollar. Depending on how long the information is, and how many
spaces you had, this will generally make the whole string either shorter or
longer than it was at first. In a text file, this is no problem, but it
will corrupt a binary file.
<P>
When you use two colons, that tells SourceSafe to keep the string length
the same. In other words, SourceSafe knows to keep the exact same number of
characters between the second colon and the dollar sign. SourceSafe will
pad with extra spaces, or truncate the information, as necessary, in order
to keep things the same, so the binary file is not corrupted.

<OL><P><LI>Disable keyword expansion in binary files using one of the following
   methods:
<P>
   a. Add the case-sensitive keyword $NoKeywords: $ before adding any other
<P><PRE>      keywords. This prevents Visual SourceSafe from expanding subsequent
      keywords.
</PRE><P>
</OL>-or-
<P>
<PRE>   b. Remove *.xls from the "Expand keywords in files of type" textbox.

</PRE></OL>-or-
<P>
<PRE>   c. Add !*.xls to the "Expand keywords in files of type" textbox.

</PRE>Items "a." and "b." listed above are both equivalent to editing the
Keyword_Masks variable manually in the SRCSAFE.INI file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In the Visual SourceSafe Administrator, go to the Tools menu and click
   Options, and then click the General tab in the Options dialog box. Add
   *.xls in the "Expand keywords in files of type" textbox.

<P><LI>Open a new Workbook in Excel and enter "Hello World" in Cell A1. Save
   the file.

<P><LI>Add the file to a Visual SourceSafe project and then check out the file.

<P><LI>Open the file in Excel. Enter "$History: $" in Cell A2.

<P><LI>Save the file and check it into Visual SourceSafe.
<P>
</OL>If the "Copy keyword-expanded files into working directory" check box is
selected (it is located on the Local Files tab in the Options dialog box)
in the Visual SourceSafe client, Excel will hang immediately. If the check
box is not selected, Excel will hang the next time that file is opened by
checking it out and opening it, or by performing a Get on the file.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on Keyword Expansion, see Chapter 5 in the Visual
SourceSafe User's Guide.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: DLL EXE DOC<BR>
Keywords          : ssafe ssusage<BR>
Version           : WINDOWS NT:4.0,4.0a,5.0;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
