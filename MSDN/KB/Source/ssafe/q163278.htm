

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC97: Err Checking Out Data Object with Linked Exchange Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163278">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1997/02/06">
<META NAME="Keywords" CONTENT="GnlOthr kberrmsg kbinterop kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  If you have a database under source code control with Microsoft Visual SourceSafe, and the database contains links to a Microsoft Outlook or Microsoft Exchange folder, when ...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QABI,QABH,QA1S,QAZV,QAPN,QAYC,QAB4,QDML,QAW6,QDN9,QAEF,QA56,QA55,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Err Checking Out Data Object with Linked Exchange Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163278</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0, 4.0a,
   5.0
<LI>Microsoft Access 97
<P>
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
If you have a database under source code control with Microsoft Visual
SourceSafe, and the database contains links to a Microsoft Outlook or
Microsoft Exchange folder, when you check out Data and Misc. Objects you
may receive one of the following error messages
<P>
<PRE>   Table 'ExchangeTable000' already exists

   -or-

   Table 'MSysExchangeColumns' already exists

</PRE>which is followed by
<P>
<PRE>   Failed to import file '&lt;Database Name&gt;' into Microsoft Access.

</PRE>After these errors, checking out Data and Misc. Objects stops, and any
remaining tables in the database are not imported from Visual SourceSafe.
<P>
NOTE: The Source Code Control component of Microsoft Access 97 is included
with the Microsoft Office 97 Developer Edition Tools.
<P>
This article assumes that you are familiar with using the client-side
capabilities of Visual SourceSafe. For more information about Visual
SourceSafe, please refer to the "Visual SourceSafe User's Guide" or
Help topics available from the Visual SourceSafe Help menu.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you check out the linked Microsoft Exchange or Microsoft Outlook
table, it creates new system tables in the Microsoft Access database. When
Visual SourceSafe tries to import the original system tables with the same
name, an error occurs and check out stops.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The resolution contains two parts. First, you must recover data and design
changes if you can. Second, you must prevent the error from occurring when
you use links to Microsoft Exchange or Microsoft Outlook folders.
<P>
<P><h3>Recovering Data After the Error</h3>
 
<P>
Data and Misc. Objects contains the following Microsoft Access database
components: tables, relationships, user-defined toolbars and menus,
database properties, startup properties, import/export specifications,
Microsoft Visual Basic project references, the project name of the
database, and conditional compilation arguments.
<P>
If you created the table links before you added the database to Visual
SourceSafe, when the error occurs you must restore the database from a
backup if there are any tables or other objects that are missing from the
database. Because all of the Data and Misc. Objects are stored in Visual
SourceSafe as a single binary object, you cannot retrieve missing objects
individually. If you do not have a backup, delete the linked Microsoft
Exchange or Microsoft Outlook tables, and then recreate any missing data,
tables, table design changes, or other components.
<P>
If you created the table links sometime after you added the database to
Visual SourceSafe, and if Visual SourceSafe is configured to retain a
history of your modifications, you can recover some or all of the data by
following these steps:

<OL><P><LI>After you receive the error, the Data and Misc. Objects that were
   checked out before the error message are still checked out in your
   database. On the Tools menu, point to SourceSafe, and then click Undo
   Check Out. Undo the check out for Data and Misc. Objects, and
   click Yes when prompted if you want to undo checkout and lose changes.
   Note that you receive the same error messages again when you undo the
   check out.

<P><LI>If you have any other database objects checked out, check them back in
   as you usually do.

<P><LI>Make a backup copy of the database. You will import objects from this
   copy in a later step.

<P><LI>On the Tools menu, point to SourceSafe, and then click Show History.

<P><LI>In the History dialog box, select the version before the one in which
   you created the links to Microsoft Exchange or Microsoft Outlook, and
   then click Rollback.
<P>
   NOTE: Rolling back to an earlier revision will cause you to lose some
   of the modifications you have made to your database. Rolling back to the
   version immediately before the creation of the linked tables will
   minimize this loss.

<P><LI>When the rollback is complete, check out Data and Misc. Objects.

<P><LI>Recover missing design and data changes to Data and Misc. Objects by
   importing objects or appending data from the backup database you
   created in step 3. You must recreate any changes you cannot recover.
   Verify that each component is fully restored and up-to-date in your
   rolled-back database before you proceed with further development.
<P>
</OL><h3>Preventing the Error from Occurring</h3>
 
<P>
The only way to prevent the error is to name your links to Microsoft
Exchange or Microsoft Outlook folders so they appear alphabetically after
MSysExchangeTables. A good rule of thumb is to name those links starting
with the letter N or higher.
<P>
When you check out Data and Misc. Objects, the tables are imported
alphabetically; if your linked tables start with the letter N or higher,
the Microsoft Exchange system tables will already exist in the database
when the linked table is imported by Visual SourceSafe. When the links are
refreshed, Microsoft Access uses the existing system tables and does not
try to create new ones.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you first link to a Microsoft Exchange or Microsoft Outlook folder,
three system tables are created in your database to manage the link:
MSysExchangeColumns, MSysExchangeTables, and ExchangeTable000. Each
subsequent link creates one new incremental system table:
ExchangeTable001, ExchangeTable002, and so on.
<P>
When you check in Data and Misc. Objects, Visual SourceSafe stores those
system tables with your other tables. When you check out Data and Misc.
Objects again, if your linked table occurs alphabetically before
ExchangeTablexxx or MSysExchangeColumns, it is imported before those
system tables. Because they don't exist in the database, those system
tables are recreated when the table link is refreshed. Then Visual
SourceSafe tries to import the copy of those system tables it has stored,
and an error occurs because the tables already exist.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new blank database in Microsoft Access 97.

<P><LI>Create a link to a Microsoft Exchange or Microsoft Outlook folder.
   Regardless of the name of the folder you link to, name the linked table
   Contacts in Microsoft Access. This ensures that it appears
   alphabetically in the Database window before its supporting system
   tables.

<P><LI>Create another table called Test. It can be an empty table, and only
   needs to contain a single field. You do not need to create a primary
   key.

<P><LI>On the Tools menu, point to SourceSafe, and then click Add Database to
   SourceSafe. Add the database to a new SourceSafe project.

<P><LI>Check out Data and Misc. Objects. Note that you receive the error
   message
<P>
<P><PRE>      Table 'ExchangeTable000' already exists
</PRE><P>
   followed by
<P>
<P><PRE>      Failed to import file '&lt;Database Name&gt;' into Microsoft Access.
</PRE><P>
   After you click OK, note also that the Test table is missing from the
   Database window.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about installing and using the Microsoft
Outlook/Exchange driver, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q159322.htm">Q159322</A></B>
   TITLE     : ACC97: Paradox, Lotus, &amp; MS Exchange/Outlook ISAMs in
               ValuPack

   ARTICLE-ID: <B><A HREF="../ACCESS/Q161173.htm">Q161173</A></B>
   TITLE     : ACC97: MS Exchange ISAM Driver Requires Manual Registration

   ARTICLE-ID: <B><A HREF="../vbapps/Q161174.htm">Q161174</A></B>
   TITLE     : ACC97: Sample Procedure to Attach a Microsoft Outlook Folder

</PRE></OL>For more information about Microsoft Access system tables, search the Help
Index for "system tables," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: outlook exchange isam vss mail mapi attach<BR>
Keywords            : GnlOthr kberrmsg kbinterop kbbuglist<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
