

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Invalid Handle on Client When Journal_Text Set to Bad Path </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162530">
<META NAME="KBModify" CONTENT="1997/01/24">
<META NAME="KBCreate" CONTENT="1997/01/23">
<META NAME="Keywords" CONTENT="kbsetup kbenv kbprb">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  In the Visual SourceSafe Administrator, if the  Log all actions in Journal File  (located on the Tools Options General tab) is set to a Bad or Non- Existent path for client workstations, Invalid Handle error messages appear on the client workstatio...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QABH,QARL,QDML,QBXS,QA56,QA55,QAY5,QBBK,QAHI,QAB4,QBV0,QAFI,QBJZ,QAJ4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Invalid Handle on Client When Journal_Text Set to Bad Path</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162530</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   version 4.0
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0,
   4.0a, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the Visual SourceSafe Administrator, if the "Log all actions in Journal
File" (located on the Tools Options General tab) is set to a Bad or Non-
Existent path for client workstations, Invalid Handle error messages appear
on the client workstation when you perform operations that log to the
journal file, such as check out or check in.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you set the "Log all actions in Journal File," it sets the
Journal_File variable in the Srcsafe.ini on the server. Clients access this
file by the Srcsafe.ini on the local workstation by responding to the
<PRE>#include &lt; path to server Srcsafe.ini &gt; line.

</PRE>Since the local Visual SourceSafe workstation uses the server settings when
the Journal_File path cannot be resolved (that is, the drive or directory
structure does not exist for that workstation), an Invalid Handle error
results when the local Visual SourceSafe workstation executes an operation
that writes an entry into the journal file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When setting a location for the journal file, make sure that all Visual
SourceSafe clients can see the path to the file. Microsoft network users or
users of networks supporting Universal Naming Convention (UNC) pathing
should consider using a UNC path to the journal file location. In cases
where UNC pathing is not desired or available, set a common drive mapping
on all client computers to the journal file location.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start the Visual SourceSafe Administrator. On the Tools menu, click
   Options and then click the General tab.

<P><LI>On the General tab, set the "Log all actions in Journal File" to Non-
   Existent Drive for the client workstation.

<P><LI>In the Visual SourceSafe Explorer, perform a check out or check in
   operation.

<P><LI>When the check out or check in operation attempts to write the details
   of the operation to the journal file, an Invalid Handle message occurs
   on the client workstation.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbenv kbprb<BR>
KBSubcategory: ssconfig<BR>
Additional reference words: 3.00b 4.00 4.0a 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
