

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Restoring an Archive of an Entire Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173387">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1997/09/02">
<META NAME="Keywords" CONTENT="sscl ssother">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  After you have archived an entire database with the SSARC utility and you try to restore it with SSRESTOR, you receive the following error:     The path $/ is already in use. Cannot restore path from archive file.  CAUSE =====  The syntax you used ...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJN,QA2X,QAVV,QAUR,QAKJ,QALW,QAZV,QAFI,QAG0,QA3A,QBWQ,QBW1,QDL9,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Restoring an Archive of an Entire Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173387</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
   on the following platforms:
   - Windows NT
   - Windows 95
   - x86
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you have archived an entire database with the SSARC utility and you
try to restore it with SSRESTOR, you receive the following error:
<P>
<PRE>   The path $/ is already in use. Cannot restore path from archive file.

</PRE><h2>CAUSE</h2>
 
<P>
The syntax you used was:
<P>
<PRE>   SSRESTOR [-s path to srcsafe.ini] &lt;archive file&gt; $/

</PRE>SSRESTOR attempts to create a new project in the target database, with the
name of the project given in the SSRESTOR command. Because the root project
($/) will always exist in the target database, the restored root project
cannot be created.
<P>
<P><h2>RESOLUTION</h2>
 

<OL><P><LI>Repeat the SSRESTOR command multiple times, once for each top-level
   project.
<P>
   -or-

<P><LI>In the original project, share the entire project tree to a new project,
   and then archive and restore this project.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design. According to the User's Guide (Appendix B page
219 for Visual SourceSafe 5.0), "if restoring attempts to create a
duplicate file or project name, the restore fails."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If, for example you have three top-level projects:
<P>
<PRE>   $/first
   $/second
   $/third

</PRE></OL><h3>Resolution 1</h3>
 
<P>
Run SSRESTOR three times, each time specifying the name of one of the
projects as the last argument (for example, SSRESTOR archive.ssa $/first).
There are two disadvantages to this method.
<P>
If there is a large number of top-level projects, this process will be
tedious, and there is no easy way to automate it. Any links (shared or
branched files) between top-level projects and will be lost. For example,
if:
<P>
<PRE>   $/first/sub_one/myfile.txt

</PRE>is shared to:
<P>
<PRE>   $/third/sub_one/myfile.txt

</PRE>the files will not be shared in the restored projects.
<P>
Links that are within the same project tree are maintained, such as:
<P>
<PRE>   $/first/sub_one/myfile.txt
   $/first/sub_five/myfile.txt

</PRE><h3>Resolution 2</h3>
 
<P>
There are three steps in this resolution:

<OL><P><LI>In the original database, create a new top-level project, (for example,
   $/root), then recursively share all top-level projects into $/root.

<P><LI> Archive $/root.

<P><LI> Restore $/root into the target database.
<P>
</OL>In this case all links at all levels are restored, the disadvantages of
this method are:

<UL><LI>With a large number of top-level projects, sharing them into $/root may
   be time consuming.

<LI>After restoring, you may want to move all the top-level projects back to
   being subprojects of $/, rather than subprojects of $/root. Again, this
   may be time consuming with a large number of projects.
</UL> 
<PRE>Keywords          : sscl ssother
Version           : WINDOWS:5.0
Platform          : NT Win95 WINDOWS
Hardware          : x86
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
