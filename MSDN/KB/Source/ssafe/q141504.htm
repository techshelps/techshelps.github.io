

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Make SourceSafe Keyword Expansion Work in Text Docs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141504">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1995/12/19">
<META NAME="Keywords" CONTENT="SourceSafe">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  This article describes how to set up SourceSafe to use keyword expansion. Note that keyword expansion occurs only if a user changes a file and then updates or checks in the file. The following table lists and describes the valid keywords:  Valid Ke...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEY,QAMB,QDML,QA2X,QAGU,QAXB,QAN0,QACE,QAC1,QBD2,QAML,QABA,QBDM,QAUR,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Make SourceSafe Keyword Expansion Work in Text Docs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141504</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
<LI>Microsoft Visual SourceSafe for Windows, versions 3.1, 4.0
<LI>Microsoft Visual SourceSafe for Windows NT, versions 3.1, 4.0
<LI>Microsoft Visual SourceSafe for Windows 95, versions 3.1, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to set up SourceSafe to use keyword expansion.
Note that keyword expansion occurs only if a user changes a file and then
updates or checks in the file. The following table lists and describes the
valid keywords:
<P>
<PRE>Valid Keyword     Description
--------------    ----------------------------------------------

$Archive: $       &amp;&amp; Project path and file name in Source Safe
$Author:  $       &amp;&amp; User who last changed the file
$Date:  $         &amp;&amp; Date and Time of last check in
$Header: $        &amp;&amp; Archive Info, Revision, Date, User
$Logfile: $       &amp;&amp; Same as $Archive: $
$Modtime: $       &amp;&amp; Date and time of last modification
$Revision: $      &amp;&amp; Revision number
$Workfile: $      &amp;&amp; File name
$Log:  $          &amp;&amp; Same as $History: $ except in RCS format
$History: $       &amp;&amp; File name, Revision, Date, Time, User
$NoKeywords: $    &amp;&amp; Disables all keywords after this keyword

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>To make keyword expansion work, use either one of the two methods
   described below:
<P>
<P><PRE>    - In the Visual SourceSafe Administrator, point to Tools and click
      Options and in the "Expand keywords in files of type" option, enter
      the file types for the keyword expansion. For example, type *.txt.
</PRE><P>
<P><PRE>    - or -
</PRE><P>
<P><PRE>    - Add the following line to the Srcsafe.ini file on the server:
</PRE><P>
<PRE>        Keyword_Masks = *.TXT

   NOTE: It must also be placed before the first occurrence of a section
   header in the srcsafe.ini file.  A section header is a line enclosed in
   square brackets, i.e. [$/MyProj].  This setting will not work if placed
   in an individual user's ss.ini file.

   Optionally, the following line can be added to the srcsafe.ini file.
   This setting will update keywords in a user's working directory with the
   new keyword information when a user updates or checks in a file.

        Expand_Keywords_Locally = YES

   NOTE: You can put the Expand_Keywords_Locally setting into a user's
   Ss.ini file to individualize settings.

   NOTE: The file may not have updated keywords if the user chooses to keep
   the file checked out on the update (that is, Keep_Checkedout=YES).

   NOTE: On SourceSafe for the Macintosh versions 3.04 and 3.1, keyword
   expansion only works with a specific setup. For more information, please
   see the following article in the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A HREF="../SSAFE/Q129192.htm">Q129192</A></B>
      TITLE     : BUG: Keyword Expansion Fails on the Macintosh

   NOTE: The "Keyword_Masks =" line can have any extension or combination
   of extensions. If you use more than one extension, you must separate
   them with a comma or the keyword expansion won't work. For example:

      Keyword_Masks = *.C, *.CCP, *.H, *.HPP, *.BAS

</PRE><P><LI>Add keywords to files. Keywords are case sensitive. For more information
   on this, please see the following article in the Microsoft Knowledge
   Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../SSAFE/Q131092.htm">Q131092</A></B>
<PRE></PRE>      TITLE     : PRB: Keyword Expansion is Case Sensitive

   NOTE: In the User's Guide, the keyword is $NoKeywords: $ is incorrect.
   It is listed as $Nokeywords: $, with a lower case k. It should be
   $NoKeywords: $, with an upper case K. This keyword will not work with a
   lower case k.

</PRE><P><LI>Format the keywords correctly. There are two ways to format keywords in
   files. The most frequently used method is to align the keywords on the
   left margin:
<P>
<P><PRE>      $Archive: $
      $Author: $
      $Date: $
</PRE><P>
   When expanded, it will look like this:
<P>
<P><PRE>      $Archive: /KeywordAlignTest/KeyAlign1.txt $
      $Author: Guest $
      $Date: 11/23/95 9:31a $
</PRE><P>
   The other way is to format the keywords so that when they are expanded,
   the values are aligned in a column. Note the use of two colons and the
   amount of space between the colons and the second dollar sign.
<P>
<PRE>      $Archive::                                                   $
       $Author::                                                   $
         $Date::                                                   $

   When it is expanded, it looks like this:

      $Archive:: /KeywordAlignTest/KeyAlign1.txt                   $
       $Author:: Guest                                             $
         $Date:: 11/11/95 5:57p                                    $

   If you don't leave enough space between the colons and the dollar
   sign, SourceSafe will truncate the value so it would look like this:

      $Archive:: /KeywordAli$
       $Author:: Guest      $
         $Date:: 11/11/95 5:$

</PRE><P><LI>Place comment characters in front of keywords so the keywords are not
   compiled. SourceSafe sets the following comment characters by default:
<P>
<P><PRE>      *.ASM = "; "
      *.BAS = "rem "
      *.BAT = "rem "
      *.S = "; "
      ;default comment for all other file types
      *.* = "* "
</PRE><P>
   If you want to use a different comment character in a file that has a
   specific file extension, add the following lines to the Srcsafe.ini file
   on the server:
<P>
<P><PRE>      [Keyword Comments]
      *.C = "/*","*/"
</PRE><P>
   The comment character is especially important in dealing with $Log: $
   and $History: $ keywords. Unlike the other keywords, $Log: $ and
   $History: $ keywords add more information to the file each time keywords
   are updated -- instead of just replacing the previous information with
   the current information. A comment character, as defined by the
   Srcsafe.ini, is added to the beginning of each line created by $Log: $
   and $History: $ keywords. For example, if the following is in a .txt
   file:
<P>
<P><PRE>      *$Log: $
      *$History: $
</PRE><P>
   and the default comment characters are in effect, it would look like
   this after keyword expansion took place:
<P>
<P><PRE>      *$Log: /KeywordAlignTest/KeyAlign1.txt $
       *
<PRE></PRE>       * 3    11/23/95 10:47a Guest
       *
       * 2    11/23/95 10:45a Guest
       *
       * 1    11/11/95 5:57p Guest
      *$History: KeyAlign1.txt $
       *
       * *****************  Version 3  *****************
       * User: Guest     Date: 11/23/95   Time: 10:47a
       * Updated in $/KeywordAlignTest
       *
       * *****************  Version 2  *****************
       * User: Guest     Date: 11/23/95   Time: 10:45a
       * Updated in $/KeywordAlignTest
       *
       * *****************  Version 1  *****************
       * User: Guest     Date: 11/11/95   Time: 5:57p
       * Updated in $/KeywordAlignTest

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Pages 68-71 of the Microsoft Visual SourceSafe User's Guide for version 4.0
 
<PRE>Keywords          : SourceSafe
Version           : WINDOWS:3.1 4.0
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
