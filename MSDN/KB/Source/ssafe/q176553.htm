

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Database Architecture Changes in 4.0, 4.0a, and 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176553">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/11/10">
<META NAME="Keywords" CONTENT="ssconv ssother">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  Visual SourceSafe database architecture changed dramatically between versions 3.x and 4.0. However, no architectural changes were made to the database log files between 4.x and 5.x.  This means that a Visual SourceSafe 5.0 client (build 2218, 2219,...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QARL,QDML,QA56,QA55,QDMW,QBE7,QBE6,QA2X,QAYV,QAUR,QALQ,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Database Architecture Changes in 4.0, 4.0a, and 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176553</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0, 4.0a,
   5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual SourceSafe database architecture changed dramatically between
versions 3.x and 4.0. However, no architectural changes were made to the
database log files between 4.x and 5.x.
<P>
This means that a Visual SourceSafe 5.0 client (build 2218, 2219, or 2220)
can be used on a 5.0 or 4.0 version database. Visual SourceSafe 4.0a (build
1309) can be used on a 5.0 or 4.0 version database as well. The only
restriction is that 4.0 clients (build 0811 or 0831) can only be used on
4.0 databases. The term "client" refers to the executables for the Visual
SourceSafe Explorer and command line interfaces.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The only change to files within the 5.0 database is the addition of a 16-
byte (128 bit) unique identifier (GUID) to the um.dat file. However, this
Guid is not added when the 5.0 version of DDCONV.exe is run on the 4.x
database. It is only added if the SSARC or SSRESTOR (archive &amp; restore
utilities) are run on the database. This is to ensure that the database can
be uniquely identified for archive &amp; restore operations. This guarantees
that Ssrestor.exe knows whether the archive it is restoring is being
applied to the same or a different database than it was archived from.
<P>
Restating the SUMMARY section: The 4.0 client (builds 0811 and 0831) can't
read the um.dat file that contains a Guid. So they will not work with a 5.0
database. The 4.0a client (build 1309) and the 5.0 client (build 2218, 2219
and 2220) can read the um.dat file if it has a Guid or not, so these
clients will work with all databases.
 
<PRE>Keywords          : ssconv ssother
Version           : WINDOWS:4.0,4.0a,5.0
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
