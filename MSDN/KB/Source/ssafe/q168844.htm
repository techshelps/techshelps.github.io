

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Undo Check Out Not Behaving As Expected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168844">
<META NAME="KBModify" CONTENT="1997/05/22">
<META NAME="KBCreate" CONTENT="1997/05/21">
<META NAME="Keywords" CONTENT="kbusage ssusage">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  The  Undo Check Out  command does not operate as expected if you have the  Compare Files By  option set to  Time  and the  Set Date/Time on Local Files  set to  Current .  CAUSE =====  When you set  Compare Files By  to  Time , the algorithm used t...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QAML,QBXS,QAEF,QDML,QBVV,QA9N,QA5C,QAAW,QASB,QAGC,QAX6,QAXC,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Undo Check Out Not Behaving As Expected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168844</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   version 4.0
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The "Undo Check Out" command does not operate as expected if you have the
"Compare Files By" option set to "Time" and the "Set Date/Time on Local
Files" set to "Current".
<P>
<P><h2>CAUSE</h2>
 
<P>
When you set "Compare Files By" to "Time", the algorithm used to determine
whether a Get should be performed is based on a comparison between the
timestamp on the local copy of the file and the timestamp on the last check
in for the file.
<P>
If the timestamp on the last check in is more recent than the timestamp on
the local file, SourceSafe does the Get and overwrites the local copy of
the file. If the timestamp on the local file is more recent than the
timestamp on the last check in, SourceSafe does not do the Get, and the
local file is not replaced.
<P>
<P><h2>RESOLUTION</h2>
 

<UL><LI>Set the "Compare Files By" option to "CheckSum" instead of "Time"
<P>
</UL>-or-

<UL><LI>Remove the local copy of the file, and then perform the Get/Check Out.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you perform an "Undo Check Out" with the above options set in
SourceSafe, unexpected results occur.
<P>
Lets say that you've got a file checked out and you've edited it. The local
file (the one you are editing) has a more recent timestamp on it than the
last checked in copy of the file. After you've edited and saved the file
you decide you really don't want the changes you made, so you go back to
SourceSafe and perform an "Undo Check Out" on the file. You get the warning
message stating that all your changes will be lost if you perform an Undo
Check Out. You click "Yes" and SourceSafe does not copy the changes in the
local file back to the server.
<P>
When you Get or Check Out the file again, SourceSafe sees that the
timestamp on your local file is more recent than the timestamp on the last
check in. SourceSafe does not perform the Get, and the local file is not
replaced. As a result, you see all the changes you thought you had
discarded instead of the unaltered copy you thought you retrieved by
performing the Get.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.0b<BR>
Keywords            : kbusage ssusage<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
