

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Branch or Rollback of Shared File May Cause Corruption </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157813">
<META NAME="KBModify" CONTENT="1998/01/28">
<META NAME="KBCreate" CONTENT="1996/10/18">
<META NAME="Keywords" CONTENT="fixlist500 ssusage">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When you Branch or Rollback a shared file that uses Keyword Expansion, previous versions of that file may become corrupt. The corruption will be seen in all versions two or more behind the current version of the file. For example, if you have a sha...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDLB,QDML,QAFI,QAMB,QA56,QA55,QAC1,QAEY,QABI,QBWQ,QAR4,QABH,QAKP,QA3A,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Branch or Rollback of Shared File May Cause Corruption</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 28, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157813</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you Branch or Rollback a shared file that uses Keyword Expansion,
previous versions of that file may become corrupt. The corruption will be
seen in all versions two or more behind the current version of the file.
For example, if you have a shared file that uses Keyword Expansion that
contains 10 versions and you Rollback that file to version 8, versions 1
through 5 may be corrupted.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when a Branch is executed on a file that uses Keyword
Expansion. When you Rollback a shared file, Visual SourceSafe actually
performs a branch in conjunction with the Rollback. It is this Branch that
results in the problem, not the Rollback itself.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not use Keyword Expansion or do not Rollback a file that uses Keyword
Expansion in versions prior to 4.0.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Visual SourceSafe version
4.0 and 4.0a for Windows. This problem was corrected Visual SourceSafe for
Windows, version 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI> Use an ASCII text editor, such as Notepad, to create a new text file.

<P><LI> Add the following text to the beginning of line 1:
<P>
<P><PRE>    $History:: $
</PRE>
<P><LI> Add the following text to the beginning of line 2:
<P>
<P><PRE>    This is my entry for version 2
</PRE>
<P><LI> Save the file and add it to a Visual SourceSafe project.

<P><LI> Share the file with another Sourcesafe project or subproject.

<P><LI> Check out the file from Visual SourceSafe.

<P><LI> Add a new line to the checked out file that reads:
<P>
<P><PRE>    This is my entry for version 3
</PRE>
<P><LI> Save the changes and check the file back into Visual SourceSafe.

<P><LI> Repeat steps 6 through 8 until you have added a total of 6 versions of
<P><PRE>    comments in the file.
</PRE>
<P><LI>Branch off the shared copy of the file.

<P><LI>Right-click on the branched copy of the file, and then choose Show
<P><PRE>    History.
</PRE>
<P><LI>Do a View on any version two or more versions behind the branched
<P><PRE>    version. For example, if version 6 is the branched version, note that
    version 4 or earlier of the file has missing data.
</PRE><P>
</OL>NOTE: The problem would also occur if you were to replace step 10 above
with a Rollback because SourceSafe would perform a Branch at this point.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SSAFE/Q157082.htm">Q157082</A></B>
   TITLE     : BUG: Rollback of a Shared Files Rolls to Unexpected Version

   ARTICLE-ID: <B><A HREF="../SSAFE/Q156717.htm">Q156717</A></B>
   TITLE     : PRB: Rollback of Shared Files Forces a Branch
</PRE></OL> 
<PRE>Keywords          : fixlist500 ssusage
Version           : WIN95
Platform          : Win95
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 28, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
