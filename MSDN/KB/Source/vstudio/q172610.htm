

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Visual Studio 97 Service Pack 2 Readme </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172610">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1997/08/12">
<META NAME="Keywords" CONTENT="kbreadme VS97FixlistSP2 VS97FixlistSP1 VS97FixlistSP3 kbreadme">
<META NAME="KBArea" CONTENT="Support; KB; vstudio">
<META NAME="Description" CONTENT="  This is a copy of the Visual Studio 97 Service Pack 2 Readme (English language version).  MORE INFORMATION  Microsoft Visual Studio 97 Service Pack 2 Readme  The Microsoft Visual Studio 97 Service Pack 2 Readme contains the following sections:   - ...">
<META NAME="Product" CONTENT="vstudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QBS0,QA55,QA56,QAA1,QAR4,QAXB,QDI2,QAB5,QBRJ,QBV9,QBVV,QAC1,QBD2,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Visual Studio 97 Service Pack 2 Readme</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172610</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Studio 97sp2
<LI>Microsoft Visual C++, 32-bit Editions, version 5.0
<LI>Microsoft Visual Basic Learning and Professional Editions for Windows,
   version 5.0
<LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
<LI>Microsoft Visual J++, version 1.1
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
<LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This is a copy of the Visual Studio 97 Service Pack 2 Readme (English
language version).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Visual Studio 97 Service Pack 2 Readme</h3>
 
<P>
The Microsoft Visual Studio 97 Service Pack 2 Readme contains the following
sections:

<UL><LI>Microsoft Visual Studio 97 Service Pack 2 provides an overview of Visual
   Studio Service Pack 2.

<LI>Installing the Microsoft Visual Studio 97 Service Pack 2 provides
   installation and setup instructions.

<LI>Notes on Fixes in the Visual Studio 97 Service Pack 2 provides overall
   information on the fixes and the interactions with other products.

<LI>Finding More Information on Issues Resolved with This Service Pack
   provides instructions on how to search online for the Knowledge Base
   articles, and a list of the fixes and their summaries.

<LI>Welcome to Visual Basic 5.0 Service Pack 2 contains the Visual Basic
   Readme for this Service Pack.
<P>
</UL><h3>Microsoft Visual Studio 97 Service Pack 2</h3>
 
<P>
The Microsoft Visual Studio 97 Service Pack 2 includes all of the fixes in
Service Pack 1 and upgrades the following Visual Studio applications:
<P>
<PRE> Microsoft Visual Studio 97 (Professional and Enterprise Editions)
 Microsoft Visual Basic, version 5.0 (Professional and Enterprise Editions)
 Microsoft Visual C++, version 5.0 (Professional and Enterprise Editions)
 Microsoft Visual InterDev
 Microsoft Visual J++, version 1.1
 Microsoft Visual SourceSafe, version 5.0
 Microsoft Visual FoxPro, version 5.0
 Microsoft Developer Network (MSDN) Library

</PRE>These Visual Studio applications should be shut down before installing this
Service Pack. Install this Service Pack whenever you have updated or
changed any of the applications in Visual Studio to ensure that you have
the latest fixes.
<P>
<P><h3>Installing the Microsoft Visual Studio 97 Service Pack 2</h3>
 
<P>
To install the Service Pack, insert the compact disc into your computer's
CD-ROM drive. If you have downloaded and decompressed the Service Pack, or
if the Service Pack Setup does not automatically launch, go to the root
directory of the Service Pack and run Setup. The setup.exe will detect the
language of your computer's operating system and run one of the following
setups:
<P>
<PRE> \fra\setup (French)
 \deu\setup (German)
 \enu\setup (English)
 \jpn\setup (Japanese)
 \esp\setup (Spanish)
 \kor\setup (Korean)
 \chs\setup (Simplified Chinese)
 \cht\setup (Traditional Chinese)
 \ita\setup (Italian)

</PRE>The Service Pack Setup detects any installed Visual Studio applications and
the specific languages those applications use. (Files are checked for
language, determined by the operating system settings and the individual
file settings.) This Service Pack supports the following languages: Czech,
English, French, German, Italian, Japanese, Korean, Portuguese, Russian,
Simplified Chinese, Spanish, and Traditional Chinese.
<P>
During the installation, the Service Pack displays the files to be
installed or updated based on the installed applications detected. After
updating your installation of any of the Visual Studio applications, the
Service Pack appends any actions to the VS97SP2.log file, which is stored
in the root directory of the drive where Windows is installed. If you run
the Service Pack again, any additional file updates are appended to the end
of the log file.
<P>
Determining the Files That Setup Installs
<P>
Setup does not install all the files included in this Service Pack on your
computer.
<P>
If the file does not exist already on your computer, in most cases Setup
will not install an update for it. Setup does not make any entries in the
log for files that are not present.
<P>
If the file on your computer is a more recent version than the one in the
Service Pack, Setup will not update the file on your computer. The setup
log will state "File is up to date" for each file on your computer that is
the same version or more recent than what is on the Service Pack.
<P>
Some .cab files are included in the Service Pack for redistribution only.
Setup does not install them as part of the product update. You must copy
them from the compact disc as needed.
<P>
Interpreting the Setup Log File
<P>
Setup will perform one of two actions for each file in its file list. If
Setup detects that a file is not installed on your computer and the file is
not required, Setup will neither install it nor create a report in the log.
Otherwise, Setup will report in the log one of the following conditions for
each file in its list:

<UL><LI>"Copied successfully": The file on your computer was successfully
   updated with the file in Setup's list.

<LI>"Rename on reboot": The file on your computer was in use during the
   copy process. It will be replaced with the Service Pack copy on the next
   system reboot.

<LI>"File is up to date": The Service Pack file contains version
   information and the file on your computer is the same or a later
   version. (Setup will also report this message if the date of any file
   that does not contain version information, such as a text file, on your
   computer is later than the date of the Service Pack file.)
<P>
</UL>All other errors, such as "Access denied" or "The system cannot find the
path specified," are the operating system's error message for a particular
problem. These errors indicate that Setup could not update the file.
<P>
Updating Files You Previously Modified
<P>
The primary way Setup determines which files to replace is by checking the
version information in a file's resources. However, some files, such as
text files and non-binary files, have no resource information. In these
cases, Setup uses the time stamp to determine which files need to be
replaced.
<P>
If you have altered the time stamp on any of the Visual Studio component
text files or files that do not have version information, then Setup may
not replace those files. Source files and header files are examples of some
files you might have changed.  Please check the setup log to determine
which files have been updated. You must evaluate each of the files that is
not updated to determine whether you should use the Service Pack version.
<P>
Determining the Update History of the Products Based on File Versions
<P>
To determine which updates have been made since the initial release of a
product, you will need to examine the version number in the properties of
one or more files.
<P>
To determine the update status of a product:

<OL><P><LI>Look in the table below to determine which file you want to examine. In
   some cases, you may need to examine more than one file to determine
   fully the product's update history.

<P><LI>For each file, right-click the file in Windows Explorer, then click
   Properties.

<P><LI>Click the Versions tab and compare the version listed with the version
   in the table.
<P>
</OL>The following table lists the developer tools that shipped in 1997 and have
been updated in a Visual Studio 97 Service Pack. It also lists the key
files you should check to ascertain version information:
<P>
<PRE>                                       Version on
   Product               Files         Release     SP1         SP2
   -------------------------------------------------------------------
   Visual Basic 5.0      setupwiz.exe  5.00.3716   5.00.3905   5.00.3905
                         vb5ide.dll    5.00.3724   ---         5.00.4319

   Visual C++ 5.0        link.exe      5.00.7022   5.02.7132   5.02.7132
                         eecxx.dll     5.00.7122   ---         5.00.7198

   Visual InterDev 1.0   devisws.pkg   5.00.7022   5.00.7087   No update

   Visual J++ 1.1        devjava.pkg   5.00.7022   5.00.7128   5.00.7128
                         devdbg.pkg    5.00.7022   5.00.7128   5.00.7198

   Visual SourceSafe 5.0 ssscc.dll     5.00.2218   5.00.2219   5.00.2220

   Visual FoxPro 5.0     vfp.exe       Build 402   No update   Build 412

</PRE></OL>NOTE: "No update" means that the product has no updates in the Service
Pack. Also note that even for updated products, some of the files did not
change from one service pack to the next.
<P>
The InfoViewer tool is used to display online help for Visual Studio and
MSDN. It has also been updated several times.
<P>
<PRE>               Version on
   Files       Release     MSDN April  SP1         MSDN July   SP2
   ---------------------------------------------------------------------
   ivauto.dll  5.00.7022   5.00.7022   5.00.7055   5.00.7055   5.00.7198
   deviv.pkg   5.00.7022   5.00.7022   ---         5.00.7022   5.00.7198

</PRE>Uninstalling the Visual Studio 97 Service Pack
<P>
The Service Pack cannot be uninstalled independently of the product tools
being updated. To uninstall the Service Pack updates to a Visual Studio 97
tool, such as Visual C++ or Visual Basic, you must uninstall the tool. The
Service Pack updates will be uninstalled with it. Then, reinstall the tools
without the updates.
<P>
Because many interdependent components of the Visual Studio 97 tools are
simultaneously updated by the Service Pack, the products may become
unstable if you roll back of some of the updates, or if you run Setup in
maintenance mode from the original product compact disc. This instability
can occur because of the combination of files that are updated and files
that are not updated.
<P>
To avoid an unstable combination of updated and old files, you must remove
all of the Visual Studio 97 tools completely if you want to remove the
Service Pack updates or if you want to remove parts of the product. If you
had not installed everything in your Visual Studio suite before applying
the Service Pack and you now want to add some of the remaining components,
make the additions first, then apply the Service Pack.
<P>
<P><h3>Notes on Fixes in the Visual Studio Service Pack 2</h3>
 
<P>
Microsoft Visual Studio 97 Service Pack 2 includes all of the fixes in
Service Pack 1.
<P>
NOTE: Do not use the Microsoft Utility RegClean 4.1 with Visual Studio or
any Visual Studio Applications.
<P>
If you run RegClean 4.1 (build 97.71), you might find (if you have Visual
C++ Enterprise or Visual Basic Enterprise installed) that the Database
Designer no longer works, or (if you have Visual InterDev installed)
the Database Designer and LinkView tools no longer work. If you have run
RegClean, then reinstall the Visual Studio applications as appropriate.
<P>
Active Server Pages (ASP) Browser Component Does Not Recognize the Browser
<P>
If you are installing a new release of Microsoft Internet Explorer or
Netscape Navigator, the ASP browser component object may not work in Visual
Studio. The string identifying the browser may not be present in the
browsecap.ini file, which is located on the Web server. The solution is to
either manually change the file or download a newer version of the file
from the Internet Information Server (IIS) Web site.
<P>
The version of the browsecap.ini file that currently ships with the Visual
InterDev server components does not recognize Microsoft Internet Explorer
3.02 as a valid browser. This results in an error when running an .asp page
using the browser component in Microsoft Internet Explorer 3.02.
<P>
An updated version of the browsecap.ini file as well as a 1.0b updated
version of Active Server Pages is available at:
<B><A HREF="http://www.microsoft.com/iis/">http://www.microsoft.com/iis/.</A></B> Once there, click the "get IIS" button and
choose "Other free software," then "Updates for IIS." Choose a new
compressed or uncompressed browsecap.ini file to download.
<P>
A full download of Active Server Pages English 1.0b is available under "get
iis" as well. The 1.0b English version provides full DBCS enabling and some
fixes.
<P>
Updates to SQL Server and Visual Database Tools
<P>
You must download SQL Server Service Pack 3 for working with Visual
Database Tools and/or Visual InterDev.
<P>
The SQL Server Service Pack 3 is available at:
<B><A HREF="http://www.microsoft.com/sql/ServicePak.htm">http://www.microsoft.com/sql/ServicePak.htm.</A></B>
<P>
SQL Server Service Pack 3 fixes several issues with the relational engine
of Visual Database Tools including:

<UL><LI>A query with two or more RIGHT/LEFT OUTER JOIN clauses resulted in a
   syntax error.  Now they parse correctly and generate the correct result.

<LI>Some "complex" queries and views with five or more tables would stop the
   server.  This resulted in a TDS Protocol error and a subsequent stop of
   Visual Studio. This issue has been corrected.
<P>
</UL>Visual Database Tools/Visual InterDev still requires, as a minimum, SQL
Server Service Pack 1, but installing SQL Server Service Pack 3 is
recommended.
<P>
Microsoft Internet Explorer Security Options and InfoViewer
<P>
InfoViewer, the integrated online documentation viewer included with MSDN
and Visual Studio, relies on the Microsoft Internet Explorer security
settings for active content. The online documentation included with MSDN
and Visual Studio includes some active content. If you set your Microsoft
Internet Explorer security's maximum security options while browsing the
World Wide Web, some types of hyperlinks in your online documentation will
not work.
<P>
Allowing Microsoft Internet Explorer to download an ActiveX control and
then automatically executing the downloaded code is a legitimate security
concern. However, you can protect against this problem and still use the
online documentation included with MSDN and Visual Studio. To do so,
complete the following steps.

<OL><P><LI>On the View menu in Microsoft Internet Explorer, click Options.

<P><LI>Click Security.

<P><LI>Make the following changes under "Active Content:"
<P>
   a. Clear the "Allow downloading of active content" check box.
   (This option ensures that no unknown active content will be downloaded
   from a World Wide Web site.)
<P>
   b. Select the "Enable ActiveX controls and plug-ins" check box.
   (This option enables local ActiveX controls, such as those supplied with
   MSDN and InfoViewer, to execute.)
<P>
   c. Select the "Run ActiveX scripts" check box.
   (This option allows local ActiveX scripts to execute.)

<P><LI>Click OK.

<P><LI>Restart Visual Studio.
<P>
</OL>Special Instructions for Visual C++ for Microsoft Windows CE
<P>
Customers of Visual C++ for Windows CE may experience problems with the
Visual Studio family of products. If you want to install any part of the
Visual Studio Service Pack, please uninstall Visual C++ for Windows CE
first. If you encounter any problems using Visual C++ for Windows CE with
Visual Studio, please call Visual C++ for Windows CE product support. If
further information becomes available, it will be posted on the web site
for Visual Studio 97 Service Packs (<B><A HREF="http://www.microsoft.com/vstudio/sp/">http://www.microsoft.com/vstudio/sp/)</A></B>
and in the Knowledge Base (available on the web at
<B><A HREF="http://www.microsoft.com/kb/)">http://www.microsoft.com/kb/).</A></B>
<P>
Updating Visual C++ .map Files
<P>
Visual Studio 97 Service Pack 2 updates the following .map files if you
installed them in your system or system32 directory with Visual C++ 5.0.
If you installed these .map files to a different location, used some
derivative of these files, or used the .map files directly from the Visual
C++ 5.0 compact disc, you will need to update these files manually or
reference them directly from the Service Pack 2 compact disc. You can find
the Service Pack 2 updates to these files in the \all\vc\debug directory on
the Visual Studio Service 97 Pack 2 compact disc:
<P>
<PRE>  Mfc42.map
  Mfc42d.map
  Mfc42u.map
  Mfc42ud.map
  Mfcd42d.map
  Mfcn42d.map
  Mfcn42ud.map
  Mfco42d.map
  Mfco42ud.map

</PRE></OL>Microsoft Transaction Server Updates
<P>
This Service Pack does not include any updates to the Microsoft Transaction
Server. To gain access to the Microsoft Transaction Server service packs
released since it shipped with the Enterprise Editions of Visual Studio 97,
Visual Basic 5.0, and Visual C++ 5.0, go to
<B><A HREF="http://www.microsoft.com/support/transaction/">http://www.microsoft.com/support/transaction/.</A></B>  This site contains pointers
to Microsoft Transaction Server 1.1 for x86, Service Pack 2 for Digital
Alpha, and the Microsoft Transaction Server SDK beta.
<P>
InstallShield Express for Japanese Visual C++ 5.0
<P>
The additional files required for the custom edition of InstallShield
Express that is included with the Japanese release of Visual C++ 5.0 are
now available. Please refer to \jpn\IShield\readme.txt for details.
<P>
<P><h3>Finding More Information on Issues Resolved with This Service Pack</h3>
 
<P>
The Microsoft Knowledge Base contains articles that provide more in-depth
information about the Visual Studio issues that are fixed in this Service
Pack. To locate these articles, go to <B><A HREF="http://www.microsoft.com/kb">http://www.microsoft.com/kb</A></B> and
follow the instructions below to build a query.
<P>
To build a Visual Studio Service Pack query:

<OL><P><LI>Choose a product. (In this case, click "Any Products.")

<P><LI>Specify the type of search. This should be set to "Search the article
   text."

<P><LI>Enter the following as your search phrase:
<P>
<P><PRE>      VS97FixlistSP2
</PRE>
<P><LI>Click "Begin Search."
<P>
</OL>Knowledge Base articles that contain VS97FixlistSP2 but do not contain
VS97FixlistSP1 describe fixes that were added in Service Pack 2. Because
Service Pack 2 includes all of the fixes in Service Pack 1, all of the
articles describing the fixes in Service Pack 1 will contain both keywords
VS97FixlistSP1 and VS97FixlistSP2. To find just those new items that were
fixed in Service Pack 2, search for:
<P>
<PRE>    VS97FixlistSP2 and not VS97FixlistSP1

</PRE></OL>For a file containing all of the text from all of the Knowledge Base
articles, look on the web site for Visual Studio 97 Service Packs:
<B><A HREF="http://www.microsoft.com/vstudio/sp/">http://www.microsoft.com/vstudio/sp/.</A></B>
<P>
InfoViewer KB Articles
<P>
Service Pack 1 fixes some problems with saving samples to directories that
contain high-ASCII characters in the path.
<P>
<PRE><B><A HREF="../VSTUDIO/Q168264.htm">Q168264</A></B>   Copying Samples to a Dir with High ASCII Stops File I/O
<B><A HREF="../VSTUDIO/Q168265.htm">Q168265</A></B>   Error "Microsoft Jscript error" After Copying Sample

</PRE>Service Pack 2 fixes a bug preventing the download of samples with certain
versions of Microsoft Internet Explorer. It also fixes a search results-
related performance problem in which Developer Studio sometimes uses 100
percent of idle time. The Service Pack fixes a bug that causes repeated
"Merging keywords" for anyone who does not have administrator privileges in
Windows NT. It fixes a limitation on the total number of
InfoViewer titles.
<P>
<PRE><B><A HREF="../VSTUDIO/Q171844.htm">Q171844</A></B>   InfoViewer Cannot Download Samples if IE4.0 is Installed
<B><A HREF="../VSTUDIO/Q171845.htm">Q171845</A></B>   Results List Uses 100% of CPU on Idle
<B><A HREF="../VSTUDIO/Q171846.htm">Q171846</A></B>   Limit on the Total Number of InfoViewer Titles
<B><A HREF="../VSTUDIO/Q171847.htm">Q171847</A></B>   Merging Keywords for Search Requires Admin Privileges

</PRE>Visual Basic 5.0 KB Articles
<P>
For a more thorough discussion of Visual Basic 5.0 fixes in Service Pack 2,
go to the end of this file where the Visual Basic 5.0 Service Pack 2 Readme
is appended.
<P>
The Service Packs address problems in dbgrid32.ocx, msrdc20.ocx, and
msrdo20.dll related to data-binding and other issues. Also included are
fixes for the incompatibility problems with comctl32.ocx. There is also an
update to the Visual Basic 5.0 Setup Kit and some of the .cab files for the
ActiveX component download. These .cab files are not installed by the
Visual Studio Service Pack but are included on the Service Pack compact
disc.
<P>
<PRE><B><A HREF="../VBWIN/Q167122.htm">Q167122</A></B>   FindItem Method of ListView Incorrectly Returns an Error
<B><A HREF="../VBWIN/Q167123.htm">Q167123</A></B>   COMCTL32.OCX Is Binary Incompatible with Previous Version
<B><A HREF="../VBWIN/Q167947.htm">Q167947</A></B>   ODBC CAB File Does Not Install 16-bit ODBC Files
<B><A HREF="../VBWIN/Q167948.htm">Q167948</A></B>   Internet Component Download Fails After Using Setup Toolkit
<B><A HREF="../VBWIN/Q167950.htm">Q167950</A></B>   DAO Internet Component Download Fails to Install

<B><A HREF="../VBWIN/Q167951.htm">Q167951</A></B>   AUTMGR32.EXE Fails After Component Download
<B><A HREF="../VBWIN/Q168153.htm">Q168153</A></B>   DBGrid Bound to RDC Displays a Single Row After MoveLast
<B><A HREF="../VBWIN/Q168155.htm">Q168155</A></B>   Crash When Resizing Column of Split DBGrid
<B><A HREF="../VBWIN/Q168156.htm">Q168156</A></B>   DBGrid Bound to RDC Displays Small ResultSets Incorrectly
<B><A HREF="../VBWIN/Q168157.htm">Q168157</A></B>   Problems Binding Multiple Controls to RDC 2.0

<B><A HREF="../VBWIN/Q168158.htm">Q168158</A></B>   Can't Close Resultset if DBGrid Bound to RDC
<B><A HREF="../VBWIN/Q168159.htm">Q168159</A></B>   DBCombo Updates Incorrectly When Using RDC Bound ListSource
<B><A HREF="../VBWIN/Q168160.htm">Q168160</A></B>   Error on Update After AddNew With RDC and Bound Controls
<B><A HREF="../VBWIN/Q168161.htm">Q168161</A></B>   Distributed Transaction Fails On Subsequent Runs
<B><A HREF="../VBWIN/Q168162.htm">Q168162</A></B>   RDO Move 0 Fails to Refresh Record

<B><A HREF="../VBWIN/Q168163.htm">Q168163</A></B>   Memory Leak When Calling UserConnection Query Event
<B><A HREF="../VSTUDIO/Q169302.htm">Q169302</A></B>   Get_Item() Does Not Return Error When Property Not Found
<B><A HREF="../VSTUDIO/Q169303.htm">Q169303</A></B>   Get_Item() Doesn't Find Property Defined on Ancestor Iface
<B><A HREF="../VSTUDIO/Q169304.htm">Q169304</A></B>   Errors Occur When Getting Property of VB Project: Crashes
<B><A HREF="../VSTUDIO/Q169305.htm">Q169305</A></B>   Repository Error after Halting Execution in Break-mode Edit

<B><A HREF="../VSTUDIO/Q169306.htm">Q169306</A></B>   ReComputeRepository GPFs if Passed Non-existent DB Name
<B><A HREF="../VSTUDIO/Q169307.htm">Q169307</A></B>   RepUtil:CompactJetRepository Doesn't Work with DSN Name
<B><A HREF="../VSTUDIO/Q169308.htm">Q169308</A></B>   CompactJetRepository Only Recognizes Lowercase Jet db Names
<B><A HREF="../VSTUDIO/Q169309.htm">Q169309</A></B>   Adding ActiveX Designer/Userconnection Results in Shutdown
<B><A HREF="../VSTUDIO/Q169331.htm">Q169331</A></B>   RecomputeRepos: Won't Work with Database Created by UML.DLL

<B><A HREF="../VSTUDIO/Q169332.htm">Q169332</A></B>   Changing Obj Name Before Saving Results in Repository Error
<B><A HREF="../VSTUDIO/Q169333.htm">Q169333</A></B>   Engine: Collection Not Updated After Removing an Item
<B><A HREF="../VSTUDIO/Q169334.htm">Q169334</A></B>   IRepos::Get_Name() Returns Error if Called on a Property
<B><A HREF="../VSTUDIO/Q169335.htm">Q169335</A></B>   CDatabase::InsRelshipRow Does Not Release Collection Obj
<B><A HREF="../VSTUDIO/Q169336.htm">Q169336</A></B>   Engine Item Method Takes Parameter Type of IntID

<B><A HREF="../VSTUDIO/Q169337.htm">Q169337</A></B>   Unable To Remove a Relationship from Collection with OBJID
<B><A HREF="../VSTUDIO/Q169339.htm">Q169339</A></B>   RepUtil.DLL Doesn't Contain Version or Copyright Information

</PRE>Service Pack 2 fixes:
<P>
<PRE><B><A HREF="../VBWIN/Q166908.htm">Q166908</A></B>   ScaleMode for Printer Object Can't Create Custom Scale
<B><A HREF="../VBWIN/Q167107.htm">Q167107</A></B>   Missing Controls on the SSTAB Control Tabs
<B><A HREF="../VBWIN/Q167165.htm">Q167165</A></B>   Too Many Controls on a Form May Crash Visual Basic IDE
<B><A HREF="../VBWIN/Q167213.htm">Q167213</A></B>   Invalid Page Fault When Shutting Down Visual Basic 5.0
<B><A HREF="../VBWIN/Q167346.htm">Q167346</A></B>   GPF Occurs When Starting Visual Basic 5.0

<B><A HREF="../VBWIN/Q167706.htm">Q167706</A></B>   Internet Transfer Control 5.0 "POST" Request Doesn't Work
<B><A HREF="../VBWIN/Q167735.htm">Q167735</A></B>   Setting Printer to Item in the Printers Collection Fails
<B><A HREF="../VBWIN/Q168290.htm">Q168290</A></B>   GPF When Setting Font of Multi-selected Controls
<B><A HREF="../VBWIN/Q168744.htm">Q168744</A></B>   Printer May Lose Font Attributes
<B><A HREF="../VBWIN/Q168766.htm">Q168766</A></B>   Internet Transfer Control Fails on Case-Sensitive Server

<B><A HREF="../VBWIN/Q168792.htm">Q168792</A></B>   Statusbar Time Panel May Not Update Properly
<B><A HREF="../VBWIN/Q171470.htm">Q171470</A></B>   Resize Event Not Fired When UserControl Copied and Pasted
<B><A HREF="../VBWIN/Q171471.htm">Q171471</A></B>   VB-Created Controls Fail to Print with UserControl_Paint
<B><A HREF="../VBWIN/Q171472.htm">Q171472</A></B>   Toggling PortOpen w/MSCOMM32.OCX Leaks Memory on Win95
<B><A HREF="../VBWIN/Q171473.htm">Q171473</A></B>   MCI32.OCX Does Not Save Recorded .WAV Files

<B><A HREF="../VBWIN/Q171474.htm">Q171474</A></B>   Path Problems Using Project on Network Server
<B><A HREF="../VBWIN/Q171475.htm">Q171475</A></B>   RichTextBox Cleared When BorderStyle Changes at Run-Time
<B><A HREF="../VBWIN/Q171476.htm">Q171476</A></B>   Masked Edit Control Right-Aligned with NT 4.0 SP3
<B><A HREF="../VBWIN/Q171477.htm">Q171477</A></B>   Format Menu Options Can Crash Visual Basic 5.0
<B><A HREF="../VBWIN/Q171478.htm">Q171478</A></B>   Cannot Set Width/Height of UserControl in Resize Event

<B><A HREF="../VBWIN/Q171479.htm">Q171479</A></B>   Mod 0 Causes an IPF or Access Violation
<B><A HREF="../VBWIN/Q171480.htm">Q171480</A></B>   Setting SelAlignment Property Does Not Affect RichTextBox
<B><A HREF="../VBWIN/Q171481.htm">Q171481</A></B>   Cannot Set the Enabled Property of an UpDown Control
<B><A HREF="../VBWIN/Q171482.htm">Q171482</A></B>   Crash When Enum Name Referred to Incorrectly
<B><A HREF="../VBWIN/Q171483.htm">Q171483</A></B>   Crash When Rebuilding EXE Containing UserControl

<B><A HREF="../VBWIN/Q171484.htm">Q171484</A></B>   Code Module Window Displayed Transparently in SDI
<B><A HREF="../VBWIN/Q171485.htm">Q171485</A></B>   Visual Basic 5.0 Title Bar Paints Incorrectly
<B><A HREF="../VBWIN/Q171486.htm">Q171486</A></B>   Crash Sometimes Occurs with Cursor over Toolbox
<B><A HREF="../VBWIN/Q171487.htm">Q171487</A></B>   Crash When Assigning Uninitialized Object to Tag
<B><A HREF="../VBWIN/Q171488.htm">Q171488</A></B>   Val Function Recognizes System Decimal Symbol

<B><A HREF="../VBWIN/Q171489.htm">Q171489</A></B>   Use of Implements and Public Constants Crashes Compiler
<B><A HREF="../VBWIN/Q171490.htm">Q171490</A></B>   Crash After Toggling Folders in ActiveX EXE Project
<B><A HREF="../VBWIN/Q171491.htm">Q171491</A></B>   Mouse Button Value Is Always 4 in MouseUp Event of SSTab
<B><A HREF="../vbapps/Q171492.htm">Q171492</A></B>   ActiveX Control Incorrectly Reports ScaleWidth/ScaleHeight
<B><A HREF="../VBWIN/Q171493.htm">Q171493</A></B>   Viewing Property Pages and Exiting Causes Memory Leak

<B><A HREF="../VBWIN/Q171494.htm">Q171494</A></B>   MouseUp Event Not Triggered in DblClick w/Comctl32
<B><A HREF="../VBWIN/Q171495.htm">Q171495</A></B>   Get Statement Not Working Correctly with Large UDT
<B><A HREF="../VBWIN/Q171496.htm">Q171496</A></B>   Bad Filename or Number with Get of UDT
<B><A HREF="../VBWIN/Q171497.htm">Q171497</A></B>   ListView in PictureBox on Tabbed Dialog Disappears
<B><A HREF="../VBWIN/Q171498.htm">Q171498</A></B>   Screen Turns Black When Compiling

<B><A HREF="../VBWIN/Q171499.htm">Q171499</A></B>   IDE Doesn't Show Topics of OCX Help Files Correctly
<B><A HREF="../VBWIN/Q171500.htm">Q171500</A></B>   ATL Controls Without IPropertyNotifySink Cause IPF in VB5
<B><A HREF="../VBWIN/Q171501.htm">Q171501</A></B>   User Control Moves When Width/Height Is Set in Container
<B><A HREF="../VBWIN/Q171502.htm">Q171502</A></B>   Crash with Watch on UserControl When Stop is Encountered
<B><A HREF="../VBWIN/Q171504.htm">Q171504</A></B>   Problems Setting PropertyPage Caption Property

<B><A HREF="../VBWIN/Q171505.htm">Q171505</A></B>   VB5 IDE Disappears or IPFs When "End" Button Is Pressed
<B><A HREF="../VBWIN/Q171506.htm">Q171506</A></B>   OLE Drag/Drop of ListView Control Fails
<B><A HREF="../VBWIN/Q171507.htm">Q171507</A></B>   VB GPFs When Selecting Align/Lefts from the Format Menu
<B><A HREF="../VBWIN/Q171508.htm">Q171508</A></B>   Add-ins May Cause Menu Corruption When Exiting Visual Basic
<B><A HREF="../VBWIN/Q171509.htm">Q171509</A></B>   Access Violation on NT4.0 on Multi-line Textbox

<B><A HREF="../VBWIN/Q171510.htm">Q171510</A></B>   Setting Font Property Causes Error 438 with RichTextBox
<B><A HREF="../VBWIN/Q171511.htm">Q171511</A></B>   Controls in Frame/PictureBox Do Not Repaint in Design Mode
<B><A HREF="../VBWIN/Q171512.htm">Q171512</A></B>   UserControls on Property Pages Do Not Trigger Focus Events
<B><A HREF="../VBWIN/Q171513.htm">Q171513</A></B>   Cannot Drag a Nested UserControl with Automatic DragMode
<B><A HREF="../VBWIN/Q171514.htm">Q171514</A></B>   Visual Basic 5.0 Crashes When Shutting Down Forms

<B><A HREF="../VBWIN/Q171515.htm">Q171515</A></B>   Crash on Customization of Design Environment Menus
<B><A HREF="../VBWIN/Q171516.htm">Q171516</A></B>   ActiveX Document DLL Causes GPF When Unloading Modal Form
<B><A HREF="../VBWIN/Q171517.htm">Q171517</A></B>   Animation Control Prints Incorrectly at Design-Time
<B><A HREF="../VBWIN/Q171518.htm">Q171518</A></B>   Controls May Not Print When Printing Form at Design Time
<B><A HREF="../VBWIN/Q171519.htm">Q171519</A></B>   Removing Function Causes Binary Compatibility Error

<B><A HREF="../VBWIN/Q171520.htm">Q171520</A></B>   Unable to Set Binary Compatibility with Class Module
<B><A HREF="../VBWIN/Q171521.htm">Q171521</A></B>   Non-Creatable Class Causes Loss of Binary Compatibility
<B><A HREF="../VBWIN/Q171522.htm">Q171522</A></B>   Enums in Public Procedures Cause Binary Compatibility Error
<B><A HREF="../VBWIN/Q171523.htm">Q171523</A></B>   Reference to Missing Member in Enum Definition Causes Crash
<B><A HREF="../VBWIN/Q171524.htm">Q171524</A></B>   Ambiguous Names Generate Incorrect Error Message

<B><A HREF="../VBWIN/Q171525.htm">Q171525</A></B>   ListView Causes IPF When Accessing ColumnHeaders Property
<B><A HREF="../VBWIN/Q171526.htm">Q171526</A></B>   Setting Enabled=False for TreeView Causes Paint Problems
<B><A HREF="../VBWIN/Q171527.htm">Q171527</A></B>   Causing a ListView Control to Paint Causes an IPF
<B><A HREF="../VBWIN/Q171528.htm">Q171528</A></B>   Using "Unload Me" in a Listbox Causes Crash
<B><A HREF="../VBWIN/Q171529.htm">Q171529</A></B>   Can't Open a Project Group from the Root Directory

<B><A HREF="../VBWIN/Q171530.htm">Q171530</A></B>   Crash on Data Tip After Enum Name Changed
<B><A HREF="../VBWIN/Q171531.htm">Q171531</A></B>   IPF When Changing Project Name With Binary Compatibility
<B><A HREF="../VBWIN/Q171532.htm">Q171532</A></B>   Crash Stepping Thru Code After Using Locals/Watch Window
<B><A HREF="../VBWIN/Q171533.htm">Q171533</A></B>   ActiveX EXE Crashes VB5 When Set to Binary Compatibility
<B><A HREF="../VBWIN/Q171575.htm">Q171575</A></B>   RISC: CByte Doesn't Fail on Negative Values on Native Exe

<B><A HREF="../VBWIN/Q171576.htm">Q171576</A></B>   RISC: AddressOf Doesn't Behave Properly in IDE/PCode Exe
<B><A HREF="../VBWIN/Q171577.htm">Q171577</A></B>   Using Set for ListItem's SubItem Results in GPF
<B><A HREF="../VBWIN/Q171795.htm">Q171795</A></B>   RDC Error Calling UpdateRow After Resultset.AddNew
<B><A HREF="../VBWIN/Q171796.htm">Q171796</A></B>   Problems When Running Asynchronous Queries with RDO 2.0
<B><A HREF="../VBWIN/Q171797.htm">Q171797</A></B>   VB5 DBCombo May Display Wrong Column for RDC 1.0

<B><A HREF="../VBWIN/Q171798.htm">Q171798</A></B>   DBCombo Click Event Fires During Form Load
<B><A HREF="../VBWIN/Q171799.htm">Q171799</A></B>   RDO May Incorrectly Handle Locking Conflicts in Transaction
<B><A HREF="../VBWIN/Q171800.htm">Q171800</A></B>   Unexpected Shutdown When Using Bound Controls
<B><A HREF="../VBWIN/Q171801.htm">Q171801</A></B>   Bound Controls Built in VB5 Do Not Work in VB4 IDE
<B><A HREF="../VBWIN/Q171802.htm">Q171802</A></B>   Problems Updating Using DBCombo When ListField = DataField

<B><A HREF="../VBWIN/Q171803.htm">Q171803</A></B>   Problems Retrieving VB 5.0 Projects from Visual SourceSafe
<B><A HREF="../VBWIN/Q171804.htm">Q171804</A></B>   Change Event Not Fired When Selecting an Item in DBCombo
<B><A HREF="../VBWIN/Q171805.htm">Q171805</A></B>   Problems Binding Controls To Nonexistent Data Control
<B><A HREF="../VBWIN/Q171806.htm">Q171806</A></B>   Memory Leak When RDC Bound to OLE Container Control
<B><A HREF="../VBWIN/Q171807.htm">Q171807</A></B>   Selected Tab Changes After Removing Tab in Tabstrip

<B><A HREF="../VBWIN/Q171808.htm">Q171808</A></B>   MDI Child Form Does Not Become Active
<B><A HREF="../VBWIN/Q171809.htm">Q171809</A></B>   Memory Leak When Setting the ForeColor of a VB5 Object
<B><A HREF="../VBWIN/Q171810.htm">Q171810</A></B>   Invoking the Visual Component Manager asserts in Exutil
<B><A HREF="../VBWIN/Q171811.htm">Q171811</A></B>   Cannot see relationship collection on an interface with Tab
<B><A HREF="../VBWIN/Q171812.htm">Q171812</A></B>   Run-Time Error When DataObject Passed As Object

<B><A HREF="../VBWIN/Q171813.htm">Q171813</A></B>   IPF in MSO97RT.DLL When Starting Visual Basic
<B><A HREF="../VBWIN/Q171814.htm">Q171814</A></B>   System Menu Appears When MouseDown Event Invokes a Drag
<B><A HREF="../VBWIN/Q171815.htm">Q171815</A></B>   Printer.TextWidth Returning Inconsistent Results in IDE
<B><A HREF="../VBWIN/Q171816.htm">Q171816</A></B>   IPF Opening or Saving Form with Tab Cont
<B><A HREF="../VBWIN/Q171817.htm">Q171817</A></B>   UserControl Cannot Read ContainedControls in Visual FoxPro

<B><A HREF="../VBWIN/Q171818.htm">Q171818</A></B>   IDE Crashes When Repeatedly Placing a Control on a Form
<B><A HREF="../VBWIN/Q171819.htm">Q171819</A></B>   Invalid Enum Value Causes Incompatible Binary Compatible
<B><A HREF="../VBWIN/Q171820.htm">Q171820</A></B>   ListView ListItems Don't Refresh When ColumnHeaders Cleared
<B><A HREF="../VBWIN/Q171821.htm">Q171821</A></B>   Memory Leak When Repeatedly Changing Toolbar Button Width
<B><A HREF="../VBWIN/Q171822.htm">Q171822</A></B>   Adding a Routine to UserControl in Break Mode Causes Crash

<B><A HREF="../VBWIN/Q171823.htm">Q171823</A></B>   Application Error When Using Implements on Hyperlink Object
<B><A HREF="../VBWIN/Q171824.htm">Q171824</A></B>   Crash in INET Control Downloading Page Multiple Times
<B><A HREF="../VBWIN/Q171825.htm">Q171825</A></B>   Tabbing Problems Using ActiveX Document in a Frame
<B><A HREF="../VBWIN/Q171826.htm">Q171826</A></B>   Tabbing Problems with Controls Contained with Controls
<B><A HREF="../VBWIN/Q171827.htm">Q171827</A></B>   Printing userdrawn usercontrol in IE Doesn't Work

<B><A HREF="../VBWIN/Q171828.htm">Q171828</A></B>   Using OpenURL Doesn't Download Complete Files
<B><A HREF="../VBWIN/Q171829.htm">Q171829</A></B>   GetChunk Freezes Unless Other Events Happening
<B><A HREF="../VBWIN/Q171830.htm">Q171830</A></B>   ActiveX Document Menu Changing Places
<B><A HREF="../VBWIN/Q171831.htm">Q171831</A></B>   IObjectSafety Implemented in Toolbar and CmDialog Controls
<B><A HREF="../VBWIN/Q171832.htm">Q171832</A></B>   Statement Builder Can Cause the Object Browser to Crash

<B><A HREF="../VBWIN/Q171833.htm">Q171833</A></B>   Statement Builder Crashes Referencing GlobalMultiUse Server
<B><A HREF="../VBWIN/Q171834.htm">Q171834</A></B>   Crash When UserControl Accesses Members of ParentControls
<B><A HREF="../VBWIN/Q171835.htm">Q171835</A></B>   Crash When Viewing Data Tips on ParamArray
<B><A HREF="../VBWIN/Q171836.htm">Q171836</A></B>   Crash When Viewing API Properties in Object Browser
<B><A HREF="../VBWIN/Q171837.htm">Q171837</A></B>   Run-time Error 6 "Overflow When Compiled to Native Code"

<B><A HREF="../VBWIN/Q171838.htm">Q171838</A></B>   Crash Compiling Native Code for Assignment of Variant Array
<B><A HREF="../VBWIN/Q171839.htm">Q171839</A></B>   Crash When Compiling a Call to a UserControl Function
<B><A HREF="../VBWIN/Q171840.htm">Q171840</A></B>   Corrupt Project Error Opening One Project After Another
<B><A HREF="../VBWIN/Q171841.htm">Q171841</A></B>   Dragging Multiple Controls on a Form May Cause Crash
<B><A HREF="../VBWIN/Q171842.htm">Q171842</A></B>   GetSetting Function Is Leaking Handles

<B><A HREF="../VBWIN/Q171843.htm">Q171843</A></B>   Winsock Control Leaks Memory When Unloaded

</PRE>Visual C++ KB Articles
<P>
Service Pack 1 addresses the following issues.
<P>
<PRE><B><A HREF="../VISUALC/Q165792.htm">Q165792</A></B>   MSDEV.EXE Application Error When Building an Application
<B><A HREF="../VISUALC/Q166282.htm">Q166282</A></B>   C2440 Caused by Template Function with Const Pointer
<B><A HREF="../VISUALC/Q166285.htm">Q166285</A></B>   MSDEV Crashes When Converting VC++ 4.0 Projects
<B><A HREF="../VISUALC/Q166718.htm">Q166718</A></B>   C1001 from Conditional Operator in Initializer
<B><A HREF="../VISUALC/Q167423.htm">Q167423</A></B>   CRecordset Members Not in "Add Member Variable" Dialog Box

<B><A HREF="../VISUALC/Q167845.htm">Q167845</A></B>   Class Wizard Deletes Source Files
<B><A HREF="../VISUALC/Q167994.htm">Q167994</A></B>   Cvpack INTERNAL ERROR When Linking Large Projects
<B><A HREF="../VISUALC/Q168007.htm">Q168007</A></B>   Remote Debugging Very Slow in Visual C++ Version 5.0

</PRE>The fixes for the Active Template Library (ATL) shown below address the
most commonly reported issues: MBCS compatibility, container compatibility
issues, and internal coding errors in ATL.
<P>
<PRE><B><A HREF="../VISUALC/Q167340.htm">Q167340</A></B>   ATL Control Causes Access Violation in Visual Basic 5.0
<B><A HREF="../VISUALC/Q167526.htm">Q167526</A></B>   ATL Control May Cause An Access Violation
<B><A HREF="../VISUALC/Q167949.htm">Q167949</A></B>   OnWindowMessage Returns BOOL for HRESULT

</PRE>The compiler fixes shown below address the most commonly reported COM
issues.  These issues include: support for VB-created controls, internal
coding issues in the COM headers, and problems related to smart pointers
and reference counting.
<P>
Additionally, there are fixes for templates that contain improper
propagation of the "const" qualifier, and fixes for a problem of forcing
instantiation of all template member functions regardless of whether they
were actually used.
<P>
There were also reported problems with either floating point optimizations,
the global optimizer (/Og) or both.  All these reported issues have been
addressed in this Service Pack.
<P>
<PRE><B><A HREF="../VISUALC/Q151491.htm">Q151491</A></B>   copy() Member of bstrt in COMUTL.H Doesn't Copy
<B><A HREF="../VISUALC/Q151499.htm">Q151499</A></B>   Compiler Performs Illegal Sign Conversion Optimization
<B><A HREF="../VISUALC/Q151500.htm">Q151500</A></B>   /Og Causes vfptr Initialization Problems
<B><A HREF="../VISUALC/Q166721.htm">Q166721</A></B>   C2784 On &lt; Operator When Instantiating an ATL Container
<B><A HREF="../VISUALC/Q167967.htm">Q167967</A></B>   /Og Increments the Index of a Loop Too Soon.

<B><A HREF="../VISUALC/Q167995.htm">Q167995</A></B>   Calling a Function Returning double May Not pop FPU Stack
<B><A HREF="../VISUALC/Q167996.htm">Q167996</A></B>   /Og Causes Invalid Double Result Returned from Function
<B><A HREF="../VISUALC/Q168003.htm">Q168003</A></B>   Function Prototypes in comutil.h Missing Calling Convention
<B><A HREF="../VISUALC/Q168008.htm">Q168008</A></B>   C2166: Incorrect Type Deduction for Template Parameter
<B><A HREF="../VISUALC/Q168009.htm">Q168009</A></B>    Smartptr Property in Interface Causes C2512 Error

<B><A HREF="../VISUALC/Q168010.htm">Q168010</A></B>   /Od May Generate Destructor for Unconstructed Temp Object
<B><A HREF="../VISUALC/Q168011.htm">Q168011</A></B>   C1001, file 'fppeeps.c', line 394, Caused By /Og
<B><A HREF="../VISUALC/Q168012.htm">Q168012</A></B>   Incorrect Code Generated When Using Floating-Point and /Og
<B><A HREF="../VISUALC/Q168028.htm">Q168028</A></B>   C2955: Caused By the "using" Declaration
<B><A HREF="../VISUALC/Q168029.htm">Q168029</A></B>   Global Optimizations (/Og) May Cause the Compiler to Hang

<B><A HREF="../VISUALC/Q168079.htm">Q168079</A></B>   _com_ptr_t::operator=(const _variant_t&amp;) AddRefs Twice
<B><A HREF="../VISUALC/Q168111.htm">Q168111</A></B>   #import Does Not Compensate for Gaps in vtable

</PRE>Listed below is a Linker fix that corrects a reported problem that ICF
(Identical COMDAT Folding) was causing severe build-time losses. The fix
also removes limits being imposed on the size of an executable and raises
the maximum size of the .ilk file used by the linker to 64 MB.
<P>
<PRE><B><A HREF="../UTILITIES/Q151501.htm">Q151501</A></B>   Linking Large Projects Can Be Very Slow

</PRE>The fixes for the Microsoft Foundation Classes (MFC) listed below deal with
the most commonly reported issues that prevent binary compatibility with
MFC 4.2 (shipped with Visual C++ 4.2). These issues include unintended
dependencies on the latest comctl32.dll, the 3.0 version of odbc32.dll,
threading issues, and internal coding errors in MFC.
<P>
<PRE><B><A HREF="../VISUALC/Q164813.htm">Q164813</A></B>   Web Browser Control Hangs in CFormView
<B><A HREF="../VISUALC/Q167423.htm">Q167423</A></B>   CRecordset Members Not in "Add Member Variable" Dialog Box
<B><A HREF="../VISUALC/Q167650.htm">Q167650</A></B>   Problems with ToolTips on Windows 95
<B><A HREF="../VISUALC/Q167692.htm">Q167692</A></B>   Assertion Line 257 in File DlgProp.cpp
<B><A HREF="../VISUALC/Q167693.htm">Q167693</A></B>   MFC Application Hangs on Multiprocessor Machine

<B><A HREF="../VISUALC/Q167731.htm">Q167731</A></B>   Access Violation When Connecting in MFC ODBC Application
<B><A HREF="../VISUALC/Q168004.htm">Q168004</A></B>   "Unable to Initialize DAO/Jet db Engine" Error
<B><A HREF="../VISUALC/Q169484.htm">Q169484</A></B>   CString::MakeUpper and MakeLower Don't Work with Some Char

</PRE>Service Pack 2 fixes some debugger issues. The debugger now evaluates
compiler-generated strings longer than 128 characters (this usually takes
place when you are debugging templates, such as STL) without encountering
an access violation. Also, the debugger now starts smoothly in
configurations that have Visual Test and Visual C++ integrated.
<P>
<PRE><B><A HREF="../VISUALC/Q171848.htm">Q171848</A></B>   Source Control Info Not Preserved During Project Conversion
<B><A HREF="../VISUALC/Q171849.htm">Q171849</A></B>   Debugger Hangs When Very Long STL Symbol in Watch Window

</PRE>Visual Database Tools KB Articles
<P>
<PRE><B><A HREF="../ISTUDIO/Q168295.htm">Q168295</A></B>   Updating Single Row Replaces Data in All Rows of a Cursor

</PRE>Visual FoxPro KB Articles
<P>
Service Pack 2 fixes the access violation error problem when running a form
with a grid repeatedly under Windows NT 4.0. OLE automation with Word 97
issues have been addressed. Some of the report printing and preview
problems under Windows NT also have been fixed.
<P>
<PRE><B><A HREF="../FOXPRO/Q156322.htm">Q156322</A></B>   RETURN TO Procedurename Command Doesn't Work in Forms
<B><A HREF="../FOXPRO/Q156788.htm">Q156788</A></B>   Report Print Preview Illegible Under Windows NT
<B><A HREF="../FOXPRO/Q168277.htm">Q168277</A></B>   Access Violation Running Form With Grid Repeatedly on NT 4
<B><A HREF="../FOXPRO/Q168523.htm">Q168523</A></B>   Report Fails When Printing Under Windows NT 4.0
<B><A HREF="../FOXPRO/Q169565.htm">Q169565</A></B>   Type Mismatch Using OLE Automation to Word 97

</PRE>Service Pack 2 fixes the Anomaly Tracking System (ATS) so that it does not
display the 'Option under construction'  message when action items are
selected.
<P>
<PRE><B><A HREF="../FOXPRO/Q168193.htm">Q168193</A></B>   'Option under construction' Message Appears in ATS

</PRE>Visual InterDev KB Articles
<P>
Service Pack 1 fixes various wizard problems. The Service Pack also fixes a
bug that destroys data in situations when FrontPage editor, which comes
with Visual InterDev, is used.
<P>
<PRE><B><A HREF="../ISTUDIO/Q165834.htm">Q165834</A></B>   Can't Set Permissions Back to Root Web Permissions
<B><A HREF="../ISTUDIO/Q167267.htm">Q167267</A></B>   New Devisws.pkg for 0-Byte File Save Problem
<B><A HREF="../ISTUDIO/Q167836.htm">Q167836</A></B>   DataForm Wizard Not Sizing Column Width Properly For DBCS
<B><A HREF="../ISTUDIO/Q167846.htm">Q167846</A></B>   Reserved Error When Running DataForm Wizard Against Access
<B><A HREF="../ISTUDIO/Q168269.htm">Q168269</A></B>   MSWC BrowserType Control Does Not Recognize IE 3.02

<B><A HREF="../ISTUDIO/Q168270.htm">Q168270</A></B>   Update Error When Updating Sybase Table From ASP
<B><A HREF="../ISTUDIO/Q168271.htm">Q168271</A></B>   Sybase Cursor Can't Scroll Back in DF Wizard Created Form
<B><A HREF="../ISTUDIO/Q168272.htm">Q168272</A></B>   GPF When Refreshing a Project Containing Sybase Connection
<B><A HREF="../ISTUDIO/Q168273.htm">Q168273</A></B>   Invalid Operation When Deleting the End Sybase Record
<B><A HREF="../ISTUDIO/Q168274.htm">Q168274</A></B>   GPF When Selecting .ALX Files in Template Wizard

<B><A HREF="../ISTUDIO/Q168275.htm">Q168275</A></B>   Corrupted Dialog Titles in Japanese Version
<B><A HREF="../ISTUDIO/Q168296.htm">Q168296</A></B>   GPF When Expanding Links in Japanese Version of VI
<B><A HREF="../ISTUDIO/Q168297.htm">Q168297</A></B>   Data Connection Icons Not Displayed for global.asa

</PRE>Visual J++ KB Articles
<P>
Service Pack 1 contains fixes that will enable customers to debug Java
applets running on Microsoft Internet Explorer 4.0 (but not on Microsoft
Internet Explorer 4.0 Preview Release 1). If you are running Microsoft
Internet Explorer 4.0 Preview Release 1, you should upgrade to Microsoft
Internet Explorer 4.0 Preview Release 2, which is available now on the web
site <B><A HREF="http://www.microsoft.com/ie/ie40">http://www.microsoft.com/ie/ie40.</A></B>  For multi-processor machines,
Service Pack 1 fixes a scenario that resulted in a fault. It also fixes an
isolated case in which ClassView did not display any information.
<P>
<PRE><B><A HREF="../java/Q167719.htm">Q167719</A></B>   JavaTLB gives an Internal Compiler Error With VBCCE Control
<B><A HREF="../java/Q167720.htm">Q167720</A></B>   Saving Java File on Multi-Processor Machine Crashes MSDEV
<B><A HREF="../java/Q167828.htm">Q167828</A></B>   Cannot Access the ClassView Information File Error
<B><A HREF="../java/Q167998.htm">Q167998</A></B>   Cannot Debug Visual J++ Programs on IE 4.0 Pre-Release

</PRE>See Visual C++ KB Articles for Service Pack 2 fixes that may affect Visual
J++ users.
<P>
Visual SourceSafe KB Articles
<P>
Service Pack 1 contains five fixes for Visual SourceSafe: the deployment of
files placed in the parent directory to a UNIX Server; movement of random
characters to the end of the file after SourceSafe editor is used;
incomplete check in of files in Visual Basic or Visual C++ when keyword
expansion is enabled; corruption of Rights.dat after adding rights by
project; and slowdown of analyze and appearance of hanging on large
databases.
<P>
<PRE><B><A HREF="../SSAFE/Q165776.htm">Q165776</A></B>   Admin Cannot See Files With Project Security Enabled
<B><A HREF="../SSAFE/Q166469.htm">Q166469</A></B>   Multiple Check In Fails with Keyword Expansion
<B><A HREF="../SSAFE/Q167273.htm">Q167273</A></B>   VSS Editor/Viewer Removing or Replacing Characters
<B><A HREF="../SSAFE/Q167274.htm">Q167274</A></B>   Analyze May Hang or Crash When Running on Large Databases
<B><A HREF="../SSAFE/Q167737.htm">Q167737</A></B>   Deploy to a Unix Server Via FTP Fails

</PRE>Service Pack 2 contains Visual SourceSafe fixes for a memory leak in the
Visual Studio integration, and an access violation in Analyze, a developer
tools integration issue where files like Status.dat are needlessly kept
open.
<P>
<PRE><B><A HREF="../SSAFE/Q171534.htm">Q171534</A></B>   Source Code Control Integration Holds .dat Files Open
<B><A HREF="../SSAFE/Q171535.htm">Q171535</A></B>   ANALYZE Crashes When No Log Entries Found in Log File

</PRE>NOTE: the original and incorrect title to <B><A HREF="../SSAFE/Q171535.htm">Q171535</A></B> was: "ANALYZE Application
Error When Directory Not Found".
<P>
<P><h3>Welcome to Visual Basic 5.0 Service Pack 2</h3>
 
<P>
Visual Basic 5.0 Service Pack 2 is an update to Visual Basic Version 5.0
Professional and Enterprise editions. It enables apartment-model threading
for Visual Basic projects that contain user interface elements, such as
forms and controls.
<P>
Documentation
<P>
The apartment-model threading enhancement in Visual Basic 5.0 Service Pack
2 is explained in vb5sp2.htm (vb5sp2.wri on some systems). This file
contains information supplementing the Books Online documentation you
received as part of your licensed copy of Visual Basic.
<P>
Bug Fixes
<P>
The Microsoft Visual Basic team closely monitored feedback from programmers
after Visual Basic 5.0 shipped. Every effort was made to reproduce and fix
the most serious and commonly reported problems. Visual Basic 5.0 Service
Pack 2 fixes problems with the development environment, the Printer object,
the Internet Transfer control, and many of the other controls and libraries
that ship with Visual Basic 5.0. The Visual Basic team made every effort to
ensure backward compatibility with shared components.
<P>
Development environment: Visual Basic 5.0 Service Pack 2 resolves several
stability problems in the development environment, including crashes that
sometimes occurred when moving the mouse cursor over the toolbox, when
setting the Font properties of multiple controls, and when using the Format
menu options to align controls.
<P>
Printer object: Setting the Printer object to an item in the Printers
collection will now switch the default printer. You can now set a user-
defined scale mode for the Printer object by changing the ScaleWidth and
ScaleHeight properties. Font attributes are no longer lost when calling the
NewPage method.
<P>
Internet Transfer control: POST now works. Problems with missing or garbled
data have been fixed. The control no longer converts file names to upper
case when sending out a request, thus eliminating reported problems
accessing case-sensitive servers.
<P>
For a complete list of bug fixes included in Visual Basic 5.0 Service Pack
2, search the Microsoft Knowledge Base at <B><A HREF="http://www.microsoft.com/kb">http://www.microsoft.com/kb</A></B> for
articles containing the keyword VB5FixlistSP2.
<P>
Dependency List
<P>
Visual Basic 5.0 Service Pack 2 includes a new master dependency file
(vb5dep.ini), which is installed in the Setupkit directory. The existing
dependency file is renamed ~vb5dep.sp2.
<P>
Removing Visual Basic 5.0 Service Pack 2 and Restoring Visual Basic 5.0
<P>
Visual Basic 5.0 Service Pack 2 modifies Visual Basic 5.0 by replacing some
files and updating system information. To remove SP2, you must open the
Control Panel and use the Add/Remove Software tool to remove Visual Basic
5.0 from your system. Manually delete any remaining SP2 files before
reinstalling Visual Basic 5.0. (For a complete list of files included with
SP2, see the SP2 documentation file - vb5sp2.htm or vb5sp2.wri.)
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VSTUDIO/Q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

   ARTICLE-ID: <B><A HREF="../VSTUDIO/Q170367.htm">Q170367</A></B>
   TITLE     : HOWTO: Determine VS97 Service Pack Updates in a Product

   ARTICLE-ID: <B><A HREF="../VBWIN/Q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

   ARTICLE-ID: <B><A HREF="../VSTUDIO/Q175869.htm">Q175869</A></B>
   TITLE     : INFO: Troubleshooting the Visual Studio Service Pack 2
               Download

</PRE>The equivalent of this article for the Visual Studio 97 Service Pack 1 is:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VSTUDIO/Q170366.htm">Q170366</A></B>
   TITLE     : INFO: Visual Studio 97 Service Pack 1 Readme
</PRE> 
<PRE>Keywords          : kbreadme VS97FixlistSP2 VS97FixlistSP1 VS97FixlistSP3 kbreadme
Version           : WINDOWS:1.0,1.1,5.0,5.0a; WINDOWS NT:5.0,97sp2
Platform          : WINDOWS
Issue type        : kbinfo
Solution Type     : kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
