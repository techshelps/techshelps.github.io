

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Field Mapping Lost When Project Moved to Different Drive </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173878">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1997/09/15">
<META NAME="Keywords" CONTENT="vfoxwin">
<META NAME="KBArea" CONTENT="Support; KB; vstudio">
<META NAME="Description" CONTENT="  Moving a project, and all it's components, to a different drive clears the  Map field type to classes  information for all the tables in it.  STATUS ======  Microsoft is researching this problem and will post new information here in the Microsoft K...">
<META NAME="Product" CONTENT="vstudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QABO,QBFY,QAJN,QAEF,QBIC,QBHQ,QAZV,QAJQ,QAB4,QAJX,QADR,QBXR,QARR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Field Mapping Lost When Project Moved to Different Drive</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173878</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Studio versions 97
<LI>Microsoft Visual FoxPro for Windows, version 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moving a project, and all it's components, to a different drive clears the
"Map field type to classes" information for all the tables in it.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If a table is part of a database, then you can map a class library and a
class to each of the fields in the table using the "Map field type to
Classes" option in the Table Designer. This way you specify the class you
want to create when you drag the field onto a form. If all these files
(database, table, class library) are a part of a project and the project is
moved to a different drive (for example, from drive "C:" to drive "D:"),
then modifying a table within the project that had a field mapped to a
class will produce "The Class.... Associated with this field cannot be
found - class association is cleared" error message, and the Field Mapping
information is cleared.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Using the Windows Explorer to create a directory "c:\vfp5app", or from
   Visual FoxPro type the following command:
<P>
<P><PRE>      MD c:\vfp5app
</PRE>
<P><LI>In the directory you created in the previous step, create a class
   library and class by issuing the following commands from the Visual
   FoxPro Command window:
<P>
<P><PRE>      CREATE CLASSLIB C:\vfp5app\ccontrols.vcx
      CREATE CLASS ctextbox OF ccontrols AS TextBox
</PRE>
<P><LI>Save the class and close the Class Designer.

<P><LI>Create a project, database, and table in the "c:\vfp5app\" directory
   and name all three of them "QA" with the following commands:
<P>
<P><PRE>      CREATE PROJECT c:\vfp5app\qa
      CREATE DATABASE c:\vfp5app\qa
      CREATE TABLE qa ( iID i, cText c(10) )
</PRE><P>
   Make sure that the database is open and active when you create the table
   so that the table is added to it.

<P><LI>Add the "QA" database and the class library, created in the previous
   step, to the "QA" project.

<P><LI>Open the "QA" project. From the Project Manager, modify table "QA".
   When the table designer appears, click the Fields tab.

<P><LI>Select "iID" field, and then under the "Map Field type to Classes"
   section set "Display Library" to "C:\vfp5app\ccontrols.vcx" and
   "Display Class" to "cTextBox". Do the same for the "cText" field.

<P><LI>Close the Table Designer and the project.

<P><LI>Using the Windows Explorer, MOVE the whole project, including all the
   files, to another drive, for example "D:" or "E:", with the same
   directory structure (D:\vfp5app\ or E:\vfp5app).

<P><LI>Open the project.

<P><LI>Modify table "QA".

<P><LI>When the "The Class.... Associated with this field cannot be found -
<P><PRE>    class association is cleared" error message is displayed, click OK.
</PRE>
<P><LI>When the Table designer appears, click the Fields Tab and look at the
<P><PRE>    "Map Field type to Classes" section for each of the fields. Note that
    both the "Display Library" and "Display Class" properties are blank.
</PRE><P>
</OL>NOTE: Rebuilding the project does not resolve this problem.
 
<PRE>Keywords          : vfoxwin
Version           : WINDOWS:5.0a; WINNT:97
Platform          : NT WINDOWS winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
