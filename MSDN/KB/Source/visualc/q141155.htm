

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: 16-bit AppWizard Doesn't Create .ODL Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141155">
<META NAME="KBModify" CONTENT="1997/08/08">
<META NAME="KBCreate" CONTENT="1995/12/12">
<META NAME="Keywords" CONTENT="CDKIss kb16bitonly kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Build an application using AppWizard and specify that it is an OLE server (full or mini) with OLE Automation support included. Notice that no Object Description Language (ODL) source file is generated.  AppWizard will not create an ODL file when ge...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBLX,QA9Q,QBE7,QBE6,QBFY,QA55,QA56,QAPF,QAUJ,QAPN,QAJN,QA2K,QAH6,QDNQ,QABO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 16-bit AppWizard Doesn't Create .ODL Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141155</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The AppWizard that comes with:
   - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52, 1.52b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Build an application using AppWizard and specify that it is an OLE server
(full or mini) with OLE Automation support included. Notice that no Object
Description Language (ODL) source file is generated.
<P>
AppWizard will not create an ODL file when generating a new application
that supports OLE Automation. ClassWizard also won't create ODL files for
new automation-enabled classes. This only applies to the 16-bit Visual C++
(1.x) products. AppWizard shipped with 32-bit versions of Visual C++ (2.x
and 4.x) will create .odl files.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Following are two methods you can use to create an appropriate .odl file
for a project that supports automation.
<P>
Using the first method, you will write the file from scratch using the
information provided in the OLE Programmer's Reference Volume 2. The OLE
SDK samples provided with Visual C++ contain two examples of .odl files:

<UL><LI>Calctype.odl provided with DSPCALC2
<LI>Hello.odl, provided with HELLO.
<P>
</UL>Visual C++ 1.x does not provide any Object Description Language (ODL)
scripts or type libraries for the MFC AUTOCLIK sample. However, the
following Knowledge Base article does contain a sample ODL file for the MFC
AUTOCLIK sample:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q132959.htm">Q132959</A></B>
   TITLE     : SAMPLE: An ODL File for 16-bit AUTOCLIK

</PRE>The second method requires less manual work. If you have Visual C++ 2.x or
4.x installed, you can generate an AppWizard OLE Automation server and use
the resulting .odl source script as a starting point for your 16-bit
project. Following are the basic steps for doing this:

<OL><P><LI>Generate an AppWizard project in Visual C++ 2.x or 4.x, selecting OLE
   Automation support.

<P><LI>Copy the resulting .odl file from the new project to your 16-bit project
   directory, changing the name of the file to the 16-bit project name.

<P><LI>Edit the .odl file in the 16-bit project.

<P><LI>Correct the document class name wherever it appears. This means the
   "//{{AFX_ODL_..." type comments as well.

<P><LI>Look for an "Ixxxxx" name where xxxxx is a document name; change it to
   reflect the document class name.

<P><LI>Generate two new GUIDs. GUIDs can be generated by using the Guidgen.exe
   tool located in your Msvc\Bin directory. The first GUID should be used
   to replace the GUID already occupying the "uuid" attribute in front of
   the "library" section in the .odl file. The second GUID should be used
   to replace the GUID in the "uuid" attribute in front of the
   "dispinterface" section.

<P><LI>Copy the CLSID for the existing 16-bit document class into the "uuid"
   attribute of the "coclass" section, replacing the GUID that was there.
   The CLSID for your project's document class can be found in the .reg
   file that AppWizard generated for your project.

<P><LI>Add new Automation-enabled classes. The ClassWizard will automatically
   update the .odl file with appropriate "coclass" and "dispinterface"
   sections.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
OLE 2 Programmer's Reference, volume 2, Chapter 7, "Object Description
Language"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: object description classwizard type library<BR>
libraries<BR>
Keywords          : CDKIss kb16bitonly kbtshoot<BR>
Technology        : kbole<BR>
Version           : 1.0 1.5 1.51 1.52 1.52b<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
