

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Visual C++ Setup Messages for File Copying Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113063">
<META NAME="KBModify" CONTENT="1997/10/21">
<META NAME="KBCreate" CONTENT="1994/03/24">
<META NAME="Keywords" CONTENT="vc10setup vc15setup vc20setup kbbuglist kbfixlist kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Installing Visual C++ may cause the Setup program to display the following in a message box:     Internal Error  This happens when the Setup program tries to copy files from the Visual C++ CD-ROM to a hard drive, and those files are hidden or read-...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QBFY,QA56,QA55,QAH4,QA9Q,QDL9,QBWQ,QBWO,QBWN,QBXB,QATJ,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Visual C++ Setup Messages for File Copying Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113063</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 | 1.00
<PRE>WINDOWS   | WINDOWS NT
</PRE>kbsetup kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, versions 1.0, 1.5
<LI>Microsoft Visual C++ 32-bit Edition, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Installing Visual C++ may cause the Setup program to display the following
in a message box:
<P>
<PRE>   Internal Error

</PRE>This happens when the Setup program tries to copy files from the Visual C++
CD-ROM to a hard drive, and those files are hidden or read-only.
<P>
In later versions of Visual C++ you are more likely to receive a dialog
box containing one of the messages below. You should only encounter the
<PRE>'Internal Error' message if the destination file is corrupted.

</PRE>For the 32-bit edition of Visual C++ version 2.0 and later:
<P>
<PRE>   Setup cannot open the file C:\msvc20\somefile.exe. The file may be in
   use by another application, or marked read-only. Close the application
   or change the file's read-only attribute and try again.

</PRE>For the 16-bit version of Visual C++ for Windows, version 1.51 or later:
<P>
<PRE>  Setup cannot open the destination file C:\msvc\somefile.exe.

</PRE>The dialog boxes have three options, Abort, Retry and Ignore.
<PRE>  Abort will terminate the setup program.
  Retry will try to copy the file again.
  Ignore will cause the setup program to move on and try to copy the next
   file to the hard disk.

</PRE><h2>CAUSE</h2>
 
<P>
The Visual C++ Setup program copies the majority of files to its own
directory (by default, C:\MSVC). It also copies some of the files to the
Windows directory and its subdirectories. Any hidden, read-only, or
corrupted files with the same names in these directories may cause the
Setup program to fail. These files have been installed by the previous
installations of the Visual C++ or by other software packages. The Visual
C++ Setup program can return the "Internal Error" message when its
attempt to overwrite a corrupted, hidden, read-only or share-locked file
fails.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When the "Internal Error" message occurs, the VC++ Setup program displays a
filename associated with its source directory and target directory in the
VC++ Setup dialog box. In the case of a hidden or read-only file in the
target directory, the Setup program displays the name of the file that
causes the problem. To resolve the problem of a hidden or read-only file,
follow the procedure below:

<OL><P><LI>Terminate the Setup program.

<P><LI>Open an MS-DOS prompt under Windows.

<P><LI>Change to the directory that was displayed on the target line in the
   VC++ Setup dialog box.

<P><LI>Examine the attributes of the file that the Visual C++ Setup program
   failed to install using the ATTRIB command in MS-DOS. For example, to
   examine the attributes of TEST.DLL, type the following:
<P>
<P><PRE>      ATTRIB TEST.DLL
</PRE><P>
   Typing ATTRIB without any arguments will give attribute information on
   all the files in the directory. The output from ATTRIB will resemble the
   following
<P>
<PRE>      ARH    C:\TEST.DLL

   where A stands for "archive", R stands for "read-only", and H represents
   "hidden". Not all attributes will be shown for a given file. Consult
   your MS-DOS documentation for more information on ATTRIB.

</PRE><P><LI>If it is a hidden file, for example, change the hidden attribute on the
   file, using the ATTRIB command:
<P>
<P><PRE>      ATTRIB -H TEST.DLL
</PRE><P>
   You may also use File Manager in Windows to change the file attributes
   by selecting Properties from the File menu after selecting the file in
   question.

<P><LI>Reinstall Visual C++.
<P>
</OL>If the file is not a hidden or read-only file, the file may be corrupted.
To resolve the problem in this case is more complicated because the Setup
program does not display the name of the corrupted file, but the last file
the Setup program installed successfully. A possible solution to the
problem is discussed in the "MORE INFORMATION" section below.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the products listed at the
beginning of this article. The problem was fixed in Visual C++ for Windows
1.51 and Visual C++ 2.0 32-bit edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Some of the files copied to the Windows subdirectory by the VC++ Setup
program are related to OLE (Object Linking and Embedding) 2.0 retail
dynamic-link libraries (DLLs) and symbol files. Any system with OLE 2.0
applications installed may already have some of these DLLs installed by the
applications. For some reason, one or more of these DLLs may have hidden or
read-only attributes, or have been corrupted. The OLE 2.0 files typically
cause an "Internal Error" during the installation of Visual C++.
<P>
OLE 2.0 retail DLL and symbol files copied by the VC++ Setup program are:
<P>
<PRE>   COMPOBJ.DLL     COMPOBJ.SYM     OLE2DISP.DLL    OLE2NLS.DLL
   OLE2NLS.SYM     OLE2.DLL        OLE2.SYM        OLE2PROX.SYM
   OLE2CONV.DLL    OLE2CONV.SYM    OLE2PROX.DLL
   CTL3DV2.DLL     TYPELIB.DLL     TYPELIB.SYM
   CTL3D.DLL       STORAGE.DLL     OLE2DISP.SYM

</PRE></OL>These files are copied from \MSVC\NODEBUG on the Visual C++ CD-ROM into the
\WINDOWS\SYSTEM directory if the option of installing OLE 2.0 retail DLLs
is selected. The option of installing OLE 2.0 retail DLLs is automatically
selected if a user selects the "Typical Installation" option during setup.
This option can also be enabled by selecting the "Custom Installation" and
having the "MFC OLE" check box selected. Notice that selecting the "MFC
OLE" check box in the "Custom Installation" dialog box will not stop the
Setup program from installing OLE 2.0 retail DLLs. The "OLE SDK" button,
located next to the "MFC OLE" check box, needs to be chosen to enable or
disable this option.
<P>
In the case of a corrupted file in the \WINDOWS\SYSTEM directory, deleting
all the files listed above and then reinstalling Visual C++ should resolve
the problem in most cases. If not, please contact Microsoft Product Support
Services at (425) 635-7007.
<P>
It is also possible that some of the files from the previous installation
of the VC++ may be corrupted for some reason. The following files are
copied to the Windows directory by the VC++ Setup program. Delete them to
reinstall Visual C++ if necessary.
<P>
<P><h3>\WINDOWS\SYSTEM Directory</h3>
 
<P>
<PRE>   FTENGINE.DLL     FTUI.DLL           MVAPI.DLL
   CIRC2.VBX        GRID.VBX           VC.LIC
   CCAPI100.DLL     CUECARD2.DLL       QRYINTL.DLL
   WINRFS.DLL       TECHNOTE.DLL       STDOLE.TLB
   MFC250.DLL       MFC250D.DLL        MFCD250.DLL
   MFCD250D.DLL     MFCO250.DLL        MFCO250D.DLL
   MFCOLEUI.DLL

</PRE><h3>\WINDOWS Directory</h3>
 
<P>
<PRE>   CCARD100.EXE

</PRE><h3>\WINDOWS\MSAPPS\MSQUERY Directory</h3>
 
<P>
<PRE>   MSQUERY.CUE       MSQUERY.EXE       MSQUERY.HLP
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50<BR>
KBCategory: kbsetup kbbuglist kbfixlist<BR>
KBSubcategory: vc10setup vc15setup vc20setup<BR>
Keywords          : vc10setup vc15setup vc20setup kbbuglist kbfixlist kbsetup<BR>
Version           : 1.00 1.50 | 1.00<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
