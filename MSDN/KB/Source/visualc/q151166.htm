

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Fixes in VC++ 4.1 to Bugs in VC++ 4.0 32-Bit Edition </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151166">
<META NAME="KBModify" CONTENT="1997/09/19">
<META NAME="KBCreate" CONTENT="1996/05/20">
<META NAME="Keywords" CONTENT="kbbuglist kbfixlist kbprg kbref kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article lists fixes in Visual C++ version 4.1 to bugs that appeared in the Microsoft 32-bit edition of Visual C++ version 4.0.  MORE INFORMATION  Visual C++ version 4.1 fixes several Visual C++ version 4.0 bugs. These bugs include Developer St...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAMB,QAM1,QAX6,QA6A,QAB4,QBVV,QAUD,QDIX,QDJO,QBFY,QA56,QA55,QAJ6,QAJG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Fixes in VC++ 4.1 to Bugs in VC++ 4.0 32-Bit Edition</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151166</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.10
WINDOWS NT
kbprg kbref kbtool kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article lists fixes in Visual C++ version 4.1 to bugs that
appeared in the Microsoft 32-bit edition of Visual C++ version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual C++ version 4.1 fixes several Visual C++ version 4.0 bugs. These
bugs include Developer Studio crashing issues and debugger crashing issues.
Many developers will find the bug fixes listed in this article to be of
particular interest.
<P>
<P><h3>Fixed Wizards Bugs</h3>
 

<UL><LI>Typelibs with long member names crashed ClassWizard. ClassWizard had a
   limit of 1024 characters on typelib member names. This limit has been
   increased to about 3000 characters.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q148230.htm">Q148230</A></B>
<PRE>   TITLE     : TypeLibs with Large Argument Lists May Crash ClassWizard

</PRE><LI>You cannot select the alphabetically first table in your .mdb file when
   setting up a DAO table type recordset via AppWizard. This would result
   in an error message saying: "You must select on table for this
   table-type recordset."
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q139490.htm">Q139490</A></B>
<PRE>   TITLE     : Can't Select First Table When Creating DAO Table Recordset

</PRE><LI>AppWizard generated the wrong coclass statement in the ODL file when
   creating an OLE Automation server. The most important effect of this
   was that Visual Basic would not recognize a declaration of a type using
   the automation server. Visual Basic would give an error message: "User-
   defined type not defined."

<LI>ClassWizard did not update the ODL file when you marked an ODL file as
   read-only and then removed the attribute. After the read-only attribute
   was removed, ClassWizard would let you do an Add Class, but it would
   not update the ODL file.

<LI>When adding a component to the Component Gallery from the ClassView
   using a project under source code control, Component Gallery would
   prompt you to check out more files than necessary. In addition, if you
   got an error message: "cannot add to Component Gallery",  the Component
   Gallery would not tell the IDE to repaint itself. (IDE repaint is turned
   off during Component Gallery execution to avoid flicker.) This led to
   the impression that the IDE was hung.

<LI>When creating a custom AppWizard from an existing project that used a
   component from Component Gallery, AppWizard created incorrect code in
   the resulting AppWizard template. As a result, projects created with
   the custom AppWizard could not be built. This problem was caused by
   Component Gallery inserting "\n" instead of "\r\n" (appropriate for
   text files) at the end of lines. As a result, custom AppWizard treated
   the file(s) touched by Component Gallery as binary. The fix in Visual
   C++ version 4.1 does not apply to applications that were modified by
   applying a component using Visual C++ version 4.0's Component Gallery.
   However, the fix does affect any project where the component is applied
   using Visual C++ version 4.1. To fix projects that had components
   applied to them using the Visual C++ version 4.0 Component Gallery, add
   a carriage return to the end of the file using the text editor.
<P>
</UL><h3>Fixed Resource Editor Bugs</h3>
 

<UL><LI>When using a display driver with large fonts, you were unable to see the
   text you were editing in the Version Info editor.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q142764.htm">Q142764</A></B>
<PRE>   TITLE     : Edit Fields Blank When Large Fonts Selected

</PRE><LI>When running a display in hicolor mode (64K colors), you could not
   reopen a 256-color bitmap after you had opened it.

<LI>If you used the Find command to search backward for a string that did
   not exist in the String Editor, the String Editor would give a GPF.

<LI>If you tried to add five or more Anibutton OLE controls with 256-color
   bitmaps to a dialog, you would get an Access Violation.

<LI>If you set the Number property (ES_NUMBER) on a dialog, the dialog
   editor did not remember that the property was set when the dialog was
   reopened.

<LI>If you tried to add a new resource symbol using View Resource Symbols,
   New Button when there was no current active window, MSVCSHL.DLL would
   crash.

<LI>If you tried to save the XLINTL32.DLL file installed with Excel in the
   \msdev folder as a *.res file, Developer Studio caused an invalid page
   fault in kernel32.dll.
<P>
</UL><h3>Fixed Debugger Bugs</h3>
 

<UL><LI>When you started a second debug session on large applications, the
   Developer Studio used to crash.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q140041.htm">Q140041</A></B>
<PRE>   TITLE     : PATCH: Visual C++ 4.0 Crash Fixes

</PRE><LI>When starting to debug huge applications with lots of DLLs, the debugger
   would hang.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q149616.htm">Q149616</A></B>
<PRE>   TITLE     : Developer Studio May Hang When Debug Session Starts/Ends

</PRE><LI>Sometimes when starting to debug huge applications with embedded
   symbols, such as the no .pdb file, the debugger would hang.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q147836.htm">Q147836</A></B>
<PRE>   TITLE     : Debugger Hangs with Huge Executable with Embedded Symbols

</PRE><LI>The debugger used to crash or hang when expanding objects with very
   large type/field names.

<LI>When editing expressions in the Watch or Variables windows on Windows NT
   version 3.51 using large fonts in 1024x768 mode, the text being edited
   could not be seen.

<LI>The debugger could not attach to processes on Windows 95 using the hex
   pid reported by PView.
<P>
</UL><h3>Fixed MFC Bugs</h3>
 

<UL><LI>CSingleLock::CSingleLock() has an assert that indicates it cannot be
   used with CCriticalSection object. This assert is not necessary.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q140669.htm">Q140669</A></B>
<PRE>   TITLE     : CSingleLock: Bogus Assert in CSingleLock::CSingleLock

</PRE><LI>The CSyncObject::Lock function always returns TRUE for finite values of
   timeout intervals. This happens even if the synchronization object is
   in a non-signaled state.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q141533.htm">Q141533</A></B>
<PRE>   TITLE     : CSyncObject::Lock Always returns TRUE for Finite Waits

</PRE><LI>Additional resources specified in a dialog template of a dialog
   implemented in a DLL file will be displayed incorrectly or not
   displayed at all. This can affect icons, bitmaps, and menus that are
   specified in a dialog template.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q147384.htm">Q147384</A></B>
<PRE>   TITLE     : Icons, Bitmaps, &amp; Menus Not Displayed in an AFXDLL Dialog

</PRE><LI>If you call CFile::GetFileName(), it will return a CString with the
   correct file name. However, if you call GetLength() on the CString, it
   will return zero.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q143086.htm">Q143086</A></B>
<PRE>   TITLE     : CFile::GetFileName() Always Returns CString w/Zero Length

</PRE><LI>The CDaoDatabase::CreateRelation() method may fail if an application is
   built as a non-UNICODE application. It is possible that a messagebox
   will appear that states: "Invalid field name '&lt;some text&gt;' in definition
   of index or relationship."
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q138767.htm">Q138767</A></B>
<PRE>   TITLE     : CreateRelation Method Fails with Non-UNICODE Build

</PRE><LI>Trying to run a program that contains a call to CDatabase::ExecuteSQL()
   that has been built for UNICODE results in a CDBException being thrown
   with an error message from the ODBC driver.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q139759.htm">Q139759</A></B>
<PRE>   TITLE     : CDatabase::ExecuteSQL() Fails with UNICODE Build

</PRE><LI>In an MFC application, AfxThrowOleDispatchException is used to throw an
   exception from within an OLE Automation function. When Microsoft Visual
   Basic is used as the automation client application, it will not be able
   to correctly interpret the error code passed to
   AfxThrowOleDispatchException.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q140590.htm">Q140590</A></B>
<PRE>   TITLE     : Error in COleDispatchException Constructor

</PRE><LI>An access violation may result after using CString::operator+= where the
   string on the right-hand side of the operator is an empty string. If
   the debug CRT libraries are installed, an Assertion Failure in
   Dbgheap.c line 1017 will occur.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q142385.htm">Q142385</A></B>
<PRE>   TITLE     : Using CString::operator+= May Cause an Access Violation

</PRE><LI>When you map a control to a recordset variable by using
   DDX_FieldCBString or DDX_FieldLBString, the following message may
   appear in a messagebox when UpdateData() is called: "Please enter no
   more than 0 characters."
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q143330.htm">Q143330</A></B>
<PRE>   TITLE     : Messagebox Shows in DDX_FieldCBString &amp; DDX_FieldLBString

</PRE></UL><h3>Fixed Developer Studio Bugs</h3>
 

<UL><LI>When the current project has sub-projects and the create browser file
   option is turned on, the Developer Studio may randomly generate an
   access violation.

<LI>When deleting sub-projects from a main project, the Developer Studio may
   sometimes crash with an access violation.

<LI>If the /Tp or /Tc Compiler option is used in a project built within the
   Developer Studio, one of the following errors occurs:
<P>
<P><PRE>      Command line error D2004 : '/Tp' requires an argument
</PRE><P>
<P><PRE>      - OR -
</PRE><P>
<P><PRE>      Command line error D2004 : '/Tc' requires an argument
</PRE><P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q142421.htm">Q142421</A></B>
<PRE>   TITLE     : D2004 Caused by /Tp and /Tc Option in Visual C++ 4.0
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.10<BR>
KBCategory: kbprg kbref kbtool kbbuglist kbfixlist<BR>
KBSubCategory: VCGenIss
<P>

Keywords          : kbbuglist kbfixlist kbprg kbref kbtool<BR>
Version           : 4.10<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 19, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
