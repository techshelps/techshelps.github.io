

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: ifstream Object Loses Character in Text Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102158">
<META NAME="KBModify" CONTENT="1998/01/14">
<META NAME="KBCreate" CONTENT="1993/07/29">
<META NAME="Keywords" CONTENT="CPPIss vcbuglist400 kbcode">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When an application reads characters into an ifstream object opened in text mode, data may be lost and not placed into the buffer. The code does not provide any warning or other indication of this data loss.  STATUS ======  Microsoft has confirmed ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QAVW,QAVX,QA56,QA55,QAPN,QAR4,QAH4,QAW6,QAM1,QAA7,QAB7,QAKP,QA5W,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ifstream Object Loses Character in Text Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 14, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102158</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft C/C++ Compiler (CL.EXE) included with:
   - Microsoft C/C++ for MS-DOS, version 7.0
   - Microsoft Visual C++ for Windows, versions 1.0 and 1.5
   - Microsoft Visual C++ 32-bit Edition, versions 1.0, 2.0, 4.0,
<P><PRE>     4.1, 4.2
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When an application reads characters into an ifstream object opened in
text mode, data may be lost and not placed into the buffer. The code
does not provide any warning or other indication of this data loss.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the products listed at the
beginning of this article. This problem was fixed in Visual C++ 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code example demonstrates this problem by filling a buffer
with the character sequence "01234567890..." and using an ifstream object
to copy the data to another buffer. The transferred sequence reads as
"013456..." Only the character "2" is missing from the sequence. The
remainder of the sequence transfers correctly.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   /*
    * Compiler options needed:  -GX for 5.0 only
    */

   #include &lt;iostream.h&gt;
   #include &lt;fstream.h&gt;

   // To resolve the problem using Visual C++ 5.0, use the
   // following three statements instead of the preceding two:
   //
   // #include &lt;iostream&gt;
   // #include &lt;fstream&gt;
   // using namespace std;


   void main(void)
   {
      ofstream os("test.tmp");
      for (int i = 0; i &lt; 512; i++)
      {
         os.put((char)('0' + i % 10));
      }
      os.put('\n');
      os.close();

      streampos pos;
      ifstream is("test.tmp");
   // To resolve this error using Visual C++ 4.x and earlier, use the
   // following line to open the ifstream instead of the line above.
   // ifstream is("test.tmp", ios::binary);
      for (int k = 0; k &lt; 10; k++)
      {
         pos = is.tellg();
         cout &lt;&lt; (char)is.get();
      }
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 8.00c 9.00<BR>
Keywords          : CPPIss vcbuglist400 kbcode<BR>
Version           : ms-dos:7.0; Windows:1.0, 1.5; Winnt: 1.0, 2.0, 4.0, 4.1, 4.2<BR>
Platform          : MS-DOS WINDOWS winnt<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 14, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
