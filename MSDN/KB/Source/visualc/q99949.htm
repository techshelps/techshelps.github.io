

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Setup "Internal Error: File List Initialization" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99949 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1993/06/10">
<META NAME="Keywords" CONTENT="kb16bitonly vc10setup kbbuglist kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  An attempt to run the Visual C++ Setup program across a network from a disk drive located on another machine may fail and Setup may generate the following message:     Internal Error: File list initialization failed.    Choose OK to terminate Setup...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAC9,QDI2,QDIZ,QAY2,QAVZ,QAFI,QBFY,QA56,QA55,QA9N,QAH6,QBSU,QA5E,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Setup "Internal Error: File List Initialization"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99949 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS
kbsetup kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to run the Visual C++ Setup program across a network from a
disk drive located on another machine may fail and Setup may generate
the following message:
<P>
<PRE>   Internal Error: File list initialization failed.
   Choose OK to terminate Setup.

</PRE><h2>CAUSE</h2>
 
<P>
Setup queries the operating system to determine the type of device
from which Setup is running. Setup uses the GetDriveType() function in
the Microsoft Windows-based application programming interface (API). This
function returns three possible values, as follows:
<P>
<PRE>   DRIVE_REMOVABLE: disk can be removed from the drive.
   DRIVE_FIXED: disk cannot be removed from drive.
   DRIVE_REMOTE: network drive.

</PRE>If the disk drive is shared over a network, Windows reports it as a
remote drive rather than a removable drive. When Setup runs from a
remote drive it attempts to perform a network installation instead of
a floppy disk installation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This situation usually occurs when the target machine does not have a
disk drive of the correct size. In this case, the attempt to remedy
the situation by sharing a disk drive across a network is not
effective. There are two methods to address this situation: copy the
contents of all of the distribution disks to a network drive and
install from the network (see below for more details) or contact
Microsoft to obtain the correct size disks for the target system.
<P>
Visual C++ is distributed only on CD-ROM or on 3.5-inch high- density
floppy disks. 5.25-inch high-density disks are available from
Microsoft Customer Service. The Visual C++ package includes an order
form for 5.25-inch disks. In the United States, you can contact
Customer Service by phone at (800) 426-9600. Outside the United
States, contact the Microsoft subsidiary or distributor that serves
your country. To locate your distributor, go to the Microsoft Web site
<B><A HREF="http://www.microsoft.com/worldwide/default.htm">http://www.microsoft.com/worldwide/default.htm</A></B>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you have a network server available, you can copy the files from
the Visual C++ distribution disks onto the server and run Setup from
the server. If the target machine has only low-density floppy disk
drives, this is the only method available to install Visual C++ on
that machine.
<P>
To run Setup from a network drive, perform the following three steps:

<OL><P><LI>Create a directory on the server for Visual C++.

<P><LI>For each distribution disk, perform the following three steps:
<P>
   a. Create a subdirectory for the disk. Name the subdirectory DISK1,
<P><PRE>      DISK2, and so on as appropriate.
</PRE><P>
   b. Copy each disk into its corresponding subdirectory. Because some
<P><PRE>      of the distribution disks contain subdirectories, use a program
      like the MS-DOS XCOPY utility to copy the disks and create the
      required subdirectories.
</PRE><P>
   c. Use the following MS-DOS commands to copy each distribution disk
<P><PRE>      to the server (substitute the disk number for &lt;n&gt; in the code
      below):
</PRE><P>
<PRE>         md disk&lt;n&gt;
         cd disk&lt;n&gt;
         {insert disk &lt;n&gt; in an appropriate disk drive}
         xcopy a:*.* /s
         cd ..

</PRE><LI>The Professional Edition of Visual C++ is distributed on 20 3.5-
   inch high-density disks. When the software is installed on the
   server, the parent Visual C++ directory should contain twenty
   subdirectories.

</UL><OL><P><LI>On the target machine, start Windows and run Setup from the DISK1
   subdirectory on the server.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbsetup kbbuglist<BR>
KBSubcategory: vc10setup<BR>
Keywords            : kb16bitonly vc10setup kbbuglist kbsetup<BR>
Version             : 1.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
