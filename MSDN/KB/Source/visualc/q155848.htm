

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ODBC Error When Using CRecordset Without Deriving From It </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155848">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1996/09/10">
<META NAME="Keywords" CONTENT="MfcDatabase kbprg kbusage kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  With Visual C++ 4.2 and later, you can use the CRecordset class without deriving from it, allowing you to open a read-only recordset on any data source. This may be helpful if you are using CRecordset::GetFieldValue(), for example. However, when ca...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QBHQ,QBFY,QA9E,QA56,QA55,QAY2,QAPN,QBVV,QAW6,QALM,QA01,QAE1,QAML,QDMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ODBC Error When Using CRecordset Without Deriving From It</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155848</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Edition, versions 4.2, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With Visual C++ 4.2 and later, you can use the CRecordset class without
deriving from it, allowing you to open a read-only recordset on any data
source. This may be helpful if you are using CRecordset::GetFieldValue(),
for example. However, when calling Open() for the CRecordset object, you
may see a message box with the following message in it:
<P>
<PRE>   No columns were bound prior to calling SQLExtendedFetch

</PRE><h2>CAUSE</h2>
 
<P>
The CDatabase object used by the CRecordset object loaded the ODBC cursor
library. The cursor library requires that there be at least one bound
column for a recordset. The Visual C++ documentation doesn't make this
requirement clear.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not load the cursor library by specifying FALSE for the last argument of
CDatabase::Open(). For example:
<P>
<PRE>    CDatabase db;
    db.Open("MyDataSource", FALSE, FALSE, "ODBC;", FALSE);
    CRecordset rs( &amp;db );
    rs.Open(...);
    ...

</PRE>If your driver does not support dynasets, then the cursor library is
required and you will not be able to use the CRecordset class without
deriving from it.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem with the Visual C++ 4.2
documentation. The Visual C++ 5.0 documentation has been changed to reflect
this information and states:
<P>
<PRE>   Note, if you declare a recordset object without deriving from
   CRecordset, do not have the ODBC Cursor Library loaded. The cursor
   library requires that the recordset have at least one bound column;
   however, when you use CRecordset directly, none of the columns are
   bound. The member functions CDatabase::OpenEx and CDatabase::Open
   control whether the cursor library will be loaded."
</PRE> 
<PRE>Keywords          : MfcDatabase kbprg kbusage kbdocerr
Technology        : kbMfc
Version           : 4.2 4.2a 5.0
Platform          : NT WINDOWS
Issue type        : kbprb
Solution Type     : kbdocfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
