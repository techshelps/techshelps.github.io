

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Win32 DDK with Visual C++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119459">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1994/08/16">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Visual C++ comes with a Help file titled  Moving to Visual C++,  which includes a section on building device drivers using Visual C++. The information in this section is correct; however, it is not complete. There is another issue that needs to be ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QBFY,QA56,QAA5,QAH6,QAB5,QDIR,QBVV,QBLO,QBXS,QBWP,QDMW,QA26,QAXB,QAU3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using the Win32 DDK with Visual C++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119459</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ 32-bit Edition, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual C++ comes with a Help file titled "Moving to Visual C++," which
includes a section on building device drivers using Visual C++. The
information in this section is correct; however, it is not complete. There
is another issue that needs to be addressed if you are using the initial
release of the Win32 DDK: the checksum.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information is taken from the Help file "Moving to Visual
C++":
<P>
<PRE>   Q. How do I build device drivers with Visual C++?

   A. Although Visual C++ does not supply all of the libraries,
      headers, and tools needed to create device drivers for Windows
      NT, you can still use many Visual C++ components.

      1. Update the command-line tools included with the DDK with
         the versions provided with Visual C++.

         Note: Not all of the tools provided in the DDK (such as
         MASM) are supplied with Visual C++, so be careful when
         deleting files.

      2. Make appropriate changes to the source files and makefile.

         See:
          - How do I migrate my Win32 SDK source files to Visual C++?
          - How do I use my Win32 SDK makefiles with Visual C++?

      3. Use the BUILD or NMAKE utility to build the device driver.

</PRE>You will also need to take the checksum into account. The ability to
produce a checksum was added to the SDK tools just before their release
times. The Visual C++ linker was changed to support checksums as well, but
not by default; this is because checksum support is not always necessary
and checksum support increases the time it takes to perform a link.
<P>
To set the checksum in the header file of the executable file, use
"link /release" or "editbin /release". The documentation for editbin
(EDITBIN.WRI), includes the following description of "/release":
<P>
<PRE>   This option sets the checksum in the header of an executable file.

   The operating system requires the checksum for certain files such
   as device drivers. It is recommended that you set the checksum for
   release versions of your programs to ensure compatibility with
   future operating systems.

</PRE>This option is included in the MAKEFILE.DEF file included with later
releases of the Win32 DDK in MSDN Level 2.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00<BR>
KBCategory: kbinterop<BR>
KBSubcategory: TlsMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
