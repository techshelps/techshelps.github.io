

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: TypeLibs with Large Argument Lists May Crash ClassWizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148230">
<META NAME="KBModify" CONTENT="1997/09/19">
<META NAME="KBCreate" CONTENT="1996/03/07">
<META NAME="Keywords" CONTENT="MfcOLE vcbuglist400 vcfixlist410 WizardIss kbbuglist kbfile kbfixlist kbole kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Developer Studio crashes or abruptly terminates when attempting to add a new class from an OLE TypeLib with the ClassWizard.  CAUSE =====  ClassWizard allocates a 1024 byte buffer to store member function prototypes based on the information it ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAY2,QDJO,QAR4,QBHQ,QAE1,QAHE,QAJ6,QAJ4,QBWP,QA9Q,QA5E,QA2K,QAUF,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: TypeLibs with Large Argument Lists May Crash ClassWizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148230</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS NT
kbtool kbfixlist kbbuglist kbfile
<P>
 
The information in this article applies to:

<UL><LI>The ClassWizard included with:
   - Microsoft Visual C++, 32-bit Edition, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Developer Studio crashes or abruptly terminates when attempting to
add a new class from an OLE TypeLib with the ClassWizard.
<P>
<P><h2>CAUSE</h2>
 
<P>
ClassWizard allocates a 1024 byte buffer to store member function
prototypes based on the information it finds in the specified OLE TypeLib.
If the ClassWizard-generated prototype for a member function exceeds this
limit, Developer Studio will crash or abruptly terminate.
<P>
This problem only occurs when attempting to create a new class from an OLE
TypeLib, where one or more of the automation methods contains a large
argument list. For example, both Microsoft Schedule+ 7.0 and Microsoft
Project 4.0 expose automation methods with large argument lists. Attempting
to create a new class from either the Schedule+ type library (SP7EN32.OLB)
or the Microsoft Project type library (PJ4EN32.OLB) may cause Developer
Studio to crash.
<P>
When the crash occurs, you will notice that a header (.H) file and an
implementation (.CPP) file were added to your project's directory. These
files will most likely be corrupted and should be deleted from your project
directory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Avoid using the ClassWizard to generate new classes with the previously
listed type libraries. Microsoft has provided a self-extracting file,
called TLBWRAP.EXE, that contains the COleDispatchDriver-derived classes
that wrap the automation objects exposed by the SP7EN32.OLB and PJ4EN32.OLB
type libraries.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ Tlbwrap.exe

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug was corrected in Visual C++ 4.1.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory:  kbtool kbfixlist kbbuglist kbole kbfile<BR>
KBSubcategory: WizardIss MfcOLE vcbuglist400 vcfixlist410<BR>
Additional reference words: 4.00 4.10 softlib software library<BR>
Keywords          : MfcOLE vcbuglist400 vcfixlist410 WizardIss kbbuglist kbfile kbfixlist kbole kbtool<BR>
Version           : 4.00<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 19, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
