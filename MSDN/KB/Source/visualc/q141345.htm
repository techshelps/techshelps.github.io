

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Duplicating Resource Causes Resource ID Collision </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141345">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1995/12/17">
<META NAME="Keywords" CONTENT="AppStudioIss kbui vcbuglist400 vcbuglist500">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  If you duplicate a resource a few times in the resource browser by using copy and paste, you will find that it is possible to run into resource ID collisions when you try to rename the resources using the resource property dialog box. That is, when...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIM,QAUJ,QBWS,QBFY,QABI,QA56,QA55,QAB4,QA4H,QA01,QAIJ,QAGH,QARM,QAL0,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Duplicating Resource Causes Resource ID Collision</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141345</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Resource Editor included with:
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.1, 4.2, 5.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you duplicate a resource a few times in the resource browser by using
copy and paste, you will find that it is possible to run into resource ID
collisions when you try to rename the resources using the resource property
dialog box. That is, when you try to rename your resources, you will find
that the resource editor may try to assign your new resource name an
integer ID that already exists. This will cause a resource editor error
message.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem is the result of the Resource Editor not correctly assigning
new IDs to resource names when you try to give a resource a new name. The
Resource Editor actually is trying to assign the new resource name an
integer ID that is already used by another resource. This will cause the
resource ID collision.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
After you have duplicated your resources and before you start to rename
them, take the following steps to ensure that your resource names have
unique integer identifiers:

<OL><P><LI>If you are using Visual C++ 2.x, make sure the resource file is open by
   double-clicking the .rc file in the project window. In Visual C++ 4.0,
   4.1, or 4.2, click the Resource tab in the Project window.

<P><LI>If you are using Visual C++ 2.x, open the Symbols dialog box (on the
   Resource menu, click Symbols). If you are using Visual C++ 4.0, 4.1, or
   4.2, open the Symbols dialog box (On the View menu, click Resource
   Symbols).

<P><LI>Click the New button. The New Symbol dialog box will appear.

<P><LI>In the name edit control, type the new symbol name you want to use.

<P><LI>In the Value edit control, type the new symbol value you want to use.
   You must make sure this value isn't being used by any of the resources
   listed in the Resource Symbols dialog box.

<P><LI>Close the New Symbol dialog box by clicking OK.

<P><LI>Close the Symbols Browser by clicking OK.
<P>
</OL>You can now rename your resources using the symbols you created without
worrying about whether the symbol has already been defined.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Use Appwizard to generate a new MDI application.

<P><LI>In Visual C++ 2.x, open the .rc file in the project window. In Visual
   C++ 4.0, 4.1, or 4.2, click the Resource tab in the Project window to
   view the resources.

<P><LI>Expand the Accelerator, Icon, Menu, and Toolbar resource folders.

<P><LI>Select the IDR_MAINFRAME Accelerator resource.

<P><LI>Press CTRL+C

<P><LI>Press CTRL+V four times to make four copies of the Accelerator table
   IDR_MAINFRAME. There are now five versions of the Accelerator table
   named IDR_MAINFRAME through IDR_MAINFRAME4

<P><LI>Repeat steps 4 through 6 for the Icon, Menu, and Toolbar resources. You
   may notice inconsistencies in the default naming of the pasted
   resources. That is, you may see the default names come up as
   IDR_MAINFRAME, IDR_MAINFRAME2, IDR_MAINFRAME3, IDR_MAINFRAME4 and so on
   (IDR_MAINFRAME1 was skipped).

<P><LI>Start renaming all of the Accelerators so that you have IDR_MAINFRAME
   and IDR_TEST1 through IDR_TEST4

<P><LI>Start renaming all of Icons in the same way the accelerators were named
   in step 8. You won't be able to because you will get an error message
   that says:
<P>
<P><PRE>      The resource 'IDR_XTYPE' of this type uses the same identifier value.
</PRE><P>
   Where X is the project name.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 3.10 3.20
<P>

Keywords            : AppStudioIss kbui vcbuglist400 vcbuglist500<BR>
Version             : 2.0 2.1 2.2 4.0 4.1 4.2 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
