

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: TRACE() Messages Displayed When Opening Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112823">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1994/03/22">
<META NAME="Keywords" CONTENT="kb16bitonly MfcDatabase kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The following TRACE() messages appear in the Output window when calling CDatabase::Open() or CRecordset::Open():     Warning: ODBC Success With Info, Driver's SQLSetConnectOption             failed    State:IM006,Native:0,Origin:[Microsoft][ODBC DL...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QAEV,QAH4,QAZV,QAU9,QBWS,QAK6,QAB4,QAYC,QABO,QAYK,QALS,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: TRACE() Messages Displayed When Opening Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112823</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 4.20
WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.5, 4.2
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following TRACE() messages appear in the Output window when calling
CDatabase::Open() or CRecordset::Open():
<P>
<PRE>   Warning: ODBC Success With Info, Driver's SQLSetConnectOption
            failed
   State:IM006,Native:0,Origin:[Microsoft][ODBC DLL]

   Driver not capable.
   State:IM006,Native:0,Origin:[Microsoft][ODBC DLL]
   State:S1C00,Native:0,Origin:[Microsoft][ODBC Single-Tier Driver]

</PRE><h2>CAUSE</h2>
 
<P>
In CDatabase::AllocConnect() located in DBCORE.CPP, the Microsoft
Foundation Classes (MFC) contain the following line of code:
<P>
<PRE>   AFX_SQL_SYNC(::SQLSetConnectOption(m_hdbc, SQL_LOGIN_TIMEOUT,
         m_dwLoginTimeout));

</PRE>Because ODBC (Open Database Connectivity) doesn't provide a way to
determine whether or not an ODBC driver uses a "login time-out," the
database classes always try to set it before trying to connect. If
SQLDriverConnect() is called and the driver doesn't support login time-
outs, the above ODBC warning messages will occur.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Because these are harmless warnings (that is, connecting was successful),
you can ignore the warnings. Keep in mind that the login time-out has no
affect on the data source.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The debug version of MFC version 2.5 can provide TRACE() diagnostics
specifically for the database classes. To enable database TRACE() messages,
run the TRACER.EXE program. This program can be executed by clicking the
"MFC Trace Options" icon in the Microsoft Visual C++ Program Manager group.
When the program is displayed, select the check boxes titled "Enable
Tracing" and "DB Tracing".
<P>
The TRACE() messages shown above occur only if DB Tracing is enabled.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.50 2.50 4.20 error timeout<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: MfcDatabase<BR>
Keywords            : kb16bitonly MfcDatabase kbprb kbprg<BR>
Technology          : kbMfc<BR>
Version             : 1.50 4.20<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
