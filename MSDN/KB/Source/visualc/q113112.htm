

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Internal Compiler Error: MSC1.CPP, Line 585 or 581 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113112">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/03/24">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Compiling the sample code shown below causes the compiler to incorrectly generate one of the following error messages:     fatal error C1001 : internal compiler error     ( compiler file 'msc1.cpp', line 585 )     -or-     fatal error C1001 : inter...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAOT,QBFY,QAAP,QAKP,QA7Y,QAJ9,QAIB,QBXT,QA5V,QAYL,QAUS,QADX,QAPF,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Internal Compiler Error: MSC1.CPP, Line 585 or 581</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113112</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbtool kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft C/C++ Compiler (CL.EXE), included with:
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Compiling the sample code shown below causes the compiler to incorrectly
generate one of the following error messages:
<P>
<PRE>   fatal error C1001 : internal compiler error
    ( compiler file 'msc1.cpp', line 585 )

   -or-

   fatal error C1001 : internal compiler error
    ( compiler file 'msc1.cpp', line 581 )

</PRE><h2>CAUSE</h2>
 
<P>
Partially initializing an array of structures that is a field of another
structure (referred to as an "aggregate") causes the compiler to generate
internal compiler errors. The compiler does not generate an error if using
a .C file. The example shown below illustrates this:
<P>
<PRE>   typedef struct Element
   {
     int   field1;
     char *field2;
   }
   ELEMENT;

   typedef struct Aggregate
   {
     ELEMENT list[5];
   }
   AGGREGATE;

</PRE>Defining and initializing a variable using:
<P>
<PRE>   AGGREGATE mylist = {  1, "one",
                         2, "two",
                         3, "three",
                         4, "four"
                      };     // Internal compiler error C1001.

</PRE><h2>RESOLUTION</h2>
 
<P>
There are three workarounds to this problem:

<UL><LI>Use an array instead of a single variable. For example:
<P>
<P><PRE>      AGGREGATE mylist[] = { 1, "one",
<PRE></PRE>                             2, "two",
                             3, "three",
                             4, "four"
                           };
   -or-

</PRE><LI>Initialize all the members in the aggregate.
<P>
   -or-

<LI>If possible, compile the file as a .C file instead of a .CPP file.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem with C/C++ versions 8.0 and
8.0c. We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
This is not a problem in Visual C++ 32-bit Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In C++, when an aggregate is initialized, the initializer is a list of
brace-enclosed, comma-separated initializers for the members of the
aggregate in increasing sequence or member order. This rule applies
recursively to the members of the subaggregates if there are any. If fewer
initializers are in the list than the members of the aggregate, then the
remaining members are padded with zeroes of the appropriate types.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: /c
*/

</PRE>typedef struct Element
{
<PRE>  int   field1;
  char *field2;
</PRE>}
ELEMENT;
<P>
typedef struct Aggregate
{
<PRE>  ELEMENT list[5];
</PRE>}
AGGREGATE;
<P>
<PRE>void main(void)
</PRE>{
<PRE>  AGGREGATE mylist = {
                        1, "one" ,
                        2, "two" ,
                        3, "three" ,
                        4, "four"
                     };
}
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 8.00 8.00c<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: CLIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
