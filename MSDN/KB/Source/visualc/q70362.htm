

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_pg_setpalette Causes Incorrect Display for Extended ASCII </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q70362 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1991/03/24">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When attempting to reset the Presentation Graphics palette to display an extended ASCII character as a plotted point, a different character may be printed than expected. This problem occurs with the _pg_setpalette() function in C versions 6.0, 6.0a...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QAKD,QAVK,QAWP,QAAP,QAWN,QAY5,QAPG,QAKE,QBXS,QAKC,QBV8,QBVV,QAEF,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>_pg_setpalette Causes Incorrect Display for Extended ASCII</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q70362 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a 6.00ax 7.00 | 1.00 1.50
<PRE>MS-DOS                 | WINDOWS
</PRE>kbprg
<P>
<P>
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT), included with:
<P>
<P><PRE>    - Microsoft C for MS-DOS, versions 6.0, 6.0a, and 6.0ax
    - Microsoft C/C++ for MS-DOS, version 7.0
    - Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When attempting to reset the Presentation Graphics palette to display
an extended ASCII character as a plotted point, a different character
may be printed than expected. This problem occurs with the
_pg_setpalette() function in C versions 6.0, 6.0a, 6.0ax, C/C++
version 7.0, Visual C++ version 1.0, and QuickC versions 2.5 and 2.51
[but not with the _pg_setpalette() function in QuickC versions 2.0 and
2.01].
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The _pg_setpalette() function sets a palette that is used by the
presentation graphics routines. This palette contains colors, line
styles, fill patterns, and plot characters specifically defined by the
user.
<P>
When defining these plot characters with extended ASCII characters,
the actual character displayed may be different than what was defined.
The sample code below demonstrates this problem. Note that the ASCII
character displayed incorrectly is ASCII 254. All extended ASCII
characters of value 175 and below seem to be displayed correctly;
however, most characters above 175 are displayed incorrectly, usually
as single dashes.
<P>
This problem is occurring because with QuickC versions 2.5 and later,
and C versions 6.0 and later, characters are based on the ANSI
character set, and the actual implementation of additional characters
are undefined (Section 2.2.1). The ANSI character set consists of all
uppercase and lowercase letters, decimal digits 0 - 10, and the
following graphics characters:
<P>
<PRE>    ! " # % &amp; ' ( ) * + , - . / :
    ; &lt; = &gt; ? [ \ ] _ { | } ~

</PRE>When using the CodeView debugger and setting a watch on
pal[1].plotchar, it can be seen that the correct value is being placed
in memory. However, _pg_setpalette() does not initialize this value
correctly for the presentation graphics functions.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compiler options needed: none
*/

#include &lt;graph.h&gt;
#include &lt;pgchart.h&gt;
#include &lt;stdio.h&gt;
#include &lt;conio.h&gt;

#define VALUES  5

</PRE>float _far xvals[VALUES] = {1.0f, 2.0f, 3.0f, 4.0f, 5.0f};
float _far yvals[VALUES] = {11.0f, 9.0f, 12.0f, 8.0f, 5.0f};
<P>
<PRE>void main(void)
</PRE>{
<PRE>   chartenv env;
   palettetype pal;

   _setvideomode(_MAXRESMODE);

   _pg_initchart();
   _pg_defaultchart( &amp;env, _PG_SCATTERCHART, _PG_POINTANDLINE );
   _pg_getpalette((paletteentry _far *)pal);

   pal[1].plotchar = 254;     /* This value does not get */
                              /* printed correctly       */

   _pg_setpalette((paletteentry _far *)pal);
   _pg_chartscatter(&amp;env, xvals, yvals, VALUES);
   getch();

   _setvideomode(_DEFAULTMODE);
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 6.00 6.00a 6.00ax 7.00 1.00 1.50 pgchart<BR>
KBCategory: kbprg<BR>
KBSubcategory: CRTIss GraphicsIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
