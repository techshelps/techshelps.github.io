

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Syntax Error in FROM Clause" Using Text ODBC Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177947">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1997/12/10">
<META NAME="Keywords" CONTENT="MfcDatabase">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you use the AppWizard to create a CRecordset class using the ODBC Text Driver, your project will compile. However, when you try to open the recordset, you will get the following error message:     Syntax error in FROM clause.  CAUSE =====  The...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAUD,QA2Q,QAY2,QAG2,QAB4,QA9E,QBNG,QATX,QAMB,QAAP,QAY5,QAU9,QAUR,QBRZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Syntax Error in FROM Clause" Using Text ODBC Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177947</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the AppWizard to create a CRecordset class using the ODBC Text
Driver, your project will compile. However, when you try to open the
recordset, you will get the following error message:
<P>
<PRE>   Syntax error in FROM clause.

</PRE><h2>CAUSE</h2>
 
<P>
The AppWizard incorrectly parses the table as [Table].[txt], instead of as
[Table#txt].
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In the CTextDriverSet.cpp implementation file, find the
CTextDriverSet::GetDefaultSQL() function and change the return value from
<P>
<PRE>   return _T("[Table].[txt]");

</PRE>to the following:
<P>
<PRE>   return _T("[Table#txt]");

</PRE>Here is the function before the changes:
<P>
<PRE>   CString CTextDriverSet::GetDefaultSQL()
   {
      return _T("[Table].[txt]");

   }

</PRE>Here is the function after the changes:
<P>
<PRE>   CString CTextDriverSet::GetDefaultSQL()
   {
      return _T("[Table#txt]");
   }

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
<P><h3>In Notepad</h3>
 

<OL><P><LI>Create a text file with the following content:
<P>
<P><PRE>      Field1,Field2
      1,abc
</PRE>
<P><LI>Save this file as Table.txt and close it.

<P><LI>Create a new User DSN based on the Microsoft Text Driver and name it
   TextDriverSample.

<P><LI>Clear the Use Current Directory box.

<P><LI>Click the Select Directory button and select the directory that contains
   Table.txt.

<P><LI>Click Options.

<P><LI>Select *.txt from the Extensions list box.

<P><LI>Click the Define Format button.

<P><LI>Select Table.txt.

<P><LI>Select the Column Name Header box.

<P><LI>From the Format combo box, select CSV Delimited.

<P><LI>Click the Guess button.

<P><LI>Save and exit the ODBC Manager.
<P>
</OL><h3>Start Visual C++ 5.0</h3>
 

<OL><P><LI>Create a new MFC application.

<P><LI>Select Single Document, then click Next.

<P><LI>Select Database View Without File Support.

<P><LI>Click the Data Source button.

<P><LI>From the ODBC combo box, select TextDriverSample, then click OK.

<P><LI>From the Database Tables list, select Table.txt.

<P><LI>Click OK, then click Finish.

<P><LI>Compile the project.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Bomb Error<BR>
Keywords          : MfcDatabase<BR>
Technology        : odbc<BR>
Version           : WINNT:5.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
