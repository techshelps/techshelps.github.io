

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Create a Printer Device Context (DC) in MFC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162609">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1997/01/24">
<META NAME="Keywords" CONTENT="MfcPrinting kbcode kbhowto kbprint">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you create a printer device context (DC) in Windows SDK programming, an application must retrieve ::CreateDC()'s parameters (such as driver name, device name and output port) from either a Win.ini file (16-bit) or a Windows registry (32-bit). ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QACT,QAB5,QDL9,QBWQ,QBWO,QBWN,QAYL,QAUD,QBXR,QAA1,QAH4,QAJB,QDI2,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Create a Printer Device Context (DC) in MFC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162609</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.52 2.00 2.10 2.20 4.00 4.10 4.20
WINDOWS NT
kbprint kbcode kbhowto
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++ for Windows, 16-bit Edition, version 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.1, 4.2
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you create a printer device context (DC) in Windows SDK programming,
an application must retrieve ::CreateDC()'s parameters (such as driver
name, device name and output port) from either a Win.ini file (16-bit) or a
Windows registry (32-bit). In Microsoft Foundation Classes, this can be
done via a call to functions CWinApp::GetPrinterDeviceDefaults() and
CPrintDialog::CreatePrinterDC().
<P>
This article shows you a way to create a printer device context using the
default selected printer without displaying the Print dialog box. To create
a printer device context for a non-default printer, please refer to Chapter
15 of "Programming Windows 3.1" by Charles Petzold.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The CWinApp::GetPrinterDeviceDefaults() expects a PRINTDLG structure to be
passed in such a way that the data retrieved can be stored in the DEVMODE
and DEVNAMES handles of the structure. Those data are then used to create a
printer DC in the CPrintDialog::CreatePrinterDC() function.
<P>
Since CreatePrinterDC() and m_pd (a PRITNDLG variable) are member function
and member variable of the CPrintDialog class, a CPrintDialog variable is
defined and used in the following sample code.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>// Instantiate a CPrintDialog object.
</PRE>CPrintDialog dlg(FALSE);
<P>
<PRE>// Retrieve the current printer defaults from the Windows .ini file
// as necessary, or uses the last printer configuration set by the
// user in Print Setup.
</PRE>CWinApp* app = AfxGetApp();
if (!app-&gt;GetPrinterDeviceDefaults(&amp;dlg.m_pd))
<PRE>    {
    // Fails to create a printer device context for printing because
    // no printer is being installed. Bring up dialog box to alert the
    // users that they need to install a printer.  This step is optional.
    if (app-&gt;DoPrintDialog(&amp;dlg) != IDOK)
       return ;
    }

// Creates a printer DC from the DEVMODE and DEVNAMES structures.
</PRE>if (dlg.CreatePrinterDC() == NULL)
<PRE>    return ;

// A printer device context (DC) has been created.
// Attach it to a CDC object. The DC is deleted when the CDC
// object goes out of scope.
</PRE>CDC PrintDC;
PrintDC.Attach(dlg.m_pd.hDC);
<P>
<PRE>// ADD YOUR CODE HERE.

</PRE><h2>REFERENCES</h2>
 
<P>
"Programming Windows 3.1," Charles Petzold, Chapter 15, Microsoft Press,
1992
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kbcode kbhowto<BR>
KBSubcategory: MfcPrinting<BR>
Additional reference words: 1.52 2.00 2.10 2.20 4.00 4.10 4.20 1.50 1.51<BR>
1.00 2.50 2.51 2.52 3.00 3.10 3.20<BR>
Keywords          : MfcPrinting kbcode kbhowto kbprint<BR>
Technology        : kbMfc<BR>
Version           : 1.52 2.00 2.10 2.20 4.00 4.10 4.<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
