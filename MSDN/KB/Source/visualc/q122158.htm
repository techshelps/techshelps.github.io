

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Configuring Sound in Visual C++ Development Environment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122158">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/10/27">
<META NAME="Keywords" CONTENT="kbcode kbinf kbprg kbsound kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Visual C++ will play different sounds at the end of a build, depending on the success of the build. Without a sound system installed, Visual C++ calls MessageBeep().  If there is a sound system installed in the computer, Visual C++ calls sndPlaySou...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHR,QAYS,QBTX,QAB4,QBFY,QA56,QA55,QAA5,QAAP,QDL2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Configuring Sound in Visual C++ Development Environment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122158</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 4.00
WINDOWS NT
kbsound kbtool kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 2.0, 2.1, and 4.0,
   on the following platforms: x86, MIPS
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual C++ will play different sounds at the end of a build, depending
on the success of the build. Without a sound system installed, Visual
C++ calls MessageBeep().
<P>
If there is a sound system installed in the computer, Visual C++ calls
sndPlaySound(), using the Multimedia API, with specific sound names. If
the sound names listed below are not in the system's registry, Visual
C++ does not make any sound at all.
<P>
<PRE>Build State            sndPlaySound()      MessageBeep()
                       Sound Name          Beep Type
</PRE> 
<PRE>Build is up to date    BuildUpToDate       MB_ICONASTERISK
Build has errors       BuildError          MB_ICONEXCLAMATION
Build has warnings     BuildWarning        MB_ICONQUESTION
Build complete         BuildComplete       MB_ICONASTERISK
Build cancelled        &lt;nothing&gt;           &lt;nothing&gt;

</PRE>In addition, Visual C++ version 4.0 supports the following sound states:
<P>
<PRE>State                  sndPlaySound()      MessageBeep()
                       Sound Name          Beep Type
</PRE> 
<PRE>Breakpoint Hit         MSVC_HitBP         &lt;nothing&gt;
Error in Output        MSVC_OutputError   &lt;nothing&gt;
Warning in Output      MSVC_OutputWarning &lt;nothing&gt;

</PRE>If a sound card is not installed, you can modify the system sounds by
choosing the Sound icon from the Control Panel. If you have a sound card
installed, you need to modify the registry to add the sndPlaySound()
sound names to enable sound before you change the sounds in the Control
Panel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Under Windows NT registry, the sounds need to be placed in:
<P>
HKEY_CURRENT_USER\Control Panel\Sounds
<P>
You can use the following sample C program to automatically add these
sounds, or you can use REGEDT32.EXE to directly modify the registry.
After the modifications, your registry should contain the following
lines for Visual C++ 2.x:
<P>
BuildComplete:REG_SZ:tada.wav,Build Complete
BuildUpToDate:REG_SZ:ding.wav,Build Up To Date
BuildError:REG_SZ:ding.wav,Build Error
BuildWarning:REG_SZ:ding.wav,Build Warning
<P>
After the modifications, your registry should contain the following
lines for Visual C++ 4.0:
<P>
BuildComplete : REG_SZ : tada.wav,MSDev: Build Complete
BuildUpToDate : REG_SZ : ding.wav,MSDev: Build Up To Date
BuildError : REG_SZ : ding.wav,MSDev: Build Error
BuildWarning : REG_SZ : ding.wav,MSDev: Build Warning
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: Default build options for a console
                  application.
*/

#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

char *sound[4] = { "BuildComplete", "BuildUpToDate",
                   "BuildError", "BuildWarning" };
</PRE>#if _MSC_VER == 1000  // using Visual C++ 4.0
<PRE>char *soundValue[4] = { "tada.wav,MSDev: Build Complete",
                        "ding.wav,MSDev: Build Up To Date",
                        "ding.wav,MSDev: Build Error",
                        "ding.wav,MSDev: Build Warning" };
</PRE>#else  // using Visual C++ 2.x
<PRE>char *soundValue[4] = { "tada.wav,Build Complete",
                        "ding.wav,Build Up To Date",
                        "ding.wav,Build Error",
                        "ding.wav,Build Warning" };
</PRE>#endif
<P>
<PRE>void main( void )
</PRE>{
<PRE>int i;
</PRE>HKEY hCPanel;
HKEY hSounds;
<P>
if ((ERROR_SUCCESS != RegOpenKeyEx(HKEY_CURRENT_USER, "Control Panel",
<PRE>                       0, KEY_SET_VALUE, &amp;hCPanel)) ||
                (ERROR_SUCCESS != RegOpenKeyEx(hCPanel, "Sounds",
                 0, KEY_SET_VALUE, &amp;hSounds)))
   {
    printf("Error opening HKEY_CURRENT_USER\\Control Panel\\Sounds\n");
    exit(-1);
   }

</PRE>for (i=0; i&lt;4; i++)
<PRE>       if (ERROR_SUCCESS != RegSetValueEx(hSounds, sound[i], 0, REG_SZ,
        (unsigned char*) soundValue[i], strlen(soundValue[i]) + 1))
       printf("Could not set sound: %s\n", sound[i]);

</PRE>RegCloseKey(hSounds);
RegCloseKey(hCPanel);
<P>
printf("Sounds were successfully added\n");
exit(0);
}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 4.00 beep sound blaster<BR>
KBCategory: kbsound kbtool kbprg kbcode kbinf<BR>
KBSubCategory: VWBIss<BR>
Keywords            : kbcode kbinf kbprg kbsound kbtool<BR>
Version             : 2.00 2.10 4.00<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
