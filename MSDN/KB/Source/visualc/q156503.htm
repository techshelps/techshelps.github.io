

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Error When Deleting a Record Using the Apex Grid Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156503">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1996/09/24">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When deleting a record in the data-bound Apex Grid Control (DBGRID32.OCX), the following error appears in a message box:     37000: [Microsoft][ODBC Microsoft Access 7.0 Driver]        Syntax error in query expression 'current of SQL_CUR12522868X' ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QA5V,QBCT,QA7O,QAB5,QAOE,QAMN,QAGC,QAGB,QAEF,QAKP,QAPN,QAAP,QAB4,QDKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error When Deleting a Record Using the Apex Grid Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156503</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.2 and 4.2a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When deleting a record in the data-bound Apex Grid Control (DBGRID32.OCX),
the following error appears in a message box:
<P>
<PRE>   37000: [Microsoft][ODBC Microsoft Access 7.0 Driver]
       Syntax error in query expression 'current of SQL_CUR12522868X'

</PRE>The actual cursor name may vary, so instead of "SQL_CUR12522868X," you may
see "SQL_CURXXXXXXXXX" where the X can be any value.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is a problem in the Apex Grid control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, set the CursorDriver property of the Remote
Data Control (RDC) to one of the following:
<P>
<PRE>   1 - ODBC Cursor
   2 - Server-side cursor

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Apex Grid Control issues positioned deletes of the form:
<P>
<PRE>   DELETE FROM &lt;table&gt; WHERE CURRENT OF &lt;cursor name&gt;

</PRE>Most ODBC drivers need the cursor library to support such statements. If
the CursorDriver property is set to 0, the cursor library does not get
loaded and the positioned delete statement causes the error mentioned
above. Setting this property to 1 (ODBC Cursors) forces the cursor library
to be used.
<P>
Setting CursorDriver to 2 (Server-side cursors) causes the Apex Grid
control to delete records using keyset cursors (SQLSetPos) and the problem
is resolved.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: VCx86 PrgCtrlsCus<BR>
Additional reference words: 4.20 kbdsd DBGRID
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
