

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: ODBC.LIB Causes Error L2023: entry WEP: export imported </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133069">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1995/07/24">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When building a dynamic-link library (DLL) with Visual C++ that links with ODBC.LIB, the following linker error occurs:     L2023 : entry WEP : export imported  CAUSE =====  The ODBC.LIB file that ships with Visual C++ and the ODBC Software Develop...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QA3P,QBHQ,QBFY,QA56,QA55,QAAP,QAB4,QAY2,QDNN,QAB9,QDL9,QBXB,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ODBC.LIB Causes Error L2023: entry WEP: export imported</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133069</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 1.51 1.52 1.52A
WINDOWS
kbtool
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Linker (LINK.EXE) included with:
   Microsoft Visual C++ for Windows, version 1.5, 1.51, 1.52, 1.52A
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When building a dynamic-link library (DLL) with Visual C++ that links with
ODBC.LIB, the following linker error occurs:
<P>
<PRE>   L2023 : entry WEP : export imported

</PRE><h2>CAUSE</h2>
 
<P>
The ODBC.LIB file that ships with Visual C++ and the ODBC Software
Development Kit (SDK) publicly export the Window Exit Procedure (WEP).
Because this function must be exported by all 16-bit DLLs, including this
library in a DLL project causes the L2023 link error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If ODBC is not being used in the DLL, simply remove ODBC.LIB from the list
of additional libraries.
<P>
If ODBC is needed, generate a new import library from ODBC.DLL by using the
IMPLIB utility. The following command generates a replacement library for
ODBC.LIB called NEWODBC.LIB that does not contain a reference to WEP:
<P>
<PRE>   IMPLIB /nowep NEWODBC.LIB ODBC.DLL

</PRE>Execute this command from the directory that contains ODBC.DLL. After
creating NEWODBC.LIB, copy it into the Visual C++ LIB directory, and
change the project setting to use NEWODBC.LIB instead of ODBC.LIB.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../UTILITIES/Q104246.htm">Q104246</A></B>
   TITLE     : Causes of L2023 : Entry WEP : Export Imported
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.50 1.51 1.52 1.52A<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: LinkIss MfcDatabase<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
