

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Failing to Initialize OLE Generates Out of Memory Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128086">
<META NAME="KBModify" CONTENT="1998/02/17">
<META NAME="KBCreate" CONTENT="1995/03/26">
<META NAME="Keywords" CONTENT="MfcOLE">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="   If the OLE .DLL files are not initialized with a call to AfxOleInit(), subsequent OLE calls will fail. For 32-bit MFC applications, debug output sent to a debugging window may show these errors:     Throwing exception of type COleException    sCod...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QA9Q,QAIF,QBFY,QA56,QA55,QAAP,QAB4,QBW6,QAKP,QDL9,QBWQ,QBWO,QBWN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Failing to Initialize OLE Generates Out of Memory Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128086</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P>
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.5, 1.51, and 1.52
    - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1,
      4.0, 4.1, 5.0
      on the following platform: x86
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
<P>
If the OLE .DLL files are not initialized with a call to AfxOleInit(),
subsequent OLE calls will fail. For 32-bit MFC applications, debug output
sent to a debugging window may show these errors:
<P>
<PRE>   Throwing exception of type COleException
   sCode = 0x8007000E E_OUTOFMEMORY

   -or-

   sCode = 0x80030008 STG_E_INSUFFICIENTMEMORY

</PRE>For 16-bit MFC applications, debug output may show:
<P>
<PRE>   Throwing exception of type COleException
   sCode = 0x80000002 E_OUTOFMEMORY

   -or-

   sCode = 0x80030008 STG_E_INSUFFICIENTMEMORY

</PRE><h2>RESOLUTION</h2>
 
<P>
AfxOleInit() calls OleInitialize(LPMALLOC), which sets the task memory
allocator used by OLE. If this is not done, OLE cannot perform memory
allocations and any OLE calls will fail. Placing a call to AfxOleInit() in
the InitInstance() of an MFC application will fix this problem. The first
few lines from the InitInstance() of HIERSVR (MFC OLE sample provided with
Visual C++) below, shows the proper syntax for calling AfxOleInit().
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: standard MFC project
*/

</PRE>BOOL CServerApp::InitInstance()
{
<PRE>    // OLE 2.0 initialization
    if (!AfxOleInit())
    {
        AfxMessageBox(IDP_OLE_INIT_FAILED);
        return FALSE;
    }
</PRE>... function continues ....
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
 
<PRE>Keywords          : MfcOLE
Technology        : kbole kbMfc
Version           : Winnet:1.5,1.51,1.52,2.0,2.1,4.0,5.0
Platform          : NT WINDOWS
Hardware          : x86
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 17, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
