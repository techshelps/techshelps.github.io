

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Windows Application Displays Hourglass, then Exits </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117144">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/06/21">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Running a C or C++ application for Windows that calls a DLL built with C/C++ for MS-DOS, version 7.0, or Visual C++ for Windows, versions 1.0 and 1.5, exits after briefly displaying the hourglass cursor; the main window for the application is not d...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QBFY,QAJH,QAGI,QAO4,QBXS,QAH4,QAGB,QAGQ,QAKP,QBWS,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Windows Application Displays Hourglass, then Exits</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117144</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00   | 1.00 1.50 1.51 1.52
MS-DOS | WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft C/C++ for MS-DOS, version 7.0
<LI>Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, and 1.52
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Running a C or C++ application for Windows that calls a DLL built with
C/C++ for MS-DOS, version 7.0, or Visual C++ for Windows, versions 1.0 and
1.5, exits after briefly displaying the hourglass cursor; the main window
for the application is not displayed. This can occur when running the
application from File Manager or when attempting to run it from within a
debugger.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the application was linked with an import library for a DLL, and the DLL
was built without including a HEAPSIZE statement in the .DEF file or
HEAPSIZE was set to 0, this behavior can occur. The default .DEF file that
the Visual C++ Workbench creates for Windows DLLs sets HEAPSIZE to 1024. It
only adds a .DEF file when the project does not include one already. So
this problem could occur if a user creates a .DEF file and does not include
a HEAPSIZE, sets HEAPSIZE to 0, or modifies the HEAPSIZE statement in the
default .DEF file.
<P>
Another thing that causes this problem to occur is naming your project
using a name reserved by Windows for one of its system components. For more
information, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q116492.htm">Q116492</A></B>
   TITLE     : PRB: Debugger Cannot Debug DISPLAY.EXE

</PRE><h2>RESOLUTION</h2>
 
<P>
Including a HEAPSIZE statement in the .DEF file for the DLL and specifying
a non-zero value negates the problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Windows loader detects that an error occurred when trying to run the
application, and this is why the application exits immediately. As part of
loading the application, Windows, using an import library, loads any DLLs
to which that application is implicitly linked.
<P>
The C/C++ run-time startup code for DLLs calls the Windows function
"LocalInit" to initialize the local heap for the DLL. The LocalInit fails
when the HEAPSIZE is unspecified or set at 0. When the call to LocalInit
fails, the startup code returns an error indication to Windows and the
application fails to load.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: debug stop break break-point 7.00 1.00 1.50<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: VCGenIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
