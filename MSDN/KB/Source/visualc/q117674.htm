

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Create SYSTEM.INI Without Third-Party Drivers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117674">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/07/05">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  You can use your original Microsoft Windows or Windows for Workgroups disks to create a new SYSTEM.INI file for your specific hardware. This may be useful for troubleshooting or for replacing a damaged or deleted SYSTEM.INI file.  NOTE: As a precau...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWN,QBWQ,QA0B,QBFY,QDIO,QBXT,QA5V,QAIB,QANE,QAIJ,QA50,QABI,QAC9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create SYSTEM.INI Without Third-Party Drivers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117674</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 1.51 1.52
WINDOWS
kbsetup kbtshoot
<P>
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51 and 1.52
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use your original Microsoft Windows or Windows for Workgroups disks
to create a new SYSTEM.INI file for your specific hardware. This may be
useful for troubleshooting or for replacing a damaged or deleted SYSTEM.INI
file.
<P>
NOTE: As a precaution, you may want to start the Setup program with the
original SYSTEM.INI file and then press "Print Screen" so that you have a
printed copy of your settings. You can then use this as a reference when
you reset the settings. Always keep a backup of the SYSTEM.INI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a new SYSTEM.INI file that is configured for your specific
hardware but does not contain any references to third-party device
drivers, perform the following steps:

<OL><P><LI>Rename the SYSTEM.INI file as SYSTEM.BAK.

<P><LI>Expand the file SYSTEM.SR_ from the original Windows disks to
   the \Windows directory by using the following command:
<P>
<P><PRE>      c:\windows\expand a:\system.sr_ c:\windows\system.ini
</PRE><P>
   NOTE: This file can be found on disk 1 of the Windows version 3.1
   1.44-MB (3.5-inch) disk set or disk 2 of the 1.2-MB (5.25-inch) disk
   set. The file is on disk 3 of the Windows for Workgroups version 3.1
   disk set (either size).

<P><LI>Change to the Windows drive, and then change to the \Windows
   directory. For example:
<P>
<P><PRE>      c:
      cd \windows
</PRE>
<P><LI>Type "setup" (without the quotation marks) to start the MS-DOS portion
   of Windows Setup.

<P><LI>Select the correct hardware options for your system. They are
   blank by default.
<P>
   NOTE: For a list of valid choices, move your cursor to the blank
   field and then press Enter.

<P><LI>Accept the changes. (At this point, you can even have Setup copy
   new drivers if you want.)

<P><LI>Open the new SYSTEM.INI file in a text editor (for example, the
   MS-DOS version 5.0 Editor). Make the following changes to the
   SYSTEM.INI file:
<P>
   a. Add PROGMAN.EXE to the SHELL= line in the [Boot] section.
<P>
   b. Remove or remark out the Taskman.exe= line in the [Boot]
<P><PRE>      section.
</PRE><P>
   c. If you are running Windows for Workgroups, add the following
<P><PRE>      line to the [Boot] section:
</PRE><P>
<PRE>         network.drv=wfwnet.drv

      Then, modify the network= line in the [386Enh] section, as
      follows (this should all appear on one line):

         network=vnetbios.386,vnetsup.386,vredir.386,
         vserver.386,vbrowse.386,vwc.386

   d. To enable 32-bit disk access, add the following lines to
      the [386Enh] section:

         32BitDiskAccess=&lt;Boolean&gt;
         device=*int13
         device=*wdctrl

      Replace "&lt;Boolean&gt;" with True if you want 32-bit disk access
      enabled, or False if you do not want 32-bit disk access enabled.

      For more information on 32-bit disk access, see Appendix D in
      the "Windows Resource Kit" or query on the following words in the
      Microsoft Knowledge Base:

         Windows and 3.1 and 32-Bit and Disk and Access

   e. Add the line "Transport=vnb.386" (without the quotation marks) to the
      [386Enh] section so that the network functionality will load when you
      restart Windows for Workgroups.

</PRE><P><LI>Start Windows. If you do not receive any errors, you have successfully
   recreated your SYSTEM.INI file.
<P>
   If you receive error message S020 or S021, the SYSTEM.INI file you
   created may be corrupted. To correct this problem, do the following:
<P>
   a. Check for a duplicate SYSTEM.INI file by typing "DIR C:\ SYSTEM.INI
<P><PRE>      /S" (without the quotation marks) at the MS-DOS prompt.
</PRE><P>
   b. Run CHKDSK to check for lost allocation units by typing
<P><PRE>      "CHKDSK /F" (without the quotation marks) at the MS-DOS prompt.
</PRE><P>
   c. Make sure your hard disk has sufficient free space.
<P>
   d. Delete the corrupt SYSTEM.INI file and then follow the steps
<P><PRE>      above, starting with step 2.
</PRE><P>
   e. If all else fails, reinstall Windows.
<P>
</OL>NOTE: You will need to add the following three lines to the system.ini if
you are using VC++ 1.x (16bit):
<P>
device=c:\msvc\bin\mmd.386
device=c:\msvc\bin\dosxnt.386
device=c:\msvc\bin\cvw1.386
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 3.10 kbinf re-create rebuild clean<BR>
boot expanding hardware system.tmp vanilla<BR>
KBCategory: kbsetup kbtshoot<BR>
KBSubcategory: vc10setup vc15setup<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
