

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Scribble File Extension Conflicts with Screen Savers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126751">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1995/03/01">
<META NAME="Keywords" CONTENT="MfcOLE kbbuglist kbfixlist kbinterop kbole">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Creating or activating embedded or linked OLE objects-based files saved with the MFC server sample  Scribble  fails in unexpected ways. Two common scenarios are:   - When you attempt to insert an object into an OLE container using the    Create fro...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOG,QAW6,QAXB,QAR4,QDL9,QBWQ,QBWO,QBWN,QA5E,QAC1,QAJH,QBS9,QDIX,QBWP,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Scribble File Extension Conflicts with Screen Savers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126751</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 1.51 1.52 | 2.00 2.10
<PRE>WINDOWS        | WINDOWS NT
</PRE>kbinterop kbole kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
<P>
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.50, 1.51, and 1.52
    - Microsoft Visual C++, 32-bit Edition, versions 2.0 and 2.1
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Creating or activating embedded or linked OLE objects-based files saved
with the MFC server sample "Scribble" fails in unexpected ways. Two common
scenarios are:

<UL><LI>When you attempt to insert an object into an OLE container using the
   Create from File option, instead of creating a new Scribble Document
   object and inplace activating it, the Packager is invoked and a package
   is created. Nothing appears to happen when you try to activate the
   package.

<LI>While a Scribble Document is open in the Scribble application, you copy
   the contents to the clipboard, and attempt to paste link from an OLE
   container. The link is created and the container document's image of the
   link displays correctly. But after the container document is saved and
   both the container and Scribble applications are shut down, when you
   reopen the saved document, the container is unable to update or activate
   the link to the Scribble Document.
<P>
</UL><h2>CAUSE</h2>
 
<P>
The .SCR file extension used by Scribble is associated with another file
type, typically screen saver applications.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the file extension used by Scribble Documents to something that is
not already associated with a file type, for example .SCB. After changing
the file extension, you will need to run Scribble once in standalone mode
so it can update the system registry.
<P>
The file extension can be changed by editing the string resource
IDR_SCRIBTYPE in the Scribble application. Initially the string
value is:
<P>
<PRE>   \nScrib\nScrib\nScrib Files (*.scr)\n.SCR\nScribble.Document.1\n
      Scrib Document\nSCRI\nscri Files

</PRE>To change the file extension to .SCB, edit the string value to
look like this:
<P>
<PRE>   \nScrib\nScrib\nScrib Files (*.scb)\n.SCB\nScribble.Document.1\n
      Scrib Document\nSCRI\nscri Files

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug was corrected in Microsoft
Visual C++, 32-bit edition, version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
MFC Applications can update the file associations maintained in the system
registry by calling CWinApp::RegisterShellFileTypes(). However,
RegisterShellFileTypes() does not replace an existing association. Thus
when an association already exists for the .SCR file extension, nothing is
added to the registry to indicate that Scribble should be used to create or
edit these files.
<P>
This situation is most likely to occur on Windows 95, as .SCR files are
associated with Screen Saver applications when Windows 95 is installed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.50 2.50 1.51 2.51 1.52 2.52 2.00 3.00 2.10<BR>
3.10<BR>
KBCategory: kbinterop kbole kbbuglist kbfixlist<BR>
KBSubcategory: MfcOLE<BR>
Keywords          : MfcOLE kbbuglist kbfixlist kbinterop kbole<BR>
Technology        : kbMfc<BR>
Version           : 1.50 1.51 1.52 | 2.00 2.10<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
