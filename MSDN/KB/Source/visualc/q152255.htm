

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Custom AppWizard Doesn't Initialize Custom Step Dialogs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152255">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1996/06/08">
<META NAME="Keywords" CONTENT="WizardIss kbprb kbprg kbui">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Custom AppWizards with some custom steps do not pick up initialization values for the dialog's controls for these steps from the Resource Editor.  For instance, if the custom step's dialog template contains a Combo Box, the strings for the Combo Bo...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QASR,QA01,QARW,QAIM,QAL0,QBWP,QA7O,QAY5,QAUD,QAOE,QAMN,QAB5,QAJQ,QDIZ,QBV3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Custom AppWizard Doesn't Initialize Custom Step Dialogs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152255</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.10
WINDOWS NT
kbprg kbui kbprb
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
   Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Custom AppWizards with some custom steps do not pick up initialization
values for the dialog's controls for these steps from the Resource Editor.
<P>
For instance, if the custom step's dialog template contains a Combo Box,
the strings for the Combo Box can be entered in the Resource Editor itself.
When the Wizard is built and run, and when the custom step containing the
Combo Box comes up, the strings don't show up in the Combo Box. The same
also happens with a picture control with a bitmap associated with it.
<P>
<P><h2>CAUSE</h2>
 
<P>
For the custom step dialogs, Custom AppWizards ignore any initialization
information setup in the Resource Editor.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Each custom step's dialog template has a corresponding CAppWizStepDlg-
derived class. The necessary initialization should be done in this class's
OnInitDialog member function. Since this function is called before the
dialog is visible to the user, the effect is as if the initializations were
done in the Resource Editor.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Custom AppWizards are of three types with only two of these types
supporting custom dialog steps. The problem discussed in this article shows
up in both these types.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   BOOL CCustomDialog::OnInitDialog()
   {
       CAppWizStepDlg::OnInitDialog();

       // Initialize the combo box
       CComboBox* pCombo = (CComboBox* )GetDlgItem(IDC_COMBO);
       pCombo-&gt;AddString("Hello");
       pCombo-&gt;AddString("World");

       // Initialize the picture control
       m_Bitmap.LoadBitmap(IDB_MYBITMAP);
       CStatic* pStatic = (CStatic* )GetDlgItem(IDC_PICSTATIC);
       pStatic-&gt;SetBitmap(m_Bitmap);

       return TRUE;
   }

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.10<BR>
KBCategory: kbprg kbui kbprb<BR>
KBSubcategory: WizardIss<BR>
Keywords            : WizardIss kbprb kbprg kbui<BR>
Technology          : kbMfc<BR>
Version             : 4.00 4.10<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
