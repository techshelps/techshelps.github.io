

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOC: CListBox::SelItemRange Selects Only Two or More Items </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129428">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1995/04/26">
<META NAME="Keywords" CONTENT="MfcUI kbcode kbdocerr kbdocfix kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The documentation for CListBox::SelItemRange says that it can be used to select one or more items in a CListBox. This is not correct. SelItemRange can only be used to select two or more items. This is because CListBox::SelItemRange uses the windows...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QA2Q,QAML,QAX6,QALQ,QAH4,QAG2,QA4Q,QA4F,QBWP,QBFY,QA56,QA55,QAR4,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: CListBox::SelItemRange Selects Only Two or More Items</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129428</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10
WINDOWS NT
kbprg kbdocerr kbdocfix kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The documentation for CListBox::SelItemRange says that it can be used to
select one or more items in a CListBox. This is not correct. SelItemRange
can only be used to select two or more items. This is because
CListBox::SelItemRange uses the windows message LB_SELITEMRANGEEX which
deselects the item if the first and last index of the range are equal.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Here are two possible ways to enable the ability to select one or more
items:

<UL><LI>Test for the condition when the first and last items are equal, and in
   that case, use CListBox::SetSel.
<P>
   -or-

<LI>Use the windows message LB_SELITEMRANGE. The following code fragment
   demonstrates how to use this message. The code works when CMyListBox
   is derived from CListBox.
<P>
</UL><h3>Sample Code</h3>
 
<P>
<PRE>int CMyListBox::MySelItemRange (BOOL bSelect,
                                int nFirstItem,
                                int nLastItem)
{
   ASSERT_VALID(this);
   return (int)SendMessage(LB_SELITEMRANGE,
                              bSelect,
                              MAKELPARAM(nFirstItem,nLastItem));
}

</PRE>NOTE:  This problem was fixed in Microsoft Visual C++, 32-bit Edition,
version 4.0.  The following is from the Visual C++ 4.0 Books On-Line
entry for CListBox::SelItemRange:
<P>
<PRE>   Selects multiple consecutive items in a multiple-selection list box.

   Use this member function only with multiple-selection list boxes.
   If you need to select only one item in a multiple-selection list
   box that is, if nFirstIem is equal to nLastItem call the SetSel
   member function instead.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbdocfix kbdocerr kbcode<BR>
KBSubcategory: MfcUI<BR>
Additional reference words: 2.00 2.10 3.00 3.10 4.00<BR>
Keywords            : MfcUI kbcode kbdocerr kbdocfix kbprg<BR>
Technology          : kbMfc<BR>
Version             : 2.00 2.10<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
