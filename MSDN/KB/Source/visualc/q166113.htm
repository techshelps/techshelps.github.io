

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: User-defined Modules Can't Be Used Through ODBC or DAO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166113">
<META NAME="KBModify" CONTENT="1997/08/07">
<META NAME="KBCreate" CONTENT="1997/03/31">
<META NAME="Keywords" CONTENT="dbDao MfcDAO MfcDatabase kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Using Microsoft Access, you can create code modules in an .mdb file that can be used by predefined queries.  When you open the query in Access, the code works as expected.  However, if you use ODBC or DAO to access the predefined query, the followi...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAH4,QDN9,QAY5,QAB9,QA9E,QBFY,QA56,QA55,QAB4,QBV8,QAGI,QAAP,QDKY,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: User-defined Modules Can't Be Used Through ODBC or DAO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166113</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.1, 4.2, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using Microsoft Access, you can create code modules in an .mdb file that
can be used by predefined queries.  When you open the query in Access, the
code works as expected.  However, if you use ODBC or DAO to access the
predefined query, the following error message appears:
<P>
<PRE>   Undefined function '&lt;function name&gt;' in expression

</PRE>For example, assume that a function, called PlusTen, that adds 10 to some
value is defined in Access as follows:
<P>
<PRE>   Public Function PlusTen(ByVal inVal As Long) As Long
     PlusTen = inVal + 10
   End Function

</PRE>You could have the following SQL statement in a predefined query:
<P>
<PRE>   Select PlusTen(column1) from table1

</PRE>With the Access 7.0 or Access 97 ODBC Drivers included with Visual C++
versions 4.x and Visual C++ version 5.0, you receive an error similar to
the following:
<P>
<PRE>   Undefined function 'PlusTen' in expression
   State:37000, Native:-3102, Origin:[Microsoft][ODBC Microsoft Access 97
   Driver]

</PRE>If you use DAO 3.0 (included with Visual C++ 4.x) or DAO 3.5 (included with
Visual C++ 5.0), the following message appears in the Output window of the
debugger:
<P>
<PRE>   DAO Call Failed.
       m_pQueryDef-&gt;m_pDAOQueryDef-&gt;OpenRecordset(
         COleVariant((long)m_nOpenType), COleVariant((long)m_nOptions),
         &amp;m_pDAORecordset)
       In file daocore.cpp on line 3327
       scode = 800A0C0D
   Error Code = 3085
   Source = DAO.Database
   Description = Undefined function 'PlusTen' in expression.

</PRE><h2>CAUSE</h2>
 
<P>
ODBC and DAO do not use or know anything about the code modules inserted
into an .MDB file by Access. Only Access recognizes the modules.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Jet<BR>
Keywords          : dbDao MfcDAO MfcDatabase kbprg<BR>
Version           : 4.0 4.1 4.2 5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
