

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: ClassView Add... Errors with Read-Only Project Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182323">
<META NAME="KBModify" CONTENT="1998/03/11">
<META NAME="KBCreate" CONTENT="1998/03/11">
<META NAME="Keywords" CONTENT="vcbuglist500 VwbIss WizardIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  ClassView offers the following four options on its context menu for classes:   - Add Member Function  - Add Member Variable  - Add Virtual Function  - Add Windows Message Handler  These operations fail if project source files are read-only.  The fi...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QADZ,QBV8,QAEV,QA56,QA55,QAYL,QAGF,QBFY,QAK6,QARA,QA01,QDO3,QAJN,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ClassView Add... Errors with Read-Only Project Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182323</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The development environment included with:
<P><PRE>    - Microsoft Visual C++, 32-bit Editions, versions 5.0, 5.0sp1,
      5.0sp2, 5.0sp3
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
ClassView offers the following four options on its context menu for
classes:

<UL><LI>Add Member Function
<LI>Add Member Variable
<LI>Add Virtual Function
<LI>Add Windows Message Handler
<P>
</UL>These operations fail if project source files are read-only.
<P>
The first two operations fail displaying one of the following messages:
<P>
<PRE>   One or more of the files for ... are read-only.

   The implementation file for class ... cannot be found.

</PRE>The last two operations listed above fail without any message or visual
cue. They may not be presented as options.
<P>
<P><h2>CAUSE</h2>
 
<P>
Source file permissions are read-only, perhaps due to source control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the source file permissions to permit write access. In a source
control environment, this may require checking out the file, or having the
file's current owner check it back in.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The .ncb file contains ClassView browser information. If it is read-only at
the time Visual C++ opens the project, ClassView is unavailable. The .clw
file contains ClassWizard information. If it is read-only at the time
Visual C++ opens the project, the Add Virtual Function and Add Windows
Message Handler options are unavailable on the ClassView context menu for
classes.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new MFC AppWizard (exe) project.

<P><LI>Change the file permissions to read-only for all files except the .ncb
   file.

<P><LI>Right-click a class in ClassView; select Add Member Function or Add
   Member Variable.
<P>
   NOTE: A message box appears, but the Add… dialog box does not.

<P><LI>Right-click Add Virtual Function or Add Windows Message Handler.
<P>
   NOTE: No visible response occurs.

<P><LI>Close the workspace and reopen it.

<P><LI>Right-click a class in ClassView. The Add Virtual Function and Add
   Windows Message Handler options do not appear on the context menu.
<P>
</OL>For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../SSAFE/Q140252.htm">Q140252</A></B>
   TITLE     : PRB: ClassWizard Disables Add Function &amp; Add Variable
               Buttons

</PRE></OL><h2>REFERENCES</h2>
 
<P>
<P><h2>Visual C++ online books: "File Types Created for Visual C++ Projects."</h2>
 
<PRE>Keywords          : vcbuglist500 VwbIss WizardIss
Version           : WINNT:5.0,5.0sp1,5.0sp2,5.0sp3
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
