

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Troubleshoot WinCE Application Installations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181007">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1998/02/12">
<META NAME="Keywords" CONTENT="kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Windows CE SDK provides tools for installing applications to a Windows CE device. This process involves writing a setup INF file (.inf), which will be used by the Application Installation tools to create cabinet (CAB) files containing the files...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIY,QAA1,QDL9,QBWQ,QBWO,QBWN,QDI2,QAJH,QABI,QBWP,QAR4,QATX,QAH5,QAGU,QA0B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Troubleshoot WinCE Application Installations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181007</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows CE, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows CE SDK provides tools for installing applications to a Windows
CE device. This process involves writing a setup INF file (.inf), which
will be used by the Application Installation tools to create cabinet (CAB)
files containing the files need for the application. An Application Manager
INI (.ini) file must also be created to register the CAB files with the
desktop Windows CE Application Manager. The following addresses common
problems encountered with the Application Installation mechanism.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>CAB Wizard</h3>
 

<UL><LI>To use a percent (%) character in an INF file, use %%, as specified in
   the Win32 SDK documentation. However, this method will not work under
   the [Strings] section.

<LI>INF files created for Windows CE cannot be used for installing to
   Windows 95 or Windows NT.

<LI>CAB files created for Windows CE cannot be used for installing to
   Windows 95 or Windows NT.

<LI>The Windows CE SDK-included files Makecab.exe and Cabwiz.ddf must be in
   the same directory as Cabwiz.exe.

<LI>Cabwiz.exe must be called with the full path.

<LI>Creating a CAB file using the Windows CE SDK-included file Makecab.exe
   doesn't work with Windows CE. You must use Cabwiz.exe (which uses
   Makecab.exe) to generate the CAB files for Windows CE.

<LI>CAB files cannot have the read-only file attribute.

<LI>Verify in the INF file that string lists do not have trailing commas or
   unnecessary/extra spaces.
<P>
<P><PRE>      Invalid:  CopyFiles=Files.Common,  Files.Cpu,
<PRE></PRE>      Valid:    CopyFiles=Files.Common,Files.Cpu

</PRE></UL><h3>Application Manager (AppMgr)</h3>
 

<UL><LI>When calling Ceappmgr.exe to register an application, use the full
   path for the location of the AppMgr INI file(s).

<LI>Use the "/report" parameter in debug versions to verify that AppMgr is
   using the correct information for the CAB files.
<P>
</UL><h3>Errors When Registering Applications with Application Manager</h3>
 

<UL><LI>Verify in the AppMgr INI file that the string list in the "CabFiles" key
   matches the actual CAB file name and relative path.

<LI>Verify in the AppMgr INI file that the string value in the "Component"
   key exists elsewhere in the INI file.

<LI>Verify that the desktop setup program is calling the correct AppMgr INI
   file, using a full path.

<LI>Verify in the AppMgr INI file that the string list in the "CabFiles" key
   contains no unnecessary spaces.
<P>
<PRE>      Invalid:   CabFiles=app.sh3.cab,  app.mips.cab
      Valid:   CabFiles=app.sh3.cab,app.mips.cab

</PRE></UL><h3>Miscellaneous</h3>
 
<P>
There are various third-party desktop setup programs that do not correctly
update the actual file sizes when overwriting existing files. Because
the Application Manager verifies the actual file size with the embedded
file size of the CAB file, make sure that the installed CAB file sizes are
correct. To ensure this happens for future upgrade scenarios, you can
delete the known, existing CAB files on a reinstallation scenario.
 
<PRE>Keywords          : kbtshoot
Version           : WINDOWS:2.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
