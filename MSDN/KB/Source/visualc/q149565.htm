

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Unable to Load Control from C:\Path\File.ocx </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149565">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1996/04/04">
<META NAME="Keywords" CONTENT="CDKIss MfcOLE kbcode kbhowto kbole kbprb">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you try to load an OLE Control generated by using ControlWizard into a Visual Basic 4.0 form in Visual Basic by on the Tools menu, clicking Custom Controls and then clicking the Browse button, the following error message appears:     Unable to...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAMN,QAOE,QA9Q,QBS0,QBJZ,QAHV,QBVV,QBC9,QBC8,QA3P,QANO,QAKD,QBRZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Unable to Load Control from C:\Path\File.ocx</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149565</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.20 4.00 4.10
WINDOWS NT
kbole kbhowto kbprb kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P>
<P><PRE>    - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1
    - Microsoft OLE Control Developer's Kit (CDK), version 2.0, 2.1, 2.2
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to load an OLE Control generated by using ControlWizard into a
Visual Basic 4.0 form in Visual Basic by on the Tools menu, clicking Custom
Controls and then clicking the Browse button, the following error message
appears:
<P>
<PRE>  "Unable to load control from: 'x:\path\file.ocx'"

</PRE><h2>CAUSE</h2>
 
<P>
Visual Basic checks an OLE control to see whether it supports self-
registration by searching for the presence of an OLESelfRegister entry in
the StringFileInfo section of the control's version information resource.
ControlWizard-generated OLE controls do not provide the entry by default.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Modify the OLE Control to indicate its support for the self-registration
feature. This can be achieved by including the OLESelfRegister entry with
an empty value in the StringFileInfo section of the control's version
resource. The following steps explain the process in detail.
<P>
<P><h3>Step-by-Step Procedure</h3>
 

<OL><P><LI>Open the .rc file of the OLE Control as a Text file.

<P><LI>Find the StringFileInfo block under Version information.

<P><LI>Add the following line to the existing list of VALUE statements:
<P>
   VALUE "OLESelfRegister", "\0"

<P><LI>Build the OLE Control. Now you can load the OLE Control (.ocx file) by
   clicking Custom Controls on the Tools menu and clicking the Browse.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
MORE INFORMATION
 
<P>
A COM server typically indicates its support for self-registration by
including the OLESelfRegister entry with an empty value in the
StringFileInfo of its version resource. This entry is considered optional
because the actual self-registration mechanisms do not depend on its
presence. This information simply allows a client application to avoid
loading a DLL (that is, an in-process server or OLE control) or launching
an .exe (that is, a local server) for no gain.
<P>
The only requirement for an OCX/DLL to support the self-registration
mechanism is to provide the entry points DllRegisterServer and
DllUnregisterServer and export them. ControlWizard-generated OLE controls
provide these two entry points and export them, though they do not indicate
their self-registration support by not including the OLESelfRegister entry
by default.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Please refer to Chapter 5 of Inside OLE, Second Edition, for more
information on self-registration.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 2.20 4.00 4.10 load failure<BR>
KBCategory: kbole kbhowto kbprb kbcode<BR>
KBSubcategory: CDKIss MfcOLE<BR>
Keywords          : CDKIss MfcOLE kbcode kbhowto kbole kbprb<BR>
Technology        : kbMfc<BR>
Version           : 2.00 2.10 2.20 4.00 4.10<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
