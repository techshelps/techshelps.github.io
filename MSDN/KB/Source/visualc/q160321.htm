

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOC: User Supplied RASAdmin.dll Callbacks Must Use _stdcall </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160321">
<META NAME="KBModify" CONTENT="1997/10/08">
<META NAME="KBCreate" CONTENT="1996/12/03">
<META NAME="Keywords" CONTENT="NtwkRAS kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  On the Microsoft Developers Network (MSDN) CD-ROM, the four user callback function entry points in the RASAdmin.dll (supplied by the user) in Windows NT 4.0 must have _stdcall in their function declarations. The declarations in these files should i...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO2,QAO3,QAY5,QBWD,QBV8,QAB9,QAGU,QAB3,QA7M,QDJP,QBFY,QBC9,QBC8,QAUJ,QANO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: User Supplied RASAdmin.dll Callbacks Must Use _stdcall</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160321</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
On the Microsoft Developers Network (MSDN) CD-ROM, the four user callback
function entry points in the RASAdmin.dll (supplied by the user) in Windows
NT 4.0 must have _stdcall in their function declarations. The declarations
in these files should include CALLBACK or WINAPI or __stdcall as is
specified for other callback functions. Look at the page for
EnumICMProfilesProc for an example of a callback function declaration. The
documentation errors are located in the following files:
<P>
<PRE>   MSDN/Products/Win32SDK/Win32 Programmer's Reference/Reference/
   Functions/RASGetIpAddressForUser

   MSDN/Products/Win32SDK/Win32 Programmer's Reference/Reference/
   Functions/RASReleaseIpAddress

   MSDN/Products/Win32SDK/Win32 Programmer's Reference/Reference/
   Functions/RASAcceptNewConnection

   MSDN/Products/Win32SDK/Win32 Programmer's Reference/Reference/
   Functions/RASHangupConnection

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Third-party RAS server administration DLLs have four entry points declared
in the WIN32SDK programmer's reference. The declarations do not include the
_stdcall calling sequence specifier. If you build your DLL using Visual
C++ 4.x defaults, your DLL does not work correctly. You can either set your
project to use __stdcall as the default by choosing:
<P>
Build\Settings\C/C++:Category Code Generation:Calling Convention __stdcall
<P>
<PRE>   -or-

</PRE>you can change your code and Rassapi.h to use the following function
declarations:
<P>
DWORD APIENTRY RasAdminGetIpAddressForUser(
<PRE>    WCHAR *lpszUserName,   // pointer to the name of the remote user
    WCHAR *lpszPortName,   // pointer to the name of the port
    IPADDR *pipAddress,         // pointer to the IP address
    BOOL *bNotifyRelease   // indicates whether RAS should call
</PRE>RasAdminReleaseIpAddress
<PRE>   );
</PRE>VOID APIENTRY RasAdminReleaseIpAddress(
<PRE>    WCHAR *lpszUserName,   // pointer to the name of the remote user
    WCHAR *lpszPortName,   // pointer to the name of the port
    IPADDR *pipAddress         // pointer to the IP address
   );

</PRE>BOOL APIENTRY RasAdminAcceptNewConnection(
<PRE>    RAS_PORT_1 *pRasPort1, // pointer to connection information
    RAS_PORT_STATISTICS *pRasStats, // pointer to port statistics
    RAS_PARAMETERS *pRasParams   // pointer to an array of parameters
   );

</PRE>VOID APIENTRY RasAdminConnectionHangupNotification(
<PRE>    RAS_PORT_1 *pRasPort1, // pointer to connection information
    RAS_PORT_STATISTICS *pRasStats, // pointer to port statistics
    RAS_PARAMETERS *pRasParams   // pointer to an array of parameters
   );

</PRE>NOTE: The remaining RasAdmin... functions are correctly declared in
rassapi.h using APIENTRY.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MSDN<BR>
Keywords          : NtwkRAS kbnetwork<BR>
Version           : WINNT:4.2;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
