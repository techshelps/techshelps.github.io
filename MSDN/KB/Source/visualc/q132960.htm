

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Invalid Precision Value Err w/ Character Field Parameters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132960">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1995/07/23">
<META NAME="Keywords" CONTENT="MfcDatabase kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Parameterizing a recordset using one or more character fields may result in an error message similar to the following being returned by an ODBC driver:     Invalid precision value    State:S1104,Native:76,Origin:[Microsoft][ODBC dBase Driver]  CAUS...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QAHE,QAKD,QBBI,QAY5,QAB4,QA9E,QAK6,QAGN,QAGI,QANY,QAYY,QAX6,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Invalid Precision Value Err w/ Character Field Parameters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132960</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++ for Windows, versions 1.5, 1.51, 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2,
<P><PRE>     4.0, 4.1, 4.2, 4.2b, 5.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Parameterizing a recordset using one or more character fields may result
in an error message similar to the following being returned by an ODBC
driver:
<P>
<PRE>   Invalid precision value
   State:S1104,Native:76,Origin:[Microsoft][ODBC dBase Driver]

</PRE><h2>CAUSE</h2>
 
<P>
If an application does not specify the maximum length of a character
field parameter in the recordset's DoFieldExchange() function, a
default value of 255 is used. Some data sources have a maximum character
field length of less than 255.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this issue, include a fourth parameter in the RFX_Text()
function call equal to the size of the character field that is being bound.
For example, to bind a parameter to an eight-character field in a database,
call the RFX_Text() function as follows:
<P>
<PRE>   pFX-&gt;SetFieldType(CFieldExchange::param);
   RFX_Text(pFX, "FIELD1Param", m_strFIELD1Param, 8);

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The exception being thrown is generated in the RFX_Text() function by the
following code:
<P>
<PRE>   AFX_SQL_SYNC(::SQLBindParameter(pFX-&gt;m_hstmt, (UWORD)nField,
   SQL_PARAM_INPUT, SQL_C_CHAR,
               (SWORD)nColumnType,
               nMaxLength, 0, pvParam, 0, plLength));

</PRE>The ODBC Programmer’s Reference states the following for the
SQLBindParameter() S1104 error:
<P>
<PRE>   S1104 - Invalid precision value The value specified for the argument
   cbColDef was outside the range of values supported by the data source
   for a column of the SQL data type specified by the fSqlType argument.

</PRE>If no nMaxLength is passed into the RFX_Text(), nMaxLength defaults to 255.
If the data source does not support text fields of 255, the S1104 error
occurs. The Microsoft dBASE and FoxPro drivers, for example, have a maximum
character field length of 254. They exhibit the behavior described in this
article.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, please see SQLBindParameter in the ODBC 2.x
Programmer's Reference.
 
<PRE>Keywords          : MfcDatabase kberrmsg kbinterop
Technology        : kbMfc
Version           : 1.5 1.51 1.52 1.52a 1.52b 2.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
