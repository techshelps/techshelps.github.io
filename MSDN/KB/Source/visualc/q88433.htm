

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: _vmalloc Fails When Running 386MAX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88433 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1992/08/26">
<META NAME="Keywords" CONTENT="kb16bitonly VirtualMem kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The function 0Fh (Resize Memory Block) of the 386MAX XMS handler seems to always return a value indicating that there is not enough extended memory. This happens when 386MAX version 6.02 or an earlier version of the 386MAX memory manager is install...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIO,QBW6,QAGI,QDJD,QAC1,QAUD,QDL9,QBWQ,QBWO,QBWN,QBVV,QBFY,QAKD,QBW5,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: _vmalloc Fails When Running 386MAX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88433 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00   | 1.00 1.50
MS-DOS | WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft C/C++ for MS-DOS, version 7.0
<LI>Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The function 0Fh (Resize Memory Block) of the 386MAX XMS handler
seems to always return a value indicating that there is not enough
extended memory. This happens when 386MAX version 6.02 or an earlier
version of the 386MAX memory manager is installed and the swaparea
parameter to _vheapinit() contains only the _VM_XMS value.
<P>
<P><h2>CAUSE</h2>
 
<P>
The function 0Fh (Resize Memory Block) of the 386MAX XMS handler
seems to always return a value indicating that there is not enough
extended memory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are three ways to work around the problem:

<UL><LI>Bitwise OR (|) the third parameter of the _vheapinit call with
   either _VM_EMS or _VM_DISK. This will allow _vmalloc to access
   expanded memory or disk space.

<LI>Substitute the 386MAX XMS handler with another. For example, run
   the program under Windows, or remove 386MAX and use HIMEM.SYS.

<LI>Upgrade to 386MAX version 6.02b or later.
<P>
</UL>Qualitas has confirmed this to be a problem in 386MAX version 6.02
and in earlier versions. This problem was corrected in 386MAX
version 6.02a. To obtain an updated version of 386MAX, use a modem
to call the Qualitas BBS at (301) 907-8030. Your 386MAX serial
number is required as part of the BBS login procedure. Request the
updated version of 386MAX by leaving a message for the BBS sysop.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed:    None
*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;vmemory.h&gt;

void main()
</PRE>{
<PRE>   _vmhnd_t handle;

   if ( !_vheapinit( 0, _VM_ALLDOS, _VM_XMS) )
   {
      printf( "Could not initialize virtual memory manager.\n" );
      exit( -1 );
   }

   printf( "Requesting 100 bytes of virtual memory.\n" );
   if ( (handle = _vmalloc( 100 )) == _VM_NULL )
      {
      _vheapterm();
      printf("Allocation failed\n");
      exit( -1 );
      }

   _vheapterm();
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 7.00 1.00 1.50<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: VirtualMem<BR>
Keywords            : kb16bitonly VirtualMem kbprb kbprg<BR>
Version             : 7.00   | 1.00 1.50<BR>
Platform            : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
