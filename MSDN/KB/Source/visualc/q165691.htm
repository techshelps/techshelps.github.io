

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Visual C++ 5.0 Readme, Sample Program Issues </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165691">
<META NAME="KBModify" CONTENT="1997/06/27">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Sample Program Issues  New Visual C++ 5.0 Samples Updated Samples ATL Samples COMMAP, CONNECT, and DRAWSERV Do Not Register Correctly When Path Contains Spaces CUSTOMWZ Sample Missing Files Get Sendtime and Settime Samples from the Compact Disc ATL...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QBFY,QA56,QA55,QAFI,QBXB,QAY2,QATJ,QAK2,QA9N,QA9Q,QAR4,QAC9,QBWS,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Visual C++ 5.0 Readme, Sample Program Issues</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165691</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h3>Sample Program Issues</h3>
 
<P>
New Visual C++ 5.0 Samples
Updated Samples
ATL Samples COMMAP, CONNECT, and DRAWSERV Do Not Register Correctly When
Path Contains Spaces
CUSTOMWZ Sample Missing Files
Get Sendtime and Settime Samples from the Compact Disc
ATL CIRC Sample Fails in Some Containers
ATLCON Sample Fails Under MinCRT Configurations
ATLBUTTON Sample Returns Incorrect Property Values
ATL POLYGON Sample Does Not Build in Release Mode
Link Error in Debug Build of COM Sample acdual/mfcctrl
Typo in tan and tanh Sample
BINDENRL Sample Fails to Copy STDREG32.MDB
Access Violation in Visual Basic 5 When Running COMEXCEL Sample
Running OLE SDK Samples
Running InOLE2 SDK Samples
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The samples on the first Visual C++ CD are accessible from any directory
browser (Windows Explorer or File Manager, for example). Sample code
remains available for viewing and download from sample abstracts in the
documentation.
<P>
New Visual C++ 5.0 Samples
 
<P>
Try out the samples located in the \DEVSTUDIO\VC\SAMPLES directory of the
first Visual C++ CD. These include examples of using the new compiler
support for COM and samples for ATL. They also include a new Custom
AppWizard sample.
<P>
<P><h3>Updated Samples</h3>
 
<P>
The most recent versions of the following samples are in the
DevStudio\Vc\Samples directory on the disc that includes "Microsoft Visual
C++" on the label. (Disc 1 if you purchased Visual C++; Disc 3 if you
purchased Visual Studio.) Do not use the versions that you can find in the
InfoViewer's Samples abstracts. Instead, copy the files from the Microsoft
Visual C++ disc to your hard drive.
<P>
<P>
MFC Samples

<UL><LI>OLDBARS
<LI>SUPERPAD
<LI>OLEVIEW
<LI>WORDPAD
<LI>EXTBIND
<LI>MDIBIND
<LI>BINDENRL
<LI>REGSVR
<LI>SMILEY
<LI>DAOCTL
<LI>ODBCINFO
<P>
</UL>ATL Samples

<UL><LI>CIRC
<LI>POLYGON
<P>
</UL>Enterprise Samples

<UL><LI>SENDTIME
<LI>SETTIME
<P>
</UL>Com Samples

<UL><LI>ALLINONE
<LI>INPROC
<LI>LABRADOR
<P>
</UL>SDK Samples

<UL><LI>AXSCRIPT
<LI>URLPAD
<P>
</UL>ATL Samples COMMAP, CONNECT, and DRAWSERV Do Not Register Correctly When
Path Contains Spaces
 
<P>
These ATL samples do not register correctly when their path contains
spaces.
<P>
Workaround
<P>
Edit their corresponding .RGS files and add single quotes around all
occurrences of %MODULE%. For example, you would change a line containing
the following:
<P>
<PRE>   InprocServer32 = s %MODULE%

</PRE>to the following:
<P>
<PRE>   InprocServer32 = s '%MODULE%'

</PRE>NOTE: DRAWSERV is a sample program within the DCOM ATL sample.
<P>
<P><h3>CUSTOMWZ Sample Missing Files</h3>
 
<P>
The CUSTOMWZ sample in the DevStudio\Vc\Samples\appwiz\ directory is
missing some essential files.
<P>
To obtain the entire sample, with all of its files, install it from the
"CUSTOMWZ: A Custom AppWizard" topic in the online documentation. To find
this topic, choose the Search command from the Help menu, enter the comma-
delimited string, "CUSTOMWZ: A Custom AppWizard", on the Query tab, and
then click the Query button.
<P>
<P><h3>Get Sendtime and Settime Samples From the Compact Disc</h3>
 
<P>
The files for the Sendtime and Settime samples downloaded from the
Enterprise sample abstracts in the online documentation will not compile.
<P>
Workaround
<P>
Manually copy the correct files for these samples from the
DevStudio\VC\Samples\Ent\time directory. This directory is on the disc that
includes "Microsoft Visual C++" on the label. (Disc 1 if you purchased
Visual C++; Disc 3 if you purchased Visual Studio.)
<P>
<P><h3>ATL CIRC Sample Fails in Some Containers</h3>
 
<P>
For correct functionality in certain containers, objects passing properties
must support the propputref semantics. The CIRC sample as installed from
the online abstract supports propput instead of propputref. Therefore, you
should use the CIRC sample from the DevStudio\Vc\Samples\Atl\circ
directory. To see the correct propputref syntax, look in the Circ.idl file.
This directory is on the disc that includes "Microsoft Visual C++" on the
label. (Disc 1 if you purchased Visual C++; Disc 3 if you purchased Visual
Studio.)
<P>
<P><h3>ATLCON Sample Fails Under MinCRT Configurations</h3>
 
<P>
To successfully run the ATL sample, ATLCON, under a MinCRT configuration,
you must remove the WinMain entry point as follows:

<OL><P><LI>On the Projects menu, click Settings.
</OL>2. In the Settings For: drop-down list, choose one of the MinCRT
<PRE>   configurations.
</PRE></OL>3. On the Link tab, choose the Output category.
4. Remove the text in the Entry-point symbol edit box.
<P>
<P><h3>ATLBUTTON Sample Returns Incorrect Property Values</h3>
 
<P>
The ATLBUTTON sample returns incorrect values for the properties ImageHover
and ImagePush. To correct the sample change the file AtlButton.h so that
the function get_ImageHover uses m_bstrFilename[1].Copy() and change
get_ImagePush so that it uses m_bstrFilename[2].Copy().
<P>
<P><h3>ATL POLYGON Sample Does Not Build in Release Mode</h3>
 
<P>
If you copy the ATL POLYGON sample from the online documentation, it will
not build in Release mode as it incorrectly defines the _ATL_MIN_CRT macro.
The sample on the disc does not have this problem. (Disc 1 if you purchased
Visual C++; Disc 3 if you purchased Visual Studio.)
<P>
Workaround

<OL><P><LI>Select the Settings command from the Project menu
</OL>2. Choose the C/C++ tab. In the General category, remove _ATL_MIN_CRT from
<PRE>   the Preprocessor definitions edit box. 3.Choose the Link tab. In the
   Output Category, remove DllMain from the Entry-point symbol edit box.

</PRE></OL><h3>Link Error in Debug Build of COM Sample acdual/mfcctrl</h3>
 
<P>
This sample will fail under debug builds looking for comsuppd.lib. To fix
the problem, go into the Project Settings dialog box and remove
_COM_DEBUG from the Preprocessor definitions box in the C/C++ Preprocessor
section.
<P>
<P><h3>Typo in tan and tanh Sample</h3>
 
<P>
In the documentation of tan and tanh, there is a typo in the sample. The
current sample shows:
<P>
<PRE>   printf( "tan( %f ) = %f\n", x, y );
   printf( "tanh( %f ) = %f\n", y, x );

</PRE>It should be:
<P>
<PRE>   printf( "tan( %f ) = %f\n", pi/4, x );
   printf( "tanh( %f ) = %f\n", x, y );

</PRE>The correct output is:
<P>
<PRE>   tan( 0.785398 ) =  1.000000
   tanh( 1.000000 ) = 0.761594

</PRE>See both the \DEVSTUDIO\VC\SAMPLES and the \OLEDB\SAMPLES directories on
the first Visual C++ CD.
<P>
<P><h3>BINDENRL Sample Fails to Copy STDREG32.MDB</h3>
 
<P>
To build the BINDENRL sample, you'll need to manually copy the database
file stdreg32.mdb into the same local directory that you copy the samples
source files. You will find stdreg32.mdb in the
DEVSTUDIO\VC\Samples\mcl\mfc\database\daoenrol directory. This directory is
on the disc that includes "Microsoft Visual C++" on the label. (Disc 1 if
you purchased Visual C++; Disc 3 if you purchased Visual Studio.)
<P>
<P><h3>Access Violation in Visual Basic 5.0 When Running COMEXCEL Sample</h3>
 
<P>
If you get an access violation while running the COMEXCEL sample in Visual
Basic 5.0 under Windows NT V4.0, please install the Windows NT Service
Pack 2.
<P>
<P><h3>Running OLE SDK Samples</h3>
 
<P>
Before you run an OLE SDK sample, you should first copy the following
subdirectories from the first VC++ product CD
<P>
<PRE>   DevStudio\VC\Samples\SDK\ole\include
   DevStudio\VC\Samples\SDK\ole\lib

</PRE>to the following subdirectories on the disk (in this case c:) that will
hold the OLE samples
<P>
<PRE>   c:\samples\ole\include
   c:\samples\ole\lib

</PRE>You can now install the sample files in any directory on the disk (in this
case c:) and compilation will find the include and lib directories. If you
have an MSTOOLS environment variable defined, you should put the include
and lib directories in the following location on your hard disk: MSTOOLS
path\samples.
<P>
<P><h3>Running InOLE2 SDK Samples</h3>
 
<P>
Before you run an InOLE2 SDK sample, you should first copy the following
subdirectories from the first VC++ product CD
<P>
<PRE>   DevStudio\VC\Samples\SDK\ole\inole2\inc
   DevStudio\VC\Samples\SDK\ole\inole2\lib

</PRE>to the following subdirectories on the disk (in this case c:) that will
hold the OLE samples
<P>
<PRE>   c:\samples\ole\inole2\inc
   c:\samples\ole\inole2\lib

</PRE>You can now install the sample files in any directory on the disk (in this
case c:) and compilation will find the inc and lib directories. If you have
an MSTOOLS environment variable defined, you should put the inc and lib
directories in the following location on your hard disk: MSTOOLS
path\samples.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbtlc<BR>
Technology          : kbatl<BR>
Version             : 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbreadme<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
