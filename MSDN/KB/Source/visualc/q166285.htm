

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: MSDEV Crashes When Converting VC++ 4.0 Projects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166285">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/04/02">
<META NAME="Keywords" CONTENT="vcbuglist500 VwbIss VS97FixlistSP3 kbtool VS97FixlistSP2 VS97FixlistSP1">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you convert a Visual C++ 4.x project, the following error messages may appear:  On Windows NT 4.0:      MSDEV.EXE - Application Error     The instruction at :0x00000004  referenced memory at  0x00000004 . The     memory could not be read.  Aft...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAFI,QA56,QA55,QAUJ,QAB4,QBFY,QAGX,QAJN,QDKA,QBE7,QBE6,QAH4,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: MSDEV Crashes When Converting VC++ 4.0 Projects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166285</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you convert a Visual C++ 4.x project, the following error messages may
appear:
<P>
On Windows NT 4.0:
<P>
<PRE>    MSDEV.EXE - Application Error
    The instruction at :0x00000004" referenced memory at "0x00000004". The
    memory could not be read.

</PRE>After selecting OK you may get the following error:
<P>
<PRE>    MSDEV.EXE - Application Error
    The instruction at :0x5f402181" referenced memory at "0x00000004". The
    memory could not be read.

</PRE>On Windows 95:
<P>
<PRE>    This program has performed an illegal operation and will be shut down.
    Details shows:
      MSDEV caused an invalid page fault in module &lt;unknown&gt; at
      00de:00000009

</PRE>After selecting OK you get the following error:
<P>
<PRE>    This program has performed an illegal operation and will be shut down.
    Details shows:
      MSDEV caused an invalid page fault in module &lt;unknown&gt; at
      0137:5f402181

</PRE>-or-
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   Details shows:
     MSDEV caused an invalid page fault in module SSSCC.DLL at
     0137:48248c18.

</PRE>Note that in both cases the address in the first message may vary, but the
second one will be consistent.
<P>
<P><h2>CAUSE</h2>
 
<P>
There are two cases that will reproduce this problem:
<P>
<P><h3>Case 1</h3>
 
<P>
Projects that are missing a top-level project in the directory where the
.MDP and .MAK files are located crash.
<P>
<P><h3>Case 2</h3>
 
<P>
Projects for which the .MDP and .MAK files have been renamed and have a
subdirectory with the same name as the upper-level original project.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Steps to Reproduce Case 1</h3>
 

<OL><P><LI>In Visual C++ 4.0, create a workspace called Test of the Application
   type.

<P><LI>Insert a top-level project called Top of any type.

<P><LI>Using the Build|Configurations menu, remove the Test project and then
   close the project.

<P><LI>In Visual C++ 5.0, open the Test workspace's Test.mdp file. Visual C++
   5.0 converts the project. MSDEV crashes and the error messages noted
   above appear.
<P>
</OL><h3>Resolution for Case 1</h3>
 

<OL><P><LI>Under the Test directory which was created for the Test workspace there
   is a "Top" subdirectory. Rename this the "Top" subdirectory to "x" (any
   name is acceptable).

<P><LI>In Visual C++ 5.0, open the Test workspace's Test.mdp file. Visual C++
   5.0 converts the project.

<P><LI>Rename the "x" subdirectory to the original name and the project will
   work as expected.
<P>
</OL>In the general case, you may have several projects. Renaming any one of the
subdirectories as shown above will work around this bug.
<P>
<P><h3>Steps to Reproduce Case 2</h3>
 

<OL><P><LI>In Visual C++ 4.0, create a workspace called Test of the Application
   type. It should be located in the Test directory.

<P><LI>Insert a subproject of any type called Sub.

<P><LI>Close the workspace.

<P><LI>In the Test directory, rename Test.m?? to foo.*

<P><LI>Create a subdirectory called Test\Test.

<P><LI>In Visual C++ 5.0 open foo.mdp. MSDEV crashes and the error messages
   noted above appear.
<P>
</OL><h3>Resolution of Case 2</h3>
 

<OL><P><LI>Rename the Test\Test subdirectory to Test\[anything].

<P><LI>Convert the project using Visual C++ 5.0. Now you can restore the
   subdirectory name to Test\Test.
<P>
</OL>Please note that for case 2 the upper-level directory name is of no
consequence. What is important is that there is a subdirectory with the
same name as the original project name.
<P>
These scenarios apply to all versions of Visual C++ 4.x.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Visual
Studio 97 Service Pack 1.
<P>
For additional information about the Visual Studio 97 Service Pack 1,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VSTUDIO/Q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: gpf ipf av<BR>
Keywords          : vcbuglist500 VwbIss VS97FixlistSP3 kbtool VS97FixlistSP2 VS97FixlistSP1<BR>
Version           : 5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
