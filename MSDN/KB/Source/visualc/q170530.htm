

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: AppWizard Project Cannot Open Include File .RC2 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170530">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1997/06/23">
<META NAME="Keywords" CONTENT="vcbuglist500 WizardIss kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you build an AppWizard-generated project, the resource compiler reports the following error if the default code page is anything other than 1252 (for example, you have an Eastern European or Asian system locale):                         (118) ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QBWI,QANY,QAIM,QAJN,QBWS,QBFY,QA56,QA55,QABB,QAH4,QABA,QBJZ,QAKP,QAG0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: AppWizard Project Cannot Open Include File .RC2</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170530</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The AppWizard included with:
   - Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you build an AppWizard-generated project, the resource compiler
reports the following error if the default code page is anything other than
1252 (for example, you have an Eastern European or Asian system locale):
<P>
<PRE>   &lt;project\project.rc&gt;(118) : fatal error RC1015: cannot open include file
   'res\\XXXXXXX.rc2'.

</PRE>This error only occurs when the project name contains characters greater
than 0x7F hex.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Resource Script for the project that AppWizard generates is hard-coded
to specify the code page as 1252 and the language as US English. When the
Resource Compiler attempts to load an RC2 file with a name that has
characters greater than 0x7F hex, but the code page 1252 has been
specified, the Resource Compiler will not be able to open the RC2 file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, do the following in the project's .RC file:

<UL><LI>Replace all references to code_page(1252) with the proper code_page.
<LI>Replace all references to "Language 9,1" with the proper language,
   sub-language code pair.
<P>
</UL>There are three places in a typical RC file to change these values:

<OL><P><LI>In the TEXTINCLUDE section, TEXTINCLUDE 3 has a reference to the
   code_page and Language:
<P>
<P><PRE>      3 TEXTINCLUDE DISCARDABLE
      BEGIN
<PRE></PRE>          "#define _AFX_NO_SPLITTER_RESOURCES\r\n"
          "#define _AFX_NO_OLE_RESOURCES\r\n"
          "#define _AFX_NO_TRACKER_RESOURCES\r\n"
          "#define _AFX_NO_PROPERTY_RESOURCES\r\n"
         "\r\n"
         "#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_ENU)\r\n"
         "#ifdef _WIN32\r\n"
         "LANGUAGE 9, 1\r\n"
         "#pragma code_page(1252)\r\n"
         "#endif\r\n"
         "#include ""res\\appwizdll.rc2"" // Non-Microsoft Visual C++
                                          // edited.
              "\r\n"
         "#include ""afxres.rc""    // Standard components\r\n"
         "#endif"
          "\0"
      END

</PRE><P><LI>Immediately after the TEXTINCLUDE section, a set of preprocessor
   definitions has a reference to the code_page and Language:
<P>
<P><PRE>      #if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_ENU)
      #ifdef _WIN32
      LANGUAGE 9, 1
      #pragma code_page(1252)
      #endif
</PRE>
<P><LI>At the end of the .RC file, there is a last set of preprocessor
   definitions with a reference to the code_page and Language:
<P>
<P><PRE>      #if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_ENU)
      #ifdef _WIN32
      LANGUAGE 9, 1
      #pragma code_page(1252)
      #endif
      #include "res\\appwizdll.rc2"  // Non-Microsoft Visual C++ edited
<PRE></PRE>                                     // resources.
      #include "afxres.rc"    // Standard components
      #endif

</PRE></OL>To make these changes, open the project's .RC file clicking Open on the
File menu and selecting an Open As type of "Text" instead of "Auto." Visual
C++ will close the resource editor if it is open for this project.
<P>
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
 
<PRE>Keywords          : vcbuglist500 WizardIss kbtool
Version           : 5.0
Platform          : NT WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
