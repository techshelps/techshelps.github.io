

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: Port I/O with inp() and outp() Fails on Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112298">
<META NAME="KBModify" CONTENT="1996/01/19">
<META NAME="KBCreate" CONTENT="1994/03/06">
<META NAME="Keywords" CONTENT="kbprg kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Attempting to use the port I/O (input/output) functions such as inp() and outp() from within an application for Windows NT running in user mode causes a privileged instruction exception to occur. The sample code provided in the OUTP.C online help s...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAY5,QBV8,QAB9,QAH4,QA5W,QDJP,QAKG,QATS,QASR,QAGU,QAGI,QBFY,QAPF,QA6E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: Port I/O with inp() and outp() Fails on Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112298</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>The C Run-time (CRT), included with:
   Microsoft Visual C++ 32-bit Edition, versions 1.0 and 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Attempting to use the port I/O (input/output) functions such as inp() and
outp() from within an application for Windows NT running in user mode
causes a privileged instruction exception to occur. The sample code
provided in the OUTP.C online help sample for the outp() function and
related functions can be used to illustrate this behavior.
<P>
The documentation regarding the compatibility of the port I/O functions is
incomplete. Win32-based applications that call inp(), outp(), and so forth
can be successfully compiled and linked. However, these applications will
generate the privileged instruction exception because the port I/O
functions cannot be called from code running in user mode.
<P>
Do not call the following functions from within a Win32-based application
executing in user mode:
<P>
<PRE>    _inp()
    _inpw()
    _inpd()
    _outp()
    _outpw()
    _outpd()

</PRE>NOTE: This documentation error has been corrected for the Visual C++ 4.0
Books Online. The descriptions of the various port I/O functions do not
list "Win NT" in the Compatibility section.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
According to the documentation provided with Visual C++ 32-bit Edition,
inp(), outp(), and the other port I/O related functions are Win32 and
Win32s compatible. However, executing code that uses these functions
causes a privileged instruction exception on Win32 on Windows NT. The code
that uses inp(), outp(), and so forth will execute correctly on Win32s.
<P>
The inp(), outp(), and other I/O port related functions map to privileged
processor instructions. For example, on Intel processors, the inp() and
outp() functions end up calling the IN and OUT instructions. The privileged
instruction exception occurs when these instructions are executed because
typical Windows NT applications execute in a nonprivileged (user) mode.
Only code executing in kernel mode has the necessary rights to execute
privileged instructions. Kernel mode code is typically found in device
drivers.
<P>
For more information on user mode and kernel mode in Windows NT, refer to
the Microsoft Press book "Inside Windows NT" by Helen Custer. For an
example of a kernel mode Windows NT device driver that allows user mode
applications to access hardware ports, refer to the GENPORT sample provided
with the Microsoft Windows NT Device Driver Kit (DDK).
<P>
<P><h2>REFERENCES</h2>
 
<P>
The Online help for _inp, _inpw, _inpd, _outp, _outpw, and _outpd.
The Microsoft Press book "Inside Windows NT" by Helen Custer.
The Microsoft Press book "Microsoft s 80386/80486 Programming Guide"
by Ross P. Nelson.
The "Kernel-Mode Device Driver Guide" provided with the Microsoft
Windows NT DDK.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 noupdate<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: CRTIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
