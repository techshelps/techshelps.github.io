

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: SQL_DRIVER_NOPROMPT Error in IIS 4.0 ISAPI Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181434">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1998/02/19">
<META NAME="Keywords" CONTENT="MfcDatabase">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  An ISAPI extension running under IIS 4.0 gives the following error when CDatabase::Open is called to open a database connection in an ODBC data source:     Only SQL_DRIVER_NOPROMPT is allowed when connection pooling is enabled  RESOLUTION  Use the ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QBWS,QAI5,QAB4,QBTX,QABI,QBV8,QBG2,QAY5,QAYY,QALZ,QAGI,QAAP,QABA,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SQL_DRIVER_NOPROMPT Error in IIS 4.0 ISAPI Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181434</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An ISAPI extension running under IIS 4.0 gives the following error when
CDatabase::Open is called to open a database connection in an ODBC data
source:
<P>
<PRE>   Only SQL_DRIVER_NOPROMPT is allowed when connection pooling is enabled

</PRE><h2>RESOLUTION</h2>
 
<P>
Use the CDatabase::OpenEx function and specify the noOdbcDialog option to
open your database connections.
<P>
<PRE>   CDatabase db;
   db.OpenEx(_T("DSN=myDS;UID=myID;PWD=myPWD;"), CDatabase::noOdbcDialog);

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SQL_DRIVER_NOPROMPT flag instructs ODBC to connect with the information
passed in the connect string and to avoid displaying a login dialog box at
run time.
<P>
CDatabase::OpenEx() with the noOdbcDialog option calls SQLDriverConnect
with the SQL_DRIVER_NOPROMPT flag. Using the CDatabase::Open function
causes MFC to use SQL_DRIVER_COMPLETE instead of SQL_DRIVER_NOPROMPT.
<P>
NOTE: Make sure you are using a "System DSN" and not a "User DSN" with an
ISAPI application. The process for creating a System DSN is identical to
that for creating a regular data source. Open the 32-bit ODBC Administrator
(in the Control Panel) and click the System DSN tab, then click Add to
create a System DataSources.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Refer to the Visual C++ online help for a complete description of the
OpenEx function.
<P>
For additional information and tips on using ISAPI and MFC ODBC, please see
the following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q160906.htm">Q160906</A></B>
   TITLE     : HOWTO: Use MFC 4.2 ODBC Classes in an ISAPI DLL

</PRE> 
<PRE>Keywords          : MfcDatabase
Technology        : odbc
Version           : WINNT:5.0
Platform          : winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
