

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Create Additional Views with CreateNewFrame() Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100993">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1993/07/01">
<META NAME="Keywords" CONTENT="kbprg MfcDocView kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The CDocTemplate::CreateNewFrame() function creates additional views of a document in a multiple document interface (MDI) application written using the Microsoft Foundation Class Library. The prototype of the CreateNewFrame() function is as follows...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QADK,QAY5,QAIB,QAIA,QAGI,QBV8,QAB9,QAHT,QBWT,QAIC,QBBI,QAPF,QBXR,QBHQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Create Additional Views with CreateNewFrame() Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100993</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
   - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
   - Microsoft Visual C++ 32-bit Edition, version 1.0, 2.0, 2.1,
<P><PRE>     4.0, 4.1, 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The CDocTemplate::CreateNewFrame() function creates additional views
of a document in a multiple document interface (MDI) application
written using the Microsoft Foundation Class Library. The prototype of
the CreateNewFrame() function is as follows:
<P>
<PRE>      CFrameWnd * CDocTemplate::CreateNewFrame(CDocument *, CFrameWnd *)

</PRE>To call this function, specify a pointer to a CDocument object (the
document for which the function will create a view) and a pointer to a
frame window that has properties to duplicate. Typically, the second
parameter of the function is NULL.
<P>
When an application calls CreateNewFrame(), the function creates a new
frame window and a view in the frame window. The frame window type and
view type depend on the document template (CDocTemplate) associated
with the document specified in the CreateNewFrame() call.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To better understand how to use CreateNewFrame(), it might be useful
to review two examples.
<P>
The first example is the WINMDI.CPP file in the Microsoft Foundation
Class Library source code. WINMDI.CPP defines the function
CMIDFrameWnd::OnWindowNew() that calls CreateNewFrame() to add an
additional frame and view for a specified document. The application
calls OnWindowNew() each time the user selects New from the MDI
application's Windows menu.
<P>
The OnWindowNew() function contains two significant lines of code, as
follows:
<P>
<PRE>      CFrameWnd * pFrame =
            pTemplate-&gt;CreateNewFrame(pDocument, pActiveChild);
      pTemplate-&gt;InitialUpdateFrame(pFrame, pDocument);

</PRE>This code creates and displays the new frame window and document view.
<P>
The other example is the DOCMULTI.CPP file, also in the Microsoft
Foundation Class Library source code. The
CMultiDocTemplate::OpenDocumentFile() function includes the following
code:
<P>
<PRE>      CFrameWnd * pFrame = CreateNewFrame(pDocument, NULL);

</PRE>Note that the second parameter is NULL because the design of the
OpenDocumentFile() function assumes that the programmer is not
interested in duplicating any of the other frames that contain views
of this document.
<P>
The CHKBOOK sample also demonstrates creating additional frames and
views for documents. In CHKBOOK.CPP, the
CChkBookApp::OpenDocumentFile() function includes the following code:
<P>
<PRE>      CChkBookDoc * pDoc =
            (CChkBookDoc*)CWinApp::OpenDocumentFile(lpszFileName);

      if (pDoc == NULL)
             return NULL;

      CMDIChildWnd * pframe =
            ((CMDIFrameWnd *)AfxGetApp()-&gt;m_pMainWnd)-&gt;MDIGetActive();

      CFrameWnd * pNewFrame =
            m_pCheckViewTemplate-&gt;CreateNewFrame(pDoc, NULL);
      if (pNewFrame == NULL)
         return pDoc;
      m_pCheckViewTemplate-&gt;InitialUpdateFrame(pNewFrame, pDoc);

</PRE>Here are two points to consider when you use the CreateNewFrame():

<UL><LI>The source code for CDocTemplate::CreateNewFrame() is in
   DOCTEMPL.CPP. It includes the following code:
<P>
<P><PRE>      if (!pFrame-&gt;LoadFrame(m_nIDResource,
<PRE></PRE>           WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE, // default frame styles
           NULL, &amp;context)

   Because this code creates the frame window with a NULL parent
   window, the Microsoft Foundation Class Library uses the
   application's main window as the parent window.

</PRE><LI>CreateNewFrame() creates both a frame and a view; not only a view.
<P>
</UL>If, for some reason, CreateNewFrame() does not quite address your
situation, the source code for CreateNewFrame() is quite useful to
demonstrate the steps required to create frames and views.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: change view<BR>
Keywords            : kbprg MfcDocView kbhowto<BR>
Technology          : kbMfc<BR>
Version             : 1.00 1.51 2.0 4.0 4.1 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
