

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE: Illustrates Multithreaded Programming Techniques </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108433">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1993/12/12">
<META NAME="Keywords" CONTENT="CRTIss kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The MTDLL sample illustrates several techniques and concepts related to multithreaded programming in Win32. The sample uses a multithreaded dynamic-link library (DLL) to implement six sorting algorithms. The DLL is called into from a Microsoft Foun...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QA01,QBWP,QAY2,QAB5,QAGI,QDNN,QAB6,QBFY,QBHQ,QAFI,QBXB,QBC9,QBC8,QA3P V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Illustrates Multithreaded Programming Techniques</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108433</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT) included with:
   - Microsoft Visual C++ 32-bit Edition, versions 1.0, 2.0, 2.1, 4.0, 4.1,
<P><PRE>     5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MTDLL sample illustrates several techniques and concepts related to
multithreaded programming in Win32. The sample uses a multithreaded
dynamic-link library (DLL) to implement six sorting algorithms. The DLL is
called into from a Microsoft Foundation Class (MFC) Libraries application
that uses a dialog box as the main window. The six sorting algorithms
implemented are the Bubble sort, Exchange sort, Heap sort, Insertion sort,
Quick sort, and Shell sort.
<P>
NOTE: The sample code has been built using the Visual C++ version 2.0. If
you are using newer versions 4.0 or 4.1 you will need to convert the
project files to Developer Studio projects. All you need to do is to open a
workspace specifying SORTDEMO.MAK and SORTDLL.MAK file. The Developer
Studio will pop up a message box prompting you for the project name and it
will do a conversion for you.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Mtdll.exe">Mtdll.exe</A> <I>(size: 64311 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Some of the multithreaded concepts and techniques illustrated by the sample
are:

<UL><LI>Conditionally using __declspec(dllexport) and __declspec(dllimport)
   on function prototypes that reside in a header file that is included
   in both the DLL and the calling application.

<LI>Using  __declspec(thread) to allocate thread-local data.

<LI>Using a critical section object to control access to the display.

<LI>Handling termination of a currently executing thread.

<LI>Using _beginthread() and _endthread() to handle thread creation and
   termination.
<P>
</UL>The calling executable and the sorting DLL in this sample also use mutual
imports. That is, the executable calls routines that have been exported
from the DLL, and the DLL calls routines that have been exported from the
executable. The sample includes the import libraries needed to build both
the DLL and the calling executable. However, if the sample is modified and
additional functions are exported from both the executable and the DLL, the
mutual imports could make it impossible to build either the DLL or the
executable, because one must be built before the other. This situation can
be worked around by using the LIB utility with the /DEF option to build an
import library from a linker .DEF file. This technique is discussed in
Chapter 4 of the "Programming Techniques" manual and Chapter 3 of the
"Build Tools User's Guide" supplied with Visual C++ for Windows NT.
<P>
This sample does not use .DEF files to specify exported functions. It
illustrates using __declspec instead. However, the sample does include .DEF
files for the DLL and the executable, which can be used as starting points
if at some point the LIB utility needs to be used with the /DEF option to
solve the problem of mutual imports.
<P>
This sample also uses CTL3D32.DLL to implement a 3-D look for its dialog
box controls. For CTL3D32.DLL to work, however, it must be copied from the
multithreaded DLL sample directory to the Windows NT SYSTEM32 subdirectory,
for example C:\WINNT\SYSTEM32. After copying the DLL, it must be deleted
from the multithreaded DLL sample directory. If CTL3D32.DLL is not copied
to the \WINNT\SYSTEM32 directory and deleted from the multithreaded DLL
sample directory, a message box with the following error will be displayed
when the sample is run:
<P>
<PRE>   This application uses CTL3D32.DLL, which has not been correctly
   installed.

</PRE>After choosing OK to dismiss the message box, the main dialog box of the
sample is displayed but it uses a white background and none of the dialog
box controls will be 3-D.
 
<PRE>Keywords          : CRTIss kbfasttip
Version           : WINDOWS NT:1.0,2.0,2.1,4.0,4.1,5.0;
Platform          : NT WINDOWS
Issue type        : kbfile</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
