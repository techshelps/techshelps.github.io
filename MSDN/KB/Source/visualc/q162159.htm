

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SAMPLE:TREESCRL Scrolls in a Tree Control During Drag-and-Drop </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162159">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1997/01/14">
<META NAME="Keywords" CONTENT="kbcode kbfile kbsample kbui MfcUI">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  A TreeView control is one capable of displaying items in a tree-like hierarchical fashion. The control supports drag-and-drop. When an item is dragged to the top or bottom of the control, the control does not automatically scroll vertically.  Trees...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QBXQ,QAMR,QA9P,QADK,QA9N,QAIB,QAY0,QAPF,QAU3,QAFI,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE:TREESCRL Scrolls in a Tree Control During Drag-and-Drop</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162159</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2,
<P><PRE>     4.0, 4.1, 4.2
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A TreeView control is one capable of displaying items in a tree-like
hierarchical fashion. The control supports drag-and-drop. When an item is
dragged to the top or bottom of the control, the control does not
automatically scroll vertically.
<P>
Treescrl.exe shows how to add scrolling functionality to a tree control
during drag-and-drop.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Treescra.exe">Treescra.exe</A> <I>(size: 73991 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
TREESCRL uses the CTreeView view class that encapsulates the functionality
of a view and a tree control. The sample's drag-and-drop functionality is
similar to the one demonstrated in CMNCTRLS, a sample shipped with the
Visual C++ product. When TREESCRL is built and run, an SDI window with a
CTreeView comes up. When you grab a tree control item (parent or child),
and drag it above/below the top/bottom of the view window, the tree control
starts scrolling upward/downward.
<P>
The idea behind TREESCRL is to install a timer when a drag-and-drop
operation starts. In the handler for the WM_TIMER message, it is first
determined if scrolling is needed. If it is, then the appropriate scroll
message is sent to the control. When the drag-and-drop operation
terminates, the timer is killed. The sample shows how to draw the drag
image and how to select the drop site during the dragging phase.
<P>
The tree control can scroll in different modes. During the drag phase, when
the mouse cursor is close to the top or the bottom border of the view,
scrolling is slow. The control scrolls at this slow speed when the
horizontal distance between the mouse and the corresponding view border
(top/bottom) is less than the width of a horizontal scrollbar. Scrolling
speeds up when the mouse is taken further away from either border.
<P>
SLOWSCROLL_FREQUENCY is a macro symbol in the view's .cpp file. This symbol
determines the relative speeds of normal and slow scrolling. Normal
scrolling occurs approximately every 75 milliseconds (the frequency of the
timer). In the sample, SLOWSCROLL_FREQUENCY is defined to be three (3),
which means slow scrolling is three times slower than normal scrolling. To
change the slow scrolling speed, modify this value to a positive integer.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbcode kbfile kbsample kbui MfcUI<BR>
Technology          : kbMfc<BR>
Version             : 2.0 2.1 2.2 4.0 4.1 4.2<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
