

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Visual C++ 4.0 or 4.1 Setup Fails to Copy Shared DLLs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148882">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1996/03/25">
<META NAME="Keywords" CONTENT="vc40setup kbenv kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you install Visual C++ 4.x in either Windows 95 or Windows NT, it is possible for setup to fail while copying certain shared DLLs. The DLLs that don't copy successfully will most likely be one of these:     MSVCRT20.DLL   MSVCRT40.DLL    ODBCC...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QABI,QDIZ,QBFY,QA56,QA55,QAGB,QBWS,QDL9,QBWQ,QBWO,QBWN,QBWP,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual C++ 4.0 or 4.1 Setup Fails to Copy Shared DLLs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148882</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Visual C++ Setup included with:
   - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you install Visual C++ 4.x in either Windows 95 or Windows NT, it is
possible for setup to fail while copying certain shared DLLs. The DLLs that
don't copy successfully will most likely be one of these:
<P>
<PRE>   MSVCRT20.DLL   MSVCRT40.DLL
   ODBCCP32.DLL   ODBC32.DLL    ODBCINT.DLL

</PRE>When setup fails, it displays a dialog box that looks similar to this:
<P>
<PRE>   Setup cannot open the destination file
   'C:\Windows\System\Msvcrt20.dll'. The file may be in use by
   another application, or marked read-only. Close the application
   or change the file's read-only attribute and try again.

   -or-

   Cannot install file C:\Windows\System\Odbc32.dll. It might be
   in use. Try closing all applications and choosing Retry.

</PRE>Both dialog boxes offer a chance to Abort, Retry, or Ignore.
<P>
<P><h2>CAUSE</h2>
 
<P>
Many applications use shared DLLs. If the setup program tries to copy a DLL
over another DLL that has the same name while that DLL is in use by another
program, the setup program will fail.
<P>
For example, the Windows 95 Explorer uses Msvcrt20.dll, so if the Explorer
is not closed before running Visual C++ 4.x setup, you could see the
problem. You may also see the problem when running The Internet Information
Server as it also uses some of these DLLs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Here are several possible resolutions:

<OL><P><LI>The best resolution is to make sure no other applications are running
   when you install Visual C++ 4.x. To do this, close all applications, and
   check the task list to make sure nothing is running. Under Windows 95,
   you can make sure other processes are not running by restarting your
   computer; hold down the SHIFT key as Windows 95 restarts to bypass the
   startup group.

<P><LI>An additional workaround is to start Visual C++ Setup in the following
   manner:
<P>
   Under Windows 95:
<P>
<P><PRE>      Close all applications including Explorer. Run setup from an MS-DOS
      window. If you are installing from the network, map to that drive.
</PRE><P>
   Under Windows NT 3.51:
<P>
<P><PRE>      Close all applications. Run setup from File Manager or a DOS window.
</PRE>
<P><LI>If all applications are closed, but the error still occurs, make sure
   that you close the Master Setup window; it uses Msvcrt20.dll.

<P><LI>If the problem persists, it is generally safe to click Ignore, and
   continue with the installation. However, remember to manually copy the
   files from the Visual C++ CD-ROM that failed to copy during the setup.

<P><LI>Another slightly riskier way to work around the problem is to rename
   the offending DLL from the system directory. Once the installation
   completes, restart your computer to cause the new version to be loaded.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
 
<PRE>Keywords          : vc40setup kbenv kbsetup
Version           : 4.0 4.1
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
