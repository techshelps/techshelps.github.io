

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Dialog in InitInstance Doesn't Process WM_DDE_INITIATE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173261">
<META NAME="KBModify" CONTENT="1997/09/12">
<META NAME="KBCreate" CONTENT="1997/08/28">
<META NAME="Keywords" CONTENT="MfcMisc">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you try to start an application that contains a modal dialog function, such as CDialog::DoModal, AfxMessageBox, or MessageBox, that is called from the CWinApp derived class' InitInstance function by double-clicking on the application from the ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QAY2,QAJH,QAY5,QAGI,QAIJ,QBIC,QAUR,QAGU,QBWS,QABI,QBWP,QBVV,QAU7,QAH5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Dialog in InitInstance Doesn't Process WM_DDE_INITIATE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173261</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Editions, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.1, 4.2, 5.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to start an application that contains a modal dialog function,
such as CDialog::DoModal, AfxMessageBox, or MessageBox, that is called from
the CWinApp derived class' InitInstance function by double-clicking on the
application from the Windows 95 Explorer, selecting the saved document from
the Start Menu or double-clicking on it from File Manager, one of the
following may happen:

<OL><P><LI>It may work fine if built with Visual C 2.x running under Windows NT
   3.5x and later.
<P>
</OL>-or-

<OL><P><LI>The dialog or message box may come up, but the application's main
   window may not come up, and the process is now hung, and can only be
   terminated by PVIEW.
<P>
</OL>-or-

<OL><P><LI>The following error message box may be displayed:
<P>
<P><PRE>      Cannot find the file &lt;path\filename&gt; (or one of its components).
      Make sure the path and filename are correct and that all required
      libraries are available.
</PRE><P>
<P><PRE>    And, symptom number 2 may also occur.
</PRE><P>
</OL><h2>CAUSE</h2>
 
<P>
When you launch an application in File Manager or Windows Explorer, a
WM_DDE_INITIATE is supposed to be handled by the CWinApp and CFrameWnd
OnDDEIntitiate handlers. A call to CDialog::DoModal, AfxMessageBox, or
MessageBox interferes with the ability for the MFC framework to handle
these messages correctly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
It has been determined that this behavior is by design and that it is not
recommended to place any of these calls within the CWinApp::InitInstance.
Any password dialogs or dialog based components which need to be displayed
in the InitInstance should be of the modeless type.  This does not apply to
a dialog based application or an SDI application.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create an AppWizard Multiple Document Application, specifying a file
   extension to associate with the application.

<P><LI>Call a modal dialog function such as CDialog::DoModal, AfxMessageBox,
   or MessageBox from the CWinApp derived class' InitInstance function.

<P><LI>Run the application, dismiss the dialog or message box, and save the
   document.

<P><LI>Start the application by:
<P>
   - Double-clicking on the application from the Windows 95 Explorer.
<P>
   -or-
<P>
   - Selecting the saved document from the Start Menu
<P>
   -or-
<P>
   - Double-clicking on the application from File Manager.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For related information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q172336.htm">Q172336</A></B>
   TITLE     : PRB: Assertion Launching Program with Tip of Day &amp; Splash
                    Screen
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: explorer start file manager<BR>
Keywords          : MfcMisc<BR>
Technology        : kbMfc<BR>
Version           : WINDOWS NT:2.0,2.1,2.2,4.0,4.1,4.2,5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
