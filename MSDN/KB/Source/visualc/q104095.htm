

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: HANDLER Sample Builds but Does Not Work Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104095">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1993/09/07">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  There are three problems related to the HANDLER sample supplied with Microsoft Visual C++ version 1.0. Only two of the following problems apply to Visual C++ version 1.5:   - The test program is called DEMO in the online help file for the    Window...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QAJN,QA56,QA55,QAPF,QABI,QBVV,QAG0,QAKP,QDL9,QBXS,QBWQ,QBWO,QBWN,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: HANDLER Sample Builds but Does Not Work Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104095</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbtool kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
There are three problems related to the HANDLER sample supplied with
Microsoft Visual C++ version 1.0. Only two of the following problems apply
to Visual C++ version 1.5:

<UL><LI>The test program is called DEMO in the online help file for the
   Windows Software Development Kit (SDK) Samples (SAMPLES.HLP). The
   actual name is HANDTEST.

<LI>There are no Visual Workbench (VWB) project files supplied for
   either HANDTEST.EXE or HANDLER.DLL. This problem was corrected in Visual
   C++ version 1.5.

<LI>If built with the supplied NMAKE makefile or through VWB, the sample
   builds without errors but does not actually count keystrokes as it
   should.
<P>
</UL><h2>CAUSE</h2>
 
<P>
The last problem occurs because the assembly module contains a WEP()
procedure rather than a _WEP() procedure. Visual C++ normally links a
default WEP() procedure into a dynamic-link library (DLL). If you need
to perform specialized cleanup (such as the cleanup required by this
sample), you must write a function named _WEP(), which is called
automatically by the C run-time WEP().
<P>
For more information, refer to pages 119-120 of the Visual C++
"Programming Techniques" manual, or pages 27-28 of the C/C++ version
7.0 "Update" manual.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you have Microsoft Macro Assembler (MASM) version 5.1 or 6.x, the
procedure for correcting the problem and building a new HANDLER.OBJ is
described below. Creation of the needed project files is also
described below.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the products listed at the
beginning of this article. We are researching this bug and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create the needed project files within the Visual Workbench, use
the steps below.
<P>
NOTE: To rebuild HANDLER.OBJ yourself requires a copy of MASM version
5.1 or later. The following steps are required:

<OL><P><LI>Open HANDLER.ASM in an editor (VWB will work). Replace WEP with
    _WEP each place it occurs in the file (there are five occurrences).
    WEP must be capitalized. Save the file.

<P><LI>Make sure that you have MSVC\INCLUDE in your INCLUDE environment
    setting. HANDLER.ASM includes a header file named WINDOWS.INC,
    which is not available in the MASM INCLUDE directory.

<P><LI>Assemble the file with the command:
<P>
       MASM /Zi HANDLER.ASM
<P>
    If you are using MASM 6.1x and did not install the MASM utility (for
    compatibility with MASM 5.1), you can use the following command:
<P>
       ML /Zi /c /Zm HANDLER.ASM

<P><LI>From the VWB main menu, select Project. Choose New from the menu.

<P><LI>Choose the Browse button and ensure that you are in the correct
    directory (MSVC\SAMPLES\HANDLER). Enter the Project Name as
    HANDLER.MAK. Choose OK.

<P><LI>Select Windows dynamic-link library (.DLL) as the Project Type. If
    Use Microsoft Foundation Classes is checked, clear the check box.
    Choose OK.

<P><LI>Add the following files to the project:
<P>
       HANDLER.OBJ
       HANDLER.DEF

<P><LI>Build this project. The browse build step will give an error
    message because there is no source for this module. You can avoid
    this by turning off the browse option, but it is not necessary.
    HANDLER must be built before you can create the HANDTEST project
    because HANDLER.LIB is needed for that project.

<P><LI>Repeat steps 1 and 2 but use HANDTEST.MAK as the Project Name.
    Select Windows-based application (.EXE) as the Project Type. Add the
    following files to the project:
<P>
       HANDTEST.C
       HANDTEST.DEF
       HANDLER.LIB
       HANDTEST.RC

<P><LI>Build the project.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: CodeSam<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
