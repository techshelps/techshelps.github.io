

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Debug a Windows Shell Extension </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138942">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1995/10/31">
<META NAME="Keywords" CONTENT="WBDebug">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  To debug a Windows Shell Extension using Microsoft Visual C++, you must specify the Windows shell as the  Executable For Debug Session  in Project Settings (Build Settings if using Microsoft Developer Studio 4.0), and re- start it by using the Visu...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBIC,QDL9,QBWQ,QBWO,QBWN,QAIJ,QBWS,QBV9,QAVX,QDKA,QBWP,QBJZ,QBFY,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Debug a Windows Shell Extension</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138942</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The development environment included with:
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.1, 4.2 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To debug a Windows Shell Extension using Microsoft Visual C++, you must
specify the Windows shell as the "Executable For Debug Session" in Project
Settings (Build Settings if using Microsoft Developer Studio 4.0), and re-
start it by using the Visual C++ debugger.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Debug a Windows Shell Extension</h3>
 

<OL><P><LI>Bring the Shell Extension up in the Visual C++ environment, and set the
   shell as the "Executable For Debug Session." To specify the shell, click
   the Debug tab after clicking Build Settings in the Project menu, and
   enter &lt;path to explorer&gt;\Explorer.exe.

<P><LI>On the Start menu on the Windows Taskbar, click Shut Down. While holding
   down the CTRL+ALT+SHIFT key combination, click the No button in the Shut
   Down Windows dialog box. This will terminate the shell.
<P>
   NOTE: this only shuts down the shell. Any other applications that are
   running will continue to run after the shell exits.

<P><LI>Start the Visual C++ debugger, and debug the Shell Extension.
<P>
</OL>It may seem confusing when you start the Explorer under the debugger, and
you don't see what you might normally think of as the Explorer. This is due
to the fact that the Taskbar and Start button are part of the Explorer
program. To debug a Context Menu for a file, once the Explorer is running
under the debugger, it will still be necessary to start an instance of the
Windows Explorer from the Start menu.
<P>
Windows 95 NOTE: Once you finish debugging, double-click anywhere on the
desktop to restart the shell. This will bring up a Task dialog box. On the
File menu, click Run, and then enter the path to Explorer.exe. Explorer.exe
and "the shell" are the same thing.
<P>
Windows NT 4.0 NOTE: Once you finish debugging, press CTRL+ALT+DEL to bring
up the Windows NT task manager. On the File menu, click New Task (Run...),
and then enter the path to Explorer.exe.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Visual C++ 4.0 Books Online - Extending the Windows 95 Shell.
 
<PRE>Keywords          : WBDebug
Version           : WINNT:2.0,2.1,2.2,4.0,4.1,4.2,5.0;
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
