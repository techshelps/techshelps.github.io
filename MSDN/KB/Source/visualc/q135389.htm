

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: What's New: Bug Fixes Made in Visual C++ Version 2.2 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135389">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1995/08/21">
<META NAME="Keywords" CONTENT="VCGenIss kbbuglist kbfixlist kbref">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article lists fixes made in version 2.2 to bugs that appeared in Microsoft Visual C++, 32-bit Edition, versions 2.0 and 2.1. This information can also be found in the What's New help file available from Books Online or from the initial Setup d...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAAP,QBVV,QAM1,QAA1,QDIX,QDI2,QA6A,QAX6,QAMB,QABA,QAB4,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: What's New: Bug Fixes Made in Visual C++ Version 2.2</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135389</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.20
WINDOWS NT
kbref kbfixlist kbbuglist
<P>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft Visual C++, 32-bit Edition, version 2.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article lists fixes made in version 2.2 to bugs that appeared in
Microsoft Visual C++, 32-bit Edition, versions 2.0 and 2.1. This
information can also be found in the What's New help file available
from Books Online or from the initial Setup dialog box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
All of the following bugs were fixed in Microsoft Visual C++, 32-bit
Edition, version 2.2.
<P>
<P><h3>Integrated Development Environment</h3>
 

<UL><LI>Pressing the F9 key or clicking the Toolbar button to set a breakpoint
   would cause a beep, and breakpoint would not be set. This bug would
   manifest itself when you chose a Windows number format that uses a comma
   instead of a decimal in a floating point number.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q127779.htm">Q127779</A></B>
<PRE>   TITLE     : FIX: Can't Set BreakPoint w/ Country Set to
               Non-English Locale

</PRE><LI>Editing a menu resource that contains a menu separator in the top-level
   menu could cause a general protection (GP) fault. This problem would
   most likely occur if you had generated an AppWizard OLE application. The
   cause was a bug in the resource editor.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q129094.htm">Q129094</A></B>
<PRE>   TITLE     : FIX: GP Fault in Visual C++ When Separators in Top-Level
               Menu

</PRE></UL><h3>MFC 3.2</h3>
 

<UL><LI>Calling CDatabase::Open in a USRDLL with the parameter list (NULL,
   FALSE, FALSE, "ODBC;") could generate a CDBException with its
   m_strError member set to the value "Dialog failed." This problem occurs
   because the SQL Data Source dialog is displayed with a NULL main window.
   The desktop window now is passed as the main window.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q125794.htm">Q125794</A></B>
<PRE>   TITLE     : PRB: Calling CDatabase::Open in a USRDLL Causes CDBException

</PRE><LI>ODBC32.DLL fails to load on Win32s. A new ODBC32.DLL, which will load on
   Win32s, has been integrated in the \WIN32S directory of the Visual C++
   version 2.2 CD.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q129772.htm">Q129772</A></B>
<PRE>   TITLE     : FIX: "Attempt to load required component ODBC32.DLL failed"

</PRE><LI>Pulling down the File menu using an MRU list that contains a file
   stored on a floppy disk drive resulted in an attempt to access the
   floppy.

<LI>MFC Tooltips did not get their styles from the Windows 95 settings.
   MFC 3.0 and 3.1 did not use the system implementation for Tooltips;
   Windows 95 uses it, and therefore follows the system settings.

<LI>Centering was not turned off for some dialog boxes that had the
   DS_ABSALIGN style. Conditional logic was corrected to eliminate this
   problem.

<LI>When an item chosen from the MRU list failed to open, MFC did not remove
   that item from the MRU list. If the document fails to open, the item is
   now removed from the MRU list.

<LI>CDC::GetWindow was documented, but did not exist in the CDC class. The
   function was added to the CDC class.

<LI>CString::TrimLeft did not trim properly in Unicode builds. The function
   did not correctly account for the trailing NULL character.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q129770.htm">Q129770</A></B>
<PRE>   TITLE     : FIX: CString::TrimLeft Fails in a UNICODE Application

</PRE><LI>Incorrect painting for a CEditView in a splitter window. The default
   window style was not being set correctly in a Windows 95 splitter
   window. This problem has been corrected.

<LI>CPropertySheet::ProcessChars had an incorrect conditional in the case of
   the WM_SYSCHAR message. The conditional logic for checking whether any
   control had the focus was incorrectly checking for ::GetFocus==NULL
   instead of the return value of GetFocus. This has been corrected to
   ::GetFocus()==NULL.

<LI>The frame window was not reactivated when EndModalState was called.
   OnModal called BeginModalState, setting the m_cModalStack to a value
   higher than it should have been. This has been corrected.

<LI>CString::operator= did not correctly null-terminate a unicode string.
   This has been corrected.
<P>
</UL>- The wrong toolbar is sometimes displayed if multiple MFC OLE servers
<PRE>  are activated in Microsoft Excel. This has been corrected.

</PRE><LI>Opening a recordset to do a bulk add sometimes caused text fields to
   be truncated. This has been corrected.

<LI>CEnumConnPoints::OnNext generated an Application Error when called.
<P>
   This line:
<P>
<P><PRE>      ((LPCONNECTIONPOINT)pv)-&gt;AddRef();
</PRE><P>
   has been corrected to read:
<P>
<P><PRE>     (*(LPCONNECTIONPOINT*)pv)-&gt;AddRef();
</PRE>
<LI>Calling DdeClientTransaction in the debug version of Windows generated a
   debug warning. This has been corrected.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../WIN16SDK/Q111013.htm">Q111013</A></B>
<PRE>   TITLE     : FIX: DDE Warning Message: Invalid Value: -32767

</PRE><LI>COleDispatchDriver::InvokeHelperV sometimes faulted when passed E_FAIL.
   This has been corrected.

<LI>A memory leak resulted if an automation method threw an exception and
   there were arguments of types BSTR, DISPATCH, or UNKNOWN that required
   coercion into a temporary. This has been corrected.

<LI>A debug build of an application would assert, and a retail build would
   hang on a task switch while in SHIFT+F1 help mode. This has been
   corrected.

<LI>Decoding a UNICODE CString in a non-UNICODE application corrupted data.
   When CString deserialized a UNICODE CString object in a non-UNICODE
   application, the number of bytes in the string was determined
   correctly, but only one byte was allocated for the terminating null
   ('\0') character. This has been corrected.

<LI>In Windows 95, CScrollView miscalculates scroll position. When the
   proportional thumb is set it will be off slightly when you scroll by
   dragging the thumb. This has been corrected.

<LI>CSplitterWnd sometimes displayed incorrect painting because when
   calculating the region to paint, it assumed that the splitter bar
   shared the border with the window. In Windows 95, this is not the case.
   This has been corrected.

<LI>CRecordset::Open was not maintaining SQL parsing errors. The mechanism
   for throwing exceptions in the case of non-concurrency related errors
   was modified so that the ODBC error strings will be filled prior to
   throwing a CDBException.

<LI>IsFieldNull sometimes returned FALSE for single-precision floating-point
   fields that are NULL. This has been corrected.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q125465.htm">Q125465</A></B>
<PRE>   TITLE     : FIX: Floating Point Field Incorrectly Assigned -9.123E+19

</PRE><LI>Calling IsFieldDirty twice could cause a database exception. This has
   been corrected.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q128831.htm">Q128831</A></B>
<PRE>   TITLE     : FIX: CFile Exception: badSeek, OS error information = -1

</PRE><LI>CRecordSet::m_bUseUpdateSQL was used before being initialized. This has
   been corrected.
<P>
</UL><h3>Setup</h3>
 

<UL><LI>Running Setup.exe in the root directory of the CD that Visual C++ 2.0 or
   2.1 come on from a UNC path would result in a Setup failure. Setup.exe
   was not intended to handle UNC connections correctly. this problem has
   been corrected. (An example of a UNC path is: \\Server\Share\Setup.exe.)

<LI>The MFC Windows Socket DLLs were not installed on Win32s. Setup now
   installs these DLLs.
<P>
   For more information, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VISUALC/Q129782.htm">Q129782</A></B>
<PRE>   TITLE     : FIX: MFCN30.DLL and MFCN30D.DLL Not Copied with Win32S Setup
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 2.20<BR>
KBCategory: kbref kbfixlist kbbuglist<BR>
KBSubcategory: VCGenIss<BR>
Keywords          : VCGenIss kbbuglist kbfixlist kbref<BR>
Technology        : kbMfc<BR>
Version           : 2.20<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
