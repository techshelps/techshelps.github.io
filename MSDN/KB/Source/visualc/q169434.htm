

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BETA-PRB: Tabbing Broken for ATL Controls in IE 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169434">
<META NAME="KBModify" CONTENT="1997/06/25">
<META NAME="KBCreate" CONTENT="1997/05/30">
<META NAME="Keywords" CONTENT="AtlMisc kbui">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Multiple Active Template Library (ATL) controls embedded in an HTML page may not exhibit proper tabbing behavior in Internet Explorer (IE) 4.0. This behavior can be observed by subclassing a Windows Edit Control with an ATL control and placing mult...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA47,QA7O,QAB5,QAMN,QBV9,QAOE,QAD7,QAH6,QAH7,QBRJ,QAY5,QBWA,QAHV,QAYY,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BETA-PRB: Tabbing Broken for ATL Controls in IE 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169434</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
********************************************************************
<PRE>     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA

     This article discusses a Beta release of a Microsoft
     product. The information in this article is provided as-is
     and is subject to change without notice.

     No formal product support is available from Microsoft for
     this Beta product. For information about obtaining support
     for a Beta release, please see the documentation included
     with the Beta product files, or check the Web location
     from which you downloaded the release.

     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA
</PRE>********************************************************************
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Active Template Library, version 2.1
<LI>Microsoft Internet Explorer (Programming), version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Multiple Active Template Library (ATL) controls embedded in an HTML page
may not exhibit proper tabbing behavior in Internet Explorer (IE) 4.0. This
behavior can be observed by subclassing a Windows Edit Control with an ATL
control and placing multiple copies in a Web page. Tabbing will toggle the
focus between the first control and the address line in IE.
<P>
<P><h2>CAUSE</h2>
 
<P>
In-place active objects must always be given the first chance at
translating accelerator keystrokes. To satisfy this requirement, the
Internet Explorer calls an ActiveX control's
IOleInPlaceActiveObject::TranslateAccelerator method. The default ATL
implementation of TranslateAccelerator does not pass the keystroke to the
container.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In order for the Internet Explorer 4.0 to handle tabbing "correctly" for
ATL controls, the control must pass the appropriate accelerator back to the
container. Adding the following to an ATL Control will "fix" this behavior:
<P>
<PRE>   STDMETHOD(TranslateAccelerator)(MSG *pMsg)
   {
       CComQIPtr&lt;IOleControlSite,&amp;IID_IOleControlSite&gt;
           spCtrlSite(m_spClientSite);

       if(spCtrlSite)
       {
           return spCtrlSite-&gt;TranslateAccelerator(pMsg,0);
       }

       return S_FALSE;
   }

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design. It is up to the programmer to decide what the
appropriate behavior for the control should be in this situation.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<P><h2>Visual C++ Books Online: IOleInPlaceActiveObject::TranslateAccelerator</h2>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : AtlMisc kbui<BR>
Technology          : kbAtl kbInetDev<BR>
Version             : 2.1 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
