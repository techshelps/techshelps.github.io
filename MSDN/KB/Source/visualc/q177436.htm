

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Developer Studio Hangs When Debug Breakpoint Is Set </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177436">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1997/12/01">
<META NAME="Keywords" CONTENT="VWBIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Visual C++ debugger causes Microsoft Developer Studio to hang when a breakpoint is set in the code, or nothing happens when you try to start debugging with Debug Go (F5). It may also cause an application error in Msdev.exe. Also, The Visual C++...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBA2,QBFY,QA55,QA56,QBRT,QAA1,QAUF,QDI2,QAH4,QBWS,QBXS,QAKD,QDNN,QAJQ,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Developer Studio Hangs When Debug Breakpoint Is Set</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177436</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Visual C++, 32-bit Editions, version 5.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Visual C++ debugger causes Microsoft Developer Studio to hang when a
breakpoint is set in the code, or nothing happens when you try to start
debugging with Debug Go (F5). It may also cause an application error in
Msdev.exe. Also, The Visual C++ debugger might not run inside Microsoft
Developer Studio, but it might run fine outside Microsoft Developer Studio.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the software license checking program Express Meter is installed in the
machine then it hooks a DLL named Em.dll in the process space of Msdev.exe.
The Visual C++ debugger also uses a DLL by the same name. As a result, when
the debugger is invoked in Microsoft Developer Studio it uses the wrong
Em.dll found in its process space and the access violation occurs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The Express Meter software is available in both 16-bit and 32-bit versions.
When you are running this software, the 16-bit version appears in the Task
Manager as EM (for Em.exe) and the 32-bit version appears as EM32 (for
Em32.exe). Express Meter software installs the Em.dll in the Windows
..\System or ..\System32 directory. The Visual C++ debugger installs this
DLL in the C:\Program files\DevStudio\SharedIDE\BIN\ directory if you
installed Visual C++ in the C: drive.
<P>
To resolve this problem, check the following registry key:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\DevStudio\5.0\Build System
     \Components\Platforms\Win32 (x86)\Execution Models

</PRE>On the right panel you will see an entry "Current EM", and its value is set
to "EM".
<P>
Change this value to the full path of the debugger's Em.dll for LoadLibrary
to load the correct DLL.
<P>
The changed value will be similar to the following directory (depending on
which drive Visual C++ is installed on):
<P>
<PRE>   C:\Program files\DevStudio\SharedIDE\BIN\EM

</PRE>To change the value, double-click "Current EM", and type in the full path
that appears above.
<P>
If this does not resolve the issue, end the task (EM or EM32) from the Task
Manager. Note that if the System Administrator is running this task in a
secured mode, you need appropriate permissions to end this task.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
 
<PRE>Keywords          : VWBIss
Version           : WINDOWS:97
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
