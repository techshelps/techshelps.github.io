

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Caveats for Using Empty Top-Level Projects in Dev. Studio </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142594">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1996/01/16">
<META NAME="Keywords" CONTENT="VwbIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article discusses the process needed to set up a project workspace such that it builds multiple targets that are related. You might want to do this if, for example, you want to set up a workspace to build several related .exe files, and .dll f...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAJN,QDI2,QDIJ,QAGB,QAEF,QAG0,QBHQ,QBVV,QAB4,QAI4,QAA5,QAH8,QABA,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Caveats for Using Empty Top-Level Projects in Dev. Studio</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142594</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The development environment included with:
   - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses the process needed to set up a project workspace
such that it builds multiple targets that are related. You might want to do
this if, for example, you want to set up a workspace to build several
related .exe files, and .dll files that they can call. This scenario is
described in the Visual C++ User's Guide online documentation in the "Empty
Top-Level Project with Multiple Subprojects" section.
<P>
The section of the documentation includes a sample scenario where an empty
top-level project has two subprojects that build .exe files, and one of the
.exe projects has a subproject that builds a DLL. The description of this
scenario implies that in general you can set up a top-level project that
has no source files, and it implies that the type of the top-level project
and the subprojects involved are unimportant; they can be any type. This is
not the case. The types of the projects and subprojects involved are
important.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In certain scenarios, you will get the following messages in the output
window when you set the default project configuration to the empty
top-level project in order to build all the subprojects:
<P>
<PRE>   LINK : warning LNK4001: no object files specified; libraries used
   LINK : error LNK2001: unresolved external symbol _mainCRTStartup
   fatal error LNK1120: 1 unresolved externals
   Error executing link.exe.

</PRE>This happens if you have one or more static library or DLL projects that
are immediate subprojects of the empty top-level project. Developer Studio
invokes the linker to build an output file for the top-level project and
automatically tries to link with the library files built by the subprojects
(DLL subprojects create import libraries). This behavior occurs even if the
top-level project is empty, meaning that it does not include source files.
<P>
If you want to set up a project workspace where the static library or DLL
projects are immediate subprojects of an empty top-level project, you need
to make the top-level project type be Makefile. In addition, you need to
change the build settings for the Makefile project so the "Build command
line" setting is blank. In other words, you do not want Developer Studio to
invoke any command for the empty top-level project. This will allow you to
set up the correct dependency relationship between the top-level project
and its subprojects, and it will prevent Developer Studio from attempting
to create an output file for the top-level project.
<P>
With Visual C++ 5.0 where the DLL projects are immediate subprojects of an
empty top-level project, you can select the "Ignore export library"
checkbox in the project settings for the DLL subprojects, Link tab, General
category. This tells the build system not to automatically link the empty
top-level project with the import library generated by the DLL subprojects.
This checkbox is not available for static libraries.
 
<PRE>Keywords          : VwbIss
Version           : WINNT:4.0,4.1,4.2,5.0;
Platform          : NT WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
