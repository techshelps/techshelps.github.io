

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Resizing CPropertySheet in OnInitDialog Does Not Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140585">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1995/12/04">
<META NAME="Keywords" CONTENT="MfcUI kbcode kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  If you create a class derived from CPropertySheet and use ClassWizard to add a handler for OnInitDialog(), the TODO comment will be added before the call to CPropertySheet::OnInitDialog(). If you replace the comment with calls to MoveWindow() or Se...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAH4,QAUD,QAIF,QBVV,QA26,QAMB,QBWP,QA2O,QAY2,QAR4,QABA,QALW,QAG0,QABO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Resizing CPropertySheet in OnInitDialog Does Not Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140585</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>4.00       | 4.00
</PRE>WINDOWS NT | WINDOWS
kbprg kbprb kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create a class derived from CPropertySheet and use ClassWizard to
add a handler for OnInitDialog(), the TODO comment will be added before the
call to CPropertySheet::OnInitDialog(). If you replace the comment with
calls to MoveWindow() or SetWindowPos() to resize the sheet, this will not
work. Also, GetWindowRect() or GetClientRect() will not return the correct
information if called before OnInitDialog().
<P>
This is the code generated by ClassWizard:
<P>
<PRE>   BOOL CMySheet::OnInitDialog()
   {
      // TODO: Add your specialized code here and/or call the base class
      return CPropertySheet::OnInitDialog();
   }

</PRE><h2>CAUSE</h2>
 
<P>
CPropertySheet::OnInitDialog causes the CPropertySheet to resize.
Therefore, any call to MoveWindow() or SetWindowPos() has no effect if it
comes before CPropertySheet::OnInitDialog().
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Call CPropertySheet::OnInitDialog() first, before resizing the sheet, as in
the following code.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>// This code shows how to resize a modeless CPropertySheet and
// add a button.

// CMySheet is derived from CPropertySheet
</PRE>BOOL CMySheet::OnInitDialog()
{
<PRE>          CPropertySheet::OnInitDialog();

          RECT rc;
          GetWindowRect (&amp;rc);
          // Increase the height of the CPropertySheet by 30
          rc.bottom += 30;
          // Increase the width of CPropertySheet by 50
          rc.right +=50;
          // Resize the CPropertySheet
          MoveWindow (rc.left, rc.top, rc.right-rc.left, rc.bottom-rc.top);

          // Convert to client coordinates
          ScreenToClient (&amp;rc);
          // m_Button is of type CButton and is a member of CMySheet
          m_Button.Create ("&amp;MyButton", WS_CHILD | WS_VISIBLE | WS_TABSTOP,
             CRect (5, rc.bottom-30, 80, rc.bottom-5), this, IDC_MYBUTTON);
          return TRUE;
}

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 Windows 95<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: MfcUI<BR>
Keywords          : MfcUI kbcode kbprb kbprg<BR>
Technology        : kbMfc<BR>
Version           : 4.00       | 4.00<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
