

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Register an MFC OLE Automation Server to Avoid Failure </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137516">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1995/09/28">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Creation of an OLE Object may fail if the registry file (.reg) generated by AppWizard is used to register the server for the object. This article explains how to avoid this failure.  MORE INFORMATION  Registration of an MFC OLE Automation server ty...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9Q,QAPN,QAA1,QBCF,QDI2,QAW6,QAPF,QBWP,QA2K,QA0N,QAJ6,QAFI,QBXN,QBWS,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Register an MFC OLE Automation Server to Avoid Failure</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137516</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.20
WINDOWS NT
kbole kbenv kbtshoot
<P>
 
The information in this article applies to:
<P>
<PRE>   The AppWizard, included with:

    - Microsoft Visual C++, 32-bit Edition, version(s) 2.00 2.10 2.20

</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Creation of an OLE Object may fail if the registry file (.reg) generated by
AppWizard is used to register the server for the object. This article
explains how to avoid this failure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Registration of an MFC OLE Automation server typically occurs when running
the server stand-alone for the first time. An alternate way of registering
the server is to run the registration editor and merge the .reg file
generated by AppWizard for the server's project. This method is necessary
if the server is installed but not run before a client tries to create it.
<P>
It is necessary that the setup program that installs the server also
replace any occurrence of the executable in the .reg file with the fully-
qualified path and file name of the executable. When AppWizard creates the
.reg file for the project, AppWizard does not know what the final path to
the executable will be. Therefore, AppWizard cannot fill in the fully
qualified path name for the server.
<P>
If the .reg file provided by the AppWizard is used as is to register the
server for an object, OLE won't be able to find the server, creation of the
object will fail, and OLE will return the error CO_E_SERVER_EXEC_FAILURE.
<P>
<P><h3>Sample Code</h3>
 
<P>
The following is an example of the \LocalServer key for the AutoClik,
Step 1 sample as generated by AppWizard:
<P>
HKEY_CLASSES_ROOT\CLSID\{2106E720-AEF8-101A-
<PRE>     9005-00DD0108D651}\LocalServer = AUTOCLIK.EXE

</PRE>After being setup correctly, the \LocalServer key in the .reg file
may appear as follows:
<P>
HKEY_CLASSES_ROOT\CLSID\{2106E720-AEF8-101A-
<PRE>     9005-00DD0108D651}\LocalServer = C:\MSVC20\SAMPLES\MFC
                         \autoclik\step3\WinDebug\AUTOCLIK.EXE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 2.00 2.10 2.20 3.00 3.10 3.20<BR>
KBCategory: kbole kbenv kbtshoot<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
