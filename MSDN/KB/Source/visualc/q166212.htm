

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: ProcessMessageFilter gets called only for messages posted </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166212">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1997/04/01">
<META NAME="Keywords" CONTENT="kbprg MfcMISC">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  ProcessMessageFilter is only called for messages that are posted to the message queue and is not called for messages that are send directly to the window procedure. Therefore, this function cannot be used to monitor messages that are sent (by  Wind...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QA01,QAGI,QAYC,QAB9,QBVV,QAIF,QBXQ,QDL9,QBWQ,QBWO,QBWN,QALQ,QAY5,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: ProcessMessageFilter gets called only for messages posted</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166212</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++ for Windows, 16-bit edition, version 1.52
   - Microsoft Visual C++, 32-bit Editions, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.0a, 4.1, 4.2, 4.2b, 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
ProcessMessageFilter is only called for messages that are posted to the
message queue and is not called for messages that are send directly to the
window procedure. Therefore, this function cannot be used to monitor
messages that are sent (by "Windows" or by the user) to a dialog box,
message box, menu, or a scroll bar.
<P>
ProcessMessageFilter is called from _AfxMsgFilterHook, which is the MFC
hook procedure for WH_MSGFILTER hook. This hook procedure will be called by
the system after a message generated by an input event (in a dialog box,
message box, menu, or scroll bar) is retrieved from the message queue.
Since messages sent directly to the window procedure (by SendMessage) do
not go through the message queue, this hook procedure is not called by
Windows. This in turn blocks the call to ProcessMessageFilter.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WH_MSGFILTER hook is a task-specific hook that enables an application
to monitor messages passed to a menu, scroll bar, message box, or dialog
box created by the application that installed the hook procedure. In a
typical MFC application the WH_MSGFILTER is set in the global function
AfxWinInit(), and in _AfxThreadEntry for multithreaded applications, with
_AfxMsgFilterHook as the callback or the hook procedure.
<P>
The callback function for this hook is called after these messages are
retrieved from the queue, just before dispatching them, performing special
processing as appropriate. Since messages sent directly to the window
procedure (by SendMessage) do not go through the message queue, the hook
procedure (_AfxMsgFilterHook) is not called by Windows.
<P>
ProcessMessageFilter of CWinThread (in MFC 3.x and up) and CWinApp (in MFC
2.x) is called from the _AfxMsgFilterHook hook procedure. Since the hook
procedure will not be called for messages sent directly to the window
procedure, ProcessMessageFilter will not get called and none of the special
code inside will execute.
<P>
In general, all the keyboard and mouse messages, along with the WM_PAINT
and WM_TIMER messages, are posted to the message queue.
ProcessMessageFilter will not be called for messages like WM_SETFOCUS,
WM_KILLFOCUS, WM_SETCURSOR, WM_COMMAND, WM_CTLCOLOR, WM_ACTIVATE, etc.,
since these are sent directly to the window procedure.
<P>
To monitor messages that are sent to a menu, message box, dialog box or a
scroll bar, set a WH_CALLWNDPROC hook. This hook is called whenever a
message is sent directly to a window procedure. Note that there will be a
tradeoff with performance since this hook procedure is called for every
message that are sent through SendMessage.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Additional information on SetWindowsHookEx, MessageProc, WH_MSGFILTER can
be found in the Windows API documentation.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg MfcMISC<BR>
Technology          : kbMfc<BR>
Version             : 1.52 2.0 2.1 2.2 4.0 4.0a 4.1 4.<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
