

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Appearance Property Uses Windows 4.0 WS_EX_CLIENTEDGE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152000">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1996/05/31">
<META NAME="Keywords" CONTENT="MfcOLE kbole kbprb kbprg kbtshoot kbusage">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  MFC Controls support a set of standard properties. One of these properties is Appearance (DISPID_APPEARANCE). Appearance is implemented to give a control a 3-D look. If the control is used on a version of Windows or Windows NT less than 4.0, the Ap...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBWP,QAB5,QBXS,QA7O,QAOE,QAMN,QANY,QAH4,QDL9,QBWQ,QBWO,QBWN,QA37,QAYL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Appearance Property Uses Windows 4.0 WS_EX_CLIENTEDGE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152000</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.10
WINDOWS NT
kbole kbprg kbusage kbprb kbtshoot
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
   Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
MFC Controls support a set of standard properties. One of these properties
is Appearance (DISPID_APPEARANCE). Appearance is implemented to give a
control a 3-D look. If the control is used on a version of Windows or
Windows NT less than 4.0, the Appearance property will not affect the
appearance of the control at run time.
<P>
<P><h2>CAUSE</h2>
 
<P>
At run time, the Appearance property is implemented in an MFC control by
setting an extended window style WS_EX_CLIENTEDGE. This window style is not
supported on versions of Windows or Windows NT less than 4.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
It is possible to supply your own implementation of the Appearance property
although this technique will not work for subclassed Windows controls.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Using the Class Wizard, add the stock Appearance property but choose
Get/Set methods rather that accepting the stock implementation. In the
control, declare a member variable of type BOOL to represent the Appearance
property. The stock Get/Set functions can be copied and changed slightly to
manipulate this variable as well as handle the property binding
requirements. In the Draw function, draw a 3-D border depending on the
value of this variable.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   // these get and set functions are the same as the original with a minor
   // change (noted in the code)

   short CTestAppearanceCtrl::GetAppearance()
   {
       return m_MyAppearance;
   }

   void CTestAppearanceCtrl::SetAppearance(short nNewValue)
   {
       if (nNewValue != 0 &amp;&amp; nNewValue != 1)
           ThrowError(CTL_E_INVALIDPROPERTYVALUE,
                      AFX_IDP_E_INVALIDPROPERTYVALUE);

       // Is the property changing?
       if (m_MyAppearance == nNewValue)
           return;

       if (!BoundPropertyRequestEdit(DISPID_APPEARANCE))
           SetNotPermitted();

   // changed from original
       // do not use the WS_EX_CLIENTEDGE style
       //ASSERT((m_hWnd == NULL) ||
       //  ((GetExStyle() &amp; WS_EX_CLIENTEDGE) == (DWORD)(m_sAppearance ?
       //      WS_EX_CLIENTEDGE : 0)));

       m_MyAppearance = nNewValue;
       SetModifiedFlag();

       //ToggleAppearance(this);
   // end of changes

       OnAppearanceChanged();

       BoundPropertyChanged(DISPID_APPEARANCE);
   }

   void CTestAppearanceCtrl::OnDraw(
               CDC* pdc, const CRect&amp; rcBounds, const CRect&amp; rcInvalid)
   {
       // TODO: Replace the following code with your own drawing code.
       pdc-&gt;FillRect(rcBounds,
            CBrush::FromHandle((HBRUSH)GetStockObject(WHITE_BRUSH)));
       pdc-&gt;Ellipse(rcBounds);

       // draw as 3D if m_appearance is set

       if(m_appearance)
       {
           CRect rect(rcBounds);
           pdc-&gt;DrawEdge(rect, EDGE_SUNKEN, BF_RECT | BF_ADJUST);
       }
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.10 DISPID_APPEARANCE<BR>
KBCategory: kbole kbprg kbusage kbprb kbtshoot<BR>
KBSubcategory: MfcOLE<BR>
Keywords            : MfcOLE kbole kbprb kbprg kbtshoot kbusage<BR>
Technology          : kbMfc<BR>
Version             : 4.00 4.10<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
