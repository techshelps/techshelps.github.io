

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Implement Context-Sensitive Help for Dialog Controls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149343">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1996/03/30">
<META NAME="Keywords" CONTENT="MfcHelp MfcMisc kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Context-Sensitive Help for dialog controls can be easily provided with the help of the resource editor. Using the resource editor eliminates the need to build a help ID array in memory.  MORE INFORMATION  The resource editor has the ability to auto...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAIM,QA4H,QA01,QA7O,QAMN,QAOE,QAH6,QAJB,QAPN,QAL0,QBWS,QAGI,QAD7,QABH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Implement Context-Sensitive Help for Dialog Controls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149343</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.10
WINDOWS NT
kbprg kbhowto kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Context-Sensitive Help for dialog controls can be easily provided with the
help of the resource editor. Using the resource editor eliminates the need
to build a help ID array in memory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The resource editor has the ability to automatically generate context help
IDs for dialog controls. To start the process, double-click the control in
the resource editor. This opens the control's property page. Select the
Help ID check box in the general tab. Then save the resource. The resource
editor then generates a file named Resource.hm, which contains help
contexts and corresponding ID numbers in the form of #define.
<P>
To add the Context-Sensitive Help button to the dialog itself, bring up the
properties for the dialog template. Click the Extended Styles tab, and
select the Context Help check box.
<P>
The help context is generated by prepending an H to the control ID in
Resource.h. The help context is what the help text author uses to identify
Help topics in .rtf file. The help context ID number is what the programmer
associates with each resource. The help context IDs are generated by adding
0x80000000 + (IDD_DIALOG &lt;&lt; 16) to the control ID in Resource.h. The help
contexts and ID numbers are mapped together in the [MAP] section of the
.hpj file.
<P>
When your application calls WinHelp, the Windows Help engine uses the
context ID your application passes to locate and display the Help topic
denoted by that context. At run time, the framework manages the process of
supplying the appropriate help context ID. These context help IDs are
passed as the dwContextID member of the HELPINFO structure. To provide
context help for the dialog control, handle the WM_HELP message for the
dialog, and in the handler, call WinHelp with context help ID as the last
parameter. Also include the Resource.hm file in the [MAP] section of the
.hpj file.
<P>
<P><h3>How to Provide Context Help for Property Sheet or Win32s Application</h3>
 
<P>
When you add a help ID to any control on a dialog, the resource editor
uses a DIALOGEX dialog template for the dialog. DIALOGEX templates are not
supported for property sheets or on Win32s. To provide context help for
a property sheet or Win32s application, see the DLGHLP32 sample in the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q141724.htm">Q141724</A></B>
   TITLE     : SAMPLE: Context-Sensitive Help in a CDialog Object

</PRE>In the help project (.hpj) file include Resource.hm:
<P>
<PRE>    [MAP]
    #include &lt;resource.hm&gt;

</PRE><h3>Sample Code</h3>
 
<P>
BEGIN_MESSAGE_MAP(CMyDialog, CDialog)
<PRE>    ON_WM_HELPINFO()
</PRE>END_MESSAGE_MAP()
<P>
BOOL CMyDialog::OnHelpInfo(HELPINFO* pHelpInfo)
{
<PRE>    if (pHelpInfo-&gt;iContextType == HELPINFO_WINDOW)
    {
        AfxGetApp()-&gt;WinHelp( pHelpInfo-&gt;dwContextId,
                              HELP_CONTEXTPOPUP);
    }

    return TRUE;
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 4.00 4.10<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: MfcMisc MfcHelp<BR>
Keywords          : MfcHelp MfcMisc kbcode kbhowto kbprg<BR>
Technology        : kbMfc<BR>
Version           : 4.00 4.10<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
