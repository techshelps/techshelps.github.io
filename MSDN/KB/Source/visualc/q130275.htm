

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Implement OLE Custom Control Context Sensitive Help </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130275">
<META NAME="KBModify" CONTENT="1996/05/26">
<META NAME="KBCreate" CONTENT="1995/05/16">
<META NAME="Keywords" CONTENT="kbtool kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  An OLE Custom Control can provide context sensitive help on the currently selected control, property, or event by modifying the .ODL file. This article shows by example how to implement it.  MORE INFORMATION  The help file for GENERIC is given by t...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA4H,QAB5,QAPN,QA7O,QAOE,QAMN,QAH4,QAO4,QA9Q,QA6A,QANY,QA17,QAHV,QBBS,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Implement OLE Custom Control Context Sensitive Help</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 26, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130275</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE Control Developers Kit (CDK) version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An OLE Custom Control can provide context sensitive help on the currently
selected control, property, or event by modifying the .ODL file. This
article shows by example how to implement it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The help file for GENERIC is given by the helpfile attribute in the library
declaration in the GENERIC.ODL file. In the following code, GENERIC.HLP
is the help file for the custom control.
<P>
<PRE>   [uuid(5CE3E2E3-8D26-101B-B883-444553540000), version(1.0),
    helpstring("GENERIC OLE Custom Control module"),
    helpfile("GENERIC.HLP")]
    library GENERICLib

</PRE>The associated GENERIC.HPJ file lists helpcontext attributes for each of
the help subjects:
<P>
[MAP]
<PRE>GENERIC                    10
GenericShape             50
FlashColor                  60
ClickIn                        70
ClickOut                     80

</PRE>To specify the help topic ID for help on the control, add the helpcontext
attribute of 10 to the coclass declaration in GENERIC.ODL; the following
code demonstrates this:
<P>
<PRE>   [ uuid(5CE3E2E0-8D26-101B-B883-444553540000),
    helpstring("GENERIC Control"), helpcontext(10)]
    coclass CGENERIC

</PRE>To specify the help topic ID for a control property, add the helpcontext
attribute to the property declaration in the property list. The following
code demonstrates a help context ID of 50 and 60 for the GenericShape and
FlashColor properties respectively:
<P>
[ uuid(5CE3E2E1-8D26-101B-B883-444553540000),
<PRE>  helpstring("Dispatch interface for GENERIC Control") ]
 dispinterface _DGENERIC
</PRE>{
<PRE>            properties:
         // NOTE - ClassWizard will maintain property information here.
         //    Use extreme caution when editing this section.
         //{{AFX_ODL_PROP(CGENERICCtrl)
            [id(3), helpcontext(50)] GenericShapeConstants
                                                          GenericShape;
            [id(1), helpcontext(60)] OLE_COLOR FlashColor;
            [id(4)] BSTR FontName;
            [id(5)] boolean FontBold;
            [id(6)] boolean FontItalic;
            [id(7)] boolean FontStrikethru;
            [id(8)] boolean FontUnderline;
            [id(9)] float FontSize;
            [id(DISPID_BACKCOLOR), bindable, requestedit]
                                                          OLE_COLOR
</PRE>BackColor
;
<PRE>            [id(DISPID_CAPTION), bindable, requestedit] BSTR
                                                          Caption;
            [id(DISPID_FONT), bindable] IFontDisp* Font;
            [id(DISPID_BORDERSTYLE), bindable, requestedit]

</PRE>BorderStyleConstants BorderStyle;
<PRE>            [id(DISPID_ENABLED), bindable, requestedit] boolean
                                                          Enabled;
            [id(2)] MousePointerConstants MousePointer;
            [id(10)] IPictureDisp* MouseIcon;
        //}}AFX_ODL_PROP

</PRE>To specify the help topic ID for a control event, add the helpcontext
attribute to the event declaration in the event list. The following code
demonstrates a help context ID of 70 and 80 for the ClickIn and ClickOut
events respectively:
<P>
<PRE> [ uuid(5CE3E2E2-8D26-101B-B883-444553540000),
  helpstring("Event interface for GENERIC Control") ]
</PRE>dispinterface _DGENERICEvents
{
<PRE>            properties:
            //  Event interface has no properties

            methods:
            // NOTE - ClassWizard will maintain event information here.
            //    Use extreme caution when editing this section.
            //{{AFX_ODL_EVENT(CGENERICCtrl)
            [id(1), helpcontext(70)] void ClickIn(float* X, float* Y,

     BSTR* Caption);
            [id(2), helpcontext(80)] void ClickOut();
            //}}AFX_ODL_EVENT
};
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 OCX<BR>
KBCategory: kbtool kbprg kbcode<BR>
KBSubcategory: CDKIss
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 26, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
