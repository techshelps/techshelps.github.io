

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Windows NT Reads Environment Variables from AUTOEXEC.BAT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110305">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1994/01/19">
<META NAME="Keywords" CONTENT="msm611setup vc10setup vc15setup vc20setup">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  At boot time, Windows NT reads the AUTOEXEC.BAT file and sets any environment variables that do not conflict with Windows NT settings. These environment variables may affect the way some programs work.  MORE INFORMATION  Environment variables may b...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAYL,QAFY,QDKH,QBXS,QBAO,QAX1,QABA,QBVV,QBFY,QA56,QA55,QAOT,QANE,QAL3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Windows NT Reads Environment Variables from AUTOEXEC.BAT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110305</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, version 1.5
<LI>Microsoft Visual C++ 32-bit Edition, versions 1.0, 2.0, 4.0, 5.0
<LI>Microsoft FORTRAN PowerStation 32, version 1.0
<LI>Microsoft Macro Assembler, version 6.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
At boot time, Windows NT reads the AUTOEXEC.BAT file and sets any
environment variables that do not conflict with Windows NT settings. These
environment variables may affect the way some programs work.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Environment variables may be used to set compiler, assembler, and linker
options. Settings made in this way will override settings made in the
Visual Workbench and in makefiles. For example, the following setting will
cause the compiler to pack structures on 1-byte boundaries, and this can
cause problems when creating applications for Windows NT using Visual C++
32-bit edition:
<P>
<PRE>   SET CL=-Zp1

</PRE>The following environment variables may affect development tools:
<P>
<PRE>   CL       : C/C++ compilers
   ML       : MASM
   FL32, FL : FORTRAN compilers
   LINK     : Link

</PRE>Environment variables set in AUTOEXEC.BAT can only be seen in a console
session. To see the current environment variable settings, run a console
session and enter the following command at a prompt:
<P>
<PRE>   set

</PRE>The resulting list may include variable settings that do not show up when
checking the system settings in the Control Panel. These variables are
probably being set in the AUTOEXEC.BAT file.
<P>
To prevent problems related to setting of unwanted environment variables in
Windows NT, but to still allow them to be set when booting MS-DOS on a dual-
boot machine, use a secondary batch file. For example, place all of the SET
commands in the AUTOEXEC.BAT file in a file called DOSVARS.BAT. Save this
file in the root directory of your boot drive (the same directory as
AUTOEXEC.BAT). Add a line to execute this batch file to the end of
AUTOEXEC.BAT (add it as the last line):
<P>
<PRE>   DOSVARS

</PRE>This will execute the batch file to set the variables and not return to the
AUTOEXEC.BAT processing. You can also use the following
<P>
<PRE>   CALL DOSVARS

</PRE>at any point in the AUTOEXEC.BAT file so that processing of AUTOEXEC.BAT
continues after the settings are made. Because Windows NT does not process
nested batch files when reading AUTOEXEC.BAT, the variables will be set for
DOS but not for Windows NT.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MASM FORTRAN<BR>
Keywords          : msm611setup vc10setup vc15setup vc20setup<BR>
Version           : WINDOWS:1.5;WINDOWS NT:1.0,2.0,4.0,5.0<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
