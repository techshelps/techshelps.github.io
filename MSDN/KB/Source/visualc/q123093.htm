

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: C2400 With __asm and __emit Inline Assembler </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123093">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/11/21">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When using two underscores with the emit keyword (__emit), the compiler generates error C2400.     error C2400: inline syntax error in 'opcode';found 'constant'  RESOLUTION  Use only one underscore with _emit.  STATUS ======  Microsoft has confirme...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBFY,QAKP,QBA8,QATS,QASR,QALQ,QALG,QAAP,QAB4,QAJQ,QBV8,QATM,QAOT,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: C2400 With __asm and __emit Inline Assembler</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123093</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00   | 1.00 1.50 1.51
MS-DOS | WINDOWS
kbtool kbdocerr kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft C/C++ Compiler (CL.EXE) included with:
<P>
<P><PRE>    - Microsoft C/C++ for MS-DOS, version 7.0
    - Microsoft Visual C++ for Windows, versions 1.0, 1.5, and 1.51
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using two underscores with the emit keyword (__emit), the compiler
generates error C2400.
<P>
<PRE>   error C2400: inline syntax error in 'opcode';found 'constant'

</PRE><h2>RESOLUTION</h2>
 
<P>
Use only one underscore with _emit.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem can arise when using the online help example code, which shows
how to use two underscores with emit. The online help for emit can only be
invoked by pressing the F1 key when either emit or __emit is selected.
<P>
The _emit keyword defines a single immediate byte at the current location.
The _emit pseudo-instruction is similar to the DB directive of the
Microsoft Macro Assembler (MASM). It allows definition of a single
immediate byte at the current location in the current code segment.
However, _emit can define only one byte at a time, and it can only define
bytes in the code (_TEXT) segment. It uses the same syntax as the INT
instruction. You can use _emit to define processor specific instructions,
which the inline assembler does not support.
<P>
The following code sample defines and uses the 80386 CWDE instruction. It
demonstrates the compiler error discussed in this article.
<P>
<P><h3>Sample Code to Reproduce Problem</h3>
 
<P>
<PRE>/* compile options needed: none.
*/

/* Macro for 386 cwde instruction, assumes 16-bit mode */
#define cwde __asm __emit 0x66 __asm __emit 0x98       /* C2400 */

/* Work-around :
   Replace the above macro with the following line:
   #define cwde __asm _emit 0x66 __asm _emit 0x98
*/

void main()
</PRE>{
<PRE>    __asm mov ax, 0xFFFF
          cwde           ; Macro to generate CWDE
    __asm nop            ; use Codeview to look at EAX
}
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 7.00 8.00 8.00c 1.00 1.50 1.51 docerr<BR>
KBCategory: kbtool kbbuglist kbdocerr<BR>
KBSubcategory: AsmIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
