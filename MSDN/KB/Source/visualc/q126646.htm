

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error Msg: LNK2001 on __beginthreadex and __endthreadex </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126646">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1995/02/27">
<META NAME="Keywords" CONTENT="MfcMisc">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When compiling an MFC application using the single-threaded run-time library, you receive the following two unresolved external error messages:     nafxcwd.lib(thrdcore.obj) : error LNK2001:     unresolved external symbol  __beginthreadex     nafxc...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBHQ,QBFY,QAH4,QAB4,QA56,QA55,QBWS,QAAP,QBAO,QA2Q,QABA,QBVR,QAG2,QAJH,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Msg: LNK2001 on __beginthreadex and __endthreadex</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126646</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft C/C++ Compiler (CL.EXE) included with:
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 4.0, 4.1,
<P><PRE>     4.2, 5.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When compiling an MFC application using the single-threaded run-time
library, you receive the following two unresolved external error messages:
<P>
<PRE>   nafxcwd.lib(thrdcore.obj) : error LNK2001:
    unresolved external symbol "__beginthreadex"
   nafxcwd.lib(thrdcore.obj) : error LNK2001:
    unresolved external symbol "__endthreadex"

</PRE><h2>CAUSE</h2>
 
<P>
Starting with version 3.0, all MFC classes are "thread safe" and require
the multi-threaded run-time libraries to link successfully. Many people
try to use the single-threaded run-time libraries because they assume these
libraries are needed to enable the application to run in Win32s. This
is not the case. MFC versions 3.0 and later will use a single thread, so as
long as you are not creating additional threads in the application, the
application will run under Win32s.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid these unresolved external errors, do not set the Project Settings
to Single-Threaded for an MFC version 3.0 or later application. This
setting can be changed by doing the following:
<P>
On Visual C 2.x and 5.0:

<OL><P><LI>Select the PROJECT menu (and continue Steps 2 through 5 below).
<P>
</OL>On Visual C 4.x:

<OL><P><LI>Select the Build menu.

<P><LI>Select the SETTINGS... option.

<P><LI>Select the tab, C/C++.

<P><LI>Select CODE GENERATION on the Category list box.

<P><LI>Finally, make a selection other than SINGLE-THREADED on the Use Run Time
   Library list box.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For Win32s, MFC versions 3.0 and later do not create additional threads.
However, the MFC does make use of Thread Local Storage (TLS) in the
multithreaded libraries to provide per-process data in DLLs that are used
by multiple applications under Win32s.
<P>
In the Project Settings dialog box, if you select the run-time library
option to link "Multithreaded using DLL," you can take advantage of using
the shared DLL, MSVCRTx0.DLL (where "x" represents the major version of
Visual C++). There are separate versions of MSVCRTx0.DLL for Windows NT and
Win32s that cannot be interchanged. "Multithreaded using DLL" is required
when building an AFXDLL.
<P>
Linking to the multithreaded libraries may cause multiple defined symbol
errors. This usually occurs when the application uses user-created or
third-party static libraries that were created as single-threaded.
<P>
The best solution in this case is to rebuild the static libraries to use
the same library options as MFC (either /MT or /MD, depending on which MFC
lib is used).
<P>
In this case, you may be able to use /NOD:LIBC.LIB. However, if the static
library accesses any static global C Run-Time data such as _errno or stdin,
you will get unresolved externals on these symbols.
<P>
One solution which will always work is to isolate the single-threaded code
into a DLL, and call it, protected by semaphores, from the multithreaded
MFC code.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the run-time library options, see the section
titled "Code Generation Category" in Chapter 20 of the Visual C++ "User's
Guide." Or refer to the following article in the Visual C++ Books Online:

<UL><LI>Visual C++ Books
<P><PRE>    - User's Guides
       - Visual C++ User's Guide
<PRE></PRE>          - Setting Compiler Options
             - Setting Compiler Options
                - Code Generation
                   - Use Run-Time Library
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 9.00<BR>
Keywords          : MfcMisc<BR>
Technology        : kbMfc<BR>
Version           : WINNT:2.0,2.1,4.0,4.1,4.2,5.0;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
