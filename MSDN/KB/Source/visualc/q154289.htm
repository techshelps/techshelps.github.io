

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Identify the Symptoms of File Corruption Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154289">
<META NAME="KBModify" CONTENT="1997/10/03">
<META NAME="KBCreate" CONTENT="1996/07/31">
<META NAME="Keywords" CONTENT="VCGenIss kbsetup kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article describes how to identify the symptoms of file corruption problems. At some point after installing one of the products listed above, you may run into strange build errors that occur on simple projects or even with some of the sample pr...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBFY,QDI2,QA56,QA55,QAB4,QAAP,QAKP,QBWP,QBSO,QBWN,QAL2,QAEF,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Identify the Symptoms of File Corruption Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154289</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52,
   1.52b, 1.52c
<LI>Microsoft Visual C++, 32-bit Edition, versions 1.0, 2.0, 2.1, 2.2,
   4.0, 4.1, 4.2, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to identify the symptoms of file corruption
problems. At some point after installing one of the products listed above,
you may run into strange build errors that occur on simple projects or even
with some of the sample projects shipped with the products. The problem is
often not resolved until the product is completely removed from your system
and reinstalled. In other words, simply running the setup program again
without removing the product and its associated registry entries does not
resolve the problem.
<P>
The likely cause of these errors is that the build tool reporting the
error, or other files in your installation, have become corrupted.
Following are a few examples of scenarios that can occur:

<UL><LI>C1001 error from the compiler even on simple .CPP files that does
   not occur when compiling .C files. This is happening because the Visual
   C++ parser component (C1XX*.EXE) of the compiler is corrupted.

<LI>L1101 error in LAFXCWD.LIB even when building a 16-bit MFC application
   generated by AppWizard. This is happening because this MFC library
   file is corrupted.

<LI>LNK1141 error when building a DLL. This could be happening because the
   linker (LINK.EXE) is corrupted.

<LI>Internal link error during pass 1. This could be happening because the
   linker (LINK.EXE) or one of the libraries in your installation is
   corrupted.
<P>
</UL>These and other errors could also occur with the 32-bit versions of Visual
C++ if multiple versions exist on the same system.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To verify that the error is really occurring because of a corrupted file in
your installation, you can use the MS-DOS or Windows NT File Compare
program (Fc.exe) to compare the original files on the product CD-ROM and
the copies of the files that have been installed on your system. Use the
following Command line:
<P>
<PRE>   FC /b [drive1:][path1]filename1 [drive2:][path2]filename2

</PRE>The /B (binary) option tells the File Compare program to do a binary
comparison on the files.
<P>
If you decide to do a complete reinstallation of the product, here are the
general steps you should follow:

<OL><P><LI>Uninstall the product.

<P><LI>Delete the directory where Visual C++ resides:
<P>
   - \MSVC\ for Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52,
<P><PRE>     1.52b, and 1.52c.
</PRE><P>
   - \MSVC\ for Visual C++, 32-bit Edition, versions 1.0.
<P>
   - \MSVC20\ for Visual C++, 32-bit Edition, versions 2.0, 2.1, and 2.2.
<P>
   - \MSDEV\ for Visual C++, 32-bit Edition, versions 4.0, 4.1, and 4.2.

<P><LI>Delete the registry keys (only in the 32-bit Editions):
<P>
   - For versions 1.0, 2.0, 2.1, 2.2: Search for "Visual C++."
<P>
   - For versions 4.0, 4.1, 4.2: Search for "Developer."

<P><LI>Shut down and restart Windows.

<P><LI>Reinstall Visual C++.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information on troubleshooting installation problems,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q136258.htm">Q136258</A></B>
   TITLE     : Troubleshooting Visual C++ Setup Problems in Windows NT

   ARTICLE-ID: <B><A HREF="../VISUALC/Q134347.htm">Q134347</A></B>
   TITLE     : Troubleshooting Visual C++ Setup Problems Under Windows 95
</PRE></OL> 
<PRE>Keywords          : VCGenIss kbsetup kbtshoot
Version           : WIN3X:1.0,1.5,1.51,1.52;WINNT:1.0,2.0,2.1,2.2,4.0,4.1,4.2,5.0;
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
