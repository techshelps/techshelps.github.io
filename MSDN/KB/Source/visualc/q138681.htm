

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Windows Flash and Disappear in Dialog-Based Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138681">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1995/10/25">
<META NAME="Keywords" CONTENT="MfcMisc kbcode">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  In a default dialog-based application, windows created after returning from DoModal flash and disappear.  CAUSE =====  In an MFC application when the main window associated with the application is destroyed, a WM_QUIT message is posted to the appli...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAY5,QAJH,QDL9,QBWQ,QBWO,QBWN,QA01,QAY2,QAW6,QAPN,QALZ,QABA,QBQU,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Windows Flash and Disappear in Dialog-Based Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138681</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
   5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a default dialog-based application, windows created after returning from
DoModal flash and disappear.
<P>
<P><h2>CAUSE</h2>
 
<P>
In an MFC application when the main window associated with the application
is destroyed, a WM_QUIT message is posted to the application. This message
is posted by calling AfxPostQuitMessage from CWnd::OnNcDestroy for the main
window. AfxPostQuitMessage calls PostQuitMessage, which performs some
processing and then posts the WM_QUIT message to the application.
<P>
The PostQuitMessage function indicates to Windows that a thread has made a
request to terminate. Any window that is created after calling the
PostQuitMessage function will be immediately destroyed. The effect is that
the window flashes for a brief moment and then disappears. If DoModal is
called to display another modal dialog box, control returns immediately
from this function.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the line that sets the m_pMainWnd to point to dialog object, into a
comment. Or set m_pMainWnd for the CWinApp-derived object to NULL before
control gets to CWnd::OnNcDestroy for the dialog object. One way of doing
this is to override OnNcDestroy for the CDialog-derived object. In the
overridden function, set the m_pMainWnd to NULL before calling the base
class.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code can be implemented in the CDialog-derived class to
prevent PostQuitMessage() from being called when the dialog box in a
default dialog-based application is dismissed.
<P>
<P><h3>Sample Code to Resolve Behavior</h3>
 
<P>
<PRE>   void CMyDialog::OnNcDestroy()
   {
      AfxGetApp()-&gt;m_pMainWnd = NULL;
      CDialog::OnNcDestroy();
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: messagebox<BR>
Keywords          : MfcMisc kbcode<BR>
Technology        : kbMfc<BR>
Version           : Winnt:2.0, 2.1, 2.2, 4.0, 5.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
