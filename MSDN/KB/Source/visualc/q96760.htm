

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Gray Box Appears Using SDK Custom Control in App Studio </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96760 ">
<META NAME="KBModify" CONTENT="1997/08/26">
<META NAME="KBCreate" CONTENT="1993/03/25">
<META NAME="Keywords" CONTENT="AppStudioIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  In the App Studio, or Developer Studio, an attempt to install a  User- Defined  control fails and a gray box appears instead of the visual representation of the control.  CAUSE =====  The App Studio dialog editor supports the following procedures f...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QANF,QAG9,QA56,QA55,QDL9,QBWO,QBWN,QAHV,QBFY,QA01,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Gray Box Appears Using SDK Custom Control in App Studio</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96760 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The App Studio included with:
   - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 1.0, 2.0, 2.1, 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the App Studio, or Developer Studio, an attempt to install a "User-
Defined" control fails and a gray box appears instead of the visual
representation of the control.
<P>
<P><h2>CAUSE</h2>
 
<P>
The App Studio dialog editor supports the following procedures for
"User-Defined" controls:

<UL><LI>Specify a location for the control in the dialog box
<LI>Specify a caption for the control
<LI>Specify the window class for the control
<LI>Specify a 32-bit hexadecimal value for the control style
<P>
</UL>These procedures are described in the "Working with User-Defined Controls"
section in the "Using the Dialog Editor" chapter of both the Visual C++
version 1.0 "App Studio User's Guide" and the Visual C++, 32-bit Edition,
versions 2.x and 4.0, Books Online.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Even though the dialog editor does not display a visual representation of
the user-defined control, you can change the size and position of the gray
box to reflect the desired placement of the control within the dialog box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual C++ for Windows (16-bit) supports installing and design-time testing
for VBX version 1.0 controls. For 32-bit systems, OLE Controls (OCX) is
the preferred custom control architecture. Building and using OLE Controls
is fully supported in Visual C++ versions 2.0 and above. See MFC Technical
Note 27 included with these versions of Visual C++ for more information.
<P>
Versions 3.0 and later of the Microsoft Windows Software Development Kit
(SDK) define an dynamic-link library (DLL) interface for custom controls.
The Dialog Editor provided with the Windows SDK supports installing custom
controls and testing their functions. Section 20.2.5 of the Windows SDK
"Guide to Programming" manual for version 3.1 documents this interface.
<P>
Typically, a user-defined control implemented as a DLL registers a
WNDCLASS structure in its LibMain() procedure. Once a user-defined control
is installed into a dialog box in App Studio, double click on the gray box
to change the properties of the control and enter the window class and any
style information.
 
<PRE>Keywords          : AppStudioIss
Version           : 1.0 1.5 1.51 1.52 2.0 2.1 4.0 5.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
