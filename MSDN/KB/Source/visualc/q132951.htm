

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Modal Property Sheet Not Modal in Propdlg Sample </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132951">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1995/07/20">
<META NAME="Keywords" CONTENT="kb16bitonly MfcMisc kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  A modal property sheet brougt up by running the PROPDLG sample allows you to switch to other windows (such as the view window) in the application, and choose menu items. This is not proper behavior for a modal property sheet.  This problem occurs o...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBE5,QAPF,QBVV,QAY5,QDL9,QBWQ,QBWO,QBWN,QBFY,QA56,QA55,QAD7,QAH7,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Modal Property Sheet Not Modal in Propdlg Sample</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132951</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.52
WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++ for Windows, version 1.52
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A modal property sheet brougt up by running the PROPDLG sample allows you
to switch to other windows (such as the view window) in the application,
and choose menu items. This is not proper behavior for a modal property
sheet.
<P>
This problem occurs only with the Propdlg sample included with Visual C++
version 1.52. It does not occur in the Propdlg sample included with the
32-bit versions of Visual C++.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem results from passing "this" to the constructor for the
CModalShapePropSheet making the view the parent of the property sheet:
<P>
<PRE>   void CShapesView::OnPropertySheetWithPreview()
   ...
       m_pModalShapePropSheet = new CModalShapePropSheet(this);

</PRE>This problem does not occur in the 32-bit version implementation of modal
property sheets, because the CPropertySheet::DoModal() member function,
disables the application's top level window:
<P>
<PRE>   // find parent HWND
   HWND hWndTopLevel;
   CWnd* pParentWnd = CWnd::FromHandle(
       AfxGetSafeOwner(m_pParentWnd, &amp;hWndTopLevel));
   if (hWndTopLevel != NULL)
       ::EnableWindow(hWndTopLevel, FALSE);

</PRE>However, in the 16-bit code, this functionality is missing:
<P>
<PRE>    // find parent HWND
    CWnd* pParentWnd = CWnd::FromHandle(AfxGetSafeOwner(m_pParentWnd));

</PRE><h2>RESOLUTION</h2>
 
<P>
Pass NULL or a pointer to the application's main frame window as the parent
to the property sheet to correct this behavior. This works because
AfxGetSafeOwner() returns the top level window in either of these cases as
the main frame window. Later, in the CPropertySheet::DoModal() function, a
call to pParentWnd-&gt;EnableWindow(FALSE) causes the top level window to
be disabled.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Run the PROPDLG sample included with Visual C++ version 1.52.

<P><LI>Select a shape.

<P><LI>On the Object menu, click Property Sheet with Preview. This brings up a
   modal property sheet.

<P><LI>Observe that you are able to move to other windows.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.52<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: MfcMisc<BR>
Keywords            : kb16bitonly MfcMisc kbprb kbprg<BR>
Technology          : kbMfc<BR>
Version             : 1.52<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
