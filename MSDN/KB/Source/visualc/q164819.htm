

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Problems Using Database Classes with Jet 3.0 under NT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164819">
<META NAME="KBModify" CONTENT="1997/09/19">
<META NAME="KBCreate" CONTENT="1997/03/07">
<META NAME="Keywords" CONTENT="MfcDAO MfcDatabase kbtool kbbuglist kbfixlist vcbuglist400">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Using a Microsoft Access 7.0 data source under Windows NT 4.0 may cause the following problems:  1. An MFC Database (ODBC, DAO) application may crash upon exit, with the    following error message:        The instruction at 0x04210085 referenced me...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBWP,QAR4,QA9E,QAU9,QAB4,QAKP,QDN9,QAZV,QAM1,QAMB,QAAP,QDIX,QBFY,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Problems Using Database Classes with Jet 3.0 under NT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2
<LI>Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.0a, 4.1, 4.2,
   4.2b on the following platform: x86
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using a Microsoft Access 7.0 data source under Windows NT 4.0 may cause
the following problems:

<OL><P><LI>An MFC Database (ODBC, DAO) application may crash upon exit, with the
   following error message:
<P><PRE>      "The instruction at 0x04210085 referenced memory at 0x04210085.
      The memory cannot be read."
</PRE><P>
   The exact addresses may be different.

<P><LI>Opening and closing a CDatabase object in a loop may cause the
   following error:
<P>
<P><PRE>      "Unhandled exception in &lt;appname.exe&gt; .... Access Violation"
</PRE>
<P><LI>Class Wizard may crash while creating a recordset based on an Access
   data source.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. This bug was corrected in
the ODBC drivers included with Visual C++ 5.0 and the ODBC Drivers
included with Office 97 Value Pack.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For more information about obtaining the newer drivers, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>      ARTICLE-ID: <B><A HREF="../ODBC/Q159674.htm">Q159674</A></B>
      TITLE     : WX1350: ODBC Desktop Database Drivers 3.5 for 32-Bit
                  Programs

</PRE></OL>To obtain the updated version of MSJT3032.DLL version 3.00.3213 that fixes
the problem, see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>      ARTICLE-ID: <B><A HREF="../ACCESS/Q151186.htm">Q151186</A></B>
      TITLE     : INFO: Updated MSJT3032.DLL, MSWNG300.DLL, MSAJETFS.DLL

      ARTICLE-ID: <B><A HREF="../ACCESS/Q143163.htm">Q143163</A></B>
      TITLE     : PRB: Problems Running Microsoft Jet 3.0 on Windows
                  NT 4.0

      ARTICLE-ID: <B><A HREF="../ODBC/Q156298.htm">Q156298</A></B>
      TITLE     : FIX: Error on Disconnecting from ODBC Desktop Drivers
</PRE> 
<PRE>Keywords          : MfcDAO MfcDatabase kbtool kbbuglist kbfixlist vcbuglist400
Component         : jet
Version           : 4.0 4.0a 4.1 4.2 4.2b
Platform          : NT WINDOWS
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 19, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
