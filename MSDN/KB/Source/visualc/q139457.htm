

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error Converting Visual C++ OLE Controls from 2.x to 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139457">
<META NAME="KBModify" CONTENT="1997/10/08">
<META NAME="KBCreate" CONTENT="1995/11/09">
<META NAME="Keywords" CONTENT="CDKIss MfcOLE kbenv">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you use the following procedure to convert a project built with the CDK that shipped with Visual C++ 2.x to Visual C++ 4.0, the following error appears:     Linking...    LINK : fatal error LNK1104: cannot open file  ocs30d.lib     Error execu...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QBFY,QA56,QA55,QBWS,QA7O,QAE2,QA9Q,QAOE,QAMN,QAB5,QAJN,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Converting Visual C++ OLE Controls from 2.x to 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139457</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0
<LI>Microsoft OLE Control Developer's Kit (CDK)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the following procedure to convert a project built with the
CDK that shipped with Visual C++ 2.x to Visual C++ 4.0, the following error
appears:
<P>
<PRE>   Linking...
   LINK : fatal error LNK1104: cannot open file "ocs30d.lib"
   Error executing link.exe.
   circ1.ocx - 1 error(s), 0 warning(s)

</PRE><h3>Conversion Procedure</h3>
 

<OL><P><LI>On the File menu, click Open Workspace.

<P><LI>Browse to the project directory.

<P><LI>List files of type *.mak.

<P><LI>Select the 32-bit project file.

<P><LI>Click Rebuild All. After it tries to link, the following error message
   will appear:
<P>
   Linking...
   LINK : fatal error LNK1104: cannot open file "ocs30d.lib"
   Error executing link.exe.
   circ1.ocx - 1 error(s), 0 warning(s)
<P>
   The actual .lib file that is displayed will be one of four variants of
   the Ocs30*.lib file depending on how the project is being built.
<P>
</OL><h2>CAUSE</h2>
 
<P>
The reason that the specified file cannot be found is that it no longer
exists in Visual C++ version 4.0. Because the Ocs30* libraries were
variants of the MFC libraries, the functionality was merged with the
Mfc40*.dll. This had several advantages, including better code reuse as one
MFC .dll file can be used for both the OLE Control container and the OLE
control. The problem is that the ocs30*.lib file is included within the
Settings, Link page thereby giving the error Ocs30*.lib cannot be found.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the settings so that Visual C++ version 4.0 is no longer trying to
link in the Ocs30*.lib file. This can be done by following these steps:

<OL><P><LI>On the Build menu, click Settings, and then click the Link tab.

<P><LI>Click the first of the four project build options under Settings For.

<P><LI>Delete Ocs30d.lib from the edit field under Object/Library Modules.

<P><LI>Click each of the other three project build options and repeat step 3.
<P>
</OL>Now when you build your project it will use the Mfc40*.dll as designed.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   /* Compile options needed:
   */

</PRE></OL>Try one of the Circ samples that ship with the 2.x CDK.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: visualc ocx ole control ocs30d ocs30 lib dll<BR>
Keywords          : CDKIss MfcOLE kbenv<BR>
Technology        : kbMfc kbole<BR>
Version           : WINNT:2.0,2.1,2.2,4.0;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
