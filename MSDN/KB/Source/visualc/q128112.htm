

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOC: CFile::end (from CFile::Seek) Uses a Forward Offset </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128112">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1995/03/27">
<META NAME="Keywords" CONTENT="kbdocerr kbdocfix kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When using CFile::Seek() with the CFile::end parameter to start seeking from the end of a file, a negative offset is required to seek backward in the file. The documentation for CFile::end states:     CFile::end  Move the file pointer backward lOff...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFQ,QAM6,QACI,QAY2,QBWP,QA9N,QANJ,QAEF,QAO3,QAO2,QBFY,QA56,QA55,QAKD,QALS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: CFile::end (from CFile::Seek) Uses a Forward Offset</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128112</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 1.51 | 1.00 2.00 2.10
<PRE>WINDOWS        | WINDOWS NT
</PRE>kbprg kbdocerr kbdocfix
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
<P>
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51
    - Microsoft Visual C++, 32-bit Edition, versions 1.0, 2.0, 2.1
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using CFile::Seek() with the CFile::end parameter to start seeking
from the end of a file, a negative offset is required to seek backward in
the file. The documentation for CFile::end states:
<P>
<PRE>   CFile::end  Move the file pointer backward lOff bytes from the end
               of the file.

</PRE>This incorrectly indicates that a positive offset value will seek backwards
in the file. Using 16-bit versions of MFC, CFile::Seek() performs the
actual seek using int 21h function 42h. The "MS-DOS Encyclopedia" states
that when seeking from the end of file, the offset:
<P>
<PRE>    ... can be either a positive or negative 32-bit integer ... [which]
    can move the file pointer either forward or backward from the end of
    the file.

</PRE>When using MFC under Windows NT, CFile::Seek() calls SetFilePointer.
Documentation for the offset parameter to SetFilePointer is as follows:
<P>
<PRE>    ... specifies the number of bytes to move the file pointer. A positive
    value moves the pointer forward in the file and a negative value
    moves it backward.

</PRE>For both 16 and 32-bit versions of MFC, the code that performs the
actual seek can be found in FILECORE.CPP.
<P>
NOTE: This problem was fixed in Microsoft Visual C++, 32-bit Edition,
version 4.0. The Visual C++ 4.0 Books On-Line states the following:
<P>
<PRE>  CFile::end   Move the file pointer lOff  bytes from the end of the file.
               Note that lOff must be negative to seek into the existing
               file; positive values will seek past the end of the file.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbdocerr kbdocfix<BR>
KBSubCategory: MfcMisc<BR>
Additional reference words: 2.5 2.50 2.51 3.0 3.00 1.00 1.50 1.51 1.00 2.00<BR>
2.10 4.00<BR>
Keywords            : kbdocerr kbdocfix kbprg<BR>
Technology          : kbMfc<BR>
Version             : 1.00 1.50 1.51 | 1.00 2.00 2.10<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
