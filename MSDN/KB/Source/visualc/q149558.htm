

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Create an .MDB File for Microsoft Access Databases </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149558">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1996/04/04">
<META NAME="Keywords" CONTENT="MfcDAO MfcDatabase kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Prior to the release of the Microsoft ODBC Desktop Driver Pack version 2.0, there was no way to programmatically create a Microsoft Access database (an .mdb file). For more details about this, please see the following article in the Microsoft Knowl...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKY,QA1S,QA9E,QBPM,QDN9,QAU9,QBXR,QAY5,QBGA,QBFY,QA56,QA55,QAX6,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Create an .MDB File for Microsoft Access Databases</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149558</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++ for Windows, versions 1.51, 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.1, 4.2, 5.0
</PRE>
<LI>The Microsoft ODBC Desktop Driver Pack version 2.0
<LI>Data Access Pack version 3.5
<LI>Microsoft 3.0 ODBC SDK
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Prior to the release of the Microsoft ODBC Desktop Driver Pack version 2.0,
there was no way to programmatically create a Microsoft Access database (an
.mdb file). For more details about this, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q118609.htm">Q118609</A></B>
   TITLE     : HOWTO: Create an .MDB File for Microsoft Access Databases

</PRE>With the release of the version 2.0 driver pack and higher, MFC ODBC
applications can now create .mdb files. Additionally, with the
incorporation of DAO into Visual C++ 4.x or higher, you have another way to
create Microsoft Access databases programmatically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using the Microsoft Access ODBC Driver to Create .MDB Files</h3>
 
<P>
Kyle Geiger's book "Inside ODBC" provides a sample program, ODBCACC, that
nicely demonstrates how to use the ODBC installer DLL API function
SQLConfigDataSource to create an .mdb file. The syntax of the function call
is:
<P>
<PRE>   BOOL SQLConfigDataSource(hwndParent, fRequest, lpszDriver,
                            lpszAttributes)

</PRE>Where:
<P>
<PRE>  hwndParent     is either NULL if no dialogs are to be displayed or a
                 valid hwnd to act as parent to any driver generated
                 dialogs.
  fRequest       is ODBC_ADD_DSN to specify creation of the .mdb file.
  lpszDriver     is Microsoft Access Driver (*.mdb).
  lpszAttributes is "CREATE_DB=&lt;path&gt;&lt;filename&gt;.mdb &lt;sort order&gt;\0"
                 where the &lt;path&gt;&lt;filename&gt; combination identifies where
                 the file should be created and &lt;sort order&gt; is language
                 sorting order (for example, General). &lt;path&gt; must be
                 specified even if the .mdb is to be created in the current
                 working directory. Use standard relative path syntax.

</PRE>NOTE: Unlike most other ODBC API functions, SQLConfigDataSource returns a
boolean value. This return value is TRUE if the .mdb was created, FALSE if
creation failed.
<P>
To use the installer DLL functions, you must:

<UL><LI>Use #include &lt;ODBCINST.H&gt;.
<LI>Link with Odbcinst.lib for 16-bit applications.
<LI>Link with Odbccp32.lib for 32-bit applications.
<P>
</UL>NOTE: The functionality of SQLConfigDataSource is available through the
ODBC Administrator. If you choose to add a new Microsoft Access datasource,
the driver dialog includes a Create button that you can use to create an
.mdb file interactively.
<P>
<P><h3>Using DAO to Create .MDB Files</h3>
 
<P>
DAO allows applications developed with Visual C++ 4.x to interface with the
Microsoft Jet database engine directly. This allows more efficient
manipulation of Microsoft Access objects than can be achieved through ODBC,
including the creation of .mdb files. For a sample program that
demonstrates how to create databases and other objects, search the
Microsoft Knowledge Base for the DAOTABLE sample.
<P>
<P><h3>Sample Code</h3>
 
<P>
Use of SQLConfigDataSource ODBC installer DLL API function:
<P>
BOOL fCreated;
fCreated = SQLConfigDataSource(NULL,
<PRE>                        ODBC_ADD_DSN,
                       "Microsoft Access Driver (*.mdb)",
                       "CREATE_DB=.\\ATest.mdb General\0" );

</PRE>This will create ATest.mdb in the application's working directory using
general sorting.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Inside ODBC" by Kyle Geiger, Microsoft Press ISBN 1-55615-815-7.
<P>
For more information, please see the following article in the Microsoft
Knowledge Base in the ODBC collection:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ODBC/Q126606.htm">Q126606</A></B>
   TITLE     : INFO: Accessing CREATE_DB, REPAIR_DB, and COMPACT_DB
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: data base creation creating<BR>
Keywords          : MfcDAO MfcDatabase kbprg<BR>
Technology        : kbMfc<BR>
Version           : 1.51 1.52 2.0 2.1 2.2 4.0 5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
