

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Explanation of Two-Phase Construction in MFC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88105 ">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1992/08/17">
<META NAME="Keywords" CONTENT="MfcMisc kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Many of the classes defined in the Microsoft Foundation Classes (MFC) libraries require the programmer to perform two steps to create an object. The CBitmap, CDC, CDialog, and CWnd classes are examples of this class type. This article discusses the...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QDL9,QBWQ,QBWO,QBWN,QBFY,QA5C,QAY5,QAY4,QAYS,QABO,QAIC,QAHR,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Explanation of Two-Phase Construction in MFC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88105 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft C/C++ for MS-DOS, version 7.0
    - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
    - Microsoft Visual C++ 32-bit Edition, versions 1.0, 2.0, 2.1, 4.0, 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Many of the classes defined in the Microsoft Foundation Classes (MFC)
libraries require the programmer to perform two steps to create an object.
The CBitmap, CDC, CDialog, and CWnd classes are examples of this class
type. This article discusses the advantages of this design decision.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This two-step process is known as two-phase construction. In the first
phase, a C++ constructor creates an object in a sound state, a state that
can be destroyed by a destructor function. The second phase, usually
performed by the Create() member function, calls into Windows and allocates
resources. [For CBitmap objects, the LoadBitmap() member function performs
the second phase.]
<P>
This design has two main benefits. First, C++ constructors cannot return a
value to indicate failure. Operator new throws an exception when no memory
is available to construct an object. (An ad hoc mechanism, like an fOK
Boolean variable, is one mechanism to indicate an error in construction.)
<P>
Second, if constructors are "cheap" (that is, the constructor requires
little processor time and does not allocate many resources), an object can
be efficiently embedded into another object without a great increase in the
cost of construction.
<P>
For example, consider the process of embedding a CBitmap object into an
object derived from CWnd. If the CWnd-derived object used one-phase
construction, its construction would depend on successful construction of
the CBitmap object. The programmer would not have any flexibility to deal
with any errors as they arose.
<P>
However, in the two-phase method, the application can initialize the bitmap
any number of different ways while checking for failure. In addition, two-
phase embedded objects reduce problems allocating and de-allocating
objects, tracking object ownership, and deleting Windows objects
appropriately.
 
<PRE>Keywords          : MfcMisc kbfasttip
Technology        : kbmfc
Version           : MS- DOS:7.0;WINDOWS:1.0,1.5,1.51,1.52;WINDOWS:1.0,2.0,2.1,4.0,5.0
Platform          : NT WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
