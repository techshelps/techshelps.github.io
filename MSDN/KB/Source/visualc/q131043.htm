

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Building 16-Bit OLE Control on a Dual-Boot Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131043">
<META NAME="KBModify" CONTENT="1997/08/07">
<META NAME="KBCreate" CONTENT="1995/06/02">
<META NAME="Keywords" CONTENT="CDKIss kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Having installed the 16-bit version of the CDK on a dual-boot computer capable of running Windows NT (or Windows 95) and Windows version 3.1x, you may encounter problems attempting to build the type library for your OLE Custom Control under Windows...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWP,QBWO,QBJZ,QAVI,QAB5,QBFY,QANE,QBE7,QBE6,QAGQ,QBWS,QA9Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Building 16-Bit OLE Control on a Dual-Boot Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft OLE Control Development Kit (CDK) included with:
   - Microsoft Visual C++ for Windows, versions 1.51, 1.52
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Having installed the 16-bit version of the CDK on a dual-boot computer
capable of running Windows NT (or Windows 95) and Windows version 3.1x, you
may encounter problems attempting to build the type library for your OLE
Custom Control under Windows version 3.1x. Choosing Make TypeLib from the
Tools menu may briefly display an MS-DOS window with this message:
<P>
<PRE>   Project can only be run in Windows.

</PRE><h2>CAUSE</h2>
 
<P>
When running the CDK setup program under Windows NT or Windows 95, the Make
TypeLib menu command is configured to execute a batch file called
BLDTYPLB.BAT. This batch file executes the MKTYPLIB.EXE utility to build
the project's type library. Because Windows programs cannot be executed
directly from the MS-DOS command prompt under Windows version 3.1x, the
error message is displayed. Under Windows NT and Windows 95, Windows
programs can be launched directly from the MS-DOS command prompt.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To readily build your 16-bit OLE Custom Control project from Windows NT (or
Windows 95) and Windows version 3.1x, add an additional menu item to your
tools menu by using the Tools dialog box (choose Tools from the Options
menu).
<P>
For Windows version 3.x, configure a Tools menu item with these settings:
<P>
<PRE>Command Line     : C:\MSVC\BIN\MKTYPLIB.EXE
Menu Text        : Make TypeLib &amp;Win16
Arguments        : /cpp_cmd C:\MSVC\BIN\cl /W0 /I C:\MSVC\CDK16\INCLUDE
                   /nologo $Proj.odl /tlb tlb16\$Proj.tlb
</PRE>Initial Directory: $ProjDir
<P>
For Windows NT and Windows 95, configure another Tools menu item with these
settings:
<P>
<PRE>Command Line     :  C:\MSVC\CDK16\BLDTYPLB.BAT
Menu Text        :  Make Type&amp;Lib Win32
Arguments        :  $Proj.ODL C:\MSVC\BIN $Proj.Dir
                    C:\MSVC\CDK16\INCLUDE
</PRE>Initial Directory: $ProjDir
<P>
When running Visual C++ version 1.5x under Windows version 3.1x, use the
"Make TypeLib Win16" menu item to build the project's type library. When
running under Windows NT or Windows 95, use the "Make TypeLib Win32" menu
item.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information on the Tools dialog box, please see the Visual
C++ Help file or User's Guide.
 
<PRE>Keywords          : CDKIss kb16bitonly
Technology        : kbole
Version           : 1.51.152</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
