

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FILE: RegMaid.exe Helps Clean Up the Registry </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156078">
<META NAME="KBModify" CONTENT="1998/02/26">
<META NAME="KBCreate" CONTENT="1996/09/16">
<META NAME="Keywords" CONTENT="MfcOLE kbsample">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  RegMaid is a utility designed to clean up invalid registry entries caused by deleting OLE projects created with Visual C++ and Microsoft Foundation Classes (MFC). RegMaid provides information about entries that are believed to be problematic within...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QBCT,QAGC,QAGB,QDKD,QAY2,QAHH,QAP2,QAFI,QAYY,QAJ4,QAE1,QBVV,QBFY,QBBS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: RegMaid.exe Helps Clean Up the Registry</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156078</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
RegMaid is a utility designed to clean up invalid registry entries caused
by deleting OLE projects created with Visual C++ and Microsoft Foundation
Classes (MFC). RegMaid provides information about entries that are believed
to be problematic within the HKEY_CLASSES_ROOT: CLSID, ProgId, TypeLib, and
Interface sections of the registry. This information is in a report form of
a list view, where the user can make multiple row selections. Once
selections have been made, the user can then delete them from the registry.
While RegMaid does not currently have an Archive and Restore capability, it
does provide a printed report mechanism for each of the four views.
<P>
The CLSID section considers an entry to contain a problem if any handler or
server file entry cannot be found by the system. This can occur if a server
has been registered over the net and the network connection has been
broken. An entry might also be listed if the server has been moved or
deleted. The CLSID section provides the most information about the entry
listed to help you wisely chose the entries to remove.
<P>
The ProgId section tries to match its CLSID entry with one in
HKEY_CLASSES_ROOT\CLSID. The typical entry being searched in the registry
is of the format HKEY_CLASSES_ROOT\Some ProgId\CLSID. If the entry under
HKEY_CLASSES_ROOT does not contain a CLSID sub-entry, then it is ignored.
This ensures that only ProgIds are listed. The clean up process is
identical to that of the CLSID section.
<P>
The TypeLib section looks for references to .tlb files and if one is found
in the registry that cannot be found in the system then the entry is listed
as problematic. As with the CLSID section the files in question are listed.
<P>
The final section is the Interface portion of HKEY_CLASSES_ROOT. In this
section each entry with a TypeLib entry is compared to the entries in
HKEY_CLASSES_ROOT\TypeLib, and if a match is not found, the entry is
listed here. This entry has the least amount of information available
for deciding which registry entries to delete. In fact the only
information available are the TypeLib and Interface GUIDs. However,
because this section is highly dependent on the TypeLib section, it should
be safe to delete these entries as long as you have resolved the TypeLib
issues first.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/RegMaid.exe">RegMaid.exe</A> <I>(size: 262066 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>NOTE: Use the -d option when running RegMaid.exe to decompress the file and
re-create the proper directory structure.
<P>
NOTE: As of February 10, 1998, there is a new version of RegMaid.exe
(v1.1). It greatly reduces the number of erroneous listings caused by
RegMaid's inability to find a server file, including:

<UL><LI>Handling of long file names.
<LI>Handling of environmental variables in the path.
<LI>Confusion caused by multiple data entries for the server.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
Visual C++ 4.1 Sample: "REGISTRY: Uses the Win32 API to Access the
Registry"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Registry Visual Basic RegClean<BR>
Keywords          : MfcOLE kbsample<BR>
Technology        : kbMfc kbole<BR>
Version           : 4.0 4.1 4.2 5.0<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
