

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Custom AppWizards Can't Make Per-File Settings/Build Steps </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181503">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1998/02/20">
<META NAME="Keywords" CONTENT="VSDSAuto VwbIss WizardIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Custom AppWizards can not make per-file settings or per-file custom build steps on the projects they generate, such as modifying the compiler settings for one .cpp in a project or adding a custom build step to run MIDL on a project's IDL file.  STA...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABA,QBAO,QARW,QAJN,QASR,QAW6,QAUF,QAPN,QAPF,QA1E,QAA5,QAG0,QBFY,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Custom AppWizards Can't Make Per-File Settings/Build Steps</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181503</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The AppWizard included with:
<P><PRE>    - Microsoft Visual C++, 32-bit Editions, versions 5.0, 5.0sp1,
      5.0sp2, 5.0sp3
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Custom AppWizards can not make per-file settings or per-file custom build
steps on the projects they generate, such as modifying the compiler
settings for one .cpp in a project or adding a custom build step to run
MIDL on a project's IDL file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
As of Visual C++ 5.0, an automation object model exists that allows COM
clients to automate and control the Developer Studio shell. Custom
AppWizards now have an extra override in their CCustomAppWiz-derived class,
CustomizeProject, which gives the custom AppWizard access to the project
settings for the project it is generating. Using IConfiguration interfaces
from CustomizeProject's IBuildProject interface, the custom AppWizard can
call AddToolSettings, RemoveToolSettings, and AddCustomBuildStep to change
various project settings.
<P>
Unfortunately, AddToolSettings, RemoveToolSettings, and AddCustomBuildStep
operate on the entire project only; they cannot make tool settings or
create custom build steps for a single file. The current Developer Studio
object model does not support this. Custom build steps for single files
must be added by hand after the custom AppWizard generates the projects.
Settings made with AddToolSettings and RemoveToolSettings are applied to
all files in the project for the specified tool. Custom Build steps added
with AddCustomBuildStep run at the end of the build process only and cannot
be used to generate dependent files.
<P>
For more information about using CustomizeProject to change the settings of
a generated project, refer to the Developer Studio documentation on the
Developer Studio Object Model. For additional information, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VISUALC/Q173483.htm">Q173483</A></B>
   TITLE     : HOWTO: Create Custom AppWizards that Generate Non-MFC
               Projects

</PRE><h2>REFERENCES</h2>
 
<P>
DevStudio Object Model documentation: "Object Model, Developer Studio."
<P>
Visual C++ 5.0 AppWizard Programming Reference: "Customizing the Generated
Custom AppWizard Project."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbdsstools<BR>
Keywords          : VSDSAuto VwbIss WizardIss<BR>
Version           : WINNT:5.0,5.0sp1,5.0sp2,5.0sp3<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
