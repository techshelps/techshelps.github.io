

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Can Not Attach Process to Debugger from NT Task Manager </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167798">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="kbtool vcbuglist500 WBDebug kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  After installing Visual C++ version 5.0, you may not be able to attach an active process from Windows NT Task Manager. A message box titled  Unable to Attach Debugger  with the following error message appears:     The operation could not be complet...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRT,QBWP,QABT,QBFY,QA39,QA56,QA55,QAR4,QAB4,QBVV,QA2Q,QAY2,QAA1,QBWS,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Can Not Attach Process to Debugger from NT Task Manager</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167798</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After installing Visual C++ version 5.0, you may not be able to attach an
active process from Windows NT Task Manager. A message box titled "Unable
to Attach Debugger" with the following error message appears:
<P>
<PRE>   The operation could not be completed. The system cannot find the file
   specified.

</PRE><h2>CAUSE</h2>
 
<P>
This happens because the registry entry in HKEY_LOCAL_MACHINE\SOFTWARE\
Microsoft\Windows NT\CurrentVersion\AeDebug has a space in the path to
MSDEV.EXE. By default, the installed path to MSDEV.EXE is C:\Program
Files\DevStudio\SharedIDE\BIN\.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The resolution is to change the entry in the AeDebug registry key to:
<P>
<PRE> "&lt;install drive&gt;\Program Files\DevStudio\SharedIDE\BIN\msdev.exe" -p %id -
 e %id

</PRE>The quotes around the executable path and name are necessary in order to
correct this problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The registry key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\
CurrentVersion\AeDebug is used to attach the Visual C++ debugger to an
active process by launching MSDEV.EXE. It is also used by Just-In-Time
(JIT) debugging for the same purpose.
<P>
After you install Visual C++, the above registry key will have the
following value:
<P>
<PRE>   &lt;drive&gt;\Program Files\DevStudio\SharedIDE\BIN\msdev.exe -p %id -e %id

</PRE>where &lt;drive&gt; is the drive letter where Visual C++ is installed.
<P>
JIT debugging works fine with the value above.
<P>
There are two ways you can attach an active process to the Visual C++
debugger. They are:

<OL><P><LI>In Developer Studio, in the Build menu, Start Debug allows you to
   Attach to Process where you select an active process from the list
   provided.

<P><LI>In Windows NT, open the Task Manager, right-click an active process, and
   select Debug in the pop up window. This attaches the Visual C++ debugger
   to the selected active process. This method is similar to the method
   described in <B><A HREF="../VISUALC/Q120707.htm">Q120707</A></B> "How to Debug an Active Process in 32-bit
   Visual C++."
<P>
</OL>The first method works without having to incorporate the fix described in
this article because Visual C++ is already running.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Windows NT Task Manager by pressing Ctrl-Alt-Delete, and then
   select Task Manager from the system dialog box.

<P><LI>Select the Processes tab, then right-click the process you wish to
   attach to the debugger, and select Debug. If the fix described above is
   not in place, you will not be able to debug the process and you will
   receive the error message described in the SYMPTOMS section.
<P>
</OL>As mentioned earlier, Just-in-time debugging and attaching to a process
from Developer Studio works without using the fix described in this
article.
<P>
WARNING: Toggling the Just-in-time debugging check box in the Developer
Studio Options--Debug menu tab rewrites the AeDebug registry key back to
its original value.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbtool vcbuglist500 WBDebug kbbuglist<BR>
Version             : 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
