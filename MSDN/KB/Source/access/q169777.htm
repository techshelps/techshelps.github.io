

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: MS Access May Choose an Unexpected Index as the Primary Key </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169777">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1997/06/06">
<META NAME="Keywords" CONTENT="OdbcProb kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you link (attach) a table from an ODBC data source, such as Microsoft SQL Server or ORACLE, and that table contains more than one unique index, Microsoft Access may select t...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QABM,QA1S,QBWS,QAMA,QDN9,QDKY,QA94,QA9E,QA2Q,QAY5,QAE2,QAG2,QAYY P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: MS Access May Choose an Unexpected Index as the Primary Key</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169777</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you link (attach) a table from an ODBC data source, such as Microsoft
SQL Server or ORACLE, and that table contains more than one unique index,
Microsoft Access may select the wrong index as the primary key.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you link a table from an ODBC data source, such as Microsoft SQL
Server and ORACLE, the Microsoft Jet database engine makes a call to
SQLStatistics, an ODBC API function used to identify the first unique index
to select as the primary key. SQLStatistics returns index information in
the following order: Clustered, Hashed, Non-clustered or other indexes. In
addition, each index is listed alphabetically within each group.
<P>
NOTE: All indexes created within ORACLE are treated as non-clustered
indexes. Therefore, the order of the index is determined by the name
rather than by type.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To ensure that the Jet database engine properly selects the desired index
as the primary key when linking the table from your ODBC back-end, you can
rename the index so that it appears first alphabetically.
<P>
NOTE: When using SQL Server version 6.x, this behavior only occurs if you
are using non-clustered unique indexes.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In a Microsoft SQL Server utility (such as isql/w), run the following
   commands:
<P>
<P><PRE>      CREATE TABLE tblPKTest
       (
<PRE></PRE>          ID int Primary Key Nonclustered,
          Fname varchar(50) null,
          Lname varchar(50) null,
          Field3 varchar(50) null
       )
      go
      CREATE UNIQUE INDEX aaa on tblPKTest(Fname,Lname)

</PRE><P><LI>Start Microsoft Access and create a new database.

<P><LI>On the File menu, point to Get External Data, and then click Link
   Tables.

<P><LI>In the Link dialog box, click ODBC Databases in the Files Of Type box.

<P><LI>In the Select Data Source dialog box, click the data source to connect
   to your SQL Server database, and then click OK. Supply any necessary
   log on information, and click OK.

<P><LI>In the Link Tables dialog box, select the tblPKTest table created in
   Step 1, and then click OK.

<P><LI>Open the linked tblPKTest table in Design view; click Yes to the prompt
   that you cannot modify all properties of a linked table. Note that the
   PrimaryKey is not the ID field as expected, but the combined index of
   the Fname and Lname fields.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
ORACLE is manufactured by Oracle Corporation, a vendor independent of
Microsoft; we make no warranty, implied or otherwise, regarding this
product's performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: indexes<BR>
Keywords          : OdbcProb kb3rdparty<BR>
Version           : Windows; 2.0, 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
