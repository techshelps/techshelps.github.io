

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: "#Error" Message Referencing Subreport Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114513">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1994/05/05">
<META NAME="Keywords" CONTENT="kberrmsg kbusage RptSub">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  Referencing a subreport control from a main report when the subreport does not return any records results in a  #Error  error message.  CAUSE =====  This error occurs becau...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAMA,QA7O,QAAP,QA1S,QAY5,QAY2,QA7N,QAUD,QAKD,QBT6,QBJZ,QAB9,QBV4,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: "#Error" Message Referencing Subreport Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114513</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
Referencing a subreport control from a main report when the subreport does
not return any records results in a "#Error" error message.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs because the subreport does not return any values.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure that a subreport referenced in a main report returns values.
Alternatively, you can use an Access Basic function to retrieve values from
the subreport and trap for the error should it occur. See the "Steps to
Solve Problem" section later in this article for an example of this
technique.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new, blank query based on the Customers table.

<P><LI>Drag the Customer ID and Company Name fields from the field list to
    the query grid.

<P><LI>In the criteria cell for the Company Name column, enter the following
    expression:
<P>
       Like "P*"

<P><LI>Save the query as Sorter.

<P><LI>Create a new report based on the Orders table. This report will be
    the subreport.

<P><LI>Drag the Freight field from the field list to the report's Detail
    section.

<P><LI>In the report's footer section, add a text box with the following
    properties:
<P>
       ControlSource: =Sum([Freight])
       Name: Sum Freight

<P><LI>Save the report as SubRpt.

<P><LI>Create a new report based on the Sorter query. This report will be
    the main report.

<P><LI>From the Format menu, turn off the Page Header/Footer command. From
    the View menu, choose Sorting And Grouping. In the Field/Expression
    box, select Customer ID, and then set the Group Header property to Yes.

<P><LI>Drag the Customer ID field from the field list to the main report's
    Customer ID header section.

<P><LI>Drag the SubRpt report from the Database window to the detail section
    of the main report. Below the new subreport, add a label control
    with the caption "Total Order Amount Per Customer:" (without quotation
    marks) and a text box containing the following formula:
<P>
       =([SubRpt].Report![Sum Freight])

<P><LI>Set the subreport's LinkMasterFields and LinkChildFields properties
    to [Customer ID].

<P><LI>Save the main report as MainRpt.

<P><LI>Preview the main report. Note that in the record for company
    Paris Specialties, the error message "#Error" is displayed for
    the subreport reference ([SubRpt].Report![Sum Freight]).
<P>
</OL><h3>Steps to Solve Problem</h3>
 

<OL><P><LI>Create the a new Access Basic function called ErrAvoid():
<P>
<P><PRE>      Function ErrAvoid (n As Variant)
<PRE></PRE>         On Error GoTo Trap
         ErrAvoid = n
         Exit Function
      Trap:
         ErrAvoid = 0
         Resume Next
      End Function

</PRE><P><LI>Replace "=([SubRpt].Report![Sum Freight])" in step 13 of the previous
   procedure with:
<P>
<P><PRE>      =ErrAvoid([SubRpt].Report![Sum Freight])
</PRE>
<P><LI>Preview the main report. Note that in the record for company Paris
   Specialties, $0.00 is now displayed instead of the "#Error" message. The
   ErrAvoid() function traps for errors caused by the subreport containing
   no values. When an error is encountered, a value of zero is assigned.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pounderror<BR>
Keywords            : kberrmsg kbusage RptSub<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
