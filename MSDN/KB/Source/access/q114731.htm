

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Shortcut Method for Creating an SQL Union Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114731">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1994/05/10">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  This article demonstrates a shortcut method for creating an SQL union query using a second  scratchpad  query to create the second half of the SQL UNION statement.  MORE IN...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QABM,QA2Q,QBWS,QDN9,QAGT,QAG2,QAPF,QAY2,QAUJ,QACF,QBJZ,QAB9,QARM P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Shortcut Method for Creating an SQL Union Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114731</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
This article demonstrates a shortcut method for creating an SQL union query
using a second "scratchpad" query to create the second half of the SQL
UNION statement.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create a union query that returns
all the customers and suppliers in London in the sample database
Northwind.mdb (or NWIND.MDB in version 2.0).

<OL><P><LI>Start Microsoft Access and open Northwind.mdb.

<P><LI>Create a new query based on the Customers table.

<P><LI>Add the CompanyName, ContactName, and City fields to the query grid.
<P>
 NOTE: In version 2.0, there is a space in Company Name and Contact Name.

<P><LI>In the Criteria row for the City column, type London.

<P><LI>On the View menu, click SQL View (or SQL in Microsoft Access 7.0 and
    earlier). The SQL statement displayed is the first half of the union.

<P><LI>Leave the first query open and create a second new query based on the
    Suppliers table. This will be the "scratchpad" query.

<P><LI>Repeat steps 3 and 4 using the Suppliers table.

<P><LI>On the View menu, click SQL View (or SQL in Microsoft Access 7.0 and
    earlier). Select the entire SQL statement, except the ending semicolon
    (;).

<P><LI>Press CTRL+C to copy the selected text to the Clipboard.

<P><LI>Close the scratchpad query without saving it, and then switch back
    to the original query.

<P><LI>Position the insertion point before the semicolon (;) at the end
    of the SQL statement. Type the keyword "union" (without quotation
    marks) with a space before and after it.

<P><LI>Position the insertion point before the semicolon (;) at the end of
    the statement. Paste the text from the Clipboard by pressing
    CTRL+V. This creates the second half of the union.

<P><LI>Run the query. Note that the title bar indicates that it is a union
    query, and that the Design view button on the toolbar is disabled.
<P>
</OL><h3>Tips</h3>
 
<P>
NOTE: In the examples of SQL statements in the tips below, there are
differences in the SQL syntax for Microsoft Access 2.0 and 7.0. In
Microsoft Access 2.0 and 7.0, the word DISTINCTROW appears after each
SELECT, for example:
<P>
<PRE>   SELECT DISTINCTROW Customers.CompanyName

</PRE></OL>In Microsoft Access 2.0, because the field names contain spaces they are
enclosed in square brackets ([]), for example:
<P>
<PRE>   SELECT DISTINCTROW Customers.[Company Name]

</PRE>In Microsoft Access 2.0, the field names used in a WHERE clause are not
surrounded by an extra set of parentheses (), and they appear like this:
<P>
<PRE>   WHERE ((Suppliers.City="London"))

</PRE>To be able to tell which table the data comes from, switch back to the
query's SQL view and add the table name (preceded by a comma and enclosed
in quotation marks) to the end of each SELECT statement, as in this
example:
<P>
<PRE>   SELECT Customers.CompanyName, Customers.ContactName,
   Customers.City, "Customers"
   FROM Customers
   WHERE (((Customers.City)="London"))
   UNION SELECT Suppliers.CompanyName, Suppliers.ContactName,
   Suppliers.City, "Suppliers"
   FROM Suppliers
   WHERE (((Suppliers.City)="London"));

</PRE>If you include the table name in the query, it appears in a fourth column
called "Expr1003," when you run the query. To give the new column a more
meaningful name, add an alias to it. For example, add the alias "[Source
Table]" to the first SELECT statement as shown in this example:
<P>
<PRE>   SELECT Customers.CompanyName, Customers.ContactName,
   Customers.City, "Customers" AS [Source Table]
   FROM Customers
   WHERE (((Customers.City)="London"))
   UNION SELECT Suppliers.CompanyName, Suppliers.ContactName,
   Suppliers.City, "Suppliers"
   FROM Suppliers
   WHERE (((Suppliers.City)="London"));

</PRE>If you want to sort your query, add an ORDER BY statement to the last
SELECT clause in the UNION statement as shown below:
<P>
<PRE>   SELECT Customers.CompanyName, Customers.ContactName,
   Customers.City, "Customers" AS [Source Table]
   FROM Customers
   WHERE (((Customers.City)="London"))
   UNION SELECT Suppliers.CompanyName, Suppliers.ContactName,
   Suppliers.City, "Suppliers"
   FROM Suppliers
   WHERE (((Suppliers.City)="London")) ORDER BY [ContactName];

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about union queries, search for "union queries" and
then "UNION Operation (Microsoft Jet SQL)" using the Microsoft Access 97
Help Index.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: queries sql-specific short cut outer join<BR>
Keywords            : kbusage OdbcOthr<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
