

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC95: Yes/No Field Causes Error in AutoLookup Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142540">
<META NAME="KBModify" CONTENT="1997/05/22">
<META NAME="KBCreate" CONTENT="1996/01/15">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryFixup">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you add a record in a form (or query datasheet) bound to an AutoLookup query, you may receive one of the following error messages:     Current field must match join key '?' ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QA1S,QA5V,QAB4,QADX,QDN9,QAPN,QACF,QAPF,QARR,QABA,QAAP,QDIZ,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Yes/No Field Causes Error in AutoLookup Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142540</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you add a record in a form (or query datasheet) bound to an AutoLookup
query, you may receive one of the following error messages:
<P>
<PRE>   Current field must match join key '?' on 'one' side of one-to-many
   relationship because it has been updated.

   -or

   To make changes to this field, first save the record.

</PRE><h2>CAUSE</h2>
 
<P>
The AutoLookup query contains a Yes/No data type field from the "one" side
table. For Yes/No fields, Microsoft Access automatically enters a 0 (zero)
as the default value.
<P>
Because the Yes/No field is from the "one" side table and has a hidden
default value, Microsoft Access assumes that you are trying to add a
record to the "one" side as well as to the "many" side, which generates
the error messages.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two possible workarounds for using a Yes/No field in an
AutoLookup query. Your choice depends on whether you need to modify the
Yes/No field in the "one" side table.
<P>
<P><h3>Method 1</h3>
 
<P>
If you want to add records to the "many" side table, but only display (not
modify) the Yes/No field from the "one" side table, you can work around the
hidden default value for Yes/No fields by using an expression in the query
grid. For example, you can replace a Yes/No field reference such as
<P>
<PRE>   FieldName: MyYes/No

</PRE>with the expression:
<P>
<PRE>   FieldName: Expr1: [MyYes/No]+0

</PRE>Because an expression is used to output the field instead of a direct
reference, Microsoft Access does not try to set the value of the Yes/No
field in the "one" side table when you add records to the AutoLookup query.
A side-effect of this workaround is that you cannot modify the Yes/No field
in the "one" side table.
<P>
<P><h3>Method 2</h3>
 
<P>
CAUTION: This method involves modifying the design of the "one" side table.
If your application has multiple queries, forms, reports, and modules based
on the table, this change may affect their behavior. To avoid potential
side-effects caused by the design change, you should use Method 1 as the
resolution for this issue.
<P>
If you need to modify the Yes/No field in the "one" side table and add
records to the "many" side table, you can change the field's data type from
Yes/No to Number. Then, you can set the field's FieldSize and Validation
Rule properties to simulate the behavior of a Yes/No data type field. To do
so, follow these steps:

<OL><P><LI>Open your "one" side table in Design view.

<P><LI>Select the Yes/No field that you included in your AutoLookup query.

<P><LI>Change the field's properties to the following settings:
<P>
<P><PRE>      Table: Sample
      -----------------------
      FieldName: SampleField
      DataType : Number
      FieldSize: Integer
      ValidationRule: 0 or -1
</PRE>
<P><LI>Close the table and save the design changes. If you receive a "Data
   integrity rules have changed" message, click Yes to test your existing
   data against the new validation rule.
<P>
</OL>NOTE: If you have an existing form that has a check box, option button, or
toggle button for entering data into the Yes/No field, the form control
should continue to work properly after you change the field's DataType,
FieldSize, and ValidationRule properties as described in step 3.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0. This
problem no longer occurs in Microsoft Access 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Order Details Extended query in Design view.

<P><LI>Add the Discontinued field from the Products table to the query grid.

<P><LI>Run the query.

<P><LI>Enter the following values in a new record:
<P>
<P><PRE>      OrderID: 11077
      ProductName: Chai
      UnitPrice: $18.00
</PRE><P>
   Note that you receive the error message in the "Symptoms" section.

<P><LI>Press the ESC key twice to undo the new record.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about AutoLookup queries, search for "AutoLookup
queries," and then "About AutoLookup queries that enter data
automatically" using the Microsoft Access 97 Help Index.
<P>
For information about the "Current field must match join key '?' on 'one'
side of one-to-many relationship because it has been updated" error
message in Microsoft Access 2.0), please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q116062.htm">Q116062</A></B>
   TITLE     : ACC2: Adding Records to AutoLookup Form Generates Error

   ARTICLE-ID: <B><A HREF="../vbapps/Q148410.htm">Q148410</A></B>
   TITLE     : ACC95: Microsoft Jet Database Engine 3.0 Reserved Errors
               List
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: #3341<BR>
Keywords            : kberrmsg kbusage QryFixup<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
