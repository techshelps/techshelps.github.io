

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Compound Indexes Must Restrict First Indexed Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98793 ">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1993/05/13">
<META NAME="Keywords" CONTENT="kbusage TblPriky">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Before an index can be used, queries with restrictions on multiple-field (compound) indexes must restrict at least the first field of the index. You can, however, also use a...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QA7O,QA7N,QABD,QABE,QA1S,QAKD,QDN9,QBVV,QAY2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Compound Indexes Must Restrict First Indexed Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98793 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Before an index can be used, queries with restrictions on multiple-field
(compound) indexes must restrict at least the first field of the index. You
can, however, also use adjacent fields in the index (up to 10 fields). If
the restriction is placed on a field other than the first field, the query
optimizer scans the table rather than using the index. This is not always
desirable because table scans are slower than index searches for most
queries.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By default, when a compound index is created in Microsoft Access, no
individual indexes are assigned to the fields included in the compound
index. This behavior is by design.
<P>
For the query optimizer to use an index, you must use a comparison of
either the first field in the compound index or the first field and any
number of adjacent fields (up to 10) that make up the compound index. You
must query the indexed fields in the order they appear in the Indexes
window, beginning with the first indexed field and continuing with adjacent
fields.
<P>
NOTE: This principle also applies to using criteria with the Find
method in Visual Basic for Applications (or Access Basic in Microsoft
Access 2.0 or earlier).
<P>
For example, consider a table (T1) containing three fields: key_part1,
key_part2, and key_part3. If there is a composite index created on these
three fields and all fields are the primary key, then:
<P>
<PRE>   SELECT * FROM T1 WHERE key_part2 = &lt;value&gt;

</PRE>does not use the index because the first field, key_part1, is not used.
<P>
<PRE>   SELECT * FROM T1 WHERE key_part1 = &lt;value&gt; AND key_part3 = &lt;value&gt;

</PRE>also does not use the index, because, although key_part1 is referred to,
key_part1 and key_part3 are not adjacent fields.
<P>
However, each of the following three SQL statements do use the index
because they each include the first field, or the first field and one or
more adjacent fields of the composite index:
<P>
<PRE>   a. SELECT * FROM T1 WHERE key_part1 = &lt;value&gt;

   b. SELECT * FROM T1 WHERE key_part1 = &lt;value&gt; AND key_part2 =
      &lt;value&gt;

   c. SELECT * FROM T1 WHERE key_part1 = &lt;value&gt; AND key_part2 =
      &lt;value&gt; AND key_part3 = &lt;value&gt;

</PRE>The above fields are not prohibited from having indexes on them; individual
indexes can be built for each field, allowing comparisons on those fields
with index searches. Be aware, however, that indexes can take up as much
(or more) space than the data.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating indexes, search the Help Index for
"indexes, creating," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about optimizing queries with Rushmore technology,
search the Help Index for "Rushmore technology," or ask the Microsoft
Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: index query performance multi<BR>
Keywords            : kbusage TblPriky<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
