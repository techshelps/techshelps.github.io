

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Sample Function for a Directory-Selection Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128886">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1995/04/12">
<META NAME="Keywords" CONTENT="GnlOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to create a sample user-defined Access Basic function that you can use to provide users with a directory-selection dialog box. This method is s...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAH4,QA5F,QAMA,QA01,QAY5,QBT6,QAA1,QAB9,QBV4,QBXB,QBV8,QATJ,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Sample Function for a Directory-Selection Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128886</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to create a sample user-defined Access Basic
function that you can use to provide users with a directory-selection
dialog box. This method is similar to the Open file common dialog box that
can be called from Access Basic.
<P>
This sample function is based on the directory-selection function used by
the Microsoft Access Developer's Toolkit (ADT) Setup Wizard. It requires
that the SWU2016.DLL file be located in the Microsoft Access directory or,
if the sample function is used with a Microsoft Access run-time
application, that the SWU2016.DLL file be located in the same directory as
the MSARN200.EXE file.
<P>
You can ship the SWU2016.DLL file with a Microsoft Access application, but
it is only available when you install the ADT. It is copied to the Access
directory during ADT Setup. This file is not available from Microsoft Access
Product Support Services. Because this is a support file included with the ADT,
it is subject to change in future versions of the product.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a directory-selection dialog box on a form, follow the steps
below.

<OL><P><LI>Open a database for which you want to create a directory-selection
   dialog box.

<P><LI>Create a new module and add the following line to the Declarations
   section.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code.
<P>
<P><PRE>      Declare Function zws_BrowseDir Lib "SWU2016.DLL" Alias "#2"_
      (ByVal hwnd As Integer, ByVal szTitle As String, ByVal szDir_
      As String) As Integer
</PRE>
<P><LI>Create a new form and add a text box called "ChosenDir."

<P><LI>Add a command button to the form and then add the following code to
   the command button's OnClick event procedure.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code.
<P>
<PRE>      Sub commdir_Click ()

      On Error GoTo SelectDir_Err
          Dim stDir As String
          Dim iTmp As Integer
          Dim stControl As String
          stControl = "ChosenDir"

          stDir = Trim$(IIf(IsNull(Me(stControl)), "", Me(stControl)))

          stDir = stDir &amp; Chr$(0) &amp; Space$(255)

           If zws_BrowseDir(Me.hwnd, "select directory", stDir) &lt;&gt; 0 Then
              stDir = Left(stDir, InStr(stDir, Chr$(0)) - 1)
              Me(stControl) = stDir
          End If

          Exit Sub

      SelectDir_Err:
          If Err = 53 Then 'File not found.
              MsgBox "Could not load 'SWU2016.DLL', make sure file _
              exists", 48
          Else
              MsgBox Error$ &amp; Chr(13) &amp; Chr(10) &amp; " ErrorNum:" _
              &amp; Str(Err), 48
          End If
          Exit Sub

      End Sub

</PRE><P><LI>View the form in Form view.

<P><LI>Choose the command button and then use the directory-selection dialog
   box to select a directory name. The directory name you select appears
   in the ChosenDir text box.
</OL> 
<PRE>Keywords          : GnlOthr kbusage
Version           : 2.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
