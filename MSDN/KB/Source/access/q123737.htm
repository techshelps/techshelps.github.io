

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Cannot Clear Selection in LimitToList Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123737">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1994/12/08">
<META NAME="Keywords" CONTENT="FmsCmbo kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you delete the selected entry in a combo box, you may receive the following error message:     The text you enter must match an entry in the list.  CAUSE =====  The combo bo...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAEF,QA1S,QAFF,QBFY,QAH4,QAO4,QAJX,QADR,QBJZ,QDN9,QA7O,QAY5,QAHH,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Cannot Clear Selection in LimitToList Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123737</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you delete the selected entry in a combo box, you may receive the
following error message:
<P>
<PRE>   The text you enter must match an entry in the list.

</PRE><h2>CAUSE</h2>
 
<P>
The combo box's LimitToList property is set to Yes. When a combo box's
LimitToList property is set to Yes, an empty selection does not match any
value in the list. This behavior makes clearing a selection in the combo
box difficult.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can work around this behavior by including the following Access Basic
procedure in a new or existing module in your database and calling it from
the Change event of your combo box:
<P>
<PRE>   Sub AdjustEmptyCombo (C As Control)
      On Error Resume Next
      If IsNull(C.Text) Or C.Text = "" Then C = Null
   End Sub

</PRE>For example, in the sample database, NWIND.MDB, you can call the
AdjustEmptyCombo procedure from the Change event of the Salesperson
combo box on the Orders form:
<P>
<PRE>   Sub Employee_ID_Change ()
      AdjustEmptyCombo Me![Employee ID]
   End Sub

</PRE>You must pass the combo box control as an argument to the AdjustEmptyCombo
procedure.
<P>
NOTE: This technique will not work if the field the combo box is bound to
is a Required field. For more information about Required fields, search
for "Required" then "Required Property" using the Microsoft Access 2.0
Help menu.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database, NWIND.MDB.

<P><LI>Open the Orders form.

<P><LI>Click into the Salesperson combo box and delete the selection, and then
   press ENTER.
<P>
   Result: The following message appears:
<P>
<P><PRE>      The text you enter must match an entry in the list.
</PRE><P>
</OL>To work around this behavior, do the following:

<OL><P><LI>Create a new module with the following in the Declaration section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Create the following procedure:
<P>
<PRE>      Sub AdjustEmptyCombo (C As Control)
         On Error Resume Next
         If IsNull(C.Text) Or C.Text = "" Then C = Null
      End Sub

</PRE><P><LI>Save the module with a unique name, and then close the module.

<P><LI>Open the Orders form in Design view.

<P><LI>View the properties for the Salesperson combo box.

<P><LI>Choose [Event Procedure] for the OnChange property and choose the
   Build button to the right of the property setting to view the
   empty Change event procedure:
<P>
<PRE>      Sub Employee_ID_Change ()

      End Sub

</PRE><P><LI>Add the following line to the procedure code:
<P>
<PRE>      Sub Employee_ID_Change ()
         AdjustEmptyCombo Me![Employee ID]
      End Sub

</PRE><P><LI>Repeat the steps in the "Steps to Reproduce Behavior" section. Note
   that you are able to clear the selection without an error.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the NotInList event, search for "NotInList,"
and then "NotInList Event" using the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsCmbo kberrmsg kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
