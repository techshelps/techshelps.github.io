

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC1x: Creating Unbound Object Frame with CreateControl() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104711">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1993/09/27">
<META NAME="Keywords" CONTENT="EvnGpf kberrmsg kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you use the CreateControl() function with a controltype argument of 114 to create an unbound object frame, Microsoft Access causes a general protection (GP) fault when you view the form in Form view.  CAUSE =====  The CreateControl() function ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QDN9,QAW6,QAY5,QAH4,QAIB,QAIA,QAB4,QBKN,QAUR,QAGB,QBV8,QAB9,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Creating Unbound Object Frame with CreateControl()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104711</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the CreateControl() function with a controltype argument of
114 to create an unbound object frame, Microsoft Access causes a general
protection (GP) fault when you view the form in Form view.
<P>
<P><h2>CAUSE</h2>
 
<P>
The CreateControl() function does not provide any method for specifying the
object to embed in the new control. Instead, an empty, unbound object frame
is created. Note that you cannot create an empty, unbound object frame when
you create the frame manually because Microsoft Access displays an Insert
Object dialog box in which you must select the object to embed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The GP fault occurs because Microsoft Access does not expect to run with an
empty, unbound object frame. The CreateControl() function does not provide
any method of specifying the object to embed.
<P>
The following example demonstrates how to use the sample function
CreateUnboundObjectFrame() to create an unbound object frame using a
DoMenuItem action:
<P>
NOTE: In the following sample code, an underscore (_) is used as a line-
continuation character. Remove the underscore when re-creating this code in
Access Basic.

<OL><P><LI>Create a new module, and enter the following:
<P>
<P><PRE>      Function CreateUnboundObjectFrame (ByVal sFormName$, _
<PRE></PRE>                                         ByVal sObjectPath$)

         A_FORMDESIGNBAR = 3
         A_INSERTOBJECT = 10

         DoCmd SelectObject A_FORM, sFormName
         SendKeys "%f" &amp; sObjectPath &amp; "{ENTER}"
         DoCmd DoMenuItem A_FORMDESIGNBAR, A_EDIT, A_INSERTOBJECT

      End Function

</PRE><P><LI>Create a new, unbound form. Save the form as Chess.

<P><LI>With the form open, select the Database window.

<P><LI>Create a new module.

<P><LI>In the module's Immediate window, type the following, and then press
   ENTER:
<P>
<P><PRE>      ? CreateUnboundOjbectFrame("Chess", "c:\windows\chess.bmp")
</PRE><P>
</OL>NOTE: This example assumes that the CHESS.BMP file supplied with Microsoft
Windows is located in the C:\WINDOWS directory.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
1.0 and 1.1. This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new, unbound form. Save the form as CreateControlTest.

<P><LI>With the form open, select the Database window.

<P><LI>Create a new module. Enter the following sample function:
<P>
<P><PRE>      Function CreateUnboundObjectFrame ()
<PRE></PRE>         Dim C As Control
         Set C = CreateControl("CreateControlTest", 114)
      End Function

</PRE><P><LI>In the module's Immediate window, type the following, and then press
   ENTER:
<P>
<P><PRE>      ? CreateUnboundObjectFrame()
</PRE>
<P><LI>View the CreateControlTest form in Form view. The following error
   message will occur:
<P>
<P><PRE>      An error has occurred in your application. If you choose Ignore, you
      should save your work in a new file. If you choose Close, your
      application will terminate.
</PRE><P>
</OL>If you choose Close or Ignore several times, the following error message
will occur:
<P>
<PRE>   MSACCESS caused a General Protection Fault in module MSACCESS.EXE at
   0096:50B6.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "The Secrets of AccessWizards," pages 12-14
<P>
Microsoft Access "Language Reference," pages 151-152 and 433-434
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ADK GPF<BR>
Keywords            : EvnGpf kberrmsg kbprg PgmOthr<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
