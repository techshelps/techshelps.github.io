

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Sort Order of Union Queries Affected by ALL Predicate </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117164">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1994/06/22">
<META NAME="Keywords" CONTENT="kbusage QryOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The data from a union query appears to be sorted automatically according to values in the first column selected even when the query does not have an explicit ORDER BY clause. Thi...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAPN,QA2Q,QBWS,QAG2,QAML,QAY2,QAUD,QBPM,QAB9,QA1S,QAB6,QACF,QBVV,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sort Order of Union Queries Affected by ALL Predicate</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117164</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The data from a union query appears to be sorted automatically according to
values in the first column selected even when the query does not have an
explicit ORDER BY clause. This happens because, by default, union queries
do not return duplicate records; they perform an implicit DISTINCT. To
determine distinct rows of data, a union query sorts the data.
<P>
Duplicate records are not returned unless UNION ALL is used. When the ALL
predicate is used, the union query's rows are returned unsorted unless an
ORDER BY clause in included in the last SELECT statement.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you want to see the data from all the SELECT statements in the UNION
query including duplicates, keep the following tips in mind when you are
designing your queries:

<UL><LI>If any SELECT statement from the second through last does not have the
   ALL predicate with its UNION clause, the records will be sorted by
   default.

<LI>Any SELECT statement that has the ALL predicate and is not followed by
   another SELECT statement omitting the ALL predicate will have its rows
   appended to the records returned by the preceding SELECT statement,
   instead of sorted within the records of the preceding SELECT statement.
<P>
</UL>The following example demonstrates how to create a union query that returns
a sorted recordset, based on the first tip above:

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb (or
   NWIND.MDB in version 2.0).

<P><LI>Create a new query that is not based on any table.

<P><LI>On the Query menu, click SQL Specific, and then click Union.

<P><LI>Enter the following SQL statement in the Union Query window.
<P>
   NOTE: The blank lines in the following sample SQL statement have no
   effect on the query itself, but are meant to improve readability.
   Similarly, the column for the constants Employees1, Employees2,
   and Customers is included to identify each record's source. The
   Customers SELECT statement is restricted to contact names
   beginning with "K" in order to limit the number of records returned.
<P>
   SELECT [FirstName] &amp; " " &amp; [LastName] as Fullname, "Employees1"
   FROM Employees
<P>
   UNION ALL SELECT [FirstName] &amp; " " &amp; [LastName] , "Employees2"
   FROM Employees
<P>
   UNION SELECT [ContactName], "Customers"
   FROM Customers
   WHERE [ContactName] LIKE "K*";
<P>
   (NOTE: In Microsoft Access 2.0, [FirstName], [LastName], and
   [ContactName] should all be typed as two words, as follows:
   [First Name], [Last Name], [Contact Name].)

<P><LI>On the Query menu, click Run.
<P>
   NOTE: The rows from all three SELECT statements are sorted in a single
   alphabetical sequence by Fullname. In this example, the SELECT
   statement without an ALL predicate in the UNION clause happens to
   be the last one. Notice also that duplicates are retained in these
   query results.
<P>
</OL>The next example returns an unsorted recordset, based on the second tip
above:

<OL><P><LI>Reverse the second and third SELECT statements in the above example so
   that the SQL statement looks like the following statement.
<P>
   NOTE: The semicolon (;) should only appear at the end of the entire
   statement.
<P>
   SELECT [FirstName] &amp; " " &amp; [LastName] as Fullname, "Employees1"
   FROM Employees
<P>
   UNION SELECT [ContactName], "Customers"
   FROM Customers
   WHERE [ContactName] LIKE "K*"
<P>
   UNION ALL SELECT [FirstName] &amp; " " &amp; [LastName] , "Employees2"
   FROM Employees;

<P><LI>On the Query menu, click Run.
<P>
   NOTE: The order of the records is changed. The two Customers rows are
   sorted within the records from the first SELECT (Employees1), and
   the rows from the last SELECT (Employees2) are appended, in their
   own sort order, to the rows of the first two SELECT statements.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about union queries, search the Help Index for "union
queries," or ask the Microsoft Access 97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QryOthr<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
