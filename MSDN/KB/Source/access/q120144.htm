

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Can Print Macro Definition Without Read Design Permission </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120144">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1994/09/04">
<META NAME="Keywords" CONTENT="kbusage ScrtPerm">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When a user has Open/Run permissions on a macro, but not Read Design permissions, the user can view the macro's design using the Print Definitions command.  CAUSE =====  Thi...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAH4,QBWS,QAK7,QAGU,QBXS,QDN9,QAVX,QAVW,QBWG,QAAD,QAOX,QA50,QBJZ,QDKS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Can Print Macro Definition Without Read Design Permission</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120144</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When a user has Open/Run permissions on a macro, but not Read Design
permissions, the user can view the macro's design using the Print
Definitions command.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem only occurs if the user is granted Open/Run permissions on a
macro as an individual user. The problem does not occur if the user is
granted Open/Run permissions on the macro as a member of a group.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent a user from being able to read a macro's design, give the user
Open/Run permissions on the macro as a member of a group, instead of as an
individual user.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
2.0. This behavior no longer occurs in Microsoft Access for Windows 95
version 7.0. In Microsoft Access 7.0, attempts to print a macro without
design permission returns the error message "Object variable or With block
variable not set."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
NOTE: This example assumes that there is no password on your Admin user
account.

<OL><P><LI>Create a new database called TEST.MDB.

<P><LI>Create the following new macro and then save the macro as Test Security
   and close it:
<P>
<P><PRE>      Test Security Actions
      --------------------------
      MsgBox
<PRE></PRE>         Message: This is a test

</PRE><P><LI>From the Security menu, choose Users, and then in the Users dialog
   box choose the New button. In the Name box, enter "Joe" (without
   quotation marks), and in the Personal ID box enter "abcd" (without
   quotation marks). Choose OK. Make sure that Joe is a member
   of only the Users group and then choose the Close button.

<P><LI>From the Security menu, choose Permissions. In the Object Name box,
   select the Test Security macro, and then assign the following
   permissions on the macro:
<P>
<P><PRE>      Admins group: all permissions
      Guests group: no permissions
      Users group: no permissions
      Joe: Open/Run permissions
</PRE><P>
   When you are done, close the Permissions dialog box.

<P><LI>From the Security menu, choose Change Password. Change the Admin
   user's password by typing "1234" (without quotation marks) in
   the New Password and Verify boxes, and then choose OK.

<P><LI>Quit Microsoft Access and then start it again. In the Logon dialog
   box, type "Joe" (without quotation marks) in the Name box, and then
   choose OK.

<P><LI>Open the TEST database, and then select the Test Security macro
   in the Database window. Choose the Design button to open the macro
   in Design view. You will receive a message stating that you do not
   have permissions to read the macro. This is correct behavior, as
   the user Joe has only Open/Run permissions on this macro.

<P><LI>From the File menu, choose Print Definition. In the Print Macro
   Definition dialog box, choose OK. An Object Definition report will
   be generated, in which you can view the macro's names, conditions,
   actions, arguments, and permissions, even though you do not have
   Read Design permissions on the macro.
<P>
</OL>NOTE: To avoid having to log in to Microsoft Access as the Admin user after
following the above steps, clear the password for the Admin user by
following these steps:

<OL><P><LI>Quit Microsoft Access and then start it again.

<P><LI>In the Logon dialog box, type "Admin" (without quotation marks) in
   the Name box, type "1234" (without quotation marks) in the Password
   box, and then choose OK.

<P><LI>Open any database.

<P><LI>From the Security menu, choose Users.

<P><LI>In the Name box, select Admin, then choose the Clear Password
   button. Choose the Close button.

<P><LI>Quit Microsoft Access.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 14,
"Securing Your Application," pages 313-344
<P>
For more information about database security, search for "security:
basics," and then "Securing a Database" using the Microsoft Access Help
menu.
<P>
For more information about the Print Definition command, search for "Print
Definition," and then "Print Definition Command" using the Microsoft Access
Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage ScrtPerm<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
