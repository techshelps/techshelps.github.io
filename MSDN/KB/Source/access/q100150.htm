

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Macro on Subform Control Executed by Main Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100150">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/06/16">
<META NAME="Keywords" CONTENT="FmsEvnt kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If a macro is attached to the OnEnter or OnExit property of the first control in the tab order of a subform, the macro will run each time you move from one record to another in t...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAVX,QAVW,QAPN,QDN7,QAMA,QA39,QAHE,QA5V,QA7O,QAOE,QAMN,QAB5,QBWS,QA1S P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Macro on Subform Control Executed by Main Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100150</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If a macro is attached to the OnEnter or OnExit property of the first
control in the tab order of a subform, the macro will run each time
you move from one record to another in the main form.
<P>
In addition, a macro attached to the OnEnter property of the first
control in the tab order of the subform will run when the main form is
opened, and a macro attached to the OnExit property of the first
control in the tab order of the subform will run when the main form is
closed.
<P>
NOTE: This behavior is also true for Visual Basic for Applications code
(Access Basic code in Microsoft Access 2.0 or earlier) attached to the
OnEnter or OnExit property.
<P>
<P><h2>CAUSE</h2>
 
<P>
To cause a macro to run only when you are actually moving in and out
of the subform, use a test condition with a flag. A macro can set a flag on
the main form to indicate whether the subform was entered by moving into
the subform from the main form. The macro attached to the subform's OnEnter
and OnExit properties can check this flag to see if you really did move
into the subform and continue running if appropriate. The following steps
demonstrate how to set up and test for this condition.
<P>
<P><h2>RESOLUTION</h2>
 

<OL><P><LI>Create the following macro called Subform Flag:
<P>
<PRE>      Macro Name     Action
      -----------------------
      Set            SetValue
      UnSet          SetValue

      Subform Flag Actions
      -----------------------
      SetValue
         Item: [Subform Flag]
         Expression: True
      SetValue
         Item: [Subform Flag]
         Expression: False

</PRE><P><LI>For a form named MyForm, add an unbound text box to the main form with
   the following properties:
<P>
<P><PRE>      Form: MyForm
      Text Box: Subform Flag
<PRE></PRE>         Name: Subform Flag (in version 1.x, ControlName: Subform Flag)
         Visible: No
         Default Value: False

</PRE><P><LI>Select the subform control on the main form and change the following
   properties:
<P>
<P><PRE>      Form: MyForm Subform
      On Enter: Subform Flag.Set
      On Exit: Subform Flag.UnSet
</PRE>
<P><LI>Add the following macro action to the top of the macro that is
   attached to the OnEnter or OnExit property of the first control in
   the tab order of the subform. The macro will not perform any other
   actions if the subform flag is not set.
<P>
<PRE>      Condition                       Action
      -----------------------------------------
      Parent![Subform Flag] = False   StopMacro

</PRE></OL>The macro attached to the OnEnter property of the first control in the
subform will not run if you enter the control from the main form and the
control is in the selected record on the subform (denoted by a triangle in
the record selector). As a result, the macro will not run when you enter
the subform by pressing TAB, or by clicking the first control in the
selected record on the subform. However, the macro will run if you click
this control on a different record in the subform.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in Microsoft Access
   versions 1.x and 2.0) and create the following macro called Test:
<P>
<PRE>      MacroName     Action
      --------------------
      Test          MsgBox

      Test Actions
      --------------------
      MsgBox
         Message: Testing!

</PRE><P><LI>Open the Orders Subform form and change the OnEnter and OnExit
   properties of the PropertyID box ( or Property ID box in versions
   1.x and 2.0) box to Test, as follows:
<P>
<P><PRE>      Form: Orders Subform
      OnEnter: Test
      OnExit: Test
</PRE>
<P><LI>Save the Orders Subform form, open the Orders form, and move among the
   records. Note that the message "Testing!" appears twice for each record.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: exit enter<BR>
Keywords            : FmsEvnt kbusage<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
