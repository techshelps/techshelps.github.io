

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC1x: How to Execute Macro Actions Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99407 ">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1993/05/27">
<META NAME="Keywords" CONTENT="IntpDde kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Microsoft Access supports the execution of certain macro actions over a dynamic data exchange (DDE) channel.  MORE INFORMATION  The only macro actions that you can execute over a DDE channel to Microsoft Access are those supported by the DoCmd() fu...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QDN9,QAH4,QBVP,QAZ2,QBWS,QBV8,QAB9,QAJZ,QAFY,QAH6,QBUG,QBUF,QDNZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Execute Macro Actions Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99407 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Access supports the execution of certain macro actions over a
dynamic data exchange (DDE) channel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The only macro actions that you can execute over a DDE channel to
Microsoft Access are those supported by the DoCmd() function in Access
Basic. For this reason, the following macro actions cannot be executed:
<P>
<PRE>   AddMenu
   MsgBox
   RunApp
   RunCode
   SendKeys
   SetValue
   StopAllMacros
   StopMacro

</PRE>The syntax for macro actions executed through DDE is the same as the
syntax for macro actions called by the DoCmd() function, that is:
<P>
<PRE>   MacroActionName Argument1,Argument2,...,ArgumentN

</PRE>You cannot use the predefined constants that are available inside Access
Basic, such as A_NORMAL, as arguments when you are executing macro
actions with DDE. Instead, you must use the actual values of the
constants. The values of the constants can be determined using the
following procedure:

<OL><P><LI>Open a macro in Design view.

<P><LI>Select the macro action you want to use from the list of macro
   actions in the Action column.

<P><LI>In the Action Arguments section, locate the argument for which you
   need to supply a value.

<P><LI>In the list box associated with that argument, locate the option
   that you want to use.

<P><LI>Count down the list, starting at zero (0), until you reach that
   option.
<P>
</OL>The number you count to to reach the option is the number you need to
supply as the argument when you execute the macro over a DDE channel.
<P>
The following example creates a macro in Microsoft Excel that
demonstrates how to execute macro actions in Microsoft Access using DDE:
<P>
NOTE: This macro will not work in Microsoft Access version 1.0.

<OL><P><LI>Open Microsoft Access.(This macro only works if Microsoft Access is
   already running.)

<P><LI>Open a new macro sheet in Microsoft Excel. Enter the following
   macro:
<P>
<PRE>      Cell    Command
      --------------------------------------------------
      A1     MacroActionDDE
      A2
      A3    chan=INITIATE("MSACCESS","SYSTEM")
      A4    =APP.ACTIVATE("Microsoft Access",FALSE)
      A5    =EXECUTE(chan,"[opendatabase nwind.mdb]")
      A6    =EXECUTE(chan,"[beep]")
      A7    =EXECUTE(chan,"[openform categories,,,,,2]")
      A8    =EXECUTE(chan,"[beep]")
      A9    =EXECUTE(chan,"[openform categories]")
      A10   =EXECUTE(chan,"[close]")
      A11   =EXECUTE(chan,"[closedatabase]")
      A12   =TERMINATE(chan)
      A13   =APP.ACTIVATE(,FALSE)
      A14   =RETURN()

</PRE><P><LI>Size your Microsoft Access and Microsoft Excel windows so that you
   can see both applications at the same time.

<P><LI>To run the macro, select cell A3, choose Run from the Macro menu,
   and then choose OK.
<P>
</OL>The commands in cells A3 and A4 initiate a DDE channel to Microsoft
Access on the SYSTEM topic and activate the Microsoft Access application.
<P>
The command in cell A5 opens the sample database NWIND.MDB in the current
working directory using the OpenDatabase pseudo action. (Pseudo actions
are actions that are only valid over the DDE channel.)
<P>
The commands in cells A6 and A8 execute the Microsoft Access macro action
Beep.
<P>
The command in cell A7 executes the Microsoft Access macro action
OpenForm to open the Categories form in a minimized state.
<P>
The command in cell A9 executes the Microsoft Access macro action
OpenForm to open the Categories form in a normal state.
<P>
The command in cell A10 closes the currently active object in Microsoft
Access.
<P>
The command in cell A11 closes the currently opened database file using
the CloseDatabase pseudo action.
<P>
The commands in cells A12 through A14 terminate the DDE channel, activate
the Microsoft Excel application, and end the macro.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Language Reference," version 1.0, pages 149-150
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpDde kbinterop<BR>
Version             : 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
