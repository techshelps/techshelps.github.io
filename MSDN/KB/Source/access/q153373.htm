

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Importing Fixed-Width Text with Embedded Carriage Returns </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153373">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1996/07/08">
<META NAME="Keywords" CONTENT="IsmTxtfx kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you import or link to a fixed-width text file with fields that contain an embedded carriage-return and line feed control character (ASCII decimal values 13 and 10 respective...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA5V,QAUD,QA3P,QAMB,QA7O,QBWS,QA1S,QATX,QADF,QBTI,QA7N,QAIK,QAIJ,QBS0 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Importing Fixed-Width Text with Embedded Carriage Returns</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153373</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you import or link to a fixed-width text file with fields that contain
an embedded carriage-return and line feed control character (ASCII decimal
values 13 and 10 respectively), Microsoft Access interpret this character
set as being the end of a record. The remaining portion of the record that
follows the CR/LF is considered the beginning of a new record.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Import Wizard does not evaluate the field with the embedded or "soft"
return as part of the field's value.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, create a custom import specification using
Schema.ini and then link to the text file using Visual Basic for
Applications. Once linked, you can use a make-table or append query to
import the linked data.
<P>
For more information about using Schema.ini, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q149090.htm">Q149090</A></B>
   TITLE     : ACC: How to Use Schema.ini for Accessing Text Data

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Access Text Import Wizard assumes that a combination of CR/LF
designates a new record when parsing a fixed-width formatted text file.
Imported or linked data appears in an unexpected format when a field value
contains an embedded CR/LF.
<P>
Using Visual Basic for Applications and the TransferText AcImportFixed
generates the same behavior when linking or importing. Using an
export/import specification does not override the wizard.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Click the Tables tab, and then click the Suppliers table.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an external File or Database," and
    then click OK.

<P><LI>In the Save Table In dialog box, under Save As Type, click Text Files,
    and then click Export. The Text Export Wizard starts.

<P><LI>In the Text Export Wizard dialog box, click to select Fixed Width.
<P>
    NOTE: The fifth column (Address field) of the fourth record displays
    an embedded, or soft, return as two vertical bars. These are the actual
    CR/LF control characters.

<P><LI>Click Finish to export the data.
<P>
    NOTE: Using Notepad, you can open the Suppliers.txt file and view how
    the table was exported. The embedded returns within the Address
    field produce an unexpected text file format. Note how the fourth row
    ends with 9-8 Sekimai and the fifth row starts with Musashino-shi, even
    though this is all part of the same field value.

<P><LI>On the Microsoft Access File menu, point to Get External Data, and then
    click Import.

<P><LI>In the Import dialog box, under Files Of Type, click Text Files. Click
    the Suppliers.txt file, and then click Import. Note that the Text
    Import Wizard starts and that the wizard assumes a fixed-width format.
<P>
    In the Sample Data From File box, view how the wizard interprets the
    text file. The wizard guesses where the field breaks are and when a new
    record begins. Fixed-width records with an embedded carriage return
    within a field are interpreted differently than expected. The
    field value in column five of record four ends with 9-8 Sekimai and
    record five starts with Musashino-shi.

<P><LI>When finished viewing, click Cancel to terminate the Import process.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about importing fixed-width text files, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q94107.htm">Q94107</A></B>
   TITLE:      ACC1: How to Import Fixed-Width Text Files

</PRE></OL>For more information about accessing data in a text file, search in the
Help Index for "accessing text files," or ask the Microsoft Access 97
Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: truncates missing<BR>
Keywords            : IsmTxtfx kb3rdparty<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
