

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC1x: Trapping SQL Server RAISERROR() Function Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101678">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1993/07/20">
<META NAME="Keywords" CONTENT="IsmPdox kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft SQL Server users often create triggers or stored procedures that perform specific functions which are fired during certain events. Often, a custom-generated error ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB4,QA1S,QAAP,QATP,QAKD,QDN9,QAB9,QAY5,QAY2,QAXB,QA3P,QAN0,QAH4,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Trapping SQL Server RAISERROR() Function Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101678</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft SQL Server users often create triggers or stored procedures that
perform specific functions which are fired during certain events. Often, a
custom-generated error value is desired to indicate the status of such
events. This article describes a way to trap that value in Microsoft
Access.
<P>
NOTE: This article assumes that the user is running Microsoft Access
version 1.1, because that version corrects a problem to allow the SQL
Server RAISERROR() function to return a value to Microsoft Access.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Create the following stored procedure based on the sample database
   PUBS in Microsoft SQL Server:
<P>
<P><PRE>      CREATE PROCEDURE TestProc
      AS
<PRE></PRE>        RAISERROR 25000 'This is a test error'

</PRE><P><LI>Create a trigger on the table from which you want this stored
   procedure to run:
<P>
   NOTE: Stored procedures cannot be executed directly from Microsoft
   Access 1.1, unless they are triggered from a SQL Server trigger or the
   SQL pass-thru .DLL file (SPT110.DLL) is used. However, when using
   version 2.0, you can invoke a stored procedure using an SQL pass-
   through query. For this example, you will use a trigger that fires when
   a record is updated.
<P>
<P><PRE>      CREATE TRIGGER TestTrig
      ON Authors
      FOR UPDATE
      AS
<PRE></PRE>        EXECUTE TestProc

</PRE><P><LI>Add the following code to an Access Basic module. The subprocedure
   updates the Authors table (the attached table dbo_authors) in some
   way, and traps the error value that is passed by the RAISERROR()
   function:
<P>
<PRE>      Sub TrapIt ()
          Dim db As Database, Mydyna As Dynaset
          Dim Xerr As String, Xval As Integer,
          Dim Xstart As Integer, Xlen As Integer
          On Error GoTo ErrorHandler
          Set db = CurrentDB()
          Set Mydyna = db.CreateDynaset("select * from dbo_authors;")
          Mydyna.Edit
          Mydyna!au_fname = Mydyna!au_fname
          Mydyna.Update
          Mydyna.MoveNext
          Exit Sub

      ErrorHandler:

      'This routine parses the error string returned from ODBC and
      'extracts only the error value you assigned with the RAISERROR()
      'function in SQL Server.

      'traps the error message
          xerror = Error$
      'finds start of error value
          Xstart = InStr(1, xerror, "#") + 1
      'finds length of error value
          Xlen = InStr(Xstart, xerror, ")") - Xstart
      'extracts error value from string
          Xval = Mid(xerror, Xstart, Xlen)
          MsgBox ("You have encountered error #" &amp; CStr(Xval))
          Resume Next
      End Sub
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IsmPdox kb3rdparty<BR>
Version             : 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
