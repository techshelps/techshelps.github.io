

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC1x: "Invalid Database Object" Error Message </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94600 ">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1993/01/11">
<META NAME="Keywords" CONTENT="JetTrans kberrmsg kbprg MdlTran PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you are trying to use a database object (database, QueryDef, table, dynaset, snapshot) within Access Basic, you may receive the following error message:     Invalid Database Object.  CAUSE =====  The problem occurs if you are within a transact...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAPN,QAW6,QA1S,QAB4,QAY5,QAGB,QDN9,QAB9,QAAW,QBV8,QBXS,QA4F,QAO4,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: "Invalid Database Object" Error Message</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94600 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are trying to use a database object (database, QueryDef,
table, dynaset, snapshot) within Access Basic, you may receive the
following error message:
<P>
<PRE>   Invalid Database Object.

</PRE><h2>CAUSE</h2>
 
<P>
The problem occurs if you are within a transaction, you call
another function or procedure which dimensions the database, and
then leave the function or procedure which implicitly closes the
object that was opened within the transaction.
<P>
In this case Microsoft Access will try to close it and since it was
opened within a transaction, Microsoft Access will roll back all
levels of nested transactions.
<P>
If any other database objects were opened within the transaction,
rolling back has the effect of closing them. This means that any
references to an object opened within a transaction after another
object was forced to be implicitly closed will result in the "Invalid
database object" error message.
<P>
This problem will not occur if you always close database objects
before they go out of scope. The problem only occurs if you let
Microsoft Access implicitly close them.
<P>
<P><h2>RESOLUTION</h2>
 

<UL><LI>You should always try to open database objects outside of
   transactions.

<LI>You should always explicitly close database objects.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Open the sample database NWIND.MDB and enter the following code fragment in
a module to illustrate the problem:
<P>
<PRE>   Function One ()
      Dim MyDB As Database, MyTable As Table

      Set MyDB = CurrentDB()
      BeginTrans
         Set MyTable = MyDB.OpenTable("Employees")
         X = Two()
         Debug.Print MyTable.RecordCount '"Invalid database object."
         MyTable.Close
      CommitTrans
      MyDB.Close
   End Function

   Function Two ()
      Dim MyDB2 As Database
      Set MyDB2 = CurrentDB()
   End Function

</PRE>MyDB loses scope, implicitly rolls back and closes MyDB with the
effect of also closing MyDB in the One() function.
<P>
To circumvent the problem, change the procedure Two to:
<P>
<PRE>   Function Two()
      Dim MyDB2 as Database
      Set MyDB2 = CurrentDB()
      MyDB2.Close
   End Sub
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : JetTrans kberrmsg kbprg MdlTran PgmObj<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
