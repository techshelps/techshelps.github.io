

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Compare a Field to a Field in a Prior Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120273">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1994/09/07">
<META NAME="Keywords" CONTENT="kbusage QrySqlvw">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to compare the values in a record with the values in another record using a subquery. In order to use the method described in this article, the ta...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA7O,QA7N,QANY,QARR,QAKC,QA1S,QAUD,QAPN,QAG7,QAB9,QACE,QBTM,QAKE,QBC6 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Compare a Field to a Field in a Prior Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120273</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to compare the values in a record with the
values in another record using a subquery. In order to use the method
described in this article, the table you are using must have one or more
fields that can be compared using the GREATER THAN (&gt;) or LESS THAN (&lt;)
operator.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to calculate miles per gallon by
subtracting a recorded mileage from the current mileage, and then dividing
by the number of gallons of gasoline recorded in the current record:

<OL><P><LI>Create the following new table, and then save it as MileageRecord. Do
   not create a primary key for the table:
<P>
<P><PRE>      Table: MileageRecord
      -----------------------
      Field Name: Date
      Data Type: Date/Time
      Field Name: Mileage
      Data Type: Number
      Field Size: Single
      Field Name: Gallons
      Date Type: Number
      Field Size: Double
</PRE>
<P><LI>View the table in Datasheet view, and enter the following records in
   the table:
<P>
<PRE>       Date      Mileage   Gallons
       ---------------------------
       7/08/94   12340     14.8
       7/13/94   12700     12.6
       7/18/94   13090     13.7
       7/25/94   13425     11.9

</PRE><P><LI>Create a new, blank query based on the MileageRecord table. Add the
   Date and Mileage fields to the query grid.

<P><LI>Click the Properties button on the toolbar to view the property sheet,
   and then select the title bar of the MileageRecord table. Set the
   table's Alias property to Mile1.

<P><LI>Enter the following expression in the third column in the query grid.
<P>
   NOTE: In the following sample expression, an underscore (_) at the end
   of a line is used as a line-continuation character. Remove the
   underscore from the end of the line when re-creating this expression.
<P>
<P><PRE>      PrevMileage: (Select Max(Mileage) from MileageRecord _
      Where Mileage &lt; Mile1.[Mileage])
</PRE><P>
   This expression is a subquery that finds the highest mileage in the
   MileageRecord table that is less than the mileage of the current
   record.

<P><LI>Enter the following expression in the fourth column in the query grid:
<P>
<P><PRE>      Elapsed: [Mileage] - [PrevMileage]
</PRE><P>
   This field calculates the difference between the current and previous
   mileage entries.

<P><LI>Enter the following expression in the fifth column in the query
   grid:
<P>
<P><PRE>      MPG: ([Mileage] - [PrevMileage]) / Gallons
</PRE><P>
   This field calculates the miles per gallon.

<P><LI>Run the query. Note that you receive the following results:
<P>
<PRE>      Date      Mileage   PrevMileage   Elapsed   MPG
      ------------------------------------------------------------
      7/08/94   12340
      7/13/94   12700     12340         360       28.5714285714286
      7/18/94   13090     12700         390       28.4671532846715
      7/25/94   13425     13090         335       28.1512605042017

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about subqueries, search the Help Index for
"subqueries," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: differential calculus<BR>
Keywords            : kbusage QrySqlvw<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
