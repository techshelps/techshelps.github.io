

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: "Record Lock Threshold Exceeded" with Large Action Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102522">
<META NAME="KBModify" CONTENT="1998/02/24">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="GnlMu kb3rdparty kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  If you exceed the maximum number of locks set per connection for the Novell server, you may receive the following error message on the server:     Record Lock threshold exce...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA5V,QABA,QBXS,QDN9,QABT,QAA8,QAR4,QAPN,QAJ6,QDO3,QA8Y,QAR6,QAB4,QAVZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "Record Lock Threshold Exceeded" with Large Action Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 24, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102522</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
If you exceed the maximum number of locks set per connection for the
Novell server, you may receive the following error message on the server:
<P>
<PRE>   Record Lock threshold exceeded

</PRE>This error can also cause a Netware 3.1x server to stop responding (crash)
that doesn't have the TTS fix installed.
<P>
If you are using Microsoft Access version 2.0 and you have not installed
the Service Pack and you receive reserved error -1106, you might try
installing the Service Pack before installing the Novell Patch.
<P>
For more information about the Service Pack, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q122927.htm">Q122927</A></B>
   TITLE     : WX1124: Microsoft Access Version 2.0 Service Pack

</PRE><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, follow these steps.
<P>
NOTE: The Novell patch mentioned in this article is not needed if you are
running Netware version 3.12 or later.

<OL><P><LI>Obtain the TTSFIX.NLM dynamic patch directly from Novell.
   You can find this file on the World Wide Web at
   <B><A HREF="http://support.novell.com/search/ff_index.htm">http://support.novell.com/search/ff_index.htm.</A></B> Enter TTSFIX.NLM in the
   Enter Filename textbox.
   \** Confirmed on 2/24/98.  --Robdil

<P><LI>Set the Record Lock threshold to 10,000. Even though the server should
   no longer crash, Microsoft Access may still encounter problems when the
   server exceeds the lock count.
<P>
   There are no reports of any problems with the Record Lock threshold
   set to a high value. Even with this maximum set, if the threshold
   is reached, Microsoft Access stops; with the fix, the Novell network
   does not crash.

<P><LI>Load the TTSFIX.NLM dynamic patch on the server to ensure that it
   does not crash if a lock count is exceeded.
<P>
   NOTE: The 311LPTD.ZIP file also contains PATCHMAN.NLM and TTSFIX.NLM.
   We recommend that these files be loaded in the AUTOEXEC.NCF of the
   server. This action requires a LOAD PATCHMAN.NLM, followed by a LOAD
   TTSFIX.NLM in the AUTOEXEC.NCF.
<P>
</OL>The following table details possible lock settings:
<P>
<PRE>                                            Range        Defaults
                                            ---------------------------
#1 SET Maximum record locks per connection: 10-10,000    default 500
#2 SET Maximum file locks per connection:   10-1,000     default 250
#3 SET Maximum record locks:                100-200,000  default 20,000
#4 SET Maximum file locks:                  100-100,000  default 10,000

</PRE></OL>#1 is the setting that should be increased from the default to 10,000.
<P>
NOTE: This behavior is related to the record locks setting on the Novell
server. This behavior is not related to the MS-DOS SHARE.EXE locks setting.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: Microsoft Access 97 has two new features that may be helpful when
working with large action queries: MaxLocksPerFile is a new Jet 3.5
registry setting and UseTransaction is a new query property. Microsoft
Access will split action queries that need more locks than specified by
MaxLocksPerFile into multiple transactions. As long as the value for
MaxLocksPerFile, default value of 9500, is smaller than the record locks
per connection on your Netware server, you won't receive the above error.
<P>
For more information about MaxLocksPerFile, search for "SetOption," and
then "SetOption Method" using the Microsoft Access 97 Help Index. To see
the description of MaxLocksPerFile, click "Initializing the Microsoft Jet
3.5 Database Engine" jump at the bottom of the SetOption Method help topic.
<P>
The products discussed here are manufactured by vendors independent of
Microsoft; we make no warranty, implied or otherwise, regarding these
products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: netware 4.1<BR>
Keywords          : GnlMu kb3rdparty kberrmsg<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 24, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
