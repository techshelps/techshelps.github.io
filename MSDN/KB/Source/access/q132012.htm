

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Unexpected Query Results with Attached xBASE Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132012">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/06/26">
<META NAME="Keywords" CONTENT="IsmXbase kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run a select query based on an attached Microsoft FoxPro or dBASE table with the criteria applied to an indexed field designated as the unique record identifier, the Mic...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QDKY,QA28,QATJ,QA39,QBWS,QAKH,QA7O,QA7N,QAUD,QAPF,QABT,QAHH,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Unexpected Query Results with Attached xBASE Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132012</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run a select query based on an attached Microsoft FoxPro or dBASE
table with the criteria applied to an indexed field designated as the
unique record identifier, the Microsoft Access version 2.0 Service Pack
produces unexpected query results. For example, the query returns only 1
record instead of all the records that match the criteria applied to the
unique record identifier field.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the unique record identifier field contains duplicate values, the
Microsoft Jet database engine version 2.5 returns the first record that
matches the criteria in the query.
<P>
NOTE: This behavior differs from the Jet database engine version 2.0 that
was shipped with Microsoft Access version 2.0. The Jet database engine
version 2.0 returns all the records that match the specified criteria in
the unique record identifier field, not just the first matched record.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, re-attach the table without a unique record
identifier, and then run the query again. To do so, follow these steps:

<OL><P><LI>In your database, delete the attachment to the FoxPro or the dBASE
   table.

<P><LI>Re-attach the table and specify an index file. In the Select Unique
   Record Identifier dialog box, click Cancel to avoid specifying a
   unique identifier.

<P><LI>Run the select query again. Note that you receive all the records
   you expect instead of only 1 record.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Export the Order Details table using the Microsoft FoxPro version 2.6
   format to a new file called ORD_DET.DBF.

<P><LI>Start FoxPro and open the ORD_DET.DBF file.

<P><LI>In FoxPro, to create an index file called ORD_DET.CDX., create an
   index on the Product_Id field by typing the following lines in the
   Command window:
<P>
<P><PRE>      USE ORD_DET
      INDEX ON PRODUCT_ID TAG PRODUCT_ID
      USE
      QUIT
</PRE>
<P><LI>Switch to Microsoft Access and create a new database called TEST.MDB.

<P><LI>In TEST.MDB, attach to ORD_DET.DBF as a FoxPro 2.6 table. Be sure
   to specify ORD_DET.CDX as the index and select Product_Id in the
   Unique Record Identifier dialog box.

<P><LI>Create the following new query and saved it as Query1:
<P>
<P><PRE>      Query: Query1
      ------------------
      Type: Select Query
      Field: Order_Id
<PRE></PRE>         Table: ORD_DET
      Field: Product_Id
         Table: ORD_DET
         Criteria: 24

</PRE><P><LI>Run Query1. Note that only 1 record is returned.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about attaching tables, search for "Attach Table," and
then "Attach Table Command (File Menu)" using the Microsoft Access Help
menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IsmXbase kb3rdparty<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
