

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: "Reserved Error" Message with No Error Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126825">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1995/03/05">
<META NAME="Keywords" CONTENT="FmsEvnt kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the SetFocus method in an event procedure, you receive the error message  Reserved Error  without any other error code or explanation.  CAUSE =====  The form contain...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAB4,QAPN,QAH4,QAAP,QAO4,QA7O,QADK,QDMH,QAOE,QAMN,QAB5,QAI2,QA2O,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: "Reserved Error" Message with No Error Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126825</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the SetFocus method in an event procedure, you receive the
error message "Reserved Error" without any other error code or explanation.
<P>
<P><h2>CAUSE</h2>
 
<P>
The form containing the event procedure is based on a table or query with
no records, and the form is either read-only or its DefaultEditing property
is set to Read Only or Can't Add Records. The SetFocus method must identify
the current record before it can move the focus to another control. If
there are no records and you cannot create a new record, then there is no
current record. An attempt to identify the current record results in an
error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure that the table or query on which the form is based contains at
least one record, or include logic in your event procedure to avoid using
the SetFocus method if there are no records.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The GoToControl action also causes an error under the same circumstances,
but it issues a more informative error (2105, "Can't go to specified
record"). Both the GoToControl action and the SetFocus method attempt to
identify the current record. If the form is based on a table or query with
no records, there is no current record and an error occurs.
<P>
Note that when a form is based on a table or query with no records, none
of the controls in the form's detail section appear, including unbound
controls. Unbound controls in a header or footer section do appear. This
error occurs even when you try to set the focus to an unbound control that
is visible in the form header or footer.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create the following query based on the Employees table:
<P>
<P><PRE>      Query: ReservedErrorsQuery
      --------------------------
      Type: Select Query
      Field: *
<PRE></PRE>         Table: Employees
      Field: Employee ID
         Criteria: &lt; 0

   This query should return no records.

</PRE><P><LI>Modify the Employees form as follows:
<P>
   a. Change the form's RecordSource property to ReservedErrorQuery.
<P>
   b. Change the form's DefaultEditing property to Can't Add Records.

<P><LI>Add an unbound control named MyUnboundCtl to the form header.

<P><LI>Add the following code to the form's OnOpen event procedure:
<P>
<P><PRE>      Me!MyUnboundCtl.SetFocus
</PRE>
<P><LI>View the form in Form view. Note the error message.

<P><LI>Change the code in the OnOpen event procedure to:
<P>
<P><PRE>      DoCmd GoToControl Me!MyUnboundCtl.Name
</PRE>
<P><LI>View the form in Form view. Note the more informative error message.
<P>
</OL><h3>Adding Logic to the Event Procedure</h3>
 
<P>
To avoid generating an error message if there are no records, follow these
steps:

<OL><P><LI>Open the modified Employees form in Design view. Change the code in
   the Open event procedure as follows:
<P>
<P><PRE>      If Me.RecordsetClone.RecordCount &gt; 0 Then
<PRE></PRE>         Me!MyUnboundCtl.SetFocus
      End If

</PRE><P><LI>View the form in Form view. Note that no error message is generated.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsEvnt kberrmsg kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
