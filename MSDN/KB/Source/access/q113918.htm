

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: TraceSQLMode Setting Helps Debug SQL Queries to ODBC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113918">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the *registry. Before you edit the registry, you should first make a backup copy of *the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   Advanced: Re...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QBXS,QBAO,QA9E,QABA,QAY2,QABM,QDIU,QBWC,QA2Q,QAYY,QAX6,QATJ,QAL0 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: TraceSQLMode Setting Helps Debug SQL Queries to ODBC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113918</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 1.1, 2.0, 7.0, 97
</UL> 
<P>
IMPORTANT: This article contains information about editing the *registry.
Before you edit the registry, you should first make a backup copy of *the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access can record all SQL statements sent to an ODBC data
source in a file called Sqlout.txt. You can create this log file by
setting the TraceSQLMode setting to 1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a log file of all the SQL queries sent to ODBC for processing,
do the following.
<P>
<P><h3>In Microsoft Access 7.0 and 97</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems
that may require you to reinstall Windows 95. Microsoft cannot guarantee
that problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys
And Values online Help topic in Registry Editor (Regedit.exe). Note that
you should make a backup copy of the registry files (System.dat and
User.dat) before you edit the registry.
<P>
Set the TraceSQLMode parameter to 1 in the Registry File. Make this
entry to the following registry path:
<P>
In Microsoft Access 97:
<P>
<PRE>   \HKEY_LOCAL_MACHINE\Software\Microsoft\Office\8.0\Access\Jet\3.5\
   Engines\ODBC

</PRE>In Microsoft Access 7.0:
<P>
<PRE>   \HKEY_LOCAL_MACHINE\Software\Microsoft\Access\7.0\Jet\3.0\
   Engines\ODBC

</PRE>Before you can set the TraceSQLMode, you may have to create the ODBC
Key and the TraceSQLMode DWORD value. The Sqlout.txt file generated
is placed in your current directory. You can identify your current
directory by evaluating ?CurDir() in the Debug window.
<P>
For more information about creating this Registry file entry, search
for "TraceSQLMode" using the Find option in the Microsoft Access Help
Topics.
<P>
<P><h3>In Microsoft Access 1.x and 2.0</h3>
 
<P>
Set the TraceSQLMode setting in the [ODBC] section of your Access
.ini file as shown below. The Access .ini file for version 2.0 is
Msacc20.ini and for version 1.x is Msaccess.ini. The Sqlout.txt file
is placed in your Microsoft Access folder.
<P>
The setting is:
<P>
<PRE>   [ODBC]
   TraceSQLMode=1

</PRE>To turn the TraceSQLMode option off, change the setting from 1 to 0.
<P>
NOTE: After setting this option, you must restart Microsoft Access for
the change to take effect. SQL statements sent to an ODBC data source
continue to be recorded in the Sqlout.txt file as long as the
TraceSQLMode setting is set to 1.
<P>
A sample of the SQL statement from the View SQL window in a Microsoft
Access query follows:
<P>
<PRE>   SELECT DISTINCTROW dbo_authors.au_id, dbo_authors.au_lname,
   dbo_authors.au_fname, dbo_authors.phone, dbo_authors.address,
   dbo_authors.city, dbo_authors.state, dbo_authors.zip,
   dbo_authors.contract FROM dbo_authors;

</PRE>Here's a sample Sqlout.txt file:
<P>
<PRE>   ================= Open the attached dbo.authors ==================

   SQLExecDirect: SELECT dbo.authors.au_id FROM dbo.authors
   SQLExecDirect: SELECT au_id,au_lname,au_fname,phone,
   address,city,state,zip,contract  FROM dbo.authors
   SQLPrepare: SELECT au_id,au_lname,au_fname,phone,address,city,
   state,zip,contract  FROM dbo.authors  WHERE au_id = ? OR
   au_id = ? OR au_id = ? OR au_id = ? OR au_id = ? OR
   au_id = ? OR au_id = ? OR au_id = ? OR au_id = ? OR au_id = ?
   SQLExecute: (MULTI-ROW FETCH)
   ===================================================================

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about setting options for ODBC, search the Help
Index for "registry," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about setting options for ODBC, search for "ODBC
Settings" then "Customizing MSACC20.INI Settings" using the Microsoft
Access version 2.0 Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: queries tracing sqltrace<BR>
Keywords            : kbusage OdbcOthr<BR>
Version             : 1.10 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
