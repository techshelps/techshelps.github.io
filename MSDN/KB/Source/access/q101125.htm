

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: SendKeys Macro Action Doesn't Work on Toggle Keys (1.x/2.0) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101125">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/07/06">
<META NAME="Keywords" CONTENT="kbusage McrOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  A SendKeys macro action will not work correctly on the toggle keys CAPS LOCK or SCROLL LOCK. You may see the CAPS LOCK or SCROLL LOCK lights flash on the keyboard, but the l...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBMK,QAPN,QAH4,QA1S,QAY5,QAKR,QBJZ,QAQT,QABG,QAB9,QDN9,QDL9,QBWO,QBWN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: SendKeys Macro Action Doesn't Work on Toggle Keys (1.x/2.0)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101125</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
A SendKeys macro action will not work correctly on the toggle keys
CAPS LOCK or SCROLL LOCK. You may see the CAPS LOCK or SCROLL LOCK
lights flash on the keyboard, but the lights will not remain on and
the keys will not be correctly activated after the SendKeys action is
completed. Note that SendKeys also will not work correctly with the
ALT+PRINT SCREEN key combination.
<P>
<P><h2>CAUSE</h2>
 
<P>
SendKeys keystrokes are sent to applications at a high level. Microsoft
Windows 3.x traps toggle keys and the PRINT SCREEN key at a lower level,
keeping them from your application.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.
<P>
There is a workaround for the CAPS LOCK problem. To force input in a
field into uppercase, set the control's Format property to "&gt;". The
UCase() function can also be used to force entries in a field to
uppercase.
<P>
Although a SendKeys macro action cannot toggle keys, a Windows API
SetKeyboardState() function call can toggle keys. The following
example demonstrates how to use the Windows API SetKeyboardState()
function:

<OL><P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
      Declare Sub GetKeyboardState Lib "User" (ByVal lpKeyState As String)
      Declare Sub SetKeyboardState Lib "User" (ByVal lpKeyState As String)
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function SetKeys ()
      Dim keys As String
      Const VK_CAPITAL = &amp;H14
</PRE><P>
<P><PRE>      keys = Space$(256)
</PRE><P>
<P><PRE>      GetKeyboardState keys
</PRE><P>
<P><PRE>      If &amp;H1 = (Asc(Mid(keys, VK_CAPITAL + 1, 1)) And &amp;H1) Then
<PRE></PRE>          keys = Left(keys, VK_CAPITAL) &amp; Chr(0) &amp; Right(keys, Len(keys) _
             - (VK_CAPITAL + 1))
      Else
          keys = Left(keys, VK_CAPITAL) &amp; Chr(1) &amp; Right(keys, Len(keys) _
            - (VK_CAPITAL + 1))
      End If

      SetKeyboardState keys

      End Function

</PRE><P><LI>To test this function, type the following line in the Immediate window,
   and then press ENTER:
<P>
<P><PRE>      ? SetKeys()
</PRE><P>
   Note that the CAPSLOCK key will toggle from whatever state it was in
   previously.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following SendKeys action will not toggle the CAPS LOCK key to on:
<P>
<PRE>   MacroName       Action
   ----------------------
   Macro1          SendKeys

   Macro1 Actions
   --------------------------
   SendKeys
      Keystrokes:  {CAPSLOCK}
      Wait:        NO

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about SendKeys, search for "SendKeys Statement" using
the Microsoft Access Help Menu.
<P>
For more information about API functions, search for "API" using the
Microsoft Access Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: send key num<BR>
Keywords            : kbusage McrOthr<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
