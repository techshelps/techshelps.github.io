

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC1x: How to List Related Tables in a Database in Version 1.x </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88653 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1992/08/30">
<META NAME="Keywords" CONTENT="RltOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Although you can create relationships among tables in your database, there is no inherent Microsoft Access command to gather this information and present it in a meaningful way. Sometimes this information can be helpful, for instance, to find the s...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QBJZ,QBMW,QDNC,QDNA,QBWS,QA1S,QAG2,QACF,QAZV,QAY2,QAPN,QARR,QANE,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to List Related Tables in a Database in Version 1.x</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88653 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although you can create relationships among tables in your database, there
is no inherent Microsoft Access command to gather this information and
present it in a meaningful way. Sometimes this information can be helpful,
for instance, to find the source table of a referential integrity
violation. This article discusses how you can use a series of queries to
gather and relate information you need from the system tables MSysObjects,
MSysColumns, and MSysIndexes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To gather information and present it in a meaningful way, you can create a
query containing two columns. The first column, called Primary.Name, will
contain a table name. The second column, called Foreign.Name, will
represent the table that the Primary.Name table is related to.
<P>
Because the information will be coming from the system tables mentioned
above, you must make sure you have access rights to these tables.
MSysObjects has these rights by default. To give yourself access rights to
MSysIndexes and MSysColumns, follow these steps:

<OL><P><LI>In the Database Window menu, select the View menu, and then choose
   Options.

<P><LI>Change the Show System Objects setting to Yes, and then choose the
   OK button.

<P><LI>From the Database Window menu, choose the Permissions command from
   the Security menu.

<P><LI>In the following dialog box, choose Table for the Object Type
   prompt, and then choose MSysIndexes for the Object Name prompt.

<P><LI>In the Permissions box at the bottom of the dialog box, select the
   Full Permissions box.

<P><LI>Click Assign, and then choose the Close button. Repeat steps 4 and
   5 for MSysColumns.

<P><LI>From the View menu at the top of the screen, choose Options.

<P><LI>Change Show System Objects to No, and then choose the OK button.
<P>
</OL>At this point, you can begin building the queries that will retrieve
the relationship information. To do so, follow these steps:

<OL><P><LI>In the Database window, choose the Query button, and then choose New.
   Note that a query design screen appears, along with a dialog box
   asking for a Table/Query to add to the query. Choose Close so that the
   query design grid is blank.

<P><LI>From the View menu, choose SQL, and delete any contents that appear in
   the SQL dialog box.

<P><LI>Enter the following SQL statement into the SQL window:
<P>
<P><PRE>      SELECT DISTINCTROW
<PRE></PRE>         MSysObjects.Name, MSysObjects.Id
      FROM MSysObjects
      WHERE ((MSysObjects.Type=1)
      AND (MSysObjects.Flags Is Null Or MSysObjects.Flags&lt;&gt;2))
      ORDER BY MSysObjects.Name;

</PRE><P><LI>Choose OK. Close and save the query as psi User Tables.

<P><LI>Repeat steps 1 through 3, substituting the SQL statement in step 3
   with the following SQL statement:
<P>
<P><PRE>      SELECT DISTINCTROW [Tables].Name AS Table,
<PRE></PRE>         MSysColumns.Name AS Field,
         [Tables].Id AS [Primary Id]
      FROM [psi User Tables] AS Tables, MSysColumns, Tables
      INNER JOIN MSysColumns ON [Tables].Id = MSysColumns.ObjectId
      ORDER BY [Tables].Name, MSysColumns.PresentationOrder;

</PRE><P><LI>Choose OK, and then close and save the query as psi User Tables
   Field List.

<P><LI>Repeat steps 1 through 3, substituting the SQL statement in step 3
   with the following SQL statement:
<P>
<P><PRE>      SELECT DISTINCTROW Primary.Name, Foreign.Name
      FROM [psi User Tables] AS Primary, MSysIndexes, [psi User Tables]
<PRE></PRE>         AS Foreign, MSysIndexes AS LKeyName, LKeyName
      INNER JOIN MSysIndexes ON LKeyName.Idxid = MSysIndexes.Idxid,
         LKeyName
      INNER JOIN MSysIndexes ON LKeyName.ObjectId = MSysIndexes.ObjectId,
         Primary
      INNER JOIN MSysIndexes ON Primary.Id = MSysIndexes.ObjectId,
         Foreign INNER JOIN MSysIndexes ON Foreign.Id =
         MSysIndexes.ObjectIdReference
      WHERE ((MSysIndexes.ObjectIdReference&lt;&gt;0)
         AND (MSysIndexes.Operation=2)
         AND (LKeyName.Operation=0))
      ORDER BY Primary.Name, Foreign.Name;

</PRE><P><LI>Choose OK. Close and save the query as psi Relationships.

<P><LI>To view the Relationships table, highlight the psi Relationships query
   in the Database window and choose the Open button.
<P>
</OL>With this query, you can create reports or use the query in any other
way that you would normally use a Microsoft Access query to make use of
the information.
<P>
Another way to display database information is to use the Database
Analyzer tool. For more information about this tool, see the PSSKB.TXT
file, question 23, or choose the Microsoft Access Q&amp;A icon in the
Microsoft Access group in Program Manager.
 
<PRE>Keywords          : RltOthr kbusage
Version           : 1.0 1.1
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
