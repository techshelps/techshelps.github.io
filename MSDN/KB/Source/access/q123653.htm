

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Error Message Adding Record to Subform </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123653">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="FmsSubf kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you try to add a new record to a subform, you receive the following error message:     In Microsoft Access 97:        An error occurred while referencing the object. You tri...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QAB4,QA5V,QA7O,QA7N,QAUJ,QDN9,QAMA,QAAP,QBS0,QDN7,QBBI,QARM,QBXS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Error Message Adding Record to Subform</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123653</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you try to add a new record to a subform, you receive the following
error message:
<P>
<PRE>   In Microsoft Access 97:

      An error occurred while referencing the object. You tried to run a
      Visual Basic procedure that improperly references a property or
      method of an object.

   In Microsoft Access 7.0:

      An error occurred while referencing the OLE Automation object. You
      tried to run a Visual Basic procedure that improperly references a
      property or method of an OLE Automation object.

   In Microsoft Access 1.x or 2.0:

      Can't set value.

</PRE><h2>CAUSE</h2>
 
<P>
This error can occur if the subform's LinkChildFields property contains the
name of a form property.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the name contained in the subform's LinkChildFields property and the
name of the associated field in the underlying table to something other
than the name of a form property.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you add a record to a linked subform, Microsoft Access sets the value
from the field on the main form specified in the subform's LinkMasterFields
property to the field on the subform specified in the subform's
LinkChildFields property. If the field specified in the LinkChildFields
property is the name of a form property, Microsoft Access tries to set the
value of that property for the form instead of the field. Note that this
behavior is normal, and the values will therefore update normally
after displaying the error.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and create a new database.

<P><LI>Create the following two tables:
<P>
<P><PRE>      Table Name: OneSideTable
      ------------------------
      Field Name: AName
      Data Type: Text
</PRE><P>
<P><PRE>      Set the AName field as the primary key for the OneSideTable table.
</PRE><P>
<P><PRE>      Table Name: ManySideTable
      -------------------------
      Field Name: Num
      Data Type: Number
      Field Name: Parent
      Data Type: Text
</PRE><P>
   Note that Parent is the name of a form property.

<P><LI>Create a one-to-many relationship between the OneSideTable table and the
   ManySideTable table using the OneSideTable table as the primary table.
   Join the AName field with the Parent field to create the relationship.
   Enforce referential integrity.

<P><LI>Use the Form Wizard to create a main form and subform. Use the
   OneSideTable table for the main form, and the ManySideTable table
   for the subform.

<P><LI>Open the main form in Form view and then try to add a record to the
   subform. You receive the error message stated above. Once you click
   OK you can add the new record.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the LinkChildFields and LinkMasterFields
properties, search the Help Index for "LinkChildFields," or ask the
Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: setvalue<BR>
Keywords            : FmsSubf kberrmsg kbusage<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
