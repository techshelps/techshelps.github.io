

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: OnError Property Does Not Trap Locking Error in Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116065">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1994/06/09">
<META NAME="Keywords" CONTENT="FmsProp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you have a form's RecordLocks property set to No Locks and a multiuser record locking error occurs, the form's Error event is not triggered, and the normal  This record has be...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA5V,QAAP,QAB4,QAPN,QAO4,QABI,QAGU,QAKP,QBJZ,QAJZ,QAEF,QBWS,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: OnError Property Does Not Trap Locking Error in Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116065</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you have a form's RecordLocks property set to No Locks and a multiuser
record locking error occurs, the form's Error event is not triggered, and
the normal "This record has been changed by another user since you started
editing it..." dialog box appears.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Error event is triggered when a run-time error is produced in Microsoft
Access. The multiuser record locking error mentioned above is not a
trappable run-time error.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access
version 2.0. This problem no longer occurs in Microsoft Access
version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Error event is triggered when a run-time error is produced in Microsoft
Access. If you set the form's OnError property to a macro or event
procedure, Microsoft Access will run the macro or event procedure when a
run-time error occurs.
<P>
If you set a form's RecordLocks property to No Locks, no error will be
trapped when two users modify the same record at the same time. Instead,
Microsoft Access will display a dialog box to the user who attempted to
save the record last, prompting the user to save the changes, discard the
changes, or copy the changes to the Clipboard.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB. Make sure to clear the Exclusive
    check box in the Open Database dialog box.

<P><LI>Open the Employees form in Design view.

<P><LI>Set the form's OnError property to:
<P>
       =MsgBox("An error has occurred.")

<P><LI>From the View menu, choose Options.

<P><LI>In the Category box, select Multiuser/ODBC. In the Items box, set
    Default Record Locking to No Locks.

<P><LI>Save and close the Employees form.

<P><LI>Start another instance of Microsoft Access, or start Microsoft Access
    on another computer.

<P><LI>In the second instance of Microsoft Access, or on the other computer,
    open the same NWIND.MDB file. Make sure to clear the Exclusive check
    box in the Open Database dialog box.

<P><LI>In both copies of Microsoft Access, open the Employees form in Form
    view.

<P><LI>In both copies of Microsoft Access, edit the Title field of the first
    record.

<P><LI>In the second copy of Microsoft Access, move to the next record.

<P><LI>In the first copy of Microsoft Access, move to the next record. Note
    that the Error event is not triggered.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Error events, search for "error events," and
then "Error and Timing Events" using the Microsoft Access Help menu.
<P>
Microsoft Access "User's Guide," version 2.0, pages 107 and 224
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: optimistic<BR>
Keywords            : FmsProp kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
