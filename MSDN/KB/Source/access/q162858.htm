

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Error "Invalid key" When Adding Node to TreeView Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162858">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1997/01/29">
<META NAME="Keywords" CONTENT="IntpCstm kbcode kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  When you try to use the Add method of the Node object with the TreeView Custom Control, you may receive the following error message:     Run-time error '35603':    Invalid ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAB4,QA28,QATJ,QAHE,QBXS,QAAP,QA7O,QAOE,QAMN,QAB5,QAB9,QA1S,QADZ,QAX6 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Error "Invalid key" When Adding Node to TreeView Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162858</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
When you try to use the Add method of the Node object with the TreeView
Custom Control, you may receive the following error message:
<P>
<PRE>   Run-time error '35603':
   Invalid key

</PRE>NOTE: The TreeView control is only available if you have installed the
Microsoft Access Developer's Toolkit version 7.0, or the Office 97
Developer Edition.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Item Method, which can be used to return a specific member of the Nodes
collection, takes one argument. If this argument is a numeric expression,
the Item method searches for the Node by index; if the argument is a string
expression, the Item method searches for the Node by key. Because this
argument is a Variant, the Item method cannot distinguish a key expression
from an index expression unless that expression contains at least one non-
numeric character.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Concatenate at least one non-numeric character to the expression in the key
argument of the Add method. For example, add a node by using
<P>
<PRE>   Set Node = Me!CustOrders.Nodes.Add(, , "Node " &amp; rst!OrderID,
   CStr(rst!OrderID))

</PRE>instead of
<P>
<PRE>   Set Node = Me!CustOrders.Nodes.Add(, , rst!OrderID, CStr(rst!OrderID))

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new form not based on any table or query.

<P><LI>Insert a TreeView Control and name it CustOrders.

<P><LI>Set the form's OnLoad property to the following [Event Procedure]
<P>
<P><PRE>     Private Sub Form_Load()
<PRE></PRE>         Dim db As DATABASE, rst As Recordset
         Dim Node As Object
         Set db = CurrentDb()
         Set rst = db.OpenRecordset("Orders", dbOpenDynaset)
         If rst.RecordCount &gt; 0 Then
             Do Until rst.EOF
                 Set Node = Me!CustOrders.Nodes.Add(, , _
                         st!OrderID,cstr(rst!OrderID))
                 rst.MoveNext
             Loop
         End If
         rst.Close
         db.Close
     End Sub

</PRE><P><LI>Open the form in Form View. Note that you receive the following error
   message:
<P>
<P><PRE>      Run-time error '35603':
      Invalid Key
</PRE><P>
   The error occurs even if you use the Cstr() function with the key
   argument (the third argument of the Add method).
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Add method of the Node object, search the
Help Index for "Add Method," and then "Add Method (Nodes Collection)."
<P>
For more information about the Item method, search the Help Index for "Item
method."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpCstm kbcode kberrmsg<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
