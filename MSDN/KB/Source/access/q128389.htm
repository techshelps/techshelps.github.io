

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Cannot Export Run Time Font Style Changes to RTF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128389">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/03/30">
<META NAME="Keywords" CONTENT="kbusage OtpRtf">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you conditionally set the font styles for a report's controls using a section's OnFormat property, the changes are lost when you choose the Output To command to save the report as a Rich Text Format (RTF) file. For example, if you change a con...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDMF,QBJZ,QBXS,QA7O,QBWS,QAPN,QAGU,QAMN,QAB5,QA1S,QDNG,QA5V,QA5A,QA3Z,QA3Y V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Cannot Export Run Time Font Style Changes to RTF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128389</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you conditionally set the font styles for a report's controls using a
section's OnFormat property, the changes are lost when you choose the
Output To command to save the report as a Rich Text Format (RTF) file. For
example, if you change a control's FontUnderline, FontItalics, or
FontWeight property at run time, the change does not appear when you output
the report to an RTF file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, you can use the following steps to stack two
bound controls (one with font styles and one without font styles) on each
other, and set the Visible property to specify which control is displayed
at run time:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Make a copy of the Employee Sales Subreport report, and name it
    RTF_FIX.

<P><LI>Open the RTF_FIX report in Design view.

<P><LI>If the field list is not displayed, choose Field List from the View
    menu. Drag the Employee Sales field from the field list so that it is
    on top of the existing Employee Sales control in the detail section.
    This new control has the name Field6 by default.

<P><LI>Delete the label associated with the Field6 control.

<P><LI>Set the following properties for the Field6 field:
<P>
       Format: Currency
       BorderStyle: Clear
       FontUnderline: Yes
<P>
    NOTE: This example sets only the FontUnderline property. To set the
    FontItalics or FontWeight properties, repeat the steps above for those
    properties.

<P><LI>Set the detail section's OnFormat property to the following event
    procedure:
<P>
<PRE>       Sub Detail1_Format (Cancel As Integer, FormatCount As Integer)
          If [Employee Sales] &gt; 50000 Then
             Me![Field6].visible = -1
             Me![Employee Sales].visible = 0
          Else
             Me![Field6].visible = 0
             Me![Employee Sales].visible = -1
          End If
       End Sub

</PRE><P><LI>From the File menu, choose Print Preview. Note that sales that are
    greater than $50,000 are underlined.

<P><LI>From the File menu, choose the Output To command.

<P><LI>In the Select Format list box, select Rich Text Format (*.rtf), and
    then choose the OK button.

<P><LI>In the File Name box, type the filename "TESTFIX.RTF" (without the
    quotation marks), and then choose OK.

<P><LI>Open the TESTFIX.RTF file in a word processor (such as Microsoft Word
    for Windows) that supports the RTF format. Note that sales amounts
    exceeding $50,000 are underlined.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
When Microsoft Access outputs data to an RTF file, it uses the first data
record to determine the format for that section. If a control in the first
record is underlined, that control is underlined for all subsequent records
in the RTF file. Microsoft Access ignores any format changes after the
first record.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Make a copy of the Employee Sales Subreport, and name it RTF_Test.

<P><LI>Open the RTF_Test report in Design view.

<P><LI>Set the detail section's OnFormat property to the following event
   procedure:
<P>
<PRE>      Sub Detail1_Format (Cancel As Integer, FormatCount As Integer)
         If [Employee Sales] &gt; 50000 Then
           Me![Employee Sales].fontunderline = True
         Else [Employee Sales].fontunderline = False
         End If
      End Sub

</PRE><P><LI>From the File menu, choose Print Preview. Note that sales greater
   than $50,000 are underlined.

<P><LI>From the File menu, choose the Output To command.

<P><LI>In the Select Format list box, select Rich Text Format (*.rtf), and then
   choose the OK button.

<P><LI>In the File Name box, type "TEST.RTF" (without quotation marks),
   and then choose OK.

<P><LI>Open TEST.RTF in a word processor (such as Microsoft Word for
   Windows) that supports the RTF format. Note that sales exceeding
   $50,000 are not underlined.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Output To command, search for "Output To"
then "Output To Command (File Menu)" using the Microsoft Access Help
menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage OtpRtf<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
