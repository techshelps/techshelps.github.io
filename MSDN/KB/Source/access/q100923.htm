

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Sample Macro for Repair/Compact Operations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100923">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1993/06/30">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates a sample macro that repairs and compacts a database.  MORE INFORMATION  The sample macro in this article automates the process of compacting and repairi...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAZV,QAH4,QDN9,QAR4,QAVX,QAVW,QAPN,QAF0,QAUD,QAUJ,QANS,QBV8,QDKY,QADN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sample Macro for Repair/Compact Operations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100923</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates a sample macro that repairs and compacts a
database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The sample macro in this article automates the process of compacting and
repairing a database. It repairs a database called MYDB, and compacts it to
a new database called NewDB. The macro will only prompt for information if
the name of the database it is compacting to already exists.
<P>
NOTE: The macro must be run from a different database than the one you want
to repair and compact.
<P>
In Microsoft Access 97, create the following macro:
<P>
<PRE>   Macro Name       Action
   ----------------------------
   Test             SetWarnings
                    SendKeys
                    RunCommand
                    SendKeys
                    RunCommand
                    SetWarnings

   Test Actions
   -----------------------------------------
   SetWarnings
      WarningsOn: No
   SendKeys
      Keystrokes: Mydb.mdb{enter}
      Wait: No
   RunCommand
      Command: RepairDatabase
   SendKeys
      Keystrokes: Mydb.mdb{enter}NewDB{enter}
      Wait: No
   RunCommand
      Command: CompactDatabase
   SetWarnings
      Warnings On: Yes

</PRE>In Microsoft Access 7.0, create the following macro:
<P>
<PRE>   Macro Name       Action
   ----------------------------
   Test             SetWarnings
                    SendKeys
                    DoMenuItem
                    SendKeys
                    DoMenuItem
                    SetWarnings

   Test Actions
   -----------------------------------------
   SetWarnings
      WarningsOn: No
   SendKeys
      Keystrokes: Mydb.mdb{enter}
      Wait: No
   DoMenuItem
      Menu Bar: Startup
      Menu Name: Tools
      Command: Database Utilities
      SubCommand: Repair Database
   SendKeys
      Keystrokes: Mydb.mdb{enter}NewDB{enter}
      Wait: No
   DoMenuItem
      Menu Bar: Startup
      Menu Name: Tools
      Command: Database Utilities
      SubCommand: Compact Database
   SetWarnings
      Warnings On: Yes

</PRE>In Microsoft Access version 2.0 and 1.x, create the following macro:
<P>
<PRE>   Macro Name       Action
   ----------------------------
   Test             SetWarnings
                    SendKeys
                    DoMenuItem
                    SendKeys
                    DoMenuItem
                    SetWarnings

   Test Actions
   ------------------------------------------------------------
   SetWarnings
      WarningsOn: No
   SendKeys
      Keystrokes: MYDB.MDB{enter}
      Wait: No
   DoMenuItem
      Menu Bar: Startup (in Microsoft Access version 1.x = Init)
      Menu Name: File
      Command: Repair Database
   SendKeys
      Keystrokes: MYDB.MDB{enter}NewDB{enter}
      Wait: No
   DoMenuItem
      Menu Bar: Startup (in Microsoft Access version 1.x = Init)
      Menu Name: File
      Command: Compact Database
   SetWarnings
      Warnings On: Yes

</PRE><h3>Notes</h3>
 

<UL><LI>In most cases this macro works fine. However, remember that keystrokes
   sent by the SendKeys action are buffered temporarily and that results
   may vary. A large database may take extra time to compact or repair; in
   this case, the macro may not exhibit expected behavior.

<LI>In Microsoft Access 2.0, you can use new command-line options to create
   an icon in Program Manager to compact or repair your database. You can
   also use the data access objects (DAO) methods CompactDatabase and
   RepairDatabase from Access Basic.

<LI>In Microsoft Access 7.0 and 97 you can use command-line options to
   create a shortcut on your desktop to compact or repair your database.
   You can also use the data access objects (DAO) methods CompactDatabase
   and RepairDatabase from Visual Basic for applications.

<LI>In Microsoft Access 97, you do not have to close the current database
   in order to repair it or compact it. On the Tools menu, point to
   Database Utilities and then click Compact Database or Repair Database.
   Microsoft Access automatically closes and reopens the database after the
   compact or repair command is finished.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information about command line, CompactDatabase, or RepairDatabase
search the Help Index for "command line", "CompactDatabase", or
"RepairDatabase."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
