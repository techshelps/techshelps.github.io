

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Use a Secured Database in Word Mail Merge </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120810">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1994/09/20">
<META NAME="Keywords" CONTENT="IntpDde IntpPrtm kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  To access a secured Microsoft Access database using ODBC or DDE, you must log on using a valid Microsoft Access account. Microsoft Word for Windows will not open a merge doc...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QALI,QDME,QAIH,QBWS,QDKY,QAZV,QDN9,QAK7,QA2Q,QAG2,QAI5,QABT,QA9E,QAVY P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use a Secured Database in Word Mail Merge</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120810</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 2.0, 7.0, 97
<LI>Microsoft Word for Windows versions 6.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
To access a secured Microsoft Access database using ODBC or DDE, you must
log on using a valid Microsoft Access account. Microsoft Word for Windows
will not open a merge document if you do not have Read Data permission on
the table or query that is specified as the data source.
<P>
This article describes how to use a secured Microsoft Access database in a
Microsoft Word for Windows mail merge.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article describes how to complete the following tasks to set up an
example of using a secured Microsoft Access database in a Word mail
merge:

<UL><LI>Creating a merge document in Word, using DDE to access the secured
   database as the data source.

<LI>Creating a merge document in Word, using ODBC to access the secured
   database as the data source.
<P>
</UL>Detailed instructions for these tasks are listed below.
<P>
<P><h3>Create a Merge Document in Word, Using DDE to Access the Secured Database</h3>
 

<OL><P><LI>Start Word and create a new document. Save the document as
    TESTMRG.DOC.

<P><LI>On the Tools menu, click Mail Merge. Click the Create button,
    select Form Letters, and then click the Active Window button.

<P><LI>Click the Get Data button, select Open Data Source, and then in the
    Files Of Type box, select MS Access Databases (*.mdb).

<P><LI>Locate and select the secured database you created. In Word version
    6.0, select the Confirm Conversions check box, and then click OK. In
    Word 7.0 and 97, select the Select Method check box, and then click
    Open.

<P><LI>Select MS Access Databases Via DDE, and then click OK.

<P><LI>When you are prompted, enter the user name and password for the
    account that has permissions, and then click OK.
<P>
    NOTE: If you are using Microsoft Access 97 and have set a Database
    password for the database you are trying to open, you will have
    to enter that password when prompted.

<P><LI>Select the Mailing List table, click OK, and then click the
    Edit Main Document button.

<P><LI>Click the Insert Merge Field button on the Mail Merge toolbar. Add
    several fields to the document.

<P><LI>Click the Merge To New Document button on the Mail Merge toolbar
    and verify that the merge is successful.

<P><LI>After saving, try to reopen the document. When you are prompted,
    enter user information for an account that should not have
    permissions. Verify that the document fails to open.
<P>
</OL><h3>Create a Merge Document in Word, Using ODBC to Access the Secured Database</h3>
 

<OL><P><LI>Follow steps 1-4 in section 2 above.

<P><LI>Select "MS Access &lt;x.x&gt; Databases via ODBC," and then click OK.

<P><LI>When you receive a message stating that the default login is invalid,
   click OK, and then enter the user name and password for the account
   that has permissions. Click OK.

<P><LI>Select the Mailing List table, click OK, and then click the Edit Main
   Document button.

<P><LI>Click the Insert Merge Field button on the Mail Merge toolbar. Add
   several fields to the document.

<P><LI>Click the Merge To New Document button on the Mail Merge toolbar
   and verify that the merge is successful.
<P>
</OL>You can create new ODBC data sources using the ODBC icon in Control
Panel. Creating a new ODBC data source with the 32-bit Microsoft Access
driver lets you specify the default database, user name, and workgroup file
(SYSTEM.MDW).
<P>
NOTE: If you are using a version of Microsoft Access earlier than 7.0, you
will only be allowed to specify the default database and user name.
<P>
To avoid being prompted for a user name and password each time you open
the document, add this information to the connect string programmatically.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For information about creating a WordBasic macro to set the connect
string, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WORD/Q110334.htm">Q110334</A></B>
   TITLE     : WordBasic Examples Using ODBC: MailMergeOpenDataSource

</PRE></OL>For information about securing a database in Microsoft Access version
2.0, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q132143.htm">Q132143</A></B>
   TITLE     : ACC2: Overview of How to Secure a Microsoft Access Database

</PRE>For information about securing a database in Microsoft Access 97, search
the Help Index for "How do I secure a database."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpDde IntpPrtm kbinterop<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
