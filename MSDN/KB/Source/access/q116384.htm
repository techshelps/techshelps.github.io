

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Using the Shell() Function to Run MS-DOS Commands </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116384">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1994/06/20">
<META NAME="Keywords" CONTENT="kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes and gives an example of how you can use the Shell() function in Access Basic to run intrinsic MS-DOS commands, such as Copy, Dir, Del, and so on.  This art...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBV8,QAB9,QAY5,QDN9,QAMA,QA5F,QANE,QBIC,QA6A,QAUD,QBWO,QAFI,QAH4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using the Shell() Function to Run MS-DOS Commands</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116384</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes and gives an example of how you can use the Shell()
function in Access Basic to run intrinsic MS-DOS commands, such as Copy,
Dir, Del, and so on.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Shell() function in Access Basic requires that you specify a file that
has an extension of .EXE, .COM, .BAT or .PIF. These file types are
registered as executable applications in the listed locations in the
following operating environments:
<P>
<PRE>   Windows 3.x and Windows for Workgroups 3.x
   ------------------------------------------
   Filename: WIN.INI
   Section: [windows]
   Item: Programs=com exe bat pif

   Windows NT 3.x
   ----------------------------------------------------------------------
   Filename: REGEDT32.EXE
   Registry Key:
   HKEY_CURRENT_USER\Software\Microsoft\WindowsNT\CurrentVersion\Windows
   Value: Programs
   Type: REG_SZ
   Item: com exe bat pif cmd

</PRE>Using the Shell() function to run MS-DOS commands requires the use of
the COMMAND.COM program. The COMMAND.COM program supports two optional
parameters that you can use to run an intrinsic (or built in) MS-DOS
function:

<UL><LI>COMMAND /C:  This syntax runs a built in function, and then closes
<PRE>                the MS-DOS session.

</PRE><LI>COMMAND /K:  This syntax runs a built in function and returns the
<PRE>                MS-DOS command prompt.

</PRE></UL><h3>Example</h3>
 
<P>
To create a sample application that demonstrates the use of these
techniques, follow these steps:

<OL><P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following two functions:
<P>
<P><PRE>      Function ShellDOS_Exit() As Integer
<PRE></PRE>         On Local Error Goto ShellDOS_Exit_Err
         Dim MyCommand As String
         Dim TaskId As Integer
         ' Create command string to show the contents of current
         ' directory. Upon completion the window closes.
         MyCommand = "COMMAND.COM /C DIR /P"
         TaskId = Shell(MyCommand, 1)
         ShellDOS_Exit = True
      ShellDOS_Exit_End:
         Exit Function
      ShellDOS_Exit_Err:
         MsgBox Error$
         Resume ShellDOS_Exit_End
      End Function

      Function ShellDOS_Stay() As Integer
         On Local Error Goto ShellDOS_Stay_Err
         Dim MyCommand As String
         Dim TaskId As Integer
         ' Create command string to show the contents of current
         ' directory. Upon completion the window remain opens
         ' at the MS-DOS prompt.
         MyCommand = "COMMAND.COM /K DIR /P"
         TaskId = Shell(MyCommand, 1)
         ShellDOS_Stay = True
      ShellDOS_Stay_End:
         Exit Function
      ShellDOS_Stay_Err:
         MsgBox Error$
         Resume ShellDOS_Stay_End
      End Function

</PRE><P><LI>To test the first function, type the following line in the Immediate
   window, and then press ENTER:
<P>
<P><PRE>      ? ShellDOS_Exit()
</PRE><P>
   Note that the MS-DOS window displays the contents of the current
   directory (prompting you to press a key if the contents of the
   directory exceeds one display page) and returns True as a result
   of the function.

<P><LI>To test the second function, type the following line in the Immediate
   window, and then press ENTER:
<P>
<P><PRE>      ? ShellDOS_Stay()
</PRE><P>
   Note that the MS-DOS window displays the contents of the current
   directory (prompting you to press a key if the contents of the
   directory exceeds one display page) and then keeps the MS-DOS
   session open and active, displaying the MS-DOS command prompt. The
   function also returns True as a result.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 5, "Access
Basic Fundamentals," pages 113-132
<P>
Microsoft Access "Language Reference," version 2.0, "Shell Function,"
pages 568-569
<P>
For more information about the Shell() function, search for "Shell," and
then "Shell Function" using the Microsoft Access Help menu.
<P>
For more information about using MS-DOS commands in Access Basic and on how
to add additional functionality to these routines, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q99940.htm">Q99940</A></B>
   TITLE     : ACC: How to Wait for a Shelled Process to Finish
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg PgmHowto<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
