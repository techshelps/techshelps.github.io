

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC1x: How to Create a Table with Access Basic Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88157 ">
<META NAME="KBModify" CONTENT="1997/08/06">
<META NAME="KBCreate" CONTENT="1992/08/18">
<META NAME="Keywords" CONTENT="TblModfy kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  There is no command in Microsoft Access to programmatically create a table. This article demonstrates a method and a user-defined Access Basic function you can use to accomplish this task. The user-defined function requires a  template table  that ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QATX,QA36,QDN9,QA5F,QAMA,QAMB,QA4Q,QAB9,QAH4,QARR,QDKS,QAZQ,QAPN,QAP2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Create a Table with Access Basic Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88157 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There is no command in Microsoft Access to programmatically create a
table. This article demonstrates a method and a user-defined Access Basic
function you can use to accomplish this task. The user-defined function
requires a "template table" that you can create.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Create the template table before you create the user-defined function. The
template table is used to define the data types that will be used in the
new table.
<P>
For example, in the template table below, the user has created a data type
called Long Text, which is a 255-character Text field. The user has also
created data types called Short Text, Long Int, and so on.
<P>
<PRE>   Table Name: MyTemplate
   ----------------------

   Field Name     Field Type     Length
   ------------------------------------

   Long Text      Text           255
   Short Text     Text           50
   Long Int       Number         Long Integer
   Integer        Number         Integer
   Memo           Memo           N/A
   Date/Time      Date/Time      N/A
   OLE Object     OLE Object     N/A

</PRE>This template can be used as a generic template for using the CreateTable
procedure. Once you have defined your data types in a template table, you
can use the CreateTable procedure in the following manner:
<P>
<P><h3>Definition</h3>
 
<P>
CreateTable &lt;target table&gt;, &lt;template table&gt;, &lt;structure definition&gt;
<P>
<PRE> Where:

    &lt;target table&gt; is the name of the table to create and MUST NOT exist
    in the database. You may want to code a routine to check for the
    existence of such a table before invoking this procedure.

    &lt;template table&gt; contains the user-defined data types that will be
    used in creating the target table.

    &lt;structure definition&gt; defines the structure of the columns in the
    table.

 Where:

    &lt;structure definition&gt; = "&lt;field name&gt; As &lt;user-defined data
    type&gt;,..."

</PRE>NOTE: There are quotation marks around the entire &lt;structure definition&gt;
parameter.
<P>
Below is an example of how you would invoke the CreateTable procedure
to create a table based on the template table discussed earlier:
<P>
<PRE>   CreateTable "NewTable",
               "MyTemplate",
               "First Name As Short Text,
                Last Name As Short Text,
                Description As Long Text,
                Amount As Integer,
                Notes As Memo"

</PRE><h3>How CreateTable Works</h3>
 
<P>
As mentioned earlier, there is no Access Basic command or function to
create a table. Fortunately, Microsoft Access supports the SQL SELECT INTO
command that can be used to create a table. However, SELECT INTO requires
a table for its FROM clause, which explains why you need to have a
template table.
<P>
CreateTable parses the structure definition, then builds a SELECT INTO
statement based on that definition. Once the SQL statement is built, the
QueryDef object is employed to invoke the command, resulting in a new
table.
<P>
<P><h3>Procedure Listing</h3>
 
<P>
NOTE: In the following sample code, an underscore (_) is used as a line
continuation character. Remove the underscore from the end of the line
when re-creating this code in Access Basic.
<P>
<PRE>   Sub CreateTable (TargetTbl As String, TemplateTbl As String,
      StructureDef As String)

      Dim LineChunk As String, SelectStmt As String, TempChunk As String
      Dim CharPos As Integer, HomePos As Integer, BuildLoop As Integer
      Dim CrtTblDB As Database, CrtTblQry As QueryDef

      BuildLoop = True
      HomePos = 1
      SelectStmt = "Select "

      Do While BuildLoop
         If InStr(HomePos, StructureDef, ",") &lt;&gt; 0 Then
            LineChunk = Trim(Mid$(StructureDef, HomePos, (InStr(HomePos,_
                        StructureDef, ",") - HomePos)))
         Else
            LineChunk = Trim(Mid$(StructureDef, HomePos))
            BuildLoop = False
         End If

         TempChunk = Trim$(Mid$(LineChunk, InStr(UCase$(LineChunk),_
                     " AS ") + 3))
         SelectStmt = SelectStmt &amp; "[" &amp; Trim(Mid$(TempChunk, 1))_
                      &amp; "]" &amp; " As [" &amp; Trim(Mid$(LineChunk, 1, _
                      InStr(UCase$(LineChunk), " AS "))) &amp; "],"

         HomePos = InStr(HomePos, StructureDef, ",") + 1
      Loop

      SelectStmt = Left$(Trim(SelectStmt), Len(Trim(SelectStmt)) - 1) &amp; "_
                   Into [" &amp; TargetTbl &amp; "] From [" &amp; TemplateTbl &amp; "];"

      Set CrtTblDB = CurrentDB()
      Set CrtTblQry = CrtTblDB.CreateQueryDef("TempQuery", SelectStmt)

      CrtTblQry.Execute
      CrtTblQry.Close
      CrtTblDB.DeleteQueryDef ("TempQuery")
   End Sub
</PRE> 
<PRE>Keywords          : TblModfy kbusage
Version           : 1.0 1.1
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
