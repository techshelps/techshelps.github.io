

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Errors Exporting or Appending Many Records to SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137115">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1995/09/20">
<META NAME="Keywords" CONTENT="kberrmsg kbusage OdbcSqlms">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you export or append a large amount of data to Microsoft SQL Server (using the Export command, an action query, or the Upsizing Tools), you may receive an error message such as     ODBC Call Failed.    [Microsoft][ODBC.DLL] ODBC Function Seque...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB4,QA3P,QA1S,QDN9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Errors Exporting or Appending Many Records to SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137115</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
<LI>Microsoft Access Upsizing Tools version 1.0
<P>
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you export or append a large amount of data to Microsoft SQL Server
(using the Export command, an action query, or the Upsizing Tools), you
may receive an error message such as
<P>
<PRE>   ODBC Call Failed.
   [Microsoft][ODBC.DLL] ODBC Function Sequence Error [#0]

   -or-

   Microsoft [ODBC SQL Server Driver] rollback transaction
   request has no corresponding BEGIN TRANSACTION [#3093]

</PRE><h2>CAUSE</h2>
 
<P>
There are several possible causes for the error message:

<UL><LI>You may have exceeded the number of available locks on the server.
   Because the Microsoft Access Upsizing Tools exports or appends data
   within a transaction, the locks accumulate until the transaction is
   committed or rolled back.
<P>
   To determine the number of locks available on the server, you can run
   the following Microsoft SQL server stored procedure:
<P>
<P><PRE>      sp_configure "locks"
</PRE><P>
   For more information about the sp_configure stored procedure, see your
   Microsoft SQL Server documentation.

<LI>You may have run out of available space for the Microsoft SQL Server
   database.

<LI>You may have filled the Microsoft SQL Server transaction log to
   capacity.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve the error message, try the following:
<P>
- You can increase the number of locks available on your Microsoft SQL
<PRE>  Server. For more information about this procedure, see your Microsoft SQL
  Server documentation.

</PRE>- You can divide the data into smaller recordsets in Microsoft Access
<PRE>  before exporting or appending to Microsoft SQL Server. For example, if
  you have a table with 150,000 records, you can create 3 select queries
  with criteria that each returns 50,000 records. Then, export or append
  the queries instead of one large table.

</PRE>- You can use a different method for adding data to Microsoft SQL Server
<PRE>  besides the Microsoft Access Upsizing Tools. First, export your data from
  Microsoft Access to a text file in a comma-delimited format. Then, use
  Microsoft SQL Server's bulk copy program (BCP) to copy the text file to a
  database table. For more information about the BCP utility program, see
  your Microsoft SQL Server documentation.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To determine whether the error message is caused by running out of locks on
Microsoft SQL server, follow these steps:

<OL><P><LI>While transferring data to Microsoft SQL Server (using the Export
   command, an action query, or the Upsizing Tools), run a query against
   the SQL Server's master database to determine the number of locks in
   use:
<P>
<P><PRE>      Select count(*) from master..syslocks
</PRE>
<P><LI>Run this query a few times. Notice that the number of locks increases as
   long as Microsoft Access continues to transfer data to Microsoft SQL
   Server. If you receive an error message such as the ones listed in the
   "SYMPTOMS" section, then you have exceeded the number of locks available
   for your Microsoft SQL Server.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft SQL Server "Language Reference," version 4.2, pages 471-472
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Upsizing Wizard<BR>
Keywords            : kberrmsg kbusage OdbcSqlms<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
