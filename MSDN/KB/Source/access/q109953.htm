

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Repair a Damaged Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109953">
<META NAME="KBModify" CONTENT="1998/01/06">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="GnlCmp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  Environmental factors, such as power outages and fluctuations, improper closing of Microsoft Access, and disk or network failures may leave your database file damaged. The ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QA1S,QDN9,QAR4,QAH4,QAEF,QBCU,QA6A,QAGB,QBRZ,QBJZ,QBWS,QDKY,QAMB,QDIU P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Repair a Damaged Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109953</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
Environmental factors, such as power outages and fluctuations, improper
closing of Microsoft Access, and disk or network failures may leave your
database file damaged. The Repair and Compact utilities in Microsoft Access
are useful tools for recovering and optimizing Microsoft Access database
files. This article describes how to use these utilities and additional
alternatives for repairing a damaged database file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Although the steps outlined in this article are usually successful at
recovering damaged database files, you should always have a recent backup
copy of your database file on hand.
<P>
<P><h3>The Repair Utility</h3>
 
<P>
You can use the Repair utility to fix databases with certain types of
damage. The Repair utility attempts to repair only the tables, queries,
and indexes in the database. It does not attempt to repair damaged forms,
reports, macros, or modules; it does, however, copy them to the new,
repaired database.
<P>
NOTE: Run the Repair Database command only when the Microsoft Jet
database engine returns an error message indicating that the Repair
should be run. The Repair Database command should not be run under any
other circumstances.
<P>
<P><h3>Compact Utility</h3>
 
<P>
The Compact utility eliminates empty space in an existing database. It does
so by creating a new destination database and copying each object in the
old database to the new one. If you choose to compact the database into the
original database name instead of a new database, the Compact utility
creates a temporary database, exports all the objects from the original
database into the temporary database, removes the original database, and
renames the temporary database to the original database's name.
<P>
<P><h3>Recovering a Damaged Database</h3>
 
<P>
The following steps outline a general method for repairing a damaged
database:

<OL><P><LI>If you are using Microsoft Access version 2.0, obtain the Microsoft
   Access 2.0 Service Pack if you are getting either of the following error
   messages in a multiuser environment:
<P>
<P><PRE>    - Couldn't open SYSTEM.MDA
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - &lt;Database&gt; is corrupt or is not a database file. Attempt to repair?
</PRE><P>
   In addition to fixing the problem mentioned above, the Service Pack also
   includes an enhanced Repair utility. For more information about the
   Service Pack, please see the following articles here in the Microsoft
   Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../ACCESS/Q123589.htm">Q123589</A></B>
<PRE></PRE>      TITLE:      ACC2: Error Message "Couldn't Open SYSTEM.MDA"

      ARTICLE-ID: <B><A HREF="../ACCESS/Q123823.htm">Q123823</A></B>
      TITLE:      ACC2: MS Access Version 2.0 Service Pack Questions and
                  Answers

      ARTICLE-ID: <B><A HREF="../ACCESS/Q123588.htm">Q123588</A></B>
      TITLE:      ACC2: Microsoft Access Repair Utility Enhanced

</PRE><P><LI>Back up the damaged database (.mdb) file.

<P><LI>Delete the .ldb file if it is present. The corresponding .mdb file
   should be closed before deleting this file.
<P>
   The .ldb file is used to determine which records are locked in a shared
   database and by whom. If a database is opened for shared use, the .ldb
   file is created with the same name as the corresponding database (.mdb).
   For example, if you open (for shared use) the Northwind.mdb sample
   database in the c:\Msoffice\Access folder, then a file called
   Northwind.ldb is automatically created in the same folder. In Microsoft
   Access 7.0 and 97, the .ldb file is automatically deleted after the last
   user has exited the database with two exceptions -- when the last user
   does not have delete privileges to the folder containing the .mdb file
   or when the database is corrupted.
<P>
   For more information about .ldb files, please see the following articles
   here in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../ACCESS/Q136128.htm">Q136128</A></B>
<PRE></PRE>      TITLE:      ACC: Introduction to .ldb Files (95/97)

      ARTICLE-ID: <B><A HREF="../ACCESS/Q109957.htm">Q109957</A></B>
      TITLE:      ACC: Introduction to .ldb Files (1.x, 2.0)

</PRE><P><LI>Run the Compact utility as follows:
<P>
<P><PRE>    a. If a database is open, close it.
</PRE><P>
<P><PRE>    b. Point to Database Utilities on the Tools menu, and then click
       Compact Database.
</PRE><P>
<P><PRE>    In Microsoft Access 2.0 or earlier, on the File menu, click Compact
    Database.
</PRE><P>
   At this point, check your database to see if the damage has been
   repaired. If not, continue with the remaining steps.

<P><LI>If the damage is in a table, query, or index, run the Repair utility as
   follows:
<P>
<P><PRE>    a. If a database is open, close it.
</PRE><P>
<P><PRE>    b. Point to Database Utilities on the Tools menu, and then click Repair
       Database.
</PRE><P>
<P><PRE>    In Microsoft Access 2.0 or earlier, on the File menu, click Repair
    Database.
</PRE><P>
<P><PRE>    c. Select the damaged file in the Repair Database dialog box, and then
       click Repair.
</PRE><P>
<P><PRE>    In Microsoft Access 2.0 or earlier, enter the name of the damaged
    file in the File Name box, and then click OK.
</PRE><P>
<P><PRE>    If the repair is successful, you will receive the following message:
</PRE><P>
<P><PRE>    In Microsoft Access 97:
</PRE><P>
<PRE>         Successfully repaired the '&lt;path&gt;&lt;database name&gt;' database.

    In Microsoft Access for Windows 95:

         Microsoft Access repaired database '&lt;path&gt;&lt;database name&gt;'
         successfully.

    In Microsoft Access 2.0 or earlier:

         Repair of database '&lt;path&gt;&lt;database name&gt;' completed successfully.

   If the repair does not succeed, you will receive a message stating so.
   This means the damage to a table, query, or index is so severe that it
   cannot be corrected, or the damage is in an object that the Repair
   utility cannot affect.

</PRE><P><LI>If the damage is in a table, and the previous steps have not recovered
   it, try the following:
<P>
<P><PRE>    a. From within Microsoft Access, export the table to an ASCII
       (delimited text) file. For more information about this topic, search
       on the phrase "delimited text," and then view the "exporting Access
       data" topic using the Microsoft Access Help Index.
</PRE><P>
<P><PRE>    b. Delete any relationships associated with this table, and then delete
       the table from the database.
</PRE><P>
<P><PRE>    c. Compact the database.
</PRE><P>
<P><PRE>    d. Recreate the table and any relationships it had.
</PRE><P>
<P><PRE>    e. Using a word processor, examine the ASCII file for bad or strange
       data and remove those records. Save the file in an ASCII text file
       format
</PRE><P>
<P><PRE>    f. Re-import the ASCII file into the newly recreated table. For more
       information about this topic, search on the phrase "delimited text,"
       and then view the "importing or linking" topic using the Microsoft
       Access Help Index.
</PRE><P>
<P><PRE>    g. Recreate any records you were forced to delete.
</PRE>
<P><LI>If the previous steps fail to recover your damaged database, try
   creating a new database and importing the objects, one-by-one, from
   the old database to the new one. Then recreate the relationships. This
   technique resolves problems with damaged system tables in the database.

<P><LI>If the damage is in a form or report, the damage can be either in the
   form or report itself or in one or more controls on the form or report.
   You can delete the form or report and import it from the backup copy of
   your database or use one of the following options:
<P>
<P><PRE>    - If the damage is in the form or report itself, create a new form or
      report, and then copy the controls from the original form or report.
</PRE><P>
<P><PRE>    - If the damage is in a control on the form or report, create a new
      form or report, and then recreate the controls on the new form or
      report. It is best to recreate all the controls, because there is no
      way to tell which controls are damaged.
</PRE>
<P><LI>If the damage is in a macro or module, the damage can be in the macro
   or module itself or in the contents of the macro or module. You can
   delete the macro or module and import it from the backup copy of
   your database or use one of the following options:
<P>
<P><PRE>    - If the damage is in the macro or module itself, create a new macro
      or module, and then copy the contents of the original macro or
      module.
</PRE><P>
<P><PRE>    - The damage could involve non-ASCII characters embedded in the module.
      Save the module as a text file, remove any bad or strange data, and
      then reload the text file into a new module.
</PRE><P>
<P><PRE>    - If the damage is in the contents of the macro or module, you must
      create a new macro or module, and then re-create the contents of the
      original macro or module.
</PRE><P>
</OL>If you cannot repair the database with these steps, the database is
probably damaged beyond repair. If this is the case, you should restore
your last backup database or recreate the database.
<P>
As a final alternative, some consultants may provide a Microsoft Access
database repair service. Because this is such a specialized service, the
most efficient way to locate a consultant is to post a message in the
Microsoft Access "Third Party and User Groups" Internet newsgroup, which
has the following newsgroup address:
<P>
<PRE>    microsoft.public.access.3rdpartyusrgrp

</PRE></OL>For more information about the Microsoft Access Internet newsgroups, please
see the following article here in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q150057.htm">Q150057</A></B>
   TITLE:      ACC: Microsoft Access Newsgroups Available on the
               Internet

</PRE>For information on how to obtain Microsoft Jet 3.51, please see the
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q172733.htm">Q172733</A></B>
   TITLE:      ACC97: Updated Version of Microsoft Jet 3.5 Available on MSL

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about repairing databases, type "repairing" in the
Office Assistant, click Search, and then click to view "Repair a damaged
database."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: corrupt corruption<BR>
Keywords          : GnlCmp kbusage<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
