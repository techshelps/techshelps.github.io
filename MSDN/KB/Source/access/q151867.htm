

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Type Mismatch Specifying Criteria on Count in Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151867">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1996/05/30">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryTotal">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  When you specify text criteria for a Text field with Count in the Total row of a totals query, you may receive the following error message:     Type Mismatch  CAUSE =====  ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QADP,QAPF,QA5V,QAGF,QAG8,QBWS,QA7O,QA7N,QACF,QA1S,QDKY,QAE5,QDN9,QA2Q P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Type Mismatch Specifying Criteria on Count in Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151867</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
When you specify text criteria for a Text field with Count in the Total
row of a totals query, you may receive the following error message:
<P>
<PRE>   Type Mismatch

</PRE><h2>CAUSE</h2>
 
<P>
The Text criteria is being compared to the result of the Count which is
numeric.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can use one of the following two methods to work around this behavior.
These two methods assume that the criteria is meant to limit the records
before the Count is performed by the query.
<P>
<P><h3>Method 1</h3>
 
<P>
You can add the field to the query a second time and use Where on the Total
row. The following example uses the sample database Northwind.mdb (or
NWIND.MDB in version 2.0) to demonstrate adding a field to a totals query
twice.

<OL><P><LI>Open the sample database Northwind.mdb (NWIND.MDB in Microsoft Access
   version 2.0) and create a new query based on the Orders table.

<P><LI>Click the Totals button on the toolbar.

<P><LI>Add the field ShipName to the query and select Count on the Total
   row.

<P><LI>Add the field ShipName to the query again. Select Where on the
   Total row. On the Criteria row type "Quick-Stop". Run the query and
   note that it returns the correct count.
<P>
</OL>NOTE: In Microsoft Access 2.0, there is a space in the Ship Name field.
<P>
<P><h3>Method 2</h3>
 
<P>
Use two queries. The following example demonstrates how to build a totals
query based on a select query with a Text criteria:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0) and
   create a new query based on the Orders Table.

<P><LI>Drag the ShipName field into the first column of the QBE grid. Type
   "Quick-Stop" in the Criteria row. Save the query as Ship Name 1.

<P><LI>Create another new query based on the Ship Name 1 query. Drag the
   ShipName field to the QBE grid in the first column. Click the
   Totals button on the toolbar, and then select Count in the Total row.

<P><LI>Run the query and note that it returns the correct count.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).
   Create a new query based on the Orders Table.

<P><LI>Drag the ShipName field to the first column of the QBE grid.

<P><LI>Type "Quick-Stop" in the Criteria row.

<P><LI>Click the Totals button on the toolbar, and then select Count in the
   Total row of the QBE grid.

<P><LI>Run the query. Note that you receive the "Type Mismatch" error.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the Count() function in queries, search
the Help Index for "Count," and view the available topics, or ask the
Microsoft Access 97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage QryTotal<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
