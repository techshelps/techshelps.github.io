

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Can't Create Relationship with Multiple-Field Primary Key </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155514">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1996/08/30">
<META NAME="Keywords" CONTENT="kberrmsg kbusage RltRef">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  When you try to create a relationship that enforces referential integrity, and the relationship involves a multiple-field primary key, you may receive the following error: ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QA7O,QA7N,QBJZ,QAMA,QBWS,QA1S,QAMN,QAUJ,QARR,QAUR,QAGB,QDN9,QA01 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Can't Create Relationship with Multiple-Field Primary Key</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155514</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
When you try to create a relationship that enforces referential integrity,
and the relationship involves a multiple-field primary key, you may receive
the following error:
<P>
<P><h3>In Microsoft Access 7.0 and 97</h3>
 
<P>
<PRE>   No unique index found for referenced field of primary table.

</PRE><h3>In Microsoft Access 2.0</h3>
 
<P>
<PRE>   Can't create relationship to enforce referential integrity. The
   field(s) in the primary table must be the primary key or have a
   unique index.

</PRE><h2>CAUSE</h2>
 
<P>
The order of the primary key fields in Design view of the table is
different from the order of the fields in the PrimaryKey index.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two ways to work around this error:

<OL><P><LI>Reorder the PrimaryKey fields in the index so that they appear in the
   same order as they do in Design view of the table.

<P><LI>Order the field names in the Relationships dialog box to match the order
   of the field names in the PrimaryKey index.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 2.0, 7.0,
and 97. We are researching this problem and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<P><h3>Creating the Tables</h3>
 

<OL><P><LI>Create a new table in Design view.

<P><LI>Add the following fields to the table:
<P>
      Table:
      ------------------
      Field Name: A
<PRE>         Data Type: Text
      Field Name: B
         Data Type: Text

</PRE><P><LI>Highlight both fields by holding down the SHIFT key while you click the
    row selector button to the left of each field name, and then release
    the SHIFT key.

<P><LI>On the Edit menu, click Primary Key (or Set Primary Key in version
    2.0).

<P><LI>On the View menu, click Indexes.

<P><LI>Change the order of the fields in the PrimaryKey index so that B is in
    the first row, and A is in the second row:
<P>
<PRE>      Index Name   Field Name   Sort Order
      ------------------------------------
      PrimaryKey   B            Ascending
                   A            Ascending

</PRE><P><LI>Close the Indexes dialog box.

<P><LI>Save the table as tblOne and close it.

<P><LI>Repeat steps 1 and 2.

<P><LI>Save the table as tblTwo and close it. You do not need to create a
    primary key index on this table.
<P>
</OL><h3>Creating the Relationships</h3>
 

<OL><P><LI>Open the Relationships window by clicking Relationships on the Tools
<P><PRE>    menu (or in version 2.0, click Relationships on the Edit menu.)
</PRE>
<P><LI>On the Relationships menu, click Show Table (or Add Table in version
   2.0). Add the tblOne table and the tblTwo table to the Relationships
   window.

<P><LI>Highlight fields A and B in the tblOne table by holding down the SHIFT
   key while you click both fields, and then release the SHIFT key.

<P><LI>Drag the highlighted fields A and B from the tblOne table to the tblTwo
   table to invoke the Relationships dialog box.

<P><LI>Select fields A and B from the tblTwo table in the Related Table/Query
   column, so that the Relationships dialog box looks as follows:
<P>
<PRE>      Table/Query: tblOne   Related Table/Query: tblTwo
      -------------------------------------------------
               A                       A
               B                       B

</PRE><P><LI>Click Enforce Referential Integrity.

<P><LI>Click the Create button. Note that the error message appears.

<P><LI>Click Cancel in the Relationships dialog box, and then close the
   Relationships window. You do not need to save your changes.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using a multiple field primary key, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q98793.htm">Q98793</A></B>
   TITLE     : ACC: Compound Indexes Must Restrict First Indexed Field

</PRE></OL>For more information about enforcing referential integrity, type "What is
Referential Integrity" in the Office Assistant, click Search, and then
click to view "What is Referential Integrity?"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: index multiple field primary key<BR>
Keywords            : kberrmsg kbusage RltRef<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
