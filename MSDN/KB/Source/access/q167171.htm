

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC97: Error Saving Table with Multiple Primary Key </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167171">
<META NAME="KBModify" CONTENT="1997/04/21">
<META NAME="KBCreate" CONTENT="1997/04/18">
<META NAME="Keywords" CONTENT="kbusage TblDsign TblPriky">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  When you create a multiple-field primary key in Design view of a table, you may receive the following error message:     Invalid index definition.  This will be followed by...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTV,QATJ,QA28,QA7O,QA7N,QBJZ,QAMA,QBWS,QAUR,QA5V,QA1S,QAUJ,QAB4,QDN9,QAU7 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Error Saving Table with Multiple Primary Key</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167171</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
When you create a multiple-field primary key in Design view of a table, you
may receive the following error message:
<P>
<PRE>   Invalid index definition.

</PRE>This will be followed by:
<P>
<PRE>   Microsoft Access was unable to create the table.

   -or-

   Errors were encountered during the save operation. Indexes were not
   added or changed.

</PRE><h2>CAUSE</h2>
 
<P>
When you use the right mouse button (right-click) to create a
multiple-field primary key, Microsoft Access 97 generates two
fields in the PrimaryKey index for one of the fields in your table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are several ways to create a multiple-field primary key; the problem
occurs only with one of them. You can work around this behavior easily by
using one of the following methods.
<P>
<P><h3>Method 1: Set the Primary Key Using the Edit Menu or Toolbar</h3>
 

<OL><P><LI>Open your table in Design view.

<P><LI>Press and hold down the CTRL key, and then click the record selector
   button to the left of the Field Name for each record you want to include
   in your primary key. Note that the field rows are highlighted to
   indicate that you have selected them.

<P><LI>Release the CTRL key.

<P><LI>On the Edit menu, click Primary Key.
<P>
   -or-
<P>
   Click the Primary Key button on the Table Design toolbar.

<P><LI>Save your table.
<P>
</OL><h3>Method 2: Edit the PrimaryKey Index</h3>
 

<OL><P><LI>Open your table in Design view.

<P><LI>Press and hold down the CTRL key, and then click the record selector
   button to the left of the Field Name for each record you want to include
   in your primary key. Note that the field rows are highlighted to
   indicate that you have selected them.

<P><LI>While still pressing the CTRL key, use the right mouse button
   (right-click) to click the record selector button for one of the
   fields you have selected, and then click Primary Key on the shortcut
   menu that appears.

<P><LI>On the View menu, click Indexes.

<P><LI>In the Indexes dialog box, locate the index named PrimaryKey and
   identify the field name that appears twice in that index.

<P><LI>Click the record selector button to the left of the Index Name column
   for the duplicate field name.

<P><LI>Press DELETE.

<P><LI>Close the Indexes dialog box.

<P><LI>Save your table.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Note that this behavior only occurs if you right-click the record selector
button for one of the rows in your primary key; if you right-click
elsewhere in one of the selected rows, and then click Primary Key on the
shortcut menu, the problem does not occur.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Click the Tables tab in the Database window, and then click the New
   button.

<P><LI>In the New Table dialog box, click Design View, and then click OK.

<P><LI>Create three new fields in the table:
<P>
<P><PRE>      Table: tblJunction
      ------------------------
      Field Name: InvoiceNumber
<PRE></PRE>         Data Type: Number
         Field Size: Long Integer
      Field Name: ExtraField
         Data Type: Text
      Field Name: PartNumber
         Data Type: Number
         Field Size: Long Integer

</PRE><P><LI>Select the InvoiceNumber field by clicking the record selector button to
   the left of the field name.

<P><LI>Press the CTRL key and click the record selector button for the
   PartNumber field.

<P><LI>While still pressing the CTRL key, right-click the record selector
   button for the InvoiceNumber field, and then click Primary Key on the
   shortcut menu that appears.

<P><LI>On the View menu, click Indexes. Note that the PrimaryKey index contains
   two entries for the InvoiceNumber field.

<P><LI>On the File menu, click Save, and then click OK in the Save As dialog
   box. Note that you receive two error messages, and you cannot save the
   table. At this point, you can close the table without saving it.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using primary key fields in tables, search the
Help Index for "key fields, primary keys," or ask the Microsoft Access 97
Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage TblDsign TblPriky<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
