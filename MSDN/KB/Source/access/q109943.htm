

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Fill Text Boxes on a Report Using Access Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109943">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="kbusage McrArg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes two methods that you can use to populate (or fill) controls on a report based on a table or query when you run the report.  This article assumes that you a...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBCF,QA1S,QBT6,QBV4,QA5F,QAMA,QDN9,QAM3,QAH4,QAHP,QBCE,QAGU,QA7O,QAVT,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Fill Text Boxes on a Report Using Access Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes two methods that you can use to populate (or fill)
controls on a report based on a table or query when you run the report.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x, or the "Building Applications" manual, Chapter 3, "Introducing Access
Basic," in version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Both of the examples below use Access Basic code to fill a control on a
report based on the Employee List query. The code will fill in the City
field on a report that only contains the Employee ID and Employee Name
fields.
<P>
The first example demonstrates how to fill a field using Access Basic
code called from the OnFormat property of the report's detail section:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Using the Report Wizard, create a new report based on the Employee
   List query with the following options:
<P>
<P><PRE>    - Single-Column
    - Include both fields
    - Sort by Employee Name
    - Select Executive style
</PRE>
<P><LI>View the report in Design view.

<P><LI>Add the following text box to the report's detail section:
<P>
<P><PRE>      ControlName: City
      ControlSource: &lt;leave empty&gt;
</PRE>
<P><LI>Save the report as Fill Report1.

<P><LI>Type the following sample code in a new or existing module:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Function fillrep()
<PRE></PRE>         Dim ds as Dynaset, db as Database
         Set db=CurrentDB()
         set ds=db.CreateDynaset("Employees")
         ds.MoveFirst
         ds.FindFirst "[Employee ID]=" &amp; Reports![Fill Report1]![Employee _
                ID]
         Reports![Fill Report1]![City]=ds![city]
      End Function

</PRE><P><LI>Set the report detail section's OnFormat property as follows:
<P>
<P><PRE>      =fillrep()
</PRE>
<P><LI>Preview the report. Note that the City field on the report is filled by
   the Access Basic code.
<P>
</OL>The second example demonstrates how to fill a field using Access Basic
code called from a text box's ControlSource property:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Using the Report Wizard, create a new report based on the Employee
   List query with the following options:
<P>
<P><PRE>    - Single-Column
    - Include both fields
    - Sort by Employee Name
    - Select Executive style
</PRE>
<P><LI>View the report in Design view.

<P><LI>Add the following text box to the report's detail section:
<P>
<P><PRE>      ControlName: City
      ControlSource: &lt;leave empty&gt;
</PRE>
<P><LI>Save the report as Fill Report2.

<P><LI>Enter the following sample code in a new or existing module:
<P>
<P><PRE>      Function fillit()
<PRE></PRE>         Dim ds as Dynaset, db as Database
         Set db=CurrentDB()
         set ds=db.CreateDynaset("Employees")
         ds.MoveFirst
         ds.FindFirst "[Employee ID]=" &amp; Reports![Fill Report2]![Employee _
              ID]
         fillit=ds!city
      End Function

</PRE><P><LI>Change the City text box's ControlSource property as follows:
<P>
<P><PRE>      =fillit()
</PRE>
<P><LI>Preview the report. Note that the City field on the report is filled by
   the Access Basic code.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For an example of how to fill text boxes on a report using Visual Basic,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q143280.htm">Q143280</A></B>
   TITLE     : ACC: How to Fill Text Boxes on a Report Using Visual Basic
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage McrArg<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
