

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC97: ShowToolbar with Where Appropriate Hides Custom Toolbar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176152">
<META NAME="KBModify" CONTENT="1997/11/25">
<META NAME="KBCreate" CONTENT="1997/11/03">
<META NAME="Keywords" CONTENT="McrArg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If a macro contains the ShowToolbar action with the Toolbar Name argument set to the name of a custom toolbar, and if that toolbar is already visible, running the macro hides the...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBOG,QAPN,QBWS,QAF0,QBS0,QANS,QAH4,QBJZ,QA1S,QAKJ,QAD7,QDN9,QBXS,QA39,QA2Q P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: ShowToolbar with Where Appropriate Hides Custom Toolbar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176152</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If a macro contains the ShowToolbar action with the Toolbar Name argument
set to the name of a custom toolbar, and if that toolbar is already
visible, running the macro hides the toolbar instead of showing it. This
behavior also occurs when you run a Visual Basic for Applications procedure
containing the ShowToolbar method with the toolbarname argument set to the
name of a custom toolbar.
<P>
<P><h2>CAUSE</h2>
 
<P>
You have set the Show argument of the ShowToolbar action to Where
Appropriate in your macro, or you are using the constant
acToolbarWhereApprop with the ShowToolbar method in your Visual Basic for
Applications procedure.
<P>
The Microsoft Access 97 "Show Toolbar Action" Help topic reads as follows:
<P>
<PRE>   For custom toolbars, you can select Yes or Where Appropriate to display
   the custom toolbar in all Microsoft Access windows that become active or
   No to hide the toolbar in all Microsoft Access windows.

</PRE>However, if you select Where Appropriate or use the constant
acToolbarWhereApprop, a custom toolbar is displayed only when a form or
report to which it is attached is open.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, use either of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Set the Show argument of the ShowToolbar macro action to Yes, or use the
constant acToolbarYes with the ShowToolbar method in your Visual Basic for
Applications procedure.
<P>
<P><h3>Method 2</h3>
 
<P>
If you want to set the Show argument of the ShowToolbar macro action to Where
Appropriate, or if you want to use the constant acToolbarWhereApprop with
your Visual Basic for Applications procedure, attach the custom toolbar to
a form or report. To do so, follow these steps:

<OL><P><LI>In the Database window, select the form or report to which you want to
   attach the custom toolbar, and then click Design.

<P><LI>On the Edit menu, click either Select Form or Select Report.

<P><LI>On the View menu, click Properties, and in the Form dialog box, click
   the Other tab.

<P><LI>Click in the Toolbar box and select the custom toolbar.
<P>
</OL>The custom toolbar appears when you open the form or report. If you hide
the toolbar and then run the macro or procedure, the toolbar reappears. If
the toolbar is still visible and you run the macro or procedure, the
toolbar is visible when you set the focus back to the form or report to
which it is attached.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>On the View menu, point to Toolbars, and then click Customize.

<P><LI>In the Customize dialog box, click New.

<P><LI>In the New Toolbar dialog box, type "Custom1" (without the quotation
   marks) in the Toolbar Name box, and then click OK.

<P><LI>In the Customize dialog box, click Close.

<P><LI>Click the Macros tab in the Database window, and then click New.

<P><LI>Create the following new macro:
<P>
<P><PRE>      Action
      -----------
      ShowToolbar
</PRE><P>
<P><PRE>      Action Arguments
      -------------------------------
      Toolbar Name: Custom1
<PRE></PRE>              Show: Where Appropriate

</PRE><P><LI>Save the macro as macShowBar and run it. Note that the custom toolbar is
   now hidden.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about ShowToolbar, search the Help Index for
"ShowToolbar Action."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: tool bar<BR>
Keywords          : McrArg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbdocerr<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
