

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: How to Prompt User to Save Changes to Record in Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181820">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1998/02/26">
<META NAME="Keywords" CONTENT="FmsEvnt PgmPrcs">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding and interoperability skills.  When you move to the next record or close a Microsoft Access form, Microsoft Access automatically saves any changes that you have made to the current record. This article demonstr...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QA5V,QAUR,QAPN,QAU7,QACF,QA1S,QAGB,QAFX,QBWS,QAO4,QAGC,QDN9,QAGU,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: How to Prompt User to Save Changes to Record in Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181820</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding and interoperability skills.
<P>
When you move to the next record or close a Microsoft Access form,
Microsoft Access automatically saves any changes that you have made to the
current record. This article demonstrates how to use a BeforeUpdate event
procedure that prompts you to verify the save operation before continuing.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file
and perform these steps on a copy of the database.
<P>
This example uses the BeforeUpdate event procedure in the Customers form to
prompt the user to confirm changes before saving.

<OL><P><LI>Start Microsoft Access and open the sample database NWIND.MDB.

<P><LI>In the Database window, click the Form tab and select the Customers
   form. Then click Design.

<P><LI>On the View menu, click Properties and select Event Properties from the
   combo box at the top of the dialog box.

<P><LI>Click the BeforeUpdate property box, and then click the Build (...)
   button.

<P><LI>In the Choose Builder dialog box, click Code Builder. Click OK.

<P><LI>Set the BeforeUpdate property of the form to the following event
   procedure.
<P>
   NOTE: In the following sample statements, an underscore (_) at the end
   of a line is used as a line-continuation character. Remove the
   underscore from the end of the line when re-creating these statements.
<P>
<PRE>      Sub Form_BeforeUpdate (Cancel As Integer)
         ' This procedure checks to see if the data on the form has
         ' changed. If the data has changed, the procedure prompts the
         ' user to continue the save operation or cancel it. Then the
         ' action that triggered the BeforeUpdate event is completed.

         On Error GoTo Err_BeforeUpdate

         ' The Dirty property is True if the record has been changed.
         If Me.Dirty Then
            ' Prompt to confirm the save operation.
            If MsgBox("Do you want to save?", 4 + 32, _
                  "Save Record") = 7 Then
               Cancel = True
               SendKeys "{ESC}"
            End If
         End If

      Exit_BeforeUpdate:
         Exit Sub

      Err_BeforeUpdate:
         MsgBox CStr(Err) &amp; " " &amp; Error(Err)
         Resume Exit_BeforeUpdate

      End Sub

</PRE><P><LI>On the Run menu, click Compile Loaded Modules.

<P><LI>If no errors occur, save the form.
<P>
</OL>When you make a change to a record, and then you either move to a different
record or close the form, you are prompted to confirm that you want to save
the current record. If you choose No, the record is reset and the operation
continues as normal.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about how to prompt a user to save a record in
Microsoft Access 7.0 or 97, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q175911.htm">Q175911</A></B>
   TITLE     : ACC: How to Prompt User to Save Changes to Record in
               Form(95/97)

</PRE></OL>For more information about undoing the current record in the BeforeUpdate
event, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q97525.htm">Q97525</A></B>
   TITLE     : ACC: UndoCurrentRecord in BeforeUpdate Property Causes Error
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: inf saving ask asking<BR>
Keywords          : FmsEvnt PgmPrcs<BR>
Version           : WINDOWS:2.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
