

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Dynamic Query to Return Records for the Previous Month </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176645">
<META NAME="KBModify" CONTENT="1997/11/12">
<META NAME="KBCreate" CONTENT="1997/11/11">
<META NAME="Keywords" CONTENT="QryCrit QryHowto">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to create a query that returns all the records in which the value of a date field falls within the previous month.  MORE INFORMATION  To create a qu...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QACE,QA5V,QA7O,QA7N,QAPF,QDKY,QAYV,QAY5,QBQU,QAB6,QA1S,QAB9,QAGY,QALW P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Dynamic Query to Return Records for the Previous Month</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176645</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to create a query that returns all the
records in which the value of a date field falls within the previous month.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a query that returns the data from the previous month based on
the current date, use the Between...And operator with the DateSerial()
function in the Criteria of the date field. The DateSerial() function
returns a date for a specified year, month, and day. The syntax of the
DateSerial() function is:
<P>
<PRE>    DateSerial(year, month, day)

</PRE>The following example returns all records from the Orders table of the
sample database Northwind.mdb (or NWIND.MDB in version 2.0) in which the
value in the ShippedDate field (or Shipped Date field in version 2.0) falls
within the previous month.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0). You may want to back
up the Northwind.mdb (or NWIND.MDB) file and perform these steps on a copy
of the database.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb (or
   NWIND.mdb in version 2.0).

<P><LI>Open the Orders table in Datasheet view.

<P><LI>Click in the ShippedDate field (or Shipped Date field in version 2.0).

<P><LI>On the Records menu, point to Sort and click Sort Ascending. (In version
   2.0, point to Quick Sort on the Records menu, and then click Ascending.)

<P><LI>In several of the records in which the ShippedDate field is empty,
   enter dates that fall within the previous month.

<P><LI>Close the Orders table.

<P><LI>Create the following query based on the Orders table:
<P>
<P><PRE>      Query: qryLastMonth
      ---------------------------------------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: OrderID
<PRE></PRE>         Table: Orders
      Field: OrderDate
         Table: Orders
      Field: RequiredDate
         Table: Orders
      Field: ShippedDate
         Table: Orders
         Criteria: Between DateSerial(Year(Date()),Month(Date())-1,1) And
                   DateSerial(Year(Date()),Month(Date()),0)

   NOTE: In Microsoft Access 2.0, there is a space in the field names
   Order ID, Order Date, Required Date, and Shipped Date.

</PRE><P><LI>Save the query as qryLastMonth.

<P><LI>Run the qryLastMonth query. Note that it returns only the records that
   you changed in step 5.
<P>
</OL>In this example, the DateSerial() function automatically handles the change
in the year. In the expression in the Criteria of the ShippedDate field,
the second instance of the DateSerial() function sets the day argument to
zero. Therefore, the expression returns the last day of the previous month.
For example
<P>
<PRE>   DateSerial(97,1,0)

</PRE></OL>returns
<P>
<PRE>   12/31/96

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the Between...And operator, search the Help
Index for "Between...And operator."
<P>
For more information about the DateSerial() function, search the Help Index
for "DateSerial."
<P>
For more information about other expressions to manipulate dates, see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q88657.htm">Q88657</A></B>
   TITLE     : ACC: Functions for Calculating and Displaying Date/Time
               Values
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prior<BR>
Keywords          : QryCrit QryHowto<BR>
Version           : WINDOWS:2.0,7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
