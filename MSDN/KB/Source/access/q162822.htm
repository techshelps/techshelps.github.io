

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC97: Error Creating CommandBar with Duplicate Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162822">
<META NAME="KBModify" CONTENT="1997/05/21">
<META NAME="KBCreate" CONTENT="1997/01/28">
<META NAME="Keywords" CONTENT="GnlOthr kberrmsg kbui UifMenub">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  If you try to create a command bar with an existing name through Visual Basic for Applications, you may receive the following error message:     Run-time error '5':    Inva...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAUJ,QAIH,QBS0,QAB9,QANS,QBV8,QA1S,QDKX,QAH4,QDN9,QAJQ,QDNE,QAY5,QAAP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Error Creating CommandBar with Duplicate Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162822</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
If you try to create a command bar with an existing name through Visual
Basic for Applications, you may receive the following error message:
<P>
<PRE>   Run-time error '5':
   Invalid procedure call or argument

</PRE>If you try to create a command bar with an existing name through the user
interface, you may receive the following error message:
<P>
<PRE>   A toolbar named '&lt;name&gt;' already exists. Type another name.

</PRE><h2>RESOLUTION</h2>
 
<P>
You cannot create multiple command bars with the same name in any Microsoft
Office 97 file, except in Microsoft Word 97.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following table demonstrates how the Microsoft Office 97 applications
behave when creating duplicate command bar names:
<P>
<PRE> Application              Using Code      Using the User Interface
 -----------------------------------------------------------------

 Microsoft Word 97           Yes                    No
 Microsoft Excel 97           No                    No
 Microsoft Access 97          No                    No
 Microsoft Powerpoint 97      No                    No

</PRE>NOTE: Microsoft Word 97 is able to create multiple command bars with the
same name through Visual Basic for Applications because Word needs to be
able to have multiple command bars with the same name to handle the case
where you have two templates open.
<P>
<P><h3>Steps to Reproduce Behavior Using Visual Basic for Applications</h3>
 

<OL><P><LI>Using Microsoft Access 97, open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function CreateCmdBar()
<PRE></PRE>          Dim cb As CommandBar
          Set cb = Application.CommandBars.Add("Test1")
          Set cb = Application.CommandBars.Add("Test1")
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>       ?CreateCmdBar()
</PRE><P>
   Note that you receive the following error message on the third line
   of code:
<P>
<P><PRE>      Run-time error '5':
      Invalid procedure call or argument"
</PRE><P>
</OL><h3>Steps to Reproduce Behavior Using the User Interface</h3>
 

<OL><P><LI>Using Microsoft Access 97, open the sample database Northwind.mdb.

<P><LI>On the View menu, point to Toolbars, and then click Customize.

<P><LI>Click the New button in the Customize dialog box. Set the Toolbar name
   to "Test2" (without the quotation marks), and then click OK.

<P><LI>Repeat step 3. Note that you receive the following error message:
<P>
<P><PRE>      A toolbar named 'Test2' already exists. Type another name.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating command bars through code, search the
Help Index for "Add Method, command bars," and then "Add Method,
(CommandBars Collection)."
<P>
For more information about creating command bars through the user
interface, ask the Microsoft Office 97 Office Assistant, "How do I
create a command bar."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: menubar toolbar menu shortcut xl excel access word<BR>
powerpoint<BR>
Keywords            : GnlOthr kberrmsg kbui UifMenub<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
