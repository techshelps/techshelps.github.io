

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Creating a Crosstab Query with Multiple Value Fields </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109939">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="kbusage QryCross">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  In a Microsoft Access crosstab query, you can specify only one field or calculation as the value. Often it is desirable to show more than one value in the query.  For examp...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QADP,QAGF,QAB6,QAG8,QDPA,QA1S,QAE5,QA7O,QA7N,QAUJ,QACF,QDN9,QBDM,QBE7 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Creating a Crosstab Query with Multiple Value Fields</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109939</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
In a Microsoft Access crosstab query, you can specify only one field
or calculation as the value. Often it is desirable to show more than
one value in the query.
<P>
For example, the following shows two columns of information per company, a
count of the number of orders, and the order totals for each year:
<P>
<PRE> Company Name  1989 Orders  1989 Total  1990 Orders  1990 Total
 --------------------------------------------------------------
 ABC Company   12           $855.00     15           $1010.25
 XYZ Company   1017         $22045.57   1050         $25345.29

</PRE>This type of query is sometimes called a Multiple Value Field query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to create a Multiple Value Fields crosstab query, you must
create two separate crosstab queries with fixed column headings for each
value you want to calculate. These two queries can then be joined,
using a Select query to display the desired results.
<P>
The following example uses the sample database Northwind.mdb in Microsoft
Access version 7.0 and Microsoft Access 97 (or NWIND.MDB in versions 2.0 or
earlier) to create a query that displays results similar to the
example above, showing the number of sales and total for each year for each
company.
<P>
<P><h3>Step One: Create the Order Total Crosstab Query</h3>
 
<P>
To create the Order Total Crosstab query, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0 or
   earlier) and create the following crosstab query based on the Orders,
   Order Details, and the Customers tables.
<P>
<P><PRE>      Query: Order Total
      ------------------
      Type: Crosstab Query
      Join: Customers.[CustomerID] &lt;-&gt; Orders.[CustomerID]
</PRE><P>
<P><PRE>      NOTE: In versions 1.x and 2.0, there is a space in Customer ID.
</PRE><P>
<P><PRE>      Join: Orders.[OrderID] &lt;-&gt; Order Details.[OrderID]
</PRE><P>
<P><PRE>      NOTE: In versions 1.x and 2.0, there is a space in Order ID.
</PRE><P>
<P><PRE>      Field: CompanyName
<PRE></PRE>         Table Name: Customers
         Total: Group By
         Crosstab: Row Heading

      NOTE: In versions 1.x and 2.0, there is a space in Company Name.

      Field: Expr1: Year([OrderDate]) &amp; " " &amp; "Order Total"
         Table Name:
         Total: Group By
         Crosstab: Column Heading

      NOTE: In versions 1.x and 2.0, there is a space in Order Date.

      Field: Expr2: Sum(CCur([UnitPrice]*[Quantity]*(1.-[Discount])))
         Table Name:
         Total: Expression
         Crosstab: Value

      NOTE: In versions 1.x and 2.0, there is a space in Unit Price.

</PRE><P><LI>Select the query by clicking anywhere on the gray area in the top half
   of the query grid. Click Query Properties on the View menu, select the
   Fixed Column Headings check box, and in the Fixed Column Headings box
   type the entries appropriate for your version of Microsoft Access:
<P>
<PRE>      Version 1.x:      "1989 Order Total";"1990 Order Total";"1991 Order
                        Total";"1992 Order Total"

      Version 2.0:      "1991 Order Total";"1992 Order Total";"1993 Order
                        Total";"1994 Order Total"

      Version 7.0:      "1993 Order Total";"1994 Order Total";"1995 Order
                        Total"

      Version 97:       "1994 Order Total";"1995 Order Total";"1996 Order
                        Total"

</PRE></OL>NOTE: In Microsoft Access versions 2.0, 7.0, and 97, the
FixedColumnHeadings property is called Column Headings.
<P>
Step Two: Create the Order Count Crosstab Query
 

<OL><P><LI>Create the following Crosstab query based on the Orders and the
   Customers tables:
<P>
<P><PRE>      Query: Order Count
      ------------------
      Type: Crosstab Query
      Join: Customers.[CustomerID] &lt;-&gt; Orders.[CustomerID]
</PRE><P>
<P><PRE>      NOTE: In versions 1.x and 2.0, there is a space in Customer ID.
</PRE><P>
<P><PRE>      Field: CompanyName
<PRE></PRE>         Table Name: Customers
         Total:      Group By
         Crosstab:   Row Heading

      NOTE: In versions 1.x and 2.0, there is a space in Company Name.

      Field: Expr1: Year([OrderDate]) &amp; " " &amp; "Order Count"
         Table Name:
         Total: Group By
         Crosstab: Column Heading

      NOTE: In versions 1.x and 2.0, there is a space in Order Date.

      Field: OrderID
         Table Name: Orders
         Total:      Count
         Crosstab:   Value

      NOTE: In versions 1.x and 2.0, there is a space in Order ID.

</PRE><P><LI>Select the query by clicking anywhere on the gray area in the top half
   of the query grid. Click Query Properties on the View menu, select the
   Fixed Column Headings check box, and in the Fixed Column Headings box
   type the entries appropriate for your version of Microsoft Access:
<P>
<PRE>      Version 1.x:      "1989 Order Count";"1990 Order Count";"1991 Order
                        Count";"1992 Order Count"

      Version 2.0:      "1991 Order Count";"1992 Order Count";"1993 Order
                        Count";"1994 Order Count"

      Version 7.0:      "1993 Order Count";"1994 Order Count";"1995 Order
                        Count"

      Version 97:       "1994 Order Count";"1995 Order Count";"1996 Order
                        Count"

</PRE></OL>NOTE: In Microsoft Access versions 2.0, 7.0, 97, the
FixedColumnHeadings property is called Column Headings.
<P>
Step Three: Create the Multiple Values Query
 

<OL><P><LI>Create a Select query based on the Order Total and Order Count Crosstab
   Queries.  You will use CompanyName as well as the Order Total and Order
   Count fields for the years whose results you want to view. The example
   below uses the last two years of Order Total and Order Count in
   Microsoft Access 97.
<P>
<P><PRE>      Query: Multiple Values
      ----------------------
      Join: Order Total.[CompanyName] &lt;-&gt; Order Count.[CompanyName]
</PRE><P>
<P><PRE>      NOTE: In versions 1.x and 2.0, there is a space in Company Name.
</PRE><P>
<P><PRE>      Field: CompanyName
<PRE></PRE>         Table Name: Order Count
         Show: Yes
      Field: 1995 Order Count
         Table Name: Order Count
         Show: Yes
      Field: 1995 Order Total
         Table Name: Order Total
         Show: Yes
      Field: 1996 Order Count
         Table Name: Order Count
         Show: Yes
      Field: 1996 Order Total
         Table Name: Order Total
         Show: Yes

</PRE></OL>Running the Multiple Values query results in a table that looks like the
following:
<P>
<PRE> Company Name          1995 Order Count 1995 Order Total 1996 Order Count..
 --------------------------------------------------------------------------
 Alfred's Futterkiste  3                $2,022.50        3
 Ana Trujillo          2                  $799.75        1
 Antonio Moreno        5                $5,960.78        1

</PRE>NOTE: This technique does not work if the field specified for the
concatenation (Step One(expr1)) is a field in more than one of the tables
joined in the query. There is no way to force the query to accept the
table name in the expression without generating reserved error -1310. If
you add the table name to the Table row, you generate a syntax error. If
you leave the table name out completely, you generate an "ambiguous
reference" error.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about crosstab queries, search for "crosstab queries,
creating," and then "Create a crosstab query without using a wizard," using
the Microsoft Access 97 Help Index.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QryCross<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
