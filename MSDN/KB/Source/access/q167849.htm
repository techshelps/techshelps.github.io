

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: 'TMP%#MAU' Error Generated When Opening Linked Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167849">
<META NAME="KBModify" CONTENT="1998/01/08">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="OdbcNonms OdbcProb kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you try to open a linked table that uses an ODBC driver, you may receive the following error message:     Table 'TMP%#MAU@' already exists.  Then the table fails to ope...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDKY,QAXB,QDO3,QAE1,QDN9,QALH,QDMN,QDKX,QBVV,QAB4,QAH4,QAC1,QBD2,QA9E P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: 'TMP%#MAU' Error Generated When Opening Linked Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167849</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you try to open a linked table that uses an ODBC driver, you may
receive the following error message:
<P>
<PRE>   Table 'TMP%#MAU@' already exists.

</PRE>Then the table fails to open.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you link to an ODBC Data Source, the Microsoft Jet database engine
calls SQLSpecialColumns for the table you are linking. If SQLSpecialColumns
returns a column name, but does not include that column name in the meta-
data returned by SQLColumns, an internal state variable for the Column ID
of that column is not initialized to a valid value for a Column ID. When
you try to open the linked table, the Jet database engine tries to get
information about the invalid Column ID. If it does not resolve to a column
in the meta-data that is returned by the ODBC Driver, the Jet database
engine tries to refresh the meta-data, creating a temporary table called
TMP%#MAU. That table already exists, so the error message occurs, and you
cannot open the table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two ways you can work around this problem:

<UL><LI>Use an SQL pass-through query to manipulate the data in your data
   source, which bypasses the Jet database engine.

<LI>You can use an ODBC driver that does not return special columns, such as
   row identifiers, that are not included in the table meta-data.
<P>
</UL>Another solution that has been reported by some customers is to activate
ODBC Tracing in the ODBC Data Source Administrator before linking the
table.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0
and 97.  This problem no longer occurs in the updated version of the file,
Msjet35.dll. The updated version of the file can be obtained from the
following sources:

<UL><LI>Updated version of Microsoft Jet 3.5 (Jet35upd.exe).
<P>
   For more information about how to obtain the Microsoft Jet 3.5 update,
   please see the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../ACCESS/Q172733.htm">Q172733</A></B>
<PRE></PRE>      TITLE     : ACC97: Updated Version of Microsoft Jet 3.5 Available on
                  MSL

</PRE><LI>Microsoft Office 97 for Windows, Service Release 1 (SR-1)
<P>
   For more information about how to obtain SR-1, please see the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../OFFICE/Q172475.htm">Q172475</A></B>
<PRE></PRE>      TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><LI>Stand-alone Microsoft Access 97 Service Release 1
<P>
   NOTE: Stand-alone Microsoft Access 97 Service Release 1 is not currently
   available, but you can update your copy of Microsoft Access 97 to
   Service Release 1 by downloading Microsoft Office Service Release 1 from
   Microsoft's Web site at:
<P>
<P><PRE>      <B><A HREF="http://www.microsoft.com/office/office97/servicerelease">http://www.microsoft.com/office/office97/servicerelease</A></B>
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
With the Microsoft Jet database engine version 3.5, the value in the
uninitialized Column ID variable is most often outside the range of column
ordinal values, so the special column is not found and the Jet database
engine tries to refresh the meta-data. However, this occurs within the meta-
data refresh code itself, and the code is not designed to be called
recursively. So when the Jet database engine tries to create a temporary
table to retrieve the meta-data, it fails because the temporary table
already exists.
<P>
This behavior differs from the Microsoft Jet database engine version 3.0
that ships with Microsoft Access for Windows 95 version 7.0. With that
version of the Jet database engine, the value in the uninitialized Column
ID variable is typically within the range of column ordinal values in the
table being accessed. Therefore the special column is found, no attempt is
made to refresh the meta-data, and the table opens successfully.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about SQL pass-through queries, search the Help Index
for "pass-through queries," and see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q112108.htm">Q112108</A></B>
   TITLE     : ACC: How to Create an SQL Pass-Through Query in Code

   ARTICLE-ID: <B><A HREF="../vbapps/Q124391.htm">Q124391</A></B>
   TITLE     : ACC: Sample Code for Running Temporary SQL Pass-Through
               Query

   ARTICLE-ID: <B><A HREF="../vbapps/Q131534.htm">Q131534</A></B>
   TITLE     : ACC How to Simulate Parameters in an SQL Pass-Through Query
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: link attach thru spt sqlbase gupta centura<BR>
intersolv<BR>
Keywords          : OdbcNonms OdbcProb kberrmsg<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
