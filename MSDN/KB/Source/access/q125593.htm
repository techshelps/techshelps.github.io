

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Combo Box's AfterUpdate Event Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125593">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1995/01/31">
<META NAME="Keywords" CONTENT="FmsCmbo kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you choose a combo box's drop-down arrow, close the drop-down box without selecting an item, and then type an entry in the text portion of the combo box, the combo box's After...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBV3,QA1S,QA01,QAO4,QDN9,QAH4,QBJZ,QBXS,QAXB,QAHP,QANX,QBWS,QAE1,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Combo Box's AfterUpdate Event Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125593</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you choose a combo box's drop-down arrow, close the drop-down box
without selecting an item, and then type an entry in the text portion of
the combo box, the combo box's AfterUpdate event fails to update the
information in the combo box.
<P>
<P><h2>CAUSE</h2>
 
<P>
The combo box's Column property is not updated if you enter a value in the
combo box manually after choosing the drop-down arrow.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, requery the combo box as the first action in
your event procedure or event macro. For example, given a combo box named
MyCombo, you could requery the combo box with the following Access Basic
statement:
<P>
<PRE>   Me!MyCombo.requery

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access
version 2.0. This problem no longer occurs in Microsoft Access
version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A combo box's Column property is not updated if you type an entry in the
combo box manually after choosing the combo box's drop-down arrow. If you
are copying the value of the combo box's Column property to another control
with the AfterUpdate event, you must requery the combo box as outlined in
the "Resolution" section earlier in this article in order update the value
of the Column property before you copy the value to another control.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Customer List query in Design view. Add the Contact Name
   field to the query's third column. Save and then close the query.

<P><LI>Open the Orders form in Design view. Change the Bill To combo box's
   properties as follows:
<P>
<P><PRE>      ColumnCount: 3
      ColumnWidths: 2;0;2
      ListWidth: 4 in
      AfterUpdate: [Event Procedure]
</PRE>
<P><LI>Choose the Build button to the right of the AfterUpdate property.
   Enter the following code in the form module that opens:
<P>
<P><PRE>      Sub_Customer_ID_AfterUpdate ()
<PRE></PRE>         MsgBox Me![Customer ID].Column(2)
      End Sub

   Close the module.

</PRE><P><LI>View the form in Form view.

<P><LI>In the Bill To box, select Frankenversand. Note that a message box
   with the text "Peter Franken" appears. Choose OK.

<P><LI>In the Bill To box, type "Godos" (without the quotation marks) and then
   press ENTER. Note that a message box with the text "Peter Franken"
   appears. The message box should display "Jose Pedro Freyre." Choose
   OK.
<P>
</OL>To correct this problem, add the following line to the combo box's
AfterUpdate event procedure. Add this line before the MsgBox statement:
<P>
<PRE>   Me![Customer ID].Requery

</PRE></OL>Note that you can substitute the Recalc method for the Requery method. The
Recalc method may provide better performance if you are not performing many
floating-point operations. If you are performing many floating-point
operations, the Requery method may provide better performance.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about combo box properties, search for "combo box:
properties," and then "Combo Box Control Properties" using the Microsoft
Access Help menu.
<P>
For more information about the Requery method search for "Requery," and
then "Requery Method" using the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsCmbo kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
