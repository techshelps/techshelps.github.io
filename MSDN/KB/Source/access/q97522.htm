

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Sample DDE Macro Communicates with Microsoft Excel 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97522 ">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1993/04/13">
<META NAME="Keywords" CONTENT="IntpDde kbinterop McrHowto">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The text below demonstrates communication between two applications through dynamic data exchange (DDE). Specifically, one example shows a macro developed for Microsoft Excel...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QA1S,QDN9,QBWS,QAY5,QAUJ,QAEV,QBV8,QAB9,QBJZ,QDMW,QBXS,QBUG,QBUF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sample DDE Macro Communicates with Microsoft Excel 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97522 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
<LI>Microsoft Excel for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The text below demonstrates communication between two applications
through dynamic data exchange (DDE). Specifically, one example shows a
macro developed for Microsoft Excel version 4.0 for Windows that
starts Microsoft Access, loads a database and runs a macro. A second
example shows an Access Basic function that loads Microsoft Excel and
runs a macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Running a Microsoft Access Macro from Microsoft Excel</h3>
 
<P>
Perform the following three steps to demonstrate this behavior. These
steps assume that a "MESSAGE" macro already exists in Microsoft
Access.

<OL><P><LI>In Microsoft Excel, choose New from the File menu, select Macro
   Sheet and choose OK.

<P><LI>Enter the following macro into the macro sheet. Substitute the
   appropriate location for files on your computer.
<P>
<P><PRE>      =EXEC("c:\access\msaccess.exe c:\access\db4.mdb")
      Chan=INITIATE("MSACCESS","system")
      =APP.ACTIVATE("Microsoft Access")
      =EXECUTE(Chan,"MESSAGE")
      =TERMINATE(Chan)
      =RETURN()
</PRE>
<P><LI>To run the macro, select the first cell, select Run from the Macro
   menu and choose OK.
<P>
</OL>The EXEC function in the macro loads Microsoft Access minimized and
loads the DB4.MDB database. The macro initiates a DDE channel and
assigns it to the variable Chan. The APP.ACTIVATE switches to the
Microsoft Access window to show the macro actions running.
<P>
The EXECUTE function runs a macro named "MESSAGE," as follows.
<P>
<PRE>   Name Summary
   --------------------------------
   Application Name: "MSACCESS"
   Window Title: "Microsoft Access"
   Topic: "System"
   Item: "Message"

</PRE></OL><h3>Running a Microsoft Excel Macro from Microsoft Access</h3>
 
<P>
Perform the following two steps to demonstrate this behavior. These
steps assume that a macro named "Message" already exists in a
Microsoft Excel macro sheet named "MACRO1.XLM."

<OL><P><LI>In Microsoft Access, create a new function that contains the
   following code. Substitute the appropriate location for files on
   your computer.
<P>
<P><PRE>      Function CallExcel ()
<PRE></PRE>         Dim Chan
         x = Shell("c:\excel\excel.exe c:\excel\macro1.xlm", 1)
         Chan = DDEInitiate("Excel", "System")
         DDEExecute Chan, "[Run(""macro1.xlm!Message"")]"
         DDETerminate Chan
      End Function

</PRE><P><LI>Create a new blank form and add a command button.

<P><LI>Select the button.

<P><LI>From the View menu, choose Properties.

<P><LI>Set the button's OnPush property to the following:
<P>
<P><PRE>      = CallExcel()
</PRE><P>
   Note that the OnPush property is named OnClick in Microsoft Access
   versions 2.0 and 7.0.

<P><LI>View the form in Form view.

<P><LI>Choose the command button to start the function.
<P>
</OL>The Shell function loads Microsoft Excel and the "MACRO1.XLM" macro
sheet full screen and leaves the focus on Microsoft Excel. The macro
initiates a DDE channel and assigns it to the variable Chan.
<P>
The EXECUTE function runs a macro named "Message."
<P>
<PRE>   Name Summary
   -------------------------------------
   Application Name: "Excel"
   Window Title: "Microsoft Excel"
   Topic: "System"
   Item: "[Run(""macro1.xlm!Message"")]"

</PRE></OL>The syntax for these two macros demonstrates that the correct syntax
for the "Item" depends on the target application.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference", version 4.0, pages 14 - 15
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpDde kbinterop McrHowto<BR>
Version             : 1.0 1.1 2.0 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
