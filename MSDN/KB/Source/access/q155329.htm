

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Display a Line After Specific Records on a Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155329">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1996/08/27">
<META NAME="Keywords" CONTENT="kbusage RptEvent">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how you can display a horizontal line after specific detail records in a report, where the criteria for displaying the line changes on a sliding scale.  MO...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA7O,QABO,QA1S,QDMF,QA7N,QAWH,QBJZ,QBXT,QAH4,QAGB,QAPN,QAIB,QADP,QDN9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Display a Line After Specific Records on a Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155329</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how you can display a horizontal line after specific
detail records in a report, where the criteria for displaying the line
changes on a sliding scale.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example creates a report based on the Sales By Category query
in the sample database Northwind.mdb (or NWIND.MDB in version 2.0). The
report groups the records by category and sorts the records in each group
by total sales. It uses a variable called SalesPct to determine when a
hidden line control appears on the report. In this example, there is a red
line under the first record in each group that exceeds 10% of total sales,
and also under the first record that exceeds 40% of total sales.
<P>
NOTE: In version 2.0, there is a space in the following field names:
CategoryName, ProductName, and ProductSales. In the following example,
Change all instances of CategoryName, ProductName, and ProductSales to
Category Name, Product Name, and Product Sales.

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).

<P><LI>Create a new, blank report based on the Sales By Category query.

<P><LI>On the View menu, click Sorting And Grouping.

<P><LI>In the first Field/Expression row, click CategoryName and set the
    following properties:
<P>
       Sort Order: Ascending
       Group Header: Yes
       Keep Together: Whole Group

<P><LI>In the second Field/Expression row, click ProductSales and set the
    following property:
<P>
       Sort Order: Ascending.

<P><LI>Close the Sorting And Grouping dialog box.

<P><LI>If the field list is not displayed, on the View menu, click Field List.

<P><LI>Drag the CategoryName field from the field list to the CategoryName
    Header section of the report.

<P><LI>Drag the ProductName field and the ProductSales field from the field
    list to the detail section of the report. Align the two controls
    side by side on the same horizontal plane.

<P><LI>Add a text box control to the CategoryName Header section and set the
    following properties:
<P>
       Name: Total
       ControlSource: =Sum([ProductSales])

<P><LI>Add a text box control to the detail section, placing it to the right
    of the ProductName and ProductSales controls. Set the following
    properties:
<P>
       Name: Pcnt
       ControlSource: =[ProductSales]/[Total]
       Format: Percent
       DecimalPlaces: Auto

<P><LI>Add a line control to the detail section. Place it directly under the
    Pcnt control, and make it wide enough to underline the control. Set
    the following properties:
<P>
       Name: RedLine
       Visible: No
       BorderColor: 255
       BorderWidth: 2 pt

<P><LI>On the View menu, click Code. Add the following line to the
    Declarations section of the report's code module:
<P>
       Dim SalesPct as Single

<P><LI>Close the code module.

<P><LI>Set the OnFormat property of the CategoryName Header section to the
    following event procedure:
<P>
    In Microsoft Access 7.0 and 97
    ------------------------------
<P>
       Private Sub GroupHeader0_Format(Cancel As Integer, _
<PRE>          FormatCount As Integer)
       SalesPct = .1
       End Sub

    In Microsoft Access 2.0
    -----------------------

       Sub GroupHeader3_Format (Cancel As Integer, FormatCount As Integer)
       SalesPct = .1
       End Sub

</PRE><P><LI>Set the OnFormat property of the detail section to the following event
    procedure:
<P>
    In Microsoft Access 7.0 and 97
    ------------------------------
<P>
       Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)
       If Me![Pcnt] &gt;= SalesPct Then
<PRE>          Me![RedLine].Visible = True
          Select Case SalesPct
             Case .1
                SalesPct = .4
             Case .4
                SalesPct = 999
          End Select
       Else
          Me![RedLine].Visible = False
       End If
       End Sub

   In Microsoft Access 2.0
   -----------------------

       Sub Detail1_Format (Cancel As Integer, FormatCount As Integer)
       If Me![Pcnt] &gt;= SalesPct Then
          Me![RedLine].Visible = True
          Select Case SalesPct
             Case .1
                SalesPct = .4
             Case .4
                SalesPct = 999
          End Select
       Else
          Me![RedLine].Visible = False
       End If
       End Sub

</PRE><P><LI>Save the report as rptProductSales and open it in Print Preview.
    Note that in each category group, a red line appears on the report
    under the first detail record where the Pcnt field is greater than or
    equal to 10%, and then again where the Pcnt field is greater than or
    equal to 40%.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about sorting and grouping, search the Help Index
for "sorting" or "grouping" and view the Help topics provided, or ask
the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: condition multiple<BR>
Keywords            : kbusage RptEvent<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
