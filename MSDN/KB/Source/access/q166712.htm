

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC97: Errors Caused by Strong Typing in Microsoft Access 97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166712">
<META NAME="KBModify" CONTENT="1997/12/16">
<META NAME="KBCreate" CONTENT="1997/04/09">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  In Microsoft Access 97, you may receive one of the following error messages when you try to set or use some form and report properties in your database:     Run-time error '13': ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAB4,QAP2,QAPN,QAAP,QAUD,QAYY,QDNE,QAH4,QAZV,QALW,QDMC,QAMB,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Errors Caused by Strong Typing in Microsoft Access 97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166712</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
In Microsoft Access 97, you may receive one of the following error
messages when you try to set or use some form and report properties
in your database:
<P>
<PRE>   Run-time error '13': Type mismatch

   -or-

   Run-time error '94': Invalid use of Null

</PRE>NOTE: The same action that causes the error message in Microsoft Access 97
may not produce an error in earlier versions of Microsoft Access.
<P>
<P><h2>CAUSE</h2>
 
<P>
Some properties that returned values of Variant data type in earlier
versions of Microsoft Access are strictly typed as non-Variant data types
in Microsoft Access 97.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Verify that no errors exist in your application by doing the following:

<UL><LI>Compile and save all modules in your database.

<LI>Check for run-time errors when you run your code.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Some form and report properties that returned Variant values in earlier
versions of Microsoft Access now return strict data types. The term for
this is "strong typing" or "strict typing." Visual Basic for Applications
code in your database that includes strictly-typed properties runs faster
in Microsoft Access 97; however, when you convert a database from an
earlier version of Microsoft Access to Microsoft Access 97, you must verify
that no errors are introduced in your application by the new data types.
<P>
Following are lists of properties that returned Variant values in earlier
versions of Microsoft Access, but return specific data types in Microsoft
Access 97.
<P>
<P><h3>Properties Returning String Data Types</h3>
 
<P>
<PRE>AfterDelConfirm      InputMask        OnGotFocus     OnRetreat
AfterInsert          Item             OnInsert       OnTimer
AfterUpdate          MenuBar          OnKeyDown      OnUnload
BeforeDelConfirm     OLEClass         OnKeyPress     OnUpdated
BeforeInsert         OnActivate       OnKeyUp        OrderBy
BeforeUpdate         OnApplyFilter    OnLoad         Picture
Caption              OnChange         OnLostFocus    RecordSource
Class                OnClick          OnMenu         RowSource
ColumnWidths         OnClose          OnMouseDown    RowSourceType
ControlName          OnCurrent        OnMouseMove    ShortcutMenuBar
ControlSource        OnDblClick       OnMouseUp      SourceDoc
ControlTipText       OnDeactivate     OnNoData       SourceItem
DatasheetFontName    OnDelete         OnNotInList    SourceObject
DefaultValue         OnEnter          OnOpen         StatusBarText
Filter               OnError          OnPage         Tag
Format               OnExit           OnPrint        ValidationRule
FormName             OnFilter         OnPush         ValidationText
HelpFile             OnFormat         OnResize

</PRE><h3>Properties Returning Boolean Data Types</h3>
 
<P>
<PRE>AddColon     Dirty
AutoLabel    HideDuplicates
Cancel       RepeatSection

</PRE><h3>Properties Returning Double Data Types</h3>
 
<P>
<PRE>CurrentX       ScaleLeft
CurrentY       ScaleTop
ScaleHeight    ScaleWidth

</PRE><h3>Properties Returning Integer Data Types</h3>
 
<P>
<PRE>DatasheetGridlinesBehavior    FillStyle     OLETypeAllowed
DrawMode                      LabelAlign    RunningSum
DrawStyle                     LabelX        ScaleMode
DrawWidth                     LabelY

</PRE><h3>Properties Returning Long Data Types</h3>
 
<P>
<PRE>BackColor            DatasheetBackColor         FillColor
BorderColor          DatasheetForeColor         ForeColor
CurrentRecord        DatasheetGridlinesColor

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example demonstrates the error message that you receive if
you try to set the ControlSource property of a text box control to Null in
Microsoft Access 97. The ControlSource property is typed as a String data
type in Microsoft Access 97; you receive an error because String data types
cannot contain Null values.

<OL><P><LI>Start Microsoft Access 97 and open the sample database Northwind.mdb.

<P><LI>Open the Customers form in Design View.

<P><LI>Add a command button to the form:
<P>
<P><PRE>      Command button:
      Name: Command0
      OnClick: [Event Procedure]
</PRE>
<P><LI>Set the OnClick property of the command button to the following event
   procedure:
<P>
<P><PRE>      Private Sub Command0_Click()
<PRE></PRE>         Me![CompanyName].ControlSource = NULL
      End Sub

</PRE><P><LI>Switch the Customers form to Form view, and click the Command Button.
   Note that you receive the following error:
<P>
<P><PRE>      Run-time error '13': Type mismatch.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about strict typing, search the Help Index for "Type
Mismatch (error message)."
<P>
For more information about data types, search the Help Index for "data
types, described."
<P>
For more information about this and other issues related to converting
databases from earlier versions of Microsoft Access, please see the
following article in the Microsoft Knowledge Base for instructions on
obtaining the Microsoft Access 97 Conversion white paper:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q151193.htm">Q151193</A></B>
   TITLE     : ACC97: MS Access 97 Conversion White Paper Available on MSL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: object single byte currency date int<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
