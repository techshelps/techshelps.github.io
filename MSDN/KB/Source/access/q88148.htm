

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: How to Add New Record to a Combo Box with a Double-Click </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88148 ">
<META NAME="KBModify" CONTENT="1997/10/21">
<META NAME="KBCreate" CONTENT="1992/08/18">
<META NAME="Keywords" CONTENT="FmsEvnt">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to set up a macro so that you can add new values to a combo box. The article uses the Orders form in the sample database Northwind.mdb (or Nwind.mdb in...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAGU,QA5V,QAUJ,QA1S,QAI2,QAH4,QA5W,QAW6,QAUR,QDN9,QAF0,QA4H,QAZV,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Add New Record to a Combo Box with a Double-Click</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88148 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to set up a macro so that you can add new
values to a combo box. The article uses the Orders form in the sample
database Northwind.mdb (or Nwind.mdb in earlier versions) as an example.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Follow these steps to modify the Orders form so that you can add new
values to the Salesperson combo box:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new macro, and save it as Macro1:
<P>
<P><PRE>    In Microsoft Access 97
    ----------------------
</PRE><P>
<PRE>       Macro Name   Condition                   Action
       -----------------------------------------------------
       NewRecord                                OpenForm
       OnClose      [EmployeeID] Is Not Null    RunCommand
                    ...                         SelectObject
                    ...                         ReQuery
                    ...                         SetValue

       NewRecord Actions
       ---------------------------------------------------------
       OpenForm
          Form Name: Employees
          View: Form
          Data Mode: Add
          Window Mode: Normal

       OnClose Actions
       -------------------------------------------------------------------
       RunCommand
          Command: SaveRecord
       SelectObject
          Object Type: Form
          Object Name: Orders
          In Database Window: No
       ReQuery
          ControlName: EmployeeId
       SetValue
          Item: Forms!Orders![EmployeeID]
          Expression: Forms!Employees![EmployeeID]

    In Microsoft Access 7.0
    -----------------------

       Macro Name   Condition                   Action
       -----------------------------------------------------
       NewRecord                                OpenForm
       OnClose      [EmployeeID] Is Not Null    DoMenuItem
                    ...                         SelectObject
                    ...                         ReQuery
                    ...                         SetValue

       NewRecord Actions
       ---------------------------------------------------------
       OpenForm
          Form Name: Employees
          View: Form
          Data Mode: Add
          Window Mode: Normal

       OnClose Actions
       -------------------------------------------------------------------
       DoMenuItem
          Menu Bar: Form
          Menu Name: Records
          Command: Save Record
       SelectObject
          Object Type: Form
          Object Name: Orders
          In Database Window: No
       ReQuery
          ControlName: EmployeeId
       SetValue
          Item: Forms!Orders![EmployeeID]
          Expression: Forms!Employees![EmployeeID]

    In Microsoft Access 1.x and 2.0
    -------------------------------

       Macro Name   Condition                   Action
       -----------------------------------------------------
       NewRecord                                OpenForm
       OnClose      [Employee ID] Is Not Null   DoMenuItem
                    ...                         SelectObject
                    ...                         ReQuery
                    ...                         SetValue

       NewRecord Actions
       ---------------------------------------------------------
       OpenForm
          Form Name: Employees
          View: Form
          Data Mode: Add
          Window Mode: Normal

       OnClose Actions
       -------------------------------------------------------------------
       DoMenuItem
          Menu Bar: Form
          Menu Name: File
          Command: Save Record
       SelectObject
          Object Type: Form
          Object Name: Orders
          In Database Window: No
       ReQuery
          ControlName: Employee Id
       SetValue
          Item: Forms!Orders![Employee ID]
          Expression: Forms!Employees![Employee ID]

</PRE><P><LI>Change the properties of the EmployeeID (or Employee ID in versions 1.x
   and 2.0) combo box on the Orders form as follows:
<P>
<P><PRE>      OnDblClick: Macro1.NewRecord
      StatusBarText: Double-click to Add a New Employee
</PRE>
<P><LI>Change the OnClose property of the Employees form as follows:
<P>
<P><PRE>      On Close: Macro1.OnClose
</PRE><P>
</OL>To see how this works, open the Orders form in Form view, and then double-
click the Salesperson combo box. Note that the Employees form opens. After
you add a new record, close the Employees form and the new employee's name
appears on the Orders form.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: doubleclick update record<BR>
Keywords          : FmsEvnt<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
