

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: VBA Functions Break in Database with Missing References </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160870">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1996/12/11">
<META NAME="Keywords" CONTENT="MdlLib">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you have a procedure that contains a Visual Basic for Applications function, and your database contains a reference to a missing object library or type library, you may receiv...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBHQ,QAB4,QAB3,QA1S,QDH6,QAZV,QBWS,QAH4,QAY5,QAW6,QAPN,QANA,QAEF,QA01 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: VBA Functions Break in Database with Missing References</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160870</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Excel 97
<LI>Microsoft Word 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you have a procedure that contains a Visual Basic for Applications
function, and your database contains a reference to a missing object
library or type library, you may receive the following error message when
you compile your modules or execute the procedure.
<P>
<P><h3>In Microsoft Access 97, Microsoft Excel 97, Microsoft Word 97</h3>
 
<P>
<PRE>      Compile Error:
      Can't find project or library

</PRE><h3>In Microsoft Access 7.0</h3>
 
<P>
<PRE>      Can't find project or library

</PRE><h2>CAUSE</h2>
 
<P>
Your database contains a reference to a database, type library, or object
library which is marked as "Missing:" in the References dialog box.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Follow these steps to remove the missing reference:

<OL><P><LI>Open your database.

<P><LI>Open a module in Design view.

<P><LI>On the Tools menu, click References.

<P><LI>Click to clear the check box for the type library or object library
   marked as "Missing:."
<P>
</OL>An alternative to removing the reference is to restore the referenced file
to the path specified in the References dialog box. If the referenced file
is in a new location, clear the "Missing:" reference and create a new
reference to the file in its new folder.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new module.

<P><LI>On the Tools menu, click References.

<P><LI>Click Microsoft Excel 8.0 Object Library (or Microsoft Excel 5.0
   Object Library if you have Microsoft Excel 7.0) in the Available
   References box, and then click OK.

<P><LI>Create the following procedure in the module window:
<P>
<P><PRE>      Function Test(x as string)
<PRE></PRE>         Msgbox Left(x, 5)
      End Function

</PRE><P><LI>Save the module as Module1, and then close the database.

<P><LI>If you have Microsoft Excel 97, rename the file Excel8.olb to
   Excel8a.olb. This is the Microsoft Excel 8.0 Object Library file,
   which is installed by default in the C:\Program Files\Microsoft
   Office\Office\ folder.
<P>
   If you have Microsoft Excel 7.0, rename the file Xl5en32.olb to
   Xl5en32.xyz. This is the Microsoft Excel 5.0 Object Library file,
   which is installed by default in the C:\MSOffice\Excel folder.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Open Module1 in Design view.

<P><LI>On the Debug menu (or the Run menu in Microsoft Access 7.0), click
<P><PRE>    Compile Loaded Modules. Note that you receive the error message.
</PRE>
<P><LI>Click OK in the error message box, and the References dialog box opens
<P><PRE>    automatically. Note the word MISSING: in front of the Microsoft Excel
    Object Library.
</PRE>
<P><LI>Click Cancel in the References dialog box, and then close the database.

<P><LI>Rename Excel8a.olb to Excel8.olb (or rename Xl5en32.xyz to
<P><PRE>    Xl5en32.olb).
</PRE>
<P><LI>Repeat steps 8 - 10 and note that the error message no longer appears.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For a complete list of Visual Basic for Applications functions, search the
Help Index for "functions, reference topics," or ask the Microsoft Access
97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Now Time Date Left Right Mid Str Format Trim LTrim<BR>
RTrim<BR>
Keywords            : MdlLib<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
