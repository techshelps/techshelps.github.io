

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Links to Formatted DDE Items Result in Text </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90108 ">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1992/10/08">
<META NAME="Keywords" CONTENT="IntpDde kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  A calculated control that uses another control linked through dynamic data exchange (DDE), displays the  #Error  message when displayed in Form view or in a report's Preview...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QBJZ,QBVP,QAHP,QA1S,QAZ2,QADK,QBS9,QBWS,QATX,QAMB,QDN9,QBUG,QBUF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Links to Formatted DDE Items Result in Text</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90108 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
A calculated control that uses another control linked through dynamic data
exchange (DDE), displays the "#Error" message when displayed in Form view
or in a report's Preview.
<P>
<P><h2>CAUSE</h2>
 
<P>
Controls based on DDE links to numeric items that have been formatted in
Microsoft Excel result in text. To perform calculations on the results of
these links, you must convert the results to a Numeric data type.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following example demonstrates how to create a DDE link to a numeric
item that has been formatted:

<OL><P><LI>Start Microsoft Excel.

<P><LI>In cell A1 of Sheet1, type "80" (without the quotation marks).

<P><LI>Select cell A1, and choose Number from the Format menu.

<P><LI>From the Format Codes list, select a currency format, such as
    $#,##0_);($#,##0), and then choose the OK button.

<P><LI>Select cell A1, and choose Copy from the Edit menu.

<P><LI>Start Microsoft Access and open any database.

<P><LI>Create a new form not based on any table or query.

<P><LI>From the Edit menu, choose Paste Special, and then select Text from
    the Data Type list.

<P><LI>Choose Paste Link. Note that a text box with the following formula is
    created on the form:
<P>
       =DDE("Excel","Sheet1","R1C1")

<P><LI>Create a new text box on the form, and enter the formula:
<P>
       =Field0+100

<P><LI>View the form in Form view. Note that the first text box, Field0,
    displays "$80." The second text box displays "#Error."
<P>
</OL>The following steps demonstrate how to convert the DDE-linked item to a
Numeric data type:

<OL><P><LI>View the form in Design view.

<P><LI>Change Field0 as follows:
<P>
<P><PRE>      =CCur(DDE("Excel","Sheet1","R1C1"))
</PRE>
<P><LI>View the form in Form view. Note that the second text box now displays
   the value 180.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior no longer occurs when you link formatted numbers between
Microsoft Access version 7.0 and Microsoft Excel versions 5.0 or 7.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about data type conversions, search for "converting
data types" using the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpDde kberrmsg kbinterop<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
