

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC95: Parameter Query Excludes Ending Date </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149945">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1996/04/16">
<META NAME="Keywords" CONTENT="kbusage QryParm">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use a Date/Time field as a parameter within a parameter query, where both valid dates and times have been stored within the Date/Time field, some of the expected records...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QAU3,QAMR,QA5V,QANE,QAKD,QAFH,QAUD,QA7O,QA7N,QAHE,QACF,QAY4,QAPF,QANY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Parameter Query Excludes Ending Date</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149945</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use a Date/Time field as a parameter within a parameter query,
where both valid dates and times have been stored within the Date/Time
field, some of the expected records may not appear in the recordset when
you type only dates (excluding time values)into the parameter box when
prompted.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, enter 11:59:59pm as part of the parameter
value when entering a date into the parameter box prompt, or enter the day
you want plus one. For example, if you want 07/31/93, enter a date of
08/01/93 when prompted for a date.
<P>
Another approach would be to create a field expression within the parameter
query that would parse the time from the Date/Time field. For example:
<P>
<PRE>     Expr1: CVDate(Int([&lt;DateTimeFld&gt;]))

</PRE>where &lt;DateTimeFld&gt; would be replaced by the name of the actual Date/Time
field within the table.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you simply store a date (excluding the time) into a Date/Time field,
the field will assume a default time value of 12:00:00am.
<P>
If the following were entered as the query's criteria:
<P>
<PRE>     Between [&lt;param1&gt;] and [&lt;param2&gt;]

</PRE>the recordset would not include records that have a time value greater that
12:00:00am if only a date is entered into &lt;param2&gt;. When only a date is
entered into &lt;param2&gt;, Microsoft Access will always assume a time value of
12:00:00am. Although many records may have a date that matches the date
entered into &lt;param2&gt;, if the date field also stores a time value greater
than 12:00:00am, that record will be excluded from the recordset.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
This example assumes that the sample database Northwind.mdb has not been
previously altered.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new query in Design View and add the Orders table.

<P><LI>Drag the OrderDate field to the QBE grid and set Sort to Ascending.

<P><LI>Enter the following criteria into the OrderDate column:
<P>
<P><PRE>      Between [Start Date] And [End Date]
</PRE><P>
   NOTE: It is necessary to define the data type of both [Start Date] and
   [End Date] by clicking Parameters on the Query menu.

<P><LI>Click Run on the Query menu and enter the following values when
   prompted for the Start Date and End Date:
<P>
<P><PRE>      08/01/93
</PRE><P>
<P><PRE>      08/31/93
</PRE>
<P><LI>Move to the very last record, which should have an OrderDate value of
   08/31/93 and add "12:00:01am" to the field's current date value.
   The new OrderDate value should look like as follows:
<P>
<P><PRE>      08/31/93 12:00:01am
</PRE>
<P><LI>Click Query Design on the View menu and once in Design view, click
   Run on the Query menu to rerun the query.

<P><LI>When prompted, use the same values you used in step 5.
<P>
   NOTE: Because only a date was entered into the [End Date] prompt,
   Microsoft Access assumes a default time of 12:00:00am. The results of
   this new recordset drops the record that has a date of 08/31/93 because
   it now contains a time value greater than 12:00:00am.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QryParm<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
