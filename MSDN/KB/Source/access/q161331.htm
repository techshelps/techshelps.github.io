

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Number Field with Input Mask Appears as Text in MS Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161331">
<META NAME="KBModify" CONTENT="1997/06/04">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="IsmExl5 IsmOthr kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you export a table to Microsoft Excel using the OutputTo macro action or a Visual Basic method, Number fields that have an input mask appear as Text fields in Microsoft Exce...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKC,QBC6,QA7O,QA7N,QATX,QAMB,QAPN,QAG8,QAYY,QBJZ,QAH4,QA1S,QA3P,QAUJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Number Field with Input Mask Appears as Text in MS Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access, versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you export a table to Microsoft Excel using the OutputTo macro action
or a Visual Basic method, Number fields that have an input mask appear as
Text fields in Microsoft Excel.
<P>
<P><h2>CAUSE</h2>
 
<P>
When a field in a table uses an input mask, Microsoft Access outputs the
data in a custom format. The custom format causes the indexed sequential
access method (ISAM) driver for Microsoft Excel to treat the field as Text.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want to maintain your data as a Number field, use the Save
As/Export command on the File menu. If you only want the data in Microsoft
Excel to look the same as it does in Microsoft Access, you can use
OutputTo.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
NOTE: The following example uses the OutputTo action in a macro. The same
results apply if you use the OutputTo method of the DoCmd object in Visual
Basic code.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new table in Design view. You do not need to
   create a primary key:
<P>
<P><PRE>      Table: InputMasks
      ------------------------
      Field Name: 99999 text
<PRE></PRE>         Data Type: Text
         Input Mask: 99999
      Field Name: 99999 number
         Data Type: Number
         Input Mask: 99999
      Field Name: 00000 text
         Data Type: Text
         Input Mask: 00000
      Field Name: 00000 number
         Data Type: Number
         Input Mask: 00000
      Field Name: ##### text
         Data Type: Text
         Input Mask: #####
      Field Name: ##### number
         Data Type: Number
         Input Mask: #####

</PRE><P><LI>Save the InputMasks table, and then open it in Datasheet view.

<P><LI>Add the following records to the InputMasks table:
<P>
<PRE>      99999   99999    00000   00000    #####   #####
      Text    Number   Text    Number   Text    Number
      ------------------------------------------------
      12345   12345    12345   12345    12345   12345
      01201   01201    01201   01201    01201   01201
      1 2 3   123      12300   12300    1 2 3   123

   Note the way the data is aligned in the Text and Number fields, and
   note that the second row of data drops the leading zero in the Number
   fields, but not in the Text fields.

</PRE><P><LI>Close the table.

<P><LI>Create the following new macro called TestXLFormat:
<P>
<PRE>      Macro Name     Action
      -----------------------
      TestXLFormat   OutputTo

      TestXLFormat Actions
      ---------------------------------------------
      OutputTo
        Object Type: Table
        Object Name: InputMasks
        Output Format: Microsoft Excel (*.xls)
        Output File: c:\My Documents\InputMasks.xls
        Auto Start: Yes

</PRE><P><LI>Saved the macro, and then run it.

<P><LI>When Microsoft Excel starts and displays the spreadsheet, the alignment
   and the appearance of the data is the same as it is in Microsoft Access.

<P><LI>Click in the B2 cell, and then click Cells on the Format menu. Note
   that the Number tab shows a custom format, #####, that makes the Text
   cells appear as Numbers.
<P>
</OL>If you export the InputMasks table to Microsoft Excel format using the
Save As/Export command on the File menu, the numeric integrity of your
data is preserved.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the OutputTo action or method, search the Help
Index for "OutputTo action" or "OutputTo method."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IsmExl5 IsmOthr kbinterop<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
