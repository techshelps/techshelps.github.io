

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Storing SQL Database Login IDs and Passwords Locally </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101084">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1993/07/04">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Storing SQL database login IDs and passwords locally requires that the database administrator create a unique table on the server.  MORE INFORMATION  In Microsoft Access whe...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QABM,QAZV,QAWK,QDN9,QAKJ,QAMB,QBXS,QA4H,QBW7,QBVV,QA4P,QARR,QBWU,QA94 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Storing SQL Database Login IDs and Passwords Locally</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101084</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Storing SQL database login IDs and passwords locally requires that the
database administrator create a unique table on the server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Access when you link (attach in Microsoft Access 2.0 or
earlier) a SQL database table, you can choose whether you want Microsoft
Access to store your login ID and password locally. If you do not,
Microsoft Access prompts you for your login ID and password each time you
connect to the SQL database containing the table.
<P>
If you want Microsoft Access to store the connection information in your
Microsoft Access database so that you do not have to type it each time,
you can click to select the Save Login ID And Password Locally check box in
the Attach Tables dialog box when you link the SQL database table.
<P>
For Microsoft SQL Server, Sybase SQL Server, and ORACLE Server databases,
your SQL database administrator can choose to disable this feature,
requiring all users to enter their login IDs and passwords each time they
connect to a SQL database.
<P>
To disable the ability to store login IDs and passwords locally, your
SQL database administrator must create a table called MSysConf in the
SQL database. When a user connects to the SQL database, Microsoft
Access looks for this table in the database and, if it finds it,
queries the table. If the values in the table correctly specify that
local storing of login IDs and passwords should be disabled, Microsoft
Access does so, regardless of whether the Save Login ID And Password
Locally check box is selected. If the table is not present or does not
specify disabling of the feature, users can store login IDs and
passwords locally.
<P>
The SQL database table MSysConf should have the following structure.
<P>
<PRE>   Column name   Data type                                 Allows Null?
   --------------------------------------------------------------------
   Config        A data type that corresponds to a         No
                 2-byte integer

   chValue       VARCHAR(255)                              Yes

   nValue        A data type that corresponds to a
                 4-byte integer                            Yes

   Comment       VARCHAR(255)                              Yes

</PRE>If the data source you are working with is case-sensitive, use the table
and column names exactly as shown. All users must have permission to use
the SELECT statement on this table and only the system administrator can
have permission to use the DELETE statement on this table.
<P>
In ORACLE, there are a few things that are different. For instance, the
word "Comment" is reserved in ORACLE, so you will need to change it to
"Comments." The other change relates to a difference in data types. Here is
how the table would appear in an ORACLE database:
<P>
<PRE>   CONFIG          NUM(4,0)         NOT NULL
   CHVALUE         VARCHAR(255)
   NVALUE          NUM(5,0)*
   COMMENTS        VARCHAR(255)

</PRE>Nvalue can have a precision of up to Num(9,0).
<P>
To disable password and login ID storage, the table should have only one
row as follows:
<P>
<PRE>   Column name     Value    Explanation
   --------------------------------------------------------------------
   Config          101      This is the only valid value for Microsoft
                            Access version 1.1.

   chValue         NULL     This is reserved for future use.

   nValue          0 or 1   Use 0 to prevent the password and login ID
                            from being stored; use 1 to permit
                            password and login ID storage as in
                            version 1.0. The default is 1.

   Comment                  Allow storage of passwords and login IDs in
                            Microsoft Access.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage OdbcOthr<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
