

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: List Box Column Property Gets Incorrect Row Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109827">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="FmsCmbo kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you select a row from a multicolumn list box or combo box, controls that reference the Column property of the list box or combo box retrieve data from a different row in the...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QA37,QBT6,QAKC,QBV4,QA7O,QAHP,QAPN,QBC6,QA5V,QA7N,QA1S,QAE1,QAWI,QBQU P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: List Box Column Property Gets Incorrect Row Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109827</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.x, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you select a row from a multicolumn list box or combo box, controls
that reference the Column property of the list box or combo box retrieve
data from a different row in the list box or combo box.
<P>
NOTE: A list box may appear to work as desired, but upon binding the list
box, it will exhibit the same behavior as a combo box.
<P>
<P><h2>CAUSE</h2>
 
<P>
The list or combo box's BoundColumn property does not point to a field
with unique values.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The list or combo box's BoundColumn property must point to a field that
contains unique values. If the BoundColumn property does not point to a
field with unique values, Microsoft Access will return information for
the first row with a matching BoundColumn value when you select a row in
the list box or combo box.
<P>
For example, the Type field in the sample table below does not contain
unique values. If the Type field is used for the BoundColumn property, a
text box referencing the second column will return Apple rather than
Grape when you select the third row.
<P>
<PRE>   Type    Description
   -------------------
   Fruit   Apple
   Fruit   Orange
   Fruit   Grape

</PRE>If you use the Description column for the BoundColumn property, the
behavior will not occur because the Description column contains unique
values.
<P>
Another way to resolve this behavior would be to add a Counter field (or
AutoNumber field in Microsoft Access 7.0 and 97) to the underlying table,
and then use the Counter field (or AutoNumber field)for the BoundColumn
property.
<P>
In Microsoft Access 7.0 and 97, the following code can be added to the
AfterUpdate property of the combo box.
<P>
<PRE>   Me![Stock Number] = _
   Me![Manufacturer].Column(1, Me![Manufacturer].ListIndex)

   Me![Description] = _
   Me![Manufacturer].Column(2, Me![Manufacturer].ListIndex)

   NOTE: If you use this code, remove the expressions that are assigned to
   the ControlSource properties of the Stock Number control and Description
   control.

</PRE>In Microsoft Access 7.0 and 97, the ListIndex property of the combo box
or list box can be used as a pointer to the correct row in the combo box or
list box. Non-unique columns in a combo box or list box can be resolved by
setting the BoundColumn property to 0 (zero). This will allow a text box on
a form to be populated with, for example, a value in combox.column(1) when
no columns with the combo box contain unique values.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create the following table:
<P>
<P><PRE>      Table: Table1
      ---------------------------
      Field Name: Manufacturer
<PRE></PRE>         Data Type: Text
      Field Name: Stock Number
         Data Type: Number
         Field Size: Long Integer
         Indexed: Yes
      Field Name: Description
         Date Type: Text

      Table Properties: Table1
      -------------------------
      Primary Key: Stock Number

</PRE><P><LI>View the table in Datasheet view. Add the following data to the
   table:
<P>
<PRE>      Manufacturer   Stock Number   Description
      -----------------------------------------
      IB Co          1              Mouse
      IB Co          2              Printer
      IB Co          3              Hard Drive
      ComCo          4              PC

</PRE><P><LI>Create the following new form:
<P>
<P><PRE>      Form: Test1
      Combo box: Manufacturer
<PRE></PRE>         ControlSource: &lt;leave empty&gt;
         RowSourceType: Table/Query
         RowSource: Table1
         ColumnCount: 3
         BoundColumn: 1
         Width: 3
      Text box: Stock Number
         ControlSource: =[Manufacturer].Column(1)
      Text box: Description
         ControlSource: =[Manufacturer].Column(2)

</PRE><P><LI>View the form in Form view.

<P><LI>Select the first row in the combo box. Note that the Stock Number
   and Description boxes correctly display "1" and "Mouse."

<P><LI>Select the third row in the combo box. Note that the Stock Number and
   Description boxes still display the information from the first row.

<P><LI>Select the fourth row in the combo box. Note that the Stock Number and
   Description boxes display the correct information for the fourth row.
<P>
</OL>If you change the BoundColumn property of the Manufacturer list box to 2
instead of 1, the text boxes on the form will display the correct
information for all the rows in the list box because the second column
contains unique values.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating combo boxes, search the Help Index
for "creating combo boxes," or ask the Microsoft Access 97 Office
Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: duplicate bound column<BR>
Keywords            : FmsCmbo kbusage<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
