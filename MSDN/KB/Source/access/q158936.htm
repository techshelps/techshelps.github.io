

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Recovering Data from a Nonmember of a Replica Set </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158936">
<META NAME="KBModify" CONTENT="1997/05/23">
<META NAME="KBCreate" CONTENT="1996/11/07">
<META NAME="Keywords" CONTENT="kbusage RplConf RplGen">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to recover data from a nonmember of a replica set and synchronize it back into a replica set. The nonmember can be a database with an invalid repl...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAFO,QA5V,QBWS,QAY2,QARR,QA7O,QA7N,QAYY,QAR4,QAUJ,QBXS,QAPF,QACF,QDMC P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Recovering Data from a Nonmember of a Replica Set</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158936</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to recover data from a nonmember of a replica
set and synchronize it back into a replica set. The nonmember can be a
database with an invalid replica ID, or a database that is not part of the
replica set.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use this technique to recover data if the ReplicaID property of a
replicated database becomes invalid. Without a valid replica ID, a database
is unable to synchronize with the other databases in a replica set. You can
also use this technique to extract data from an unreplicated copy of a
database, and add the data to the replica set.
<P>
Start by linking tables from the nonmember database and use append queries
to add new data to the tables in the replica database. Then create select
queries to help you identify data that has changed.
<P>
NOTE: If your database enforces referential integrity in any of its
relationships, then you must append data from a table on the "one" side of
a relationship before you can append data from a table on the "many" side.
<P>
Appending New Data
 

<OL><P><LI>Synchronize all members of the replica set so that the data is current
   in all databases.

<P><LI>Create a new replica database in the same folder as the nonmember
   database, but with a different file name. You can create the replica
   from the Design Master database or from another replica.

<P><LI>Open the new replica database.

<P><LI>On the File menu, point to Get External Data, and then click Link
   Tables.

<P><LI>Select the nonmember database file, and then click Link.

<P><LI>Link all the replicated tables in the nonmember database. The
   replicated tables are those that have a matching table name in the
   current database. The linked tables will keep the same names, but will
   have the number 1 appended to the end. For example, a linked Customers
   table is named Customers1.

<P><LI>Create a new query for each of the linked table/local table pairs
   using the Find Unmatched Query Wizard. For example, create a query
   based on the tables Customers1 and Customers.

<P><LI>In the "Which table or query contains records you want in the query
   results?" dialog box, select the linked table, and then click Next.

<P><LI>In the "Which table or query contains the related records?" dialog
   box, select the local table which corresponds to the linked table you
   chose in the previous dialog box, and then click Next.

<P><LI>In the "What piece of information is in both tables?" dialog box,
<P><PRE>    select the primary key field from each table, click the &lt;=&gt; button to
    join the fields, and then click Next.
</PRE>
<P><LI>In the "What fields do you want to see in the query results?" dialog
<P><PRE>    box, move all the fields to the Selected fields box, and then click
    Next.
</PRE>
<P><LI>In the "What would you like to name your query?" dialog box, click
<P><PRE>    Modify the design, and then click Finish. The new query opens in
    Design view.
</PRE>
<P><LI>On the Query menu, click Append Query (or Append in version 7.0). In
<P><PRE>    the Append dialog box, select the local table in the Table Name box.
</PRE>
<P><LI>Verify that the Append To field name in the QBE grid is correct in
<P><PRE>    every column except the column containing the primary key from the
    local table; clear the Append To cell in that column.
</PRE>
<P><LI>On the Query menu, click Run to append the new records from the linked
<P><PRE>    table to the local table.
</PRE>
<P><LI>Close the query. You do not need to save it.

<P><LI>Repeat steps 7-16 for each table that you want to update.
<P>
</OL><h3>Identifying Data That Has Changed</h3>
 

<OL><P><LI>Create a new query in Design view for each one of the local
   table/linked table pairs. For example, create a query based on the
   Customers and Customers1 tables.

<P><LI>In the query Design window create a join between the two tables based
   on the Primary Key or other field(s) that uniquely identify each row
   of data.

<P><LI>Add all fields from the linked table to the QBE grid.

<P><LI>In the Criteria for each of the fields, type an expression to indicate
   that the data is not equal to the data in the corresponding field name
   of the local table. For example, if the local table is People and the
   attached table is People1, the QBE grid looks as follows:
<P>
<PRE>       Field:    Name               Addr               City
       Table:    People1            People1            People1
       Criteria: &lt;&gt;[People].[Name]
       or:                          &lt;&gt;[People].[Addr]
       or:                                             &lt;&gt;[People].[City]

   NOTE: You must type each expression in its own row, stepping down one
   line for each new criteria as in the example above.

</PRE><P><LI>On the Query menu, click Run.

<P><LI>The records that the query returns are those records in the nonmember
   database that are different in some way from the corresponding records
   in the replica database. You must decide if the record in the nonmember
   database is correct or if the record in the replica database is
   correct, and then update the replica database accordingly. Manually
   reviewing and updating these changes is the surest way to do it,
   because it can be difficult to determine programmatically which
   database contains the correct information. For example, if the Address
   field for customer number 1234 is different in each database, you must
   decide which database is correct.

<P><LI>Repeat steps 1-6 for each table that you want to update.
<P>
</OL><h3>Synchronizing the Data and Importing Unreplicable Objects</h3>
 

<OL><P><LI>When all new and changed data has been updated in the replica, you can
   delete the table attachments and synchronize with other members of the
   replica set.

<P><LI>If the nonmember database contains local objects that you want to
   include in the replica, you can import them into the new replica. This
   applies to all objects, not just tables.

<P><LI>When you confirm that the new replica database is working properly,
   you can replace the nonmember database with the new replica you
   created.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about replication and creating replica databases,
search the Help Index for "replicas," or ask the Microsoft Access 97 Office
Assistant.
<P>
For information about obtaining the Microsoft Jet Replication White
Paper, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../ACCESS/Q138828.htm">Q138828</A></B>
   TITLE     : ACC95: Microsoft Jet Replication White Paper Available on
               MSL

   ARTICLE-ID: <B><A HREF="../ACCESS/Q164553.htm">Q164553</A></B>
   TITLE     : ACC97: Jet 3.5 Replication White Paper Available on MSL
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage RplConf RplGen<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
