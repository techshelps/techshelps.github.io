

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: "PrtDevMode" Help Example Forces Resave of Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132027">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1995/06/26">
<META NAME="Keywords" CONTENT="kbprint PtrProb">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you use either one of the two sample user-defined Access Basic functions in the  Example  section of the  PrtDevMode  topic in the Microsoft Access Help system as it is printe...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAUR,QAY5,QAPF,QDN9,QA5F,QAU7,QAMA,QAH4,QBV8,QAB9,QBXT,QA5V,QAIB,QA63 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: "PrtDevMode" Help Example Forces Resave of Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132027</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you use either one of the two sample user-defined Access Basic functions
in the "Example" section of the "PrtDevMode" topic in the Microsoft Access
Help system as it is printed, the function runs correctly, but you are
prompted to resave the report after the function finishes running.
<P>
<P><h2>CAUSE</h2>
 
<P>
The code that saves the report runs before the Painting property of the
report is set. Therefore, when the report is closed at the end of the
function, Microsoft Access tries to resave the report with the new
Painting value.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For each of the sample Access Basic functions in the example, move the line
that saves the report so that it is after the line that sets the Painting
property value. Because the resolution is the same for both sample
functions, this section demonstrates the resolution for only the first
function in the example.
<P>
The first sample Access Basic function in the "Example" section of the
"PrtDevMode" topic in the Microsoft Access Help system reads as follows:
<P>
<PRE>   Function SetCopies (MyReport As String, Copies As Integer)
        Dim dm As zwtDevModeStr  ' Structures defined in zwAllGlobals.
   module_ in WZFRMRPT.MDA.
        Dim DevMode As zwtDeviceMode
        DoCmd OpenReport MyReport, A_DESIGN
        Reports(MyReport).Painting = False
        If Not IsNull(Reports(MyReport).PrtDevMode) Then
             dm.rgb = Reports(MyReport).PrtDevMode
             LSet DevMode = dm
             DevMode.dmCopies = Copies
             LSet dm = DevMode
             Reports(MyReport).PrtDevMode = dm.rgb
             DoCmd SetWarnings False
             DoCmd DoMenuItem 7, A_FILE, 2  'This line saves the report.
             DoCmd SetWarnings True
        End If

        Reports(MyReport).Painting = True
        DoCmd Close A_REPORT, MyReport
   End Function

</PRE>In the sample code above, change the last seven lines of code just below
the line that read "Reports(MyReport).PrtDevMode = dm.rgb" to read as
follows:
<P>
<PRE>             DoCmd SetWarnings False
             DoCmd SetWarnings True
        End If

        Reports(MyReport).Painting = True
        DoCmd DoMenuItem 7, 0, 2, , A_MENU_VER20  ' Report|File|Save.
        DoCmd Close A_REPORT, MyReport
   End Function
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprint PtrProb<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
