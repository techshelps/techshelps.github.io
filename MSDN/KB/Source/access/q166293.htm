

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: ShortcutMenuBar Property Does Not Work on Image or Label </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166293">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1997/04/02">
<META NAME="Keywords" CONTENT="FmsHowto FmsProp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you set the ShortcutMenuBar property of an image control or label control on a form to the name of a custom shortcut menu, right-clicking the control causes the default shor...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKR,QAF0,QA1S,QAPN,QAMB,QAC2,QDN9,QAMN,QAB5,QA7O,QAOE,QBS0,QBXS,QAUJ,QBWR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: ShortcutMenuBar Property Does Not Work on Image or Label</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166293</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you set the ShortcutMenuBar property of an image control or label
control on a form to the name of a custom shortcut menu, right-clicking the
control causes the default shortcut menu for the form to appear.
<P>
<P><h2>CAUSE</h2>
 
<P>
The ShortcutMenuBar property does not work with controls that cannot
receive the focus.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use one of the following methods to work around this behavior, depending on
your version of Microsoft Access.
<P>
<P><h3>Method 1: Microsoft Access 7.0 and 97</h3>
 
<P>
Place an invisible command button on the form and use it to invoke your
custom shortcut menu:

<OL><P><LI>Add a command button control to the form. Place it on top of the image
   or label control, and size it to cover the image or label completely.

<P><LI>Set the Transparent property of the command button to Yes.

<P><LI>Set the ShortcutMenuBar property of the command button to the name of
   the custom shortcut menu that you want to display.
<P>
</OL><h3>Method 2 (Microsoft Access 97)</h3>
 
<P>
You can use the MouseDown event of the image or label control to invoke the
ShowPopup method of your custom shortcut menu. In order to use this method,
your custom menu must have its Type property set to PopUp, which is a
requirement for any shortcut menu.
<P>
This example assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
Set the MouseDown event of the image or label control to the following
event procedure. This example assumes a control named Image0, and a
shortcut menu named Custom1; substitute the names of your own control and
shortcut menu in the procedure.
<P>
<PRE>   Private Sub Image0_MouseDown(Button As Integer, Shift As Integer, _
      X As Single, Y As Single)
   'If the right mouse button is pressed, show the custom shortcut menu
   If Button = acRightButton Then
      CommandBars![Custom1].ShowPopup
   End If
   'Cancel the event so the form's default shortcut menu does not appear
   DoCmd.CancelEvent
   End Sub

</PRE></OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using shortcut menus in Microsoft Access, search
the Help Index for "shortcut menus," or ask the Microsoft Access 97 Office
Assistant.
<P>
For more information about the ShortcutMenuBar property, search the Help
Index for "ShortcutMenuBar property."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: short cut popup<BR>
Keywords            : FmsHowto FmsProp kbusage<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
