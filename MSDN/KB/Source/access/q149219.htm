

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC95: NewPassword Method Doesn't Update Current Session </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149219">
<META NAME="KBModify" CONTENT="1997/05/23">
<META NAME="KBCreate" CONTENT="1996/03/28">
<META NAME="Keywords" CONTENT="kberrmsg kbusage ScrtUsr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  After using the NewPassword method to change a user's password, the user is unable to access objects for which he or she has permissions. The user receives the error message...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAB4,QAWK,QDN9,QAGU,QAI5,QAXB,QAPN,QBV4,QBWS,QBT6,QBJZ,QAHP,QAMB,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: NewPassword Method Doesn't Update Current Session</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149219</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
After using the NewPassword method to change a user's password, the user
is unable to access objects for which he or she has permissions. The user
receives the error message "Not a valid account name or password."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two possible workarounds for this error message.
<P>
<P><h3>Workaround 1</h3>
 
<P>
You can avoid the error message by using the user interface to a change
password instead of the NewPassword method in Visual Basic for
Applications. Here are the basic steps:

<OL><P><LI>On the Tools menu, click Security.

<P><LI>Click User and Group Accounts.

<P><LI>Click the Change Logon Password tab.

<P><LI>Enter a new password using the Old Password, New Password, and Verify
   boxes, and then click OK.
<P>
</OL><h3>Workaround 2</h3>
 
<P>
After you use the NewPassword method, you can restart Microsoft Access,
which allows you to log on using the new password. Because you have logged
on again, you do not receive the error message. To do so, follow these
steps:

<OL><P><LI>Exit Microsoft Access and restart the program.

<P><LI>In the logon box, enter your new password and click OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
7.0. We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and log in as Admin (or another user with
   Administer permissions).

<P><LI>On the Tools menu, click Security, and then click User and Group
   Accounts. Create a new user, and let this user be a member of the
   Admins group.

<P><LI>Create the following new form:
<P>
<P><PRE>      Form: ChangePassword
      -----------------------
      Caption: ChangePassword
</PRE><P>
<P><PRE>      Textbox:
<PRE></PRE>         Name: OldPwd
         ControlSource:

      Textbox:
         Name: NewPwd
         ControlSource:

      Change the captions of the corresponding labels of the text boxes to
      "Old" and "New" (without the quotation marks).

      Command button:
         Name: Button0
         Caption: My Button
         OnClick: [Event Procedure]

      Set the Onclick property to the following [Event Procedure]

         Private Sub Command0_Click()
            Dim ws as Workspace
            Set ws = DBEngine.Workspaces(0)
            ws.Users(CurrentUser()).NewPassword [OldPwd], [NewPwd]
            ws.Close
         End Sub

</PRE><P><LI>Close and save the form.

<P><LI>Quit Microsoft Access.

<P><LI>Restart Microsoft Access and log in as the new user.

<P><LI>Open the ChangePassword form.

<P><LI>Enter the following into the text boxes:
<P>
<P><PRE>      Old: ""  (with no spaces between the quotation marks)
      New: abc
</PRE>
<P><LI>Click the command button to update the password.

<P><LI>Close the ChangePassword form.

<P><LI>Open the Categories form. Note that the error message "Not a valid
<P><PRE>    account name or password" appears, and you are unable to open the form.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 7.0, Chapter 14,
"Securing and Delivering Your Application", pages 328-339.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage ScrtUsr<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
