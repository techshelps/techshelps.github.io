

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Second OpenRecordset Fails with Run-Time Error 3008 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172617">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1997/08/12">
<META NAME="Keywords" CONTENT="MdlDao MdlRcd">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use the OpenRecordset method in a Visual Basic for Applications procedure, you may receive the following message:     Run-time error '3008':    The table '         ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QBWS,QDKY,QBXS,QAB4,QBJZ,QAH4,QAJQ,QAAP,QAKJ,QBS0,QABT,QAX6,QAGB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Second OpenRecordset Fails with Run-Time Error 3008</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172617</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use the OpenRecordset method in a Visual Basic for Applications
procedure, you may receive the following message:
<P>
<PRE>   Run-time error '3008':
   The table '&lt;tablename&gt;' is already opened exclusively by another user,
   or it is already open through the user interface and cannot be
   manipulated programmatically.

</PRE>If you are using Microsoft Access version 7.0, you may receive the
following message:
<P>
<PRE>   Run-time error '3008':
   Table '&lt;tablename&gt;' is exclusively locked.

</PRE>This error occurs the second time you use the OpenRecordset method in your
procedure. The first line in which you use the OpenRecordset method to open
a recordset based on the same table does not generate an error.
<P>
<P><h2>CAUSE</h2>
 
<P>
A snapshot-type recordset based on the same underlying table is already
open. You may have opened this recordset by opening a form whose Recordset
Type property is set to Snapshot, or by using the OpenRecordset method in a
Visual Basic for Applications procedure and designating the type with the
constant dbOpenSnapshot.
<P>
The Microsoft Jet database engine places a shared table-read lock on the
underlying table when you open a snapshot-type recordset. This lock
persists until you close the recordset in code or close the form. If the
recordset is still open and your code uses OpenRecordset with the constant
dbDenyWrite to open another recordset based on the same table, the lock on
the table is upgraded from a shared table-read lock to a more restrictive
exclusive deny-write lock. Even if you then close the second recordset and
use the Idle method with the constant dbFreeLocks, the exclusive deny-write
lock on the table remains in effect; the Jet database engine upgrades locks
to be more restrictive but does not downgrade them to be less restrictive.
Therefore, you receive the error message described in the "Symptoms"
section when you open another recordset based on that table.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Select the Customers form.

<P><LI>On the Edit menu, click Copy.

<P><LI>One the Edit menu, click Paste; in the Paste As dialog box, type
    "frmCustRecords" (without the quotation marks) in the Form Name box.

<P><LI>Open frmCustRecords in Design View.

<P><LI>On the View menu, click Properties, and then click the Data tab.

<P><LI>Change the Recordset Type to Snapshot and close the property sheet.

<P><LI>Add a command button to the form and set its Name and Caption
    properties to "LockTest" (without the quotation marks).

<P><LI>Set the OnClick property of the command button to the following event
    procedure:
<P>
       Private Sub LockTest_Click()
<PRE>          Dim db As Database
          Dim rs As Recordset
          Set db = CurrentDb
          Set rs = db.OpenRecordset("Customers", dbOpenTable, dbDenyWrite)
          rs.Close
          db.Close
          Set db = Nothing
          Set rs = Nothing
          DBEngine.Idle dbFreeLocks
          Set db = CurrentDb
          Set rs = db.OpenRecordset("Customers", dbOpenTable, dbDenyWrite)
          rs.Close
          db.Close
          Set db = Nothing
          Set rs = Nothing
          DBEngine.Idle dbFreeLocks
       End Sub

</PRE><P><LI>Close and save the form.

<P><LI>Open frmCustRecords and click LockTest. Note that you receive one of
    the errors described in the "Symptoms" section.

<P><LI>Click Debug. Note that the code fails on the line which uses the
    OpenRecordset method for the second time. The previous instance of the
    same line of code did not generate the error.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Microsoft Jet database engine locks, refer
to the "Microsoft Jet Database Engine Programmer's Guide", pages 193 - 215.
<P>
For more information about the constants that you can use with the
OpenRecordset method, search the Help Index for "OpenRecordset method."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MS Jet<BR>
Keywords          : MdlDao MdlRcd<BR>
Component         : jet<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
