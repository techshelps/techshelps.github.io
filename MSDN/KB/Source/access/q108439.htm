

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: "ORA-00904: Invalid Column Name" Error Message in Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108439">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1993/12/12">
<META NAME="Keywords" CONTENT="kberrmsg kbinterop OdbcOracl">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  If you have a query based on an attached Oracle synonym that has a sort on a column name, and the owner of the synonym has read-only permissions on the table on which the synonym is based, you will receive the error messages:     ODBC - call failed...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QA94,QA2O,QAPN,QABA,QA1S,QAGU,QBWS,QAN0,QAH5,QAEF,QAAP,QDN9,QA39,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "ORA-00904: Invalid Column Name" Error Message in Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108439</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you have a query based on an attached Oracle synonym that has a sort on
a column name, and the owner of the synonym has read-only permissions on
the table on which the synonym is based, you will receive the error
messages:
<P>
<PRE>   ODBC - call failed

   -and-

   [PageAhead][ODBC Oracle Driver][Oracle OCI]ORA-00904: invalid
   column name. [#904]

</PRE><h2>CAUSE</h2>
 
<P>
This error occurs because the owner of the synonym has read-only
permissions on the Oracle table on which the synonym is based.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are four ways to correct this problem:

<UL><LI>Create a Public synonym in Oracle.

<LI>In Microsoft Access, attach directly to the table on which the
   synonym is based.

<LI>In Oracle, assign the owner of the synonym permissions greater
   than read-only.

<LI>In Microsoft Access, remove the "order by" clause from the
   query.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The following is an example of an SQL statement that will cause this
error:
<P>
<PRE>   SELECT * FROM &lt;owner&gt;.&lt;synonym_name&gt;
      ORDER BY &lt;owner&gt;.&lt;synonym_name&gt;.&lt;column_name&gt;

</PRE>Note that the same errors will occur if this command is issued in SQL*DBA
or SQL*PLUS, which are Oracle's interface tools. If you remove the ORDER BY
clause, the statement will run. The statement will run with the ORDER BY
clause if you remove the &lt;owner&gt;. clause instead. The statement will run
with all the clauses included if you increase the owner's permissions on
the table on which the query is based.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Oracle, create a table. Assign all permissions on the table to user
   A, and read-only permissions to user B.

<P><LI>Log into Oracle as user A. Create synonym A based on the new table.

<P><LI>Log into Oracle as user B. Create synonym B based on the new table.

<P><LI>Start Microsoft Access. Attach synonym A with user A's login account.
   Create a query based on synonym A with a sort on one of the columns.

<P><LI>Run the query. Note that the query runs correctly.

<P><LI>Attach synonym B with user B's login account. Create a query based on
   synonym B with a sort on one of the columns.

<P><LI>Run the query. The error messages stated above will occur.
<P>
</OL>NOTE: You can reproduce this behavior in Oracle's SQL*DBA as well. To do
so, connect as user A and issue the following command:
<P>
<PRE>  SELECT * FROM userA.synonymA ORDER BY userA.synonymA.column1;

</PRE></OL>Note that the command runs correctly. Next, connect as user B and issue the
following command:
<P>
<PRE>  SELECT * FROM userB.synonymB ORDER BY userB.synonymB.column1;

</PRE>An error message will occur.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: adk<BR>
Keywords            : kberrmsg kbinterop OdbcOracl<BR>
Version             : 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
