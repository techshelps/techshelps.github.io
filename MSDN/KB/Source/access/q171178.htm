

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC97: Wrong Sort Order in Large, Linked SQL Server Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171178">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1997/07/09">
<META NAME="Keywords" CONTENT="kbinterop OdbcSqlms">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Records from a linked SQL Server table are sorted incorrectly in Microsoft Access datasheets and forms if the following conditions are true:   - A Microsoft Access user opens a l...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QABM,QBPM,QDN9,QDMH,QACF,QAEF,QAKC,QBC6,QAU3,QAUD,QAMR,QAFH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Wrong Sort Order in Large, Linked SQL Server Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171178</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft SQL Server, versions 6.0, 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Records from a linked SQL Server table are sorted incorrectly in
Microsoft Access datasheets and forms if the following conditions are
true:

<UL><LI>A Microsoft Access user opens a long-running query or a form based on
   a long-running query.

<LI>The query returns records ordered by one or more columns.

<LI>The Microsoft Access user and/or other users delete records to which
   the query conditions apply.

<LI>The records are deleted before the keyset of the query is completely
   built (the total number of records in the keyset is not yet displayed
   at the bottom of the query window).
<P>
</UL><h2>CAUSE</h2>
 
<P>
This behavior is caused by a timing issue between SQL Server and Microsoft
Access.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Although some of the records will appear out of sort order in the keyset,
they are sorted correctly on the server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following procedure requires that you to have access to a SQL Server
database containing over 100,000 records.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open a new database in Microsoft Access 97.

<P><LI>Link to a SQL Server table that contains at least 100,000 records.

<P><LI>Create a query based on the linked table and apply criteria that will
   reduce the recordset to approximately 25,000 records. Set the sort to
   Ascending for four of the columns in the query.

<P><LI>Run the query.
<P>
   NOTE: It is important that the query runs for a long time before all
   the records are returned.

<P><LI>While the query is still processing records, use the record number at
   the bottom of the query window to jump to record number 8040.
<P>
   NOTE: At this point the complete number of records being returned is
   not yet displayed. Background processing is still fetching records.

<P><LI>Start deleting records, a few at a time.

<P><LI>Scroll down a few times (usually 6 or 7 times) using the scroll bar of
   the query datasheet window.
<P>
   Within the records you will notice that some of the records are now out
   of order.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbinterop OdbcSqlms<BR>
Version             : 97<BR>
Platform            : NT WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
