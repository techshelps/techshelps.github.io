

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Delete Queries Cause Size of Replicated Database to Grow </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182464">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1998/03/13">
<META NAME="Keywords" CONTENT="RplGen">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run multiple delete queries in a replicated Microsoft Access database, the size of the database may increase significantly. Compacting the database does not reduce its s...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAFO,QA5V,QBJZ,QBXS,QAZV,QDN9,QAPN,QAGU,QDKY,QAH5,QBWS,QBCT,QALY,QAGC P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Delete Queries Cause Size of Replicated Database to Grow</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182464</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Office 97 Developer Edition
<LI>Microsoft Access Developer's Toolkit, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run multiple delete queries in a replicated Microsoft Access
database, the size of the database may increase significantly. Compacting
the database does not reduce its size.
<P>
<P><h2>CAUSE</h2>
 
<P>
Whenever you delete a record in a replicated Microsoft Access database, a
corresponding record is created in the MSysTombstone system table.
MSysTombstone is a read-only system table in which the Microsoft Jet
Database engine stores information about deleted records. This information
remains in the MSysTombstone table until the retention period has expired
and the database is compacted. If you use the Microsoft Access user
interface to replicate a database, the retention period of the resulting
replica set is set to 1000 days. However, if you use Microsoft Replication
Manager to replicate a database, the default retention period is 60 days.
<P>
NOTE: Microsoft Replication Manager is installed with the Microsoft Office
97 Developer Edition or with the Microsoft Access Developer's Toolkit
version 7.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You cannot prevent Microsoft Access from storing a reference to a deleted
record in the MSysTombstone table. However, you can reduce the number of
days that a reference to a deleted record remains in the MSysTombstone
table. To accomplish this, use Microsoft Replication Manager to reduce the
value of the KeepDesignChangeHistory property of the managed replica set.
<P>
NOTE: When you use Microsoft Replication Manager to reduce the length of
the retention period, it is important that you remember to synchronize each
database in the replica set before the retention period expires. The
KeepDesignChangeHistory property affects how long a record of design
changes is retained. If the retention period expires before a particular
database has been fully synchronized, you will be unable to synchronize
that replica, and it will no longer be a part of the replica set.
<P>
Follow these steps to reduce the length of the retention period of a
replica set:

<OL><P><LI>Start Microsoft Replication Manager.

<P><LI>On the File Menu, click Managed Replicas.

<P><LI>In the Managed Replicas dialog box, click to select the desired replica
   set, and click Open.
<P>
   NOTE: Before you can update the KeepDesignChangeHistory property,
   you must first ensure that you are managing the Design Master of your
   replica set. If your Design Master does not appear in the list, click
   Manage New in the Managed Replicas dialog box.
<P>
   NOTE: If you are using Microsoft Replication Manager version 3.0, which
   is installed with the Microsoft Access Developer's Toolkit version 7.0,
   you must first select the managed folder from the Folders drop-down
   combo box on the toolbar, and then select the Design Master from the
   Replicas drop-down combo box on the toolbar.

<P><LI>On the View menu, click Properties.
<P>
   NOTE: If you are using Microsoft Replication Manager version 3.0, which
   is installed with the Microsoft Access Developer's Toolkit version 7.0,
   click Replica Properties on the View menu.

<P><LI>In the Properties dialog box, click the Replica Set tab.

<P><LI>Reduce the number of days in the Keep Design Change History box to a
   value smaller than 1000.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about replica properties, search the Microsoft
Replication Manager Help Index for "replicas, properties" and then display
the topic "Viewing and Setting Replica Properties."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prb bloat large<BR>
Keywords          : RplGen<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
