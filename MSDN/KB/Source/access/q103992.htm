

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Cannot Add Security Items to Custom Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103992">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/09/02">
<META NAME="Keywords" CONTENT="kbusage McrOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  If you add a security command to a custom menu with a DoMenuItem action, the security command will be unavailable.  CAUSE =====  You can only perform DoMenuItem actions with...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAD,QAF0,QAPN,QAWK,QAK7,QAZV,QAUJ,QA1S,QAVY,QAH4,QBXJ,QBWR,QDN9,QANS,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Cannot Add Security Items to Custom Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103992</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
If you add a security command to a custom menu with a DoMenuItem action,
the security command will be unavailable.
<P>
<P><h2>CAUSE</h2>
 
<P>
You can only perform DoMenuItem actions with commands available from the
current context. If you have a form open, you can only perform menu items
available to a form. Since security items are available only from the
Database window, they will not work when invoked from a form.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can add the security command Change Password to a custom menu using
the following sample macro:
<P>
<PRE>   Macro Name         Action        Defined Below
   ----------------------------------------------
   Change Password    Echo               1
                      SelectObject       2
                      DoMenuItem         3
                      DoMenuItem         4
                      SelectObject       5

   Change Password Actions
   ---------------------------------------------------------
   1. Echo
         Echo On: No
   2. SelectObject
         Object Type: Form
         Object Name: &lt;name of the form that the menu is on&gt;
         In Database window: Yes
   3. DoMenuItem
         Menu Bar: Database
         Menu Name: Security
         Command: Change Password
   4. DoMenuItem
         Menu Bar: Database
         Menu Name: Window
         Command: Hide
   5. SelectObject
         Object Type: Form
         Object Name: &lt;name of the form that the menu is on&gt;
         In Database window: No

</PRE>NOTE: Actions 1 and 5 are used if you need to have the Database window
hidden while using the retail version of Microsoft Access. The Echo
action in step 1 ensures that the Database window is not visible when it
is activated in step 2. Step 4 hides the Database window again. If you
are using the Microsoft Access Distribution Kit (ADK), steps 1 and 5 can
be omitted since the Database window is always hidden.
<P>
The only side effect to this workaround is that when the Change Password
dialog box appears, you will see the Database window menu items in the
background. However, you will not be able to choose them.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create the following macro and save it as Security Menu:
<P>
<PRE>      Action      Defined Below
      -------------------------
      AddMenu          1

      Security Menu Actions
      ---------------------------------------------
      1. AddMenu
            Menu Name: Security Menu
            Menu Macro Name: Security Menu Password
            Status Bar Text: Change Password

</PRE><P><LI>Create the following macro and save it as Security Menu Password:
<P>
<PRE>      Macro Name        Action     Defined Below
      ------------------------------------------
      Change Password   DoMenuItem       1

      Security Menu Password Actions
      ------------------------------
      1. DoMenuItem
            Menu Bar: Database
            Menu Name: Security
            Command: Change Password

</PRE><P><LI>Create a form and set the OnMenu property to Security Menu.

<P><LI>View the form in Form view and note that Change Password is
   unavailable on the Security menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage McrOthr<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
