

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC2: Error When Trying to Enforce Referential Integrity </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113494">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1994/04/06">
<META NAME="Keywords" CONTENT="kbusage TblOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  When you create a relationship in the Relationships window by dragging a field from one table to another, you get the following error message when you select  Enforce Refer...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QBXS,QBWS,QAY2,QA7O,QA7N,QAA1,QA28,QATJ,QAB4,QAG2,QA1S,QDI2,QA9N,QAYV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Error When Trying to Enforce Referential Integrity</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113494</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
When you create a relationship in the Relationships window by dragging a
field from one table to another, you get the following error message when
you select "Enforce Referential Integrity" and choose the Create button:
<P>
<PRE>   Can't create relationship to enforce referential integrity. The
   field(s) in the primary table must be the primary key or have a unique
   index.

</PRE><h2>CAUSE</h2>
 
<P>
You must drag the joining field from the "one" side to the "many" side in
order to enforce referential integrity." The field on the "one" side must
also be the primary key field in that table, or have a unique index. If you
are dragging the joining field from the "one" side to the "many" side and
still get this error, another possible cause might be the way your indexes
are set up.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To set up your indexes correctly, open the "one-side" table in Design view
and set a primary key, or create a unique index, for the field you want to
use. Then, create the relationship between the tables.
<P>
The following example uses the sample database NWIND.MDB to demonstrate a
relationship with referential integrity enforced:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>From the Edit menu, choose Relationships.

<P><LI>From the Edit menu, choose Clear Layout. When you are prompted
   to continue, choose OK.

<P><LI>From the Relationships menu, choose Add Table.

<P><LI>Double click the Products table and the Order Details table. Choose
   Close.

<P><LI>If there is already a relationship line drawn between the Products
   table and the Order Details table, select it and press DEL
   to remove it. When you are prompted to continue, choose OK.

<P><LI>Drag the Product ID field from the Products table onto the Product
   ID field in the Order Details table.

<P><LI>In the Relationships dialog box, select the "Enforce Referential
   Integrity" check box, and then choose Create.
<P>
   This will create a one-to-many relationship between the Products table
   and the Order Details table.

<P><LI>Close the Relationships window. Do not save your changes.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>From the Edit menu, choose Relationships.

<P><LI>From the Edit menu, choose Clear Layout. When you are prompted
   to continue, choose OK.

<P><LI>From the Relationships menu, choose Add Table.

<P><LI>Double click the Products table and the Order Details table. Choose
   Close.

<P><LI>If there is already a relationship line drawn between the Products
   table and the Order Details table, select it and press DEL
   to remove it. When you are prompted to continue, choose OK.

<P><LI>Drag the Product ID field from the Order Details table onto the Product
   ID field in the Product table.

<P><LI>In the Relationships dialog box, select the "Enforce Referential
   Integrity" check box, and then choose Create.
<P>
   This will cause the error message to pop up. You must drag the field
   from the "one" side (the Products table) to the "many" side (the Order
   Details table) in order to enforce referential integrity.

<P><LI>Close the Relationships window. Do not save your changes.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information about setting up relationships, search for
"Relationships" using the Microsoft Access Help menu.
<P>
Microsoft Access "User's Guide," version 2.0, Chapter 2, "Designing a
Database (Determining the Relationships)"
<P>
Microsoft Access "User's Guide," version 2.0, Chapter 7, "Table Basics"
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage TblOthr<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
