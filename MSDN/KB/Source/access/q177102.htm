

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Append Query Causes Divide Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177102">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/11/20">
<META NAME="Keywords" CONTENT="QryAppnd">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run an append query, you may receive one of the following error messages:  Microsoft Windows 95     This program has performed an illegal operation and will be shut down...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QA7N,QAUR,QA1S,QAVX,QAVW,QAB4,QDN9,QACF,QBWS,QA4H,QAAP,QARR,QBXS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Append Query Causes Divide Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177102</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run an append query, you may receive one of the following error
messages:
<P>
<P><h3>Microsoft Windows 95</h3>
 
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you are using Microsoft Access 7.0, you receive the following message
when you click Details:
<P>
<PRE>   MSACCESS caused a divide error in module MSJT3032.DLL

</PRE>If you are using Microsoft Access 97, you receive the following message
when you click Details:
<P>
<PRE>   MSACCESS caused a divide error in module MSJET35.DLL

</PRE><h3>Microsoft Windows NT</h3>
 
<P>
<PRE>   An application error has occurred
   and an application error log is being generated.

   MSACCESS.exe
   Exception: divide by zero

</PRE><h2>CAUSE</h2>
 
<P>
The append query contains a join to a field in another query whose
UniqueValues property is set to Yes. For example, the append query may be
based on a table that is joined to a select query whose UniqueValues
property is set to Yes in order to limit the data that is appended.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
When creating an append query, do not use a join to a query whose
UniqueValues property is set to Yes. Set the UniqueValues property of the
select query to No, and then set the UniqueValues property of the append
query to Yes. Instead of using a select query, you may also want to
consider using the source table of the select query, and then setting the
UniqueValues property of the append query to Yes.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft Access
versions 7.0 and 97. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
<P><h3>Create the Tables</h3>
 

<OL><P><LI>Create a new database in Microsoft Access.

<P><LI>Create the following table and save it as tblDivideError1:
<P>
<P><PRE>      Table: tblDivideError1
      ---------------------------
      Field Name: ID
<PRE></PRE>         Data Type: Number
         Field Size: Long Integer
      Field Name: TextName
         Data Type: Text
         Field Size: 50

      Table Properties: tblDivideError1
      ---------------------------------
      PrimaryKey: ID

   Close and save the table.

</PRE><P><LI>Create a copy of the tblDivideError1 table. To create a copy of the
   tblDivideError1 table, select it in the Database window; press CTRL+C,
   and then press CTRL+V. In the Paste Table As dialog box, type
   tblDivideError2 in the Table Name box, and then click OK.

<P><LI>Open the tblDivideError1 table and add the following data:
<P>
<PRE>      ID     TextName
      --     --------
      1      Test
      2      Test
      3      Test
      4      Test
      5      Test

</PRE><P><LI>Create the following table and save it as tblDivideError3:
<P>
<P><PRE>      Table: tblDivideError3
      ---------------------------
      Field Name: ID
<PRE></PRE>         Data Type: Number
         Field Size: Long Integer
      Field Name: AltID
         Data Type: Number
         Field Size: Long Integer

      Table Properties: tblDivideError3
      ---------------------------------
      PrimaryKey: ID

   Close and save the table.

</PRE><P><LI>Open the tblDivideError3 table and add the following data:
<P>
<PRE>      ID     AltID
      --     -----
      1      2
      2      3
      3      5
      4      5

</PRE></OL><h3>Create the Queries</h3>
 

<OL><P><LI>Create a new query based on the tblDivideError3 table and save it as
   qryDivide1:
<P>
<P><PRE>      Query: qryDivide1
      -------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: AltID
<PRE></PRE>         Table: tblDivideError3

      Query Properties
      ------------------
      Unique Values: Yes

</PRE><P><LI>Create a new query and add both the tblDivideError1 table and qryDivide1
   query. Save it as qryDivideAppend:
<P>
<P><PRE>      Query: qryDivideAppend
      ---------------------------------------------
      Type: Append Query
      Join: tblDivideError1.ID &lt;-&gt; qryDivide1.AltID
</PRE><P>
<P><PRE>      Field: ID
<PRE></PRE>         Table: tblDivideError1
      Field: Name
         Table: qryDivide1

      Query Properties
      ----------------------------------
      Destination Table: tblDivideError2

</PRE><P><LI>Run qryDivideAppend. Note that you receive the error described in the
   "Symptoms" section.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the UniqueValues property, search the Help Index
for "UniqueValues property."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: crash fail<BR>
Keywords          : QryAppnd<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
