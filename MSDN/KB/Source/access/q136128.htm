

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Introduction to .ldb Files (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136128">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1995/08/31">
<META NAME="Keywords" CONTENT="GnlMu kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The .ldb file plays an important role in the multiuser scheme of the Microsoft Jet database engine versions 3.0 and 3.5. The .ldb file is used to determine which records are lock...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAZV,QAGU,QDKY,QAUJ,QAK7,QA5V,QA3A,QAFI,QABT,QALQ,QAJQ,QAEF,QBVV,QAGB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Introduction to .ldb Files (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136128</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The .ldb file plays an important role in the multiuser scheme of the
Microsoft Jet database engine versions 3.0 and 3.5. The .ldb file is
used to determine which records are locked in a shared database and by
whom.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Automatic .ldb File Creation and Deletion</h3>
 
<P>
For every database opened for shared use, an .ldb file is created to store
computer and security names and to place extended byte range locks. The
.ldb file always has the same name and is located in the same folder as the
opened database (.mdb). For example, if you open (for shared use) the
Northwind.mdb sample database in the c:\Msoffice\Access folder, then a file
called Northwind.ldb is automatically created in the same folder.
<P>
Whenever the last user closes a shared database, the .ldb file is deleted.
The only exception is if a user does not have delete rights or when the
database is marked as corrupted; then, the .ldb file is not deleted because
it contains information about who was using the database at the time the
database was marked as corrupted.
<P>
<P><h3>Required Folder Privileges</h3>
 
<P>
If you plan to share a database, the .mdb file should be located in a
folder where users have read, write, create, and delete privileges. Even if
you want users to have different file privileges (for example, some read-
only and some read-write), all users sharing a database must have read,
write, and create permissions to the folder. You can, however, assign read-
only permissions to the .mdb file for individual users while still allowing
full permissions to the folder.
<P>
NOTE: If a user opens a database with exclusive access (by selecting the
Exclusive check box in the Open dialog box), record locking is not used;
therefore, Microsoft Access does not attempt to open or create an .ldb
file. If the database is always opened for exclusive use, a user needs only
read and write privileges to the folder.
<P>
<P><h3>The .ldb File Contents</h3>
 
<P>
For each person who opens a shared database, the Jet database engine writes
an entry in the database's .ldb file. The size of each .ldb entry is 64
bytes. The first 32 bytes contains the computer name (such as JohnDoe). The
second 32 bytes contains the security name (such as Admin). The maximum
number of concurrent users that the Jet database engine supports is 255;
therefore, the .ldb file size is never larger than 16 kilobytes.
<P>
When a user closes a shared database, the user's entry is not removed from
the .ldb file. However, it may be overwritten when another user opens the
database. This means, you cannot use the .ldb file alone to determine who
is currently using the database.
<P>
<P><h3>The .ldb File Usage</h3>
 
<P>
The Jet database engine uses .ldb file information to prevent users from
writing data to pages that other users have locked and to determine who has
other pages locked. If the Jet database engine detects a lock conflict with
another user, it reads the .ldb file to get the computer and security name
of the user who has the file or record locked.
<P>
In most lock conflict situations, you receive a generic "Write conflict"
error message that allows you to save the record, copy it to the Clipboard,
or drop the changes you made. In some circumstances, however, you receive
the following error message:
<P>
<PRE>      Couldn't lock table &lt;table name&gt;; currently in use by user
      &lt;security name&gt; on computer &lt;computer name&gt;.

</PRE>NOTE: The state of the information in the .ldb file has no bearing on the
state of the database. If an .ldb file becomes corrupted, everything in the
database should still work correctly. However, you may see garbled text
instead of user names in any lock conflict messages.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more detailed information about the .ldb file and extended byte
range locks, please see the Jet Locking white paper. For details about how
to obtain this white paper, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../URJump.htm">Q148583</A></B>
   TITLE     : ACC95: Understanding Jet Locking Paper &amp; LDBview Available
               on MSL
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : GnlMu kbusage<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
