

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC1x: "Database Already in Use" Error After Running Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109353">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1994/01/02">
<META NAME="Keywords" CONTENT="kbusage QryOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  You receive the error message  Couldn't use '               '; database already in use  when you close a database after running a query containing a subquery or crosstab query based on an empty table or another query.  You must quit Microsoft Acces...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QA1S,QBWS,QA7O,QA7N,QDN9,QA5V,QAB4,QAY2,QAGB,QACF,QATX,QAMB,QABI,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: "Database Already in Use" Error After Running Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109353</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You receive the error message "Couldn't use '&lt;database name&gt;'; database
already in use" when you close a database after running a query containing
a subquery or crosstab query based on an empty table or another query.
<P>
You must quit Microsoft Access and restart it in order to restore proper
operation. In some cases, the database may become corrupted, and may result
in a database that remains corrupted even after you run the Repair Database
command and receive notification that the database was repaired
successfully.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, add some records to the empty underlying
table. Or, you can use a DLookUp() function to make sure all referenced
tables contain records before running the query.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
1.0 and 1.1. This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If a parameter query is the subquery for a query, and you do not enter
anything in the parameter box, the subquery will return an empty set, and
will cause the error stated above.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Access and either create a new database or open one
    of your choosing.

<P><LI>Create a new table called Table1 with the following structure:
<P>
<PRE>      Field   Type
      --------------------
      f1      text
      f2      text
      f3      text
      z1      long integer

</PRE><P><LI>Create another new table called Table2 with the following
    structure:
<P>
<PRE>       Field   Type
       --------------------
       f4      text
       f5      text
       z2      long integer

</PRE><P><LI>Create a new query called Query1 based on Table1.

<P><LI>Click the Totals button.

<P><LI>Drag all fields from Table1 to the query grid.

<P><LI>Choose Group By in the Total row for all fields. The SQL
    statement (choose SQL from the View menu) should look like:
<P>
       SELECT DISTINCTROW Table1.f1, Table1.f2, Table1.f3, Table1.z1
       FROM Table1
       GROUP BY Table1.f1, Table1.f2, Table1.f3, Table1.z1
       WITH OWNERACCESS OPTION;

<P><LI>Create a second query called Query2. Add Query1 and Table2 to the
    new query.

<P><LI>Place a join line between field z1 in Query1 and field z2 in
    Table2.

<P><LI>Drag the f1 and f2 fields from Query1 to the query grid. The
    SQL statement should look like:
<P>
       SELECT  DISTINCTROW Query1.f1, Query1.f2
       FROM Query1, Table2,
       Query1 INNER JOIN Table2 ON Query1.z1 = Table2.z2
       WITH OWNERACCESS OPTION;

<P><LI>Do not enter any data. Instead, open Query2 and close the database
    from the Control menu of the Database window.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Queries<BR>
Keywords            : kbusage QryOthr<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
