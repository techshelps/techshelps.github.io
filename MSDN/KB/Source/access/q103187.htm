

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: Cannot Open a Database with a DoMenuItem Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103187">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/08/18">
<META NAME="Keywords" CONTENT="kbusage McrArg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you try to open another database with a macro containing DoMenuItem and Sendkeys actions, the macro does not seem to run.  CAUSE =====  Microsoft Access cannot open another ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAZV,QAPN,QBWS,QA1S,QAY2,QAUJ,QDKY,QDN9,QAUR,QBVV,QBDM,QASR,QAGB,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Cannot Open a Database with a DoMenuItem Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103187</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you try to open another database with a macro containing DoMenuItem
and Sendkeys actions, the macro does not seem to run.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Access cannot open another database while the DoMenuItem action
is running in the current database. Microsoft Access does not support
opening multiple databases.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, use either of the following methods. The
first method runs a macro from the Database window. The second method runs
a macro from a button on a form.
<P>
<P><h3>Method 1: Running a Macro from the Database Window</h3>
 
<P>
To run a macro from the Database window, follow these steps:

<OL><P><LI>Create a database and create the following macro:
<P>
<PRE>      Macro Name      Action
      ------------------------
      OpenMDB         SendKeys

      OpenMDB Actions
      ---------------------------------
      SendKeys
         Keystrokes: %fo&lt;YOURFILE&gt;.MDB~
         Wait: No

</PRE><P><LI>Close and save the macro as OpenMDB.

<P><LI>In the Database window, select the OpenMDB macro, and then click the Run
   button. Note that the macro closes the current database and opens the
   database you specify in the OpenMDB macro.
<P>
</OL><h3>Method 2: Running a Macro from a Form</h3>
 
<P>
To run a macro from a form, follow these steps:

<OL><P><LI>Create a database and create the following macro:
<P>
<PRE>      Macro Name       Action
      -----------------------------
      OpenMDB2         SelectObject
                       SendKeys

      OpenMDB2 Actions
      ---------------------------------
      SelectObject
         Object Type: Macro
         Object Name: OpenMDB2
         In Database Window: Yes
      SendKeys
         Keystrokes: %fo&lt;YOURFILE&gt;.MDB~
         Wait: No

</PRE><P><LI>Create a blank form and save it as OpenMDBTest.

<P><LI>Add a command button to the form and set the following properties for
   the control:
<P>
<P><PRE>      Name: Button1
      Caption: Open Database
</PRE>
<P><LI>Set the button's OnClick property to the OpenMDB2 macro.
<P>
   NOTE: The OnClick property is called the OnPush property in version 1.x.

<P><LI>Switch the OpenMDBTest form to Form view.

<P><LI>Click the command button to close the current database and open
   another database.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new database.

<P><LI>Create the following macro:
<P>
<PRE>      Macro Name   Action
      -----------------------
      OpenMe       SendKeys
                   DoMenuItem

      OpenMe Actions
      ---------------------------------------------------------
      SendKeys
         NORTHWIND.MDB~  (or NWIND.MDB in versions 1.x and 2.0)
      DoMenuItem
         Menubar: Database
         Menu Name: File
         Command: Open database

</PRE><P><LI>Run the macro. Note that it does not open the Northwind.mdb database.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: opendb<BR>
Keywords            : kbusage McrArg<BR>
Version             : 1.0 1.1 2.0 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
