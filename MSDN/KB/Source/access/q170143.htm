

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACC: ItemData Property Returns Value from Previous Row </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170143">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1997/06/16">
<META NAME="Keywords" CONTENT="FmsCmbo kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The ItemData property of a combo box or list box does not return the value from the row that you specified in the rowindex argument; instead, it returns the value from the previo...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QBV4,QA5V,QBT6,QBVR,QAHP,QAUD,QDN9,QBS0,QA28,QATJ,QA5F,QAMA,QBXS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: ItemData Property Returns Value from Previous Row</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170143</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The ItemData property of a combo box or list box does not return the value
from the row that you specified in the rowindex argument; instead, it
returns the value from the previous row.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The ColumnHeads property for the combo box or list box is set to Yes.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use a condition to check the ColumnHeads property. If it is set to Yes, add
1 to the row index. The following example demonstrates how to add 1 to the
row index if the ColumnHeads property is set to Yes and then to pass it to
the ItemData property:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Orders form in Design view.

<P><LI>Set the ColumnHeads property of the CustomerID combo box to Yes.

<P><LI>Add a textbox to the form with the following properties:
<P>
<P><PRE>      Form: Orders
      -------------------------------------------
      Text Box:
      Name: ItemDataTest
      ControlSource: =MyItemData("CustomerID", 0)
</PRE>
<P><LI>On the View menu, click Code to view the form's module.

<P><LI>Type the following procedure:
<P>
<P><PRE>      Function MyItemData(ctlName As String, RowIndex As Long)
<PRE></PRE>         On Error Resume Next
         If Me(ctlName).ColumnHeads Then RowIndex = RowIndex + 1
         MyItemData = Me(ctlName).ItemData(RowIndex)
      End Function

</PRE><P><LI>Open the form in Form view. Note that the ItemDataTest text box
   contains the value "ALFKI", which is the first data item in the
   CustomerID combo box.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ItemData property returns the data in the bound column of the specified
row in a combo box or list box. Rows in combo and list boxes are indexed
starting with zero. For example, to return the item in the sixth row of a
combo box, you would specify 5 for the ItemData property's row index. If
the ColumnHeads property for a combo box or list box is set to Yes, the
column name is displayed as the first item in the list. Microsoft Access
treats this row as the first data item instead of the first row in the
control's row source.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Orders form in Design view.

<P><LI>Set the ColumnHeads property of the CustomerID combo box to Yes.

<P><LI>Add a textbox to the form with the following properties:
<P>
<P><PRE>      Form: Orders
      -----------------------------------------
      Text Box:
      Name: ItemDataTest
      ControlSource: =[CustomerID].[ItemData](0)
</PRE>
<P><LI>Open the form in Form view. Note that the value of the ItemDataTest text
   box is "Customer ID" instead of the CustomerID "ALFKI" in the first row
   of the row source.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the ItemData property, search the Help Index for
"ItemData property."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsCmbo kbusage<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
