

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Direct Connected Network Printers Using DLC, IPX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115757">
<META NAME="KBModify" CONTENT="1995/09/18">
<META NAME="KBCreate" CONTENT="1994/06/02">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT=" Windows NT as a base system does not support printing directly to a printer with an option card, which connects the printer directly into the network using a protocol in the card. The most common protocols used are IPX and DLC.  The process that the...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAA1,QAH6,QDI2,QAD7,QBWP,QAYY,QAI5,QBWB,QAVZ,QACT,QBV8,QBXE,QA05,QAZB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Direct Connected Network Printers Using DLC, IPX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115757</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Device Development Kit (DDK) for Windows NT,
   versions 3.1, 3.5, and 3.51
</UL> 
<P>
Windows NT as a base system does not support printing directly to
a printer with an option card, which connects the printer directly into
the network using a protocol in the card. The most common protocols used
are IPX and DLC.
<P>
The process that the printer goes through to print is as follows:

<OL><P><LI>The application begins to generate output for the targeted spooled
   printer.

<P><LI>The spooler subsystem passes the data to the local print provider. If
   any other print providers are installed (such as through the network
   control panel under the Networks option), the data is passed to the
   additional print providers.

<P><LI>The data is passed to the appropriate print processor.

<P><LI>The print processor handles the data to determine what, if anything,
   must be done to the data to make it printable.

<P><LI>After processing, the data returns back to the print provider.

<P><LI>At this time, the print data is sent to the appropriate print monitor.
<P>
</OL>The key to providing support for direct connected printers is a custom
print monitor. You can use the print monitor to give a printer driver more
options during installation for where the print data will be directed. This
is set up during installation: when selecting the port connected to the
printer, you can either choose "Other" and select a print monitor already
installed in the system or choose to install a new print monitor.
<P>
When the print provider is ready to send data to the print monitor, there
are a set of mandatory callback functions that must be present in the
monitor driver. These functions include the following:

<UL><LI>InitializeMonitor
<LI>EnumPorts
<LI>OpenPort
<LI>ReadPort
<LI>WritePort
<LI>StartDocPort
<LI>EndDocPort
<LI>ClosePort
<LI>DeletePort
<LI>AddPort
<LI>ConfigurePort
<P>
</UL>The data is transmitted to the print monitor through these callback
functions. The print monitor can then transmit the data through appropriate
means for the connection or protocol you want. For example, under IPX you
can communicate to the card using the Sockets API, and under DLC you can
communicate to the card using the AcsLan API.
<P>
More information on these functions can be found in the "Microsoft Win32
Subsystem Driver Design Guide," in section 1.4, "Print Monitors."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 PRINTING MONITOR IPX<BR>
KBCategory: kbprg<BR>
KBSubCategory: GdiPrn<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
