

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Control Message Fails when Trying Dynamic VxDs as Static </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141231">
<META NAME="KBModify" CONTENT="1995/12/14">
<META NAME="KBCreate" CONTENT="1995/12/13">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  While developing a new dynamic VxD for Windows 95, developers sometimes put the VxD into the System.ini files's [386Enh] section as a  device=  line to test initialization or other basic function. During early testing, the .inf might not be generat...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAVQ,QAHC,QADN,QAEV,QAVX,QAVW,QAYC,QA7O,QAOE,QAMN,QAHB,QBXM,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Control Message Fails when Trying Dynamic VxDs as Static</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 14, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141231</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Device Development Kit (DDK) for Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
While developing a new dynamic VxD for Windows 95, developers sometimes put
the VxD into the System.ini files's [386Enh] section as a "device=" line to
test initialization or other basic function. During early testing, the .inf
might not be generated or the loading application may not be working yet,
so this seems a good way to temporarily test some functions. Yet, the
initialization routines are never called.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is due to the fact that the control messages that VMM sends out for
static and dynamic VxDs are not the same. Refer to the library compact disc
or Vmm.doc from the DDK. To summarize (from VMM.DOC):
<P>
Static messages:
<P>
<PRE>Device_Init         Virtual devices initializing (interrupts enabled).
Init_Complete       All virtual devices have initialized.
Sys_Critical_Exit   System is terminating (interrupt disabled).
Sys_Critical_Init   Virtual devices initializing (interrupts disabled).
System_Exit         System is terminating (interrupts enabled).

</PRE>Dynamic messages:
<P>
<PRE>Sys_Dynamic_Device_Exit   Dynamic VxD being unloaded (directed).
Sys_Dynamic_Device_Init   Dynamic VxD being loaded (directed).

</PRE><h2>RESOLUTION</h2>
 
<P>
If you are planning to switch back and forth, you may want to include both
types of messages in your control message procedure, for example:
<P>
<PRE>   Control_Dispatch SYS_DYNAMIC_DEVICE_INIT, My_Init
   Control_Dispatch DEVICE_INIT, My_Init

</PRE>Also, don't forget to finally remove the System.ini "device" line when your
dynamic loading is working.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Windows 95 DDK
MSDN Library Compact Disc October 1995
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 VMM control message<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 14, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
