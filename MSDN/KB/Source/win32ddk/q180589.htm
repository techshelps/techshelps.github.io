

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: IoMarkIrpPending(Irp) vs. IoStatus.Status=STATUS_PENDING </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180589">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1998/02/05">
<META NAME="Keywords" CONTENT="NTDDKKMode">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  This article explains the difference between IoMarkIrpPending(Irp), IoStatus.Status=STATUS_PENDING, and return STATUS_PENDING.  MORE INFORMATION  To see exactly what IoMarkIrpPending does, look at the following definition in NTDDK.H:     // VOID   ...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAUD,QBWP,QAKD,QBCF,QBXN,QAM2,QBVV,QAIF,QALW,QDMW,QBBI,QAYV,QALQ,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: IoMarkIrpPending(Irp) vs. IoStatus.Status=STATUS_PENDING</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180589</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Device Driver Kit (DDK) for Windows NT, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains the difference between IoMarkIrpPending(Irp),
IoStatus.Status=STATUS_PENDING, and return STATUS_PENDING.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To see exactly what IoMarkIrpPending does, look at the following definition
in NTDDK.H:
<P>
<PRE>   // VOID
   // IoMarkIrpPending(
   //     IN OUT PIRP Irp
   //     )
   //
   // Routine Description:
   //
   // This routine marks the specified I/O Request Packet (IRP) to indicate
   // that an initial status of STATUS_PENDING was returned to the caller.
   // This is used so that I/O completion can determine whether or not to
   // fully complete the I/O operation requested by the packet.
   //
   // Arguments:
   //
   //     Irp - Pointer to the I/O Request Packet to be marked pending.
   //
   // Return Value:
   //
   //     None.
   //
   //--

   #define IoMarkIrpPending( Irp ) ( \
       IoGetCurrentIrpStackLocation( (Irp) )-&gt;Control |=
       SL_PENDING_RETURNED )

</PRE>There is never any reason to store STATUS_PENDING in Irp-&gt;IoStatus.Status
because Irp-&gt;IoStatus.Status is filled in with the "final" status of the
IRP just before calling IoCompleteRequest. None of the code paths look at
Irp-&gt;IoStatus.Status until IoCompleteRequest is called. Therefore, there is
no reason to set Irp-&gt;IoStatus.Status to any value before IoCompleteRequest
is called. Conversely, STATUS_PENDING is never an appropriate value for Irp-
&gt;IoStatus.Status when IoCompleteRequest is called.
<P>
STATUS_PENDING is the proper return value from any dispatch routine that
has not called IoCompleteRequest on the IRP or not passed the IRP to a
lower-layer driver. This type of routine must also call IoMarkIrpPending
for the IRP.
 
<PRE>Keywords          : NTDDKKMode
Version           : WINNT:4.0
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
