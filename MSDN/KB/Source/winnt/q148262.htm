

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Removing Windows NT 3.51 SP4 or SP5 May Cause Logon Failures </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148262">
<META NAME="KBModify" CONTENT="1997/04/11">
<META NAME="KBCreate" CONTENT="1996/03/07">
<META NAME="Keywords" CONTENT="kbnetwork kbsetup ntsecurity ntsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  After you upgrade to Windows NT 3.51 Service Pack 4 or 5 and you want to revert back to the original version of Windows NT 3.51 or the previous Service Pack version through the Repair process or re-installation of Windows NT 3.51, one or all the fo...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDO3,QAA1,QAR4,QAB4,QDI2,QDL9,QBWQ,QBWO,QBWN,QDNL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Removing Windows NT 3.51 SP4 or SP5 May Cause Logon Failures</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148262</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you upgrade to Windows NT 3.51 Service Pack 4 or 5 and you want to
revert back to the original version of Windows NT 3.51 or the previous
Service Pack version through the Repair process or re-installation of
Windows NT 3.51, one or all the following symptoms occur:

<UL><LI>The following Logon error message appears:
<P>
<P><PRE>      The system cannot log you on [80000005]
      Please try again or consult your system administrator
</PRE>
<LI>The following Logon error message appears:
<P>
<P><PRE>      Unable to log you on because the netlogon service failed
      to start.
</PRE>
<LI>The following Logon error message appears:
<P>
<P><PRE>      The system cannot log you on [C0000037]. Please try again or
      consult your system administrator.
</PRE>
<LI>The From drop-down list box is blank. No computer or domain
   name appears.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To correct this problem, do one of the following:

<UL><LI>If Windows NT is installed on a FAT partition, replace Samsrv.dll in
   the %SystemRoot%\System32 directory with the Samsrv.dll in Service
   Pack 4 or 5.

<LI>OR-

<LI>If Windows NT is installed on an NTFS partition, re-install Windows NT
   to a separate directory. Log on as the same user with same permissions
   and relace Samsrv.dll in the %SystemRoot%\System32 directory with the
   Samsrv.dll in the Service Pack 4 or 5.

<LI>OR-

<LI>Restore the SAM and SECURITY database system hives from the last Windows
   NT Backup performed prior to the installation of Windows NT Service
   Pack 4 or 5. This restores the SAM and Security databases to the format
   prior to the update of Service Pack 4. This format is compatible with
   the original Windows NT 3.51 (Build 1057) system files.
<P>
   WARNING: This procedure may result in loss of any new users, groups and
   trust relationships created since the previous backup. You should only
   follow this procedure as the last resort.

<LI>OR-

<LI>Modify the contents of the emergency repair disk (ERD) by doing the
   following:

</UL><OL><P><LI>Remove the attributes from the SETUP.LOG file by typing the
   following at the commandline:
<P>
<P><PRE>      attrib -r -h -s a:\SETUP.LOG
</PRE>
<P><LI>In Setup.log, add the following line to the files.WinNt section:
<P>
<P><PRE>      \Winnt\System32\Samsrv.dll = "samsrv.dll","316d3","\",
      (continued line)  "nt351 repair disk","samsrv.dll"
</PRE><P>
   NOTE: \Winnt represents the directory where Windows NT is installed.

<P><LI>Copy Samsrv.dll from the Windows NT 3.51 Service Pack 4 or 5 source
    media to the root directory of the ERD.

<P><LI>Restart your computer with the three Windows NT 3.51 Setup disks.

<P><LI>Select R to Repair your Windows NT.

<P><LI>Select only "Verify Windows NT System Files" and continue.

<P><LI>If prompted to insert Windows NT setup disk #4, press ESC to
   continue with the Repair process.

<P><LI>After you replace Samsrv.dll with the file from Windows NT 3.51
   Service Pack 4 or 5, press F3 to exit Repair. Reboot the computer and
   restart Windows NT.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
After you install Windows NT 3.51 Service Pack 4 or 5, the SAM and Security
database hives are updated to a new format. This new format requires the
new Samsrv.dll that ships with Service Pack 4 or 5, and it is not backward-
compatible with the earlier versions of Samsrv.dll.
<P>
The following is an important notice included in the Readme.txt of the
Windows NT 3.51 Service Pack 4 and 5:
<P>
<PRE>   When using the Windows NT Emergency Repair Disk to repair your Windows
   NT system after applying the Service Pack, do not repair the file
   Samsrv.dll. If it is necessary to repair this file because it has become
   corrupt, you must replace it with the Service Pack version of the file.

   This is necessary because the Service Pack update process changes the
   user database, and the Service Pack version of Samsrv.dll is needed to
   allow the system to function properly.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt sp4 sp5<BR>
Keywords            : kbnetwork kbsetup ntsecurity ntsetup<BR>
Version             : 3.51<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
