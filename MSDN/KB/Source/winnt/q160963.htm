

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHKNTFS.EXE: What You Can Use It For </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160963">
<META NAME="KBModify" CONTENT="1997/12/20">
<META NAME="KBCreate" CONTENT="1996/12/13">
<META NAME="Keywords" CONTENT="kbbug4.00 ntdistrib ntfilesys nthowto ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Chkntfs.exe is a utility developed by Microsoft and is available on Service Pack 2 and later for Windows NT 4.0. It is designed to disable the automatic running of chkdsk on specific volumes, when Windows NT reboots from an improper shutdown. Chknt...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QA7T,QBWP,QAY2,QBWS,QBXS,QBE7,QBE6,QA8N,QAC9,QBFY,QAKD,QBV8,QAL4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>CHKNTFS.EXE: What You Can Use It For</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160963</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Chkntfs.exe is a utility developed by Microsoft and is available on
Service Pack 2 and later for Windows NT 4.0. It is designed to disable the
automatic running of chkdsk on specific volumes, when Windows NT reboots
from an improper shutdown. Chkntfs can also be used to unschedule a chkdsk
if chkdsk /f was used to schedule a chkdsk on an active volume on the next
system reboot.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Every time Windows NT boots, Autochk.exe is called by the Kernel to scan
all volumes to check if the volume dirty bit is set. If the dirty bit is
set, autochk performs an immediate chkdsk /f on that volume. CHKDSK /f
verifies file system integrity and attempts to fix any problems with the
volume. It is always advisable to run chkdsk on volumes that have been
improperly shutdown, however, there may be some situations in which
running chkdsk after every improper shutdown is not possible or practical.
In some cases, chkdsk may take several hours or even days to completely
check the volume or may hang while checking the volume. In these
situations, it is more practical to postpone the chkdsk until a more
convenient time.
<P>
Chkntfs is a utility that allows a system administrator to exclude volumes
from being checked by the autochk program. The utility is run from a
command prompt and has the following command line options:
<P>
<PRE>   chkntfs drive: [...]
   chkntfs /d
   chkntfs /x drive: [...]
   chkntfs /c drive: [...]
      drive:         Specifies a drive letter.
     /D             Restores the machine to the default
                    behavior; all drives are checked at boot
                    time and chkdsk is run on those that are
                    dirty. This undoes the effect of the /X
                    option.
     /X             Excludes a drive from the default boot-time
                    check. Excluded drives are not accumulated
                    between command invocations.
     /C             Schedules chkdsk to be run at the next
                    reboot if the dirty bit has been set.

</PRE>If no switches are specified, chkntfs will display the status of the dirty
bit for each drive.
<P>
Examples:
<P>
<PRE>   chkntfs /x c:     This will disable chkdsk from running on drive C:

   chkntfs /x d: e:  This will disable chkdsk from running on drives D:
                     and E:.

</PRE>The chkntfs /x commands are not cumulative, the command will overwrite any
previous drive exclusions that have been established. In the above
example, chkntfs will only disable the chkdsk checking on drives D and E,
drive C will not be checked for the presence of a dirty bit.
<P>
The chkntfs utility works by modifying the BootExcecute value in the
system registry. The BootExecute value is located in the following
registry key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CURRENTCONTROLSET\CONTROL\SessionManager

</PRE>The default value is:
<P>
<PRE>   BootExecute:REG_MULTI_SZ:autocheck autochk *

</PRE>Chkntfs /x adds a /k parameter prior to the asterisk. The /k parameter
excludes volumes from being checked for the presence of a dirty bit.
<P>
For example, the command
<P>
<PRE>    chkntfs /x D:

</PRE>would modify this registry entry to autocheck autochk /k:d *
<P>
Chkdsk /f schedules itself to run at the next reboot by setting the dirty
bit on the drive. Chkdsk /x disables the checking for this bit. Chkdsk /f
will never run on volumes that are excluded from dirty bit checking by
chkntfs.
<P>
In order to run a chkdsk /f on a drive that has been excluded by the
chkntfs utility, you must run the chkntfs /d option to return the system
to its normal state or edit the BootExecute value in the registry and
remove the applicable drive letter from the /k parameter.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
Chkdsk /f /r allows chkdsk to check volumes for file system errors and bad
sectors on the physical disk. Chkdsk /f /r schedules itself to be run on
the next system reboot, by adding an entry into the BootExecute value.
For example,
<P>
<PRE>   chkdsk c: /f /r

</PRE>will add the following entry to the BootExecute value:
<P>
<PRE>   autocheck autochk /r \??\C:

</PRE>Because this entry is actually placed in the registry, the chkdsk /f /r
will be unaffected by any chkntfs commands. The only way to disable a
chkdsk /f /r is to remove the line from the BootExecute value that
references this command.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: chkdsk chkntfs<BR>
Keywords          : kbbug4.00 ntdistrib ntfilesys nthowto ntutil<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
