

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Unattended Install of PowerToys in WinNT Server Reskit 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166820">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1997/04/11">
<META NAME="Keywords" CONTENT="ntreskit ntsetup NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Windows NT Server 4.0 Resource Kit Supplement 1 includes four desktop components that are not included in the original Windows NT Server 4.0 Resource Kit.  The new components are:     CMD Prompt Here (Cmdhere.inf)    Security        (Rshxmenu.i...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QBKX,QBXB,QATJ,QDL9,QBWQ,QBWO,QBWN,QDIK,QAFI,QBXT,QA5V,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unattended Install of PowerToys in WinNT Server Reskit 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166820</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows NT Server 4.0 Resource Kit Supplement 1 includes four desktop
components that are not included in the original Windows NT Server 4.0
Resource Kit.
<P>
The new components are:
<P>
<PRE>   CMD Prompt Here (Cmdhere.inf)
   Security        (Rshxmenu.inf)
   Run             (Runext.inf)
   TweakUI         (Tweakui.inf)

</PRE>The new components are located in the PowerToy directory under the
resource kit directory. If you used the default to install the resource
kit, the directory is C:\Ntreskit\Powertoy
<P>
To manually install the new components, go to Windows NT Explorer and
highlight the .inf file. Right-click and then click Install from the menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To automate the installation of the Power Toys during deployment or
unattended installation of Windows NT 4.0, you need an Unattend.txt file
that is configured to install Windows NT 4.0. Follow these steps:

<OL><P><LI>Add the option OEMPreInstall = Yes to the [UNATTENDED]
   section in the answer file.

<P><LI>Create an I386 directory on a server and copy the files from the
   I386 directory of the Windows NT 4.0 compact disc to the I386 directory
   on the server.

<P><LI>Create a directory called $OEM$ under the I386 directory on the server.

<P><LI>Copy the contents of the PowerToy directory to the $OEM$.
<P>
<P><PRE>      Cmdhere.inf
      Rshxmenu.inf
      Rshxmenu.X86
      Runext.inf
      Runext.X86
      Tweakui.CNT
      Tweakui.CPL
      Tweakui.HLP
      Tweakui.inf
</PRE>
<P><LI>Use a text editor to create or modify the Cmdlines.txt file, and save
   it to the $OEM$.
<P>
</OL>To save time, you can copy the following 5 lines of information to create
the required Cmdlines.txt.
<P>
<PRE>   [Commands]
   "rundll32 setupapi,InstallHinfSection DefaultInstall 128 .\CMDHERE.INF"
   "rundll32 setupapi,InstallHinfSection DefaultInstall 128 .\RSHXMENU.INF"
   "rundll32 setupapi,InstallHinfSection DefaultInstall 128 .\RUNEXT.INF"
   "rundll32 setupapi,InstallHinfSection DefaultInstall 128 .\TWEAKUI.INF"

</PRE></OL>If you have an existing Cmdlines.txt file, do not copy the [Commands] line,
as an existing Cmdlines.txt file has this line.

<OL><P><LI>A modification of the Tweakui.inf file in the $OEM$ directory is
   required to prevent the Windows NT 4.0 installation from stopping. When
   the TweakUI utility runs, a help file is displayed during installation.
   To disable the help file, comment the following line in Tweakui.inf with
   a semicolon:
<P>
<P><PRE>      HKLM,%SMWCV%\RunOnce\Setup,%ITWEAK%,,"WINHLP32.EXE -i Main
      %18%\TWEAKUI.HLP"
</PRE><P>
</OL>Your Tweakui.inf should look like this after the semicolon is added:
<P>
<PRE>   HKLM,%SMWCV%\Run,%TWEAKUI%,,"RUNDLL32.EXE TWEAKUI.CPL,TweakMeUp"
   HKLM,%SMWCV%\RunOnce\Setup,%UPTWEAK%,,"RUNDLL32.EXE
      TWEAKUI.CPL,TweakMeUp 0";
   HKLM,%SMWCV%\RunOnce\Setup,%ITWEAK%,,"WINHLP32.EXE -i Main
      %18%\TWEAKUI.HLP"

</PRE></OL>NOTE: The previous text should take up 3 lines. It has been wrapped for
readability.
<P>
Consult the Windows NT 4.0 Device Driver Kit (DDK) and the Windows NT 4.0
Software Development Kit (SDK) for detailed information on the new INF
format and options.
<P>
For additional information on the Windows NT 4.0 Power Toys, consult the
online documentation for Windows NT 4.0 Server Supplement 1.
<P>
For additional information on Windows NT 4.0 deployment or unattended
installation, consult the Microsoft Knowledge Base at
<B><A HREF="http://www.microsoft.com/kb">http://www.microsoft.com/kb</A></B> and download the Windows NT 4.0 Deployment
Guide from <B><A HREF="http://www.microsoft.com/ntworkstation/">http://www.microsoft.com/ntworkstation/.</A></B>
<P>
NOTE: The Deployment Guide is valid for both Windows NT Workstation
and Windows NT Server.
 
<PRE>Keywords          : ntreskit ntsetup NTSrvWkst kbsetup
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
