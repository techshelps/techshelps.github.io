

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Winhlp32 &amp; Custom DLL Calling Conventions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120737">
<META NAME="KBModify" CONTENT="1995/02/28">
<META NAME="KBCreate" CONTENT="1994/09/19">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Windows NT help system can call custom DLLs at specific times while viewing specific help files. In Windows 3.1 and Windows NT on 80x86 architectures, the DLL is called with the _pascal calling convention.  MORE INFORMATION  On the MIPS and Pow...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA4Q,QAGI,QBWP,QAIF,QBC7,QAPN,QAH7,QAH6,QAH4,QAHE,QAD7,QDNN,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Winhlp32 &amp; Custom DLL Calling Conventions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120737</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT workstation version 3.5
<LI>Microsoft Windows NT Server version 3.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows NT help system can call custom DLLs at specific times while
viewing specific help files. In Windows 3.1 and Windows NT on 80x86
architectures, the DLL is called with the _pascal calling convention.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
On the MIPS and PowerPC architectures, Windows NT 3.1 and 3.5 use a
workaround because the architectures use a register calling convention:
they pass four (for the MIPS) or eight (for the PowerPC) dummy arguments
followed by the actual arguments. For example, on the 80x86 you might do:
<P>
abc.hpj [CONFIG] section:
<PRE>     RegisterRoutine( "abc", "MyFunction", "UI" )
</PRE>abc.hlp macro call:
<PRE>     MyFunction( hwndApp, 2 )
</PRE>abc.dll implementation:
<PRE>void MyFunction( HWND hwndApp, int i )
</PRE>{
<PRE>     if( i == 3 ) ....
</PRE>}
<P>
On the MIPS, you would employ the dummy argument workaround, and do:
<P>
abc.hpj [CONFIG] section:
<PRE>     RegisterRoutine( "abc", "MyFunction", "UI" )
</PRE>abc.hlp macro call:
<PRE>     MyFunction( hwndApp, 2 )
</PRE>abc.dll implementation:
<PRE>void MyFunction( int d1, int d2, int d3, int d4, HWND hwndApp, int i )
</PRE>{
<PRE>     if( i == 3 ) ....
</PRE>}
<P>
Use these macros if you want your function declarations to be portable
between various NT architectures:
<P>
#if defined(_MIPS_)
<PRE>#define XR1STARGDEF int dummy1, int dummy2, int dummy3, int dummy4,
#define XR1STARGREF 1,2,3,4,
</PRE>#elif defined(_PPC_)
<PRE>#define XR1STARGDEF int d1,int d2,int d3,int d4,int d5,int d6,int d7,int
</PRE>d8,
<P>
<PRE>#define XR1STARGREF 1,2,3,4,5,6,7,8,
</PRE>#else
<PRE>#define XR1STARGDEF
#define XR1STARGREF
</PRE>#endif
<P>
abc.dll implementation:
<PRE>void MyFunction( XR1STARGDEF HWND hwndApp, int i )
</PRE>{
<PRE>     if( i == 3 ) ....
</PRE>}
<P>
If another C routine calls your DLL function, use:
<P>
<PRE>    MyFunction( XR1STARGREF hwnd, 33 );
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: prodnt 3.50 powerpc ppc<BR>
KBCategory: kbprg kbcode<BR>
KBSubCategory: nthowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 28, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
