

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Unattended Setup Does Not Honor Win31Upgrade=no In Answer File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163615">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1997/02/13">
<META NAME="Keywords" CONTENT="kbbug4.00 NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  You want to run Unattended Setup on a computer that already has Windows 3.x installed. But because you do not want to upgrade Windows, you specify  Win31Upgrade=no  in your unattended answer file.  Even though you do this, there is a message during...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDL9,QBWO,QBWN,QDIZ,QBWQ,QBWP,QBW5,QAFI,QBXB,QATJ,QAC1,QBVV,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unattended Setup Does Not Honor Win31Upgrade=no In Answer File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163615</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You want to run Unattended Setup on a computer that already has Windows 3.x
installed. But because you do not want to upgrade Windows, you specify
"Win31Upgrade=no" in your unattended answer file.
<P>
Even though you do this, there is a message during text mode setup saying:
<P>
<PRE>   Setup has found a previous version of Microsoft Windows on your hard
   disk in the directory shown below.

      C:\WINDOWS

   Setup recommends installing Microsoft Windows NT in the same directory.

</PRE><h2>CAUSE</h2>
 
<P>
When Setup finds Windows, it first checks if there is enough free space on
the partition containing Windows before it asks for the upgrade. If there
is insufficient space, Windows NT Setup displays the message above before
honoring the setting in the unattended answer file.
<P>
The drive is too full to hold Windows NT, which requires approximately
122 MB (1 MB = 1,048,576 bytes) of free disk space.
<P>
<P><h2>WORK-AROUND</h2>
 
<P>
Free up some disk space by moving files or directories to another drive.
<P>
-or-
<P>
Windows NT only searches for Windows 3.1 in directories listed in the PATH
statement in C:\Autoexec.bat. In the Windows directory, it checks for the
files Win.com, Win.ini, and System.ini.
<P>
There are several ways to hide Windows from Windows NT Setup:

<OL><P><LI>Rename C:\Autoexec.bat prior to setup and undo the rename after setup.

<P><LI>Rename Win.com, Win.ini, or System.ini in the Windows directory prior to
   setup and rename them after setup.

<P><LI>In C:\Autoexec.bat, edit the PATH statement to remove the Windows
   directory.

<P><LI>Setup also does not offer the upgrade if it suspects Windows 95 in this
   directory. Setup looks for Shell32.dll, User32.dll, Kernel32.dll, and
   Gdi32.dll in the system subdirectory. If it finds those files it will
   not perform an upgrade.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft Windows NT
version 4.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: unattend<BR>
Keywords          : kbbug4.00 NTSrvWkst<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
