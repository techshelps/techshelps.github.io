

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RUNONCE Key Is Processed Immediately When RUNDLL32 Is Called </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173039">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1997/08/22">
<META NAME="Keywords" CONTENT="ntreskit ntsetup NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If you place items in the RUNONCE key so that they will run the next time you log on, they will run as soon as Rundll32.exe is run, whether or not logging on is in progress. This is a design feature of Rundll32.exe for Windows NT 4.0 Server and Wor...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAVW,QAVX,QBTI,QDL9,QBWO,QBWN,QBWS,QBXB,QBWQ,QATJ,QAFI,QDNQ,QDJ4,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RUNONCE Key Is Processed Immediately When RUNDLL32 Is Called</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173039</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
<P>
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you place items in the RUNONCE key so that they will run the next time
you log on, they will run as soon as Rundll32.exe is run, whether or
not logging on is in progress. This is a design feature of Rundll32.exe for
Windows NT 4.0 Server and Workstation.
<P>
This feature can cause problems, however, during an unattended installation
of Windows NT version 4.0 using the Cmdlines.txt option.  This article
discusses these possible problems and some ways to avoid them.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To produce the desired results from the RUNONCE key, it is very important
not to add any values to it before running Rundll32.exe options. This
includes using a Windows 95-style .inf to add the RUNONCE registry values.
<P>
You can re-create and examine the effects of launching Rundll32.exe when
there is a RUNONCE value ready to run by using the following steps:

<OL><P><LI>Create a directory called Test.

<P><LI>Using Notepad.exe, enter the following lines, and then save as
   Runonce.reg in the Test directory:
<P>
<P><PRE>      REGEDIT4
</PRE><P>
<P><PRE>      [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion
      \RunOnce]
      "doit"="c:\\test\\test.cmd"
</PRE><P>

<P><LI>Using Notepad.exe, enter the following lines, and then save as
   Cmdlines.cmd in the Test directory:
<P>
<P>
<P><PRE>      @ECHO OFF
      REGEDIT.EXE /s RUNONCE.REG
      rundll32 setupapi,InstallHinfSection DefaultInstall 128 .\test.INF
</PRE>
<P><LI>Using Notepad.exe, enter the following lines, and then save as Test.cmd
   in the Test directory:
<P>
<P><PRE>      @echo off
      ECHO HELLO WORLD
      PAUSE
</PRE>
<P><LI>Using Notepad.exe, enter the following lines, and then save as Test.inf
   in the Test directory:
<P>
<P><PRE>      [Version]
      Signature = "$Windows NT$"
</PRE><P>
<P><PRE>      [DefaultInstall]
      AddReg = AddReg
      DelReg = DelReg
      UpdateInis = UpdateInis
</PRE><P>
<P><PRE>      [AddReg]
      [DelReg]
      [UpdateInis]
</PRE>
<P><LI>From an MS-DOS prompt, run Cmdlines.cmd; you will see that the file
   Test.cmd runs.
<P>
</OL>The following example shows the file Cmdlines.txt located in the $OEM$
directory of a Windows NT Deployment share, with the proper order to
run Rundll32.exe and a Regedit script for Runonce. Optimally, it would be
best to run all Rundll32.exe statements before running Regedit scripts.
<P>
<PRE>   [Commands]
   "rundll32 setupapi,InstallHinfSection DefaultInstall 128 .\test.INF"
   "REGEDIT.EXE /s .\RUNONCE.REG"

</PRE></OL>For additional information on Windows NT 4.0 deployment and unattended
installation, download the Windows NT 4.0 Deployment Guide from the
following web site:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/ntworkstation/info/deployguide.htm">http://www.microsoft.com/ntworkstation/info/deployguide.htm</A></B>

</PRE>Note: The deployment guide is valid for both Windows NT Workstation
and Windows NT Server.
 
<PRE>Keywords          : ntreskit ntsetup NTSrvWkst kbsetup
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
