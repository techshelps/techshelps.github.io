

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RUN.EXE: A Logon Script Exit Utility </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142028">
<META NAME="KBModify" CONTENT="1996/01/22">
<META NAME="KBCreate" CONTENT="1996/01/03">
<META NAME="Keywords" CONTENT="kbtool kbhowto kbreadme">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Local area network administrators often want users running MS-DOS clients (Lan Manager 2.2c, Network Client 3.0) to go directly into Microsoft Windows or to run some application immediately upon logging on. This is often attempted by executing the ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QDNQ,QAI5,QAVZ,QANE,QBWE,QBBI,QDL9,QBWO,QBWN,QBJQ,QBV8,QBXT,QBW7,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RUN.EXE: A Logon Script Exit Utility</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 22, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142028</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft LAN Manager Server version 2.2
<LI>Microsoft LAN Manager Client version 2.2c
<LI>Microsoft Network Client version 3.0 for MS-DOS
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Local area network administrators often want users running MS-DOS clients
(Lan Manager 2.2c, Network Client 3.0) to go directly into Microsoft
Windows or to run some application immediately upon logging on. This is
often attempted by executing the application at the end of a logon script.
Unfortunately, memory problems are often experienced because logon scripts
are spawned on a second copy of COMMAND.COM, and NET.EXE still resides in
memory from the unfinished execution of NET LOGON.
<P>
RUN.EXE is a utility in the Lan Manager Resource Kit (version 2.1) that
allows you to specify a command to execute upon the completion of your
logon script. It provides support similar to Novell NetWare's login script
option:
<P>
<PRE>     EXIT "cmdline"

</PRE>RUN.EXE avoids the memory problems mentioned above by executing your
command at the original MS-DOS prompt. It works with logon scripts in both
the Lan Manager server and Windows NT server environments.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>HOW RUN.EXE IS USED</h3>
 
<P>
The following files are included with RUN.EXE
<P>
<PRE>    Filename        Description
    --------        -----------
    RUN.EXE         Executable
    README.TXT      This file

</PRE>Place RUN.EXE in your current working directory or somewhere in your path.
At the end of your logon script add:
<P>
<PRE>    RUN &lt;cmdline&gt;

</PRE>where &lt;cmdline&gt; specifies the command line for the application that you
want to start after you have logged in. &lt;cmdline&gt; is limited to 14
characters (see "Important Notes" below).
<P>
Example:
<P>
Suppose you would like to have Windows start up after your logon script
executes. Place RUN.EXE somewhere in your path, and add the following line
to the end of your logon script:
<P>
<PRE>       RUN WIN

</PRE>Windows will immediately start after your NET LOGON command finishes,
without the memory loss caused by NET.EXE and a second copy of COMMAND.COM
running.
<P>
<P><h3>HOW DOES RUN.EXE WORK?</h3>
 
<P>
RUN.EXE simply takes the command line you specify and dumps it into the
keyboard buffer. The keyboard buffer will be emptied at the first available
opportunity. If you use RUN.EXE at the end of your logon script, the first
opportunity will be after NET LOGON has finished executing. Therefore, your
original MS-DOS prompt will receive the input.
<P>
<P><h3>IMPORTANT NOTES</h3>
 
<P>
The keyboard buffer is limited to 16 characters. Therefore, because one
character is taken for the line feed and another for the tail pointer,
&lt;cmdline&gt; is limited to 14 characters. If more than 14 characters are
specified, RUN.EXE will ignore them.
<P>
RUN.EXE was designed to be run exclusively on MS-DOS. It is a real mode
application that will not execute from OS/2. The whole reason for running
RUN.EXE is lost in OS/2 since the memory problem is not an issue. Similarly
you should be careful when logging in from Windows. Again the functionality
of this utility in such an environment would be questionable. Limited tests
have shown that RUN.EXE has no effect when logging on from Windows.
<P>
If you need more than 14 characters to specify the command(s) that you need
to execute, create a batch file and have RUN.EXE call your batch file. This
would be useful if you wanted to do something like set a variety of
environment variables.
<P>
RUN.EXE writes directly to the keyboard buffer. Computers that are not
fully IBM-compatible could have some problems with RUN.EXE. It has been
successfully tested on a variety of AT-compatible computers as well as some
PS/2's.
<P>
Persistent Connections are restored after the logon script executes. If a
Persistent Connection requires a password, the command line specified with
RUN.EXE will be inserted at the password prompt and thus will not run at
the MS-DOS command line. If you are using RUN.EXE, be careful that this
does not happen. If you need to connect to a share that requires a password
different from the one you logged on with, you should add the NET USE for
this share to the batch file that RUN.EXE executes.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: winnt run.exe lmreskit<BR>
KBCategory: kbtool kbhowto kbreadme<BR>
KBSubcategory: ntutil ntdosap
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 22, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
