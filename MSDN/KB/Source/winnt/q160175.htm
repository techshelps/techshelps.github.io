

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>What Does WinNT 4.0 look for in a Valid WinNT 3.51 Install </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160175">
<META NAME="KBModify" CONTENT="1997/12/31">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="ntsetup NTSrvWkst kbnetwork kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When Windows NT 4.0 Setup cannot find a previous version of Windows NT to upgrade, it is usually because one of the following checks failed:   - Boot.Ini entry - Setup looks for a valid path to the Software hive.   - Loads the Software hive for ver...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QAC1,QDIZ,QAA5,QBVV,QBFM,QDL9,QBWQ,QBWO,QBWN,QDIV,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>What Does WinNT 4.0 look for in a Valid WinNT 3.51 Install</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160175</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When Windows NT 4.0 Setup cannot find a previous version of Windows NT to
upgrade, it is usually because one of the following checks failed:

<UL><LI>Boot.Ini entry - Setup looks for a valid path to the Software hive.

<LI>Loads the Software hive for version number and product ID, loads the
   System hive.

<LI>A System32 directory, Ntoskrnl.exe, and Ntdll.dll must be present.

<LI>A System32\Drivers directory must exist.

<LI>Must have Windows NT version 3.X installation CD to perform an upgrade
   to clean directory if you have the upgrade or step-up version of Windows
   NT 4.0.
<P>
</UL><h2>MORE INFORMATION</h2>
 

<UL><LI>If an application or the user has altered the Software hive version
   or Product ID, Windows NT setup will not find a valid upgrade path. If
   the Software hive is corrupt, the computer typically will not boot.

<LI>If the Software or System hives are corrupt, Windows NT Setup will not
   find a valid installation and require a clean install. A possible
   work around is to export third-party registry keys, particularly in the
   Software hive, until the Software hive is recognized as valid. Then
   reinstall the 3rd-party components after the upgrade.
<P>
   NOTE: You can run Rdisk.exe and select update repair information then
   expand the System._ and Software._ files found in the
   %SystemRoot%\Repair directory. Using Regedt32 on another Windows NT
   computer running the newer version, try to load the expanded System or
   Software Hives to see if they load without error.

<LI>Windows NT will parse the Boot.ini file or look in NVRAM on RISC
   computers to find a valid Windows NT installation. The Boot.ini entries
   must be correct and should follow these guidelines:
<P>
<P><PRE>    - Contain no spaces in the ARC path except: "The description between
      quotes"
</PRE><P>
<P><PRE>    - Contain only ACSII characters and end with a CR LF - use EDIT.COM to
      add a hard return after each line
</PRE><P>
<P><PRE>    - Contain no blank lines between entries
</PRE>
<LI>If Windows NT does not find a valid installation, ensure that the boot
   drive and the system drive are attached to disk controllers that are
   detected by Windows NT. One drive may be controlled by a retired driver
   or a controller driver that is not being detected (though in most cases
   this will result in a STOP: 0x0000007b - inaccessible boot device error
   message). If the error is occurring, use F6 during the hardware
   detection phase ("Setup is examining your hardware configuration") to
   select the correct controllers or load a 3rd party device driver.

<LI>Windows NT will not upgrade Server to Workstation. Make certain the
   system being upgraded is not a member server.

<LI>There is no back-door to fooling setup for upgrade purposes. If the
   Windows NT 3.51 installation is deleted, you will need a Windows NT 3.51
   CD (the "Step-Up" Version will work) to continue.

<LI>In some cases, a parallel installation of Windows NT will help Setup
   identify the original installation as an upgrade candidate.

<LI>The resource kit utility C2config.exe (C2 Configuration Manager)
   Registry Security option was run on the Windows NT 3.51 computer before
   the upgrade. The registries Access Control List entries (permissions)
   had been changed so that setup was unable to access the information
   necessary to locate the previous installation. This is by design and is
   part of the C2 Security specification.
<P>
</UL>For more information, please see the following Microsoft Knowledge Base
article:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q159995.htm">Q159995</A></B>
   TITLE     : Windows NT Does Not Detect Previous Window NT 3.5x
               Installation
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: previous version upgrade c2<BR>
Keywords          : ntsetup NTSrvWkst kbnetwork kbsetup<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 31, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
