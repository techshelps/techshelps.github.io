

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Batch File Adds/Removes Machine Accounts in Server Manager </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140387">
<META NAME="KBModify" CONTENT="1997/03/26">
<META NAME="KBCreate" CONTENT="1995/11/29">
<META NAME="Keywords" CONTENT="kbsetup kbusage ntdomain nthowto NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  An Windows NT network administrator may have to add a large number of Windows NT Workstations or Non-Domain Controller Servers to a domain's Machine Account database, which is accessed and maintained by the Server Manager user interface.  MORE INFO...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAVZ,QBG2,QAI5,QADZ,QAEF,QADN,QAH5,QBV8,QAB9,QBWU,QAGU,QDIO,QAJG,QAGF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Batch File Adds/Removes Machine Accounts in Server Manager</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140387</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An Windows NT network administrator may have to add a large number of
Windows NT Workstations or Non-Domain Controller Servers to a domain's
Machine Account database, which is accessed and maintained by the Server
Manager user interface.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In situations where a network administrator is setting up a network with a
large number of new machine accounts, it may be advantageous to consider
using a simple batch file to add all of the new machine accounts.
<P>
It is possible to add machine accounts with a command line utility under
Windows NT called NET COMPUTER. Its syntax is:
<P>
<PRE>      NET COMPUTER \\computername [/ADD | /DELETE]


</PRE><h2>Using NET COMPUTER Command in a Simple Batch File</h2>
 
<P>
This example adds 5 new machine accounts to the domain:
<P>
<PRE>   echo *****  Are you sure you want to add these accounts?  *******
   echo ***  If not, press CTRL-C to terminate this batch file  ***
   pause
   net computer \\NT1 /ADD
   net computer \\NT2 /ADD
   net computer \\NT3 /ADD
   net computer \\NT4 /ADD
   net computer \\NT5 /ADD
   cls
   echo             *******  Machine Accounts Added  ********
   pause

</PRE>NOTE: The NET COMPUTER command listed in this article can only be used to
add Windows NT Workstation or Windows NT Server (Non-Domain Controller
role) machine accounts to the Server Manager's database. Also, this command
or batch files that use this command should only be run at the Primary
Domain Controller(PDC). Once the batch file is run the administrator can
then synchronize the account database with the rest of the domain's Backup
Domain Controller's (BDC's).
<P>
<P><h2>Using the FOR Batch File Command in Conjunction with NET COMPUTER</h2>
 
<P>
Another way to accomplish this is to use the FOR command. The batch file
command FOR lets your batch file repeat a command for a specific set of
files. In this case, for the specific machine names we want to add to the
Server Manager database:
<P>
<PRE>   echo *****  Are you sure you want to add these accounts?  *******
   echo ***  If not, press CTRL-C to terminate this batch file  ***
   pause
   FOR %%X IN (NT1 NT2 NT3 NT4 NT5) DO NET COMPUTER \\%%X  /ADD
   FOR %%X IN (NT6 NT7 NT8 NT9 NT10) DO NET COMPUTER \\%%X  /ADD
   cls
   echo             *******  Machine Accounts Added  ********
   pause

</PRE>NOTE: Under Windows NT, the command line is limited to 256 characters.
<P>
<P><h2>NET COMPUTER Errors</h2>
 

<UL><LI>The NET COMPUTER command will return an error level message for each
   machine name that is attempted.

<LI>If the computer name already exists in the Server Manager database the
   message: "The computer \\name already exists." is returned with a NET
   HELPMSG #3782.

<LI>If the command completed successfully, a message saying so appears.
<P>
</UL><h2>Using NET COMPUTER to Delete Many Machine Accounts</h2>
 
<P>
You can also remove many accounts by using the "\DEL" switch instead of the
"\ADD" switch in the batch files shown above.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbsetup kbusage ntdomain nthowto NTSrvWkst<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
