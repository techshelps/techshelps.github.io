

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Hung Server Service, Event 7022 w/ Many DLC Printers Connected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137399">
<META NAME="KBModify" CONTENT="1997/11/21">
<META NAME="KBCreate" CONTENT="1995/09/29">
<META NAME="Keywords" CONTENT="ntnetserv ntprint kberrmsg kbprint">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you configure your Windows NT computer to connect to many network print devices using the DLC protocol, one or both of the following symptoms occur:   - The following event appears in the System Log (as seen in the Event    Viewer):        Eve...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACK,QBWP,QAI5,QAY2,QAO4,QAIJ,QBJZ,QAPN,QAB4,QBWS,QAAP,QDIV,QAVZ,QAR4,QAL0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Hung Server Service, Event 7022 w/ Many DLC Printers Connected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137399</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.50 3.51
WINDOWS
kbprint kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you configure your Windows NT computer to connect to many network
print devices using the DLC protocol, one or both of the following
symptoms occur:

<UL><LI>The following event appears in the System Log (as seen in the Event
   Viewer):
<P>
<P><PRE>      Event ID: 7022
      Source: Service Control Manager
      Type: Error
      Description: Server service hung on startup.
</PRE><P>
   -or-

<LI>The Server service stops responding (hangs) in a "start pending" state
   and the Netlogon and Browser services do not start. This error message
   appears when you log in:
<P>
<P><PRE>      Can not contact the domain controller for this domain
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
The server service does not initially start due to delays caused by the
spooler service.
<P>
The spooler service attempts to connect to all the network printers.
Usually, you encounter this problem only on servers attempting to connect
to over 25 network printers using the DLC protocol. The number of
connections required to trigger this event varies according to hardware
and network performance.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Run Registry Editor (REGEDT32.EXE).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Services\Spooler
</PRE>
<P><LI>From the Edit menu, select Add Value.

<P><LI>Add the following:
<P>
<P><PRE>      Value Name: DependOnService
      Data Type:  REG_MULTI_SZ
<PRE></PRE>      Data:       LanmanWorkstation&lt;CR&gt;LanmanServer&lt;CR&gt;LmHosts

</PRE></OL>NOTE: &lt;CR&gt; Indicates you should hit Enter on the keyboard

<OL><P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Services\NetLogon
</PRE>
<P><LI>Select the DependOnService entry

<P><LI>From the Edit menu, select Multi String....

<P><LI>Add the necessary services to make your data look like this:
<P>
<P><PRE>      Value Name: DependOnService
      Data Type:  REG_MULTI_SZ
<PRE></PRE>      Data:       LanmanServer

</PRE><P><LI>Choose OK and quit Registry Editor.

<P><LI>Shut down and restart Windows NT.
<P>
</OL>Adding these lines holds the spooler service from loading until the
LanmanWorkstation, LanmanServer, and LmHosts services have loaded and
holds the netlogon service from loading until spooler, LanmanWorkstation,
LanmanServer, and LmHosts has loaded.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kberrmsg<BR>
KBSubcategory: ntprint ntnetserv<BR>
Additional reference words: prodnt 3.50 3.51 JetDirect<BR>
Keywords          : ntnetserv ntprint kberrmsg kbprint<BR>
Version           : 3.50 3.51<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
