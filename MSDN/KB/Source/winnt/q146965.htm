

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetAdmin Utility Grants Users Administrative Rights </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146965">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1996/03/07">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00 nt32ap ntsecurity NTSrvWkst kbfile kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  A utility, Getadmin.exe, is being circulated on the Internet that grants normal users administrative rights by adding them to the Administrators group. This utility can be run from any user context except Guest and grants a local user account admin...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAGU,QAR4,QBG2,QAAD,QAVZ,QBWS,QBCU,QA39,QAGI,QAI5,QBWU,QBVV,QA9A,QAM1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>GetAdmin Utility Grants Users Administrative Rights</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146965</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A utility, Getadmin.exe, is being circulated on the Internet that grants
normal users administrative rights by adding them to the Administrators
group. This utility can be run from any user context except Guest and
grants a local user account administrative rights.
<P>
This problem does not occur on Windows NT 3.51.
<P>
<P><h2>CAUSE</h2>
 
<P>
Getadmin.exe works because of a problem in a low-level kernel routine that
causes a global flag to be set which allows calls to NtOpenProcessToken to
succeed regardless of the current users permissions. This in turn allows a
user to attach to any process running on the system, including a process
running in the system's security context, such as WinLogon. Once attached
to such a process, a thread can be started in the security context of the
process.
<P>
In the specific case of GetAdmin, it attaches to the WinLogon process,
which is running in the system's security context, and makes standard API
calls that add the specified user to the administrators group.
<P>
It is important to note that any account which has been granted the rights
to "Debug Programs" will always be able to run Getadmin.exe successfully,
even after the application of the hotfix. This is because the "Debug
Programs" right allows a user to attach to any process. The "Debug
Programs" right is initially granted to Administrators and should be only
granted to fully trusted users.
<P>
Also, if Getadmin.exe is run with an account that is already a member of
the administrators local group, it will still work (even after applying
the hotfix). This is by design. Members of the administrators group always
have the rights to make the calls GetAdmin needs in order to succeed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
A fix to the Windows NT Kernel routine which was being used to set the
global flag has been developed by Microsoft. This fix prevents an
application, such as Getadmin.exe, from attaching to WinLogon (or any
other process not owned by the user) and from granting administrative
rights to users.
<P>
To resolve this problem, obtain the hotfix below, or wait for the next
service pack.
<P>
This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/</A></B>
   hotfixes-postSP3/getadmin-fix

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Getadmin.exe must be executed locally and works for accounts on a
workstation or member server and for domain accounts on a primary domain
controller (PDC). The utility does not function on a backup domain
controller (BDC) because the account database on a BDC is read only. The
only way to use GetAdmin to modify a domain account database is to log on
to a primary domain controller and run the utility locally on the PDC.
<P>
For more information on Windows NT security, please see the following
Internet sites:

<UL><LI><B><A HREF="http://www.microsoft.com/security/">http://www.microsoft.com/security/</A></B>
<LI><B><A HREF="http://www.microsoft.com/ntserver/guide/securityupdate.asp">http://www.microsoft.com/ntserver/guide/securityupdate.asp</A></B>
<P>
</UL>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/">http://www.microsoft.com/</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 prodnt security hole breach<BR>
Keywords          : kbbug4.00 kbfix4.00 nt32ap ntsecurity NTSrvWkst kbfile kbnetwork<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
