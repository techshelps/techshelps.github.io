

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TCP/IP Upgrade from Windows NT 3.1 Requires User Interaction </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130961">
<META NAME="KBModify" CONTENT="1995/08/08">
<META NAME="KBCreate" CONTENT="1995/05/31">
<META NAME="Keywords" CONTENT="kbtool kbbug3.50">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  UNATTEND.TXT, included in the Resource Kit for Windows NT 3.5, implies that you can automatically upgrade a Windows NT 3.1 system to Windows NT 3.5 and have the system configured with dynamic host configuration protocol (DHCP). You can select to in...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QAC1,QDI2,QDIZ,QAA5,QBWD,QDNT,QBKX,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>TCP/IP Upgrade from Windows NT 3.1 Requires User Interaction</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 8, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130961</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Resource Kit version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
UNATTEND.TXT, included in the Resource Kit for Windows NT 3.5, implies that
you can automatically upgrade a Windows NT 3.1 system to Windows NT 3.5 and
have the system configured with dynamic host configuration protocol (DHCP).
You can select to install TCP/IP with DHCP using Setup Manager, but during
the setup process, if you choose to "Upgrade existing Windows NT
installation," the following warning message appears:
<P>
<PRE>   You have chosen to upgrade an existing Windows NT system. Setup will use
   the current system information and ignore parameters specified in the
   unattended answer file.

</PRE>This does not correlate with the information in the following sections
excerpted from the default UNATTEND.TXT file:
<P>
<PRE>   ; For unattended UPGRADES of Windows NT 3.1 and Windows NT Advanced
   ; Server 3.1, you may not need to specify an unattended answer file. You
   ; should specify an answer file if upgrading TCP/IP. For unattended
   ; upgrades, do:
   ;
   ;    winnt32 /u
   ;
   ; For unattended installation using winnt.exe or winnt32.exe do:
   ;
   ;    winnt[32] /u:&lt;script_file&gt; /s:&lt;source&gt;
      .
      .
      .
   ;[GuiUnattended]
   ;
   ; You need to define the !UpgradeEnableDhcp if you upgrade from Windows
     NT 3.1 to Windows NT Workstation v3.5. Specify for upgrades ONLY!
   ;
   ; !UpgradeEnableDhcp = YES | NO

</PRE>The section above implies that the switch, !UpgradeEnableDhcp, will be
set to YES in the script file for an unattended installation, thereby
automatically enabling DHCP during the upgrade.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Setup Manager does set !UpgradeEnableDhcp equal to YES. However, if you
didn't have TCP/IP installed under Windows NT 3.1, you will not have TCP/IP
installed after you upgrade to Windows NT 3.5. If you did have TCP/IP
installed, you are prompted during the upgrade process to configure TCP/IP
with a static IP address or with DHCP.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.5. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The help file for Windows NT Setup Manager includes the same incorrect
information as the UNATTEND.TXT file. Under the heading "Upgrading Windows
NT using an Unattended Answer File" it states that existing configuration
information for an upgrade will take precedence over settings in the
unattended answer file. The help file also states that this precedence
applies for network configuration information. However, the help file then
states:
<P>
<PRE>   The one exception to this case is the Enable DHCP entry which is used
   only during upgrades.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbbug3.50<BR>
KBSubcategory: ntreskit<BR>
Additional reference words: 3.50 prodnt reskit unattend.txt setupmgr dhcp<BR>
upgrade tcpip<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 8, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
