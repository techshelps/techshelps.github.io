

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Microsoft Exchange Client Unable to Print Message w/ Attachment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170516">
<META NAME="KBModify" CONTENT="1997/07/09">
<META NAME="KBCreate" CONTENT="1997/06/23">
<META NAME="Keywords" CONTENT="kbprint kbui ntprint NTSrvWkst ntui kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When a user chooses to print a mail message with a file attachment, the user may optionally choose to print the attachment as well. In cases where the user chooses to print the attachment, and the application responsible for printing the attachment...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWP,QA5T,QAY5,QAJH,QBF0,QAGI,QBWS,QARL,QAGB,QAYC,QBVV,QAR4,QAGU,QAEV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Microsoft Exchange Client Unable to Print Message w/ Attachment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170516</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a user chooses to print a mail message with a file attachment, the
user may optionally choose to print the attachment as well. In cases where
the user chooses to print the attachment, and the application responsible
for printing the attachment is running, the file attachment may not print
properly.
<P>
The user may see a message such as this:
<P>
<PRE>   Microsoft WordErr=1078
   This file could not be found.(C:\temp\document.doc)

</PRE><h2>CAUSE</h2>
 
<P>
On computers running Windows NT 3.51, the Microsoft Exchange client calls a
Windows NT system function that is responsible for printing the file
attachment using whatever application has registered itself to handle this
document (based on the attachment's file extension).
<P>
The Microsoft Exchange client saves the document attachment in a temporary
directory and calls the Windows NT system function, passing it the path to
the document to print.
<P>
If the application necessary for printing the document is not running, the
following operations are performed by the system function:

<OL><P><LI>The application necessary to print the document is started.

<P><LI>The application is passed information on the command-line regarding the
   name of the file to print.

<P><LI>The application is closed after printing is complete.
<P>
</OL>If the application necessary for printing the document is currently
running, the following operations are performed by the system function:

<OL><P><LI>The system function initiates a Windows DDE conversation with the
   application.

<P><LI>The application is asked (through DDE) to open, print, and close the
   document.
<P>
</OL>After the system call is performed, the Microsoft Exchange client deletes
the temporary file created for printing the attachment.
<P>
A race condition exists where, in the latter case (using DDE), the
temporary file is deleted BEFORE the application has had an opportunity to
print the document, which usually results in the application complaining
that the file is missing.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Close the application(s) that will be used to print the file attachments
before beginning the print operation.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SHELL32 printing print failure<BR>
Keywords            : kbprint kbui ntprint NTSrvWkst ntui kbfixlist<BR>
Version             : 3.51<BR>
Platform            : WINNT<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
