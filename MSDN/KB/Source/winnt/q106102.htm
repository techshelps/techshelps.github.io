

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Environment Vars in Logon Scripts on a Non-Windows NT Client </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106102">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1993/11/01">
<META NAME="Keywords" CONTENT="ntnetserv ntutil kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If you use Windows NT system environment variables in a logon script, those environment variables will not be correctly resolved when you attempt to log on to a non-Windows NT client.  MORE INFORMATION  Windows NT allows you to specify a logon scri...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDNQ,QAI5,QBW7,QBWO,QAX1,QARL,QA9A,QA5E,QAYL,QAM4,QDIR,QAGU,QBWF,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Environment Vars in Logon Scripts on a Non-Windows NT Client</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106102</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you use Windows NT system environment variables in a logon script,
those environment variables will not be correctly resolved when you
attempt to log on to a non-Windows NT client.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows NT allows you to specify a logon script as part of the profile
for each user name account on the domain and on the local computer.
Each time an attempt is made to log on with a particular user name,
the user name's associated logon script will execute. Within the logon
script, you may include Windows NT system environment variables.
However, if you attempt to log on to a Windows NT Advanced
Server-based domain from a non-Windows NT client, any Windows NT
system environment variables contained within the logon script will
not be resolved on the non-Windows NT client. This is expected
behavior because the Windows NT system environment variables are not
defined on the non-Windows NT client.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create the following logon script in any text editor and save it as
   TSTSCRPT.BAT:
<P>
<P><PRE>      echo off
      echo hello %USERNAME%
      echo thank you for logging on to %USERDOMAIN%
      pause
</PRE>
<P><LI>Using User Manager for Domains on a Windows NT Advanced Server
   Domain Controller, create a domain user account called 'Test' and
   modify the profile so that TSTSCRPT.BAT is specified as the Logon
   Script Name.

<P><LI>Log on to the domain from a client computer running a non-Windows
   NT networking operating system, such as LAN Manager or Windows for
   Workgroups 3.1. The logon script will execute and the following will
   be displayed on the screen:
<P>
<P><PRE>      hello
      thank you for logging on to
      Press any key to continue...
</PRE><P>
</OL>The environment variables %USERNAME% and %USERDOMAIN% will not be
resolved, thus leaving no information on the screen for those values.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt<BR>
Keywords          : ntnetserv ntutil kbnetwork<BR>
Version           : 3.1<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
