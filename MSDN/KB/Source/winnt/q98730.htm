

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Q&amp;A: Technical Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98730 ">
<META NAME="KBModify" CONTENT="1997/05/06">
<META NAME="KBCreate" CONTENT="1993/05/12">
<META NAME="Keywords" CONTENT="kbother ntgeneral">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The following information is also included in the Windows NT and Windows NT Advanced Server Frequently Asked Questions (FAQ) document that is available in the WINNT forum.  More information on this topic may be available from Microsoft Information ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWO,QDL9,QBWQ,QBWN,QAA1,QANE,QBVV,QAJH,QBWS,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Q&amp;A: Technical Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98730 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following information is also included in the Windows NT and Windows NT
Advanced Server Frequently Asked Questions (FAQ) document that is available
in the WINNT forum.  More information on this topic may be available from
Microsoft Information Services.  Microsoft Information Services are
available on the World Wide Web by connecting to <B><A HREF="http://www.microsoft.com">http://www.microsoft.com.</A></B>
The FTP site is located at ftp.microsoft.com.
<P>
This article contains the Technical
Information section, including the following topics:

<UL><LI>Couldn't Find NTLDR
<LI>How the LibPath Environment Variable Works
<LI>File Compression Programs and Drivers (Doublespace)
<LI>Troubleshooting 16-bit Windows Applications Under Windows NT
<LI>Using fault tolerance mirroring in Windows NT
<LI>OS/2 Subsystem Takes Priority
<LI>ANSI.SYS Support
<LI>Extended and Expanded Memory for MS-DOS Applications
<LI>Converting File Systems without Reformatting
<LI>Removal of NTFS
<LI>CHKDSK /F on an NTFS Drive
<LI>MS-DOS Device Drivers in CONFIG.SYS
<LI>Replacing Boot Sector Without Reinstalling
<LI>Microsoft Visual C++ (MMD.386 virtual device driver not loaded)
<LI>Microsoft Visual C++ (XXXX.EXE is not a valid Windows NT app.)
<LI>What is Win32s?
<LI>Recreating a Post Office
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Couldn't Find NTLDR</h3>
 
<P>
Question:
<P>
When I select Windows NT from Boot loader it comes up with the following
error:
<P>
<PRE>   BOOT: Couldn't find NTLDR
   Please insert another disk

</PRE>Answer:
<P>
In order for Boot loader to start NTLDR must be in the root of the C Drive.
If this file is missing you will get this error message. To fix this simply
copy the NTLDR from the CD or the Floppies to the root of the C drive. If
you are copying from the CD ROM, you will find NTLDR in the I386 directory
and can copy it by going to the CD ROM Drive and entering:
<P>
<PRE>   copy \i386\ntldr c:\

</PRE>Or, if you have a floppy installation set, you can find NTLDR as NTLDR.$ on
disk 2. To expand this file and copy it to the correct location, type the
following:
<P>
<PRE>   expand ntldr.$ c:\ntldr

</PRE><h3>How the LibPath Environment Variable Works</h3>
 
<P>
Question:
<P>
I used to use the LIBPATH environment variable to search for DLL files. The
environment variable is no longer available under Windows NT. What do I use
as a replacement?
<P>
Answer:
<P>
There is no Win32 or NT LIBPATH environment variable or Registry entry
under Windows NT. DLLs are found just like executable files (.EXE files) on
the path.
<P>
<P><h3>File Compression Programs and Drivers (Doublespace)</h3>
 
<P>
Question:
<P>
Is Windows NT compatible with my hard disk compression driver? Does Windows
NT support MS-DOS 6.0 Doublespace?
<P>
Answer:
<P>
You cannot place Windows NT on a partition with Stacker, DoubleSpace
(Microsoft MS-DOS 6.0) or any other compression or partitioning software.
In general, Windows NT will not be able to access data on a disk that
requires a driver in the CONFIG.SYS file for MS-DOS unless a similar driver
has been installed for Windows NT. Windows NT supports the MS- DOS FAT file
system and applications. It does not support Doublespace, the integrated
data compression technology available with MS-DOS 6.0. We are looking to
make this technology available in a future release of Windows NT.
<P>
<P><h3>Troubleshooting 16-bit Windows Applications Under Windows NT</h3>
 
<P>
Question:
<P>
My 16-bit Windows application is not working under Windows NT. What should
I do?
<P>
Answer:
<P>
Many different 16-bit applications designed to run under Windows 3.1 have
been tested with Windows NT. When you are troubleshooting a 16- bit
application that is not working properly under Windows, the following items
should be taken into consideration:

<UL><LI>If possible, verify that the application works correctly under Windows
   3.0 and 3.1.

<LI>If the application requires a VxD (virtual device driver), it will not
   work properly under Windows NT.

<LI>If the application requires Windows 3.0 or 3.1 to be running in 386
   enhanced mode, the application will not function properly on either the
   DEC Alpha or MIPS versions of Windows NT at this time because these
   platforms currently emulate only the Intel 80286 architecture.

<LI>Check Print Manager to see that a default printer has been selected.
   Some applications (such as Microsoft Word version 2.0 for Windows) will
   not function properly under Windows NT unless a default printer has been
   selected.

<LI>Make sure that any dynamic link libraries (DLLs) used by the application
   are both current and locatable by the application (either in the system
   path or explicitly defined within the application or working directory.)
<P>
</UL>Try other standard troubleshooting steps such as the following:

<UL><LI>Remove unnecessary device drivers

<LI>Remove unnecessary hardware

<LI>Boot with clean AUTOEXEC.NT and CONFIG.NT files

<LI>Use standard device drivers in Windows NT (Standard VGA, and so forth)
<P>
</UL><h3>Using fault tolerance mirroring in Windows NT</h3>
 
<P>
Question:
<P>
Why am I unable to choose the Establish Mirror or Stripe Set With Parity
options under Disk Administrator in Windows NT?
<P>
Answer:
<P>
Only Windows NT Advanced Server supports the hard disk fault tolerance
options of mirroring (which includes duplexing) and striping with parity.
<P>
<P><h3>OS/2 Subsystem Takes Priority</h3>
 
<P>
Question:
<P>
Why is that whenever I run my bound application it runs under the OS/2
subsystem and not the MS-DOS subsystem?
<P>
Answer:
<P>
Bound applications are designed and built so that they can be run under
either OS/2 or MS-DOS. The OS2 SubSystem is not available on MIPS,
therefore, bound applications will run as MS-DOS applications on MIPS.
<P>
When a bound application is run under Windows NT on an 80x86 CPU, it
automatically runs under the OS2 SubSystem if available.
<P>
The OS2 SubSystem is available by default on an 80x86. In order to force
bound applications to run as an MS-DOS application, use the FORCEDOS
command. It can be found in your \%SystemRoot%\system32 directory.
<P>
<P><h3>ANSI.SYS Support</h3>
 
<P>
Question:
<P>
Does Windows NT support the use of ANSI.SYS?
<P>
Answer:
<P>
Windows NT does support the use of ANSI.SYS for backward compatibility with
MS-DOS-based applications which require it. However, when you start a
Command Prompt, you are not running ANSI.SYS, so escape sequences do not
function.

<OL><P><LI>Add the following line to your CONFIG.NT file in your
   %SYSTEMROOT%\SYSTEM32 directory:
<P>
<P><PRE>      device=%systemroot%\system32\ansi.sys
</PRE>
<P><LI>Start a command prompt.

<P><LI>Run COMMAND.COM from MS-DOS 5.0. Note: This must be the version that
   comes with MS-DOS 5.0. If you just type COMMAND, the system starts
   another CMD.EXE from Windows NT. Check the version with the VER command.
   It should be "MS-DOS 5.00," not "Windows NT Version 3.10." Also,
   remember to include extra environment space if you are going to use the
   PROMPT variable.
<P>
</OL>You should now be able to send ANSI escape sequences. To test this, try the
following example:
<P>
<PRE>   prompt $e[J

</PRE></OL>This should clear the screen.
<P>
NOTE: When you type EXIT at the command prompt, only COMMAND.COM is exited;
you need to type EXIT a second time to close the Windows NT command prompt.
<P>
<P><h3>Extended and Expanded Memory for MS-DOS Applications</h3>
 
<P>
Question:
<P>
How do I give my MS-DOS applications extended or expanded memory?
<P>
Answer:
<P>
As with Windows 3.1, a program information file (PIF) can be created for
applications which need resources beyond those supplied to MS-DOS
applications by default. See Chapter 11 (Other Application Environments) in
the Windows NT System Guide for more information about using PIF files.
<P>
<P><h3>Converting File Systems without Reformatting</h3>
 
<P>
Question:
<P>
Can I convert my current file system to NTFS without reformatting the
drive?
<P>
Answer:
<P>
Yes. The command-line utility, CONVERT.EXE, can be used to convert existing
HPFS or FAT drives to the NTFS format. Note that no other conversions are
supported at this time. It is only possible to convert FAT or HPFS to NTFS.
To convert from NTFS back to FAT or HPFS, it is necessary to backup your
drive, reformat it, and then restore the files back to it.
<P>
For example: To convert drive "D:" from FAT to NTFS format, type the
following command:
<P>
<PRE>   convert d: /fs:ntfs

</PRE><h3>Removal of NTFS</h3>
 
<P>
Question:
<P>
How do I remove my NTFS partition from my C Drive?
<P>
Answer:
<P>
The CONVERT utility cannot change an NTFS-formatted drive to a drive
formatted by another file system. It is necessary to reformat an NTFS drive
in order to change the file system. If Windows NT is not installed on the
NTFS partition you are trying to remove, use the FORMAT command from a
Windows NT command prompt to change the file system, or use the Disk
Administrator to remove the partition directly.
<P>
Windows NT does not permit you to format the drive that it is installed on.
To reformat a drive containing Windows NT, do the following:

<OL><P><LI>Start Windows NT Setup.

<P><LI>Choose Custom Installation.

<P><LI>If Setup suggests a path in which to install Windows NT, press N to
   select a new location.

<P><LI> When Setup asks you to select the partition where you would like to
</OL>install Windows NT, choose the NTFS drive you want to reformat and press D
to delete the partition.

<OL><P><LI>Either continue from here using the setup program to recreate and format
   the partition or exit Setup and use the FDISK and FORMAT commands to
   complete the process.
<P>
</OL><h3>CHKDSK /F on an NTFS Drive</h3>
 
<P>
Question:
<P>
Why won't Windows NT let me run CHKDSK /F on NTFS formatted drives?
<P>
Answer:
<P>
There are two reasons for this:

<OL><P><LI>If you see the message
<P>
<P><PRE>      Cannot lock the current drive.
</PRE><P>
   make another drive current. For example, if you are trying to run CHKDSK
   /F on the D drive, make C current by typing "C:" and ENTER before
   issuing the CHKDSK command.

<P><LI>If you see the message
<P>
<P><PRE>      Cannot lock the drive for single user.
</PRE><P>
   it indicates that there are open files on the drive you are attempting
   to check. If Windows NT is not installed to the drive in question,
   simply be sure that all applications that might have files open on the
   drive are closed. If you have a page file on the drive, that too must be
   moved by using the Virtual Memory application in Control Panel. You
   should then be able to run CHKDSK with the /F option.
<P>
   If Windows NT is installed to the NTFS drive for which you are trying to
   run CHKDSK /F, then it will not be possible to fix errors without
   restarting Windows NT.
<P>
   When CHKDSK /F is unable to execute, it prompts the user with a message
   similar to the following:
<P>
<P><PRE>      Chkdsk cannot run because the volume is in use by another process.
      Would you like to schedule this volume to be checked the next time
      the system reboots? (Y/N)
</PRE><P>
   If you choose Y, CHKDSK /F is executed the next time Windows NT is
   started.
<P>
</OL><h3>MS-DOS Device Drivers in CONFIG.SYS</h3>
 
<P>
Question:
<P>
How do I load device drivers in CONFIG.SYS for my MS-DOS applications? Are
there drivers that I will not be able to load?
<P>
Answer:
<P>
You can only use device drivers in CONFIG.SYS that touch parts of the
system that are emulated by the Windows NT VDM (Virtual DOS Machine) code.
This is why ANSI.SYS works (because the display is an emulated device) but
ASPI drivers don't (since the hardware is not emulated.)
<P>
If you have some software that requires a device driver, it is likely that
the vendors who produced it need to write a VDD (Virtual Device Driver) for
that driver, and possibly a Windows NT Device Driver to support that VDD.
The information required to write these drivers can be found in the Windows
NT DDK.
<P>
<P><h3>Replacing Boot Sector Without Reinstalling</h3>
 
<P>
Question:
<P>
How do I replace my Windows NT boot sector without reinstalling Windows NT?
<P>
Answer:

<OL><P><LI>Boot from the floppy setup disk you used to install Windows NT.

<P><LI>Choose the option to use the emergency repair disk that was created
   during installation.

<P><LI>Be sure the option to "verify boot files on your C: drive" is selected.

<P><LI>Proceed with the repair operation.
<P>
</OL>If the Emergency Repair disk is not available, use the MKSECT.ZIP utility
which is available in Library 1 of the WINNT forum on CompuServe. If
neither of the above are options for you, reinstall Windows NT.
<P>
<P><h3>Microsoft Visual C++ (MMD.386 virtual device driver not loaded)</h3>
 
<P>
Question:
<P>
Why do I get the following error message when I run the Microsoft Visual
C++ compiler Windows NT?
<P>
<PRE>   MMD.386 virtual device driver not loaded.

</PRE></OL>Answer:
<P>
Visual C++ requires a driver in the SYSTEM.INI file which is specific to
Windows 3.1. You can not use the compiler in this fashion under Windows NT.
Please refer to the MSLANG forum for more information.
<P>
<P><h3>Microsoft Visual C++ (XXXX.EXE is not a valid Windows NT application)</h3>
 
<P>
Question:
<P>
Why do I get the following error message when I run a Microsoft Visual C++
utility under Windows NT?
<P>
<PRE>   XXX.EXE is not a valid Windows NT application.

</PRE>Answer:
<P>
Visual C++ applications require that you fix the executables in order for
them to run correctly under Windows NT. You can get the fix from Library l
of the MSLNG32 forum. The file is called B2FIX.EXE. It is a self-extracting
archive and contains instructions on how to use this utility to fix the
problem. This program is a NOT supported by Microsoft, but only provided so
that MSVC will operate properly under Windows NT.
<P>
<P><h3>What is Win32s?</h3>
 
<P>
Question:
<P>
I know what Win32 is but what is Win32s?
<P>
Answer:
<P>
Win32s is an operating system extension that allows Win32 applications for
Windows 95 and Windows NT to run on Windows 3.1 and Windows for Workgroups.
This is done by adding some extra DLLs to Win31 and keeping the differences
between Windows NT and Win31 in mind while writing your Win32s code (such
as preemptive multitasking, memory management, and security). Win32s also
includes a VxD. The Win32 SDK has more information on Win32s in its online
documentation.
<P>
<P><h3>Recreating a Postoffice</h3>
 
<P>
Question:
<P>
I deleted the WGPO subdirectory. I assumed that I would be able to recreate
it. It turned out to not be as easy as expected. Is there any way of
recreating my mail system short of reloading Windows NT?
<P>
Answer:
<P>
Yes, by editing the Registry database. CAUTION: Before editing the Registry
database, you might want to back up (export) any mail you want to retain
before proceeding with the following:

<OL><P><LI>Using File Manager, delete the postoffice directory and all
   subdirectories in it. The default name of the Windows NT  postoffice
   directory is WGPO and it can be located in the root  directory or a
   subdirectory of any available partition on the hard  disk drive.
<P>
</OL>WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Start Registry Editor (REGEDT32.EXE) and select the following subkey to
   highlight it:
<P>
<P><PRE>      HKEY_CURRENT_USER\Software\Microsoft\Mail\Custom Commands
</PRE><P>
<P><PRE>      HKEY_CURRENT_USER\Software\Microsoft\Mail\Custom Messages
</PRE><P>
<P><PRE>      HKEY_CURRENT_USER\Software\Microsoft\Mail\Microsoft Mail
</PRE>
<P><LI>Press the DELETE key on your keyboard, or choose Delete from the Edit
   menu, and then press ENTER to confirm the action. One subkey at a time.
<P>
</OL>The next time you start MS Mail, you will have the option of connecting to
an existing postoffice, or creating a new postoffice, and then continuing
with the rest of the initial MS Mail setup.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt Q&amp;A post office<BR>
Keywords            : kbother ntgeneral<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
