

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Disk Administrator Corrupts Partitions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135308">
<META NAME="KBModify" CONTENT="1997/03/21">
<META NAME="KBCreate" CONTENT="1995/08/20">
<META NAME="Keywords" CONTENT="kbbug3.51 kbfix3.51.sp2 kbother ntboot ntfault ntfilesys ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAR4,QBWU,QBVV,QAH5,QA2H,QAC9,QAAP,QAFV,QBJQ,QAYY,QAYV,QBWS,QAV1,QAV0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Disk Administrator Corrupts Partitions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135308</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
 ---------------------------------------------------------------------
<P>
</UL><h2>SYMPTOMS</h2>
 
<P>
When you install Windows NT 3.51 and start Disk Administrator for the
first time, Windows NT will write a disk signature to the drives before
opening the Disk Administrator window.
<P>
The first time Disk Administrator is opened, drives and partitions appear
correctly, but if you close and reopen it, some of the partitions are lost
and incorrect information is displayed on the others. Alternatively, Disk
Administrator can hang during initialization or the error message, "The
parameter is incorrect" appears.
<P>
This only happens if there are more than two logical drives in an extended
partition when Disk Administrator attempts to write a fault tolerance
signature.
<P>
This problem will not occur if a signature is already present.
<P>
Another symptom of this problem is that any partition formatted as Windows
NT File System (NTFS) will show 0 bytes available and 0 bytes free after
the signature was written by WINDISK, but before the first reboot after the
signature was written.
<P>
<P><h2>CAUSE</h2>
 
<P>
Windows NT Disk Administrator writes a fault tolerance signature to each
physical drive's master boot record, if one is not already present, when it
is run for the first time. Faulty calculations result in the corruption of
logical drives in an existing extended partition.
<P>
NOTE: It is possible for a system to remain functional after the partition
table is corrupted. The nature of the corruption is such that partition
table data is written to incorrect locations on the disk which may lie in
the middle of user or file system data. Provided this information is not
overwritten, the partition table entries may still identify the layout of
the drives sufficiently well that Windows NT can continue to access the
drives. However, this is an unstable situation and access to the partitions
will be lost when the table entries are eventually overwritten.
<P>
If the table entries overwrite existing data, user data or file system
integrity are compromised immediately.
<P>
If you suspect that your partition table is compromised, immediately back
up critical data, then re-partition your disk and restore the backed up
data to the system.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem:

<UL><LI>Install the latest U.S. Service Pack for Windows NT version 3.51.
<P>
   -or-

<LI>If your system has already been corrupted, but Windows NT still boots,
   obtain the file CORRECT.EXE to correct the partition table whenever
   possible.
<P>
   CORRECT.EXE does not guarantee recovery of user data, it just means that
   the partition table is put back in its original state if possible, or at
   least a consistent state if there is not enough information to put it
   back in its original state. In the mean time, critical user or file
   system data may still have been irretrievably lost.
<P>
   This program is also being distributed with the hotfix and both the
   fixed kernel and CORRECT.EXE are being posted to our external FTP server
   as well. Again, this is an unusual step that we are taking due to the
   seriousness of the problem.
<P>
   For more information read the README.TXT file posted with CORRECT.EXE.
<P>
   All files discussed here are publicly available from ftp.microsoft.com
   under:
<P>
<P><PRE>      \bussys\winnt\winnt-unsup-ed\fixes\nt351\windisk
</PRE><P>
</UL><h3>To Prevent Partition Table Corruption</h3>
 
<P>
If Disk Administrator has not been run, you can prevent partition table
corruption by any of these 3 procedures:

<UL><LI>If there are not already more than two logical drives in an extended
   partition, simply use Disk Administrator normally. The signature will be
   written correctly and no corruption should ensue. If there are more than
   two logical drives, perform a full system backup of data on all drives
   prior to running Disk Administrator. Then be prepared to delete and
   recreate the partition structure prior to restoring the previously
   backed up data.

<LI>If an earlier version of Windows NT is available, boot that version and
   run its Disk Administrator so that a fault tolerance signature is
   written to the disk. The 3.5 version of WINDISK.EXE may be run directly
   on Windows NT version 3.51 in order to write the initial fault tolerance
   signature, but is not recommended for systems using third-party
   partitioning software to support large IDE drives.

<LI>If you have the tools and knowledge to edit the disk at the sector
   level, you may manually enter a disk signature so that Disk
   Administrator will not try to do so. The 4-byte signature is located at
   offset 0x1b8 from the start of the Master Boot Record (physical sector
   0). The value written is not important provided that it is non-zero, but
   if there are multiple disks in the system, each should have a distinct
   signature value. If this field is already non-zero, it is not necessary
   to change it.
<P>
   CAUTION: Use this option at your own risk. Incorrectly editing physical
   disk sectors can result in corruption of the entire physical volume,
   resulting in loss of data and may require a complete reinstallation of
   the operating system.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51.
This problem has been corrected in the latest U.S. Service Pack for Windows
NT version 3.51. For information on obtaining the Service Pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt fdisk mbr<BR>
Keywords            : kbbug3.51 kbfix3.51.sp2 kbother ntboot ntfault ntfilesys ntutil<BR>
Version             : 3.51<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 21, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
