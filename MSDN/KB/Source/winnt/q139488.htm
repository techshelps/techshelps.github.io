

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Setup Windows NT SNMP Performance Counter Agent Extension </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139488">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1995/11/12">
<META NAME="Keywords" CONTENT="NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article explains how to setup the Windows NT SNMP Performance Counter Agent extension provided in Windows NT Resource Kit versions 3.51 and 4.0. This agent extension makes the performance data counters available through SNMP.  MORE INFORMATION...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBKX,QALX,QAM9,QAY5,QAU3,QAMR,QAOG,QDL9,QBWQ,QBWO,QBWN,QAUJ,QAH6,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Setup Windows NT SNMP Performance Counter Agent Extension</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139488</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
<LI>Microsoft Windows NT Resource Kit versions 3.51 and 4.0
<LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to setup the Windows NT SNMP Performance Counter
Agent extension provided in Windows NT Resource Kit versions 3.51 and 4.0.
This agent extension makes the performance data counters available through
SNMP.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To get the Memory, Processor, Network Segment, and PhysicalDisk Performance
Monitor counters via SNMP, you can run Perfm.bat, provided in the Windows
NT Resource Kit version 4.0, or use the following steps:

<OL><P><LI>Create a PERFMIB.INI configuration file with PERF2MIB.EXE:
<P>
   - This file specifies the performance counters to expose through SNMP
<P><PRE>     and the Object Ids (OID) to access them.
</PRE><P>
   - Execute the following command:
<P>
<PRE>        PERF2MIB MEM.MIB %systemroot%\SYSTEM32\PERFMIB.INI Memory 300 mem
        (continued line)  Processor 302 proc

   - PERF2MIB creates a PERFMIB.INI file with Memory and Processor
     counters. The MEM.MIB file is also created. MEM.MIB can be used by
     SNMP management tools to get the counters OID.

   - The PERFMIB.INI file must reside in the same default directory as the
     SNMP.EXE process, otherwise the Perfmib DDL initialization fails.

</PRE><P><LI>For Windows NT 4.0:
<P>
<P><PRE>    - Register Perfmib.reg in the Registry (in case you do not wish to
      create it, Perfmib.reg has been provided on the Resource Kit CD).
      This can be performed by creating the following keys with Registry
      Editor (Regedit.exe or Regedt32.exe) or by copying the following
      registry information into a file called Perfmib.reg and running
      "regini perfmib.reg" (Regini.exe is a utility in the Resource Kit).
</PRE><P>
   For Windows NT 3.51:
<P>
   Modify the registry settings to use this extension DLL:
<P>
<P><PRE>      a. Run Registry Editor (REGEDT32.EXE).
</PRE><P>
<P><PRE>      b. From the HKEY_LOCAL_MACHINE subtree, go to the following key:
</PRE><P>
<PRE>            \System\CurrentControlSet\Services\SNMP
            \Parameters\ExtensionAgents

      c. Create a new value entry:

            Name:   3
            Type:   REG_SZ
            Data:   SOFTWARE\Microsoft\Perfmib\CurrentVersion

      d. Create a new key and new value to get the dll name:

            Subtree:    HKEY_LOCAL_MACHINE
            Key Name:   \Software\Microsoft\Perfmib\CurrentVersion
            Name:       Pathname
            Type:       REG_EXPAND_SZ
            Data:       %SystemRoot%\System32\perfmib.dll

         NOTE: Copy this Perfmib.dll from the Resource Kit to the system
         directory.

</PRE><P><LI>Start the SNMP service.

<P><LI>Add Perfmib.mib to your management station using the method provided
   by the manufacturer of your management station.

<P><LI>Collect performance counters. For example to get the memory counters
   information with snmputil tool, issue the following command:
<P>
   SNMPUTIL walk agent public&lt;space&gt;.iso.org.dod.internet.private
   (continued line)  .enterprises.microsoft.software.1.3.1.1.300.
<P>
   where &lt;space&gt; is a blank space (press spacebar).
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt tcpip<BR>
Keywords          : NTSrvWkst nttcp kbnetwork<BR>
Version           : 3.51 4.0<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
