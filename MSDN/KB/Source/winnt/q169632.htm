

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Unattended Err Msg: Setup Was Unable to Create the Following... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169632">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1997/06/05">
<META NAME="Keywords" CONTENT="ntsetup NTSrv NTWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When performing an unattended installation in which Sysdiff is used to install additional applications, you may receive the following error message during the initial phase of the installation:     Setup was unable to create the following directory...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QBXB,QATJ,QAUJ,QAA1,QDI2,QAH4,QABI,QDJ2,QDJS,QAB4,QAC9,QARM,QAKC,QAWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unattended Err Msg: Setup Was Unable to Create the Following...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169632</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When performing an unattended installation in which Sysdiff is used to
install additional applications, you may receive the following error
message during the initial phase of the installation:
<P>
<PRE>   Setup was unable to create the following directory on the target drive:

   &lt;drive letter&gt;:\$\$$\&lt;directory path&gt;

   Check the target drive and make sure no files exist with the names that
   coincide with the target directory. Also check cabling to the drive.

   Setup cannot continue. Press ENTER to exit.

</PRE><h2>CAUSE</h2>
 
<P>
If you have verified that your drive cabling is functioning properly and
there are no duplicate directory or file names, this error may be
caused by the length of your directory path. The maximum number of
characters allowed in the directory path is 55; this does not include
the drive letter, colon, or any backslashes.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Two options are provided to work around this problem. Option B requires
more advanced knowledge of Sysdiff and the unattended installation process.
<P>
<P><h3>Option A</h3>
 

<OL><P><LI>Note the directory path shown on the screen when you receive this error.

<P><LI>On the computer that you are using to create the Sysdiff or diff file,
   either shorten the directory names, or move the directories in order to
   shorten the length of the path. If the directory that is causing the
   problem contains a software program, you may have to remove and re-
   install the program to a new, shortened directory path.
<P>
   Keep in mind that the Sysdiff program will truncate each directory name
   to eight characters. (Refer to the directory path from step 1.)
   Therefore, if you shorten the directory names, you must shorten them to
   fewer than eight characters.
<P>
   If the original directory is a subdirectory of the %Systemroot%
   directory (that is, C:\Winnt\&lt;path&gt;), the maximum number of characters
   cannot exceed 52. If the original directory is a subdirectory of the
   root partition (that is, D:\&lt;path&gt;), the maximum number of characters
   cannot exceed 53.

<P><LI>After you have shortened the directory path to contain less than the
   maximum number of characters, you must re-create the Sysdiff or diff
   file and the Sysdiff or inf image.
<P>
</OL><h3>Option B</h3>
 

<OL><P><LI>Note the directory path shown on the screen when you receive this error.

<P><LI>Locate this directory path in your $Oem$ subdirectory of the I386 share,
   and modify the length of the path by shortening the directory names to
   fewer than eight characters each.
<P>
   You need to shorten only as many directory names as required to reduce
   the length of the entire path to the maximum allowed characters. If the
   problem is with a subdirectory of the $Oem$\$$ directory, the maximum is
   52. If it is a subdirectory of $Oem$\C or $Oem$\D, then the maximum is
   53 characters, as counted from the first character following the $$ or
   the drive letter, not counting the backslashes.

<P><LI>Modify the $$Rename.txt file from the appropriate location (that is,
   $Oem$\$$\$$Rename.txt or $Oem$\c\$$Rename.txt) to reflect the
   modifications you made to the actual directory path in step 2 above.
<P>
   The $$Rename.txt file is used to rename the truncated directory and file
   names to their original names before the Sysdiff program truncated them
   to the MS-DOS 8.3 format.
<P>
   Be sure to make a copy of the $$Rename.txt file and review the existing
   format carefully before making any changes. A section header, which is
   the parent directory enclosed in brackets, must precede each directory
   that needs to be renamed. For example:
<P>
 The directory path
 $Oem$\$$\Profiles\Alluse~1\Startm~1\Programs\Myprog~1 needs to be
 renamed C:\Winnt\Profiles\All Users\Start Menu\Programs\My Programs.
<P>
 The $$Rename.txt file should appear as follows:
<P>
<P><PRE>    [Profiles]
    ALLUSE~1="All Users"
</PRE><P>
<P><PRE>    [Profiles\ALLUSE~1]
    STARTM~1="Start Menu"
</PRE><P>
<P><PRE>    [Profiles\ALLUSE~1\STARTM~1\Programs]
    Myprog~1="My Programs"
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: unattend sysdiff<BR>
Keywords          : ntsetup NTSrv NTWkst kbsetup<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
