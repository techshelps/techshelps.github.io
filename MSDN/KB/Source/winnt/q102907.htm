

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Troubleshoot Local Logon Scripts with Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102907">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/08/12">
<META NAME="Keywords" CONTENT="kbnetwork ntnetserv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article contains a checklist of potential problems with local logon scripts. A logon script is similar to a batch file because it performs a series of commands when a user logs in to his or her account.  MORE INFORMATION  If problems arise wit...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAI5,QABI,QBWP,QBWO,QA9A,QBW7,QAB4,QAFI,QAKP,QBXB,QATJ,QBW3,QAA1,QAOG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Troubleshoot Local Logon Scripts with Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102907</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains a checklist of potential problems with local
logon scripts. A logon script is similar to a batch file because it
performs a series of commands when a user logs in to his or her
account.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If problems arise with a logon scripts, use the following list to
troubleshoot the problem:

<UL><LI>Make sure the logon script is in the following directory:
<P>
<P><PRE>      \winnt\system32\repl\import\scripts
</PRE><P>
   The only valid path option is a subdirectory of the default logon
   script directory. A path to any other directory or using the
   environment variable %HOMEPATH% will cause the logon script to
   fail.

<LI>If the file system on the partition containing the logon script
   directory is NTFS, make sure the user has read rights to the logon
   script directory. If no rights have been explicitly assigned, the
   logon script may fail without providing an error message.

<LI>Make sure the logon script has a filename extension of either
   "CMD" and "BAT." A script with any other extension will fail. The
   "EXE" extension is also supported, but only for genuine executable
   programs.
<P>
   Attempting to use the .EXE extension for a script file will result
   in the following error message:
<P>
<P><PRE>      NTVDM CPU has encountered an illegal instruction.
</PRE><P>
   To remove the error, terminate the application or the virtual
   MS-DOS machine (VDM).

<LI>If the logon script is to be set up for a Windows for Workgroups
   computer, the Windows for Workgroups computer must have the Windows NT
   domain specified in the LAN Manager domain portion of Control Panel
   networks, rather than just assigned to that workgroup.

<LI>It will take a period of time for a recently created logon script to be
   replicated from the Primary Domain Controller to all the member servers.
   Thus, if a workstation is validated by a server other than the Primary
   Domain Controller, recently created logon script changes may not be in
   effect.

<LI>Use Server Manager to view a list of Backup Domain Controller in the
   domain. On EVERY Backup Domain Controller in the domain, verify that
   replication is enabled and that the netlogon share contains current
   logon scripts.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt tshoot<BR>
Keywords            : kbnetwork ntnetserv<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
