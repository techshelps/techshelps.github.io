

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DHCP: Spanning Multiple Subnets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120932">
<META NAME="KBModify" CONTENT="1997/12/23">
<META NAME="KBCreate" CONTENT="1994/09/23">
<META NAME="Keywords" CONTENT="NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  A DHCP (Dynamic Host Configuration Protocol) server can provide IP addresses to clients spanning multiple subnets if the router that separates them can act as an RFC 1542(BOOTP) relay agent. If the router cannot function as relay agent, each subnet...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QDJG,QAC2,QARL,QAH6,QAGI,QAEV,QBWO,QAR5,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DHCP: Spanning Multiple Subnets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120932</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft TCP/IP-32 for Windows for Workgroups version 3.11
<LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A DHCP (Dynamic Host Configuration Protocol) server can provide IP
addresses to clients spanning multiple subnets if the router that
separates them can act as an RFC 1542(BOOTP) relay agent. If the router
cannot function as relay agent, each subnet that has DHCP clients requires
a DHCP server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A relay agent that conforms to RFC 1542 relays DHCP packets to the remote
side even though they are broadcast packets. Before relaying a DHCP
message from a DHCP client, the agent examines the GIADDR (gateway IP
address) field. If the field has an IP address of 0.0.0.0, the agent fills
it with the router's IP address. When the DHCP server receives the
message, it examines the Relay IP Address field to see if it has a DHCP
scope (a pool of IP addresses) that can be used to supply an IP address
lease. If the DHCP server has multiple DHCP scopes, the address in the
Relay IP Address field identifies the DHCP scope from which to offer an IP
address lease. This process allows one DHCP server to manage different
scopes for subnets.
<P>
You can use a multihomed Windows NT Server 3.5x system configured as a
DHCP server, with multiple network cards and IP routing enabled, instead
of a relay agent for subnetting purposes.
<P>
When it receives the DHCPDISCOVER message, the DHCP server sends a
DHCPOFFER directly to the relay agent identified in the GIADDR field, and
the agent relays the message to the DHCP client. The client's IP address
is still unknown, thus it has to be a broadcast on the local subnet.
Similarly, a DHCPREQUEST message is relayed from client to server and a
DHCPACK message is relayed from server to client, according to RFC 1542.
<P>
When you have multiple DHCP servers, Microsoft recommends that you place
your DHCP servers on different subnets to achieve a degree of fault
tolerance, rather than having all the DHCP servers in one subnet. The
servers should not have common IP addresses in their scopes (each server
should have a unique pool of addresses).
<P>
If the DHCP server in the local subnet goes down, requests are relayed to
a remote subnet, and the DHCP server there can respond to DHCP requests
if it maintains a scope of IP addresses for the requesting subnet. If the
remote server has no scope defined for the requesting subnet, it cannot
provide IP addresses, even if it has available addresses for other scopes.
If each DHCP server has a pool of addresses for each subnet, then it can
provide IP addresses for remote clients whose DHCP server is down.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodtcp32 wfw wfwg prodnt<BR>
Keywords          : NTSrvWkst nttcp kbnetwork<BR>
Version           : 3.5 3.51 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
