

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SFM Print Service is Limited to 127 Printers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136151">
<META NAME="KBModify" CONTENT="1998/01/08">
<META NAME="KBCreate" CONTENT="1995/09/04">
<META NAME="Keywords" CONTENT="ntmac ntprint NTSrv kbprint">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Macintosh clients cannot print to printers shared by Windows NT Services for Macintosh (SFM) print servers. The following error message appears on the Macintosh client:     A communication error has occurred.  The following error is logged in the e...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWP,QDO9,QBTX,QACK,QAI5,QBG2,QARL,QACT,QAB4,QBWS,QA3A,QA1S,QBW7,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SFM Print Service is Limited to 127 Printers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136151</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Macintosh clients cannot print to printers shared by Windows NT Services
for Macintosh (SFM) print servers. The following error message appears on
the Macintosh client:
<P>
<PRE>   A communication error has occurred.

</PRE>The following error is logged in the event log on the Windows NT SFM
Server:
<P>
<PRE>   Macprint Event ID 2019 - Semaphore timeout.

</PRE>Macintosh clients may also be unable to see the shared SFM printers.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem is caused by an AppleTalk Printer Access Protocol (PAP)
limitation.
<P>
In response to a connection request from a Macintosh client, Windows NT
sends the socket on which the client can respond. When there are more than
127 printers shared on a Windows SFM server, Windows NT will exhaust the
range of available sockets on the first node, and then move to the next
node (a node is a set of sockets.) But there is no provision in the
protocol to tell the client which node to use. The client continues to use
the first node, but uses the new socket. That pair corresponds to some
other printer, which drops the request and causes the errors.
<P>
This is a limitation in Apple's design of Appletalk.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
A workaround exists that involves creating a service account specifically
for Print Services for Macintosh and then denying that account access to
certain printers using the Control Panel Printers tool. This will disallow
Print Services for Macintosh access to share specified printers for
Macintosh clients only.
<P>
To accomplish this, perform the following steps:

<OL><P><LI>On the Windows NT SFM server, create an account in User Manager to use
   as a service account for Print Services for Macintosh. Click to clear
   the "User must change password at next logon" checkbox and select the
   Password never expires checkbox. Specify a desired password.

<P><LI>Start the Control Panel Services tool. Click Startup for Print Services
   for Macintosh. Click This account and specify the macprint account and
   password information created in Step 1.

<P><LI>Start the Control Panel Printers tool. Right-click on the printer(s)
   that SFM should not share. Click Properties, and then click the Security
   tab. Click Permissions, and then select No Access for the macprint
   account.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MAC<BR>
Keywords          : ntmac ntprint NTSrv kbprint<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
