

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing LPR Ports with Windows NT 4.0 Unattended Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159451">
<META NAME="KBModify" CONTENT="1997/03/28">
<META NAME="KBCreate" CONTENT="1996/11/14">
<META NAME="Keywords" CONTENT="kbsetup ntdriver ntreskit ntsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Although there is an option in the Unattended Setup to install TCP/IP printing, there is no option available to actually install the LPR port. To install the LPR port in an unattended method, the OEMPreinstall features of unattend must be used.  MO...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDJP,QAKG,QBWP,QBWD,QDIZ,QBTX,QAFI,QBC9,QBC8,QANO,QAOX,QDNT,QDJ4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Installing LPR Ports with Windows NT 4.0 Unattended Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159451</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 4.0
<LI>Microsoft Windows NT Server versions 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although there is an option in the Unattended Setup to install TCP/IP
printing, there is no option available to actually install the LPR port. To
install the LPR port in an unattended method, the OEMPreinstall features of
unattend must be used.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To install LPR ports on a system, the user must be a member of the
administrator group. An advantage of installing LPR ports during an
unattended setup is that the administrator is not required to log on to
each workstation to install the port. A disadvantage of this procedure is
that each different LPR port configuration required for the workstations
will need a separate installation point on the network. Each installation
point requires about 80 MB of disk space.
<P>
To install an LPR port (or ports), perform the following steps:

<OL><P><LI>Install Microsoft TCP/IP Printing on a Windows NT Workstation or Server
   through Control Panel, Network, Services.

<P><LI>After restarting the computer, install the LPR ports with the correct IP
   addresses and desired names through Control Panel, Printer, File, Server
   Properties.

<P><LI>Open Regedit.exe (not Regedt32.exe) and go to the
<P>
<P><PRE>      HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Control/Print/Monitors/
      LPR Ports/Ports
</PRE><P>
   subkey. Under Ports, select the IP address and name of the printer you
   just installed. Click Registry/Export Registry File from the menu. Save
   it as Lpr.reg. Do this with each LPR port you have installed, making
   sure to give each .reg file a unique name. Close REGEDIT.

<P><LI>Go to the network installation point for Windows NT. Create a
   subdirectory under i386 labeled $oem$. Copy Regedit.exe and the .reg
   files created in step 3 to this directory.

<P><LI>Create a text file in the $oem$ directory using Edit.com called
   Cmdlines.txt. Add these lines, including quotation marks:
<P>
<P><PRE>      [Command]
      ".\regedit /s .\lpr.reg"
</PRE><P>
   Add an additional line for each port you are installing with the
   appropriate .reg file name.

<P><LI>Modify the Unattend.txt file using Edit.com to do an OEMPreinstall and
   automatically install TCP/IP protocol and TCP/IP printing.

<P><LI>Run setup from the i386 directory with the following command line:
<P>
<P><PRE>      winnt /b /s:&lt;sourcefiledir&gt; /u:&lt;unattend file name&gt;
</PRE><P>
   This procedure will install the LPR ports created in Step 2.
<P>
</OL><h3>Additional Information</h3>
 
<P>
The example provides only part of the answer file needed for a complete
Windows NT 4.0 unattended installation.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q155197.htm">Q155197</A></B>
   TITLE     : Unattended Setup Parameters for Unattend.txt File
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbsetup ntdriver ntreskit ntsetup<BR>
Version             : 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
