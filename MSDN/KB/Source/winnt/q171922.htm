

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Local Network Access Fails Or Is Slow After PPTP Connection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171922">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/07/24">
<META NAME="Keywords" CONTENT="ntnetserv ntrouter NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  You may experience slow connections and performance or even loss of connectivity on your local area network (LAN) after you have made a Point- to-Point Tunneling Protocol (PPTP) connection to a Windows NT 4.0 PPTP server.  CAUSE =====  Windows NT 4...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAM5,QDJ0,QANE,QAVZ,QBWP,QBWE,QBE7,QBE6,QAI5,QBWD,QBVW,QARL,QABA,QBG2,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Local Network Access Fails Or Is Slow After PPTP Connection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171922</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may experience slow connections and performance or even loss of
connectivity on your local area network (LAN) after you have made a Point-
to-Point Tunneling Protocol (PPTP) connection to a Windows NT 4.0 PPTP
server.
<P>
<P><h2>CAUSE</h2>
 
<P>
Windows NT 4.0 PPTP clients add an incorrect local subnet route to their
route tables when they connect to a PPTP server that is using the same IP
network ID.
<P>
For example, the client and the server are both on LAN subnets of a class
B address such as 172.16.0.0, using a 255.255.255.0 subnet mask. The
server is on the 172.16.1.0 subnet and the client is on the 172.16.2.0
subnet. When the client connects through PPTP, it adds a route to the
172.16.0.0 network with a gateway of the PPTP server to its route table,
which increases the time it takes to locate LAN resources.
<P>
NOTE: If the PPTP server has no route to the PPTP client's subnet, the
client will not be able to connect to its local subnet.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this issue, use the following steps:

<OL><P><LI>Disable Use Default Gateway on Remote Network for the phone book entry
   that you use to dial the PPTP server.
<P>
   NOTE: If Use Default Gateway on Remote Network is not checked, the bad
   local subnet route is not added.

<P><LI>Delete the existing default gateway (if one exists) by typing the
   following at a command prompt:
<P>
<P><PRE>      Route delete 0.0.0.0
</PRE>
<P><LI>Dial your PPTP phone book entry to make the connection to your PPTP
   server.

<P><LI>Add a new default gateway to the PPTP network by typing the following
   at a command prompt:
<P>
<P><PRE>      Route add 0.0.0.0 mask 0.0.0.0 X.X.X.X
</PRE><P>
   Where X.X.X.X is your client's IP address assigned by the PPTP server.

<P><LI>After you disconnect, re-add your local default gateway by typing the
   following command at a command prompt:
<P>
<P><PRE>      Route add 0.0.0.0 mask 0.0.0.0 Y.Y.Y.Y
</PRE><P>
   Where Y.Y.Y.Y is the IP address of the default gateway, or router, on
   your LAN.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: steelhead<BR>
Keywords          : ntnetserv ntrouter NTSrvWkst nttcp kbnetwork<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
