

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Network Access Validation with Windows for Workgroups </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103028">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1993/08/16">
<META NAME="Keywords" CONTENT="ntnetserv kbnetwork kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Windows for Workgroups 3.1 does not provide domain information when it issues network commands. The following is an example of how Windows NT Advanced Server treats Windows for Workgroups 3.1 clients in this situation.  Example -------  I am logged...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QAM4,QA9A,QAVZ,QBG2,QAI5,QBW3,QAWK,QDL9,QBWQ,QBWN,QARL,QAGU,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Network Access Validation with Windows for Workgroups</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103028</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows for Workgroups version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows for Workgroups 3.1 does not provide domain information when it
issues network commands. The following is an example of how Windows NT
Advanced Server treats Windows for Workgroups 3.1 clients in this
situation.
<P>
<P><h3>Example</h3>
 
<P>
I am logged on to my Windows NT workstation and a Windows for
Workgroups 3.1 system with the same account and password. The account
and password match the one in SCRATCH-DOMAIN (the Advanced Server
domain). I can successfully NET USE a share on \\NET (Advanced Server
that is a trusted domain of SCRATCH-DOMAIN) from my Windows for
Workgroups 3.1 system but the same command fails under Windows NT. The
Windows NT client receives the error message "System error 1326 has
occurred. Logon failure: unknown user name or bad password."
<P>
<P><h3>Configurations</h3>
 
<P>
Windows for Workgroups 3.1 workstation:

<UL><LI>Login account: USER1
<LI>Password:      PSW1
<LI>Login Domain:  N/A
<P>
</UL>Windows NT workstation:

<UL><LI>Login account: USER1
<LI>Password:      PSW1
<LI>Login Domain:  LOCAL1. Not logged on to Advanced Server domain.
<P>
</UL>Advanced Server for Windows NT:

<UL><LI>Server Name: NET
<LI>Advanced Server Domain: NET-DOMAIN
<LI>Trust:  NET-DOMAIN Trust SCRATCH-DOMAIN (Therefore, accounts on
   SCRATCH-DOMAIN can be granted permissions in the NET-DOMAIN.)
<LI>Domain Account Database for NET-DOMAIN does NOT contain an
   account for USER1.
<LI>Guest Account is DISABLED.
<P>
</UL>Advanced Server for Windows NT:

<UL><LI>Server Name:                       SCRATCH
<LI>Advanced Server Domain:            SCRATCH-DOMAIN
<LI>Domain Database contains account:  USER1
<LI>Domain Database contains password: PSW1
<P>
</UL>In this example, the Windows NT workstation is logged on to its local
workstation domain--not the domain of the Advanced Server. The Windows
for Workgroups 3.1 system is not logged on to any domain.
<P>
We should first cover some important technical background information.
When two Microsoft network systems communicate over a network, they
use a high-level protocol called server message block (SMB). These
commands are embedded in the transport protocols like NetBEUI or
TCP/IP. When a client executes a NET USE command, it sends out an SMB
Session Setup frame.
<P>
In Windows NT, the Session Setup SMB (0x73) includes the user account,
encrypted password, and login domain. An Advanced Server will look at
all of this information to determine if the client has permissions to
complete the NET USE command. Windows for Workgroups 3.1 includes only
account and password information--no domain name.
<P>
The Windows for Workgroups 3.1 client does the following:

<UL><LI>Windows for Workgroups 3.1 client carries out the
   NET USE X: \\NET\share command.
<LI>A Windows for Workgroups 3.1 client includes only the user account
   "USER1" and encrypted password "PSW1." It does not include any domain
   information.
<LI>\\NET looks at the domain name in the SMB and realizes that it is
   NULL or does not exist.
<LI>The Advanced Server then attempts to validate the account information
   on its own SAM (Security Account Manager) domain database, NET-DOMAIN.
   This is done just like the client had specified the domain name of the
   Advanced Server.
<LI>\\NET fails to find a matching account "USER1" in its domain account
   database because it does not exist.
<LI>It then systematically and simultaneously checks all domains that it
   trusts until one responds.
<LI>SCRATCH-DOMAIN is selected because NET-DOMAIN trusts it.
<LI>\\SCRATCH is a Domain Controller and looks in the Domain database and
   finds an account "USER1" that matches the SMB account "USER1."
<LI>\\NET asks \\SCRATCH to perform pass-through authentication of the user
   account.
<LI>The SMB account "USER1" and password "PSW1" are now compared to the
   SAM Domain on the trusted server \\SCRATCH.
<LI>The passwords match so the "Command Completes Successfully" message
   is generated.
<P>
</UL>The Windows NT client does the following:

<UL><LI>Windows NT client carries out the NET USE X: \\NET\share command.
<LI>The Windows NT client is logged on to the local workstation domain.
<LI>It did not log on to the Advanced Server's domain.
<LI>Therefore, when the NET USE command was carried out, the Session Setup
   SMB information that was sent out was account = "USER1", password =
   "PSW1" and domain = "LOCAL1."
<LI>\\NET receives the request and looks at the Domain name.
<LI>It does not recognize the domain name as its own or one that it
   trusts.
<LI>It does NOT check any of the domains that it trusts.
<LI>The Advanced Server \\NET then looks at the SMB Account name
   "USER1".
<LI>\\NET looks in the SAM Domain Database for "USER1" and it does not
   find a match.
<LI>\\NET now checks the Guest account because the user is unknown.
<LI>The Guest account is DISABLED in this case on \\NET.
<LI>Windows NT client receives the error message "System error 1326 has
   occurred. Logon failure: unknown user name or bad password."
<P>
</UL>The real answer here is to have all workstations, both Windows NT and
Windows for Workgroups 3.1, log on to an Advanced Server domain. In
order to login, the user must specify their correct domain, account
and password. After this is done, all NET USE type commands will pass
the correct domain password. To do this in Windows for Workgroups 3.1,
you must specify a MS LAN Manager login in the Network Control Panel
application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Both Windows NT and MS LAN Manager clients do provide domain
information. This problem only exist on Windows for Workgroups 3.1
clients.
<P>
<P><h3>Windows NT Workaround</h3>
 
<P>
There is one workaround that can be used in these cases. From the
Windows NT workstation, carry out the following command
<P>
<PRE>   NET USE X: \\NET\SHARE /USER:SCRATCH-DOMAIN\USER1 PSW1

</PRE>where:
<P>
<PRE>    - \\NET = The computer name of the Advanced Server being accessed.
    - \SHARE = The share name.
    - /USER: command line parameter that lets you specify the domain,
      account and password that should be specified in the Session Setup
      SMB.
    - SCRATCH-DOMAIN = Domain name of the Advanced Server where the user
      account resides.
    - \USER1 = Account to be validated against.
    - PSW1 = Password that matches account on the domain.

</PRE>At a Windows NT command prompt, type the following for more
information:
<P>
<PRE>   NET USE /?

</PRE>For information on trust relationships, user permissions, and domain
logins, please see your Windows NT Advanced Server "Concepts and
Planning" guide. For additional information, query on the following
words in the Microsoft Knowledge Base:
<P>
<PRE>   algorithm and access and validation

   -or-

   authentication and pass-through
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt<BR>
Keywords          : ntnetserv kbnetwork kbfasttip<BR>
Version           : 3.1<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
