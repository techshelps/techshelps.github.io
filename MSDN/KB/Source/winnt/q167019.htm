

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>New OLE Features and Enhancements in WinNT 4.0 Service Pack 2 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167019">
<META NAME="KBModify" CONTENT="1997/08/05">
<META NAME="KBCreate" CONTENT="1997/04/16">
<META NAME="Keywords" CONTENT="ntdistrib NTSrvWkst kbole kbhelpfile">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The following new features and enhancements have been made in Microsoft Windows NT version 4.0 Service Pack 2:   - DLL Surrogates  - IAccessControl/CoInitializeSecurity  - Using RPC with WinSock Proxy  DLL Surrogates  Windows NT 4.0 Service Pack 2 ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKF,QBWP,QDO3,QAI5,QBXL,QBW7,QAPN,QACK,QAH6,QAK7,QDL9,QBWQ,QBWO,QBWN,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>New OLE Features and Enhancements in WinNT 4.0 Service Pack 2</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167019</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following new features and enhancements have been made in Microsoft
Windows NT version 4.0 Service Pack 2:

<UL><LI>DLL Surrogates
<LI>IAccessControl/CoInitializeSecurity
<LI>Using RPC with WinSock Proxy
<P>
</UL><h3>DLL Surrogates</h3>
 
<P>
Windows NT 4.0 Service Pack 2 now provides the functionality to incorporate
DLL servers that can be loaded into surrogate EXE processes. This combines
the ease of writing DLL servers with the benefits of executable
implementation. COM provides default surrogate processes, or you can write
a custom surrogate if you have special needs. The DLL server, in a
surrogate process, offers the benefit of:

<UL><LI>Fault isolation and the ability to service multiple clients
   simultaneously.
<LI>In a distributed environment, a DLL server implementation could be used
   to service remote clients.
<LI>It could permit clients to protect themselves from untrusted server
   code, while allowing access to the services the DLL server
   provides.
<LI>Running a DLL server in a surrogate provides the DLL with the
   surrogate's security.
<P>
</UL><h3>IAccessControl/CoInitializeSecurity</h3>
 
<P>
IAccessControl and CoInitializeSecurity are two new features written into
Windows NT 4.0 Service Pack 2. IAccessControl is an interface to control
access to objects and their properties. The methods used by the
IAccessControl interface help you manage access to objects and their
properties and to get information about access permissions.
<P>
CoInitializeSecurity registers security and sets the default security
values. For legacy applications, COM automatically calls
CoInitializeSecurity with values from the registry. You can use
CoInitializeSecurity in conjunction with IAccessControl. The
CoInitializeSecurity function takes the pointer to IAccessControl.
<P>
<P>
<P><h3>Using RPC With WinSock Proxy</h3>
 
<P>
Another new feature is the recent release of Microsoft(r) Internet Access
Server that includes WinSock Proxy, an enhanced version of Windows Sockets
API, version 1.1.
<P>
WinSock Proxy lets a Windows Sockets application, running on a private
network client, behave as if it were directly connected to a remote
Internet server application. Actually, the Microsoft Proxy Server is
the host for this connection. This means that all application-level
communications are channeled through a single secured computer; the
gateway computer running Microsoft Proxy Server.
<P>
To use RPC with WinSock Proxy, you need to edit the system registry on each
computer.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>From the HKEY_LOCAL_MACHINE window, go to the following key:
<P>
<P><PRE>      Software\Microsoft\Rpc
</PRE>
<P><LI>On the Edit menu, click Add Value.

<P><LI>Add the following:
<P>
<P><PRE>      Value Name : UseWinsockForIP
      Data Type  : REG_DWORD
<PRE></PRE>      Data       : 1

</PRE><P><LI>Click OK.

<P><LI>Quit Registry Editor.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
For more information on these enhancements, refer to the Windows NT Service
Pack 2 Online Help.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords          : ntdistrib NTSrvWkst kbole kbhelpfile<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>
Solution Type     : kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
