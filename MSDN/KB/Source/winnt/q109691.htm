

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Err Msg: FAXSTUB.DLL Is Not a Valid Windows NT Image </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109691">
<META NAME="KBModify" CONTENT="1997/05/13">
<META NAME="KBCreate" CONTENT="1994/01/06">
<META NAME="Keywords" CONTENT="kbother nt32ap">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If you migrate a user to Windows NT from Windows for Workgroups version 3.11 with At Work PC Fax installed, when you try to run Windows NT Mail, the following error message may occur:     FAXSTUB.DLL is not a valid Windows NT image.  CAUSE =====  W...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWO,QAB4,QAEF,QAVU,QAY2,QBVV,QBCT,QAGC,QAGB,QAYC,QDL9,QBWQ,QBWN,QDKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Err Msg: FAXSTUB.DLL Is Not a Valid Windows NT Image</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109691</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you migrate a user to Windows NT from Windows for Workgroups version
3.11 with At Work PC Fax installed, when you try to run Windows NT Mail,
the following error message may occur:
<P>
<PRE>   FAXSTUB.DLL is not a valid Windows NT image.

</PRE><h2>CAUSE</h2>
 
<P>
When Windows NT migrates the Windows for Workgroups 3.11 settings and At
Work Fax is installed, references to a 16-bit DLL for the Fax option are
placed in the Registry. Because Windows NT Mail is 32-bit, 16-bit DLLs will
not operate.
<P>
NOTE: The settings are migrated from the MSMAIL.INI file. To prevent
additional new users from having these setting migrated, remark out the fax
settings in the MSMAIL.INI file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To eliminate this error message, remove the references to FAXSTUB.DLL and
the Fax menu from the Registry with the Registry Editor (REGEDT32.EXE),
using the following steps:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system- wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Go to HKEY_CURRENT_USER\Software\Microsoft\Mail.

<P><LI>Delete the Providers key.

<P><LI>Delete the EFAX Transport key.

<P><LI>In the Custom Commands Key, delete all Values that reference Fax
   commands.

<P><LI>Delete the Value Fax= from the Custom Menus Key.

<P><LI>Delete the CustomOptionsHandler Value in the Microsoft Mail Key.

<P><LI>Delete the Value referencing Fax.Encrypted from the Custom Messages Key.
<P>
</OL>Windows NT Mail should now run without the above error message. The At Work
PC Fax feature included with Windows for Workgroups version 3.11 does not
work under Windows NT.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt awfax<BR>
Keywords            : kbother nt32ap<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
