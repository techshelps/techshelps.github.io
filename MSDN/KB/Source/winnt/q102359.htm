

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Replacing Corrupted System Files in Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102359">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="kbusage nthowto">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" WARNING: Using Registry Editor incorrectly can cause     serious, system-wide problems that may require you to     reinstall Windows NT to correct them. Microsoft cannot     guarantee that any problems resulting from the use of     Registry Editor c...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBQU,QAUJ,QDNN,QAIJ,QAY2,QANN,QAI5,QDIV,QA9N,QASB,QAL3,QAB4,QACI,QBXN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Replacing Corrupted System Files in Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102359</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system, version 3.1
<LI>Microsoft Windows NT Advanced Server, version 3.1
</UL> 
<P>
WARNING: Using Registry Editor incorrectly can cause
<PRE>    serious, system-wide problems that may require you to
    reinstall Windows NT to correct them. Microsoft cannot
    guarantee that any problems resulting from the use of
    Registry Editor can be solved. Use this tool at your own
    risk.

</PRE>To enable a Windows NT machine with a corrupt .DLL file to complete the
logon process successfully, you must replace the .DLL with a new,
renamed version of the file:

<OL><P><LI>From a Windows NT machine that has an uncorrupted version of the
   .DLL file you want to replace, connect to the machine with the
   corrupt .DLL file as Administrator.

<P><LI>From the remote machine, place a new, uncorrupted copy the of the
   file in the SYSTEM32 directory on the machine with the damaged
   file (use a different filename for the copy of the file).

<P><LI>From the remote machine, run REGEDT32.EXE, to edit the registry on
   the affected machine.

<P><LI>Locate the following section:
<P>
   HKEY_LOCAL_MACHINE on (Remote Machine Name)
<P><PRE>      SYSTEM\CurrentControlSet\Control\SessionManager\KnownDLLS.
</PRE>
<P><LI>In this section, change the name of the file pointed to by the key
   to the new, renamed version of the file that was copied to the
   SYSTEM32 directory. Close REGEDT32 and restart the machine with the
   previously corrupted file.
<P>
</OL>The machine should start up and complete the logon process.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For example, if the SHELL32.DLL file is corrupt, the following error
message is displayed after you enter your password and attempt to
complete the logon process:
<P>
<PRE>   The application failed to initialize properly (0xc0000139).
   Click OK to terminate the application.

</PRE></OL>The application that has failed to start is Program Manager. At this
point, Windows NT is nonfunctional. Attempting to copy SHELL32.DLL
from a remote machine will not be effective since the file is marked
as in use by Windows NT. To replace the corrupt SHELL32.DLL do the
following:

<OL><P><LI>Connect to the affected machine's root with a functioning Windows NT
   machine as Administrator.

<P><LI>Copy a new SHELL32.DLL from the functioning machine to the affected
   machine's &lt;SYSTEMROOT&gt;\WINNT\SYSTEM32 using the filename
   SHELLALT.DLL.

<P><LI>Edit the affected machine's registry by running REGEDT32.EXE and
   scrolling to the following section:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE on (Remote Machine Name)
<PRE></PRE>         SYSTEM\CurrentControlSet\Control\SessionManager\KnownDLLS.

   The SHELL32.DLL key will point to the file SHELL32.DLL. Change
   that key so that it points to the new file SHELLALT.DLL.

   Before Registry Edit:

   Existing Value Names       Data Type   String
   --------------------------------------------------------------------
   SHELL32.DLL                REG_SZ      SHELL32.DLL


   After Registry Edit:

   Existing Value Names       Data Type   String
   --------------------------------------------------------------------
   SHELL32.DLL                REG_SZ      SHELLALT.DLL


</PRE><P><LI>Close REGEDT32 on the remote machine and restart the affected
   machine. The machine should start and complete the logon process
   with the new SHELLALT.DLL.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt tshoot<BR>
Keywords            : kbusage nthowto<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
