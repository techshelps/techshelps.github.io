

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use Multiple Gateways with Windows NT TCP/IP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104660">
<META NAME="KBModify" CONTENT="1997/05/09">
<META NAME="KBCreate" CONTENT="1993/09/27">
<META NAME="Keywords" CONTENT="kbnetwork NTSrvWkst nttcp">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If the default gateway of a Windows NT computer becomes unavailable, the computer cannot communicate with systems outside its own subnet (aside from those it has established connections with on remote subnets prior to failure).  For example, if Rou...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAM5,QABA,QBVW,QAOX,QDNT,QDIZ,QBXS,QBVV,QAY2,QAKD,QBWD,QBJZ,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use Multiple Gateways with Windows NT TCP/IP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104660</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If the default gateway of a Windows NT computer becomes unavailable, the
computer cannot communicate with systems outside its own subnet (aside from
those it has established connections with on remote subnets prior to
failure).
<P>
For example, if Router A, the default gateway to Server2, which is on a
different subnet, is out of commission when Client1 starts, Client1 is not
able to connect to Server2. This is because by default, Windows NT uses
only the default gateway specified during setup. So, even though there may
be an alternate Router available to connect to Server2, Windows NT will not
use it unless it is configured to use multiple default gateways.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following procedure to configure Windows NT to use multiple
gateways by default:

<OL><P><LI>Open the Registry Editor (REGEDT32.EXE).
<P>
   WARNING: Using Registry Editor incorrectly can cause serious,
   system-wide problems that may require you to reinstall Windows NT
   to correct them. Microsoft cannot guarantee that any problems
   resulting from the use of Registry Editor can be solved. Use this
   tool at your own risk.

<P><LI>Use the following path:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\
      Tcpip\Parameters
</PRE>
<P><LI>From the Edit menu, choose Add Value to create the following entry:
<P>
<P><PRE>      AdditionalGateways
</PRE>
<P><LI>Set the Data Type to REG_MULTI_SZ.

<P><LI>The value should be set to a string representing the default
   gateway, either the dotted decimal format or a fully qualified
   domain name that can be resolved by either the HOSTS file or by
   Domain Name Service. For example:
<P>
<P><PRE>      130.25.000.000
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      rhino.microsoft.com
</PRE><P>
   With the Data Type set to REG_MULTI_SZ, you can make multiple entries
   to represent several other default gateways.
<P>
   NOTE: These entries should be added in order of preference.
<P>
</OL>When a Windows NT system is configured this way, retransmission problems at
the TCP layer cause the IP routing software to try the routers in the
AdditionalGateways list. In this example, if Client1 and Server2 had a
session established and Router A went down, TCP would send a message to IP
telling it to try one of the additional routers. IP would then try Router
B, and use the double-hop route to continue exchanging data between Client1
and Server2. When Router A becomes available, the interrouting protocol
forces Router B (the current first-hop router in the path from Client1 to
Server2) to redirect Client1 to use Router A for traffic destined for
Server2.
<P>
The ROUTE utility can be used to display the currently active default (or
smart) gateway; the ROUTE -S PRINT command prints the currently active
default gateway, and the ROUTE PRINT command prints all current routes in
the routing tables, identifying all default gateways in the table in order
of preference.
<P>
The ROUTE -S ADD command can be used to add additional default gateways
after the system has initialized. Any gateways added in this way are
appended to the existing list. The ROUTE command does not provide a way to
order the gateways, so you must use ROUTE -F to flush all the routing
table entries and then add entries in the order of preference. But any
changes to the routing tables using the ROUTE utility are not added to the
Registry, so to permanently affect the default gateway routing tables, you
must add the AdditionalGateways value entry to the Registry.
<P>
NOTE: The registry value entry only applies to TCP applications. UDP
applications cannot use alternate gateways because it is a connectionless
datagram.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbnetwork NTSrvWkst nttcp<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
