

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Limited Virtual Memory Changing Drive Letter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102081">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/07/28">
<META NAME="Keywords" CONTENT="kbbug3.10 kbsetup ntsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" WARNING: Using Registry Editor incorrectly can cause     serious, system-wide problems that may require you to     reinstall Windows NT to correct them. Microsoft cannot     guarantee that any problems resulting from the use of     Registry Editor c...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAC9,QBXS,QAYL,QBTX,QBJZ,QBWS,QAX1,QAR4,QAM4,QA4B,QAY2,QAGU,QAB4,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Limited Virtual Memory Changing Drive Letter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102081</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system, version 3.1
<LI>Microsoft Windows NT Advanced Server, version 3.1
</UL> 
<P>
WARNING: Using Registry Editor incorrectly can cause
<PRE>    serious, system-wide problems that may require you to
    reinstall Windows NT to correct them. Microsoft cannot
    guarantee that any problems resulting from the use of
    Registry Editor can be solved. Use this tool at your own
    risk.

</PRE><h2>SYMPTOMS</h2>
 
<P>
When the static Drive Letter in Disk Manager is changed from the
logical drive that Windows NT is presently installed on, the following
error message appears:
<P>
<PRE>                     "Limited Virtual Memory
   Your system is running without a properly sized paging file. Please
   use the virtual memory option of the System applet in the Control
   Panel to create a paging file, or to increase the initial size of
   your paging file."

</PRE><h2>RESOLUTION</h2>
 
<P>
NOTE: Although you can perform the following steps 1-5 through the
User Interface, use the Registry editor to perform steps 7-14.

<OL><P><LI>From the System dialog box in Control Panel, choose the Virtual
    Memory button.

<P><LI>Select the drive on which the Paging File is to be created.

<P><LI>Enter Initial Size (in megabytes, MB) and Maximum Size (in
    megabytes), and then choose the Set button. It will return to the
    System dialog box.

<P><LI>In the Users Environment Variables box, select each variable.

<P><LI>In the boxes below it, change each Variable and Value, and then
    choose the Set button.

<P><LI>Start REGEDT32. Select the HKEY_USERS on Local Machine subtree and
    search for the following subkey:
<P>
      DEFAULT\Environment

<P><LI>On the right side of the window, choose the temp:REG_SZ: value.

<P><LI>From the Edit menu, choose String.

<P><LI>Edit the string and replace the drive letter reference with the
    correct drive letter.

<P><LI>On the right side of the window, choose the tmp:REG_SZ: value.

<P><LI>From the Edit menu, choose String.

<P><LI>Edit the string and replace the drive letter reference with the
    correct drive letter.

<P><LI>Exit REGEDT32.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Although the System Environment Variables change, and the PAGEFILE.SYS
file is located on the drive that you have changed the drive letter
of, it never gets updated in HKEY_LOCAL_MACHINE on Local Machine subtree
after restarting:
<P>
<PRE>   \SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management

</PRE></OL>under the key value PagingFiles:REG_MULTI_SZ:. It also does not change
the Users Environment Variables or the Default Environment Variable
setting.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.1
and Windows NT Advanced Server version 3.1. We are researching this
problem and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Changing the Environment Variables and Virtual-Memory Paging File
"Windows NT System Guide," pages  148-151
"Windows NT Advanced Server," pages 158-161
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt sticky<BR>
Keywords            : kbbug3.10 kbsetup ntsetup<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
