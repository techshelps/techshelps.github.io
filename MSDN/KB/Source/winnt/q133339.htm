

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automating Client Services for NetWare (CSNW) Installation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133339">
<META NAME="KBModify" CONTENT="1996/03/27">
<META NAME="KBCreate" CONTENT="1995/07/30">
<META NAME="Keywords" CONTENT="kbsetup kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you run Unattended or Computer Profile Setup (CPS), by default, Client Services for NetWare (CSNW) is not installed. However, you can accomplish automated installation of CSNW by modifying setup files.   MORE INFORMATION  To automatically conf...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBXT,QAIB,QA5V,QAA1,QDI2,QBKX,QBWS,QDIZ,QBXS,QAY2,QAMB,QACR,QAUR,QAM2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automating Client Services for NetWare (CSNW) Installation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133339</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft Resource Kit for Windows NT version 3.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you run Unattended or Computer Profile Setup (CPS), by default, Client
Services for NetWare (CSNW) is not installed. However, you can accomplish
automated installation of CSNW by modifying setup files.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To automatically configure CSNW when you use an answer file with Windows NT
Setup, modify the TXTSETUP.SIF, NTLANMAN.INF, AUTOEXEC.NT, and SYSTEM:
<P>
WARNING: Modification of INF files may cause serious, system-wide problems
before and after Setup and may require you to reinstall Windows NT to
correct them. Microsoft cannot guarantee that any problems resulting from
the modification of INF files can be solved. Make INF modifications at your
own risk.  Corporate Network Systems does not support the modification of
INF files.  For more information on INF files, refer to the Programmer's
Guide included in the Windows NT DDK or contact Microsoft Consulting
Services or a Solution Provider.

<OL><P><LI>Copy the \I386 directory from the Windows NT compact disc to your hard
   drive.

<P><LI>Expand NTLANMAN.IN_, AUTOEXEC.NT_, and SYSTEM._ using the EXPAND.EXE
   command.
<P>
   The EXPAND.EXE file is located in the %SystemRoot%\SYSTEM32 directory.

<P><LI>Make a backup copy of TXTSETUP.SIF and rename NTLANMAN.IN_,
   AUTOEXEC.NT_, and SYSTEM._.

<P><LI>Add the following to the [Files] section of the TXTSETUP.SIF file:
<P>
<P><PRE>      ;;; Added line below. &lt;your_name&gt;, &lt;today's_date&gt;
      nwcfg.dll = dx,,,2,0,0
</PRE><P>
   NOTE: The text ";;; Added line below. &lt;your_name&gt;, &lt;today's_date&gt;" is an
   optional comment that Microsoft recommends you add for tracking and
   easier troubleshooting in the future.

<P><LI>Add the following to the [ServiceData] section of the NTLANMAN.INF file:
<P>
<P><PRE>      ;;; Added line below. &lt;your_name&gt;, &lt;today's_date&gt;
<PRE></PRE>      ServiceData_5      = "OEMNSVNW.INF","NWWKSTA",11,NWWKSTA

   NOTE: The ServiceData_5 line must immediately follow the ServiceData_4
   line.

</PRE><P><LI>Add the following to end of the AUTOEXEC.NT file:
<P>
<P><PRE>      REM Install netware redirector
      lh %SystemRoot%\system32\nw16
      lh %SystemRoot%\system32\vwipxspx
</PRE>
<P><LI>Run Registry Editor (REGEDT32.EXE) on another Windows NT system running
   CSNW.

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Control\Print\Providers
</PRE>
<P><LI>Choose the Save Key option from the Registry menu to save the
   Providers Key to a file (for example: A:\PROVIDE.TMP).

<P><LI>Choose the OK button.

<P><LI>Make sure the HKEY_LOCAL_MACHINE window is highlighted by selecting it.

<P><LI>Choose the LOAD HIVE option from the Registry menu.

<P><LI>In the Load Hive dialog box, specify SYSTEM file that was expanded in
   Step 2 and choose the OK button:

<P><LI>When prompted for Key Name, specify "Template System" (without
   quotes) and choose the OK button.

<P><LI>Go to the key:
<P>
   \Template System\CurrentControlSet001\Control\Print\Providers

<P><LI>Choose the Restore option from the Registry menu and specify the file
<P><PRE>    saved in Step 9 above (for example: A:\PROVIDE.TMP).
</PRE>
<P><LI>Choose the OK button.

<P><LI>Select the Template System key.

<P><LI>Choose the Unload Hive option from the Registry menu.

<P><LI>Run Unattended Setup.
<P>
</OL>For details on running Unattended Setup refer to the "Unattended
Installation" section in Chapter 3 or the Windows NT Resource Kit.
<P>
To automatically configure CSNW using computer profile setup (CPS):

<OL><P><LI>Upload the master system (must have CSNW installed) to the distribution
   server.

<P><LI>Modify the [ServiceData] section of %SYSTEMROOT%\SYSTEM32\DEFAULTS.INF
   on the distribution server to appear as follows.
<P>
   NOTE: DEFAULTS.INF lines in the following example that do not fit on one
   line in this article but should be on one line in the DEFAULTS.INF file,
   have several parts to it and are labeled as such to help you identify
   and modify the correct lines. Be sure to remove the line labels if you
   copy this  example to the DEFAULTS.INF file:
<P>
<PRE>              line 1: [ServiceData]
      line 2, part 1: !ServiceInfList =
      line 2, part 2: {"OEMNSVSV.INF","OEMNSVWK.INF","OEMNSVNB.INF",
      line 2, part 3: "OEMNSVRP.INF", "OEMNSVNW.INF"}
      line 3, part 1: !ServiceOptionList = {"SRV","WKSTA","NETBIOS",
      line 3, part 2: "RPCLOCATE","NWWKSTA"}
              line 4: !ServiceBbList = {"3","2","5","11","11"}
      line 5, part 1: !ServiceNameList = {"LanmanServer",
      line 5, part 2: "LanmanWorkstation","NetBIOS","RPCLOCATOR","NWWKSTA"}

</PRE><P><LI>Run WINNTP.EXE on the target system.
<P>
</OL>For details on uploading the master system to the distribution server or
running WINNTP.EXE from the target system read "Preinstalling Windows NT
Using CPS" in Volume 1 of the Windows NT Resource Kit.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbnetwork<BR>
KBSubcategory: ntsetup nthowto ntreskit<BR>
Additional reference words: prodnt 3.50 3.51 upgrade<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
