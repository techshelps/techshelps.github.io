

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Event 2000 Occurs When You Print to a Shared Printer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134759">
<META NAME="KBModify" CONTENT="1996/08/26">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="kbprint kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you print to a shared printer, the following is logged in the system log:     Event 2000:    Source: SRV    Type: ERROR    Description: The server's call to a system service failed unexpectedly.     0000: 00040000 00540001 00000000 c00007d0   ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWP,QACT,QA3A,QDL9,QBWQ,QBWO,QBWN,QAO4,QBT0,QBWS,QAI5,QA0K,QBXS,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Event 2000 Occurs When You Print to a Shared Printer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 26, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134759</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you print to a shared printer, the following is logged in the system
log:
<P>
<PRE>   Event 2000:
   Source: SRV
   Type: ERROR
   Description: The server's call to a system service failed unexpectedly.

   0000: 00040000 00540001 00000000 c00007d0
   0010: 00000000 c000000d 00000000 00000000
   0020: 00000000 00000000 12880bc5

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when:

<UL><LI>A printer is physically connected to your computer running Windows 95
   and shared on the network.

<LI>You print from an MS-DOS-based application under Windows 95 to LPT2, and
   LPT2 is redirected to a printer shared by Windows NT.

<LI>The printer shared by Windows NT is not local printer, but is redirected
   to a printer shared by Windows 95.

<LI>The Windows NT printer is created in two steps. You use Connect To
   Printer to access the printer shared by Windows 95 and you use Create
   Printer and Print To &lt;destination&gt; to print to the printer shared by
   Windows 95.
<P>
</UL>In above configuration, the error occurs when the spooler accesses LAN
Manager Print Services.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, edit the Registry:
<P>
WARNING: Using the Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from the  use
of the Registry Editor can be solved. Use this tool at your own  risk.

<OL><P><LI>Run Print Manager and remove the printer previously established.

<P><LI>Run Registry Editor (REGEDT32.EXE).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Control\Print\Providers
<PRE></PRE>        \LanManPrintServices\PortNames

</PRE><P><LI>Delete following key:
<P>
<P><PRE>      REG_SZ: \\printserver\printershare
</PRE>
<P><LI>Shutdown and restart Windows NT.

<P><LI>Run Print Manager and create a printer:
<P>
   a. From the Printer menu, choose Create Printer.
<P>
   b. In the Print To list box, choose Others.
<P>
   c. Select Local Port and then choose OK.
<P>
   d. Type in the universal naming conversion (UNC) path to the print
<P><PRE>      server, for example \\printsrv\printshare, and then choose OK.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kbnetwork<BR>
KBSubCategory: ntprint<BR>
Additional reference words: 3.50 3.51 prodnt lanman<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 26, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
