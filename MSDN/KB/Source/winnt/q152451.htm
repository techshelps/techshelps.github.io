

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Applications Run from the Schedule Service Fail to Print </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152451">
<META NAME="KBModify" CONTENT="1997/11/18">
<META NAME="KBCreate" CONTENT="1996/06/14">
<META NAME="Keywords" CONTENT="ntconfig ntprint NTSrvWkst kbprint">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="   Applications run from the Windows NT Schedule service fail to print.  CAUSE =====  Printing fails because no default print device is defined for the service account. When an application sends a print request, Windows NT queries the Windows NT regi...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWS,QBWP,QACK,QAL4,QAY2,QAPF,QAI5,QASR,QAKD,QABA,QACT,QAJH,QAIJ,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Applications Run from the Schedule Service Fail to Print</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152451</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:
<P>
- Microsoft Windows NT Workstation versions 3.5 and 3.51
- Microsoft Windows NT Server versions 3.5 and 3.51
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
<P>
Applications run from the Windows NT Schedule service fail to print.
<P>
<P><h2>CAUSE</h2>
 
<P>
Printing fails because no default print device is defined for the service
account. When an application sends a print request, Windows NT queries the
Windows NT registry for the default print device and the print driver.
Applications run from the Windows NT Schedule service should be running
under the context of the System account to work correctly; however, there
is no default print device defined for the System account (which is
actually relying on the default user information in the registry). Such an
application, therefore, is unable to print and usually issues an error,
the text of which varies from application to application.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To ensure successful printing from a scheduled application, complete the
following procedure:

<OL><P><LI>Open Control Panel, click the Services icon, and from the list of
   available services, select the Schedule service. Then click the Startup
   button and verify that this service is configured to log on as the
   System account and that it is allowed to interact with the desktop.
<P>
   NOTE: For a scheduled application to print correctly, and for these
   instructions to produce successful results, you must use the System
   account for the service (Log On As) account.
<P>
   When you have verified the above settings, click the OK button, and
   from the Services window click the Stop button (with the Schedule
   service selected), if the Stop button is available. This ensures that
   the changes take effect the next time you start the Schedule service.

<P><LI>In Print Manager, create a local printer--regardless of whether the
   printer is actually a local printer or a remote network printer--by
   choosing Create Printer from the Printer menu, using the printer driver
   appropriate for the type of printer you are using. Configure the
   printer to print to LPT1, and set it as the default printer.

<P><LI>Start and maximize Registry Editor (Regedt32.exe).
<P>
   WARNING: Using Registry Editor incorrectly can cause serious, system-
   wide problems that may require you to reinstall Windows NT to correct
   them. Microsoft cannot guarantee that any problems resulting from the
   use of Registry Editor can be solved. Use this tool at your own risk.
<P>
   Minimize the windows titled "HKEY_LOCAL_MACHINE on Local Machine" and
   "HKEY_CLASSES_ROOT on Local Machine" and position the remaining two
   windows, titled "HKEY_CURRENT_USER on Local Machine" and "HKEY_USERS on
   Local Machine," such that they are tiled vertically on the screen with
   each filling about one half of the available window space in Registry
   Editor. This step is provided for convenience in completing the
   remaining steps, in which you will review and edit certain registry
   keys.

<P><LI>Select the key
<P>
<P><PRE>      HKEY_CURRENT_USER
<PRE></PRE>         \Software\Microsoft\Windows NT\Current Version\Devices

   and note the information for the value of the key that represents the
   default printer created in step 2 above (for example, "LocalPrinter :
   REG_SZ : winspool,LPT1:").

</PRE><P><LI>Select the key
<P>
<P><PRE>      HKEY_USERS
<PRE></PRE>         \.DEFAULT\Software\Microsoft\Windows NT\Current Version\Devices

   and choose Add Value from the Edit menu to create the same value you
   noted in step 4 (using the above example, "LocalPrinter" is the value
   name, "REG_SZ" is the data type, and "winspool,LPT1:" is the string).

</PRE><P><LI>Select the key
<P>
<P><PRE>      HKEY_CURRENT_USER
<PRE></PRE>         \Software\Microsoft\Windows NT\Current Version\PrinterPorts

   and note the information for the value of the key that represents the
   default printer created in step 2 above (for example, "LocalPrinter :
   REG_SZ : winspool,LPT1:,14,45").


</PRE><P><LI>Select the key
<P>
<P><PRE>      HKEY_USERS
<PRE></PRE>         \.DEFAULT\Software\Microsoft\Windows NT\Current Version
         \PrinterPorts

   and choose Add Value from the Edit menu to create the same value you
   noted in step 6 (in the example from step 6, "LocalPrinter" is the
   value name, "REG_SZ" is the data type, and "winspool,LPT1:,14,45" is
   the string).


</PRE><P><LI>Select the key
<P>
<P><PRE>      HKEY_CURRENT_USER
<PRE></PRE>         \Software\Microsoft\Windows NT\Current Version\Windows

   and note the information for the device value of the key (for example,
   "LocalPrinter,winspool,LPT1:").

</PRE><P><LI>Double-click the device value of the key
<P>
<P><PRE>      HKEY_USERS
<PRE></PRE>         \.DEFAULT\Software\Microsoft\Windows NT\Current Version\Windows

   and edit it to reflect the same information you noted in step 8 (in the
   example from step 8, you would enter "LocalPrinter,winspool,LPT1:" for
   the string).

</PRE><P><LI>Close Registry Editor.

<P><LI>Open Control Panel, click the Services icon, and from the list of
<P><PRE>    available services, select the Schedule service. Click the Start
    button to start the Schedule service with the above settings changes
    in effect.
</PRE>
<P><LI>If the printer is actually a local printer, schedule the application
<P><PRE>    to run at the desired time, using the following command as a model:
</PRE><P>
<P><PRE>       at 10:00am /interactive c:\excel\excel.exe c:\excel\macro.xls
</PRE>
<P><LI>If the printer is a remote network printer, create a batch file to
<P><PRE>    start the application, using the following file, Example.bat, as a
    model:
</PRE><P>
<P><PRE>       EXAMPLE.BAT
       -----------
</PRE><P>
<P><PRE>       @echo off
       net use lpt1: /d
       net use lpt1: \\&lt;PrinterServer&gt;\&lt;PrinterShare&gt; &lt;password&gt;
<PRE></PRE>          /user:&lt;DomainName&gt;\&lt;AuthorizedUserName&gt;
       c:\excel\excel.exe c:\excel\macro.xls
       net use LPT1: /d

    NOTE: The third and fourth lines of the above batch file are actually
    only one line, with just a space between "&lt;password&gt;" and "/user".

    Schedule the application to run at the desired time, using the
    following command as a model;

       at 10:00am /interactive example.bat

    Use of a batch file is necessary in this case because by default the
    System account does not have network access to the printer share, so
    the batch file establishes the connection to the network printer with
    the required credentials (the user name and password of a user granted
    access to the printer share).
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt 3.50 3.51 scheduler program process<BR>
Unable to initialize device printer service<BR>
Keywords          : ntconfig ntprint NTSrvWkst kbprint<BR>
Version           : 3.5 3.51<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
