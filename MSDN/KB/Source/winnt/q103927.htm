

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 3.0 and 3.1 Control Panel Files Do Not Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103927">
<META NAME="KBModify" CONTENT="1997/05/09">
<META NAME="KBCreate" CONTENT="1993/09/01">
<META NAME="Keywords" CONTENT="kbbug3.10 kbtool ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" WARNING: Using Registry Editor incorrectly can cause     serious, system-wide problems that may require you to     reinstall Windows NT to correct them. Microsoft cannot     guarantee that any problems resulting from the use of     Registry Editor c...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTX,QBWP,QAB4,QDL9,QBWQ,QBWO,QBWN,QAA1,QAFI,QBXB,QATJ,QDI2,QBVV,QAGQ,QBXI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 3.0 and 3.1 Control Panel Files Do Not Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103927</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
WARNING: Using Registry Editor incorrectly can cause
<PRE>    serious, system-wide problems that may require you to
    reinstall Windows NT to correct them. Microsoft cannot
    guarantee that any problems resulting from the use of
    Registry Editor can be solved. Use this tool at your own
    risk.

</PRE><h2>SYMPTOMS</h2>
 
<P>
Windows 3.0 and 3.1 Control Panel (.CPL) files are not compatible with
Windows NT even though they use the same extension.
<P>
While you are using Windows NT, if any Windows 3.0 or 3.1 Control
Panel files are located in either of the WINNT\SYSTEM or SYSTEM32
subdirectories, you may receive the following error message:
<P>
<PRE>   The application or DLL DosDevices\C:\winnt\system\filename.cpl is
   not a valid Windows NT image. Please check this against your
   installation diskette.

</PRE>The filename of the .CPL file depends on the application that
installed it.
<P>
<P><h2>CAUSE</h2>
 
<P>
If an application, during its installation, places a .CPL file in the
WINNT\SYSTEM directory and makes its appropriate entries in the
Registry, you will receive the above error message when you try to run
Control Panel. The installation program thinks it is writing its
settings to an .INI file, but these settings are mapped by Windows NT
to the Registry. Therefore, when you try to run Control Panel, Windows
NT uses those mappings to look in the WINNT\SYSTEM directory for the
.CPL file.
<P>
For this reason, copying a Windows 3.0 or 3.1 .CPL file into the
WINNT\SYSTEM directory does not generate this error message.
<P>
Also, when Control Panel loads, it searches the WINNT\SYSTEM32
directory for any .CPL files. Any Windows 3.0 or 3.1 .CPL file located
in the SYSTEM32 directory also generates the above error message.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this error message, use one of the following workarounds:

<UL><LI>Remove the .CPL file from the WINNT\SYSTEM or SYSTEM32 directory.
<P>
   -or-

<LI>Remove the appropriate entry from the Registry using the Registry
   Editor (REGEDT32.EXE). The location of the entry will vary,
   although it should be under the following path:
<P>
<P><PRE>      HKEY_CURRENT_USER\Control Panel\
</PRE><P>
</UL>CAUTION: Modifying the Registry can harm your system. For details,
query on the following words in the Microsoft Knowledge Base:
<P>
<PRE>   ntregistry and warning and
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt 3rdparty third party third-party<BR>
Keywords            : kbbug3.10 kbtool ntutil<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
