

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RSHSVC Included in WinNT 3.5x/4.0 ResKit Has Potential Leak </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158320">
<META NAME="KBModify" CONTENT="1997/10/22">
<META NAME="KBCreate" CONTENT="1996/10/29">
<META NAME="Keywords" CONTENT="NTINTEROP NTPROTOCOL ntreskit nttcp kbnetwork kbtool">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Although the RSHSVC utility included in the Windows NT Server Resource Kit uses the .Rhosts file for the Account Level Equivalence (ALE) security, RSHSVC does not do the ALE security check as is explicitly specified in the Rshsvc.txt or Rshsvc.htm ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAD,QBWP,QAK7,QBWD,QABI,QBKX,QAI5,QBWF,QBBI,QABH,QBW7,QAUJ,QAGU,QDN1,QDNL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RSHSVC Included in WinNT 3.5x/4.0 ResKit Has Potential Leak</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158320</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Although the RSHSVC utility included in the Windows NT Server Resource Kit
uses the .Rhosts file for the Account Level Equivalence (ALE) security,
RSHSVC does not do the ALE security check as is explicitly specified in the
Rshsvc.txt or Rshsvc.htm files, therefore it poses a security leak or hole.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A Remote Shell Server Service (RSH) Daemon normally provides one or two
levels of security: the Host Level Equivalence (low/loose), by using the
Hosts.equiv file and the Account Level Equivalence (high/tighter), by using
the .Rhosts file (The period "." is part of the name!).
<P>
According to the Rshsvc.txt or Rshsvc.htm file, the Rshsvc.exe file
running on an IP host (local computer) provides the ALE security and is
supposed to check the user name (either the client user name or server user
name) of a user who tries to remotely access from a remote host, and the
remote host name against the entries in the .Rhosts file under the
%SystemRoot%\System32\Drivers\Etc directory on the local computer.
<P>
RSHSVC supposedly returns an access denied error message when any of the
following conditions occur:

<UL><LI>The RSH client computer name is not specified in the .Rhosts file.

<LI>The name of the user that is logged on to the RSH client computer is not
   present in the .Rhosts files.

<LI>RHSVC (using GetHostByName) failed to resolve the IP Address of a
   computer, say Mx, specified in the .Rhosts files and a user is trying
   to access this service from that computer Mx.
<P>
</UL>But RSHSVC fails to check whether the user name is authorized or not in the
.Rhost file and mistakenly let any unauthorized user name access the local
computer as long as it comes from an authorized host computer.
<P>
This poses serious security problems such as delete file, kill process,
and so forth.
* 2. Issue the following command from an authorized remote computer. (But
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in NT version 3.5x/4.0 and we
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>REFERENCE</h2>
 

<OL><P><LI>Rshsvc.txt or Rshsvc.htm coming with the Rshsvc.exe and .DLL file in the
   Windows NT Resource Kit.

<P><LI>Essential System Administration, O'Reilly &amp; Assoc, 2nd Ed., Chapter 13
   Network Security, Pages 622-623.

<P><LI>UNIX Network Programming, W. R. Stevens, Prentice Hall, Chapter 9
   Security, Pages 421-424
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Reskit<BR>
Keywords          : NTINTEROP NTPROTOCOL ntreskit nttcp kbnetwork kbtool<BR>
Version           : WinNT:3.5,3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
