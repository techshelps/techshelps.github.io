

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Sysdiff.exe with Unattended Setup and Windows NT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156795">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1996/09/30">
<META NAME="Keywords" CONTENT="ntdriver ntreskit ntsetup NTSrvWkst kbfaq kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Sysdiff.exe is a Windows NT 4.0-only utility used to profile and install applications for Windows NT 4.0 systems. The utility has several modes that must be run to achieve a proper profile of the system for installation purposes.  Sysdiff consists ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QAFI,QBXB,QATJ,QDI2,QAX3,QDJS,QA5W,QAH6,QAJH,QA9N,QASR,QAHT,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Sysdiff.exe with Unattended Setup and Windows NT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156795</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sysdiff.exe is a Windows NT 4.0-only utility used to profile and install
applications for Windows NT 4.0 systems. The utility has several modes
that must be run to achieve a proper profile of the system for
installation purposes.
<P>
Sysdiff consists of a three step process:

<OL><P><LI>Step one is SNAP mode, which takes an initial snapshot of a fresh
   install of Windows NT.

<P><LI>Step two is DIFF mode, which is run after applications have been
   installed and uses the image created with SNAP mode for comparison.

<P><LI>Step three is INF mode, which is used to incorporate the installation
   of the applications with unattended setup.
<P>
</OL>Sysdiff.exe does not provide support for any registry values that are
contained in any of the HKEY_USER hives. This includes items like the
desktop, screen savers, and wallpaper. Also, Sysdiff.exe does not support
any installable services or device drivers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following instructions provide a working model that can be used in
preparing your distribution server:

<OL><P><LI>Make a directory on the distribution server called I386.

<P><LI>Copy the entire contents of the I386 directory from the Windows NT 4.0
   compact disc to the I386 directory. Share the I386 directory as I386 on
   the distribution server.

<P><LI>Do a fresh installation of Windows NT 4.0 on another system. This
   system is called the Master System.

<P><LI>Create a directory (MKDIR C:\Images) on the Master System to hold the
   files created by Sysdiff. It is not necessary to send the images to a
   network drive. A local drive will increase the performance of Sysdiff.

<P><LI>Once Windows NT is installed, Sysdiff can be run to get an initial
   snapshot used for comparison. From an MS-DOS window run the following
   command:
<P>
<P><PRE>      sysdiff /snap c:\images\snap.img
</PRE>
<P><LI>Next, install the applications that will be used.

<P><LI>Once all applications are installed, the system is ready to run the
   next step of Sysdiff, which is DIFF mode. DIFF mode will use Snap.img
   to determine what the applications directory structure is and the
   registry entries to add, if any. Use the following command:
<P>
<P><PRE>      sysdiff /diff c:\images\snap.img c:\images\diff.img
</PRE><P>
   The most common issues with DIFF mode occur when Sysdiff is profiling
   the registry and is unable to extract the information. Review the
   Registry window to see where Sysdiff stopped. In most cases, the
   application cannot be profiled and will have to be installed manually.
   Another area to watch is the INI files section. In some cases, the
   files for some applications are not placed in the image. Application
   INI files may have to be copied manually once the installation of
   Windows NT is completed.

<P><LI>Now that the difference file (Diff.img) has been created, the next step
   is to incorporate the applications into the I386 directory on the
   distribution server. The way to incorporate the applications is with
   INF mode. The Diff.img file will be extracted and a special directory
   structure built for unattended setup to use. Also, a special INF file
   is created to rebuild the registry.
<P>
   Map a drive letter to the distribution server’s share of the I386
   directory that was created earlier:
<P>
<P><PRE>      net use z:\\server_name\i386
</PRE><P>
   Now run the following command:
<P>
<P><PRE>      sysdiff /inf /m c:\images\diff.img z:\
</PRE><P>
   /M is used to ensure the shortcuts are added to the Start menu.
<P>
   NOTE: Sysdiff will create a directory called $OEM$ and it is very
   important that this directory be under the I386 directory on the
   server. In this case, the I386 directory is shared as a root so Z:\ is
   all that is needed. To verify that $OEM$ is in the correct location,
   from the server, check that $OEM$ is under the I386 directory. If, for
   some reason, the $OEM$ directory is not written to I386, it can moved
   using File Manager.
<P>
   The distribution server is now ready to install Windows NT 4.0 and the
   applications. One additional item is to verify the directory length
   under $OEM$. The first phase of the installation of Windows NT is
   MS-DOS based, and MS-DOS cannot copy directories with path names longer
   than 64 characters.

<P><LI>To turn on the installation of applications placed in the $OEM$
   directory, OEMPreInstall = Yes must be added to the [Unattended]
   section of the answer file. Using OEMPreInstall = Yes may require
   additional entries in the answer file.
<P>
   For additional information, please see the following article in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../WINNT/Q155197.htm">Q155197</A></B>
<PRE></PRE>      TITLE     : Unattended Setup Parameters for Unattend.txt File

</PRE></OL>Definitions of directories created by Sysdiff using INF mode.
<P>
<P><h3>$OEM$\$$</h3>
 
<P>
This directory contains the system files (either new files or replacements
for retail files) that are copied to the various subdirectories when
Windows NT is installed. The structure of this directory must match the
structure of a standard Windows NT installation, where $OEM$\$$ matches
%Windir%, $OEM$\$$\System32 matches %Windir%\System32, and so on.
<P>
Each subdirectory should contain the files that need to be copied to the
corresponding system directory on the target computer. This directory
should also contain $$Rename.txt, which lists all files that need to be
renamed, such as files in 8.3 format that must change to long file names.
<P>
<P><h3>$OEM$\drive_letter</h3>
 
<P>
Each $OEM$\drive_letter directory contains a subdirectory structure that
is copied during text mode setup to the root of a corresponding drive in
the target computer. Files that need to be renamed should be listed in
$$Rename.txt.
<P>
Additional information on Windows NT 4.0 Deployment is available for free
download from the following Microsoft Web site:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/ntworkstation/info/deployguide.htm">http://www.microsoft.com/ntworkstation/info/deployguide.htm</A></B>

</PRE>The Sysdiff.exe utility can be found on the Windows NT 4.0 CD-ROM at
&lt;cd-rom drive&gt;:\Support\Deptools\I386\Sysdiff.exe for the Intel platform.
<P>
For additional information on troubleshooting Sysdiff.exe, see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>      ARTICLE-ID: <B><A HREF="../WINNT/Q157576.htm">Q157576</A></B>
      TITLE     : How to Troubleshoot the Sysdiff Tool in Windows NT
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : ntdriver ntreskit ntsetup NTSrvWkst kbfaq kbsetup<BR>
Version           : 4.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
