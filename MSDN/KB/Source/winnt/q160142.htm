

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Printer Operators Cannot Create DLC Ports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160142">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="ntprint NTSrvWkst ntui kbprint kbbug3.51 kbbug4.00">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  While logged in as a Print Operator, a user can create a printer and seems to create a DLC port for that printer. The following two scenarios may happen, depending on the version of Windows NT that is being used and whether the printer driver is al...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWP,QDJP,QAB4,QACT,QAA1,QAAP,QAKG,QDI2,QANY,QAKM,QBWS,QAAD,QAK7,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Printer Operators Cannot Create DLC Ports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160142</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
While logged in as a Print Operator, a user can create a printer and seems
to create a DLC port for that printer. The following two scenarios may
happen, depending on the version of Windows NT that is being used and
whether the printer driver is already loaded on the system:
<P>
<P><h3>Windows NT 3.51</h3>
 
<P>
If the printer driver was on the system, the printer installs and seems to
work until the next time the system is shut down and restarted. After
restarting, the printer status will show as unknown. The printer properties
will be unavailable and the printer Security Permissions and Owner options
will give the following error:
<P>
<PRE>   STOP
   Cannot retrieve the security descriptor for this printer.

</PRE>If the printer driver was not already loaded for another printer, the
following error will appear while loading the driver:
<P>
<PRE>   Noncritical Error
   An error has occurred.

   Setup was unable to set the security information for
   C:\WINNT35\SYSTEM32\spool\DRIVERS\W32X86\RASDDU (off the screen)
   You may continue (ignoring the error), retry the operation, or exit
   Setup.
   If you choose to ignore the error, Setup may not be able to completely
   and/or correctly install the software. If you exit, you will have to
   repeat the Setup process from the beginning.

   Ignore           Retry          Exit Setup

</PRE>If the system is restarted, the security descriptor error will also happen
as described above.
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
The printer and port will seem to install and work fine but, as above, when
the system is shut down and restarted, the port disappears. The printer
will state that it "Failed to open, retrying," and the following event will
be logged:
<P>
<PRE>   Event 1040
   Source hpmon
   Type Warning

   Description Updating the registry failed (0x5).  Make sure HP Monitor
   can access the registry.

</PRE><h2>CAUSE</h2>
 
<P>
Printer Operators can create printers but do not have sufficient access to
the registry to create new printer ports.
<P>
Print Operators are also unable to create an LPR port. For additional
information, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q140084.htm">Q140084</A></B>
   TITLE     : Permissions Error Creating an LPR Printer

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<UL><LI>Have the Administrator create the port before the Printer Operator
   creates a printer.
<P>
   -or-

<LI>Use the following steps to modify the default registry permissions to
   give Print Operators the ability to create a DLC port.
<P>
   WARNING: Using Registry Editor incorrectly can cause serious, system-
   wide problems that may require you to reinstall Windows NT to correct
   them. Microsoft cannot guarantee that any problems resulting from the
   use of Registry Editor can be solved. Use this tool at your own risk.
<P>
   1. Log on to the computer as an Administrator and run Regedt32.exe.
<P>
   2. Go to the following registry location:
<P>
<PRE>         HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print

   3. Select the Monitors key under the Print key

   4. On the Security menu, click Permissions.

   5. Click Add, and then select the Print Operators group; set the Type of
      Access to Full Control and then click OK.

   6. Click the Replace Permissions on Existing Subkeys option, and then
      click OK.

   7. Stop and then restart the Spooler service.

   Print Operators will now be able to add a DLC Port.

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT versions 3.51
and 4.0. We are researching this problem and will post new information here
in the Microsoft Knowledge Base as it becomes available.

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords          : ntprint NTSrvWkst ntui kbprint kbbug3.51 kbbug4.00<BR>
Version           : 3.51 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
