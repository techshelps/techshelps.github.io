

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Server Spools Jobs Endlessly if AppleTalk Print Device Removed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123156">
<META NAME="KBModify" CONTENT="1996/08/30">
<META NAME="KBCreate" CONTENT="1994/11/22">
<META NAME="Keywords" CONTENT="kbnetwork kbprint kbbug3.50">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If a Windows NT 3.5 print server running Services for Macintosh captures an AppleTalk print device in its zone whose name in Print Manager is the same as the print device name, the following problems will occur whenever the print server loses its c...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWP,QAB5,QAUJ,QBVV,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Server Spools Jobs Endlessly if AppleTalk Print Device Removed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 30, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123156</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a Windows NT 3.5 print server running Services for Macintosh captures an
AppleTalk print device in its zone whose name in Print Manager is the same
as the print device name, the following problems will occur whenever the
print server loses its connection to the print device:

<UL><LI>On the Windows NT print server, the printer will send new print jobs to
   itself, rather than to the print device, in an endless loop.

<LI>If the print device later becomes available, the Windows NT print server
   will not recapture it.
<P>
</UL><h2>CAUSE</h2>
 
<P>
When a Windows NT print server captures an AppleTalk print device, it
creates a network connection to that print device. Once the connection is
established, the print device stops advertising its name on the zone, and
the Windows NT print server starts using the print device's name for the
print server's print share name.
<P>
If the print server loses its connection to the print device, the print
server issues an AppleTalk NBPLookup() call, using the print device's
original name, in an attempt to reestablish the connection. Because the
Windows NT print server is advertising its print share under that name, and
the real AppleTalk print device is not available on the network, the
Windows NT print server responds to its own NBPLookup(). At this point, the
server establishes a connection to what it believes to be the print device,
but what is really the server's print share. Instead of sending new jobs to
the print device, the print server starts sending job to itself in an
endless loop.
<P>
If the original AppleTalk print device again becomes available on the
network, the scenario described above does not change. The AppleTalk print
device looks for it's original name on the zone and finds the Windows NT
print server already using that name. To avoid a name conflict, the print
device creates a new name for itself by appending a number to the end of
its original name, incrementing the number until the name is unique.
Because the print server looks for the device under its original name, it
will never find the print device.
<P>
This problem does not occur in native Macintosh networks, because
AppleShare print servers clear AppleTalk printer names whenever they lose
their connections. The AppleShare solution is not an option in Windows NT
3.5, because of the more flexible printing architecture provided by Windows
NT. Windows NT lets network clients send print jobs even if the print
device is not immediately available. The AppleShare solution would prohibit
this functionality. Also, Windows NT can create printer pools in which jobs
sent to one print share are distributed over several print devices. The
AppleShare solution would require removing a shared printer pool from the
network whenever one device in the pool became unavailable.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid these problems, do either of the following before you capture an
AppleTalk print device in Print Manager:

<UL><LI>Make the Windows NT printer name different from the AppleTalk print
   device name.

<LI>Put the AppleTalk print device and the Windows NT server in different
   AppleTalk zones.
<P>
</UL>If these workarounds are not feasible, you can minimize the problem by not
shutting down and restarting AppleTalk print devices except when absolutely
necessary.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT Server version
3.5. This problem was corrected in Windows NT version 3.51.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbprint kbbug3.50 kbfix3.51<BR>
KBSubcategory: ntmac ntprint ntprotocol NTSrvWkst<BR>
Additional reference words: sfm prodnt 3.50<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 30, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
