

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automatically Reset DHCP Leases for Win95/WinNT/WFWG Clients </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154488">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1996/08/07">
<META NAME="Keywords" CONTENT="nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If a scope is removed in DHCP Manager and another scope is defined, Microsoft-based DHCP clients will not automatically renew their lease to conform to the new scope.  CAUSE =====  The DHCP clients will not renew their leases automatically until ha...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QAXB,QBWQ,QDJJ,QARL,QDL9,QBWN,QDJG,QAM2,QA63,QDIR,QAC9,QDNQ,QBCU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automatically Reset DHCP Leases for Win95/WinNT/WFWG Clients</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154488</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows 95
<LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a scope is removed in DHCP Manager and another scope is defined,
Microsoft-based DHCP clients will not automatically renew their lease to
conform to the new scope.
<P>
<P><h2>CAUSE</h2>
 
<P>
The DHCP clients will not renew their leases automatically until half of
the lease time has expired. Microsoft DHCP Server cannot force clients to
renew their leases when the DHCP scope has changed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two ways the DHCP client computers will renew their leases
automatically:

<UL><LI>Wait until half of the allotted lease time expires. The clients will
   then renew their leases automatically.

<LI>Force a DHCP client to renew its lease by doing one of the following:
<P>
<P><PRE>    - On a Windows NT Workstation or Server or a Windows for Workgroups
      3.11 DHCP client, use the Ipconfig.exe utility with the /RENEW option
      at a command prompt:
</PRE><P>
<PRE>         ipconfig /renew

      -or-

    - On a Windows 95 DHCP client, use the Winipcfg.exe utility. On the
      Start menu, choose Run and type the following and click OK:

         winipcfg

      In the dialog box, select the RENEW option.

</PRE></UL>In networked environments with a very large number of clients, the
preferred method to force clients to renew their leases is to use the
IPCONFIG /RENEW command in an Windows NT login script. This method works
correctly in a Windows NT and Windows for Workgroups 3.11 networking
environment.
<P>
However, with the introduction of Windows 95, the command-line option is no
longer available. Use the Ipconfig.exe utility from Windows for Workgroups
3.11. This utility works correctly with Windows 95 computers and the
IPCONFIG /RENEW option can once again be used for these computers.
<P>
The following is an example of a Windows NT login script for automatically
renewing DHCP clients, assuming Ipconfig.exe from Windows for Workgroups
3.11 is on \\Server\Win95. For this example, drive letter Y was used. Any
available drive letter can be used for this purpose.
<P>
<PRE>  NET USE Y: \\SERVER\WIN95
  IF EXIST C:\WINDOWS\IPCONFIG.EXE IPCONFIG.EXE /RENEW ;WFW
  IF EXIST C:\WINNT35\SYSTEM32\IPCONFIG.EXE IPCONFIG.EXE /RENEW ;WINNT
  IF EXIST C:\WINDOWS\WINIPCFG.EXE Y:\IPCONFIG.EXE /RENEW ;WIN95
  NET USE  Y: /d ; Deleting the drive letter mapping
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords          : nttcp kbnetwork<BR>
Version           : 3.11 3.5 3.51 4.0 95<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
