

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Macintosh Clients Connected to WinNT Server Appear to Hang </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158796">
<META NAME="KBModify" CONTENT="1997/04/07">
<META NAME="KBCreate" CONTENT="1996/11/06">
<META NAME="Keywords" CONTENT="kbbug3.51 kbbug4.00 kbfix4.00.sp2 kbnetwork ntmac">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Any application that uses the AFP command CatSearch, such as the Macintosh File Find, may reduce the server's responsiveness to other Macintosh clients on the network, causing them to appear to stop responding for a brief period of time.  This prob...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDO9,QA7T,QARL,QBU8,QAGI,QAFI,QBXS,QA5C,QA4P,QBXB,QAY2,QATJ,QAHT,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Macintosh Clients Connected to WinNT Server Appear to Hang</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158796</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Any application that uses the AFP command CatSearch, such as the Macintosh
File Find, may reduce the server's responsiveness to other Macintosh
clients on the network, causing them to appear to stop responding for a
brief period of time.
<P>
This problem will only occur when there are a large number of Macintosh
clients on the network and the Macintosh volume on the Windows NT server
contains a very large number of directories and files.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Windows NT 3.51, support for the AFP CatSearch command was added. This
command is used so the Macintosh client asks the server to do the search,
rather than performing the search of the Macintosh volume itself. CatSearch
instructs Windows NT to look through all directories and files, based on
the specified search parameters. When this search is performed at the root
of a Macintosh volume with many directories, subdirectories, and files, it
can delay the processing of requests from other Macintosh clients and the
Macintosh clients will appear to stop responding while they wait for their
request to be processed.
<P>
RESOLUTION
 
<P>
To Disable CatSearch for a particular SFM volume:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Install the Windows NT 4.0 Service Pack 2.

<P><LI>Run Rededt32.exe and go to the following registry location:
<P>
<P><PRE>     HKLM\System\CurrentControlSet\Services\MacFile\Parameters\Volumes
</PRE>
<P><LI>Select the volume on which you want to disable CatSearch, and then
   select Multi String from the Edit menu.

<P><LI>Add "DisableCatsearch=1" without the quotes.

<P><LI>Exit the registry editor, and then stop and restart Services for
   Macintosh.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT versions 3.51
and 4.0. This problem was corrected in the latest Microsoft Windows NT 4.0
U.S. Service Pack. For information on obtaining the service pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>How AFP CatSearch Works</h3>
 
<P>
There are several ways Macintosh clients search a remote volume. One way is
to use Enumerate, which looks similar to Microsoft’s FindFirst, FindNext,
which is a client-based search. This method puts responsibility on the
client (and some stress on the network). Another way is for a client to
send a server-based command, CatSearch, which puts all of the
responsibility and stress on the server. This method is used by most
Macintosh applications, such as the FindFile utility, by default. This
command, in effect, makes the Services for Macintosh (SFM) server do the
file search on behalf of the client. The way SMF is designed on Windows NT,
other users are locked out of the volume until the search is complete. If
the Macintosh volume has a large number of directories and files (number of
directories makes a bigger impact), and the search is started at or near
the root of the volume, the search may impact other users. This becomes an
issue because of the way the Macintosh operating system performs network
I/O. The Macintosh uses synchronous calls to the network, and any delay in
response from the server causes the Macintosh to stop responding. The
Macintosh File Find interface allows users to search sub-directories, but
the default is the entire volume and the other option isn't very obvious.
This causes most file searches from the Macintosh to be done on the entire
volume. If applications and users were more selective, file look-ups would
not impact the system.
<P>
<P><h3>Possible Affect of Disabling AFP CatSearch on the Server</h3>
 
<P>
When the AFP CatSearch command is disabled, Macintosh clients may
experience long delays when performing Find File from the Macintosh
desktop. The delays can be significant. A Windows NT server performing the
AFP CatSearch request may lock the SFM volume for only a few moments, but
when AFP CatSearch is disabled, a client may take several minutes, or more,
to complete the same task. When disabling the AFP CatSearch command, users
are advised that, if they do initiate a Find File, they may expect delays
or long hangs while the Macintosh is performing this task.
<P>
If a Find File is used with care, then disabling the CatSearch may become
unnecessary. Users who need to perform the Find File should narrow down
their choices to a few directories, rather than searching an entire volume.
Also, extremely large volumes with lots of subfolders can increase the
problem. If the File Find is being used constantly to access information,
consider using a text file with the path to the needed file or a database
that keeps a list of files in a particular volume. These methods can
significantly improve server response.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt sfm<BR>
Keywords            : kbbug3.51 kbbug4.00 kbfix4.00.sp2 kbnetwork ntmac<BR>
Version             : 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
