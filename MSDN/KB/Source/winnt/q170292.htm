

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Internet Control Message Protocol (ICMP) Basics </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170292">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/06/17">
<META NAME="Keywords" CONTENT="NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Internet Control Message Protocol (ICMP) is an error reporting and diagnostic utility and is considered a required part of any IP implementation. Understanding ICMP and knowing what can possibly generate a specific type of ICMP is useful in diagnos...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAGI,QA7O,QAP2,QAEV,QAVZ,QA7N,QAAY,QAM5,QAK6,QAYC,QDN1,QBWO,QBWD,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Internet Control Message Protocol (ICMP) Basics</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170292</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, and 2.11
<LI>Microsoft Systems Management Server versions 1.0 and 1.1
<LI>Microsoft Windows NT Add-On SubSystem for Presentation Manager
<LI>Microsoft LAN Manager version 2.2c
<LI>Microsoft Windows for Workgroups version 3.11
<LI>Microsoft TCP/IP-32 for Windows for Workgroups, versions 3.11, 3.11a,
   and 3.11b
<LI>Microsoft Windows 95
<LI>Microsoft Network Client version 3.0 for MS-DOS
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Internet Control Message Protocol (ICMP) is an error reporting and
diagnostic utility and is considered a required part of any IP
implementation. Understanding ICMP and knowing what can possibly generate
a specific type of ICMP is useful in diagnosing network problems.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
ICMPs are used by routers, intermediary devices, or hosts to communicate
updates or error information to other routers, intermediary devices, or
hosts.
<P>
Each ICMP message contains three fields that define its purpose and
provide a checksum. They are TYPE, CODE, and CHECKSUM fields. The TYPE
field identifies the ICMP message, the CODE field provides further
information about the associated TYPE field, and the CHECKSUM provides a
method for determining the integrity of the message.
<P>
The TYPES defined are:
<P>
TYPE   Description
----   -----------
0      Echo Reply
3      Destination Unreachable
4      Source Quench
5      Redirect Message
8      Echo Request
11     Time Exceeded
12     Parameter Problem
13     Timestamp Request
14     Timestamp Reply
15     Information Request (No Longer Used)
16     Information Reply (No Longer Used)
17     Address Mask Request
18     Address Mask Reply
<P>
<P><h3>Echo Request &amp; Echo Reply</h3>
 
<P>
This is the ICMP most used to test IP connectivity commonly known as PING.
The Echo Request ICMP will have a Type field of 8 and a Code field of 0.
Echo Replies have a Type field of 0 and a Code field of 0.
<P>
<P><h3>Destination Unreachable</h3>
 
<P>
When a packet is undeliverable, a Destination Unreachable, Type 3, ICMP is
generated. Type 3 ICMPs can have a Code value of 0 to 12:
<P>
Type 3
Code
<PRE>Value   Description
-----   -----------
0       Network Unreachable
1       Host Unreachable
2       Protocol Unreachable
3       Port Unreachable
4       Fragmentation needed and DF (Don't Fragment) set
5       Source route failed
6       Destination Network unknown
7       Destination Host unknown
8       Source Host isolated
9       Communication with Destination Network Administratively Prohibited
10      Communication with Destination Host Administratively Prohibited
11      Network Unreachable for Type Of Service
12      Host Unreachable for Type Of Service

</PRE><h3>Source Quench</h3>
 
<P>
An ICMP Source Quench message has a Type field of 4 and Code 0. Source
Quench messages are sent when the destination is unable to process traffic
as fast as the source is sending it. The Source Quench ICMP tells the
source to cut back the rate at which it is sending data. The destination
will continue to generate Source Quench ICMPs until the source is sending
at an acceptable speed.
<P>
<P><h3>Redirect Message</h3>
 
<P>
An intermediary device will generate an ICMP Redirect Message when it
determines that a route being requested can be reached either locally or
through a better path. Redirect Message ICMPs are Type 5 and are further
defined by the following Code field values:
<P>
Type 5
Code
<PRE>Value   Description
-----   -----------
0       Redirect datagrams for the Network
1       Redirect datagrams for the Host
2       Redirect datagrams for the Type of Service and Network
3       Redirect datagrams for the Type of Service and Host

</PRE><h3>Time Exceeded</h3>
 
<P>
If a router or host discards a packet due to a time-out, it will generate
a Time Exceeded Type 11 ICMP. The Time Exceeded ICMP will have a Code
value of either 0 or 1. A Code 0 is generated when the hop count of a
datagram is exceeded and the packet is discarded. A Code 1 is generated
when the reassemble of a fragmented packet exceeds the time-out value.
<P>
<P><h3>Parameter Problem</h3>
 
<P>
When an intermediary device or host discards a datagram due to inability
to process, an ICMP 12 is generated. Common causes of this ICMP are
corrupt header information or missing options. If the reason for the ICMP
is a required missing option, the ICMP will have a Code value of 1. If the
Code value is 0, the Pointer field will contain the octet of the discarded
datagram's header where the error was detected.
<P>
<P><h3>Timestamp Request &amp; Timestamp Reply</h3>
 
<P>
Timestamp Request and Timestamp Reply is a rudimentary method for
synchronizing the time maintained on different devices. The Request has a
Type field of 13 and the Reply is Type 14. This method for time
synchronization is crude and unreliable. Therefore, it is not heavily
used.
<P>
<P><h3>Information Request &amp; Information Reply</h3>
 
<P>
These ICMP types were originally designed to allow a booting host to
discover an IP address. This method is obsolete and is no longer used.
Most common methods for IP address discovery are BOOTP (bootstrap
protocol) and DHCP (dynamic host configuration protocol). BOOTP is defined
by RFC1542, and DHCP is defined by RFC1541. For information about
Microsoft's implementation of DHCP, please see the following Microsoft
Knowledge Base article:
<P>
ARTICLE ID: <B><A HREF="../WINNT/Q169289.htm">Q169289</A></B>
<PRE>TITLE     : DHCP (Dynamic Host Configuration Protocol) Basics

</PRE><h3>Address Mask Request &amp; Address Mask Reply</h3>
 
<P>
A booting computer to determine the subnet mask in use on the local
network uses the Address Mask Request ICMP Type 17. An intermediary device
or computer acting as an intermediary device will reply with a Type 18
ICMP Address Mask Reply ICMP.
<P>
References:
<P>
For more information about ICMP, see RFC950, RFC792, and RFC1122.
<P>
RFCs may be obtained via the Internet as follows:
<P>
Paper copies of all RFCs are available from the NIC, either individually
or on a subscription basis (for more information, contact
NIC@NIC.DDN.MIL). Online copies are available via FTP or Kermit from
NIC.DDN.MIL as rfc/rfc####.txt or rfc/rfc####.PS (#### is the RFC number
without leading zeros).
<P>
Additionally, RFCs may be requested through electronic mail from the
automated NIC mail server by sending a message to SERVICE@NIC.DDN.MIL with
a subject line of "rfc ####" for text versions, or a subject line of "rfc
####.PS" for PostScript versions. To obtain the RFC index, the subject
line of your message should read "rfc index".
 
<PRE>Keywords          : NTSrvWkst nttcp kbnetwork
Version           : WinNT:2.2,3.1,3.5,3.51,4.0;Windows:3.11,95
Platform          : winnt</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
