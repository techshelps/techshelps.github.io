

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error Messages Caused by Incorrect Serial Port Configuration </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112584">
<META NAME="KBModify" CONTENT="1997/04/04">
<META NAME="KBCreate" CONTENT="1994/03/15">
<META NAME="Keywords" CONTENT="kbhw nthw ntregistry">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If you configure a serial port incorrectly in the Ports option of Control Panel, there are several error messages that may appear in Event Viewer after you restart the computer. For example, you may receive the following error message:     User con...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJ9,QAB4,QAKG,QDJP,QDIZ,QAHC,QAAP,QBWP,QAC2,QAM4,QAB5,QAEF,QBTX,QADN,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Messages Caused by Incorrect Serial Port Configuration</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112584</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you configure a serial port incorrectly in the Ports option of Control
Panel, there are several error messages that may appear in Event Viewer
after you restart the computer. For example, you may receive the following
error message:
<P>
<PRE>   User configuration data for parameter COM2 overriding firmware
   configuration data.

</PRE>The specific error message that appears depends on which configuration
parameter is incorrect. The three main sources of serial errors are Input
Output (I/O) address conflicts, hardware interrupt (IRQ) conflicts, and
configuring serial ports that do not exist.
<P>
<P><h2>CAUSE</h2>
 
<P>
<P><h3>Incorrect I/O Address</h3>
 
<P>
Suppose you have added a serial port or serial device to your computer
since you first installed Windows NT. You can use the Advanced Settings
dialog to configure the port. In the Advanced Settings dialog, you can
configure a COM port number, a Base I/O Port Address, and an Interrupt
Request Line (IRQ). If you assign an I/O address to the new COM port, and
that I/O address is already assigned to another COM port, one of the
following error message appears in Event Viewer after you restart the
computer:
<P>
<PRE>   The Control registers for COMx overlaps with the COMy control registers.

</PRE>or
<P>
<PRE>   A Conflict has been detected between two drivers which claimed two
   overlapping I/O port regions.

</PRE>where x and y represent the number of the COM port. This error message
appears even if you create a duplicate entry for the same COM port, thus
making x and y the same number.
<P>
<P><h3>Incorrect IRQ Setting</h3>
 
<P>
On ISA and EISA computers, COM1 and COM3 both use IRQ 4, and COM2 and COM4
both use IRQ 3. Thus you can configure COM1 - COM4 to their respective
interrupts, but if you configure one of these COM ports to an IRQ being
used by any other device, an error message appears. Suppose, for example,
you configured COM4 to IRQ 5, and you have a bus mouse on the system also
configured to IRQ 5; the following error message appears in Event Viewer
after you restart the computer:
<P>
<PRE>   A conflict has been detected between two drivers which claimed
   equivalent IRQs. Driver &lt;driver name&gt;, with device &lt;\Device\device name.
   Translated&gt; claimed an interrupt with level in data address &lt;hex
   address&gt;, vector in data address &lt;hex address&gt; and Affinity in data
   address &lt;hex address&gt;.

</PRE>There will be an entry with this format in Event Viewer for each of the
conflicting devices.
<P>
After identifying the IRQ conflict, Event Viewer then displays another
warning about using the COM port in question:
<P>
<PRE>   The hardware resources for COM&lt;X&gt; are already in use by another device.

</PRE><h3>COM Port Doesn't Exist</h3>
 
<P>
An error message appears in Event Viewer if you attempt to configure a COM
port that physically does not exist on the system. Suppose you went to the
Ports option in Control Panel and added a COM3 port, when in fact you
physically only have COM1 and COM2 on the system. The following error
message appears in Event Viewer the next time you restart the computer:
<P>
<PRE>   While validating that COM3 was really a serial port, the contents of the
   divisor latch register was identical to the interrupt enable and receive
   registers. The device is assumed not to be a serial port and will be
   deleted.

</PRE>This error message means that the system will delete the I/O address entry
for the non-existent port in the Windows NT internal I/O port address
table. The entry for this non-existent port will still exist in the Ports
option of Control Panel and in the appropriate key of the Registry.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To clear these messages from Event Viewer, do one of the following:

<UL><LI>Use the Advanced Settings dialog box to change the I/O, IRQ, or the COM
   Port Number setting
<P>
   -or-

<LI>Delete the appropriate entry from the Windows NT Registry using Registry
   Editor.
<P>
</UL>Using the Advanced Settings dialog box clears the error messages in many
cases, but in two cases you need to delete certain entries in the Registry:

<UL><LI>If you want to change the settings for a COM port already detected at
   Setup by NTDETECT.
<P>
   -or-

<LI>If the COM port in question doesn't physically exist on the system.
<P>
</UL>In the first case, the Advanced Settings option will not be available. In
the second case, no facility exists in the Ports dialog box to delete the
entry for the non-existent COM port.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
<PRE>   problems that may require you to reinstall Windows NT to correct them.
   Microsoft cannot guarantee that any problems resulting from the use of
   Registry Editor can be solved. Use this tool at you own risk.

</PRE>To delete the false entry from the Registry, use the Registry Editor
(REGEDT32.EXE) to find the following key:
<P>
<PRE>   \HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet
       \Services\Serial\Parameters

</PRE>The Parameters key lists one or more subkeys listed as Serial10000,
Serial10001, and so on. Check the DosDevice value to find which subkey
represents the non-existent COM port. Then, highlight the subkey for the
erroneous serial port and choose Delete from the Edit menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbhw nthw ntregistry<BR>
Version             : 3.1 3.5 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
