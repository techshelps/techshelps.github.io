

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Recover From a STOP 0x00000058 FTDISK_INTERNAL_ERROR </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128630">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1995/10/31">
<META NAME="Keywords" CONTENT="ntfault">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The following STOP error message appears when you start Windows NT:     STOP: 0x00000058    FTDISK_INTERNAL_ERROR  The system was booted from a revived primary partition so the hives indicate that the mirror is OK, when in fact it is not. The  real...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMA,QALX,QAC9,QDIR,QBWP,QAFV,QAY2,QAB4,QDIV,QAGB,QAEF,QBWS,QAAJ,QDIU,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Recover From a STOP 0x00000058 FTDISK_INTERNAL_ERROR</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128630</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following STOP error message appears when you start Windows NT:
<P>
<PRE>   STOP: 0x00000058
   FTDISK_INTERNAL_ERROR

</PRE>The system was booted from a revived primary partition so the hives
indicate that the mirror is OK, when in fact it is not. The "real" image
of the hives are on the shadow drive. You must boot from the shadow drive.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If for any reason your primary operating system drive fails or goes
off-line while in a raid level-1 mirrored configuration, Windows NT
continues to run from the mirrored drive and flags the registry hives on
the current drive to reflect the broken mirror.
<P>
If you perform a normal shutdown at this point, revive the primary
operating system drive, and then perform a normal boot, the STOP:0x58
FTDISK_INTERNAL_ERROR error message appears.
<P>
Windows NT uses this protection mechanism because processing continued on
the shadow drive while the primary drive was off-line. Any data saved
to the shadowed drive would be lost if you were permitted to boot from the
primary drive again.
<P>
To guard against data loss and fully recover from the STOP error message
above:

<OL><P><LI>Using a Windows NT Fault Tolerance boot floppy disk, boot from
   the mirrored (secondary) system drive.
<P>
</OL>SEE ID: <B><A HREF="../WINNT/Q119467.htm">Q119467</A></B>
Titled: Creating a Boot Disk for an NTFS or FAT Partition

<OL><P><LI>Run Disk Administrator. Notice that the primary operating system
   disk partition is red, indicating that the mirror is broken. Notice
   that the primary drive will show the drive letter "C:". It must be
   changed to a new drive letter by breaking the mirror.

<P><LI>Using Disk Administrator, officially break the mirror:
<P>
   a. Highlight the partition.
<P>
   b. Select Fault Tolerance and choose Break Mirror.
<P>
   c. On the Partition menu, click Commit Changes Now.
<P>
   NOTE: If a message appears indicating that the mirror set cannot
   be locked and the system will need to be restarted in order to
   complete the breakage, choose YES.
<P>
   NOTE: Although the data on the primary disk is older than the data on
   the secondary disk you have the option at this point to boot to the
   primary disk using the older data and re-establishing the mirror.
   Simply reverse the drive assignments in the following steps.  This
   also may allow you to over come the problem listed in the warning
   listed in step 4.

<P><LI>Once the mirror is successfully broken and you have two separate
   partitions, do a tape backup of the mirrored drive you are currently
   running from. This is the most current data you have and contains all
   the information saved since the primary operating system drive failed.
<P>
   NOTE: This is only a precautionary step because you are no longer in a
   fault tolerant configuration. You can skip this step if you are under
   time constraints, but Microsoft does not recommend you do so if
   critical data is involved.
<P>
   WARNING: There may be cases when disk mirroring with unlike drives or
   controller types could cause the mirrored partition to be larger
   than the original master partition. If the two partitions are not the
   exact same size in Disk Administrator, do not follow this procedure
   any further because you will not be able to re-mirror to a smaller
   partition size later. Instead, restore from the backup tape you made in
   this step to the primary system partition. Proceed to Step 9 after
   completing the restore.

<P><LI>Mark active the primary partition on the secondary drive.  A reboot
   may be required.  Complete this step before continuing.
<P>
   Delete the primary drive partition so you can re-mirror the current
   operating system back to the primary drive:
<P>
   a. Select the primary drive partition
<P>
   b. On the Partition menu, click Delete.
<P>
   c. On the Partition menu, click Commit Changes Now.
<P>
   NOTE: You may need to move the paging file to another drive and reboot
   before you are allowed to delete the partition.
<P>
   NOTE: If the entire primary C drive was mirrored and does not
   contain another primary partition to mark active, Disk Administrator
   will not allow you to delete the active partition. In this situation,
   moving the drive to a secondary non-bootable drive position (SCSI
   I.D greater than 0 or slave IDE drive) should allow you to delete the
   primary partition. If this is not possible, you can use Norton
   Utilities Disk Editor (Diskedit.exe) to remove the boot flag from the
   partition table manually.

<P><LI>Re-mirror the drives:
<P>
   a. Select the current operating system drive partition and while
<P><PRE>      holding down the CTRL key.
</PRE><P>
   b. Select the free space created in Step 5.
<P>
   c. On the Fault Tolerance menu click Establish Mirror.
<P>
   d. On the Partition menu click Commit Changes Now.
<P>
   You can verify the mirror is established by either exiting and
   re-starting Disk administrator to check on the status of the mirror, or
   look for an Event:19 from Source:FTDISK in the system event log
   indicating that the mirror initialization or synchronization is
   complete.

<P><LI>Once this mirror is successfully established, you have a snapshot of
   the most current data onto the primary disk. Unfortunately you cannot
   reboot from the primary disk at this time because it is only a mirror.
   You cannot boot from a mirror while the master is active. You must re-
   break the mirror again by following Step 3 above.

<P><LI>Once the mirror is broken, mark the partition active if it is the
   primary boot partition.

<P><LI>Perform a normal shutdown and reboot from your primary operating
   system drive. Once Windows NT is running, delete the partition and
   then re-establish the mirror to regain your fault tolerant RAID-1
   configuration.
<P>
</OL><h3>Alternative Quick Recovery Method</h3>
 
<P>
An quick alternative way to recover is outlined below, but may result
in possible data loss. Use at your own risk.

<OL><P><LI>Boot from a Windows NT Fault tolerant boot disk to the mirrored
   drive (secondary drive).

<P><LI>Break the mirror in Disk Administrator.

<P><LI>Shutdown the computer and remove the secondary drive.

<P><LI>Boot from the primary drive.

<P><LI>Run Disk Administrator and make sure that the primary is not listed
   as a mirror.

<P><LI>Shutdown the computer and add the secondary drive. Restart the
   computer.
<P>
   NOTE: At this point, you should be able to access information on both
   drives safely and separately.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt tolerance trap 0x58 blue<BR>
Keywords          : ntfault<BR>
Version           : 3.5 3.51<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
