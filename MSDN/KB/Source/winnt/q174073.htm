

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Auditing User Authentication </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174073">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/09/18">
<META NAME="Keywords" CONTENT="ntdomain ntsecurity NTSrv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article contains tips for interpreting security auditing events related to user authentication.  These events will all appear in the Security event log and will be logged with a source of Security.  MORE INFORMATION  EventID   Description ----...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QAGU,QBRZ,QAK7,QAAD,QBWF,QBWG,QBWP,QBW7,QAO4,QBG2,QAPN,QAJ6,QAMB,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Auditing User Authentication</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174073</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains tips for interpreting security auditing events
related to user authentication.
<P>
These events will all appear in the Security event log and will be logged
with a source of Security.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<PRE>EventID   Description
-------   -----------
   514     An authentication package has been loaded by the LSA
   515     A trusted logon process has registered with the LSA
   518     A notification package has been loaded by the Security
           Account Manager
   528     Successful Logon
   529     Logon Failure: Unknown user name or bad password
   530     Logon Failure: Account logon time restriction violation
   531     Logon Failure: Account currently disabled
   532     Logon Failure: The specified user account has expired
   533     Logon Failure: User not allowed to logon at this computer
   534     Logon Failure: The user has not been granted the requested
           logon type at this machine
   535     Logon Failure: The specified account's password has expired
   536     Logon Failure: The NetLogon component is not active
   537     Logon Failure: An unexpected error occurred during logon
   538     User Logoff
   539     Logon Failure: Account locked out

</PRE>For more information security events, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: 174074
   TITLE     : Security Event Descriptions

</PRE><h3>Security Identifiers (SIDs)</h3>
 
<P>
Some security events report SIDs instead of user names. In this case,
it is often difficult to determine which user account is being referred
to in the event.
<P>
It is possible to build a list of mappings of user names to SIDs by
performing the following steps:

<OL><P><LI>Dump the user list to a text file with the NET USERS command or with
   Addusers.exe.

<P><LI>Modify this text file to remove unwanted information (headers, and so
   forth).

<P><LI>Modify the resulting list of user names into a batch file, using the
   GETSID resource kit utility to translate each user name into a SID.
   Redirect the output to a text file.

<P><LI>When you encounter a SID, search the text file (created previously)
   for that SID. This will place you on the line with the user's name.
<P>
</OL><h3>Logon Type</h3>
 
"Logon Type" will be one of the following:
<PRE>   2  Interactive
   3  Network
   4  Batch
   5  Service
   6  Proxy
   7  Unlock Workstation
   (0 &amp; 1 are invalid)

</PRE></OL><h3>Logon Process</h3>
 
"Logon Process" will be one of the following:
<P>
<PRE>  "msv1_0" or "MICROSOFT_AUTHENTICATION_PACKAGE_V1_0":
     msv1_0.dll, the default authentication package

  "KSecDD":
     ksecdd.sys, the security device driver

  "User32" or "WinLogon\MSGina":
     winlogon.exe &amp; msgina.dll, the authentication user interface

  "SCMgr":
     The Service Control Manager

  "LAN Manager Workstation Service"

  "advapi"
   API call to LogonUser

</PRE><h3>User Rights</h3>
 
<P>
For more detail on user rights, please see the following Microsoft
Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q101366.htm">Q101366</A></B>
   TITLE     : Definition and List of Windows NT Advanced User Right

</PRE>For more information on auditing user right changes, please see the
following Microsoft Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q163905.htm">Q163905</A></B>
   TITLE     : Auditing User Right Assignment Changes

</PRE><h3>Supplemental Information</h3>
 
<P>
For more information on user authentication, please see the following
Microsoft Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q102716.htm">Q102716</A></B>
   TITLE     : User Authentication with Windows NT

</PRE>For more information on authentication on networks, see:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q122422.htm">Q122422</A></B>
   TITLE     : Example of Remote Logon with Windows NT Server
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: secevent sec<BR>
Keywords          : ntdomain ntsecurity NTSrv<BR>
Version           : WinNT:3.5,3.51,4.0<BR>
Platform          : winnt<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
