

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WinNT Err: No Drives to Disconnect After RCMD Session </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158273">
<META NAME="KBModify" CONTENT="1997/11/06">
<META NAME="KBCreate" CONTENT="1996/10/27">
<META NAME="Keywords" CONTENT="nt32ap ntreskit NTSrv ntutil kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When a user runs a batch file or is performing a NET USE command with the Remote Command Client application (RCMD) to a server running the Remote Command service. NET USE initiates a remote connection to a file service on a third system.  If the ba...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QANN,QBV8,QAB9,QAGU,QAI5,QAEF,QBJ4,QAC9,QAGB,QBG2,QAVZ,QACK,QBWS,QAIM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WinNT Err: No Drives to Disconnect After RCMD Session</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158273</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a user runs a batch file or is performing a NET USE command with the
Remote Command Client application (RCMD) to a server running the Remote
Command service. NET USE initiates a remote connection to a file service on
a third system.
<P>
If the batch command or user does not disconnect the drive created with NET
USE before RCMD terminates, the connection remains as a resource
connection, but is not reported in the NET USE command on the RCMD client
or the Remote Command server. The drive letter is committed and cannot be
released or reused.
<P>
If a user then uses File Manager (in Windows NT 3.51 and 4.0), Explorer (in
Windows NT 4.0), or My Computer (in Windows NT 4.0) on the computer running
the Remote Command Service, they see the drive letter but when they try to
delete or open it the following messages appear:
<P>
In Windows NT 3.51 File Manager
<P>
<PRE>   No drives to disconnect

</PRE>In Windows NT 4.0 with X: being the drive letter that was created
during NET USE from the Remote client in Explorer, File Manager, and My
Computer.
<P>
<PRE>   X:\ is not accessible.
   Logon failure: unknown user name or bad password.

   NOTE: A drive letter will appear on a Windows NT 4.0 computer running
   the Remote Command service, but will not be accessible to the user of
   that system. If a user tries to access it or remove it they will get the
   error indicated above.

   Also, when the connection is made, the drive letter will dynamically
   appear in both Explorer and My Computer. If the connection is deleted,
   it will dynamically disappear from each of these applications. File
   Manager in Windows NT 4.0 will not dynamically add or remove the drive
   letter. File Manager must be closed and restarted for any changes to
   appear.

</PRE><h2>CAUSE</h2>
 
<P>
The REMOTE command is carried out in a different user context than that of
the NET USE command on the computer running the Remote Command service.
After the REMOTE command session is terminated, the drive designator
created by NET USE is orphaned with no further relationship to any user or
system context.
<P>
This is similar to use of the AT scheduling command. Unless the command is
configured properly, the AT service does not have access to resources
because the resources were available under another user context.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are three possible resolutions:

<UL><LI>During the REMOTE command session, make sure to remove (delete) all
   file resource connections before terminating the session.
<P>
   -or-

<LI>Restart the remote client application again, connect to the remote
   command server, and delete the resource connection. Then close the
   remote client application.
<P>
   -or-

<LI>If the remote command session has already been terminated (and can't
   be restarted), restart the computer running the Remote Command service
   and all orphaned connections will be cleared.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
RCMD and the Remote Command service are included with the Microsoft
Windows NT Resource Kit version 3.5x and Microsoft Windows NT Server
Resource Kit version 4.0.
<P>
<P><h3>On Connections To Printer Resources</h3>
 
<P>
NET USE commands to print resources do not appear in Print Manager or the
Printers application (selected by clicking the Start button, pointing to
Settings, clicking Control Panels, and then clicking Printers) or from a
command line NET VIEW command on the Windows NT computer running the Remote
Command service.
 
<PRE>Keywords          : nt32ap ntreskit NTSrv ntutil kberrmsg kbtool
Version           : WinNT:3.5,3.51,4.0
Platform          : winnt
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 6, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
