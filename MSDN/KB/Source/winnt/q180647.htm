

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Disabling WinNT 3.51 Video Drivers to Enable Unattend Install </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180647">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1998/02/06">
<META NAME="Keywords" CONTENT="ntsetup NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information on how to do this, view the  Restoring the Registry  online Help t...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDNL,QDI2,QAC1,QBTX,QBRZ,QDK0,QAYS,QAU9,QAA5,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Disabling WinNT 3.51 Video Drivers to Enable Unattend Install</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180647</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A system running Windows NT 3.51 and using Windows NT 3.51 OEM video
drivers may be unable to complete an unattended upgrade to Windows NT 4.0.
Specific entries must be made to the Windows NT 3.51 registry using the
utility Regini.exe, located in the Windows NT resource kit.
<P>
<P><h2>MORE INFORMAION</h2>
 
<P>
The procedure below creates registry entries not normally found in a
Windows NT 3.51 installation. These keys are necessary to complete an
unattended installation upgrade from a computer running Windows 3.51 and
using OEM video drivers to a base VGA (16 colors and 640x480 resolution)
installation of Windows NT 4.0. If an unattended installation of Windows NT
4.0 is not required, you may manually switch video drivers from the OEM
version to a default VGA setting, through Control Panel, and begin the
upgrade process.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, perform the following steps:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" online Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" online Help
topics in Regedt32.exe. Note that you should back up the registry before
you edit it.

<OL><P><LI>Create a text file including the following lines of text and save it as
   35vidoff.ini. The spacing must be exactly as shown below.
<P>
<P><PRE>      \HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\XXXXXXXX
<PRE></PRE>               Start=REG_DWORD 0x4

   NOTE: Replace XXXXXXXX with the Registry subkey associated with your
   currently loaded OEM video driver.

</PRE><P><LI>Create a second text file including the following lines of text and save
   it as 35addreg.ini. The spacing must be exactly as shown below.
<P>
<P><PRE>      \HKEY_LOCAL_MACHINE\System\CurrentControlSet\Hardware Profiles
      \0001\System\CurrentControlSet\Services\VGASave\Device0
      
<PRE></PRE>                  DefaultSettings.BitsPerPel=REG_DWORD 0x4
                  DefaultSettings.XResolution=REG_DWORD 0x280
                  DefaultSettings.YResolution=REG_DWORD 0x1e0
                  DefaultSettings.VRefresh=REG_DWORD 0x1
                  DefaultSettings.Flags=REG_DWORD 0x0
                  DefaultSettings.XPanning=REG_DWORD 0x0
                  DefaultSettings.YPanning=REG_DWORD 0x0


   NOTE: The above registry key is one path; it has been wrapped for
   readability.

</PRE><P><LI>From a Windows NT 3.51 command line, run "Regini.exe 35vidoff.ini" and
   "Regini.exe 35regadd.ini" (without the quotation marks).

<P><LI>Immediately begin your Windows NT 4.0 unattended installation upgrade.
   Do not restart prior to beginning this upgrade.

<P><LI>After the upgrade is completed, you may make changes to the Display
   properties by using the Display tool in Control Panel.
</OL> 
<PRE>Keywords          : ntsetup NTSrvWkst kbsetup
Version           : WinNT:3.51,4.0
Platform          : winnt
Hardware          : x86
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
