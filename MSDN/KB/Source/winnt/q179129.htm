

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>STOP 0x0000000A or 0x00000019 Due to Modified Teardrop Attack </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179129">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1998/01/09">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00 NTSrvWkst nttcp">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Windows NT may stop responding (hang) with a STOP 0x0000000A or 0x00000019 message after receiving a number of deliberately corrupted UDP packets.  CAUSE =====  This behavior occurs due to a variation of the  teardrop  attack. Windows NT 4.0 with S...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAR4,QAM1,QBE7,QBE6,QDL9,QBWQ,QBWO,QBWN,QDO3,QAYV,QDIX,QAGB,QAKP,QDJO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>STOP 0x0000000A or 0x00000019 Due to Modified Teardrop Attack</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179129</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
<LI>Microsoft Windows NT Server Enterprise Edition version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Windows NT may stop responding (hang) with a STOP 0x0000000A or 0x00000019
message after receiving a number of deliberately corrupted UDP packets.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs due to a variation of the "teardrop" attack. Windows
NT 4.0 with Service Pack 3 and the ICMP-fix is not susceptible to the
original form of the teardrop attack. For more information on the ICMP-
fix, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../CROSSNET/Q154174.htm">Q154174</A></B>
   TITLE     : Invalid ICMP Datagram Fragments Hang Windows NT, Windows 95

</PRE>The modified teardrop attack works by sending pairs of deliberately
constructed IP fragments which are reassembled into an invalid UDP
datagram. Overlapping offsets cause the second packet to overwrite data in
the middle of the UDP header contained in the first packet in such a way
that the datagrams are left incomplete.
<P>
As Windows NT receives these invalid datagrams, it allocates kernel
memory. If enough of these invalid datagrams are received Windows NT may
hang with a STOP 0x0000000A or 0x00000019.
ntoskrnl!KeBugCheckEx+0x1be
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
To resolve this problem, obtain the following fix or wait for the next
Windows NT service pack.
<P>
This fix should have the following time stamp:
<P>
<PRE>   01/09/98  08:16a               143,664 Tcpip.sys   (Intel)
   01/09/98  08:13a               263,536 Tcpip.sys   (Alpha)

</PRE>This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/</A></B>
   hotfixes-postSP3/teardrop2-fix/

</PRE>NOTE: The above link is one path; it has been wrapped for readability.
<P>
NOTE: This hotfix supersedes the fix referred to in the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q143478.htm">Q143478</A></B>
   TITLE     : Stop 0A in TCPIP.SYS When Receiving Out Of Band (OOB) Data

   ARTICLE-ID: <B><A HREF="../CROSSNET/Q154174.htm">Q154174</A></B>
   TITLE     : Invalid ICMP Datagram Fragments Hang Windows NT, Windows 95

   ARTICLE-ID: <B><A HREF="../WINNT/Q165005.htm">Q165005</A></B>
   TITLE     : Windows NT Slows Down Due to Land Attack

   ARTICLE-ID: <B><A HREF="../WINNT/Q177245.htm">Q177245</A></B>
   TITLE     : Multiprocessor Computer May Hang Because of Tcpip.sys

</PRE><h3>Windows NT 3.51</h3>
 
<P>
To resolve this problem, obtain the following fix.
<P>
This fix should have the following time stamp:
<P>
<PRE>   01/14/98  12:04p               123,824 Tcpip.sys   (Intel)
   01/14/98  12:00p               216,848 Tcpip.sys   (Alpha)

</PRE>This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT351/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT351/</A></B>
   hotfixes-postSP5/teardrop2-fix/

</PRE>NOTE: The above link is one path; it has been wrapped for readability.
<P>
NOTE: This fix supercedes the ICMP-fix, the OOB-fix, and the Land-fix
hotfixes.
<P>
<P><h2>STATUS</h2>
 
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
<P><h3>Windows NT 3.51</h3>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51. A
supported fix is now available, but is not fully regression tested and
should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Product Support Services for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 3.51 spoof crash crashes bonk.c boink.c<BR>
Keywords          : kbbug4.00 kbfix4.00 NTSrvWkst nttcp<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
