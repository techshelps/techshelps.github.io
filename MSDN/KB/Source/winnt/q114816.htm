

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Faster 8.3 Converted Long Filenames in NTFS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114816">
<META NAME="KBModify" CONTENT="1997/05/15">
<META NAME="KBCreate" CONTENT="1994/05/12">
<META NAME="Keywords" CONTENT="kbother ntfilesys">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Several Long Filename to 8.3 (MS-DOS compatible) name conversion performance enhancements have been introduced in Windows NT Workstation and Windows NT Server version 3.5. These enhancements include a faster worst- case scenario algorithm, as well ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAUJ,QARM,QAJQ,QDL9,QBWQ,QBWO,QBWN,QA5E,QA2S,QABU,QBWD,QDNL,QBHE,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Faster 8.3 Converted Long Filenames in NTFS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114816</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Windows NT 3.5 Server
<LI>Windows NT 3.5 Workstation
<P>
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Several Long Filename to 8.3 (MS-DOS compatible) name conversion
performance enhancements have been introduced in Windows NT Workstation and
Windows NT Server version 3.5. These enhancements include a faster worst-
case scenario algorithm, as well as improved context retention across
enumeration calls. Although these changes yield substantial improvements,
you should continue to avoid using numerous long, similar names.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Windows NT version 3.1, worst-case file manipulation of extremely large
directories (500 to several thousand files) with similar long names was
time consuming. This was evident when receiving screen output from a DIR
command or reading a directory in File Manager.
<P>
In Windows NT 3.5, NTFS has been enhanced to address these worst-case
scenarios as well as other general improvements in 8.3 enumeration.
<P>
Under Windows NT 3.1 NTFS, longfile names are converted to 8.3 names to
support DOS based clients.  This conversion simply takes the first 6
characters of the long name, and uses a "~n" suffix (where "n" is number)
to keep the name unique if needed.  When the tenth filename is converted
and the suffix exceeds 2 characters, only 5 characters of the name are used
to accommodate the three characters in the suffix and so on as needed. For
example:
<P>
<PRE>   MyTermPaper.doc   becomes  MYTERM~1.DOC
   MyTermPaper2.doc  becomes  MYTERM~2.DOC
   MyTermPaper3.doc  becomes  MYTERM~3.DOC
   MyTermPaper4.doc  becomes  MYTERM~4.DOC
   MyTermPaper5.doc  becomes  MYTERM~5.DOC
   MyTermPaper6.doc  becomes  MYTERM~6.DOC
   MyTermPaper7.doc  becomes  MYTERM~7.DOC
   MyTermPaper8.doc  becomes  MYTERM~8.DOC
   MyTermPaper9.doc  becomes  MYTERM~9.DOC
   MyTermPaper10.doc becomes  MYTER~10.DOC
   MyTermPaper11.doc becomes  MYTER~11.DOC

</PRE>That algorithm had been changed in Windows NT 3.5 for enhanced performance.
Since the occurrences of similar 8.3 names is generally minimal, only the
first four attempts at generating the 8.3 name work like they did in
Windows NT 3.1. The fifth attempt takes the first two characters of the
long name, then the next four characters are generated by a hashing
function of the entire name, and the last two characters are "~5". Only
when the hashing of the middle four characters no longer produces a unique
name will the "~5" be incremented to "~6" and so on. For example:
<P>
<PRE>   MyTermPaper.doc   becomes  MYTERM~1.DOC
   MyTermPaper2.doc  becomes  MYTERM~2.DOC
   MyTermPaper3.doc  becomes  MYTERM~3.DOC
   MyTermPaper4.doc  becomes  MYTERM~4.DOC
   MyTermPaper5.doc  becomes  MY1E2E~5.DOC
   MyTermPaper6.doc  becomes  MY1EEE~5.DOC
   MyTermPaper7.doc  becomes  MY1EAE~5.DOC

</PRE>Subsequent iterations are performed faster than under Windows NT 3.1.
<P>
NOTE: By avoiding using long names that are similar in the first 6
characters, enumeration are even more efficient.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt lfn long name<BR>
Keywords            : kbother ntfilesys<BR>
Version             : 3.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
