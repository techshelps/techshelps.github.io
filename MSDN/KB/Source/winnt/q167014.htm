

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DHCP Client May Fail to Obtain a DHCP-Assigned IP Address </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167014">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1997/04/16">
<META NAME="Keywords" CONTENT="NTSrvWkst nttcp kbnetwork kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When a DHCP client is moved from one subnet to another, it may fail to obtain a valid IP address on the new subnet.  RESOLUTION  To work around this problem, do one of the following:   -  Do not use IP addressing schemes that overlap.     -or-   - ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAC2,QDJG,QARL,QAR5,QBWO,QAJQ,QABI,QBW4,QAGI,QABH,QDL9,QBWN,QAY2,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DHCP Client May Fail to Obtain a DHCP-Assigned IP Address</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167014</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51 and 4.0
<LI>Microsoft Windows for Workgroups version 3.11
<LI>Microsoft TCP/IP-32 for Windows for Workgroups, versions 3.11, 3.11a,
   and 3.11b
<LI>Microsoft Windows 95
<LI>Microsoft Network Client version 3.0 for MS-DOS
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a DHCP client is moved from one subnet to another, it may fail to
obtain a valid IP address on the new subnet.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, do one of the following:

<UL><LI> Do not use IP addressing schemes that overlap.
<P>
   -or-

<LI>Run the following commands after you move the client to a new
   segment:
<P>
<P><PRE>      Ipconfig /Release
      Ipconfig /Renew
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
When a DHCP client that has previously had a DHCP-assigned address is
started again, the client goes into an INIT-REBOOT state. The client will
attempt to verify that it can still use the same address by sending a
DHCPRequest packet, populating the DHCP Option Field "DHCP Requested
Address" with the previously assigned IP address.
<P>
If the DHCP server remains silent, the client assumes the previous address
is still valid and keeps it. If a DHCP server sends a NACK packet in
response to the DHCPRequest, the client goes into the Discover cycle;
it also requests the previously assigned address in the DHCPDiscover
packet.
<P>
When a DHCP server receives a DHCPRequest with a previously assigned
address specified, it first checks to see if it came from the local segment
by checking the GIADDR field. If it originated from the local segment, the
DHCP server compares the requested address to the IP address and subnet
mask belonging to the local interface that received the request.
<P>
If the address appears to be on the same subnet, the DHCP server will
remain silent even if the address is not in the range of its pool of
addresses. The DHCP server assumes that the address was assigned by
another DHCP server on the same segment if it is not from its own pool. If
the address fails the subnet mask/IP address check, the DHCP server
checks to see if it came from a Superscope, if one is defined. If not,
the server responds to the DHCPRequest with a NACK packet.
<P>
If the client sending the DHCPRequest is requesting an address that appears
to be on the same subnet but was actually assigned with a different subnet
mask, the DHCP server will remain silent and the client will fail to obtain
a valid IP address for the new subnet.
<P>
For example, assume the DHCP client obtains address 172.17.3.x with a
subnet mask of 255.255.255.0, and the client is moved to a new segment
where the address of the DHCP server is 172.17.1.x with a subnet mask of
255.255.0.0. When the subnet mask/IP address comparison is done on the DHCP
server, the DHCP server will remain silent, assuming another DHCP server on
the segment assigned the address. If the subnet masks were reversed, the
client would obtain a valid address.
 
<PRE>Keywords          : NTSrvWkst nttcp kbnetwork kbhowto
Version           : WinNT:3.5,3.51,4.0;Windows:95
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
