

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPS Fails to Clone a Server with WINS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142662">
<META NAME="KBModify" CONTENT="1997/04/10">
<META NAME="KBCreate" CONTENT="1996/01/16">
<META NAME="Keywords" CONTENT="kbnetwork NTSrv nttcp">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Computer Profile Setup (CPS) utility in the Windows NT Resource Kit allows you to set up Windows NT Workstation or Windows NT Server on multiple, identical x86-based computers. However, when you try to duplicate a Windows NT Server that has Win...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QDIK,QA9N,QDL9,QBWQ,QBWO,QBWN,QBE7,QBE6,QAFO,QASB,QBKX,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>CPS Fails to Clone a Server with WINS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142662</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Computer Profile Setup (CPS) utility in the Windows NT Resource Kit
allows you to set up Windows NT Workstation or Windows NT Server on
multiple, identical x86-based computers. However, when you try to duplicate
a Windows NT Server that has Windows Internet Naming Service (WINS), CPS
fails to set up a Windows NT Server with WINS.
<P>
CPS uses two utilities: one to make a copy of an installed Windows NT
system and one to set up new Windows NT systems using this copy. When CPS
is used to duplicate a Windows NT Server system with WINS installed, the
WINS service fails to start on the newly installed Windows NT servers and
WINS has to be reinstalled.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is due to the fact that a WINS database built on a particular
system cannot be used on another system with another IP address. Therefore
CPS does not copy the Wins.mdb file on the target platform.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q140971.htm">Q140971</A></B>
   TITLE     : WINS Service Generates a System Error 1 Incorrect Function

</PRE><h2>WORKAROUND</h2>
 
<P>
The following workaround allows you to set up a fresh installation of WINS
along with CPS.

<OL><P><LI>Install a Windows NT 3.51 Server with WINS service.

<P><LI>Copy the Resource Kit CPS files under C:\CPS.

<P><LI>Modify C:\Cps\Profile.ini as required.

<P><LI>Run C:\Cps\Uplodprf -s:X:\FLAT, where X:\FLAT is the directory used for
   future installations.

<P><LI>Remove all WINS files in the flat:
<P>
<P><PRE>       del X:\FLAT\WINNT35.0\SYSTEM32\WINS\*.*
</PRE>
<P><LI>Insert Windows NT Server distribution compact disc in the CD-ROM (in the
   example below it is drive D) and carry out the following commands :
<P>
<P><PRE>      copy D:\I386\SYSTEM.MD_  X:\FLAT\WINNT35.0\SYSTEM32\WINS
      X:
      cd \FLAT\WINNT35.0\SYSTEM32\WINS
      attrib -r SYSTEM.MD_
      expand -r SYSTEM.MD_
      del X:\FLAT\WINNT35.0\SYSTEM32\WINS\SYSTEM.MD_
</PRE><P>
</OL>This will restore the distribution file System.mdb. When WINS is installed
on a server, the System.mdb distribution file is copied to
%SystemRoot%\System32\WINS and a new Wins.mdb database file is created the
first time the WINS server attempts to start.

<OL><P><LI>Modify Dosnet.inf as follows:
<P>
</OL>NOTE: Because some files have been removed from the WINS subdirectory, the
Dosnet.inf file included in X:\FLAT must be modified so that you are
not prompted with an error message stating that these files could not be
copied.
<P>
<PRE>   Edit X:\FLAT\DOSNET.INF and remove the following three lines :

      d10,Jet.log
      d10,winstmp.mdb
      d10,wins.mdb

</PRE><P><LI>Run WINNTP on the target platform.
<P>
</OL>WINS will be installed on the target platform and a new WINS database will
be created. If you need to use the WINS entries of the master server, you
need to configure pull/push partners.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows NT
version 3.51. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbnetwork NTSrv nttcp<BR>
Version             : 3.51<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
