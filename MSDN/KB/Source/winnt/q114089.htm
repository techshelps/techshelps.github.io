

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Windows NT NetDDE Share Manager </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114089">
<META NAME="KBModify" CONTENT="1997/04/04">
<META NAME="KBCreate" CONTENT="1994/04/25">
<META NAME="Keywords" CONTENT="kbtool nt16ap NTSrvWkst ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Before applications can share data, they must establish a communication channel called a trusted share. APIs exist for creating Network DDE shares under Windows for Workgroups 3.1x, but applications you write using these APIs cannot communicate whe...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3A,QBWP,QAZ2,QA0K,QAGU,QAUJ,QAJH,QAI5,QBWS,QBW7,QBWO,QAK7,QAAD,QBWG,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using the Windows NT NetDDE Share Manager</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114089</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation version 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server version 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Before applications can share data, they must establish a communication
channel called a trusted share. APIs exist for creating Network DDE shares
under Windows for Workgroups 3.1x, but applications you write using these
APIs cannot communicate when run on Windows NT systems because they can't
create trusted shares.
<P>
The Windows NT DDE Share Manager allows you to create and manage Network
DDE shares. This article discusses how to use Share Manager to create a
DDE share for an application that runs on Windows NT, rather than
rewriting
the application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are two types of DDE applications: source and destination. The DDE
source application defines the DDE Share on the system on which it runs
and
provides data to the DDE destination application.
<P>
To run the DDE Share Manager, execute DDESHARE.EXE, located in the
WINNT\System32 sub-directory. Two shared-folder icons are shown. The first
lists all shares on the system and the second (checked) lists the shares
trusted by the currently logged on user.
<P>
To view a share's properties:

<OL><P><LI>Select the Shares menu.
</OL>2. Select DDE Shares or double-click on the unchecked shared-folder icon.
3. Select the share name then select Properties.
<P>
A default installation of Windows NT will have three existing shares:
Chat$, CLPBK$, and Hearts$.
<P>
<P><h3>Step One: Creating a Share</h3>
 
<P>
When adding a new share, you are required to provide three properties:

<UL><LI>Share Name: This is used by the destination program when it requests
   data. By convention, system DDE share names end with a dollar sign ($).

<LI>Application Name: This is for the Service name used by the DDE source
   application. Generally, each application provides only one DDE service,
   the name of which usually matches the application name. Do not include
   extension or path information.

<LI>Topic Name: This is a general name for a set of data. One service can
   have multiple topics. The source application defines the topic name,
   and the destination application uses it to request specific data.
<P>
</UL>Since there are now two types of Network DDE, Share Manager offers three
text-boxes for application and topic name, allowing you the option of
including application and topic names in "old style," "new style," or in
the "static" field. If you are creating a share used to communicate with
an existing Windows for Workgroups application, enter the application name
and topic name in the "static" field. Old style DDE is message-based; new
style DDE uses a DDE Management Library--a layer that sits on top of the
DDE protocol. An application written specifically for Windows NT can take
advantage of the new style DDE. Having these entries allows for different
naming conventions while still providing old and new style DDE programs
access to the shared data through the same share name.
<P>
The option "Start Application on Connect" lets the destination application
initiate a conversation with a source application that isn't running at
the
moment, although it must be in the system path. If you select the "In
Service" option the program must be registered to the Windows NT system
as a service, for example Chat. The "Item Security" options control access
to the data items within a topic. For some applications, you may need to
restrict access to specific items. Under "Item Security" select "Grant
access only to these items" and enter the item names. If no restrictions
are required, select "Grant access to all items."
<P>
You can specify permissions for any user known to the NT security system,
set up specific permissions for each user who will be accessing the share,
and limit a user to specific DDE actions. The default allows everyone read
and link permissions.
<P>
When you select OK, the share is created and the share information is
written to the registry in the following location:
<P>
<PRE>   \HKEY_LOCAL_MACHINE\Software\Microsoft\NetDDE\DDE Shares\sharename\...

</PRE></OL><h3>Step Two: Trusting the Share</h3>
 
<P>
On the Windows NT system, the Network DDE DSDM service maintains a
database
of shared conversations. When a Network DDE share is accessed, the shared
conversation is referenced and security checks determine if the requester
can be granted access. Applications on a computer run in the "security
context" of the user who is interactively logged on to the computer, so
when a remote request is serviced by a running application on a computer
sharing a Network DDE conversation, the application handling the request
runs in the security context of the user logged onto the sharing computer,
not in the security context of the remote user.
<P>
This design complicates security issues. If, for instance, a remote user
who establishes a Network DDE share and remotely connects to it while
someone else is logged on, has the same access privileges to the sharing
computer as the logged on user. To avoid this violation, users logged onto
the source machine cannot access its applications unless they have this
share in their trusted shares list.
<P>
To add the share to the list of trusted shares, highlight the share name
and select "trust share." Select the options that apply in the context of
the currently logged on user. The trusted share information is written to
the registry in the path:
<P>
<PRE>   \HKEY_CURRENT_USER\Software\Microsoft\NetDDE\DDE Trusted Shares
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt NddeShareAdd NDdeShare<BR>
Keywords            : kbtool nt16ap NTSrvWkst ntutil<BR>
Version             : 3.1 3.5 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
