

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NTFS Performance Problem with Many Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130839">
<META NAME="KBModify" CONTENT="1995/06/01">
<META NAME="KBCreate" CONTENT="1995/05/30">
<META NAME="Keywords" CONTENT="kbhw kbbug3.10 kbbug3.50">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  An NTFS volume containing a very large number of files may exhibit degradation in performance when you create new files.  CAUSE =====  In an effort to provide consistently good performance, the Windows NT file system (NTFS) reserves a portion of di...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW5,QBWP,QAMR,QAU3,QAY5,QANY,QAWH,QA7T,QAR4,QAKC,QBI8,QBC6,QAKP,QADP,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>NTFS Performance Problem with Many Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130839</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation version 3.5
<LI>Microsoft Windows NT Server version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An NTFS volume containing a very large number of files may exhibit
degradation in performance when you create new files.
<P>
<P><h2>CAUSE</h2>
 
<P>
In an effort to provide consistently good performance, the Windows NT file
system (NTFS) reserves a portion of disk space for use by the file system
itself. In situations where very little disk space is available, Windows NT
may need to release some of this space in order to allocate space for user
files. In the vast majority of cases, this algorithm works well. In one
specialized case, however, it is possible for the algorithm to actually
degrade performance by a significant amount.
<P>
The worst case occurs if all of the following conditions are true:

<UL><LI>NTFS is formatted with a smaller cluster factor than the default.

<LI>Less than 1/8th of the total disk space is available.

<LI>The volume has never had more files on it at one time than it has now.
<P>
</UL>The problem described here only occurs when you create new files, and the
total number of files is being increased to a number greater than ever
before. The magnitude of the performance degradation depends on the history
of file creation on the volume. It is possible to observe degradation with
as few as several hundred thousand files. It is also possible to create
more than two million files on a single volume without observing
significant performance degradation depending on the pattern of file
creation.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, reduce the total number of files on the volume
or reformat the volume. To minimize the impact of the problem when a very
large number of files is required, attempt to create the smaller files
first before most of the disk space is already in use.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.5. A
fix to this problem is in development, but has not been regression-tested
and may be destabilizing in production environments. Microsoft does not
recommend implementing this fix at this time. Contact Microsoft Product
Support Services for more information on the availability of this fix.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbhw kbbug3.10 kbbug3.50<BR>
KBSubcategory: ntfilesys<BR>
Additional reference words: 3.10 3.50 prodnt huge one-eight<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 1, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
