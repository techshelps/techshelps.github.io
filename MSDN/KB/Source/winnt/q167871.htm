

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error When Connecting to a Share on WinNT 4.0 NTFS Partition </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167871">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1997/05/01">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00 nt32ap NTINTEROP NTSrvWkst kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you try to connect to a share on a computer running Microsoft Windows NT version 4.0 through a UNC name, you may receive the following error:     The directory is not a subdirectory of the root directory  This only occurs when connecting to a ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QA3A,QBWQ,QDL9,QBWO,QBWN,QAI5,QDKX,QAR4,QAFI,QA0K,QARL,QAKP,QAC1,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error When Connecting to a Share on WinNT 4.0 NTFS Partition</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167871</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project for Windows 95 version 4.1
<LI>Microsoft Office for Windows 95 versions 7.0, 7.0a, and 7.0b
<LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to connect to a share on a computer running Microsoft
Windows NT version 4.0 through a UNC name, you may receive the following
error:
<P>
<PRE>   The directory is not a subdirectory of the root directory

</PRE>This only occurs when connecting to a share on a Windows NT version 4.0
NTFS partition from a Windows NT version 3.51 client, using one of the
applications listed at the beginning of this article.
<P>
This symptom may also occur in Systems Management Server with a Windows NT
3.51 Systems Management Server site server and a Windows NT 4.0 logon or
distribution server. An Error 144 may be seen in the Maintman.log file when
Systems Management Server checks for free disk space on the logon or
distribution server.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, perform one of the following steps:

<UL><LI>Map a network drive to the share.
<P>
   - or-

<LI>Rather than sharing a folder off another subfolder, share the folder
   that resides directly off the root drive.
<P>
   - or -

<LI>In Program Manager, click File, and then type the UNC path and filename
   to the document.
<P>
   - or -

<LI>Upgrade the Windows NT version 3.51 clients to Windows NT version 4.0.
<P>
   - or -

<LI>Upgrade the Microsoft Office 95 clients to Microsoft Office 97 because
   this problem does not occur in Office 97.
<P>
</UL>For additional information on share name limitations of Windows 95,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../CROSSNET/Q160843.htm">Q160843</A></B>
   Title     : Win95 Clients Cannot See Long Share Names on
               WinNT 4.0 Servers

</PRE>To resolve the problem, obtain the following fix or wait for the next
Windows NT service pack.
<P>
This fix should have the following time stamp:
<P>
<PRE>   05/27/97  04:59 PM                61,392 Cdfs.sys (Intel)
   05/27/97  04:45 PM               355,664 Ntfs.sys (Intel)

   05/27/97  12:59 PM               102,704 Cdfs.sys (Alpha)
   05/27/97  12:45 PM               549,104 Ntfs.sys (Alpha)

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The above symptom does not occur in the following scenarios:

<UL><LI>Connecting from a Windows NT 4.0 client to a Windows NT 4.0 share.

<LI>Connecting from a Windows 95 client to either Windows NT 3.51 or Windows
   NT 4.0 shares.

<LI>Connecting to a share located on a FAT partition.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: off7 off95 acc95 xl95 ppt95 word95 access<BR>
excel powerpoint word sub-directory<BR>
Keywords          : kbbug4.00 kbfix4.00 nt32ap NTINTEROP NTSrvWkst kbinterop<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
