

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing 3rd-Party Video Drivers with Txtsetup.oem Unattended </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166028">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/03/28">
<META NAME="Keywords" CONTENT="ntdriver ntreskit ntsetup NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  By default, Windows NT 4.0 unattended setup uses a detection method to determine the correct video driver to use. If no video driver can be initialized, the default VGA driver will be used.  The following types of video adapters are known not to be...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QAU9,QDI2,QDK0,QAYS,QDJS,QBXB,QATJ,QDIZ,QAFI,QABA,QABI,QBXM,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Installing 3rd-Party Video Drivers with Txtsetup.oem Unattended</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166028</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default, Windows NT 4.0 unattended setup uses a detection method to
determine the correct video driver to use. If no video driver can be
initialized, the default VGA driver will be used.
<P>
The following types of video adapters are known not to be automatically
detected in Windows NT 4.0:

<UL><LI>8514a
<LI>Trident
<LI>VGA
<P>
</UL>Some third-party video drivers are located in the Drvlib\Video directory.
If your video adapter is not on the Windows NT compact disc, check with
the manufacturer for support for Windows NT 4.0.
<P>
With unattended setup, the installation of OEM video drivers is
accomplished using the [DisplayDrivers], [Display], and [OEMBootFiles]
sections of the unattended answer file.
<P>
The configuration of OEM video drivers is an advanced function of Windows
NT unattended configuration. The information regarding the Txtsetup.oem
that is discussed in this article can be found in the Windows NT 4.0 Device
Driver Kit (DDK) in Chapter 2, Section 2.1. The syntax and format of the
Txtsetup.oem file is also available in the Windows NT 4.0 Deployment Guide
in Chapter 2, in the section "TXTSETUP.OEM and [OEMBootFiles]."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To prepare for the installation of an OEM video driver, perform the
following steps:

<OL><P><LI>Copy the I386 directory from the Windows NT 4.0 compact disc to a
   server, and then share the directory.

<P><LI>In the I386 directory, create an $OEM$ directory.

<P><LI>In the $OEM$ directory, create a Textmode directory.

<P><LI>Copy the OEM video drivers to the Textmode directory created in
   Step 3(XXXXXXXX.dll, XXXXXXXX.sys).

<P><LI>Create a Txtsetup.oem file and place it in the Textmode directory. This
   file tells Windows NT Setup how to install the DLL and SYS drivers, and
   how to configure the registry.
<P>
   To simplify the creation of the Txtsetup.oem file, copy the example
   provided and save it as Txtsetup.oem.
<P>
   The following is the format for Txtsetup.oem. In most cases, this file
   will require very little modification.
<P>
<P><PRE>      [Disks]
      d1 = "OEM Video Disk",\OEMVideo.tag,\
</PRE><P>
<P><PRE>      [Defaults]
      DISPLAY = S3Virge
</PRE><P>
<P><PRE>      [DISPLAY]
      S3Virge = "S3 Virge - OEM"
</PRE><P>
<P><PRE>      [Files.display.S3Virge]
      driver = d1,s3virge.sys,s3virge
      dll = d1,s3virge.dll
</PRE><P>
<P><PRE>      [Config.s3virge]
      value=device0,InstalledDisplayDrivers,REG_MULTI_SZ,S3ViRGE
      value=device0,VgaCompatible,REG_DWORD,0
</PRE><P>
   This is a standard Txtsetup.oem file that will install the S3 Virge
   video driver that is supplied in the Drvlib directory on the Windows
   NT 4.0 compact disc.

<P><LI>Add OEMPreInstall = YES to the [Unattended] section of the answer file.
<P>
   This is used to tell Setup that the $OEM$ directory is going to be used
   during setup. For example:
<P>
<P><PRE>      [Unattended]
      OemPreInstall = Yes
</PRE>
<P><LI>Ensure that the NtUpgrade value in the Unattend section of Unattend.txt
   is not set to Yes.
<P>
<P><PRE>     [Unattended]
     NtUpgrade = yes
</PRE><P>
   If NtUpgrade is set to Yes, the installation will appear to run normally
   but the OEM drivers do not install. If you need NtUpgrade set to Yes,
   you can perform the following steps to automate the procedure.
<P>
   A. Use the RunOnce key as described in the following Microsoft Knowledge
<P><PRE>      Base article:
</PRE><P>
<PRE>         ARTICLE-ID: <B><A HREF="../WINNT/Q167012.htm">Q167012</A></B>
         TITLE     : Setting Control Panel Tools to Start After Unattended
                     Setup

    B. Place the command "Rundll32 Shell32.dll,Control_RunDLL Desk.cpl
      @0,3" (case sensitive) in the Run-once key to bring up the desktop
      tool and have it open to the Settings tab.

   C. You can then create a script that installs the OEM drivers.

</PRE><P><LI>Add the [DisplayDrivers] section to the answer file.
<P>
<P><PRE>      [DisplayDrivers]
      "S3 Virge - OEM" = "OEM"
</PRE><P>
<P><PRE>      [Display]
      BitsPerPel = 16
      XResolution = 800
      YResolution = 600
      VRefresh = 60
      AutoConfirm = 1
</PRE>
<P><LI>Add the [OEMBootFIles] section to the answer file.
<P>
<P><PRE>      [OEMBootfiles]
      S3VIRGE.SYS
      S3VIRGE.DLL
      TXTSETUP.OEM
</PRE><P>
   The example provided is only part of the answer file needed for a
   complete Windows NT 4.0 unattended installation.
<P>
</OL>The following is an example for the Matrox Millennium drivers supplied by
Matrox from its download service. Steps 1-8 above are the same, with the
difference being the name of the driver files, option name, and the
registry options.
<P>
<PRE>   [Disks]
   d1 = "OEM Video Disk",\oemvideo.tag,\

   [Defaults]
   DISPLAY = MGA64

   [DISPLAY]
   MGA64 = "my mga64 driver - oem"

   [Files.display.mga64]
   driver = d1,mga64.sys,mga64
   dll = d1,mga64.dll

   [Config.mga64]
   value=device0,InstalledDisplayDrivers,REG_MULTI_SZ,mga64
   value=device0,VgaCompatible,REG_DWORD,0

</PRE></OL>The following is an example of the required information needed in the
unattend answer file:
<P>
<PRE>   [Unattended]
   OemPreInstall = Yes

   [DisplayDrivers]
   "my mga64 driver - oem" = OEM"

   [Display]
   BitsPerPel = 16
   XResolution = 800
   YResolution = 600
   VRefresh = 60
   AutoConfirm = 1

   [OEMBootfiles]
   MGA64.SYS
   MGA64.DLL
   TXTSETUP.OEM

</PRE>NOTE: This method of installing video drivers will only install the video
driver itself. Additional utilities or applications provided by the
manufacturer will have to be installed through other methods. Contact the
video driver vendor for information on automation options for their
products.
<P>
The products listed here are manufactured by vendors independent of
Microsoft; we make no warranty, implied or otherwise, regarding these
products' performance or reliability.
<P>
For the latest information on Windows NT deployment, download the Windows
NT 4.0 Deployment Guide from the following location:
<P>
<PRE>   <B><A HREF="http://www.microsoft.com/ntworkstation/">http://www.microsoft.com/ntworkstation/</A></B>

</PRE>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q155197.htm">Q155197</A></B>
   TITLE     : Unattended Setup Parameters for Unattend.txt File
</PRE> 
<PRE>Keywords          : ntdriver ntreskit ntsetup NTSrvWkst kbsetup
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
