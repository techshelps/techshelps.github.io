

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Network Components Without the Control Panel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162771">
<META NAME="KBModify" CONTENT="1997/12/04">
<META NAME="KBCreate" CONTENT="1997/01/28">
<META NAME="Keywords" CONTENT="ntsetup NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  In order to install network components (for example, network adapters, network protocols or network services), you must use the Protocols, Services, or Adapters tab in Control Panel and then click Add to install the proper network component.  This ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBTX,QAVZ,QDIZ,QAJG,QBV8,QAB5,QBWP,QAGI,QAQW,QA6A,QAH6,QAUJ,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Installing Network Components Without the Control Panel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162771</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.51 and 4.0
<LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In order to install network components (for example, network adapters,
network protocols or network services), you must use the Protocols,
Services, or Adapters tab in Control Panel and then click Add to install
the proper network component.
<P>
This article is aimed at providing a way to install any network component
from a batch file, assuming you know the INF file name and the option. This
information can be applied to install network components that are shipped
with Windows NT, or to install any third-party component as soon as an
Oemsetup.inf file is provided.
<P>
WARNING: The solution provided in this article doesn't compute the
bindings. Therefore, if the bindings need to be done after the installation
of a network component, the user will have run the Network Control Panel
tool manually.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
CAUTION: The solution included in this article has not been extensively
tested in large installations. Microsoft cannot guarantee that modification
of network components as recommended herein will accomplish the objective
described in this article under all circumstances and in all
configurations.
<P>
The Network Control Panel tool (loaded from a file called Ncpa.cpl) takes
control over all setup of network components. When you add a network
component through the interface, Ncpa.cpl tells Setup.exe to call
Ncpashel.inf with specific parameters.
<P>
Instead of using the Network Control Panel tool, it is possible to call
Setup.exe with the following parameters:
<P>
SETUP.EXE /f /i%systemroot%\system32\ncpashel.inf
<PRE>          /T NTN_InstallMode = Install
          /T NTN_Origination = install
          /T NTN_Infname = OEMSETUP.INF
          /T NTN_SRCPATH = D:\I386
          /T NTN_Infoption = OPTION

</PRE>The command line above must be entered as a single line. Here is a
description of all the parameters:
<P>
<PRE>/f                 = Turns off blue background
</PRE>/T NTN_InstallMode = Install, Remove, Update, Configure or Bind
<PRE>                     This option is identical to the GUI interface
</PRE>/T NTN_Origination = Install (= NCPA when setup issued by NCPA.CPL)
<PRE>/T NTN_Infname     = Name of the INF file name
/T NTN_SRCPATH     = Path to the distribution files
/T NTN_Infoption   = Name of the option. To figure out which option has
                     to be installed, open the INF file and search for the
                     section [Options].  You should find the name of the
                     option to setup.

</PRE>For example, you may install Microsoft TCP/IP Printing with a batch file
including the following commands (it is assumed below that D: is your CD-
ROM drive):
<P>
cd %systemroot%
setup /f /i%systemroot%\system32\ncpashel.inf
<PRE>      /T NTN_InstallMode = Install
      /T NTN_Origination = install /T NTN_Infname = .\OEMNSVTP.INF
      /T NTN_SRCPATH = D:\I386
      /T NTN_InfOption = TCPPRINT

</PRE>Oemnsvtp.inf is the INF file that directs installation of the Microsoft
TCP/IP Printing component. It contains the following section:
<P>
[Options]
<PRE>    TCPPRINT
</PRE> 
<PRE>Keywords          : ntsetup NTSrvWkst kbsetup
Version           : WinNT:3.51,4.0
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
