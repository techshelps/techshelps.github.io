

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HPMON Stops Working After Upgrading Multiple-NIC Computers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129987">
<META NAME="KBModify" CONTENT="1995/06/23">
<META NAME="KBCreate" CONTENT="1995/05/09">
<META NAME="Keywords" CONTENT="kbprint kbnetwork kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you reinstall or upgrade Windows NT on a computer with multiple network interface cards (NICs), the HPMON print monitor cannot send print jobs to previously defined network printers.  CAUSE =====  This happens because HPMON identifies your com...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBWP,QAKC,QAOX,QBC6,QABA,QA2O,QDI2,QAG8,QAC1,QAA5,QBT0,QAVZ,QAC2,QDIR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HPMON Stops Working After Upgrading Multiple-NIC Computers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129987</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation version 3.5
<LI>Microsoft Windows NT Server version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you reinstall or upgrade Windows NT on a computer with multiple
network interface cards (NICs), the HPMON print monitor cannot send print
jobs to previously defined network printers.
<P>
<P><h2>CAUSE</h2>
 
<P>
This happens because HPMON identifies your computer's NICs by number, and
the installation or upgrade process can change these numbers.
<P>
When you install, reinstall, or upgrade Windows NT, a number is assigned to
each NIC in your computer. The one with the lowest I/O base address is
assigned the number 0, the one with the next lowest I/O base address is
assigned the number 1, and so on. However, if you later add a new NIC to
the system, it is assigned the next unused numbers, regardless of its I/O
base addresses. Then, when you reinstall or upgrade, the numbering is
reassigned by I/O base address.
<P>
As an example, say you install Windows NT on a computer with two adapters,
NIC-A and NIC-B, with I/O base addresses of 368h and 360h, respectively.
NIC-B becomes adapter 0, and NIC-A becomes adapter 1. If you later install
another adapter, NIC-C, with I/O base address 358h, it becomes adapter 2.
Then you reinstall or upgrade Windows NT and the adapter numbers are
reassigned. NIC-C becomes adapter 0, NIC-B becomes adapter 1, and NIC-A
becomes adapter 2.
<P>
There is no way for Setup to identify services that rely on NIC numbering.
These services cannot automatically adjust to the reassigned numbers and do
not function correctly after an upgrade or reinstall.
<P>
The HPMON print monitor relies on the DLC protocol to send print jobs to
network printers equipped with HP JetDirect adapters. DLC may be bound to
multiple NICs, but HPMON only uses one of the DLC-bound NICs. It stores
that NIC's number in the registry, in the HKEY_LOCAL_MACHINE subtree in
this key:
<P>
<PRE>   \SYSTEM
     \CurrentControlSet
       \Control
         \Print
           \Monitors
             \Hewlett-Packard Network Port
               \Options
                 \Adapter

</PRE>When you upgrade the operating system and the NIC numbering changes,
the value of this registry key is left incorrect. HPMON attempts to locate
its JetDirect-equipped network printers using the wrong NIC. When this
happens, each printer in Print Manager that uses an HPMON port has a status
of "Unavailable," and jobs sent to these printers do not print.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two ways to work around this problem:

<UL><LI>If the computer has only two adapters, then you can reconfigure HPMON
   through Print Manager. Choose Properties from the Printer menu, then
   choose the Settings button, then the Options button, and change the
   Adapter value from Primary to Secondary, or from Secondary to Primary.

<LI>If the computer has more than two adapters, you can manually alter the
   registry value mentioned above. Change the value to the adapter number
   of the correct network adapter card.
<P>
   WARNING: Using the Registry Editor incorrectly can cause serious, system-
   wide problems that may require you to reinstall Windows NT to correct
   them. Microsoft cannot guarantee that any problems resulting from the
   use of the Registry Editor can be solved. Use this tool at your own
   risk.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: prodnt 3.10<BR>
KBCategory: kbprint kbnetwork kbsetup<BR>
KBSubCategory: ntprint ntsetup<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 23, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
