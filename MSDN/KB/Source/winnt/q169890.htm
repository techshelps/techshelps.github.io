

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enable PPTP Filtering Option No Longer Works </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169890">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/06/10">
<META NAME="Keywords" CONTENT="NTRAS ntrouter NTSrv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The PPTP filtering option in the Advanced IP Addressing dialog box has no effect after Routing and Remote Access Service (RRAS) is installed.  CAUSE =====  The updated Routing and Remote Access Service disables the functionality of this option by d...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QDJ0,QBWS,QA1S,QA7O,QDIZ,QA7N,QAM5,QA01,QDN9,QAP2,QAKG,QDNT,QANN,QACK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Enable PPTP Filtering Option No Longer Works</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169890</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Routing and Remote Access Service Update for Windows NT
   Server 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The PPTP filtering option in the Advanced IP Addressing dialog box has no
effect after Routing and Remote Access Service (RRAS) is installed.
<P>
<P><h2>CAUSE</h2>
 
<P>
The updated Routing and Remote Access Service disables the functionality
of this option by design. Routing and Remote Access Service includes new,
enhanced filtering capabilities. After RRAS is installed, the check box
has no functionality; therefore, PPTP filters must be configured manually.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
PPTP filtering consists of two filters. Both filters must be configured
for input and output on the interface that is the endpoint of the PPTP
connection. The four filters work together to complete a PPTP filter. The
PPTP filter will not be secure unless all four filters are set correctly.
If you enabled the PPTP Filtering option before you installed RRAS, those
filters are migrated to the new filtering facility and these filters
should already appear in the filter lists for that interface.
<P>
PPTP uses TCP port 1723 for the control channel and IP Protocol ID 47 for
the data channel.
<P>
WARNING: The PPTP filters published in the Routing and Remote Access
Service "Administrator's Guide" on pages 39-42 are incorrect. Please use
the following, more secure, filter definitions.
<P>
To add PPTP filters:

<OL><P><LI>Click Start, point to Programs, point to Administrative Tools, and
   click Routing and RAS Admin.

<P><LI>Double-click IP Routing and double-click Summary.

<P><LI>Right-click the interface on which you want to enable the filter, this
   should be the external (Internet connected) interface, and click
   Configure interface.

<P><LI>Click Input Filters in the Packet filters section of the IP
   Configuration dialog box.

<P><LI>Create the Input Filters.
<P>
   a. First Input Filter: Allow packets using the GRE Protocol. This
<P><PRE>      filter allows your router to send or receive any PPTP packets.
</PRE><P>
<P><PRE>      1. Click Add in the IP Packet Filters Configuration dialog box and
<PRE></PRE>         select Other in the Protocol drop-down list.

      2. Type 47 in the Protocol text field.

      3. Click OK.

   b. Second Input Filter: Allow packets coming to the PPTP Control Port.
      This filter allows your router to receive any PPTP Control messages.

      1. Click Add in the IP Packet Filters Configuration dialog box.

      2. Click Destination Network to check it.

      3. Type the IP address of your external adapter in the IP Address
         field and type 255.255.255.255 in the Subnet mask field.

      4. Select TCP in the Protocol drop-down list, type 0 (implying
         any)in the Source port field, and type 1723 in the Destination
         port field.

      5. Click OK.

      6. Click Drop all except listed below in the Filter Action section
         of the IP Packet Filters Configuration dialog box and click OK.

</PRE><P><LI>Click Output Filters in the IP Configuration dialog box to create a set
   of two output filters.
<P>
   a. First Output Filter: Allow packets using the GRE Protocol. This
<P><PRE>      filter allows your router to send or receive any PPTP packets.
</PRE><P>
<P><PRE>      1. Click Add in the IP Packet Filters Configuration dialog box and
<PRE></PRE>         select Other in the Protocol drop-down list.

      2. Type 47 in the Protocol text field.

      3. Click OK.

   b. Second Output Filter: Allows your router to send any PPTP Control
      messages.

      1. Click Add in the IP Packet Filters Configuration dialog box.

      2. Click Source Network to check it.

      3. Type the IP address of your external adapter in the IP Address
         field and type 255.255.255.255 in the Subnet mask field.

      4. Select TCP in the Protocol drop-down list, type 1723 in the
         Source port field, and type 0 (implying any) in the Destination
         port field.

      5. Click OK.

      6. Click Drop all except listed below in the Filter Action section
         of the IP Packet Filters Configuration dialog box.

</PRE><P><LI>Click OK in the IP Packet Filters Configuration dialog box to return to
   the Routing and RAS Admin.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The PPTP filters can be combined with Local Host filters to allow other
server-based applications such as Microsoft Proxy Server Domain Name
Service (DNS) to securely co-exist with Routing and Remote Access
Services. For more information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q169548.htm">Q169548</A></B>
   TITLE     : Using MS Proxy with Routing and Remote Access
</PRE></OL> 
<PRE>Keywords          : NTRAS ntrouter NTSrv kbnetwork
Version           : 4.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
