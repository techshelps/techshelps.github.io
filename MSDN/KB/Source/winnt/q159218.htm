

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Proper Backup of Open Files Using Ntbackup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159218">
<META NAME="KBModify" CONTENT="1997/09/04">
<META NAME="KBCreate" CONTENT="1996/11/11">
<META NAME="Keywords" CONTENT="nt32ap ntbackup NTSrvWkst ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Files may not be properly restored with a backup program (such as Windows NT Backup).  CAUSE =====  This problem can be caused by either of the following:   - Corrupt file     Some third-party backup programs set the following value to 1 during    ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3W,QDIU,QAUR,QBWP,QABI,QAKD,QBWS,QBXS,QA5E,QAPN,QAH4,QAGB,QBSO,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Proper Backup of Open Files Using Ntbackup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159218</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Files may not be properly restored with a backup program (such as Windows
NT Backup).
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem can be caused by either of the following:

<UL><LI>Corrupt file
<P>
   Some third-party backup programs set the following value to 1 during
   setup while Windows NT Backup sets this value to 0:
<P>
<P><PRE>      \\HKEY_CURRENT_USER\Microsoft
<PRE></PRE>         \Ntbackup\Backup Engine\Backup files inuse

   Open files are generally in an inconsistent state and any attempt to
   back up these files may cause corruption (for example, WINS and DHCP
   databases).

</PRE><LI>Missing file
<P>
   If the value above is set to 0, the backup program skips open files;
   therefore, some files may be missing when you restore from backup.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Perform one of the following to resolve this problem:

<UL><LI>WARNING: Using Registry Editor incorrectly can cause serious,
   system-wide problems that may require you to reinstall Windows NT to
   correct them. Microsoft cannot guarantee that any problems resulting
   from the use of Registry Editor can be solved. Use this tool at your
   own risk.
<P>
   Set the following value to 0:
<P>
<P><PRE>      \\HKEY_CURRENT_USER\Microsoft
<PRE></PRE>         \Ntbackup\Backup Engine\Backup files inuse

</PRE><LI>Make sure a consistent file is available for backup before you start the
   backup. To do this, perform one of the following:
<P>
<P><PRE>    - Application method
</PRE><P>
<P><PRE>      Use a utility for that application file that creates a good backup
      while that file is open. For example, "RDISK -s" backs up the
      registry in the \%SystemRoot%\Repair folder.
</PRE><P>
<P><PRE>      NOTE: When performing a remote backup of any server's registry, you
      must run "RDISK -S" or "RDISK /s-" on that server first because
      remote registries are not available to be backed up over the network.
</PRE><P>
<P><PRE>    - System method
</PRE><P>
<P><PRE>      Close the files before backup (for example, stop logons, close
      current sessions with existing clients, and stop all non-essential
      services). You may be able to accomplish this by using the AT command
      or the Command Scheduler (Winat.exe).
</PRE><P>
<P><PRE>    - Application and System method
</PRE><P>
<P><PRE>      The best approach may be to use both methods to make sure all data is
      accessible from a backup and to test your plan fully before
      implementing it.
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
If the following value is 1, backup programs attempt to back up open files:
<P>
<PRE>   \\HKEY_CURRENT_USER\Microsoft\Ntbackup\Backup Engine\Backup files inuse
</PRE> 
<PRE>Keywords          : nt32ap ntbackup NTSrvWkst ntutil
Version           : WinNT:3.51,4.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
