

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error C0000035: The LsaCreateSecret Call Failed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128488">
<META NAME="KBModify" CONTENT="1996/09/03">
<META NAME="KBCreate" CONTENT="1995/04/02">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Error 1057 is reported when the Startup Option  Log On As This Account  for a Windows NT Service is selected. For example, if you run Control Panel, choose Services, modify the startup options for the Directory Replicator Service, select  Log On As...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBG2,QACK,QAI5,QAB4,QAAP,QBWP,QBTX,QBXS,QBWS,QAY2,QAGI,QDIV,QAG2,QAKP,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error C0000035: The LsaCreateSecret Call Failed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128488</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Windows NT operating system version 3.1
- Microsoft Windows NT Advanced Server version 3.1
- Microsoft Windows NT Workstation version 3.5
- Microsoft Windows NT Server version 3.5
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Error 1057 is reported when the Startup Option "Log On As This Account" for
a Windows NT Service is selected. For example, if you run Control Panel,
choose Services, modify the startup options for the Directory Replicator
Service, select "Log On As This Account," select a valid user account from
the dialog box, type a valid password for the account, and then choose OK,
the following error message appears:
<P>
<PRE>   Cannot set the startup parameters for the Directory Replicator Service.
   Error 1057 occurred: The account name is invalid or does not exist"

</PRE>The following is written to the system log:
<P>
<PRE>   Event ID#: 7005
   The LsaCreateSecret call failed with the following error: C0000035""

</PRE><h2>CAUSE</h2>
 
<P>
This error occurs when the service control manager is not able to update
the registry parameters for the service because the LSA Create Secret call
failed.
<P>
The error is reproducible after manual registry modifications or Emergency
Repair has taken place. However, it has also been reported by customers on
new installations of Windows NT where registry information has not been
previously modified.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Run Registry Editor (REGEDT32.EXE) to change the replicator ObjectName:
<P>
   a. From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<PRE>         \System\CurrentControlSet\Services\Replicator

   b. Select ObjectName: REG_SZ: LocalSystem

   c. From the Edit menu choose String.

   d. Change ObjectName to Domain\Account.

   e. Choose OK.

</PRE><P><LI>Use Control Panel to change the Directory Replicator logon account.
<P>
   a. Run Control Panel and choose Services.
<P>
   b. Select Directory Replicator and choose Startup.
<P>
   c. In the Log On As box, change This Account from Domain\Account name to
<P><PRE>      LocalSystem.
</PRE><P>
   You should now be able to start the directory replicator service under
   the system account security ID.

<P><LI>Stop the service and modify the Startup Parameters to change to the
   desired user account and password. Enter the desired logon account and
   password.
<P>
</OL>The service should start without error.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The NT Service Controller stores the password as a one-way-encrypted LSA
secret, only if the ObjectName value for this service is set to
Domain\Account rather than LocalSystem. LSA secrets reside in the Registry
in an area not normally directly accessible (even to administrators). When
you change from System Account to a specific account, the service
controller creates the LSA secret for this service, and similarly it
deletes the secret when you change from a specific account to System
Account. The 0xC00000035 error usually occurs when an administrator
manually changes ObjectName from a specific account to SystemAccount. As a
result, the LSA secret still exists even though it should have been
deleted. When the administrator tries to change back to a specific account
using the Service Controller Manager interface, the Service Controller will
try to create the LSA secret, but will display error 0xC0000035
(STATUS_OBJECT_NAME_COLLISION "Object Name already exists") because the LSA
secret already exists. Microsoft recommends changing ObjectName back to a
value consistent with the LSA state, rather than to risking more extensive
damage by manually modifying the LSA section of the registry.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: ntregistry<BR>
Additional reference words: 3.10 3.50 prodnt
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
