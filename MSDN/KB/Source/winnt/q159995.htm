

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows NT Does Not Detect Previous WinNT 3.5x Install </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159995">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1996/11/26">
<META NAME="Keywords" CONTENT="kbbug4.00 ntsetup NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you attempt to upgrade your current version of Windows NT, the following error message may appear:     A previous version of Windows NT could not be found on the system,    Press F3 to exit.  If you are using the Upgrade CD-ROM Media, the foll...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QAC1,QAA5,QDIZ,QAR4,QAB4,QABI,QDL9,QBWQ,QBWO,QBWN,QBVV,QAV1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows NT Does Not Detect Previous WinNT 3.5x Install</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159995</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to upgrade your current version of Windows NT, the
following error message may appear:
<P>
<PRE>   A previous version of Windows NT could not be found on the system,
   Press F3 to exit.

</PRE>If you are using the Upgrade CD-ROM Media, the following error message may
appear:
<P>
<PRE>   No previous version of Windows NT could be found on your computer.
   Setup is unable to verify that you qualify to use this upgrade product.
   Press F3 to exit.

</PRE>If you have a previous version of Windows NT, Setup lets you install a new
copy of Windows NT 4.0, but Setup will not allow you to upgrade to Windows
NT 4.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the Registry Editor (Regedt32.exe) to modify the following values:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe) and locate the following subkey:
<P>
   Hkey_Local_Machine\System\Setup\SystemSetupInProgress
   Hkey_Local_Machine\System\Setup\UpgradeInProgress

<P><LI>Double-click SystemSetupInProgress and change the value from 1 to 0.

<P><LI>Locate the following subkey:
<P>
<P><PRE>      Hkey_Local_Machine\Software\Microsoft\WindowsNT\
      CurrentVersion\
</PRE>
<P><LI>Verify the following registry entry is set to 3.5 or 3.51.
<P>
<P><PRE>      CurrentVersion:REG_SZ:3.5 or 3.51
</PRE>
<P><LI>Quit Registry Editor and then restart your computer for these changes
   to take effect.
<P>
</OL>Clearing both to zero will allow Windows NT to prompt for the previous
installation upgrade.
<P>
NOTE: For additional information on difficulty upgrading Windows NT 4.0,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q154538.htm">Q154538</A></B>
   TITLE: Windows NT 4.0 Upgrade CD Will Not Upgrade NT 4.0 Installation

   ARTICLE-ID: <B><A HREF="../WINNT/Q160175.htm">Q160175</A></B>
   TITLE: What Does WinNT 4.0 look for in a Valid WinNT 3.51 Install

</PRE></OL>MORE INFORMATION
<P>
 
<P>
During the upgrade process, Windows NT Setup verifies the following before
providing an upgrade option to existing installations. If the above steps
do not resolve the upgrade option, verify the following components are
present and/or correct.

<UL><LI>Ensure the current version of Windows NT is bootable before proceeding
   with an upgrade.

<LI>Make sure the SCSI or IDE controller detected by Windows NT 4.0 Setup
   is the correct driver. (You may need to select F6 during setup do
   manually install the correct driver.)

<LI>The Boot.ini file must contain a valid ARC path for the current system
   partition.

<LI>A valid Setup.log file must be present in the %SystemRoot%\Repair
   directory.

<LI>You must break any mirror sets on the boot or system partition before
   upgrading.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: could not detect previous installation step-up<BR>
stepup prodnt<BR>
Keywords          : kbbug4.00 ntsetup NTSrvWkst kbsetup<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
