

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Users and Groups During Unattended Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142616">
<META NAME="KBModify" CONTENT="1997/03/03">
<META NAME="KBCreate" CONTENT="1996/01/16">
<META NAME="Keywords" CONTENT="ntsetup ntsrvwkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Adding users and groups during unattended setup of Windows NT does not seem possible with the standard options provided by the unattended answer file Unattend.txt. However, modifying the system hive before running an unattended setup allows you to ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QBWS,QDI2,QDIZ,QBFY,QA9N,QAGU,QACK,QBKX,QA2Q,QAG2,QACI,QABO,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Adding Users and Groups During Unattended Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142616</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.50 3.51
WINDOWS
kbsetup
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Adding users and groups during unattended setup of Windows NT does not seem
possible with the standard options provided by the unattended answer file
Unattend.txt. However, modifying the system hive before running an
unattended setup allows you to add a service that will do the job during
the first system boot after setup.
<P>
This solution is used to add users and groups, but it could be used to do
any task that cannot be done at setup time.
<P>
NOTE: The solution provided here is not supported by Microsoft and is used
at your own risk.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows NT. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To perform the modification described above, complete the following steps:

<OL><P><LI>Copy the \I386 directory from the Windows NT distribution compact disc
   to a network share X:

<P><LI>On the computer on which you want to install Windows NT, create a
   directory C:\TEMP and copy the following files, both of which may be
   found in the Windows NT Resource Kit:
<P>
<P><PRE>      Addusers.exe
      Srvany.exe
</PRE>
<P><LI>Make a text file C:\TEMP\USERS.TXT that will be used with Addusers.exe
   (please refer to ADDUSERS documentation for more information).

<P><LI>Run the following commands in a batch file:
<P>
<P><PRE>      X:
      cd \
      attrib -r SYSTEM._
      expand -r SYSTEM._
      del system._
</PRE>
<P><LI>Run Regedt32.exe in order to modify the system hive. To run
   Regedt32.exe, do the following:
<P>
<P><PRE>      a. Select HKEY_LOCAL_MACHINE in HKEY_LOCAL_MACHINE window
      b. Choose Registry, Load Hive menu option
      c. Enter X:\SYSTEM.
      d. Enter FLAT as the key name
      e. Select HKEY_LOCAL_MACHINE\FLAT\ControlSet001\Services
      f. Insert a new key AddUsersSvc
      g. Select HKEY_LOCAL_MACHINE\FLAT\ControlSet001\Services\AddUsersSvc
<PRE></PRE>         and insert the following values:

          - DisplayName REG_SZ Add Users Service
          - ErrorControl REG_DWORD 0x1
          - ImagePath REG_EXPAND_SZ C:\TEMP\SRVANY.EXE
          - ObjectName REG_SZ LocalSystem
          - Start REG_DWORD 0x2
          - Type REG_DWORD 0x10

   h. Select HKEY_LOCAL_MACHINE\FLAT\ControlSet001\Services\AddUsersSvc and
      insert a new subkey Parameters. Select the Parameters key and insert
      the following values (for more information, please refer to
      Srvany.wri, provided with the Windows NT Resource Kit):

      - AppDirectory REG_SZ C:\TEMP
      - Application REG_SZ C:\TEMP\ADDUSERS.EXE
      - AppParameters REG_SZ /C USERS.TXT

   i. Select HKEY_LOCAL_MACHINE\FLAT
   j. Choose Registry, Unload Hive menu option

</PRE></OL>This will create a service, "AddUsersSvc," that starts automatically at
boot time after setup. You may remove this service later.

<OL><P><LI>Finally, Run WINNT32 /U:X:\UNATTEND.TXT
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup<BR>
KBSubcategory: ntsetup ntsrvwkst<BR>
Additional reference words: prodnt 3.50 3.51
<P>

Keywords            : ntsetup ntsrvwkst kbsetup<BR>
Version             : 3.50 3.51<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
