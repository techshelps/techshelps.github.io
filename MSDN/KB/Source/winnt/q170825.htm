

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RAS Auto-Answer Behavior in Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170825">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1997/06/30">
<META NAME="Keywords" CONTENT="NTRAS kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article explains the new behavior of Windows NT remote access service (RAS) when answering incoming calls, in Windows NT version 4.0. This behavior has changed because Unimodem support is included in Windows NT version 4.0, but not in version ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAGI,QAH6,QAIF,QAAZ,QAD7,QAS6,QAK2,QDNL,QAKC,QDL9,QBWQ,QBWO,QBWN,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RAS Auto-Answer Behavior in Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170825</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains the new behavior of Windows NT remote access service
(RAS) when answering incoming calls, in Windows NT version 4.0. This
behavior has changed because Unimodem support is included in Windows NT
version 4.0, but not in version 3.5x.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Windows NT 3.5x, RAS initializes analog modems by sending an ATS0=1
command to the modem when RAS loads. This instructs the modem to answer
incoming calls on the first ring. See the following article in the
Microsoft Knowledge Base for more information about this parameter and how
to modify the number of rings before answering:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q114687.htm">Q114687</A></B>
   TITLE: Setting Number of Rings for RAS Server Auto-Answer in NT 3.5x

</PRE>By default in Windows NT version 4.0, the modem is initialized by
Unimodem, which sends an ATS0=0 to the modem when RAS loads. When an
incoming call is received, Unimodem answers the call and passes control to
RAS. In this case, the “AA” light on an external modem is NOT lit, though
RAS answers incoming calls. For information about modifying the number of
rings for Unimodem to answer a call in Windows NT 4.0, see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q145879.htm">Q145879</A></B>
   TITLE: How to Set the Number of Rings for RAS Auto-Answer in NT 4.0

</PRE>NOTE: Unimodem can be disabled in Windows NT 4.0, which causes RAS to
behave as it does in Windows NT 3.5x, as described above. For additional
information, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q150808.htm">Q150808</A></B>
   TITLE: Disabling Support for Unimodem Modems in Remote Access

</PRE><h3>EXAMPLE</h3>
 
The following is an example of Unimodem initializing or answering the line
in Windows NT 4.0 (from the modem log):
<P>
06-25-1997 17:06:20.113 - Hayes Accura 288 V.FC + FAX in use.
06-25-1997 17:06:20.143 - Modem type: Hayes Accura 288 V.FC + FAX
06-25-1997 17:06:20.143 - Modem inf path: mdmhayes.inf
06-25-1997 17:06:20.143 - Modem inf section: M1846
06-25-1997 17:06:20.143 - 115200,N,8,1
06-25-1997 17:06:20.143 - 115200,N,8,1
06-25-1997 17:06:20.173 - Initializing modem.
06-25-1997 17:06:20.173 - Send: AT&lt;cr&gt;
06-25-1997 17:06:20.193 - Recv: AT&lt;cr&gt;
06-25-1997 17:06:20.423 - Recv: &lt;cr&gt;&lt;lf&gt;OK&lt;cr&gt;&lt;lf&gt;
06-25-1997 17:06:20.423 - Interpreted response: OK
06-25-1997 17:06:20.423 - Send: AT&amp;FE0V0W1&amp;C1&amp;D2S95=47&lt;cr&gt;
06-25-1997 17:06:20.534 - Recv: AT&amp;FE0V0W1&amp;C1&amp;D2S95=47&lt;cr&gt;
06-25-1997 17:06:21.064 - Recv: 0&lt;cr&gt;
06-25-1997 17:06:21.064 - Interpreted response: OK
06-25-1997 17:06:21.064 - Send: ATS7=60S30=0L0M1&amp;Q5S36=7S48=7S46=138&amp;K3&lt;cr&gt;
06-25-1997 17:06:21.485 - Recv: 0&lt;cr&gt;
06-25-1997 17:06:21.485 - Interpreted response: OK
06-25-1997 17:06:21.485 - Send: ATB0N1X4&lt;cr&gt;
06-25-1997 17:06:21.685 - Recv: 0&lt;cr&gt;
06-25-1997 17:06:21.685 - Interpreted response: OK
06-25-1997 17:06:21.685 - Waiting for a call.
06-25-1997 17:06:21.685 - Send: ATS0=0&lt;cr&gt;
***(tells the modem not to answer the line when a call comes in; this lets
Unimodem do it)***
<P>
06-25-1997 17:06:21.876 - Recv: 0&lt;cr&gt;
06-25-1997 17:06:21.876 - Interpreted response: OK
06-25-1997 17:07:15.703 - Recv: 2&lt;cr&gt;
***(this is the ring coming in on the modem)***
<P>
06-25-1997 17:07:15.713 - Interpreted response: Ring
06-25-1997 17:07:15.743 - Answering the call.
06-25-1997 17:07:15.743 - Send: ATA&lt;cr&gt;
***(this is Unimodem telling the modem to answer the call)***
<P>
06-25-1997 17:07:27.009 - Recv: 55&lt;cr&gt;
06-25-1997 17:07:27.009 - Interpreted response: Informative
06-25-1997 17:07:27.610 - Recv: 77&lt;cr&gt;
06-25-1997 17:07:27.610 - Interpreted response: Informative
06-25-1997 17:07:27.610 - Recv: 67&lt;cr&gt;
06-25-1997 17:07:27.610 - Interpreted response: Informative
06-25-1997 17:07:27.610 - Recv: 15&lt;cr&gt;
06-25-1997 17:07:27.610 - Interpreted response: Connect
06-25-1997 17:07:27.620 - Connection established at 28800bps.
06-25-1997 17:07:27.620 - Error-control on.
06-25-1997 17:07:27.620 - Data compression on.
 
<PRE>Keywords          : NTRAS kbnetwork
Version           : WinNT:3.50,3.51,4.0
Platform          : winnt</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
