

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows NT Serial Communication Support, MS-DOS &amp; Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101631">
<META NAME="KBModify" CONTENT="1997/09/12">
<META NAME="KBCreate" CONTENT="1993/07/19">
<META NAME="Keywords" CONTENT="nt16ap ntdosap kb3rdparty kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" The text below describes how Windows NT supports serial communications in 16-bit Windows-based and in MS-DOS-based applications.  16-Bit Windows-Based Applications  Windows NT supports serial communications in 16-bit Windows-based applications in th...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDJ9,QDL9,QBWQ,QBWN,QBWO,QAJH,QBVV,QAY5,QAI5,QABB,QAHC,QADN,QAJQ,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows NT Serial Communication Support, MS-DOS &amp; Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101631</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system, version 3.1
<LI>Microsoft Windows NT Advanced Server, version 3.1
</UL> 
<P>
The text below describes how Windows NT supports serial communications
in 16-bit Windows-based and in MS-DOS-based applications.
<P>
<P><h3>16-Bit Windows-Based Applications</h3>
 
<P>
Windows NT supports serial communications in 16-bit Windows-based
applications in the same manner that 16-bit Windows 3.1 does, through
communications functions in the Windows application programming
interface (API). From the application standpoint, Windows NT provides
COMM.DRV, the communications driver in 16-bit Windows 3.1, because a
mapping exists between the Windows 3.1 and Windows NT functions. This
mechanism emulates the EventWord and shadow modem status register
(MSR) to support the GetCommEventMask() function. It also sends
WM_COMMNOTIFY messages to support the EnableCommNotification()
function.
<P>
If a 16-bit Windows-based application uses any extended functionality
provided by a third-party communications driver, it may not
communicate reliably because Windows NT may not support the extended
functionality.
<P>
<P><h3>MS-DOS-Based Applications</h3>
 
<P>
Most MS-DOS-based communication applications do not use any serial
port functions; instead, they directly access the serial port
hardware. Windows NT supports these applications by simulating the
standard hardware serial adapters, COM1 through COM4; the application
never directly controls the serial port hardware.  Modems that are 
setup for non standard irq's like irq 5 will not work with dos 
applications in Windows NT.  Win32 applications like DUN and 
Hyperterminal will work correctly though.
<P>
Windows NT simulates four 16450 UARTs at the standard serial I/O
addresses and interrupt numbers used in IBM PC-compatible hardware.
When each virtual MS-DOS machine (VDM) starts, the simulated UARTs are
dormant. When an application accesses a simulated UART, Windows NT
connects the simulated UART to the corresponding Windows NT serial
port, even if it uses a different address, interrupt number, or a
completely different interface. If the corresponding serial port is
not present of if it is already in use, Windows NT displays an error
dialog box to inform the user of the problem.
<P>
Some applications have an "idle curiosity" about serial ports that
they do not otherwise use. When you run one of these applications in
Windows NT, it may cause spurious error messages and/or prevent
another application from using the serial ports. At this time, if the
software does not provide a method to disable this behavior, there is
no method to work around this behavior. Contact your software supplier
for a corrected, or Windows NT-specific, version of the application.
<P>
<PRE>   NOTE: Serial communications is not emulated perfectly because of
   fundamental differences between the preemptive and nonpreemtive
   multitasking environments. If an application uses real-time
   hardware interrupts, it may experience problems caused by
   preemptive multitasking in Windows NT. Timing serial events in
   Windows NT may be different than in 16-bit Windows 3.1. Also, the
   ability to directly access hardware is not available in Windows NT.
   If your application directly accesses hardware, contact your vendor
   for a Windows NT-specific version of the application.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt wow<BR>
Keywords          : nt16ap ntdosap kb3rdparty kbinterop<BR>
Version           : 3.1<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
