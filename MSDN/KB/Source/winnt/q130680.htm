

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Service, Protocol, and Adapter Lists Can Appear Blank in NCPA </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130680">
<META NAME="KBModify" CONTENT="1997/03/25">
<META NAME="KBCreate" CONTENT="1995/05/24">
<META NAME="Keywords" CONTENT="kbenv ntconfig ntregistry NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When starting the Network Control Panel tool (Ncpa.cpl), the lists of Services, Protocols, and Adapters installed can all appear blank.  The ODBC tool is also affected in a similar way for the same reason.  CAUSE =====  A new registry key has been ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTX,QAE1,QAVZ,QBWP,QAB5,QAJQ,QDIV,QAQT,QAPF,QALZ,QAK9,QACK,QABG,QDJS,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Service, Protocol, and Adapter Lists Can Appear Blank in NCPA</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130680</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When starting the Network Control Panel tool (Ncpa.cpl), the lists of
Services, Protocols, and Adapters installed can all appear blank.
<P>
The ODBC tool is also affected in a similar way for the same reason.
<P>
<P><h2>CAUSE</h2>
 
<P>
A new registry key has been added under HKEY_LOCAL_MACHINE\SOFTWARE, and
the user currently logged on does not have read rights to this key.
<P>
When the Network Control Panel tool starts up, it scans
HKEY_LOCAL_MACHINE\SOFTWARE for "Manufacturer" keys (for example,
Microsoft). It then looks at registry keys under each Manufacturer key for
"Product" keys (for example, Tcpip). Once it has found a product key it
looks for a version key (for example, CurrentVersion) and then a key called
NetRules. If it finds a key called NetRules it assumes that this subkey is
defining a network component that it needs to be able to configure.
<P>
However, NCPA assumes that it has read rights to all Manufacturer and
Product keys. If it gets an access denied error at any time while scanning
these keys it terminates the scanning process and just uses the information
it has already procured. This means that if a third party adds a key under
SOFTWARE that is alphabetically before 'Microsoft,' and it has restricted
rights applied to it, then NCPA is never able to retrieve the list of
Network components from the registry and presents a blank list.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Ensure that if it is necessary to restrict access to any data in a key
under HKEY_LOCAL_MACHINE\SOFTWARE, the key is placed at least three levels
down the tree from this point.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt applet<BR>
Keywords            : kbenv ntconfig ntregistry NTSrvWkst<BR>
Version             : 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 25, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
