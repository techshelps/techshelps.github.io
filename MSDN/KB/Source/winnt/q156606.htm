

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows NT Setup Fails to Install OEM Network Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156606">
<META NAME="KBModify" CONTENT="1997/03/20">
<META NAME="KBCreate" CONTENT="1996/09/26">
<META NAME="Keywords" CONTENT="kb3rdparty kbbug4.00 kbsetup ntdriver ntsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  During Windows NT 4.0 Setup network adapter installation, if you choose Select From List, then Have Disk, and you are using a third-party OEM network card device driver disk for installation, the following error will occur when you try to copy the ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBWP,QDI2,QBXS,QDJS,QAVZ,QDIZ,QAU9,QAYL,QANE,QAH7,QAGB,QAAP,QDKW,QA05 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows NT Setup Fails to Install OEM Network Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156606</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
During Windows NT 4.0 Setup network adapter installation, if you choose
Select From List, then Have Disk, and you are using a third-party OEM
network card device driver disk for installation, the following error will
occur when you try to copy the OEM files from the installation
disk:
<P>
<PRE>   An error has occurred:

   Unable to open the file:D:\i386\OEM_FILE_NAME

     -or-  If you performed a winnt /B installation

   Unable to open the file:$win_nt$.~ls\i386\OEM_FILE_NAME

   A Non-critical error has occurred. you may retry the operation, Ignore
   it, or exit the entire setup operation.

</PRE><h2>CAUSE</h2>
 
<P>
The OEM installation oemsetup.inf file was incorrectly written to list
themselves as an NT shipped component, Windows NT 4.0 Setup process
inadvertently overwrites the user input local variable $(SRCDIR) called for
by the Oemsetup.inf file with the default Windows NT source path.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem ask the OEM vendor for an updated oemsetup.inf
file or perform either of the following:

<UL><LI>Complete the installation by choosing to install the Microsoft Loopback
   adapter, then add OEM Network adapter after NT is installed.
<P>
</UL>-or-

<UL><LI>Replace $(SRCDIR) with A:\ in the Oemsetup.inf file located on the OEM
   installation disk, as in the following example. See the lines marked
   "&lt;--- here" for the necessary changes. These changes allow the network
   card installation to work during setup.
<P>
   [Install-Option]
<P><PRE>       set STF_VITAL = ""
</PRE><P>
<P><PRE>       ifstr(i) $(AddCopy) == "YES"
</PRE><P>
<P>
<P><PRE>      AddSectionFilesToCopyList Files-$(Option) A:\ &lt;----- here
    $(!STF_WINDOWSSYSPATH)\drivers
    endif
</PRE><P>
<P><PRE>       ifstr(i) $(DoCopy) == "YES"
</PRE><P>
<P>
<PRE>          set !STF_NCPA_FLUSH_COPYLIST = TRUE
          CopyFilesInCopyList

       endif

       Exit

   [Install-Update]
      set STF_VITAL        = ""
      set STF_OVERWRITE    = "VERIFYSOURCEOLDER"
      ;set STF_VERSION     = "YES"

      AddSectionFilesToCopyList Files-$(Option) A:\ &lt;--- here
   $(!STF_WINDOWSSYSPATH)\drivers
   AddSectionFilesToCopyList Files-Inf A:\ $(!STF_WINDOWSSYSPATH) &lt;- here
      set !STF_NCPA_FLUSH_COPYLIST = TRUE
      CopyFilesInCopyList

      exit

   [Install-Dll]
      set STF_VITAL        = ""
   AddSectionFilesToCopyList Files-Dll A:\ $(!STF_WINDOWSSYSPATH) &lt;- here
      CopyFilesInCopyList
      exit

</PRE></UL>Every network card Oemsetup.inf file will be different; however, it should
contain similar logic to prompt the user for the input source, then pass
that source to $(SRCDIR) local variable. Hardcoding the entry $(SRCDIR) to
be A:\ ensures the path is useable and not overwritten.
<P>
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kb3rdparty kbbug4.00 kbsetup ntdriver ntsetup<BR>
Version             : 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
