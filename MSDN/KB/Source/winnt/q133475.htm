

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Corrupted Directory Replicator Registry Entries </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133475">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1995/07/31">
<META NAME="Keywords" CONTENT="ntdomain NTSrvWkst kberrmsg kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Directory Replicator service fails to start. The Event Viewer logs error 7023 or 7024.  CAUSE =====  The following errors can result when the registry information fails to properly register the settings, or from user error when inputting the de...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAB4,QACK,QBXB,QATJ,QAFI,QAGB,QAIJ,QBBI,QA3P,QBTX,QDIV,QAA1,QAKP,QBCT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Corrupted Directory Replicator Registry Entries</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133475</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Directory Replicator service fails to start. The Event Viewer logs
error 7023 or 7024.
<P>
<P><h2>CAUSE</h2>
 
<P>
The following errors can result when the registry information fails to
properly register the settings, or from user error when inputting the
desired settings in Server Manager while setting up Directory Replication.
<P>
<P><h3>Errors Establishing Import and Export Paths</h3>
 
<P>
If you input a nonexistent path (for example, misspell the desired path)
when you establish the Import and Export paths for Directory Replication in
the Server Manager properties setup screen, the following errors appear
when you try to exit the Replication Properties dialog box as the system
tries to start the Directory Replicator service:
<P>
<PRE>   The system cannot find the file specified.

   -or-

   The system cannot find the path specified.

</PRE>If you then start the Directory Replicator service from the Services in
Control Panel, these same errors are more clearly reported:
<P>
<PRE>   The Directory Replicator service terminated with the following error:
   Error 0002: The system cannot find the file specified.

   -or-

   The Directory Replicator service terminated with the following error:
   Error 0003: The system cannot find the path specified.

</PRE>NOTE: Each error is logged in the system log with the following status:
<P>
<PRE>   Event ID: 7023
   Source: Service Control Manager
   Type: Error
   Category: None
   Description: The Directory Replicator service terminated with the
   following error:

      The system cannot find the file specified.

</PRE><h3>Managed Directory Information Is Deleted or Corrupted</h3>
 
<P>
If the Managed directory information is deleted or corrupted in the
Registry, the following error occurs when you try change the Managed
directory information by selecting the Manage button, or try to exit the
Replication Properties dialog box as Windows NT tries to start the
Directory Replicator service:
<P>
<PRE>   The Data is Invalid

</PRE>This error is reported more clearly if you try to start the Directory
Replicator service from Services in the Control Panel:
<P>
<PRE>   Stop
   Could not start the Directory Replicator Service on \\&lt;machine name&gt;.
   Error 0013: The Data is Invalid

</PRE>In short, the data in the Registry no longer matches the data being used
when starting the Replicator Service from within Server manager.
<P>
This problem can also occur when you do not stop and restart the Server
Manager applet after making registry entry changes to the specified paths
being used for replication.
<P>
NOTE: This error is logged in the system log with the following status:
<P>
<PRE>   Event ID: 7023
   Source: Service Control Manager
   Type: Error
   Category: None
   Description: The Directory Replicator service terminated with the
   following error:

      The data is invalid.

</PRE><h3>Error Occurs After You Delete Subkeys</h3>
 
<P>
If you try to correct errors from within the registry by simply deleting
the following subkeys from the System key under the HKEY_LOCAL_MACHINE
subtree, additional errors occur:
<P>
<PRE>   CurrentControlSet
   Services
   Replicator
   Imports
   Exports

</PRE>If Imports and /r Exports are deleted and or corrupted, the following
errors appear when you try to exit the Replication Properties dialog box as
the system tries to start the Directory Replicator service:
<P>
<PRE>   The Specified Component could not be found in the configuration
   information.

</PRE>This error is reported more clearly if you try to start the Directory
Replicator service from Services in the Control Panel:
<P>
<PRE>   Stop
   Could not start the Directory Replicator Service on \\&lt;machine name&gt;.
   Error 2146: The Specified Component could not be found in the
   configuration information

</PRE>NOTE: This error is logged in the system log with the following status:
<P>
<PRE>   Event ID: 7024
   Source: Service Control Manager
   Type: Error
   Category: None
   Description: The Directory Replicator service terminated with service-
   specific error 2146.

</PRE><h2>RESOLUTION</h2>
 
<P>
To properly correct corruption:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Make sure that Server Manager is not running.

<P><LI>Open Control Panel, double-click the Services icon, and set the startup
   parameter for the Replicator service to Manual.

<P><LI>Stop the Directory Replicator service on the specified computer.

<P><LI>Edit the following HKEY_LOCAL_MACHINE subtree Registry entries and then
   close Registry Editor:
<P>
   a. In the System\CurrentControlSet\Services\Replicator\Exports key,
<P><PRE>      delete all values. For example, delete Scripts and its string value.
</PRE><P>
   b. In the System\CurrentControlSet\Services\Replicator\Imports key,
<P><PRE>      delete all values. For example, delete Scripts and its string value.
</PRE><P>
   c. In the System\CurrentControlSet\Services\Replicator\Parameters key,
<P><PRE>      under the value ExportPath, set the string to
      &lt;drive&gt;:\.(The valid path to the directories in question).
</PRE><P>
   d. In the same key, under the value ImportPath, set the string to
<P><PRE>      &lt;drive&gt;:\.(The valid path to the directories in question).
</PRE><P>
   e. In the same key, delete both the ImportList name and the string
<P><PRE>      value.
</PRE>
<P><LI>From the Server Manager Replication Properties setup screen:
<P>
   a. Reset the appropriate Export and Import Directories, usually
<P><PRE>      &lt;drive&gt;:\Winnt35\System32\Repl\Export and
      &lt;drive&gt;:\Winnt35\System32\Repl\Import.
</PRE><P>
   b. Reset the Manage Export and Manage Import Directory options as
<P><PRE>      needed. You usually need to add the subdirectory scripts.
</PRE><P>
   c. Add the appropriate Import Servers and Export Servers to the list
<P><PRE>      boxes.
</PRE>
<P><LI>Try to close the Replication Properties Setup Screen. This should start
   the Directory Replicator service on the current computer.
<P>
</OL>Make sure the Startup account is set as the Replicator, and that it is
properly set up, and that the domain has been synchronized. Replication
should begin to take place.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords          : ntdomain NTSrvWkst kberrmsg kbnetwork<BR>
Version           : WinNT:3.5,3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
