

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Windows NT Add-On Subsystem for PM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114960">
<META NAME="KBModify" CONTENT="1997/05/15">
<META NAME="KBCreate" CONTENT="1994/05/17">
<META NAME="Keywords" CONTENT="kbtool ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article contains the troubleshooting section from the Windows NT Add- On Subsystem for Presentation Manager documentation.  TROUBLESHOOTING  Following are some possible problematic situations with the Presentation Manager Subsystem and the wor...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAGU,QAH5,QAJM,QAGB,QAGR,QABI,QAJH,QAIJ,QAKR,QAHE,QAKP,QAY2,QABH,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Windows NT Add-On Subsystem for PM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114960</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Add-On Subsystem for Presentation Manager,
   version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains the troubleshooting section from the Windows NT Add-
On Subsystem for Presentation Manager documentation.
<P>
<P><h2>TROUBLESHOOTING</h2>
 
<P>
Following are some possible problematic situations with the Presentation
Manager Subsystem and the workarounds for them:
<P>
A Presentation Manager Application Fails
<P><h3>to Run Properly on the Presentation Manager Subsystem</h3>
 

<OL><P><LI>Make sure the application runs properly on native OS/2 version 1.3. Note
   that some OS/2 version 1.1 programs don't run on OS/2 version 1.3 and
   need to be recompiled and relinked.

<P><LI>If the Presentation Manager application fails at load time, it may be
   helpful to see if the Presentation Manager Subsystem issued an error
   message with the reason for the failure. To see such messages, you will
   need to invoke the offending application from a CMD window (otherwise,
   the CMD window created by the Program Manager disappears as soon as the
   application terminates). Please write down the error message and include
   it in your problem report to Microsoft.

<P><LI>Check if the problem you are experiencing appears in the Presentation
   Manager Subsystem Release 1.0 Bug List.

<P><LI>Take a look at the restrictions on OS/2 programs (see Volume One of the
   Windows NT Resource Kit, "Windows NT Resource Guide"). These
   restrictions apply to Presentation Manager programs as well. For
   example, the application may require a private OS/2 device driver (which
   can't run "as is" under the Windows NT OS/2 &amp; Presentation Manager
   Subsystem).

<P><LI>The application may use NET API's not completely supported by the
   Windows NT OS/2 &amp; Presentation Manager Subsystem - see NET API
   spreadsheet.

<P><LI>Make sure your Path and Os2LibPath variables are set properly. If your
   application is providing help files, check the Help variable as well.
   The way to inspect &amp; modify these variables is by editing C:\CONFIG.SYS
   with an OS/2 or Presentation Manager editor. Note that Os2LibPath
   appears as LIBPATH in C:\CONFIG.SYS. For more details, please refer to
   the Windows NT Resource Guide chapter about the OS/2 compatibility (this
   chapter is provided with the Presentation Manager Subsystem Release 1.0
   documentation).
<P>
</OL>Failing to set these variables properly may cause, for example, one of the
following problems:

<UL><LI>The OS/2 subsystem may fail to locate the application's DLL(s) (via the
   Os2LibPath variable).

<LI>The application may fail to locate its help (.HLP) files.

<LI>The application may use the wrong HLP file if another file with the same
   name appears first in the Path.
<P>
</UL><h3>The Presentation Manager Subsystem is not Functioning Properly</h3>
 
<P>
For example:

<UL><LI>The Presentation Manager Desktop is not redrawn when you switch to it.

<LI>Presentation Manager applications do not receive mouse or keyboard
   events.

<LI>New Presentation Manager applications that used to work now fail to load
   properly.

</UL><OL><P><LI>Terminate the Presentation Manager Subsystem (PMSHELL and all
   Presentation Manager applications) by either:
<P>
   a. Try to close the Presentation Manager Subsystem from the Presentation
<PRE>      Manager Task Manager (if it can be    invoked)

   b. If the above step fails, try closing the PMSHELL WIN32 iconized
      window or from the WIN32 Task List.

   c. If above steps fail, close all Presentation Manager applications
      forcefully, and then PMSHELL (see section 3.7.2)

</PRE><P><LI>After terminating the Presentation Manager Subsystem, restart PMSHELL.
   If this fails, kill the OS/2 Subsystem server (see section 3.7.2)

<P><LI>If step 2 failed, a reboot of Windows NT may be required
<P>
</OL><h3>PMSHELL Fails to Start, Even After Rebooting Windows NT</h3>
 
<P>
Some of the Presentation Manager Subsystem files may have been corrupted.
Try reinstalling the Presentation Manager Subsystem.

<OL><P><LI>Terminate the Presentation Manager Subsystem (PMSHELL and all
   Presentation Manager applications) by either:
<P>
   a. Try to close the Presentation Manager Subsystem from the Presentation
<P><PRE>      Manager Task Manager (if it can be invoked).
</PRE><P>
   b. If the above step fails, try closing the PMSHELL WIN32 iconized
<P><PRE>      window or from the WIN32 Task List.
</PRE><P>
   c. If above steps fail, close all Presentation Manager applications
<P><PRE>      forcefully, and then PMSHELL (see section 3.7.2).
</PRE>
<P><LI>After terminating the Presentation Manager Subsystem, restart PMSHELL.
   If this fails, quit the OS/2 Subsystem server (see section 3.7.2).

<P><LI>If step 2 failed, a reboot of Windows NT may be required.
<P>
</OL><h3>Desktop is Locked</h3>
 
<P>
You can't switch away from the Presentation Manager desktop. The screen may
be black at that time.
<P>
Check if Windows NT is still functional (press NUM LOCK and check if the
indicator light is toggled): if it is, then please wait about four minutes.
<P>
After that time, the WIN32 may be restored, in which case you can terminate
all Presentation Manager applications and PMSHELL (see "Forceful
Termination," section 3.7.2). Otherwise, a reboot of Windows NT is needed.
<P>
PMSHELL Doesn't Come Up, Even After a Fresh
<P><h3>Installation of Presentation Manager Subsystem</h3>
 
<P>
This might be caused by the presence of a display adapter which the
Presentation Manager Subsystem doesn't recognize. To overcome this problem
please perform the following steps (after terminating PMSHELL and rebooting
your system):

<OL><P><LI>Start PMSHELL with the '/w' switch, i.e.:
<P>
<P><PRE>      PMSHELL /w
</PRE><P>
   Please let PMSHELL come-up undisturbed (i.e. do not try to switch-away
   from it while it is starting and do not start WIN32 applications at the
   same time). PMSHELL will start seemingly as usual but after PMSHELL
   comes up and restores the Windows NT Desktop, the first switch back to
   the Presentation Manager Desktop will cause the Presentation Manager
   Subsystem to write a file with the proper video registers settings for
   your adapter under C:\OS2\VIDEOHW.DMP.

<P><LI>Shut down PMSHELL as usual.

<P><LI>From now on, PMSHELL should be able to come up as usual (i.e. without
   the /w switch): it will find that there is a file C:\OS2\VIDEOHW.DMP and
   use the values stored there in place of internal values.
<P>
</OL>NOTES:

<UL><LI>Another remedy to the above problem is to configure your Windows NT
   system to use the standard VGA display driver rather than the one for
   your display adapter. However, the resulting display resolution may be
   impractical.

<LI>Note that the C:\OS2\VIDEOHW.DMP file may be copied to other systems
   with the same display adapter

<LI>If you change the display adapter in your Windows NT system, the
   C:\OS2\VIDEOHW.DMP will no longer be appropriate: it is advised to
   delete this file (although the Presentation Manager Subsystem will
   detect the mismatch and ignore the file).

<LI>Even if you successfully overcame this problem with the /w work-around,
   please notify Microsoft of the problem (indicating the display adapter &amp;
   resolution) you are using.
<P>
</UL>You Have Attempted to Shut-Down the Presentation Manager
<P><h3>Subsystem but the Presentation Manager Desktop Isn't Terminated</h3>
 
<P>
This situation may be caused by a Presentation Manager application which
misbehaves upon shutdown and can be observed also under native OS/2 version
1.3. You need to terminate PMSHELL forcefully.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Windows NT - Presentation Manager Subsystem Overview, release 1.0
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt pmnt<BR>
Keywords            : kbtool ntutil<BR>
Version             : 1.0 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
