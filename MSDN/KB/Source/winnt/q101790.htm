

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Information on Last Known Good Control Set </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101790">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1993/07/22">
<META NAME="Keywords" CONTENT="kbsetup ntgeneral ntsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" A collection of configuration data needed to control system boot is called a control set. A single control set is equivalent to, in the MS-DOS/Windows environment, the CONFIG.SYS file, some of the AUTOEXEC.BAT file and part of the WIN.INI file. The ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAML,QBXS,QAB5,QA7O,QAOE,QAMN,QAL1,QBWP,QBVV,QDIV,QAHV,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Information on Last Known Good Control Set</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101790</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system, version 3.1
<LI>Microsoft Windows NT Advanced Server, version 3.1
</UL> 
<P>
A collection of configuration data needed to control system boot is
called a control set. A single control set is equivalent to, in the
MS-DOS/Windows environment, the CONFIG.SYS file, some of the
AUTOEXEC.BAT file and part of the WIN.INI file. The last known good
control set works by keeping a backup control set of the last
successful boot. The rules for determining if the last boot was
successful, and therefore good, are:

<UL><LI>No system critical errors involving the failure of a driver
   or system file.

<LI>A user can log onto the system at least once.
<P>
</UL><h3>What is the Last Known Good Control Set Good For?</h3>
 
<P>
The following three examples demonstrate what the last known good
control set is good for:

<UL><LI>You install a new device driver and restart Windows NT. The system
   stops responding (hangs) when you start (boot) the computer. The last
   known good control set will enable you to boot because it does not
   contain any reference to the new, faulty driver.

<LI>You install a new video driver and are able to restart the system.
   However, you cannot see anything because the new video resolution
   is incompatible with your video adapter. In this case, do not try
   to log on by entering the correct keys. If you turn off and restart
   your computer, the last known good control set can be used.

<LI>You accidentally disable a system critical device driver (such as the
   SCSIPORT driver). Windows NT is not be able to boot and reverts to
   the last known good control set.
<P>
</UL><h3>What is the Last Known Good Control Set NOT Good For?</h3>
 

<UL><LI>Any problem that is not related to changes in control set
   information will not be corrected by reverting to the last known good
   configuration. This includes information like user profiles and file
   permissions.

<LI>Any change introduced more than one successful boot ago cannot be
   backed out, because the change will have been copied to the last known
   good control set on the first successful boot after the change was
   made.

<LI>The last known good control set is a backup and restore facility for
   the Registry; it does not support switching between configurations
   (docked and undocked laptops, for example).
<P>
</UL>The following are three examples where the last known good control set
is not helpful:

<UL><LI>Boot failures caused by hardware failures or corrupted files.

<LI>If you copy a new driver over the top of an old one, and the old
   one is already active, then the configuration will not change;
   switching to the last known good control set will not undo
   anything.

<LI>If Windows NT boots, a user logs on, and then Windows NT hangs,
   the last known good control set will not help because it has already
   been updated to the current control set.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbsetup ntgeneral ntsetup<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
