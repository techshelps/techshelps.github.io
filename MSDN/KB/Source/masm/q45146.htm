

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCERR: Some Coprocessor Instructions Not Emulated </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" HREF="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q45146 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1989/05/31">
<META NAME="Keywords" CONTENT="kbtool kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  The /E option of the Microsoft Macro Assembler (MASM) 5.0 and 5.1 directs the assembler to generate data and code as it is expected by coprocessor emulator libraries. The /FPi option and the OPTION EMULATOR directive provide the same functionality,...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QATS,QASR,QBV8,QAB4,QAAP,QBHQ,QBFY,QAB9,QBVV,QAMA,QAJQ,QAE1,QAPF,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: Some Coprocessor Instructions Not Emulated</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q45146 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 5.0, 5.1, 5.1a, 6.0,
   6.0a, 6.0b, 6.1, 6.1a, and 6.11
<LI>Microsoft Macro Assembler for OS/2, versions 5.1, 5.1a, 6.0, 6.0a,
   and 6.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The /E option of the Microsoft Macro Assembler (MASM) 5.0 and 5.1
directs the assembler to generate data and code as it is expected
by coprocessor emulator libraries. The /FPi option and the OPTION
EMULATOR directive provide the same functionality, starting with
MASM version 6.0.
<P>
The emulator libraries are available with the high-level languages
like C, BASIC, FORTRAN, and Pascal. However, the emulator libraries do
not support all coprocessor instructions. The following error message
will result when an unsupported coprocessor instruction is executed:
<P>
<PRE>   run-time error M6107: MATH
   - floating-point error: unemulated

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following is the list of unemulated coprocessor instructions in
MASM 5.1:
<P>
<PRE>   FBLD                    FSAVE
   FBSTP                   FSETPM
   FCOS                    FSIN
   FDECSTP                 FSINCOS
   FINCSTP                 FSTENV
   FINIT                   FUCOM
   FLDENV                  FUCOMP
   FNOP                    FUCOMPP
   FPREM1                  FXTRACT
   FRSTOR

</PRE>The following is the list of unemulated coprocessor instructions in
MASM 6.0 as indicated on page 161 of the "Microsoft Macro Assembler
Programmer's Guide":
<P>
<PRE>   FCOS                    FSAVE32
   FDECSTP                 FSETPM
   FINCSTP                 FSIN
   FPREM1                  FSINCOS
   FRSTOR                  FUCOM
   FRSTOR16                FUCOMP
   FRSTOR32                FUCOMPP
   FSAVE                   FXTRACT
   FSAVE16

</PRE>However, this list is not complete. When tested with the run-time
libraries from Microsoft C/C++ 7.0, the following instructions also
result in the M6107 error
<P>
<PRE>   FBLD                    FLDENV
   FBSTP                   FNOP
   FINIT                   FSTENV

</PRE>In addition, a few of the names are incorrect
<P>
<PRE>   FRSTOR16   should be    FRSTORW
   FRSTOR32   should be    FRSTORD
   FSAVE16    should be    FSAVEW
   FSAVE32    should be    FSAVED

</PRE>The following stand-alone assembler sample reproduces the M6107 error
for the instruction FBLD. Note that the C run-time code must be
brought in. In this case, the small model emulator library (slibce)
is used.
<P>
<P><h3>Sample Code</h3>
 
<P>
; Assemble options needed: /Cx /link slibce
<P>
OPTION EMULATOR
.MODEL small, C
PUBLIC main
<P>
.DATA
packbcd TBYTE 0
<P>
.CODE
main:
<PRE>   fbld packbcd
</PRE>END
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.10 5.10a 6.00 6.00a 6.00b 6.10 6.10a<BR>
KBCategory: kbtool kbdocerr<BR>
KBSubcategory: MLIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
