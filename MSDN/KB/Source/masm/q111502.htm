

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: SUBSTR Index Past End of String Incorrectly Assembles </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" HREF="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111502">
<META NAME="KBModify" CONTENT="1994/10/21">
<META NAME="KBCreate" CONTENT="1994/02/14">
<META NAME="Keywords" CONTENT="kbtool kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  MASM 6.x will incorrectly assemble the SUBSTR directive and not generate the expected error if the index value is 1 (one) greater than the length of the string. The expected error is:     A2091: index value past end of string  STATUS ======  Micros...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QAAP,QATX,QAKD,QANY,QAB4,QAH4,QAVX,QAVW,QAMM,QAKP,QAIJ,QBWP,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SUBSTR Index Past End of String Incorrectly Assembles</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111502</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Macro Assembler for MS-DOS, versions 6.0, 6.0a, 6.0b, 6.1,
<PRE>  6.1a, and 6.11
</PRE>- Microsoft Macro Assembler for Windows NT, version 6.11
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
MASM 6.x will incorrectly assemble the SUBSTR directive and not generate
the expected error if the index value is 1 (one) greater than the length of
the string. The expected error is:
<P>
<PRE>   A2091: index value past end of string

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft Macro
Assembler (MASM) versions 6.x. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The sample code below illustrates this behavior as well as the correct use
of SUBSTR.
<P>
The SUBSTR directive selects a value from a string and assigns it to a
symbol. The index value (start value) cannot be greater than the length of
the string. The format of the directive is:
<P>
<PRE>   &lt;name&gt; SUBSTR &lt;string&gt;, &lt;index&gt;

   -or-

   &lt;name&gt; SUBSTR &lt;string&gt;, &lt;start&gt;, &lt;length&gt;

</PRE>The directive is documented on pages 246-247 of the MASM 6.1x "Programmer s
Guide."
<P>
<P><h3>Sample Code</h3>
 
<P>
; Assemble options needed: /c /Fl
.model small
.data
<PRE>   op1 substr &lt;12345678&gt;,8  ;  4
   op2 sizestr op1          ;  5

   op3 substr &lt;12345678&gt;,9  ;  7 - should be A2091 here
   op4 sizestr op3          ;  8 - should be A2006 here

   op5 substr &lt;12345678&gt;,10 ; 10 - A2091 here
   op6 sizestr op5          ; 11 - A2006 here
END

</PRE>Assembling this will correctly generate two errors (A2091 and A2006) on
lines 10 and 11 as shown in the following (partial) listing. These errors
should also be generated on lines 7 and 8 of the source, but aren't, and
the value 0 (zero) is incorrectly assigned to symbol op4.
<P>
<PRE>               ; Assemble options needed: /c /Fl
               .model small
 0000          .data
 = 8              op1 substr &lt;12345678&gt;,8  ;  4
 = 0001           op2 sizestr op1          ;  5

 =                op3 substr &lt;12345678&gt;,9  ;  7 - should be A2091 here
 = 0000           op4 sizestr op3          ;  8 - should be A2006 here

                  op5 substr &lt;12345678&gt;,10 ; 10 - A2091 here
</PRE>test.asm(10): error A2091: index value past end of string
<PRE>                  op6 sizestr op5          ; 11 - A2006 here
</PRE>test.asm(11): error A2006: undefined symbol : op5
<PRE>               END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 6.00 6.00a 6.00b 6.10 6.10a buglist6.10<BR>
buglist6.10b buglist6.11<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: MLiss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1994</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
