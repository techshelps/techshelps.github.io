

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: MASM Allows Alignments &gt; Segment Alignment </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" HREF="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81894 ">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1992/03/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  The Microsoft Macro Assembler (MASM) versions 5.1 and 5.1a incorrectly allow ALIGN directives that are greater than the alignment of the segment they appear within. MASM 5.1 does not generate errors for these statements; however, it cannot guarante...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEB,QAEU,QAIJ,QANY,QAH4,QAAP,QAR4,QDIV,QAYA,QAB4,QAPN,QAEF,QAKP,QAYY,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: MASM Allows Alignments &gt; Segment Alignment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81894 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.10 5.10a | 5.10 5.10a
<PRE>MS-DOS     | OS/2
</PRE>kbtool kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 5.1 and 5.1a
<LI>Microsoft Macro Assembler for OS/2, versions 5.1 and 5.1a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Macro Assembler (MASM) versions 5.1 and 5.1a incorrectly
allow ALIGN directives that are greater than the alignment of the segment
they appear within. MASM 5.1 does not generate errors for these statements;
however, it cannot guarantee that the item following these ALIGN directives
will be aligned on the given boundary.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has confirmed this to be a problem in MASM versions 5.1 and 5.1a.
This problem was corrected in MASM version 6.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The maximum ALIGN value for data or code is the alignment used when
defining the segment. When a segment is declared, it is guaranteed to
start only at its specified alignment. Since the assembler can align
items relative only to the start of a segment, any ALIGN statement
greater than the segment's alignment should generate an error. If the
following sample code is assembled with MASM 5.1 or MASM 5.1a, no
error is generated. Padding is inserted after the ALIGN 4
directive, but it will not align the next statement on the indicated
boundary. MASM 6.0 correctly generates the following error:
<P>
<PRE>   A2189: invalid combination with segment alignment : 4

</PRE>Valid segment alignments include: BYTE, WORD, DWORD, PARA, or PAGE.
PARA is the default.
<P>
<P><h3>Sample Code</h3>
 
<P>
; Assemble options needed: none
<P>
STACK  SEGMENT PARA STACK 'STACK'
<PRE>       DB      100h DUP('x')
</PRE>STACK  ENDS
<P>
_DATA  SEGMENT WORD PUBLIC 'DATA'
<PRE>msg    DB      "Hello World!", 13, 10, '$'
</PRE>_DATA  ENDS
<P>
_TEXT1 SEGMENT WORD PUBLIC 'CODE'
<PRE>       ASSUME CS:_TEXT1
</PRE>retrn: ret
_TEXT1 ENDS
<P>
_TEXT2 SEGMENT WORD PUBLIC 'CODE'
<PRE>       ASSUME CS:_TEXT2, DS:_DATA
start: mov     ax, SEG msg
       mov     ds, ax

       ALIGN   4

       mov     dx, OFFSET msg
       mov     ah, 09h
       int     21h

       mov     ax, 4C00h
       int     21h
</PRE>_TEXT2 ENDS
<P>
END    start
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10 5.10a 6.00 buglist5.10 buglist5.10a<BR>
fixlist6.00<BR>
KBCategory: kbtool kbfixlist kbbuglist<BR>
KBSubCategory: MLIss<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
