

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: ASSUME Using SEG on Communal Far Data Item </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" HREF="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75178 ">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1991/08/13">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  When the ASSUME directive uses the SEG operator on a communal far data item in the Microsoft Macro Assembler (MASM) versions 5.1, 5.1a, and 6.0, it may generate an error incorrectly. The statement  cmp dog, 0  in the sample code below incorrectly g...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QATO,QAMB,QAAP,QAR4,QAH4,QAB4,QAEG,QALG,QAEF,QAKE,QAYY,QAKP,QAEV,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ASSUME Using SEG on Communal Far Data Item</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75178 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.10 5.10a 6.00 | 5.10 5.10a 6.00
<PRE>MS-DOS          | OS/2
</PRE>kbtool kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 5.1, 5.1a and 6.0
<LI>Microsoft Macro Assembler for OS/2, versions 5.1, 5.1a, and 6.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the ASSUME directive uses the SEG operator on a communal far data
item in the Microsoft Macro Assembler (MASM) versions 5.1, 5.1a, and
6.0, it may generate an error incorrectly. The statement "cmp dog, 0"
in the sample code below incorrectly generates the following message
when assembled with MASM 5.1 or 5.1a:
<P>
<PRE>   A2068: Cannot address with segment register

</PRE>MASM 6.0 incorrectly generates the following message:
<P>
<PRE>   A2074: cannot access label through segment registers

</PRE><h2>RESOLUTION</h2>
 
<P>
The following workarounds may be used to eliminate the error messages:
<P>
<PRE>   1. Use the segment name instead of the SEG operator on a label, such
      as "ASSUME ds:FAR_DATA" instead of "ASSUME ds:SEG dog".

   2. Specify the segment register along with the label, such as
      "cmp ds:dog, 0" instead of "cmp dog, 0".

   3. With MASM 6.0, specify that the communal data is far, such as
      "COMM FAR dog:BYTE instead of "COMM dog:BYTE".

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in MASM versions 5.1,
5.1a, and 6.0. This problem was corrected in MASM version 6.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample code can be used to demonstrate the problem.
<P>
<P><h3>Sample Code</h3>
 
<P>
; Assemble options needed: none
<P>
.MODEL large, C
<P>
.FARDATA
COMM dog:BYTE
<P>
.CODE
cat PROC
<PRE>    ASSUME ds:SEG dog
    mov ax, SEG dog
    mov ds, ax
    cmp dog, 0
    ret
</PRE>cat ENDP
END
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10 5.10a 6.00 buglist5.10 buglist5.10a<BR>
buglist6.00 fixlist6.00a<BR>
KBCategory: kbtool kbfixlist kbbuglist<BR>
KBSubCategory: MLIss<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
