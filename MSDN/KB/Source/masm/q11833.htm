

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Finding Size of Program </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" HREF="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q11833 ">
<META NAME="KBModify" CONTENT="1995/02/21">
<META NAME="KBCreate" CONTENT="1987/12/01">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT=" The are programming situations in which it is necessary to determine the length of a program at run-time. For example, services (such as MS-DOS function 31H) need this information. Ordinarily, one could define a symbol at the end of a segment known ...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAML,QAH4,QBHQ,QAMB,QAC2,QABO,QDIJ,QAGB,QAEF,QBW6,QAJH,QBVV,QAZC,QAY5,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Finding Size of Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q11833 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 1.25, 1.27, 3.0x,
   4.0, 5.0, 5.1, and 6.0
<LI>Microsoft Macro Assembler for OS/2, versions 5.1 and 6.0
</UL> 
<P>
The are programming situations in which it is necessary to determine the
length of a program at run-time. For example, services (such as MS-DOS
function 31H) need this information. Ordinarily, one could define a symbol
at the end of a segment known to be loaded last; however, this does not
work when linking with libraries because the libraries load after the
.OBJ's.
<P>
The following is a method that be used to perform the equivolent operation
when linking with library files that may rearange the segment order:
<P>
Begin your program with a list of declarations for all segments in your
program. This will solve the load-order problem. However, if your segments
are all named to classes and the order of the classes is all that is
important, you only need one segment declaration per class.
<P>
Define a new and empty segment to be the last segment in your load image.
Place your empty segment at the end of the list. The following is an
example:
<P>
<PRE>   ; Declarations to fix the load order. First, MYCODE
   ; and all segments of class CODE.

   MYCODE SEGMENT 'CODE'
   MYCODE ENDS

   ; Next MYDATA and all segments of class DATA

   MYDATA SEGMENT PUBLIC 'DATA'
   MYDATA ENDS

   ; Finally, LASTSEG.

   LASTSEG SEGMENT
   LASTSEG ENDS

</PRE>In the above, LASTSEG is the last segment in the load order (assuming all
other segments in the program belong to either class CODE or DATA) and thus
marks the beginning of free memory above the load image.
<P>
If your segment declarations occur randomly throughout your source files
and libraries, the solution is not as simple. The method to use is to make
a new library, to be linked in last, that defines this last empty segment
and a label in this segment. (You must have a reference to this label in
some part of the program so the linker will pull in this library.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.25 1.27 3.0x 4.00 5.00 5.10 6.00<BR>
KBCategory: kbprg<BR>
KBSubCategory: MASMLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
