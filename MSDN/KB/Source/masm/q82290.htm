

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX:EXTRN ABS Doesn't Work As Software Interrupt Number </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" HREF="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82290 ">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1992/03/30">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  In the Microsoft Macro Assembler (MASM) versions 5.1 and 5.1a or QuickAssembler versions 2.01 and 2.51, using an absolute external symbol as a software interrupt number fails to generate the correct number at link time. The module accessing this PU...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAH4,QAKC,QADN,QAHC,QBC6,QAAP,QAIJ,QAG8,QAKP,QAFR,QBXS,QA4Q,QAWN,QAWM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX:EXTRN ABS Doesn't Work As Software Interrupt Number</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82290 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.10 5.10a | 5.10 5.10a
<PRE>MS-DOS     | OS/2
</PRE>kbtool kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 5.1 and 5.1a
<LI>Microsoft Macro Assembler for OS/2, versions 5.1 and 5.1a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the Microsoft Macro Assembler (MASM) versions 5.1 and 5.1a or
QuickAssembler versions 2.01 and 2.51, using an absolute external symbol as
a software interrupt number fails to generate the correct number at link
time. The module accessing this PUBLIC symbol does not generate the proper
number; instead, it gets set to 0. This is a problem only when the symbol
is used with the INT instruction. In MASM version 5.1, using an absolute
external symbol causes the linker to generate:
<P>
<PRE>   error L2029: Unresolved externals.

</PRE><h2>RESOLUTION</h2>
 
<P>
You can work around this problem by using an equate declared in an include
file rather than relying on an absolute external. The include file that
contains this equate can be included in all the source files that need to
access the equate. This allows the assembler to determine the value of the
symbol, instead of relying on the linker to provide the value.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in MASM versions 5.1 and 5.1a
and QuickAssembler versions 2.01 and 2.51 (buglist2.01 and buglist2.51).
This problem was corrected in MASM version 6.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code demonstrates the incorrect result. To reproduce
this error, assemble both HELLO.ASM and DISPLAY.ASM with MASM 5.1a,
then link together using LINK version 5.01.20.
<P>
<P><h3>Sample Code</h3>
 
<P>
; HELLO.ASM
; Assemble options needed: none
<P>
.MODEL small, c
DOSSEG
<P>
PUBLIC mydata
mydata EQU 21h
<P>
.STACK 256
<P>
.CODE
EXTRN display:proc
start:
<PRE>    call display

    mov ax, 04C00h
    int 21h
</PRE>END start
<P>
<P>
; DISPLAY.ASM
; Assemble options needed: none
<P>
.MODEL small, c
DOSSEG
<P>
EXTRN mydata:ABS
<P>
.CODE
display PROC
<PRE>    mov ah,mydata ; Gets set to 21h by the linker
    int mydata    ; Doesn't get set to 21h by the linker
                  ; Results in Divide overflow
                  ; Results in Illegal Instruction under CodeView
    ret
</PRE>display endp
END
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10 5.10a extern extrn buglist5.10<BR>
buglist5.10a fixlist6.00<BR>
KBCategory: kbtool kbfixlist kbbuglist<BR>
KBSubCategory: MLIss<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
