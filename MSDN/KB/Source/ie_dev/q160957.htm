

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dynamic Data Exchange Support in Microsoft Internet Explorer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160957">
<META NAME="KBModify" CONTENT="1997/10/03">
<META NAME="KBCreate" CONTENT="1996/12/13">
<META NAME="Keywords" CONTENT="msiexplore kbusage">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  Several years ago, Spyglass, Inc. defined a Software Development Interface (SDI) that has served as the basis for most common interprocess communication (IPC) support in current browsers.  The SDI is composed of a number of generic, platform-indepe...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV9,QBRJ,QBBI,QAUD,QDOQ,QAVZ,QA6A,QBUG,QBUF,QBWP,QBDM,QAPF,QDL9,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Dynamic Data Exchange Support in Microsoft Internet Explorer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160957</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer versions 3.0, 3.01 for Windows 95
<LI>Microsoft Internet Explorer versions 3.0, 3.01 for Windows NT 4.0
<LI>Microsoft Internet Explorer version 3.x for Windows 3.1
<LI>Microsoft Internet Explorer version 3.x for Windows NT 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Several years ago, Spyglass, Inc. defined a Software Development Interface
(SDI) that has served as the basis for most common interprocess
communication (IPC) support in current browsers.
<P>
The SDI is composed of a number of generic, platform-independent verbs that
are implemented through platform-specific transports. For Internet Explorer
(IE) running in the Microsoft Windows environment, that platform-specific
transport is DDE.
<P>
The 16-bit versions of Internet Explorer for Windows 3.1 and Windows NT
3.51 very closely followed this Spyglass specification. Versions 2.x and
3.x of the 16-bit Internet Explorer supported the entire list of topics as
well as parameters outlined in the spec. If your application specifically
targets the 16-bit version of Internet Explorer, please refer to the
Spyglass SDI specs above for more information on its DDE support.
<P>
On the other hand, the 32-bit versions of Internet Explorer, supported only
a subset of the topics described in the Spyglass SDI specification. This
article specifically lists this subset of topics supported by the 32-bit IE
versions, as well as relevant DDE-specific information for each of these
topics.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Most of the information below applies to the 32-bit versions of Internet
Explorer, unless specifically indicated.
<P>
In each of the DDE transactions described below, you need to specify the
following:
<P>
<PRE>   ApplicationName : iexplore
   DDE Transaction Type: XTYP_EXECUTE or XTYP_REQUEST

</PRE>Topic and item names and expected return values for each verb are described
below. Note that Internet Explorer version 2.0 and earlier used "mosaic" as
its service name, instead of "iexplore."
<P>
Note that all strings passed to DDEML using DdeCreateStringHandle are
limited to 255 characters. When passing item names to any of the topics
described below, strings greater than 255 characters long are truncated.
<P>
For more information about this 255-character limit in DDEML, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q102570.htm">Q102570</A></B>
   TITLE     : DOCERR: DdeCreateStringHandle() lpszString param

</PRE><h3>OpenURL</h3>
 
<P>
OpenURL retrieves a URL off the Web and displays it, based on specified
WindowID:
<P>
<PRE>   topicName: WWW_OpenURL
   itemName : URL  &lt;Example: "<B><A HREF="http://www.microsoft.com">http://www.microsoft.com</A></B>"&gt;
   returnValue: -2 for acknowledgment, -3 for error

</PRE>In the 32-bit versions of Internet Explorer, all other parameters specified
in the SDI spec are ignored.
<P>
Note that when specifying the URL for the 16-bit version of IE, be sure to
specify the full URL, including the protocol, for example,
"<B><A HREF="http://www.microsoft.com">http://www.microsoft.com</A></B>" instead of "www.microsoft.com"; otherwise, the
OpenUrl call will fail.
<P>
For IE4, itemName can be specified as follows:
<P>
<PRE>   itemName: URL,[FileSpec],WindowID  &lt;Example:
   "<B><A HREF="http://www.microsoft.com">http://www.microsoft.com</A></B>",,0&gt;

</PRE>Note that the second parameter, FileSpec, specified in the SDI spec, is
ignored, and is, therefore, not specified in the itemName example above.
All other parameters following the WindowID parameter that are not
specified above are similarly ignored.
<P>
Specifying a WindowID of 0 tells the browser to open a new window; whereas
-1 opens the URL in the most recently active browser window.
<P>
<P><h3>ShowFile</h3>
 
<P>
ShowFile passes FileSpec to be rendered in a given WindowID:
<P>
<PRE>   topicName: WWW_ShowFile
   itemName: FileSpec
   returnValue: -2 for acknowledgment, -3 for error

</PRE>All other parameters are ignored.
<P>
<P><h3>ActivateWindow</h3>
 
<P>
Regardless of the WindowId specified, ActivateWindow brings the most
recently active browser window to the foreground:
<P>
<PRE>   topicName: WWW_Activate
   itemName:  WindowID &lt;any value&gt;
   returnValue: WindowID

</PRE>All other parameters are ignored.
<P>
Note that the WindowID returned is synthetic; that is, it can only be used
in other DDE transactions with IE. It should not be assumed as an HWND.
<P>
<P><h3>Exit</h3>
 
<P>
Exit tells the browser to shut down and exit:
<P>
<PRE>   topicName: WWW_Exit
   itemName: WWW_Exit
   returnValue: 0

</PRE><h3>RegisterURLEcho</h3>
 
<P>
RegisterURLEcho requests that ApplicationName be notified of URLEcho events
whenever a URL gets loaded. Multiple servers can be registered to get these
notifications:
<P>
<PRE>   topicName: WWW_RegisterURLEcho
   itemName: ApplicationName (enclosed in double quotes)
   returnValue: Non-Zero for success, 0 for failure

</PRE>ApplicationName is a DDE server that is registered to receive WWW_URLEcho
notifications from the browser with the following information:
<P>
<PRE>   topicName (hsz1): WWW_URLEcho
   itemName  (hsz2): URL,MIMEType,WindowID
   &lt;Example: "<B><A HREF="http://www.home.com">http://www.home.com</A></B>","text/html",-1&gt;
   Transaction: XTYP_POKE

</PRE>NOTE: WWW_RegisterURLEcho and WWW_UnRegisterURLEcho are new to IE 3.01. An
application using IE 3.0 may need to upgrade to IE 3.01 to take advantage
of this functionality.
<P>
<P><h3>UnRegisterURLEcho</h3>
 
<P>
UnRegisterURLEcho terminates associated request for URLEcho events
notification:
<P>
<PRE>   topicName: WWW_UnRegisterURLEcho
   itemName:  ApplicationName (enclosed in double quotes)
   returnValue: 0

</PRE>IE4 returns success/failure on this (instead of ALWAYS 0).
<P>
<P><h3>RegisterProtocol</h3>
 
<P>
RegisterProtocol registers the DDE Server application, Server.exe, to
handle URLs of a specific Protocol type:
<P>
<PRE>   topic Name: WWW_RegisterProtocol
   item Name:  AppName,Protocol &lt;Example:"AppName","mailto"&gt;

</PRE>Where "AppName" is Server.exe's registered Service Name, and "mailto" is
the protocol to be registered.
<P>
Note that each of the strings have to be explicitly enclosed in double
quotes. For Example, in C, the same string will have to be specified as:
<P>
<PRE>   "\"AppName\",\"mailto\""
   returnValue: Non-Zero for success, 0 for failure

</PRE>Server.exe will then get notifications from the browser with the following
information:
<P>
<PRE>   topic Name (hsz1): WWW_OpenURL
   item Name  (hsz2): URL,[FileSpec],WindowID,Flags
   &lt;Example:"mailto:billg@ms.com",,-1,0&gt;
   Transaction: XTYP_REQUEST

</PRE>Note that Flags is currently undefined and is always set to 0.
<P>
In order to convert hsz1 and hsz2 into strings, the function DdeQueryString
needs to be called.
<P>
Note that, as indicated in the specification, a protocol can be registered
to only one DDE server application at a time. In this case, only the
application Server.exe will get notifications from the browser whenever the
user clicks on any "mailto:" reference on a Web page.
<P>
<P><h3>UnRegisterProtocol</h3>
 
<P>
UnRegisterProtocol terminates associated request for protocol notification:
<P>
<PRE>   topicName: WWW_UnRegisterProtocol
   itemName:  ApplicationName (enclosed in double quotes)
   returnValue: 0

</PRE><h3>ListWindows</h3>
 
<P>
Returns a list of window IDs for windows currently used by the browser:
<P>
<PRE>   topicName: WWW_ListWindows
   itemName:  WWW_ListWindows
   returns: NumItemsInTheList,ArrayOfWindowIDs
   (ie [count,winID,winID,winID])

</PRE>Currently Internet Explorer always returns 1,-1 indicating there's only one
window open, which may or may not necessarily be true.
<P>
<P><h3>GetWindowInfo</h3>
 
<P>
Returns URL and WindowText currently being displayed in the browser window:
<P>
<PRE>   topicName: WWW_GetWindowInfo
   itemName:  WWW_GetWindowInfo
   returnValue: URL,WindowText
   &lt;Example: "<B><A HREF="http://www.microsoft.com/">http://www.microsoft.com/</A></B>","Microsoft Home Page"&gt;

</PRE>Note that the strings are quoted; therefore, double quotes are denoted with
backslashes. For example, if the title consists of the three characters
!"!, the title portion of the returned string as the six characters "!\"!".
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../AXSDK/Q160976.htm">Q160976</A></B>
   TITLE     : How to Control the Currently Running Instance of IE3 via DDE
</PRE> 
<PRE>Keywords          : msiexplore kbusage
Technology        : kbole
Version           : 2.0 2.01 2.1 3.0 3.01
Platform          : NT WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
