

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: #import "shdocvw.dll" / tagREADYSTATE compile errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169433">
<META NAME="KBModify" CONTENT="1997/10/03">
<META NAME="KBCreate" CONTENT="1997/05/30">
<META NAME="Keywords" CONTENT="AXSDKIESripting kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  When using the #import compiler directive to import Shdocvw.dll, several errors similar to the following will be reported:     error C2556: 'GetReadyState' : overloaded functions    only differ by return type     error C2371: 'GetReadyState' : rede...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAB4,QAEQ,QBRJ,QBV9,QDKS,QAKP,QDNN,QAP2,QAJQ,QDKW,QACM,QBVV,QBFY,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: #import "shdocvw.dll" / tagREADYSTATE compile errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169433</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), version 4.0
<LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the #import compiler directive to import Shdocvw.dll, several
errors similar to the following will be reported:
<P>
<PRE>   error C2556: 'GetReadyState' : overloaded functions
   only differ by return type

   error C2371: 'GetReadyState' : redefinition;
   different basic types

   error C2664: 'get_ReadyState' : cannot convert
   parameter 1 from 'enum SHDocVw::tagREADYSTATE *' to 'enum tagREADYSTATE
   *'

</PRE>When using the #import compiler directive with the no_namespace attribute
to import Shdocvw.dll, several errors similar to the following will be
reported:
<P>
<PRE>   error C2011: 'tagREADYSTATE' :
   'enum' type redefinition

   error C2871: 'SHDocVw' : does not
   exist or is not a namespace

</PRE><h2>CAUSE</h2>
 
<P>
These errors are generated because of the inclusion of the tagReadyState
definition in Ocidl.idl (included by the .idl for shdocvw).
<P>
Including tagReadyState in Ocidl.idl causes tagReadyState to be included in
the type library for Shdocvw.dll. In turn, #import "shdocvw.dll" includes
the definition of tagReadyState in the generated headers for Shdocvw.dll.
This definition collides with the definition of tagReadyState in Ocidl.h.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The exclude attribute of the #import directive can be used to work around
this problem.
<P>
Use #import shdocvw.dll as follows:
<P>
<PRE>   #import &lt;shdocvw.dll&gt; exclude("tagREADYSTATE")

</PRE>The tagReadyState will be defined for your project through the inclusion of
Ocidl.h.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Visual C++ Preprocessor Reference: The #import directive
 
<PRE>Keywords          : AXSDKIESripting kberrmsg
Technology        : kbInetDev kbole
Version           : 4.0 5.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
