

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FILE: IEHelper-Attaching to IE4 using a Browser Helper Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179230">
<META NAME="KBModify" CONTENT="1998/02/16">
<META NAME="KBCreate" CONTENT="1998/01/13">
<META NAME="Keywords" CONTENT="AXSDKWebBrowser">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  In order to attach to a running instance of Internet Explorer 4.0, you can use a  Browser Helper Object.  A  Browser Helper Object  is a DLL that will attach itself to every new instance of Internet Explorer 4.0. You can use this feature to gain ac...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QBV9,QAKJ,QBQU,QBIC,QAVZ,QDL9,QBWO,QBWN,QBRJ,QAY2,QAB5,QAIJ,QAO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: IEHelper-Attaching to IE4 using a Browser Helper Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179230</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), versions 4.0, 4.01
<LI>Internet Client SDK, versions 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In order to attach to a running instance of Internet Explorer 4.0, you can
use a "Browser Helper Object." A "Browser Helper Object" is a DLL that will
attach itself to every new instance of Internet Explorer 4.0. You can use
this feature to gain access to the object model of a particular running
instance of Internet Explorer. You can also use this feature to get events
from an instance of Internet Explorer 4.0.
<P>
This article also points to a sample that demonstrates how to implement a
Browser Helper Object.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/IEHelper.exe">IEHelper.exe</A> <I>(size: 39958 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h3>Browser Helper Objects</h3>
 
<P>
When an instance of Internet Explorer 4.0 is started, it looks in the
registry for CLSIDs stored under the following key:
<P>
<PRE>   HKLM\SOFTWARE\Microsoft\Windows
       \CurrentVersion\Explorer\Browser Helper Objects

</PRE>If this key exists and there are CLSIDs listed under it, Internet Explorer
will use CoCreateInstance() to try to create an instance of each object
listed as a subkey under this key. Note that the CLSID of the object you
create must be listed as a subkey and not a named value.
<P>
For example, imagine that the following entry exists in the registry,
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper
Objects\{CE7C3CF0-4B15-11D1-ABED-709549C10000}. Internet Explorer will try
to create an instance of the object pointed to by the CLSID {CE7C3CF0-4B15-
11D1-ABED-709549C10000} each time Internet Explorer starts.
<P>
These registry keys can be created manually or through the self
registration portion of your COM application.
<P>
There are some requirements when creating a Browser Helper Object

<UL><LI>The application that you create must be an in-proc server (that is,
   DLL).

<LI>This DLL must implement IObjectWithSite.

<LI>The IObjectWithSite::SetSite() method must be implemented. It is through
   this method that your application receives a pointer to Internet
   Explorer's IUnknown. (Internet Explorer actually passes a pointer to
   IWebBrowser2 but the implementation of SetSite() receives a pointer to
   IUnknown.) You can use this IUnknown pointer to automate Internet
   Explorer or to sink events from Internet Explorer.

<LI>It must be registered as a Browser Helper Object as described above.
<P>
</UL>WARNING: Internet Explorer will create an instance of each Browser Helper
Object listed in the registry every time a new instance of Internet
Explorer is started. This means that if you have Active Desktop installed,
the Browser Helper Objects will be loaded every time you open a new folder
as well as when the browser itself is started.
<P>
(c) Microsoft Corporation 1998, All Rights Reserved. Contributions by Scott
Roberts, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Helper<BR>
Keywords          : AXSDKWebBrowser<BR>
Technology        : kbInetDev internet ole<BR>
Version           : WINDOWS:4.0,4.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
