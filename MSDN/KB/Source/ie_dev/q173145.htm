

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: IE3.x Leaks Memory when Submitting Pages Using POST Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173145">
<META NAME="KBModify" CONTENT="1998/01/02">
<META NAME="KBCreate" CONTENT="1997/08/26">
<META NAME="Keywords" CONTENT="VIMisc">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  When working in Internet Explorer 3.x and submitting pages that use the                    tag, you may notice one of the following on the client machine:   - Resources are used and not released.   - The computer slows, becomes sluggish, or may eve...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALZ,QDNQ,QBRJ,QBWA,QBV9,QBRT,QAFZ,QAPN,QAGE,QBVX,QBW6,QBWP,QBVV,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: IE3.x Leaks Memory when Submitting Pages Using POST Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173145</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer versions 3.01, 3.02 for Windows NT 4.0
<LI>Microsoft Active Server Pages, versions 1.0, 1.0b
<LI>Microsoft Internet Explorer versions 3.01, 3.02 for Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When working in Internet Explorer 3.x and submitting pages that use the
&lt;Form Method=POST&gt; tag, you may notice one of the following on the client
machine:

<UL><LI>Resources are used and not released.

<LI>The computer slows, becomes sluggish, or may even hang.

<LI>You receive the message "Out of memory. Please close one or more
   applications and try again"
<P>
</UL>These symptoms occur on the client machine, not on the Web server. Shutting
down Internet Explorer 3.x frees the memory and causes the computer to run
normally.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Internet Explorer 3.x caches page information when using the
&lt;Form Method=POST&gt; tag and fails to free the memory until the application
is shut down.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent Internet Explorer 3.x from caching the page information, use
Active Server Pages (ASP) to add an HTTP header to the page with the POST
method. This is easily accomplished using Active Server Pages by adding the
following line to the top of an .asp page:
<P>
<PRE>   &lt;% Response.AddHeader "Pragma", "No-Cache" %&gt;

</PRE>If the page with the POST method is an HTML page, simply add the ASP code
to the page and change the extension to .asp to force the page to be parsed
by the Asp.dll, thereby adding the header.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Pages being hosted by Web servers that do not support ASP can use other
methods such as Pearl script to add an HTTP header. Consult the Pearl or
other language documentation for information on adding HTTP headers.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Paste the code below into a page named POST.asp.

<P><LI>Launch any resource monitor to view memory usage. For example, "Task
   Manager" in Windows NT.

<P><LI>Launch the Post.asp file created in step 1 above in Internet Explorer.

<P><LI>Click Submit multiple times. Result: "Memory Usage History" in the
   Performance tab of Task Manager does not show an increase in memory
   usage.

<P><LI>Remove the first line--&lt;% Response.AddHeader "Pragma", "No-Cache" %&gt;--
   from the Post.asp file. Save the file.

<P><LI>Refresh the Post.asp page in Internet Explorer.

<P><LI>Press the submit button multiple times.
<P>
</OL>"Memory Usage History" in the "Performance" tab of "Task Manager" will show
an increase in memory usage.
<P>
<PRE>   =======Post.asp begin.  Do not pass this line in Post.asp=============
   &lt;% Response.AddHeader "Pragma", "No-Cache" %&gt;
   &lt;HTML&gt;
   &lt;HEAD&gt;&lt;TITLE&gt;Sample adding HTTP header using ASP&lt;/TITLE&gt;&lt;/HEAD&gt;
   &lt;BODY&gt;
   &lt;FORM Name=frmProposals METHOD=POST ACTION="post.asp"&gt;
       &lt;INPUT Type=Submit Value="Submit"&gt;
   &lt;/FORM&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: leak<BR>
Keywords          : VIMisc<BR>
Technology        : kbInetDev<BR>
Version           : WINDOWS:3.01,3.02; WINDOWS NT:1.0,1.0b<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 2, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
