

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Content-Disposition: Does not Force File Download Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182315">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1998/03/11">
<META NAME="Keywords" CONTENT="ISAPIext">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  According to the Web site http://ds.internic.net/rfc/rfc2183.txt, setting a Content-Disposition header with type  attachment  when returning a file to a client, should force the client to prompt the user for input. Typically this input would indica...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QBV9,QA63,QAGU,QBIC,QA01,QAO0,QACF,QAP2,QAFI,QBRJ,QBVV,QAV1,QAV0,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Content-Disposition: Does not Force File Download Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182315</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), version 4.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
According to the Web site <B><A HREF="http://ds.internic.net/rfc/rfc2183.txt">http://ds.internic.net/rfc/rfc2183.txt,</A></B> setting a
Content-Disposition header with type "attachment" when returning a file to
a client, should force the client to prompt the user for input. Typically
this input would indicate whether the user wishes to view or store the
file. Internet Explorer 4.01 may attempt to open the returned file without
prompting the user.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a document file for an application installed on a client is first
opened in the Internet Explorer, the Explorer will present the user with a
File Download dialog box prompting the user with the following options:

<UL><LI>Open this file from its current location
<LI>Save this file to disk
<P>
</UL>This dialog box also presents the user with the following check box:
<P>
<PRE>   Always ask before opening this type of file

</PRE>Once the user clears this check box, Explorer will always open files of
this type.
<P>
When a file is returned to the Explorer with a Content-Disposition header
with type "attachment," Explorer should prompt the user regardless of
the above selection. In fact, Explorer may not always prompt the user.
<P>
Internet Explorer 4.01 does support the Content-Disposition header in that
it will initialize the File Download dialog box (if it does appear) with a
suggested file name. The following code demonstrates how to send the
Content-Disposition header and a suggested file name from a CGI program:
<P>
<PRE>   #include &lt;stdio.h&gt;
   int main()
   {
     char szContentType[]="Content-Type: bad/type\r\nContent-Disposition:"
                          " attachment; filename=name.xxx\r\n\r\n";
     printf(szContentType);
     printf("This is a test.");
     return 0;
   }

</PRE>Do not include a path in the file name parameter. Also, do not enclose it
in quotes.
<P>
You might think that setting the Content-Type to a type unknown to Explorer
would force the File Download dialog box. In fact, the Explorer "sniffs"
the data sent from the server and detects the type of file being sent. If
it recognizes the file type, it will behave according to the user
preference. At this point, there is no completely reliable way to force the
File Download dialog box to appear when downloading a file to Internet
Explorer.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<B><A HREF="http://ds.internic.net/rfc/rfc2183.txt">http://ds.internic.net/rfc/rfc2183.txt</A></B>
<P>
(c) Microsoft Corporation 1998, All Rights Reserved. Contributions by
Robert Duke, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbdsi<BR>
Keywords          : ISAPIext<BR>
Version           : WINDOWS:4.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
