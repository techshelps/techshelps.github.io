

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setup Error Message: "While Registering OLE Servers..." </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100836">
<META NAME="KBModify" CONTENT="1998/01/28">
<META NAME="KBCreate" CONTENT="1993/06/29">
<META NAME="Keywords" CONTENT="kberrmsg kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; setup">
<META NAME="Description" CONTENT="  The following error message may occur while you run Setup program for one of the products listed above:     While registering OLE servers, Setup had a problem with REG.DAT,    SHELL.DLL or disk space.  CAUSE =====  The following conditions can caus...">
<META NAME="Product" CONTENT="Setup">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAYL,QANE,QBXS,QAA1,QBWS,QDI2,QAH4,QAIH,QBFY,QDKW,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Setup Error Message: "While Registering OLE Servers..."</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 28, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100836</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a
<LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft PowerPoint for Windows, version 3.0, 4.0
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Office for Windows, version 4.0, 4.2
<LI>Microsoft Windows operating system, versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups, versions 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error message may occur while you run Setup program for one
of the products listed above:
<P>
<PRE>   While registering OLE servers, Setup had a problem with REG.DAT,
   SHELL.DLL or disk space.

</PRE><h2>CAUSE</h2>
 
<P>
The following conditions can cause this error:

<UL><LI>Your WINDIR variable setting is invalid or missing.

<LI>Your REG.DAT file is corrupt.

<LI>The setting for FILES and BUFFERS in CONFIG.SYS is incorrect.

<LI>Your WIN.INI file is incorrectly edited.

<LI>Your REG.DAT file is set to READ-ONLY.

<LI>You have a virus protection program running on your computer.

<LI>A .REG file for a component of a Microsoft program is corrupt.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
<P><h3>Workaround 1: Invalid or Missing Windir Variable</h3>
 
<P>
WINDIR is an environment variable set by Windows, based on the path in the
AUTOEXEC.BAT file. If the PATH statement in the AUTOEXEC.BAT file includes
the Windows program directory without the drive (for example, "\WINDOWS"
instead of "C:\WINDOWS"), Windows may set the WINDIR variable incorrectly.
<P>
Use the following instructions to check the current WINDIR environment
variable:

<OL><P><LI>Choose the MS-DOS Prompt from the Main Group.

<P><LI>At the command prompt in the MS-DOS Prompt window, type "set"
   (without the quotation marks) and then press ENTER. A list of
   environment variables should appear, including the WINDIR
   variable (for example, WINDIR=C:\WINDOWS).
<P>
<P><PRE>     NOTE: This step must be done by shelling to MS-DOS while
     Windows is running, not by exiting Windows and typing "set"
     at the MS-DOS command prompt.
</PRE>
<P><LI>If the WINDIR variable is missing or if it points to a
   directory other than your current Windows program directory,
   use one of the workarounds below to successfully install the
   Word OLE servers.
<P>
<P><PRE>     NOTE: You cannot manually set the WINDIR variable by typing
     "set windir=c:\windows" at the command prompt; Windows must
     set this variable at startup.
</PRE><P>
</OL>Use one of the following methods to correctly set your WINDIR environment
variable:
<P>
Method 1: Temporarily Set Correct WINDIR Variable
<PRE>          ---------------------------------------

          This workaround does not correct the PATH statement in your
          AUTOEXEC.BAT file that caused Windows to set the WINDIR variable
          incorrectly. This workaround temporarily sets the WINDIR variable
          so you can successfully install the Word OLE servers.

          1. Quit Windows.

          2. Do one of the following:

              - At the command prompt, start Windows by typing the
                following and pressing ENTER:

                   c:\windows\win.com

                  NOTE: In the above syntax, substitute the path to your
                  Windows program directory for "c:\windows."

                -or-

              - Start Windows by typing the following at the command prompt
               (press ENTER after each line):

                   cd\windows
                   win

          3. Run the Word Setup program.

</PRE></OL>Method 2: Permanently Set Correct WINDIR Variable
<PRE>          ---------------------------------------

          This workaround changes the PATH statement in your AUTOEXEC.BAT
          file so Windows always correctly sets the WINDIR variable.

          1. In a text editor, open your AUTOEXEC.BAT file.

          2. Change the PATH statement so it includes the complete Windows
             program directory, including the drive letter. For example, if
             your Windows program directory is "C:\WINDOWS," your PATH
             statement might appear as follows:

                PATH C:\DOS;C:\WINDOWS;C:\WINWORD;C:\EXCEL

          3. Save and close your AUTOEXEC.BAT file.

          4. Restart your computer.

          5. Start Windows and run the Word Setup program.

</PRE><h3>Workaround 2: Corrupt REG.DAT File</h3>
 
<P>
Use the following instructions to rebuild a corrupt REG.DAT file:

<OL><P><LI>From File Manager select REG.DAT, from the File menu select Rename
   and type REG.OLD to rename the file.

<P><LI>From the File menu select Run and type:
<P>
<P><PRE>      regedit /u c:\windows\system\setup.reg
</PRE><P>
   If you are running Microsoft Windows for Workgroups, version 3.11, type:
<P>
<P><PRE>      regedit c:\windows\system\setup.reg
</PRE>
<P><LI>Choose OK. The REG.DAT file should now be rebuilt.

<P><LI>Exit Windows. Restart Windows. Run the Setup program again.
<P>
</OL>For more information about troubleshooting REG.DAT problems, query on the
following words in the Microsoft Knowledge Base:
<P>
<PRE>   reg.dat and corrupt and rebuild

</PRE></OL><h3>Workaround 3: Incorrect FILES and BUFFERS Settings in CONFIG.SYS</h3>
 
<P>
Set FILES=60 in your CONFIG.SYS file unless you have a software application
that requires a higher setting. Set BUFFERS=10 in your CONFIG.SYS file if
you use SMARTDRV.EXE. Using a high number of buffers with SMARTDRV will
decrease efficiency. If you are not using SMARTDRV, set BUFFERS=30. More
buffers may improve disk access times but will use more conventional
memory. Run the Setup program again.
<P>
<P><h3>Workaround 4: WIN.INI File Incorrectly Edited</h3>
 
<P>
Rename your WIN.INI file and the problem no longer occurs.
<P>
<P><h3>Workaround 5: REG.DAT file is set to READ-ONLY</h3>
 
<P>
Use File Manager to locate your REG.DAT file. Highlight the file, click
Properties on the File menu, then deselect the Read Only attribute.
<P>
<P><h3>Workaround 6: Antivirus Program Running</h3>
 
<P>
Disable your virus detection utility before you run Setup. If you do not
disable the utility, Setup may conflict with it and not run.
<P>
<P><h3>Workaround 7: A .REG file for a component of a Microsoft program is corrupt</h3>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q122964.htm">Q122964</A></B>
   TITLE     : How to Register Applications in the REG.DAT File

</PRE><h2>REFERENCES</h2>
 
<P>
Word for Windows "Getting Started," version 2.0, pages 7-11
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.00 2.00a 2.00a-CD 2.00b 2.00c winppt grphflt<BR>
6.00 6.00a officeinterop acme 3.00 3.10 4.00 5.00 XL5 macppt diskspace WFW<BR>
WFWG<BR>
Keywords          : kberrmsg kbsetup<BR>
Version           : 1.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 28, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
