

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error Returned If You Don't Restart Windows After Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110372">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1994/01/19">
<META NAME="Keywords" CONTENT="kberrmsg kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; setup">
<META NAME="Description" CONTENT="  If you choose not to restart Windows after you install one of the applications listed above, you receive the following error message:     Setup is not yet complete. You need to exit Windows and run the    following application from DOS and then res...">
<META NAME="Product" CONTENT="Setup">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAA1,QBWQ,QDI2,QDIZ,QAIJ,QDK2,QAXB,QAEF,QBWS,QAB4,QAGB,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Returned If You Don't Restart Windows After Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110372</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a
<LI>Microsoft PowerPoint for Windows, version 4.0
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Works for Windows, version 3.0
<LI>Microsoft Office for Windows, versions 4.0, 4.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you choose not to restart Windows after you install one of the
applications listed above, you receive the following error message:
<P>
<PRE>   Setup is not yet complete. You need to exit Windows and run the
   following application from DOS and then restart Windows:

      C:\WINDOWS\_MSRSTRT.EXE

   After restarting Windows, Setup will be complete.

</PRE><h2>CAUSE</h2>
 
<P>
During the setup program, _MSRSTRT.EXE runs a file called _MSSETUP.BAT,
deletes the _MSSETUP.BAT file, deletes itself, and then restarts Windows.
If you choose not to restart Windows, this procedure is left undone.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
When you receive this error message, you should exit Microsoft Windows at
the next available opportunity and run the _MSRSTRT.EXE application which
is located in your Windows directory.
<P>
Note that the file _MSRSTRT.EXE is created by the Setup program and is not
on any of the original disks.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The _MSRSTRT.EXE application is designed to replace/remove components of
the application you are installing that may be in use by the operating
system. Components that are in use by Microsoft Windows cannot be replaced
or removed during the current Microsoft Windows session: therefore, it is
necessary to exit Microsoft Windows to accomplish this task. When you run
the _MSRSTRT.EXE application from MS-DOS, the proper components are
replaced/removed and the setup process is completed.
<P>
Restart can be caused by:
<P>
- Replacing files marked "system" in the INF when that file is in use by
<PRE>  another application/Windows.

</PRE>- Installing TTF files when TTF Control Panel flag is disabled.
<P>
- Installing VSHARE.386
<P>
- CustomAction performing restart for some reason.
<P>
_MSSETUP.BAT is created during the setup procedure. The batch file deletes
the temporary directory, ~msstfqf.f, that Setup used to install the
application. It also loads the Share program, or VSHARE.386 if it is not
loaded already.
<P>
_MSSETUP.BAT is a text file and can be opened in any text editor.
<P>
There is no pratical ways to disable the restart operation, but with
another application you can force an abort of this process by handling the
WM_QUERYENDSESSION message and dismissing the Setup dialogs to follow.
<P>
For more information about the Share program, query on the following words
in the Microsoft Knowledge Base:
<P>
<PRE>   vshare.386 and share.exe and setup
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: install winppt kbsetup acme acmsetup fails <BR>
successful successfully incomplete macppt officeinterop w4woffice<BR>
Keywords          : kberrmsg kbsetup<BR>
Version           : 1.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
