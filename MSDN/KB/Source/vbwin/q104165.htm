

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Run a WinHelp Macro from a Help File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104165">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/09/09">
<META NAME="Keywords" CONTENT="kbtool kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows by example how to invoke WinHelp macros in a Help file upon first entering a topic or upon clicking a hot spot. The examples show you how to modify the example help topic source file VB\HC\ICONWRKS.RTF using Microsoft Word versio...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QAUD,QAH4,QAE2,QAMB,QBS8,QBSO,QBWS,QAGI,QBXS,QATX,QAIH,QAY2,QA6A,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Run a WinHelp Macro from a Help File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104165</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 1.0, 2.0, and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to invoke WinHelp macros in a Help file
upon first entering a topic or upon clicking a hot spot. The examples show
you how to modify the example help topic source file VB\HC\ICONWRKS.RTF
using Microsoft Word version 2.0 for Windows. After making the changes and
compiling the .RTF file into a Help file (.HLP file), you will be able to
execute a macro upon first entering the topic or upon clicking a hot spot.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To run a macro when a topic is first entered, enter the macro call into
a custom footnote with an exclamation (!) as the footnote mark. To do
this in Microsoft Word version 2.0 for Windows, follow these steps:

<OL><P><LI>Open the file VB\HC\ICONWRKS.RTF.

<P><LI>Locate the beginning of this topic heading:
<P>
<P><PRE>      Editor: Commands and Tools
</PRE><P>
   Place the text caret at the beginning of the line, in front of the pound
   (#) character.

<P><LI>From the Insert menu, choose Footnote and select Custom Footnote Mark.
   Enter the exclamation mark (!) and choose the OK button. The Footnotes
   area appears at the bottom of the window with the caret on a line that
   begins with the exclamation mark (!).

<P><LI>Enter this text:
<P>
<P><PRE>      About()
</PRE>
<P><LI>To save this change, from the File menu, choose Close. In each of the
   subsequent three dialogs, press the Enter key to select the default
   button.

<P><LI>At the command prompt, set the current directory to VB\HC. Then enter
   the following command to compile the help file:
<P>
<P><PRE>      HC31 ICONWRKS.HPJ
</PRE>
<P><LI>Load the resulting ICONWRKS.HLP file into WINHELP.EXE. To do this in the
   Program Manager, from the File menu, choose Run. Then enter the full
   path of VB\HC\ICONWRKS.HLP. The IconWorks help file appears.

<P><LI>Click the hot spot Commands and Tools to jump to the topic that contains
   the macro call. When the topic appears, the About() macro displays a
   dialog box titled About Help.
<P>
</OL>To run a macro immediately when a hot spot is clicked, format the hot spot
text as double-underlined text followed by an exclamation mark (!) and the
macro call -- both formatted as hidden text. To do this in Microsoft Word
version 2.0 for Windows, follow these steps:

<OL><P><LI>Open the file VB\HC\ICONWRKS.RTF.

<P><LI>From the Tools menu, choose Options. Select the View Category. In the
   section labeled Nonprinting Characters, check Paragraph Marks and
   Hidden Text.

<P><LI>Place the text caret at the beginning of the second line of the file
   (the line following the heading). Enter the text "Call Macro!About()"
   without the quotation marks, and press the Enter key.

<P><LI>Select the text "Call Macro" up to but not including the exclamation
   mark. From the Format menu, choose Character. Change the setting in the
   combo box labeled Underline from None to Double. Choose the OK button.

<P><LI>Select the text "!About()" up to but not including the paragraph
   character at the end of the line. From the Format menu, choose
   Character. In the Style section, check Hidden.

<P><LI>Close the file. Compile it using the Help compiler (HC31.EXE). Then view
   the compiled .HLP file using WINHELP.EXE. See the previous example for
   an explanation of how to do this.

<P><LI>Click the Call Macro hot spot. The About() macro displays a dialog box
   titled About Help.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbtool kbprg<BR>
KBSubCategory: TlsHC<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
