

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Visual Basic 4.0 Does Not Support Color Cursor Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138529">
<META NAME="KBModify" CONTENT="1995/11/17">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="kbenv kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If cursor files are displayed in a picture box or as a mouse icon, then the picture shows in black and white only. Colors are not displayed.  RESOLUTION  Use icon files instead of cursor files. Many existing icons can be found in the Vb\Icons direc...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAO2,QAG9,QAIM,QBWS,QAPG,QBJZ,QDL9,QBWQ,QBWO,QBWN,QAYS,QBWP,QAIJ,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual Basic 4.0 Does Not Support Color Cursor Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138529</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If cursor files are displayed in a picture box or as a mouse icon, then the
picture shows in black and white only. Colors are not displayed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use icon files instead of cursor files. Many existing icons can be found in
the Vb\Icons directory. In addition, new color icons can be created by
using the IconWorks application found in the Vb\Hc directory.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. Support for color cursor files was not built
into Visual Basic 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Regardless of the method used to display a cursor file (using the
LoadPicture command or the LoadResPicture command and a resource file),
cursor files will always be displayed in black and white.
<P>
<P><h3>Step-by-Step Example - Loading a Cursor Using LoadPicture Command</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Place a picture box and command button on Form1.

<P><LI>In the Click event for the command button, place the following line of
   code (assuming you have the standard cursors installed in the standard
   directories):
<P>
<PRE>   ' On Windows NT use:
   Picture1.Picture = LoadPicture("c:\windows\system32\3dgarro.cur")

   ' On Windows 95 use:
   Picture1.Picture = LoadPicture("c:\windows\system\arrow_5.cur")

</PRE><P><LI>Run the example by pressing the F5 key. The arrow pointer is displayed
   as a black color in the picture box. When this cursor file is viewed in
   a Resource Editor the arrow has a golden color.
<P>
</OL>The next example uses App Studio which ships with Visual C++ Version 1.5 to
create a resource file. It then adds the file to a project created in
16-bit Visual Basic 4.0. The results are the same.
<P>
<P><h3>Step-by-Step Example - Loading a Cursor File by Using a Resource File</h3>
 

<OL><P><LI>Start App Studio Version 1.5. On the File menu, click New.

<P><LI>In the New dialog box, select Resource File from the list of types, and
   click OK.

<P><LI>On the Resource menu in App Studio, click Import. In the Import Resource
   dialog box, select Cursors (*.Cur) from the Types of Files list.

<P><LI>Select any color cursor file from list of files. On a computer running
   Windows NT there are some cursor files in the Windows\System32
   directory. On Windows 95, you'll find them in the Windows\Cursors
   directory.

<P><LI>By default, the ID of the resource will be 101. The ID is displayed in
   the Resource File dialog box.

<P><LI>On the File menu, click Save As, and save the file as Vbres.res. Exit
   App Studio.

<P><LI>Start a new project in the 16-bit edition of Visual Basic. Form1 is
   created by default.

<P><LI>Add the resource file to the project. On the File menu, click Add File.
   In the Add File dialog box, select Resource Files (*.res) from the
   Types of Files combo box. Then select Vbres.res from the list of files.

<P><LI>Add a picture box (Picture1) and a command button (Command1) to Form1.
   Add the following code to the Click event for Command1:
<P>
<PRE>   Private Sub Command1_Click ()
      Const vbResCursor = 2
      Picture1.Picture = LoadResPicture(101, vbResCursor)
   End Sub

</PRE><P><LI>Run the example by pressing the F5 key. The picture box displays a
<P><PRE>    black and white picture.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 picture box icon vb4win vb4all<BR>
KBCategory: kbenv kbprb<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
