

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error Connecting to MS Query with UserConnection Designer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179381">
<META NAME="KBModify" CONTENT="1998/01/16">
<META NAME="KBCreate" CONTENT="1998/01/15">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When using the UserConnection Designer, you receive the following message when attempting to build a query:      There was a problem attempting to communicate with MS Query   CAUSE =====  The UserConnection Designer cannot find where MS Query is lo...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QBJ2,QBWS,QBS0,QA2Q,QAG2,QAAP,QA1S,QAR4,QAKD,QAD7,QAB5,QAB4,QBT6,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Connecting to MS Query with UserConnection Designer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179381</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the UserConnection Designer, you receive the following message
when attempting to build a query:
<P>
<PRE>   "There was a problem attempting to communicate with MS Query"

</PRE><h2>CAUSE</h2>
 
<P>
The UserConnection Designer cannot find where MS Query is located on the
system.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure the proper registry key is pointing to where MS Query is located
on the system. To do so, you must use RegEdit.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
The correct registry key is found at the following location:
<P>
<PRE>   HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\VBQuery

</PRE>The Path value should be set correctly to where MS Query is located. The MS
Query executable is named Msqry32.exe.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Launch Regedit.exe (click Run on the Start menu, choose REGEDIT, and
   click OK).

<P><LI>Go to the HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\VBQuery
   key.

<P><LI>This key has two data values. Edit the “Path" value to make it invalid
   (for example, change the name of Msqry32.exe to Msqry3.exe).

<P><LI>Launch Visual Basic 5.0 and select a standard EXE.

<P><LI>Click Add ActiveX Designer on the Project menu, and select "Microsoft
   UserConnection."

<P><LI>When the UserConnection property page appears, select "User DNS-Less
   Connection String."

<P><LI>Under “ODBC Driver," select "Microsoft Access Driver (*.mdb)" and click
   OK.

<P><LI>Under the UserConnections form, right-click UserConnection1 and
   select "Insert Query."

<P><LI>When the ODBC Microsoft Access 97 Setup dialog box appears, click OK.

<P><LI>When the Select Database dialog box appears, choose the "NWIND.MDB"
<P><PRE>    database, and click OK.
</PRE>
<P><LI>When the Query1 dialog box appears, click the "Based On User-Defined
<P><PRE>    SQL" option.
</PRE>
<P><LI>Type in the SQL statement "Select * from customers" (without the
<P><PRE>    quotation marks) in the text box, then click the "Build" button.
</PRE><P>
<P><PRE>    Visual Basic 5.0 will hang for a few seconds, then you will receive the
    following message:
</PRE><P>
<P><PRE>       "There was a problem attempting to communicate with MS Query"
</PRE>
<P><LI>Edit the HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\VBQuery key
<P><PRE>    back to its original value.
</PRE>
<P><LI>Repeat steps 4-12, and MS Query will launch properly.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: user connection msquery<BR>
Keywords          : vb5all<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 16, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
