

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Use Visual FoxPro Tables in Visual Basic 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161307">
<META NAME="KBModify" CONTENT="1997/07/28">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="vb432 VB4WIN kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The structure of FoxPro tables has changed with the release of Visual FoxPro 3.0. Visual FoxPro 3.0 now has a database container file with the extension .DBC that contains references to tables, but does not contain the tables themselves. Like previ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA55,QA56,QAZV,QARR,QA5F,QAMA,QDI1,QAZZ,QAW6,QBXS,QBVV,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use Visual FoxPro Tables in Visual Basic 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161307</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The structure of FoxPro tables has changed with the release of Visual
FoxPro 3.0. Visual FoxPro 3.0 now has a database container file with the
extension .DBC that contains references to tables, but does not contain
the tables themselves. Like previous versions of FoxPro, the tables still
reside in their own .DBF files.
<P>
The structure of a Visual FoxPro table depends upon whether that table is
included in a database container. A table not included in a database
container is called a "free table" and its structure differs from a
"database table." Visual Basic must know which type of table it is trying
to access in order to know how to read the structure of the table.
<P>
With Visual FoxPro "free tables," Visual Basic recognizes these files much
like it recognizes older FoxPro tables. Visual Basic's database object
corresponds to the directory in which the "free tables" reside. However,
with "database tables," the Visual Basic database object corresponds to the
Visual FoxPro .DBC file, which contains reference to the "database tables."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Free Tables</h3>
 
<P>
Here is some sample code to open the Foxuser.DBF table:
<P>
<PRE>   Private Sub Form_Load()
       Dim FoxFreeDB As Database
       Dim FoxFreeRS As Recordset

       Set FoxFreeDB = Workspaces(0).OpenDatabase("C:\VFP", False, _
                       False, "FoxPro 3.0;")
       Set FoxFreeRS = FoxFreeDB.OpenRecordset("Foxuser")

       Set Data1.Recordset = FoxFreeRS
   End Sub

</PRE><h3>Database Tables</h3>
 
<P>
Here is some sample code to open the Employee.DBF table that resides in
the Tastrade.DBC database container:
<P>
<PRE>   Private Sub Form_Load()
       Dim FoxDataDB As Database
       Dim FoxDataRS As Recordset

       Set FoxDataDB = Workspaces(0).OpenDatabase( _
                       "C:\VFP\Samples\Mainsamp\Data\Tastrade.DBC", _
                       False, False, "FoxPro DBC;")
       Set FoxDataRS = FoxDataDB.OpenRecordset("Employee")

       Set Data1.Recordset = FoxDataRS
   End Sub

</PRE>When Visual Basic accesses a Visual FoxPro "database table," it uses the
.DBC file to list and locate .DBF files. Visual Basic does not use the .DBC
file to determine the structure of the .DBF files; that information is
obtained by examining the .DBF file itself. This means that long field
names, which Visual FoxPro stores in the .DBC file, will not be accessible
in Visual Basic. For example, the above sample that reads the Employee
table will have an Employee ID field "Employee_I" instead of "Employee_ID"
because the .DBF file does not store the long field name.
<P>
Another ramification of reading the linked tables directly is that Jet
marks these tables as read-only because all the Referential Integrity rules
for a table are stored in the database container file. Visual FoxPro free
tables are also read only.
<P>
NOTE: The 16-bit edition of Visual Basic version 4.0 cannot read files in
the Visual FoxPro version 3.0 format without a third-party ODBC driver.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information explaining why the Visual Basic Data Control does not
list all possible Visual FoxPro connect properties, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q140770.htm">Q140770</A></B>
   TITLE     : PRB: Accessing Visual FoxPro 3.0 Files from Visual Basic 4.0
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: fox foxpro dbc open dbf xbase<BR>
Keywords          : vb432 VB4WIN kbhowto<BR>
Version           : 4.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 28, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
