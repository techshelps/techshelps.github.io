

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Object Variable Not Set When Referencing Data Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110618">
<META NAME="KBModify" CONTENT="1995/11/17">
<META NAME="KBCreate" CONTENT="1994/01/25">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If a Data control references the Recordset property in the Form_Load event or anytime BEFORE the Form_Activate event, you will receive the following error message (Error#91):     Object Variable Not Set  You can also receive the  Object variable no...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAYL,QBS0,QBXS,QBVV,QAW6,QA7O,QAB4,QAOE,QAMN,QAB5,QAO4,QAEF,QAAP,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Object Variable Not Set When Referencing Data Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110618</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a Data control references the Recordset property in the Form_Load event
or anytime BEFORE the Form_Activate event, you will receive the following
error message (Error#91):
<P>
<PRE>   Object Variable Not Set

</PRE>You can also receive the "Object variable not set" error with the Data
control, without necessarily being in a Form-Load event, if you assign the
Recordsource property to a table name without quotation marks and then do
an addnew. For example:
<P>
<PRE>   data1.recordsource = tablename 'where tablename is neither a string
   'variable containing a valid table name, nor a quoted string.
   data1.refresh
   data1.recordset.addnew 'Gives "Object variable not set."

</PRE><h2>CAUSE</h2>
 
<P>
The RecordSet property of a Data Control is not resolved until after the
form has been loaded -- that is, after the Form_Load event. This means that
you cannot issue any method such as MoveNext or FindNext of the Data
Control that uses its record set (its internal Dynaset).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent the error, force the creation of the internal dynaset in the
data control by issuing the Refresh method:
<P>
<PRE>   Data1.Refresh

</PRE>This will validate the RecordSet property allowing you to use methods that
require this.
<P>
<P><h2>STATUS</h2>
 
<P>
This behaviour is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This problem also occurs in Visual Basic for Applications when you
define an object and don't use it. In the General Declarations section of
your the code, where the variable is dimmed as an Object, as in the
following:
<P>
<PRE>   Dim X as Object

</PRE>comment out or delete this.
<P>
Also, if "X" is set to something, for example
<P>
<PRE>   Set X = "John Doe"

</PRE>and is not used later in the procedure, then comment out or delete this
line as well.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a data control (Data1) to Form1.

<P><LI>In the Form_Load event of Form1, place the following code:
<P>
<P><PRE>     ' Data1.Refresh
     Data1.Recordset.MoveLast
</PRE>
<P><LI>Run the application. You should get Error 91 "Object Variable Not Set."

<P><LI>Remove the apostrophe from the Data1.Refresh line.

<P><LI>Run the application again (press the F5 key). Now, you won't get the
   error.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbprb<BR>
KBSubCategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
