

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Find and View the Amount of Free Disk Space on a Drive </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153091">
<META NAME="KBModify" CONTENT="1996/07/01">
<META NAME="KBCreate" CONTENT="1996/06/28">
<META NAME="Keywords" CONTENT="kbprg kbusage kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  From Visual Basic, it is possible to use the Win32 API function GetDiskFreeSpace to find and view the amount of free disk space on a specified drive. The code sample below shows this in practice.  MORE INFORMATION  Sample Code  1. Start a new proje...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW5,QANF,QAH4,QBS0,QBJZ,QAIJ,QACJ,QAY2,QAKC,QA01,QBWS,QDIV,QBXS,QBC6,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Find and View the Amount of Free Disk Space on a Drive</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 1, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153091</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
From Visual Basic, it is possible to use the Win32 API function
GetDiskFreeSpace to find and view the amount of free disk space on a
specified drive. The code sample below shows this in practice.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 

<OL><P><LI>Start a new project, Form1 is created by default.

<P><LI>From the File menu, choose Remove File.

<P><LI>From the Insert menu, choose Module.

<P><LI>Add the following code to the Module1 code window:
<P>
<PRE>   Declare Function GetDiskFreeSpace Lib "kernel32" Alias _
   "GetDiskFreeSpaceA"  (ByVal lpRootPathName As String, _
   lpSectorsPerCluster As Long, lpBytesPerSector As Long _
   _lpNumberOfFreeClusters As Long, lpTotalNumberOfClusters As Long) _
   As Long

   Public Type DiskInformation
       lpSectorsPerCluster As Long
       lpBytesPerSector As Long
       lpNumberOfFreeClusters As Long
       lpTotalNumberOfClusters As Long
   End Type

   Sub main()
       Dim info As DiskInformation
       Dim lAnswer As Long
       Dim lpRootPathName As String
       Dim lpSectorsPerCluster As Long
       Dim lpBytesPerSector As Long
       Dim lpNumberOfFreeClusters As Long
       Dim lpTotalNumberOfClusters As Long
       Dim lBytesPerCluster As Long
       Dim lNumFreeBytes As Double
       Dim sString As String

       lpRootPathName = "c:\"
       lAnswer = GetDiskFreeSpace(lpRootPathName, lpSectorsPerCluster, _
       lpBytesPerSector, lpNumberOfFreeClusters, lpTotalNumberOfClusters)
       lBytesPerCluster = lpSectorsPerCluster * lpBytesPerSector
       lNumFreeBytes = lBytesPerCluster * lpNumberOfFreeClusters
       sString = "Number of Free Bytes : " &amp; lNumFreeBytes &amp; vbCr &amp; vbLf
       sString = sString &amp; "Number of Free Kilobytes: " &amp; (lNumFreeBytes _
          / 1024) &amp; "K" &amp; vbCr &amp; vbLf
       sString = sString &amp; "Number of Free Megabytes: " &amp; _
          Format(((lNumFreeBytes / 1024) / 1024), "0.00") &amp; "MB"

       MsgBox sString
   End Sub

</PRE><P><LI>Press the F5 key or choose Start from the Run menu to start the program.
   You will see a message box displaying the free disk space on drive C:.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbprg kbusage kbhowto<BR>
KBSubcategory: APrgOther
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 1, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
