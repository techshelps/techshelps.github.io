

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Install 16-bit Visual Basic 4.0 Without Running Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152559">
<META NAME="KBModify" CONTENT="1996/12/03">
<META NAME="KBCreate" CONTENT="1996/06/18">
<META NAME="Keywords" CONTENT="kbsetup kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Under some circumstances, the 16-bit Edition of Visual Basic 4.0 will not install on a Windows system. This behavior is most typically demonstrated by a failure to extract information from a CAB file, but other persistent errors may also occur.  Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAA1,QA3P,QDI2,QAY2,QDIZ,QBXB,QATJ,QDIY,QATF,QA5F,QAMA,QAFI,QDLP,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Install 16-bit Visual Basic 4.0 Without Running Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152559</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional and Enterprise Editions of Microsoft Visual Basic,
<PRE>  16-bit only, for Windows, Version 4.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under some circumstances, the 16-bit Edition of Visual Basic 4.0 will not
install on a Windows system. This behavior is most typically demonstrated
by a failure to extract information from a CAB file, but other persistent
errors may also occur.
<P>
This article describes how to work around this behavior.
<P>
WARNING: The method described here should only be used as a last resort.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This method assumes that the customer has access to a working copy of
Visual Basic on another system because many of the files required by the
16-bit Edition of Visual Basic 4.0 are incompatible with Windows 95 system
files of the same name. Rather than provide information that could possibly
trash a system, we feel it is better to provide a less robust solution. A
set of install disks for VisData and the three extracted files can always
be sent if customer has no access to a working system.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Copy the contents of the \VB directory from the CD-ROM to the \VB
   directory on your local hard drive. You should delete the \VB\System,
   \VB\ODBC, and \VB\MSApps directories from your local hard drive. If you
   will not be using the 32-bit version of Visual Basic 4.0, you may safely
   delete all files in the \VB directory that contain the string 32.

<P><LI>Copy vaen2.dll, vba2.dll, and all the *16.OCX files from the \vb\system
   directory on the CD-ROM to the \windows\system directory.

<P><LI>Expand the control licensing .REG file by running the appropriate line
   from the \SETUP directory of the CD-ROM in a Command prompt:
<P>
   Professional Edition:
<P>
<P><PRE>      EXTRACT /L C:\VB /E VB4-6.CAB VBPRO.REG
</PRE><P>
   Enterprise Edition:
<P>
<P><PRE>      EXTRACT /L C:\VB /E VB4-6.CAB VBENT.REG
</PRE><P>
   These commands will sometimes fail due to the inability to create a
   temporary file on the CD-ROM. Assuming that the CD-ROM is drive F:, the
   following will work even if the user does not have a TEMP environment
   variable set. From the root of the C: drive (or any other drive to which
   the user has write access):
<P>
   Professional Edition:
<P>
<P><PRE>      F:\SETUP\EXTRACT /L C:\VB /E F:\SETUP\VB4-6.CAB VBPRO.REG
</PRE><P>
   Enterprise Edition:
<P>
<P><PRE>      F:\SETUP\EXTRACT /L C:\VB /E F:\SETUP\VB4-6.CAB VBENT.REG
</PRE><P>
   If you cannot locate this file, type the following line from the \SETUP
   directory of the CD-ROM in a MS-DOS Command prompt:
<P>
   Professional Edition:
<P>
<P><PRE>      EXTRACT /A /D VB4-1.CAB VBPRO.REG | MORE
</PRE><P>
   Enterprise Edition:
<P>
<P><PRE>      EXTRACT /A /D VB4-1.CAB VBENT.REG | MORE
</PRE>
<P><LI>From the \vb directory of a system with a working copy of Visual Basic
   4.0, copy vbide.dll and vbext.olb to the \vb directory on the target
   system. They can also be extracted from the product CD-ROM as follows:
<P>
   EXTRACT /L C:\VB  /E VB4-8.CAB VBIDE.DLL
<P>
   EXTRACT /L C:\VB  /E VB4-9.CAB VBEXT.OLB

<P><LI>From a system with a working copy of Visual Basic 4.0, use the
   Application Setup Wizard to create disks for the
   \vb\samples\VisData\VisData.vbp 16-bit Edition of the Visual Basic 4.0
   sample app.

<P><LI>Take the disks that you have just created to the target machine and
   run SETUP.EXE from the first disk to install the VisData sample.

<P><LI>Run vb4pro.reg by double-clicking it from File Manager. Alternately,
   enter the following Command at the MS-DOS Command line:
<P>
<P><PRE>      Regedit c:\vb\vbpro.reg
</PRE>
<P><LI>You should now be able to execute VB.EXE normally. If Visual Basic
   protests that SHARE.EXE is not installed, exit windows and restart it to
   activate VSHARE.386, which was installed with the VisData sample. This
   should not occur on Windows for Work Groups systems.
<P>
</OL>Other dependency files will probably be required as well, but the above
procedure should get the Visual Basic 4.0 16-bit Edition IDE going. These
dependencies can be found in \vb4\setupkit\kitfiles\sw16tmpl.ini. The
Register keyword will specify $(DLLSelfRegister) or $(EXESelfRegister) if
the dependency requires registration. Use the \tools\pss\regsvr.exe utility
from the CD-ROM, which is not normally installed by the Visual Basic 4.0
setup, to register the file manually. For example:
<P>
<PRE>    RegSvr OC25.DLL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb416<BR>
KBCategory: kbsetup kbhowto<BR>
KBSubcategory: Setins
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
