

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Pressing TAB Key on Form Does Not Change Focus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179707">
<META NAME="KBModify" CONTENT="1998/01/23">
<META NAME="KBCreate" CONTENT="1998/01/22">
<META NAME="Keywords" CONTENT="vb5all VBKBAX_VBKBComp">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  An ActiveX control is created using Visual Basic and compiled into an OCX file. The compiled OCX is then referenced in a Visual Basic standard EXE project. When the standard EXE project is run in the IDE, tabbing between the controls on the form an...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHV,QA7O,QAOE,QAMN,QAB5,QBS0,QADO,QAJN,QBWS,QAIJ,QABB,QBV4,QBT6,QAH4,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Pressing TAB Key on Form Does Not Change Focus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179707</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An ActiveX control is created using Visual Basic and compiled into an OCX
file. The compiled OCX is then referenced in a Visual Basic standard EXE
project. When the standard EXE project is run in the IDE, tabbing between
the controls on the form and the ActiveX control results in a beep and the
focus does not change. This problem occurs after the ActiveX control has
shown a modal form.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This problem only occurs when a project in the IDE references the compiled
OCX; the problem does not occur when the project is made into an EXE.
<P>
To work around this problem, create a project group and reference the
ActiveX control from the ActiveX control project. Reference the compiled
version of the ActiveX control just before you compile your Visual Basic
project.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This section show you how to create a sample project that demonstrates this
behavior.
<P>
<P><h3>Steps to Create the ActiveX control</h3>
 

<OL><P><LI>Start a new ActiveX Control project in Visual Basic. UserControl1 is
   created by default.

<P><LI>Add a textbox to UserControl1.

<P><LI>Copy the following code to the Code window of UserControl1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Sub Text1_DblClick()
<PRE></PRE>         Form1.Show vbModal
      End Sub

</PRE><P><LI>Add a form to the ActiveX control project.

<P><LI>Add a CommandButton to Form1. Copy the following code to the Code
   window of Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Unload Me
      End Sub

</PRE><P><LI>Change the Project name to "TestControl" and select the File/Make
   TestControl.ocx menu option to create TestControl.ocx. After
   creating the control, save and close the project.
<P>
</OL>You are done creating the ActiveX control. The next section shows you how
to create the Standard EXE project that uses the ActiveX control you just
created.
<P>
<P><h3>Steps to Create Standard EXE Project</h3>
 

<OL><P><LI>Start a new Standard EXE project in Visual Basic. Form1 is created by
   default.

<P><LI>Add an MDI Form to the project.

<P><LI>Set the MDIChild property of Form1 to True.

<P><LI>Reference the ActiveX control you compiled in the previous section by
   completing the following steps:
<P>
   a. From the Project menu, click Components. The Components dialog box
<P><PRE>      displays.
</PRE><P>
   b. Select the Controls Tab. Check TestControl in the list box.
<P>
   c. Click OK to close the Components dialog box.

<P><LI>Add two instances of the TestControl ActiveX control to Form1.
   Position the two ActiveX controls so both controls are visible on the
   form.

<P><LI>On the Run menu, click Start, or press the F5 key to start the program.
<P>
   a. Press the Tab key to change the focus between the two controls.
<P>
   b. Double-click the text box on one of the TestControl ActiveX controls.
<P><PRE>      Form1 appears. Click the CommandButton to close the form.
</PRE><P>
   c. Set the focus to one of the TestControl ActiveX controls.
<P>
   RESULTS: Pressing the Tab key results in a beep and the focus does not
   change.
<P>
</OL>The next section shows how to work around this bug using the projects you
created in the previous sections.
<P>
<P><h3>Workaround</h3>
 

<OL><P><LI>Open the ActiveX control project you used to create the ActiveX control.

<P><LI>From the File menu, click Add Project to add a standard EXE project.
   Form1 is created by default. Set the MDIChild property of Form1 to true.

<P><LI>Close the ActiveX control project. Note than an ActiveX control is added
   to the toolbar.

<P><LI>Add two instances of the ActiveX control to Form1. Position the two
   ActiveX controls so both controls are visible on the form.

<P><LI>On the Run menu, click Start or press the F5 key to start the program.
<P>
   a. Press the Tab key to change the focus between the two controls.
<P>
   b. Double-click the text box on one of the TestControl ActiveX controls.
<P><PRE>      A form is displayed. Click the CommandButton to close the form.
</PRE><P>
   c. Set the focus to one of the TestControl ActiveX controls.
<P>
   You can now tab between the text boxes of both ActiveX controls.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: user control<BR>
Keywords          : vb5all VBKBAX_VBKBComp<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
