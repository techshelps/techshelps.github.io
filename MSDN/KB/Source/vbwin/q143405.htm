

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Arrow Key Doesn't Fire Keypress Tree/Listview Controls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143405">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1996/02/01">
<META NAME="Keywords" CONTENT="PrgOther vb432 VB4WIN kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Pressing an arrow key does not fire the keypress event for the Treeview and Listview controls because they have built-in functionality for these keys. It is not obvious which event is available to determine that the selected node has changed becaus...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMN,QAB5,QA7O,QAOE,QAPN,QAO4,QBS0,QBJZ,QDL9,QBXS,QBWO,QBWN,QAVX,QAO2,QADO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Arrow Key Doesn't Fire Keypress Tree/Listview Controls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143405</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Standard, Professional and Enterprise Editions of Microsoft
<PRE>  Visual Basic, 32-bit only, for Windows, version 4.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Pressing an arrow key does not fire the keypress event for the Treeview and
Listview controls because they have built-in functionality for these keys.
It is not obvious which event is available to determine that the selected
node has changed because of this behavior.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ItemClick event for the Listview control and the NodeClick for the
Treeview control get fired whenever an item's selection changes, even if it
changes as a result of a keystroke.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Visual Basic and click New Project (ALT, F, N) on the File menu.

<P><LI>Click Custom controls on the Tools menu.

<P><LI>Inside of the Custom controls dialog box, check the "Microsoft Windows
   Common Controls."  Then click the OK button.

<P><LI>Place a TreeView control on the form.

<P><LI>Insert the following code in the Form_Load event:
<P>
<P><PRE>      Private Sub Form_Load()
</PRE>   
<P><PRE>      Dim nodX As Node
      Set nodX = TreeView1.Nodes.Add(, , "Root", "Root")
      Set nodX = TreeView1.Nodes.Add("Root", 4, "Node1", "Node1")
      Set nodX = TreeView1.Nodes.Add("Node1", 4, "Node2", "Node2")
      Set nodX = TreeView1.Nodes.Add("Node2", 4, "Node3", "Node3")
</PRE>   
<P><PRE>      End Sub
</PRE>
<P><LI>Add the following line to the TreeView1_Keydown event:
<P>
<P><PRE>     Debug.Print  "TreeView Keydown "; KeyCode
</PRE>
<P><LI>Add the following line to the Form_Keydown event:
<P>
<P><PRE>     Debug.Print  "Form Keydown "; KeyCode
</PRE>
<P><LI>Set the Form's KeyPreview property to True.

<P><LI>Run the program. The TreeView control should have the focus. Use the
   arrow keys to move around the tree. Note that the keydown events are not
   triggered and no text appears in the debug window.

<P><LI>Press the letter "N." Note that the node having the focus changes and
<P><PRE>    you can monitor the keys in the debug window. This works correctly.
</OL></PRE> 
<PRE>Keywords          : PrgOther vb432 VB4WIN kbcode
Version           : 4.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
