

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Ambiguous Names Generate Incorrect Error Message </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171524">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/07/16">
<META NAME="Keywords" CONTENT="vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If Binary Compatibility is set, then writing a duplicate Implements statement in a Class Module can cause a compatibility error to occur when compiling a DLL, instead of the expected  Ambiguous name detected  error message.  STATUS ======  Microsof...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB4,QAPN,QAH4,QAR4,QAB5,QDO3,QA2Q,QAM1,QA56,QA55,QAAP,QAG2,QAJN,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Ambiguous Names Generate Incorrect Error Message</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171524</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If Binary Compatibility is set, then writing a duplicate Implements
statement in a Class Module can cause a compatibility error to occur when
compiling a DLL, instead of the expected "Ambiguous name detected" error
message.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VSTUDIO/Q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where,and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
NOTE: MSO97.DLL is required to duplicate this scenario.

<OL><P><LI>Start a new ActiveX DLL project in Visual Basic 5.0. Class1 is created
   by default.

<P><LI>Select Project...References from the menu bar and add a reference to the
   Microsoft Office 8.0 Object Library.

<P><LI>Select Project...Add Module to add a new Module (Module1).

<P><LI>Add the following code to Module1:
<P>
<PRE>      Sub Main()

      End Sub

</PRE><P><LI>Add the following code to Class1:
<P>
<P><PRE>      Implements IFoundFiles
</PRE><P>
<P><PRE>      Private Property Get IFoundFiles_Count() As Long
</PRE><P>
<P><PRE>      End Property
</PRE><P>
<P><PRE>      Private Property Get IFoundFiles_Item(ByVal Index As Long) As String
</PRE><P>
<P>
<P><PRE>      End Property
</PRE>
<P><LI>Select Project...Properties and change the Startup Object to Sub Main.

<P><LI>Select File...Make Project1.dll and compile the project as Project1.DLL.

<P><LI>After compilation, select Project...Project1 Properties, and select
   Binary Compatibility on the Components tab.

<P><LI>Change the code in Class1 to the following:
<P>
<P><PRE>      Implements IFoundFiles
      Implements IFoundFiles
</PRE><P>
<P><PRE>      Private Property Get IFoundFiles_Count() As Long
</PRE><P>
<P><PRE>      End Property
</PRE><P>
<P><PRE>      Private Property Get IFoundFiles_Item(ByVal Index As Long) As String
</PRE><P>
<P><PRE>      End Property
</PRE>
<P><LI>Select File...Make Project1.dll, and compile the project as
<P><PRE>    Project2.DLL.
</PRE><P>
</OL><h3>Result</h3>
 
<P>
The following Visual Basic dialog box appears:
<P>
<PRE>    "The Class1 class implemented an interface in the version-compatible
    component, but not in the current project.

   If you choose Accept, the Class1 class module will no longer support
   client applications compiled against the version-compatible component.
   To avoid this incompatibility, add the interface declaration back into
   the class module, or clear the version compatibility setting in Project
   Options."

</PRE></OL>The correct error message that should display is:
<P>
<PRE>   "Compile error: Ambiguous name detected: IFoundFiles"

</PRE>Note that this message does display after the initial dialog is dismissed.
<P>
NOTE: This behavior has also been reported when duplicate Enum names are
used.
 
<PRE>Keywords          : vb5all VS97FixlistSP3 VS97FixlistSP2 VB5FixlistSP2
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
