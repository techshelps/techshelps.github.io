

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Non-Menu Keys Disabled When Menu Pulled Down </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99811 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/06/08">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When a Visual Basic menu is pulled down, all non-menu keystrokes are disabled and keystrokes cannot be detected. This behavior is by design. When a menu is down, all keystrokes just beep or do nothing, except for the keystrokes that control the men...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVI,QAF0,QBS0,QAQT,QBW7,QA4B,QAMN,QAI5,QBWR,QBXS,QAUD,QA1S,QBLX,QA4P,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Non-Menu Keys Disabled When Menu Pulled Down</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99811 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a Visual Basic menu is pulled down, all non-menu keystrokes are
disabled and keystrokes cannot be detected. This behavior is by design.
When a menu is down, all keystrokes just beep or do nothing, except
for the keystrokes that control the menu.
<P>
You cannot determine which menu item the user chose, until after the
user clicks the menu item or presses ENTER. The Click event for the
menu item will then give you the chosen menu item.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Access Keys Give a User Keyboard Access to Menu Items</h3>
 
To give a user keyboard access to a menu item, insert an
ampersand (&amp;) immediately in front of a letter in the Caption
by using the Menu Design Window. At run time, this letter
(called the access key) is underlined. The user can change
the focus to a menu or command by pressing ALT plus the letter
(access key).
<P>
You can use an access key such as ALT+F to give focus quickly
to a menu, command, or control by using the keyboard as an
alternative to the mouse.
<P>
Unlike shortcut keys (such as F10 or CTRL+T, which are also
assigned in the Menu Design Window), access keys do not execute
commands when pressed, until the ENTER key is pressed. If you
open a menu with an access key, then all non-menu keystrokes
are disabled until you press a menu-control key such as ENTER,
ESC, or ALT.
<P>
<P><h3>Step-by-Step Example</h3>
 
To trap all keystrokes in the form instead of the form's controls, you can
set the form's KeyPreview property to True. However, because menu controls
disable non-menu key presses when the menu is down, you won't be able to
preview or trap keys that are pressed when the menu is down, as this
example demonstrates:

<OL><P><LI>Set the KeyPreview property to True for Form1.

<P><LI>Using the Menu Design window, add a Main menu with two submenus:
<P>
   Mainmenu
<P><PRE>      Submenu1
      Submenu2
</PRE>
<P><LI>In the KeyPress event for the form, print trapped key values as follows:
<P>
<PRE>   Sub Form_KeyPress (KeyAscii As Integer)
      Print Str$(KeyAscii)
   End Sub

</PRE><P><LI>Run the program. Press any alphanumeric key, and its ASCII value
   will be trapped by Form_KeyPress and be printed.

<P><LI>Click the Mainmenu menu to drop it down. While the menu is down,
   non-menu key strokes cause the computer to either beep or do nothing.
   For example, pressing the x key causes the computer to beep; pressing
   the F1 key causes the computer to do nothing; but pressing the s key
   toggles the menu selection between Submenu1 and Submenu2 because both
   begin with the letter s.

<P><LI>Press ESC, ALT, ENTER, or click the menu to make the menu go away and
   reenable trapping of keystrokes.
<P>
</OL>While the menu is down, the Form_KeyPress event detects no keys.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
