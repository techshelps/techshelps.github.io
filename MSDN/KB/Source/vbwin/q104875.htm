

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Encrypt a Microsoft Access Database in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104875">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/09/30">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Database encryption has nothing to do with security. However, you can use database encryption to prevent someone from using a file or disk editor to read and write data in a Microsoft Access .MDB file. This article shows by example how to encrypt a...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QABG,QDKY,QBJZ,QBWS,QDN9,QAZV,QAUJ,QA28,QATJ,QAMA,QBGY,QAY2,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Encrypt a Microsoft Access Database in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104875</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Database encryption has nothing to do with security. However, you can use
database encryption to prevent someone from using a file or disk editor to
read and write data in a Microsoft Access .MDB file. This article shows by
example how to encrypt a Microsoft Access database file in Microsoft Visual
Basic version 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access reads and writes all data a page at a time. Each page is
always 2K in size. Encryption is done at the page level, not at the data
level. This means the encryption process has no knowledge of what is on the
page, only that there is 2K of data that needs to be encrypted and written.
or read and decrypted.
<P>
Everything in a Microsoft Access .MDB database file is encrypted, including
tables, queries, forms, indexes, and so on. Microsoft Access uses the RSA
company algorithm for database encryption.
<P>
The overhead involved in encrypting and decrypting causes is a performance
degradation of approximately 10-15% in encrypted databases. Encrypted files
cannot be compressed using tools such as PKZip, Stacker, MS-DOS version 6
DoubleSpace, and so on.
<P>
<P><h3>Encryption in Visual Basic</h3>
 
<P>
Use the CompactDatabase statement in Microsoft Visual Basic version 3.0 for
Windows to encrypt a Microsoft Access database file. For more information
on the CompactDatabase statement, review pages 90-92 in the Visual Basic
version 3.0 "Language Reference" manual.
<P>
<P><h3>Step-by-Step Encryption Example</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>From the Windows menu, choose Data Manager.

<P><LI>In Data Manager, choose New Database from the File menu. Then select
   either Microsoft Access 1.0 or Microsoft Access 1.1.

<P><LI>Enter the name TESTING.MDB for the Microsoft Access file name that you
   are about to create.

<P><LI>Click the New button and enter Table1 for the table name.

<P><LI>Click the Add button and enter First Name as the Field Name. Then
   select Text for the Field Type and enter 15 as the Field Size.

<P><LI>Click the Add button for Indexes, and enter First Name Index as the
   Index Name. Then select Unique, Primary and click Done.

<P><LI>Click the Open button, then the Add button. Next enter a name (Bob, for
   example) into the First Name field. Then click the Add button.

<P><LI>Close the Data Manager and add a Command button to Form1.

<P><LI>Add the following code to the Command1 Click event procedure:
<P>
<P><PRE>    Sub Command1_Click ()
       Const DB_ENCRYPT = 2
       Const DB_LANG_GENERAL = ";LANGID=0x0809;CP=1252;COUNTRY=0"
</PRE><P>
<P><PRE>       '** Enter the following two lines as one, single line:
       CompactDatabase "C:\VB\TESTING.MDB", "C:\VB\NEWTEST.MDB",
<PRE></PRE>          DB_LANG_GENERAL, DB_ENCRYPT
    End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) to run the program. Click
<P><PRE>    the Command1 button to encrypt the TESTING.MDB database file. To check
    the new NEWTEST.MDB file, choose Data Manager from the Window menu in
    Visual Basic version 3.0 for Windows. In the Data Manager, choose Open
    Database from the File menu. Then select the NEWTEST.MDB file.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
