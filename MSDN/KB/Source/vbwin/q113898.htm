

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Use CTL3D.DLL in Your Visual Basic Program </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113898">
<META NAME="KBModify" CONTENT="1997/02/13">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="kbprg kbcode kbfile kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can use CTL3D.DLL to add three-dimensional (3-D) effects to the common dialog boxes and message boxes for a Visual Basic application. However, CTL3D.DLL does not work currently for the controls on a Visual Basic form or for the form itself.  To...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA01,QAH4,QA4Q,QAPN,QAB9,QAY2,QAFF,QAMA,QA7O,QAY5,QAO4,QAOE,QAMN,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use CTL3D.DLL in Your Visual Basic Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113898</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0, 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use CTL3D.DLL to add three-dimensional (3-D) effects to the
common dialog boxes and message boxes for a Visual Basic application.
However, CTL3D.DLL does not work currently for the controls on a
Visual Basic form or for the form itself.
<P>
To get 3-D effects for the controls on a form, use the controls found
in the THREED.VBX custom control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use CTL3D.DLL to enhance the common dialog boxes and message boxes from
Visual Basic, follow these steps:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the form's general declarations section:
<P>
   Option Explicit
   Const GWW_HINSTANCE = (-6)
<P>
<PRE>   ' Enter each declaration as one, single line:
   Declare Function GetWindowWord Lib "User" (ByVal hWnd As Integer, ByVal
      nIndex As Integer) As Integer
   Declare Function Ctl3dAutoSubclass Lib "Ctl3D.DLL" (ByVal hInst As
      Integer) As Integer
   Declare Function Ctl3dRegister Lib "Ctl3D.DLL" (ByVal hInst As Integer)
      As Integer
   Declare Function Ctl3dUnregister Lib "Ctl3D.DLL" (ByVal hInst As
      Integer) As Integer

</PRE><P><LI>Add the following code to the form's load event procedure:
<P>
<PRE>   Sub Form_Load ()
     Dim hInst As Integer, ret As Integer

     hInst = GetWindowWord(Me.hWnd, GWW_HINSTANCE) ' Get Instance Handle
     ret = Ctl3dRegister(hInst)            ' Register program w/ Ctl3d.
     ret = Ctl3dAutoSubclass(hInst)        ' Subclass the program.
   End Sub

</PRE><P><LI>Add the following code to the form's unload event procedure:
<P>
<PRE>   Sub Form_Unload (Cancel As Integer)
     Dim hInst As Integer, ret As Integer

     hInst = GetWindowWord(Me.hWnd, GWW_HINSTANCE) ' Get Instance Handle
     ret = Ctl3dUnregister(hInst)          ' Unregister the program.
   End Sub

</PRE><P><LI>Add a command button (Command1) to the form.

<P><LI>In the Click event for Command1, add a MsgBox statement:
<P>
<PRE>   Sub Command2_Click ()
      MsgBox "This is a 3-D Message Box"
   End Sub

</PRE><P><LI>Press the F5 key to run the program. When you click the command button,
   a message box will appear in 3-D.
<P>
</OL><h3>Important Note</h3>
 
<P>
If your program fails to unregister itself from CTL3D.DLL when your program
ends, you may cause Windows to crash (stop operating). For example, if you
place the Ctl3dUnregister() function in the Unload event and your program
uses the End statement, Windows may crash because the End statement does
not invoke the QueryUnload or Unload event.
<P>
<P><h2>REFERENCES</h2>
 
<P>
The information in this article is taken from the CTL3D.HLP help file.
<P>
<PRE>You can find <A HREF="http://support.microsoft.com/download/support/mslfiles/CTL3D.EXE">CTL3D.EXE</A> <I>(size: 402932 bytes)</I> 
                      , a self-extracting file, on these services:

</PRE></OL>The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A HREF="http://support.microsoft.com/download/support/mslfiles/Ctl3d.exe">Ctl3d.exe</A> <I>(size: 402932 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../zMiscellaneous/Q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from
               Online Services

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN16SDK/Q97361.htm">Q97361</A></B>
   TITLE     : INF: Adding 3D Controls Using CTL3D.DLL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode kbfile<BR>
KBSubcategory: APrgOther<BR>
Additional reference words: 3.00 softlib
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
