

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Can't Load VB 3 Binary Form with Some Extended Characters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149325">
<META NAME="KBModify" CONTENT="1996/04/04">
<META NAME="KBCreate" CONTENT="1996/03/30">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Adding a Visual Basic 3.0 form that contains code with some extended characters to a Visual Basic 4.0 16-bit or 32-bit project causes the following error:     The basic code in            was corrupt, and couldn't be loaded.  The problem has been c...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAMA,QA5F,QAH4,QAUR,QAKP,QAU7,QBJZ,QAIJ,QBVV,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Can't Load VB 3 Binary Form with Some Extended Characters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149325</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Adding a Visual Basic 3.0 form that contains code with some extended
characters to a Visual Basic 4.0 16-bit or 32-bit project causes the
following error:
<P>
<PRE>   The basic code in &lt;filename&gt; was corrupt, and couldn't be loaded.

</PRE>The problem has been confirmed with the ANSI characters 196/228, 197/229,
214/246, 201/233, and 220/252. It may occur with other extended characters
also. The problem only occurs if actual code contains these extended
characters; it doesn't happen if a property is set to a string with one or
more of the problem characters. This problem does not occur if the Visual
Basic 3.0 form is saved as text rather than as binary, and also does not
occur if the file name of the form does not contain any of the problem
characters.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
This problem can be avoided by two different methods:

<UL><LI>Load the form(s) into Visual Basic 3.0 and save them as text before
   loading them into either bitness of Visual Basic 4.0. This is the
   preferred solution and should work in all cases.
<P>
   -or-

<LI>It may be possible to work around the problem by changing the file name
   of each problem form to one that does not contain any of the problem
   characters. This can be done with File Manager or Explorer after saving
   the form in Visual Basic 3.0 but before loading the form into Visual
   Basic 4.0 16- or 32-bit. Once the form has been loaded, it can be saved
   from Visual Basic 4.0 with the original filename.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Start an utility that can output characters of any ANSI value (the
   Character Map utility that ships with Windows NT performs this
   function). Select and copy to the clipboard the ANSI characters numbered
   196 and 197.

<P><LI>Start Visual Basic 3.0. Form1 is created by default.

<P><LI>Add this code to the Form_Click event of Form1:
<P>
<PRE>   Sub Form_Click()
      Form1.Caption = "  "
   End Sub

</PRE><P><LI>Save the form file from Visual Basic 3.0 with a name of   .FRM. Ensure
   that the Save As Text check box is NOT selected so the form will be
   saved as binary.

<P><LI>Shut down Visual Basic 3.0 and start either Visual Basic 4.0 16-bit or
   Visual Basic 4.0 32-bit.

<P><LI>Select Remove File from the File menu to remove the default Form1.

<P><LI>Choose Add File from the File menu and choose to add the file saved in
   step 4. After clicking OK to dismiss the previous version message, the
   error mentioned above will be displayed. If the form is examined at this
   point, no code will be present.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all 3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
