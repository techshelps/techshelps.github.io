

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Compacted 1.1 DB Becomes 2.0 DB w/ Compatibility Layer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115779">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/06/02">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Error 3041  Incompatible database version  is the result when you use the Microsoft Access 2.0/Visual Basic 3.0 Compatibility Layer to open a Microsoft Access version 1.1 database that was compacted by using the CompactDatabase statement with the D...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QATR,QAZV,QBS0,QDN9,QANZ,QAC1,QAPN,QAKP,QAKJ,QAH4,QAA1,QDKY,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Compacted 1.1 DB Becomes 2.0 DB w/ Compatibility Layer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115779</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic
<PRE>  for Windows, version 3.0
</PRE>- Microsoft Access 2.0/Visual Basic 3.0 Compatibility Layer also called
<PRE>  Microsoft Jet 2.0/Visual Basic 3.0 Compatibility Layer
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Error 3041 "Incompatible database version" is the result when you use
the Microsoft Access 2.0/Visual Basic 3.0 Compatibility Layer to open
a Microsoft Access version 1.1 database that was compacted by using the
CompactDatabase statement with the DB_VERSION10 option.
<P>
<P><h2>CAUSE</h2>
 
<P>
According to the README.TXT file for the Compatibility Layer, after
installing the Compatibility Layer, the CompactDatabase statement in Visual
Basic version 3.0, when used with the DB_VERSION10 constant (from the file
DATACONS.TXT), is supposed to generate a Microsoft Access version 1.1
database. The following table shows which type of database is supposed to
be created when you use CompactDatabase with and without DB_VERSION10:
<P>
 
<PRE>Jet Database Engine   Creates by Default      With DB_VERSION10
</PRE> 
<PRE>Version 1.1           Version 1.1 database    Version 1.0 database
Version 2.0           Version 2.0 database    Version 1.1 database

</PRE>However, this is not what happens. There is a bug in the Compatibility
Layer that causes the CompactDatabase statement to always create a
Microsoft Access version 2.0 database regardless of the existence of the
constant DB_VERSION10 as an option. Both the Office Development Kit (ODK)
and Access Developer's Toolkit (ADT) versions of the Compatibility Layer
have this problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use Microsoft Access version 1.1 or 2.0 to compact a version 1.1
database instead of using the CompactDatabase statement from the
Compatibility Layer.
<P>
NOTE: Once a database is in Microsoft Access version 2.0 format, you
cannot convert it back to Microsoft Access version 1.1 format directly.
If you used CompactDatabase and ended up turning a version 1.1 database
into a version 2.0 database, you need to restore the version 1.1 database
from a backup copy, or rebuild it by extracting the information from
the newly compacted version 2.0 database and placing it into a new
version 1.1 database.
<P>
WARNING: If the Compatibility Layer has been installed and you're using
a Microsoft Access version 1.1 database with a Visual Basic application,
NEVER use CompactDatabase on the version 1.1 database if you want it to
remain in version 1.1 format. Instead, use Microsoft Access itself to
compact version 1.1 databases.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
The following steps reproduce the problem if the Compatibility Layer is
installed on your computer:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a command button (Command1) to Form1.

<P><LI>Place the following code in the Command1 Click event procedure:
<P>
<PRE>   Sub Command1_Click ()
      Const DB_VERSION10 = 1               'Microsoft Access Version 1.1
      Const DB_LANG_GENERAL = ";LANGID=0x0809;CP=1252;COUNTRY=0"

      ' The following should compact a 1.1 Database into a 1.1 Database.
      ' But it actually compacts a 1.1 Database into a 2.0 Database.
      ' Enter the following code as one, single line:
      CompactDatabase "C:\VB\BIBLIO.MDB", "C:\VB\NEWBIB.MDB",
         DB_LANG_GENERAL, DB_VERSION10
   End Sub

</PRE><P><LI>Press the F5 key to run the program, and click the Command1 button.
   This results in an "Incompatible Database Version" error if the
   resulting compacted database, which is now in Microsoft Access version
   2.0 format, is used on a computer that does not have the Compatibility
   Layer installed.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00 buglist3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
