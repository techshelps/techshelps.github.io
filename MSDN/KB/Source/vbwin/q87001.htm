

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Obtain a Listing of Classes for OLE Client Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87001 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/07/21">
<META NAME="Keywords" CONTENT="kbole kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Below is an example of how to obtain a list of the Object Linking and Embedding (OLE) class properties for the OLE Client control in Visual Basic. This example is based on the ServerAcceptFormats example on page 214 in the  Microsoft Professional T...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVR,QA9Q,QAB5,QAMN,QAPN,QA7O,QAOE,QAH4,QAMB,QA5B,QAFF,QABO,QAUJ,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Obtain a Listing of Classes for OLE Client Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87001 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version 2.0
- Microsoft Professional Toolkit for Microsoft Visual Basic programming
<PRE>  system for Windows, version 1.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Below is an example of how to obtain a list of the Object Linking and
Embedding (OLE) class properties for the OLE Client control in Visual
Basic. This example is based on the ServerAcceptFormats example on page 214
in the "Microsoft Professional Toolkit for Visual Basic: Custom Control
Reference" for version 1.0.
<P>
This example gets the information from the REG.DAT file in your
Windows directory. It uses the ServerClasses property to return a
listing of the classes to a list box. The Class property is discussed
on pages 198-201 and 207 of the "Microsoft Professional Toolkit for
Visual Basic: Custom Control Reference" for version 1.0. The
ServerClasses property is discussed on pages 201 and 217 in the same
manual.
<P>
Note that the CtlName property in Visual Basic version 1.0 has been
changed to the Name property in Visual Basic version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This example uses a single form with two list boxes, two labels, and
one OLE Client control. One list box should have a CtlName (or Name) of
Identifier, and the other list box should have a CtlName (or Name) of
FileType. Each label is placed above a list box, with the captions
of Identifier and File Type, respectively.
<P>
There are three event procedures (Form_Load, Identifier_Click, and
FileType) and one procedure, located in the general section of Form1,
called Fillitems(S$).
<P>
The example results in two lists. The available OLE classes are listed
in the Identifier list box, and the Class File Types are listed in the File
Type list box.
<P>
When you click a certain class in the Identifier list box, the
associated class display is highlighted in the second
Identifier-Display list box.
<P>
<P><h3>Step-by-Step Example</h3>
 
1. Start Visual Basic or from the File menu, choose New Project (ALT,
<PRE>   F, N) if Visual Basic is already running. Form1 is created by default.

</PRE><P><LI>From the File menu, choose Add File. In the Files box, select the
   OLECLIENT.VBX custom control file. The OLE Client tool will appear
   in the Toolbox.

<P><LI>Add two label boxes (Label1 and Label2) and two list boxes (List1 and
   List2) to Form1. Position Label1 above List1, and Label2 above List2.

<P><LI>Change the Control Name of List1 to Identifier, and change the Caption
   of Label1 to Identifier.

<P><LI>Change the Control Name of List2 to FileType, and change the Caption
   of Label2 to FileType.

<P><LI>Add the following code to the Form_Load event procedure:
<P>
<PRE>   Sub Form_Load ()
      Dim I As Integer
      ' Fill the Identifier and FileType list boxes
      For I = 0 To OLEClient1.ServerClassCount - 1
         Identifier.AddItem OLEClient1.ServerClasses(I)
         FileType.AddItem OLEClient1.ServerClassesDisplay(I)
      Next I
   End Sub

</PRE><P><LI>Add the following code to the Identifier_Click event procedure
   after you have changed the control name in step 4 above:
<P>
<PRE>   Sub Identifier_Click ()
      ' When user selects a Class, highlight the associated ClassDisplay.
      FileType.ListIndex = Identifier.ListIndex
      ' Display information associated with the selected class.
      FillItems (OLEClient1.ServerClasses(Identifier.ListIndex))
   End Sub

</PRE><P><LI>Add the following code to the FileType_Click event procedure after
   you have changed the control name in step 4:
<P>
<PRE>   Sub FileType_Click ()
      ' When user selects a ClassDisplay, highlight the associated Class.
      Identifier.ListIndex = FileType.ListIndex
   End Sub

</PRE><P><LI>Add the following code to the (general) section of the form's Code
</OL>window
<PRE>   under Object:

   Sub FillItems (S$)
      Dim I As Integer
      ' Set the ServerClass.
      OLEClient1.ServerClass = S$
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00<BR>
KBCategory: kbole kbprg kbcode<BR>
KBSubcategory: IAPOLE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
