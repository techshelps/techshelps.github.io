

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BackColor Erases Existing Graphics on Form or Picture Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108812">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/12/19">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Setting the BackColor property on forms or picture boxes at run time erases all previous printed graphics and output, including a persistent bitmap. This behavior is by design. Setting the ForeColor property does not affect the graphics or print ou...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGB,QAEF,QAPN,QBS0,QBVR,QAOX,QAH4,QABA,QBWS,QAYS,QAIJ,QBT6,QBJZ,QATX,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BackColor Erases Existing Graphics on Form or Picture Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108812</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Setting the BackColor property on forms or picture boxes at run time
erases all previous printed graphics and output, including a persistent
bitmap. This behavior is by design. Setting the ForeColor property does
not affect the graphics or print output that are already drawn.
<P>
Setting the BackColor property on other controls, such as list boxes,
text boxes, or combo boxes, does not erase previously added items.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: A persistent bitmap is a bitmap, accessed with the Image property,
that stores output from graphics methods in memory. For more information,
see the following items in the Visual Basic Help menu:

<UL><LI>AutoRedraw property
<LI>persistent bitmap
<P>
</UL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a list box and a picture box to Form1.

<P><LI>Double-click the form to open the code window. Add the following code to
   the Form Load event:
<P>
<PRE>   Sub Form_Load ()
      form1.Show 'In Load event, must show form before Print works

      picture1.ForeColor = QBColor(1)
      picture1.BackColor = QBColor(11)
      picture1.Print "color1"
      form1.ForeColor = QBColor(1)
      form1.BackColor = QBColor(12)
      form1.Print "color1"
      list1.ForeColor = QBColor(1)
      list1.BackColor = QBColor(11)
      list1.AddItem "color1"

      MsgBox "click to see next color"
      picture1.ForeColor = QBColor(2)
      picture1.BackColor = QBColor(10)  'This BackColor erases picture1
      picture1.Print "color1"
      form1.ForeColor = QBColor(2)
      form1.BackColor = QBColor(13)  'This BackColor erases form1
      form1.Print "color1"
      list1.ForeColor = QBColor(2)
      list1.BackColor = QBColor(10)  'This BackColor doesn't erase List1
      list1.AddItem "color2"

      MsgBox "click to see next color"
      picture1.ForeColor = QBColor(4)
      picture1.BackColor = QBColor(14)  'This BackColor erases picture1
      picture1.Print "color1"
      form1.ForeColor = QBColor(4)
      form1.BackColor = QBColor(8)  'This BackColor erases form1
      form1.Print "color1"
      list1.ForeColor = QBColor(4)
      list1.BackColor = QBColor(14)  'This BackColor doesn't erase List1
      list1.AddItem "color3"

   End Sub

</PRE><P><LI>Start the program or press the F5 key. Click OK to see the next color.
   To end the program, close the form.
<P>
</OL>Here are the results:

<UL><LI>Changing the Form1.BackColor property erases the text that you
   previously printed on Form1.
<LI>Changing the Picture1.BackColor property erases the text that you
   previously printed on Picture1.
<LI>Changing the List1.BackColor property does not erase the text that you
   previously added to the List1 list box.
<P>
</UL>All of this behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00 delete remove blank out<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
