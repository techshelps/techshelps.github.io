

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Clear the Contents of a DBGrid Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150468">
<META NAME="KBModify" CONTENT="1996/05/07">
<META NAME="KBCreate" CONTENT="1996/04/30">
<META NAME="Keywords" CONTENT="kbusage kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to clear the contents of a DBGrid control. A DBGrid control is bound to a Data control. To clear the DBGrid control of all data, set the RecordSource property of the Data control so no records are returned, and then execu...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAJX,QAEF,QADR,QBS0,QAHV,QAPN,QAMB,QBWS,QBXS,QA5V,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Clear the Contents of a DBGrid Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150468</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to clear the contents of a DBGrid control. A
DBGrid control is bound to a Data control. To clear the DBGrid control of
all data, set the RecordSource property of the Data control so no records
are returned, and then execute the Refresh method on the Data control. The
DBGrid control displays the data retrieved by the Data control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following instructions show how to create a sample program that
demonstrates how to clear the DBGrid control. The form contains a DBGrid
control bound to a Data control. The Data control is bound to the sample
database shipping with Microsoft Visual Basic, BIBLIO.MDB, and the
RecordSource is set to the Titles table. Two Command buttons are used to
populate and clear the DBGrid control. To clear the DBGrid control, the
RecordSource is set to a SQL statement that does not return any records. To
populate the DBGrid control, the RecordSource property is set to the Titles
table.
<P>
When you run the program, the DBGrid control is immediately populated
because the RecordSource property of the Data control is bound to the
Titles table. Click the Command button to clear the DBGrid control.
<P>
Follow these instructions to create a sample application that demonstrates
this process:

<OL><P><LI>Start Visual Basic version 4.0. If it is already running, from the File
   menu, select New Project.

<P><LI>Add a Data control, a DBGrid control, and two Command buttons to
   Form1.form.

<P><LI>Set the following properties for each control:
<P>
<PRE>      Control          Default Name       Property           Value
      ---------------------------------------------------------------

      Data Control     Data1              DatabaseName     BIBLIO.MDB
                                          RecordSource     Title

      DBGrid Control   DBGrid1            DataSource       Data1

</PRE><P><LI>Copy the following code to the Code window of the Form1 form:
<P>
<P><PRE>      Option Explicit
      Dim sql As String
</PRE><P>
<P><PRE>      Private Sub Command2_Click()
<PRE></PRE>         ' SQL statement that does not return records.
         sql = "SELECT * From Titles Where Title = Null"
         Data1.RecordSource = sql
         Data1.Refresh
         Command1.Visible = True
         Command2.Visible = False
      End Sub

      Private Sub Command1_Click()
      ' Set the RecordSource to fill the DBGrid control.
         Data1.RecordSource = "Titles"
         Data1.Refresh
         Command1.Visible = False
         Command2.Visible = True
      End Sub

      Private Sub Form_Load()
         Command1.Caption = "Fill DBGrid"
         Command1.Visible = False
         Command2.Caption = "Clear DBGrid"
         Command2.Visible = True
      End Sub

</PRE><P><LI>From the Run menu, select Start, or press the F5 key. Click the visible
   Command button to clear or populate the DBGrid control.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbusage kbhowto kbcode<BR>
KBSubcategory: PrgCtrlsStd
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
