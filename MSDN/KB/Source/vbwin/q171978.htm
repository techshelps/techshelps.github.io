

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INFO: Non-Modal Form Support in Visual Basic DLLs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171978">
<META NAME="KBModify" CONTENT="1997/08/04">
<META NAME="KBCreate" CONTENT="1997/07/25">
<META NAME="Keywords" CONTENT="IAPOLE vb5all VBKBAX VBKBComp kbinfo">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Visual Basic 4.0 ActiveX DLLs (in-process ActiveX Servers) could display forms modally only. Visual Basic 5.0 allows you display forms modally or in modeless form. When designing a ActiveX DLL, you have to take into consideration whether if the cli...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAMA,QA5F,QAJH,QDKX,QBRJ,QAI2,QBV9,QARL,QAJG,QAFR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Non-Modal Form Support in Visual Basic DLLs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171978</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic 4.0 ActiveX DLLs (in-process ActiveX Servers) could display
forms modally only. Visual Basic 5.0 allows you display forms modally or
in modeless form. When designing a ActiveX DLL, you have to take into
consideration whether if the client application supports displaying
modeless forms.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Modeless forms displayed by in-process components cannot function correctly
unless they can communicate with the client's message loop. Therefore, in-
process components created with Visual Basic can display modeless forms
only in client processes that support such communication.
<P>
The following applications support the display of modeless forms by in-
process components:

<UL><LI>Applications created with Visual Basic 5.0 or later.

<LI>Microsoft Office 97 or later.

<LI>Applications that have the Visual Basic Technology logo.(Those that
   license Visual Basic for Applications version 5.0 or later.)
<P>
</UL>Applications that do not support the display of modeless forms by in-
process components include:

<UL><LI>Applications created with earlier versions of Visual Basic.

<LI>Earlier versions of Microsoft Office.

<LI>Version 3.0 of Microsoft Internet Explorer.
<P>
</UL>To allow in-process components to detect at run time whether a client
application supports the display of modeless forms, Visual Basic provides
the Boolean NonModalAllowed property of the App object.
<P>
An in-process component should test this property before showing a modeless
form. If the value is True, the form can be shown vbModeless. If the value
is False, showing a modeless form will cause run-time error 369. The
component should degrade gracefully by showing the form vbModal instead.
Example:
<P>
<PRE>   If App.NonModalAllowed Then
      Form1.Show vbModeless
   Else
      Form1.Show vbModal
   EndIf
</PRE> 
<PRE>Keywords          : IAPOLE vb5all VBKBAX VBKBComp kbinfo
Version           : 5.0
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
