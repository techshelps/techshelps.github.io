

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Locate" Dialog Appears When Running Setup Wizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173049">
<META NAME="KBModify" CONTENT="1997/10/16">
<META NAME="KBCreate" CONTENT="1997/08/22">
<META NAME="Keywords" CONTENT="vb5all VBKBSetup VBKBWinAPI VBKBWiz">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When running the Microsoft Visual Basic Application Setup Wizard, a dialog titled  Locate Kernel,   Locate User,   Locate GDI,  etc., is displayed after you click the Next button on the  Setup Wizard - Select Project and Options  form.  CAUSE =====...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAA1,QBWS,QA01,QA5F,QAMA,QAJN,QACI,QA4Q,QAY5,QANE,QAB9,QDIZ,QA2Q,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Locate" Dialog Appears When Running Setup Wizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173049</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When running the Microsoft Visual Basic Application Setup Wizard, a dialog
titled "Locate Kernel," "Locate User," "Locate GDI," etc., is displayed
after you click the Next button on the "Setup Wizard - Select Project and
Options" form.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Visual Basic Application Setup Wizard scans a project's files for
Declare statements to determine if any additional dependency files need to
be distributed. If any such files are found, the user is prompted for the
location of the files with the "Locate" dialog.
<P>
If any declarations for 16-bit DLLs are found in the project's files, the
user is prompted for the location. For example, if the following 16-bit
declaration appears in the project:
<P>
<PRE>   Declare Function GetWindowsDirectory Lib "Kernel" _
      (ByVal lpBuffer As String, ByVal nSize As Integer) As Integer

</PRE>Setup Wizard will prompt the user for the location of the Kernel DLL with
the "Locate" dialog.
<P>
This is a very common problem with applications converted from 16-bit
Visual Basic to Visual Basic 5.0, which is 32-bit, or with Visual Basic 4.0
applications that use conditional compilations that have been converted to
Visual Basic 5.0. Setup Wizard does not take into consideration the
compiler directives when looking for Declare statements resulting, for
example, in a "Locate Kernel" dialog for the sample code below:
<P>
<PRE>   #If Win32 Then
      Declare Function GetWindowsDirectory Lib "Kernel32" _
         Alias "GetWindowsDirectoryA" _
         (ByVal lpBuffer As String, ByVal nSize As Long) As Long
   #Else
      Declare Function GetWindowsDirectory Lib "Kernel" _
         (ByVal lpBuffer As String, ByVal nSize As Integer) As Integer
   #End If

</PRE><h2>RESOLUTION</h2>
 
<P>
Convert all 16-bit declarations to their 32-bit equivalents and recompile
the project, or, if conditional compilation was used to select between
pairs of 16-bit and 32-bit declarations, the conditional compilation
statements and 16-bit declarations can be commented out or removed and the
project recompiled.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new Standard EXE project in Visual Basic.

<P><LI>Add a new module (Module1) to the project.

<P><LI>In the General Declarations section of Module1, add following code:
<P>
<P><PRE>      Declare Function GetWindowsDirectory Lib "Kernel" _
<PRE></PRE>         (ByVal lpBuffer As String, ByVal nSize As Integer) As Integer

</PRE><P><LI>Save the project, compile it, and then exit Visual Basic.

<P><LI>Start the Visual Basic Application Setup Wizard and proceed to the form
   entitled "Setup Wizard - Select Project and Options," click the Browse
   button, and select the project you compiled.

<P><LI>Click the Next button. A locate file common dialog box entitled "Locate
   Kernel" is displayed.
</OL> 
<PRE>Keywords          : vb5all VBKBSetup VBKBWinAPI VBKBWiz
Version           : WINDOWS:5.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
