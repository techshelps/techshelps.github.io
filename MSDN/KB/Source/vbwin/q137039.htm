

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>New Features in Microsoft Jet Version 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137039">
<META NAME="KBModify" CONTENT="1995/11/27">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbother kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Microsoft Jet 3.0 database engine used by Microsoft Visual Basic version 4.0 has many functional improvements over previous versions. This article briefly describes some of these improvements and summarizes their effect in contrast with previou...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBS0,QAEF,QBE7,QBE6,QBWA,QAY5,QAYZ,QAGU,QDIV,QA28,QATJ,QBF0,QAY2,QAU3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>New Features in Microsoft Jet Version 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 27, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137039</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Microsoft Jet 3.0/Visual Basic 4.0 Compatibility Layer
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Jet 3.0 database engine used by Microsoft Visual Basic
version 4.0 has many functional improvements over previous versions. This
article briefly describes some of these improvements and summarizes their
effect in contrast with previous versions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Improvements in Microsoft Jet 3.0 database engine:

<UL><LI>New index structure. This results in substantial reduction in storage
   size and significant reduction in time to create indices that are highly
   duplicated.

<LI>No more read locks on index pages. This will remove many locking
   conflict issues and remove the need for users to call FreeLocks in
   Visual Basic.

<LI>New mechanism for page reuse. In Microsoft Jet 2.x, if a user deleted a
   lot of data, the last user out would pay a substantial time penalty
   while the recycled page identifiers were being processed into available
   page identifiers. In Microsoft Jet 3.0, this process is significantly
   faster.

<LI>New compacting method. Compacting the database now results in the
   indices being stored in a clustered-index format. While the clustered
   index isn't maintained until the next compact, performance is still
   improved. This differs from Microsoft Jet 2.x where rows of data were
   stored the way they were entered. The new clustered-key compact method
   is based on the primary key of the table. New data entered will be in
   time order.

<LI>New mechanism for page allocation. In Microsoft Jet 2.X each page could
   contain data from a different table, thus causing more disk activity. In
   Microsoft Jet 3.0, each table typically maintains clusters of grouped
   together pages (eight pages), thus eliminating the scenario of every
   other page having data from different tables. This scenario also greatly
   enhances Microsoft Jet's read-ahead capabilities because data pages are
   more contiguous.

<LI>Faster delete operations. In Microsoft Jet 2.x, pages were doubly
   linked, thus causing a delete operation to visit every page when all
   rows were being deleted. This operation can now be done by simply
   visiting the Space Map object for that table and removing the bits that
   reference that table and returning them to the recycle area.

<LI>Multithreading. By default, Microsoft Jet uses three threads to perform
   read ahead, write behind, and cache maintenance.

<LI>Implicit transactions. Users are no longer forced to explicitly use
   BEGINTRANS and COMMITTRANS to gain performance improvements. For
   example, when walking through a recordset to do operations, Microsoft
   Jet groups a series of commands into an internal transaction. Then as
   appropriate (that is, in a specified time period or when the cache fills
   up) it starts asynchronously flushing the transaction to disk. Still, if
   a user wants to force a particular behavior in their application, then
   they should explicitly use transactions. For users that don't explicitly
   use transactions and have the database opened shared, they should
   encounter little if any behavioral differences from Microsoft Jet 2.x.
   If a user opens the database exclusively, then they could see some
   behavior differences relating to some types of error trapping if they
   are not using explicit transactions.

<LI>New sort engine. Many of the sort algorithms that are in FoxPro are now
   used in Microsoft Jet.

<LI>Long Values (such as memos or binary data types) are stored in separate
   tables in Microsoft Jet 3.0. In Microsoft Jet 2.x, all long value
   columns were stored in one hidden table, which resulted in a lot of
   contention issues for users using Microsoft Jet in shared mode. Placing
   these values in separate tables resolved manu contention issues. Also
   each Long Value table is now indexed, whereas in Microsoft Jet 2.x, Long
   Value data was forward linked only, thus making random positioning
   time-consuming.

<LI>Dynamic buffering. Microsoft Jet 2.x supported a maximum cache size of
   4 MB. Microsoft Jet 3.0's cache is dynamically allocated at start up
   and has no limit. Currently, the cache will be half the available memory
   upon start up. This allows effective memory usage on computers that have
   large amounts of RAM without changing registry settings. The buffer has
   also been redesigned to use common buffering code. In Microsoft Jet 2.x,
   separate buffering code could result in pages being needlessly flushed
   from the cache, thus causing Jet to re-read the page. Microsoft Jet 2.x
   also used a FIFO (first in, first out) buffer replacement policy, which
   also caused frequently-referenced pages to be flushed from cache.
   Microsoft Jet 3.0 implements an LRU (least recently used) replacement
   policy to help eliminate this problem.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbref kbother kbinterop<BR>
KBSubcategory: RefsProd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 27, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
