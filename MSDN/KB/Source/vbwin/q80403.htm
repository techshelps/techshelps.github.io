

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Call VBSetErrorMessage() In Response to VBM_ Messages Only </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80403 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/01/28">
<META NAME="Keywords" CONTENT="kbtool kbprg kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Visual Basic Control Development Kit (CDK) API function VBSetErrorMessage() operates correctly only when called in response to a VBM_ message, such as VBM_SETPROPERTY.  STATUS ======  This behavior is by design.  MORE INFORMATION  The VBSetErro...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAEV,QA5F,QAMA,QAYC,QAUD,QAGI,QAH4,QA5B,QAH7,QAH6,QAAP,QAD7,QAB4,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Call VBSetErrorMessage() In Response to VBM_ Messages Only</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80403 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic Control Development Kit (CDK) for Microsoft
<PRE>  Visual Basic Programming system for Windows, version 1.0
</PRE>- Microsoft Professional Toolkit for Microsoft Visual Basic, version 1.0
- Professional Edition of Microsoft Visual Basic for Windows, version 2.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Visual Basic Control Development Kit (CDK) API function
VBSetErrorMessage() operates correctly only when called in response
to a VBM_ message, such as VBM_SETPROPERTY.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The VBSetErrorMessage() function can be called from a custom control in
response to a VBM_ message to pass an error number and message back to
Visual Basic. When execution returns to Visual Basic, a trappable
run-time error will occur, with the error number and message specified
in the call to VBSetErrorMessage.
<P>
The VBSetErrorMessage routine works only in response to messages that
originate from Visual Basic itself (VBM_ messages). Visual Basic
responds to the return code for VBM_ messages, and in turn sets the
error condition in the program. If the return code for a VBM_ message
is True, Visual Basic will generate an error condition. For other
messages (non VBM_ messages), Visual Basic must pass along the return
code to the originator of the message (usually Windows); therefore,
Visual Basic will not generate an error condition for these messages.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Visual Basic: Control Development Guide," (c) 1992, page
117 (shipped with Professional Toolkit)
<P>
"Microsoft Visual Basic: Control Development Guide," (c) 1991, page
108 (part no. 20666)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: docerr 1.00 2.00<BR>
KBCategory: kbtool kbprg kbdocerr<BR>
KBSubcategory: TlsCDK<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
