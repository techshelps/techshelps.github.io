

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: GPF When Erase User-Defined Array of Variable Strings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95525 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/02/14">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you try to erase an user-defined type array of a variable-length strings, you may encounter a general protection (GP) fault or unrecoverable application error (UAE).  WORKAROUND  This problem doesn't occur if you use an array of fixed-length str...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAVW,QAVX,QATX,QBKN,QBJZ,QDKW,QAEF,QAR4,QAP2,QAGB,QAH4,QAKP,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: GPF When Erase User-Defined Array of Variable Strings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95525 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 2.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you try to erase an user-defined type array of a variable-length
strings, you may encounter a general protection (GP) fault or
unrecoverable application error (UAE).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
This problem doesn't occur if you use an array of fixed-length strings
or an array of type Variant in place of the array of variable-length
strings. Therefore, you can work around the problem by using an array
such as the following with a user-defined type and fixed-length
strings.
<P>
<PRE>   Type mytype
      mystrings(1) As String * 10   'array of fixed length string
   End Type

   Global test As mytype

</PRE>You can also work around the problem by using an array of variants instead
of an array of strings, as this example shows:
<P>
<PRE>   Type mytype
      mystrings(1) As Variant      'array of variant type
   End Type

   Global test As mytype

</PRE>A third alternative is to erase the elements in the variable-length string
array manually instead of using the Erase statement, as follows:
<P>
<PRE>   Form_Click()
   For i% = 0 to UBound(test.mystrings)
      test.mystrings(i%) = ""
   Next i%
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Visual Basic
version 2.0 for Windows. This problem was corrected in Microsoft Visual
Basic version 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Run Visual Basic, or if Visual Basic is already running choose New
   Project from the File menu (ALT, F, N). Form1 is created by
   default.

<P><LI>From the File menu, choose New Module (ALT, F, M). Module1 will be
   created.

<P><LI>Add the following code to the general declarations section of Module1:
<P>
<P><PRE>      Type mytype
<PRE></PRE>         mystrings(1) As String
      End Type

      Global test As mytype

</PRE><P><LI>Next add the following code to the Form_Click event procedure of Form1:
<P>
<P><PRE>      Form_Click()
<PRE></PRE>         Erase test.mystrings(1)
      End Sub

</PRE><P><LI>Press the F5 key and click Form1.
<P>
</OL>At this point, you will encounter a GP fault or UAE.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 fixlist3.00 2.00 3.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgOptTips<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
