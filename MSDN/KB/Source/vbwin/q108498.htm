

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: DDE Error When Running Setup on Norton Desktop </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108498">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/12/13">
<META NAME="Keywords" CONTENT="kbtool kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Setup Toolkit provided with Visual Basic version 3.0 is used to create distribution disks for applications created with Visual Basic. If Norton Desktop for Windows version 2.0 or 2.2 is being used as the Windows Shell, Windows will report the e...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBS0,QAGI,QAB4,QAH4,QDI2,QAGU,QAJH,QAZ2,QDIZ,QDL9,QBWQ,QBWO,QBWN,QBIC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: DDE Error When Running Setup on Norton Desktop</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108498</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Setup Toolkit provided with Visual Basic version 3.0 is used to create
distribution disks for applications created with Visual Basic. If Norton
Desktop for Windows version 2.0 or 2.2 is being used as the Windows Shell,
Windows will report the error message, "An application using DDE did not
respond to the system's exit command," shortly after SETUP1 is complete.
<P>
<P><h2>CAUSE</h2>
 
<P>
The error message occurs because the Norton Desktop shell and the Program
Manager each handle DDE messages differently. SETUP1 calls two routines
to create groups and items, CreateProgManGroup and CreateProgManItem. Each
routine establishes a DDE link and then terminates it after the group or
item is created. After the termination of the link, not enough time is
being given to the Norton Desktop shell to acknowledge the terminated link.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
A customer has reported that this problem does not occur with version 3.0
of Norton Desktop.
<P>
If you are experiencing this problem, modify the SETUP1.MAK program to
allow the Norton Desktop shell to acknowledge the termination of DDE links.
To do this, call the DoEvents function after each call to
CreateProgManGroup or CreateProgManItem.
<P>
Here are the changes you need to make to the SETUP1.FRM file in the
Form_Load event. The SETUP1.FRM is part of the SETUP1.MAK file, which is
typically in the \VB\SETUPKIT\SETUP1 directory.
<P>
<PRE>   CreateProgManGroup Setup1, "My Loan Application", "LOAN.GRP"

   For i% = 1 To 10
      z% = DoEvents()
   Next

   CreateProgManItem Setup1, destPath$ + "LOAN.EXE", "My Loan Application"

   For i% = 1 To 10
      z% = DoEvents()
   Next

</PRE>As you can see, the loop of DoEvents is included after each and every call
to CreateProgManGroup and CreateProgManItem. If more calls to these
procedures are added, additional loops of DoEvents must be included after
those calls. If the SETUP1A.MAK program is being used, the same changes
must be made to the SETUP1A.FRM Form_Load event. These changes will not
affect installations on computers that use the Program Manager shell.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The SETUP1.MAK program is part of the Setup Toolkit provided with Visual
Basic version 3.0. SETUP1.MAK can be modified by the user or the Setup
Wizard to design a custom setup that will install the user's application
on other computers. It is typically located in the \VB\SETUPKIT\SETUP1
directory.
<P>
When the setup program is run on a target computer, the SETUP1.EXE program
is copied to the computer's hard drive and launched. The SETUP1 program
then proceeds to copy all of the user's application over to the hard drive.
At the conclusion of this process, SETUP1 initiates a series of DDE links
to the Program Manager. This is to create the program groups and items for
the user's application.
<P>
When you use Norton Desktop version 2.0 or 2.2 for Windows as the Windows
Shell, the DDE links are successful in creating the necessary program
groups and items, and the user's application is installed intact. However,
some time after the SETUP1 program ends, the error message (An application
using DDE did not respond to the system's exit command) appears. Options to
retry, continue, and close are displayed in the dialog box. If the user
chooses close, the error will disappear and the user's application will
still be installed successfully.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 norton desktop progman dde error<BR>
KBCategory: kbtool kbprg kbprb<BR>
KBSubCategory: TlsSetWiz<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
