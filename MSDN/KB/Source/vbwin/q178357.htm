

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Set an Error Level from a Visual Basic Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178357">
<META NAME="KBModify" CONTENT="1997/12/22">
<META NAME="KBCreate" CONTENT="1997/12/19">
<META NAME="Keywords" CONTENT="VB4WIN vb5all vb5howto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article contains a sample Visual Basic application that sets the DOS error level upon exiting and a DOS batch file for testing.  MORE INFORMATION  1. Start a new project and save as Project1.  2. In the Declaration Section of Form1, add the fo...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAIJ,QAFF,QBWQ,QAGB,QAAP,QAB4,QDL9,QDIV,QBWO,QBWN,QBBI,QAMB,QAA3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Set an Error Level from a Visual Basic Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178357</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, versions 4.0, 5.0
   on the following platforms: NT, Win95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains a sample Visual Basic application that sets the DOS
error level upon exiting and a DOS batch file for testing.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start a new project and save as Project1.

<P><LI>In the Declaration Section of Form1, add the following declaration:
<P>
<P><PRE>      Private Declare Sub ExitProcess Lib "kernel32" _
      (ByVal uExitCode As Long)
</PRE>
<P><LI>Place three CommandButtons on the form (use default names).

<P><LI>Change the Caption property on the CommandButtons to 50, 100, and 150
   respectively.

<P><LI>Place the following code behind the form:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         ExitProcess (50&amp;) 'Button labeled "50"
      End Sub
   
      Private Sub Command2_Click()
         ExitProcess (100&amp;) 'Button labeled "100"
      End Sub
   
      Private Sub Command3_Click()
         ExitProcess (150&amp;) ''Button labeled "150"
      End Sub

</PRE><P><LI>Save the Project and Make the executable.

<P><LI>Create the following batch file named errlevel.bat in your project
   directory:
<P>
<P><PRE>      echo off
      start /w project1
      rem "start /w"
      if errorlevel 150 goto 150
      if errorlevel 100 goto 100
      if errorlevel 50 goto 50
      echo Exit Code 0
      goto Done
      :150
      echo Exit Code 150
      goto done
      :100
      echo Exit Code 100
      goto done
      :50
      echo Exit Code 50
      :done
      echo done
</PRE>
<P><LI>Run the batch file. When the user clicks on a CommandButton, the
   application will terminate with the error level on the button. The batch
   file will then test the error level and echo the result to the screen.
<P>
</OL>Additional notes:

<OL><P><LI>Start /w is necessary for this to work correctly in Windows 95.

<P><LI>"if errorlevel" must be in the order presented. "If the EXIT status is
   less than the specified value, the specified DOS command is executed;
   otherwise, processing continues with the next batch file command."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
MS-DOS Batch Files, Second edition, MS Press
 
<PRE>Keywords          : VB4WIN vb5all vb5howto
Version           : WINDOWS:4.0,5.0
Platform          : NT Win95 WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
