

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Determine the Type of Drive Using Win32 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161300">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="vb432 VB4WIN vb5all vb5howto VBKBProgramming VBKBWinAPI kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  There are many types of drives that Windows can detect and the Win32 API GetDriveType gives the Visual Basic programmer a simple way to differentiate between them. Below is a code sample showing how to use the API.  MORE INFORMATION  1. Start a new...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAGX,QAC9,QDL9,QBWQ,QBWO,QBWN,QA5B,QATX,QAH4,QAEF,QABB,QAP2,QA01,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Determine the Type of Drive Using Win32</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161300</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are many types of drives that Windows can detect and the Win32 API
GetDriveType gives the Visual Basic programmer a simple way to
differentiate between them. Below is a code sample showing how to use the
API.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start a new Standard EXE project. Form1 is added by default.

<P><LI>Add a DriveListBox to Form1.

<P><LI>Add the code below to the General Declarations section of Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Declare Function GetDriveType Lib "kernel32" Alias _
<PRE></PRE>        "GetDriveTypeA" (ByVal sDrive As String) As Long

      Private Function DriveType(sDrive As String) As String
        Dim sDriveName As String
        Const DRIVE_TYPE_UNDTERMINED = 0
        Const DRIVE_ROOT_NOT_EXIST = 1
        Const DRIVE_REMOVABLE = 2
        Const DRIVE_FIXED = 3
        Const DRIVE_REMOTE = 4
        Const DRIVE_CDROM = 5
        Const DRIVE_RAMDISK = 6
        sDriveName = GetDriveType(sDrive &amp; ":\")
        Select Case sDriveName
          Case DRIVE_TYPE_UNDTERMINED
            DriveType = "has not been recognized"
          Case DRIVE_ROOT_NOT_EXIST
            DriveType = "specified doesn't exist"
          Case DRIVE_CDROM
            DriveType = "is a CD-ROM drive."
          Case DRIVE_FIXED
            DriveType = "cannot be removed I.E. Hard Disk"
          Case DRIVE_RAMDISK
            DriveType = "is a RAM disk."
          Case DRIVE_REMOTE
            DriveType = "is a remote I.E Network drive."
          Case DRIVE_REMOVABLE
            DriveType = "can be removed I.E. Floppy Disk."
        End Select
      End Function

      Private Sub Drive1_Change()
        MsgBox "The Drive Type " &amp; DriveType(Left(Drive1.Drive, 1))
      End Sub

</PRE><P><LI>Press the F5 key to run the project, and select a drive from the Drive
   List box. A message box will be displayed showing what type of drive it
   is.
</OL> 
<PRE>Keywords          : vb432 VB4WIN vb5all vb5howto VBKBProgramming VBKBWinAPI kbusage
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
