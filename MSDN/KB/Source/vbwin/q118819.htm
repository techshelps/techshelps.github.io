

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Tell Whether an App Runs in VB Design Environment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118819">
<META NAME="KBModify" CONTENT="1997/02/26">
<META NAME="KBCreate" CONTENT="1994/07/31">
<META NAME="Keywords" CONTENT="EnvtRun kbcode kbenv kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how a Visual Basic application can determine whether it is running in the design environment or as an executable file. Two ways that Visual Basic does this are explained.  MORE INFORMATION  Visual Basic provides the APP objec...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA4Q,QAH4,QDIZ,QAX1,QBWS,QAJH,QAY5,QAUJ,QA5F,QAMA,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Tell Whether an App Runs in VB Design Environment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbenv kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic
   Programming System for Windows, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how a Visual Basic application can determine whether
it is running in the design environment or as an executable file. Two ways
that Visual Basic does this are explained.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic provides the APP object, which has the property EXENAME.
APP.EXENAME reports the name of the executable file when it runs as an
executable file. However, in the design environment, APP.EXENAME reports
the name of the project. If you use different names for the project and the
executable file, then you can use APP.EXENAME to determine whether an
application is running in the Visual Basic design environment or as an
executable file.
<P>
You can also use the Windows API to determine whether an application is
running in the Visual Basic Design Environment or as an executable file.
When running in the design environment, the application's module name is
"VB." However, as an executable file the module name matches the executable
file name that is chosen when compiling the application to an executable
file from Visual Basic.
<P>
<P><h3>Example</h3>
 
<P>
You can determine the module name by using the functions GetCurrentTask()
and TaskFindHandle() from the Windows API. The following example
illustrates how to use the functions to determine whether the application
is running in the Visual Basic design environment:

<OL><P><LI>Start a new project (Form1 is created by default).

<P><LI>Add a new module to the program (MODULE1.BAS by default).

<P><LI>Place the following code in the module:
<P>
<P><PRE>      Type TASKENTRY
<PRE></PRE>         dwSize As Long
         hTask As Integer
         hTaskParent As Integer
         hInst As Integer
         hModule As Integer
         wSS As Integer
         wSP As Integer
         wStackTop As Integer
         wStackMinimum As Integer
         wStackBottom As Integer
         wcEvents As Integer
         hQueue As Integer
         szModule As String * 10
         wPSPOffset As Integer
         hNext As Integer
      End Type
   
      ' The following declare must be entered on a single line
      Declare Function TaskFindHandle Lib "Toolhelp" (lpte As TASKENTRY,
         ByVal hTask As Integer) As Integer
      Declare Function GetCurrentTask Lib "Kernel" () As Integer
   
      Function VBDesignEnvironment () As Integer
         Dim TE As TASKENTRY
         Dim ModuleName As String
         Dim hTask As Integer
         Dim r
   
         hTask = GetCurrentTask()
         TE.dwSize = Len(TE)
         r = TaskFindHandle(TE, hTask)
         ModuleName = Left(TE.szModule, InStr(TE.szModule, Chr(0)) - 1)
   
         If ModuleName = "VB" Then
            VBDesignEnvironment = True
         Else
            VBDesignEnvironment = False
         End If
      End Function
   
</PRE></OL>4. Add the following code to the load event of the form:
<PRE>   
      Sub Form_Load ()
         Me.Show
         If VBDesignEnvironment() Then
            Print "Design Environment"
         Else
            Print "Executable"
         End If
      End Sub

</PRE><P><LI>Save the project.

<P><LI>Run the application in the design environment. The form should display
   "Design Environment".

<P><LI>Make an executable file from the project.

<P><LI>Run the executable file from File Manager. The form should display
   "Executable".
<P>
</OL><h3>Notes</h3>
 

<UL><LI>The function TaskFindHandle() is in the TOOLHELP.DLL file. This dynamic-
   link library does not come with Windows version 3.0.

<LI>You may want to add code to the VBDesignEnvironment() function that
   checks for errors when returning from GetCurrentTask() and
   TaskFindHandle().
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kbprg kbcode<BR>
KBSubcategory: EnvtRun<BR>
Additional reference words: 3.00 .EXE VB.EXE debug run-time IDE<BR>
Keywords            : EnvtRun kbcode kbenv kbprg<BR>
Version             : 3.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
