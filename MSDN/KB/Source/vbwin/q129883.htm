

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Dynaset, Snapshot, and Table Objects No Longer Available </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129883">
<META NAME="KBModify" CONTENT="1996/04/16">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you try to dimension a Dynaset, Snapshot, or Table object variable and using DAO 3.0 (Visual Basic version 4.0 data access objects), you will receive this runtime error:     User-defined type not defined.  If you replace the Dynaset, Snapshot, o...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAN0,QBXS,QAW6,QAH4,QANF,QAIJ,QBHQ,QACJ,QDN3,QDKY,QBVV,QA59,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Dynaset, Snapshot, and Table Objects No Longer Available</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129883</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you try to dimension a Dynaset, Snapshot, or Table object variable and
using DAO 3.0 (Visual Basic version 4.0 data access objects), you will
receive this runtime error:
<P>
<PRE>   User-defined type not defined.

</PRE>If you replace the Dynaset, Snapshot, or Table object with the Object or
RecordSet type and use methods such as CreateDynaset, CreateSnapshot, or
OpenTable that are tied to the Dynaset, Snapshot, or Table types, you will
receive this error:
<P>
<PRE>   Feature not available.

</PRE><h2>CAUSE</h2>
 
<P>
Visual Basic version 4.0 has replaced the older Dynaset, Snapshot, and
Table objects with a single RecordSet object. This object can take on the
attributes of any of the older three making it much more powerful and
flexible.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can resolve this problem one of two ways.

<UL><LI>Replace references to the older objects, while retaining lines of code
   such as these:
<P><PRE>       Dim DB As Database
       Set DB = OpenDatabase("Biblio.mdb")
</PRE><P>
   For example, instead of this old code:
<P>
<P><PRE>       Dim DS As Dynaset
       Dim SS As Snapshot
       Dim TB As Table
</PRE><P>
<P><PRE>       Set DB = OpenDatabase("Biblio.mdb")
       Set DS = DB.CreateDynaset("Authors")
       Set SS = DB.CreateSnapshot("Authors")
       Set TB = DB.OpenTable("Authors")
</PRE><P>
   Use this new code:
<P>
<P><PRE>       Dim DB As Database
       Dim RS1 As Recordset
       Dim RS2 As Recordset
       Dim RS3 As Recordset
</PRE><P>
<P><PRE>       Set DB = OpenDatabase("Biblio.mdb")
       Set RS1 = DB.OpenRecordset("Authors", dbOpenDynaset)
       Set RS2 = DB.OpenRecordset("Authors", dbOpenSnapshot)
       Set RS3 = DB.OpenRecordset("Authors", dbOpenTable)
</PRE><P>
   -or-

<LI>Retain the older syntax and change the Data Access Object (DAO) Type
   Library that your program uses. Although Microsoft recommends the first
   method for future compatibility, using the older syntax is useful for
   compiling code written in previous versions of Visual Basic in version
   4.0 with a minimal number of changes. To change the DAO Type Library:
<P>
   1. Choose References from the Tools menu in Visual Basic.
<P>
   2. Clear the Microsoft DAO 3.0 Object Library selection.
<P>
   3. Select the Microsoft DAO 2.5/3.0 Compatibility Library.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
With the Microsoft DAO 3.0 Object Library selected in Tools References:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Data Control (Data1) to Form1.

<P><LI>Add the following code to the Form1_Click procedure:
<P>
<PRE>   Sub Form1_Click()
      Dim ds As dynaset  'this generates "User-defined type not defined"

      Data1.Databasename = "Biblio.MDB"
      Data1.RecordSource = "Authors"
      Data1.Refresh

      Set ds = Data1.Recordset.CreateDynaset()
      ' If ds is Dim'd as a RecordSet,
      ' this generates "Feature not available"
      ds.Close
      Set ds = Nothing
   End Sub

</PRE><P><LI>Start the program by choosing Start from the Run menu or by pressing the
   F5 key. The 3251 error will be generated on the CreateDynaset line.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
