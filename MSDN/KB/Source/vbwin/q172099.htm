

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: T-SQL - Running Remote and Local SQL Debugging </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172099">
<META NAME="KBModify" CONTENT="1997/08/05">
<META NAME="KBCreate" CONTENT="1997/07/29">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After installing both SQL Server and Visual Basic 5.0 Enterprise Edition on your local machine, you will be able to perform local SQL debugging. When running the local SQL debugger after remote debugging (Visual Basic and SQL Server reside on two d...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QABM,QABI,QANN,QAB4,QBWS,QAP2,QAAW,QBXS,QAIJ,QABH,QA5F,QAMA,QAKP,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: T-SQL - Running Remote and Local SQL Debugging</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172099</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
<LI>Microsoft Visual Studio 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After installing both SQL Server and Visual Basic 5.0 Enterprise Edition
on your local machine, you will be able to perform local SQL debugging.
When running the local SQL debugger after remote debugging (Visual Basic
and SQL Server reside on two different computers), the T-SQL debugger
starts to skip breakpoints set in the SQL stored procedure with the
following error message:
<P>
<PRE>   "The query could not be debugged due to a problem coordinating events
   with the server. Check the server and client log to find the exact
   cause, fix the problem and try again."

</PRE>The Event Viewer log on the server reveals the following error message:
<P>
<PRE>   "CreateDispatch failed (Class not registered). Check to make sure
   Automation manager is running on debugger machine."

</PRE><h2>CAUSE</h2>
 
<P>
When installing the T-SQL Debugger client-side component, Visual Basic
will create several Registry keys for VBSDISERVR.SDIEVENT under
HKEY_CLASSES_ROOT in the Registry. The \LocalServer32 key for
VBSDISERVR.SDIEVENT's CLSID is one of them that is being used by the local
SQL debugging. When doing remote debugging from another computer, this key
is deleted and some other keys for inprocServer are created. If you do
local SQL Debugging after a remote SQL debugging session has been
performed, Automation Manager will not be able to find the \LocalServer32
key in the Registry, resulting in the above error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can add the LocalServer32 key manually in REGEDT32.EXE to enable the
next local SQL debugging. However, this key will be deleted again after
another remote SQL debugging.
<P>
<P><h3>Steps to Add the LocalServer32 Key:</h3>
 

<OL><P><LI>Start the Registry Editor by running regedt32.exe.

<P><LI>In Registry Editor, select
   HKEY_CLASSES_ROOTS\CLSID\{124765AA-7866-11CF-BF3B-00A0D10003FA}\.

<P><LI>Choose Edit\AddKey on the menu and type "LocalServer32" as Key Name.

<P><LI>Add the following value for LocalServer32 by choosing Edit\AddValue from
   the menu:
<P>
<PRE>      Value Name:                     (Leave it empty)
      Data Type: REG_SZ
      String: C:\Program Files\DevStudio\VB\Tsql\vbsdicli.exe

   Note: Make sure you have an appropriate path for your vbsdicli.exe.

</PRE></OL>You can also add this Registry key in Visual Basic code by calling the
Registry API. Please refer to the following article in the Microsoft
Knowledge Base for how to implement this:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q145679.htm">Q145679</A></B>
   TITLE: HOWTO: Use the Registry API to Save and Retrieve Setting

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem only occurs with local debugging. It doesn't happen during
remote debugging.
 
<PRE>Keywords          : vb5all
Version           : 5.0 97
Platform          : NT WINDOWS
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
