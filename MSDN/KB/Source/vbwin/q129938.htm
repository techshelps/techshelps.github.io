

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Moving Off 'Sub' Doesn't Create 'End Sub' </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129938">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbenv kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you use the mouse or arrow keys to move off the statement:     Sub X ()  the End Sub statement is not generated, and the Sub X() statement appears as part of the subroutine that follows it.  CAUSE =====  This is by design. The purpose of this be...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFF,QAUD,QBS0,QAVX,QAVW,QAPN,QAB9,QANJ,QBVV,QA9N,QAEF,QACI,QBXT,QA5V,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Moving Off 'Sub' Doesn't Create 'End Sub'</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129938</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the mouse or arrow keys to move off the statement:
<P>
<PRE>   Sub X ()

</PRE>the End Sub statement is not generated, and the Sub X() statement appears
as part of the subroutine that follows it.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is by design. The purpose of this behavior is to give you control over
whether or not an End Sub is automatically generated. There are cases when
it is desirable not to have an End Sub generated.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Leaving the Sub line by pressing the ENTER key automatically generates
the appropriate End Sub. This also adds the End Sub where one did
not exist if you previously left the line by using the mouse or arrow keys.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Visual Basic version 4.0 supports conditional compilation and you may want
to take advantage of that to create more than one Sub statement for a
single subroutine depending on various conditions.
<P>
<PRE>   #if WIN32 then
   Sub MySubWin32version(x)
   #else
   Sub MySubWin16version(x,y)
   #endif

      ' ...
   End Sub

</PRE>In this case, you would not want two End Sub statements generated for your
two Sub statements. If you move off the first Sub statement with the ENTER
key and the second Sub statement with the mouse or arrows, this procedure
is generated correctly. As Visual Basic cannot anticipate which case will
require End Sub and which will not, you are given explicit control.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Type the following line of code in the General Declarations section of
   Form1, but don't press the ENTER key:
<P>
<PRE>   Sub Test()

</PRE><P><LI>Use the mouse or arrow keys to move off the line. Sub Test does not get
   its own End Sub statement, but rather it is merged with the next Sub
   statement as in this example:
<P>
<PRE>   Sub Test()
   Private Sub Form_Load()

   End Sub

</PRE><P><LI>To add an End Sub, move to the end of the Sub Test() line, and press the
   ENTER key to separate the Sub Test() procedure from the Sub Form_Load()
   procedure:
<P>
<PRE>   Sub Test()

   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbenv kbprg kbprb<BR>
KBSubcategory: EnvtDes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
