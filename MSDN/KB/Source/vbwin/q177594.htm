

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Bypass Login Prompt When Opening Linked Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177594">
<META NAME="KBModify" CONTENT="1997/12/08">
<META NAME="KBCreate" CONTENT="1997/12/03">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all vb5howto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  In Access, when you first link (attach) an external table using an ODBC driver, you have the option to store the User ID and password for the table locally. If you do not store the ID and password locally, you will be prompted later for such inform...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QANE,QBS0,QDKY,QDN9,QAZV,QACF,QBXS,QAWK,QAGU,QA4H,QAFX,QABM,QA5B,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Bypass Login Prompt When Opening Linked Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177594</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions, 16-bit and
   32-bit, for Windows, version 4.0
<LI>Microsoft Visual Basic Professional Edition for Windows, version 3.0
<LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Access, when you first link (attach) an external table using an ODBC
driver, you have the option to store the User ID and password for the table
locally. If you do not store the ID and password locally, you will be
prompted later for such information when you open the table.
<P>
This article demonstrates how to bypass the Login prompt when you open an
Access linked table by pre-connecting to the database and providing User ID
and password programmatically in Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Jet database engine caches authentication information for
each DSN. This prevents users from being prompted to login to remote
databases each time a table is opened. You can take advantage of this
behavior by pre-connecting to the database directly and programmatically
providing user ID and password to prevent the login prompt from appearing
when opening linked tables that don't have the user ID and password cached.

<OL><P><LI>In Access, create a new database, db1.mdb, and a linked table,
   dbo_authors, from SQL Server Pubs database.
<P>
</OL>2a. In Visual Basic, start a new project and choose "Standard EXE." Form1
<PRE>    is created by default.

</PRE></OL>2b. In Access, create a new database and create a new form (Form1).

<OL><P><LI>In Visual Basic 4.0 and later, add a Reference to:
<P>
<PRE>   Microsoft Data Access Object 2.x   (VB4 16-bit)
   Microsoft Data Access Object 3.x   (VB4 32-bit; VB5)

</PRE><P><LI>Paste the following code in the General Declarations section of Form1:
<P>
<PRE>      Sub Command1_Click()
         Dim db1 As Database
         Dim db2 As Database
         Dim rs As Recordset
         Dim strConnect As String

         '*** You have to modify the path to where db1.mdb is located
         Set db1 = OpenDatabase("C:\MyTest\db1.mdb")
         strConnect = UCase(db1.TableDefs("dbo_authors").Connect) &amp; _
                      ";UID=sa;PWD=;"
         Set db2 = OpenDatabase("", False, False, strConnect)
         db2.Close
         Set db2 = Nothing
         Set rs = db1.OpenRecordset("dbo_authors")
         Debug.Print rs(0)
         Debug.Print "Recordset Opened Successfully"
         rs.Close
         db1.Close
         Set rs = Nothing
         Set db1 = Nothing
         Set DBEngine = Nothing
      End Sub

</PRE></OL>NOTES:

<OL><P><LI>You must provide correct login information, User ID and Password, in
   strConnect to establish the connection.

<P><LI>If you know which DSN the table is linked to, you can hard-code the
   value of strConnect.

<P><LI>The Microsoft Jet database engine will first try to log you in with the
   same user ID and password that you log into the Jet database with
   (default is Admin/no password). If you make the local login match the
   server login, you will not get any login prompts.

<P><LI>Microsoft SQL Server can integrate its security mechanism with Microsoft
   NT domain accounts. If the user has a valid account in the domain, you
   will not get any login prompts.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
See "Managing Connection Resources, Preconnecting" in the Microsoft Jet
Database Engine Programmer's Guide, Chapter 9, Developing Client/Server
Applications
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Adrian Chiang, Microsoft Corporation
 
<PRE>Keywords          : VB4ALL VB4WIN vb5all vb5howto
Version           : WINDOWS:1.0,1.1,2.0,3.0,4.0,5.0,7.0,97
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
