

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Set Up Desktop Computer for Developing Pen Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121097">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/09/26">
<META NAME="Keywords" CONTENT="kbreadme kbprg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The PENCNTRL.VBX custom control provides an easy method for developing pen- based applications. However, this control will not load unless Windows for Pen Computing is detected on your computer. This article explains how to use the Microsoft Window...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBHF,QBWQ,QAA1,QDI2,QAU9,QAJH,QAE5,QAGQ,QDNN,QAB5,QAGI,QAJG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Set Up Desktop Computer for Developing Pen Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121097</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The PENCNTRL.VBX custom control provides an easy method for developing pen-
based applications. However, this control will not load unless Windows for
Pen Computing is detected on your computer. This article explains how to
use the Microsoft Windows Software Development Kit (SDK) to develop pen-
based applications without having to install Windows for Pen Computing.
<P>
The More Information section below contains the first four sections of the
README.TXT provided with the Microsoft Windows SDK. It tells you how to
configure your computer to provide basic Pen functionality. To make use of
this information, you must have either the Microsoft Windows Software
Development Kit or Microsoft Visual C++ Profession Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information is from the README.TXT file included with
Microsoft Windows for Pen Computing Files. This file contains the following
information regarding building Microsoft Windows for Pen Computing
applications:
<P>
I.   Introduction
II.  Hardware Requirements and Basic Limitations
III. Installation Notes and Procedures
IV.  Shipping PENWIN.DLL with your application
<P>
<P><h2>I. Introduction</h2>
 
<P>
The Windows SDK contains sufficient components from Windows for Pen
Computing to allow the application designer to build and test pen
applications. The Microsoft Mouse can be used to get a rough idea of how
recognition and a pen will work.
<P>
However, it is strongly recommended that Windows for Pen Computing hardware
in the form of a computer or peripheral device be used during the design
and development process. This is critical because a pen gives the
application designer an accurate feeling for how an application will work
in real situations and because the Microsoft Alphanumeric Recognition
System shipped with the Windows SDK has been optimized for a pen and will
work less well with a mouse.
<P>
<P><h2>II. Hardware Requirements and Basic Limitations</h2>
 

<OL><P><LI>A driver for the Microsoft Mouse has been provided so that simple
   testing of pen functionalities can be done. This pen driver is called
   MSMOUSE.DRV.

<P><LI>At this time, only VGA displays can be used with the pen extensions. The
   VGAP.DRV display driver is a modified version of the VGA.DRV that
   supports inking. It is required if the pen functionalities are to be
   tested.

<P><LI>Handwriting recognition with the Microsoft Mouse will achieve poor
   results in comparison to digitizer hardware designed specifically for
   Pen Computing. The recognizer has been designed to work with pen
   computers and peripherals with true digitizer input and its associated
   high data rates and high data resolution.

<P><LI>The spell checking technology included in Windows for Pens may be used
   exclusively for the purpose of improving handwriting recognition. It is
   not to be used by applications as a spell checker or spelling corrector.
<P>
</OL><h2>III. Installation Notes and Procedures  (***** READ THIS *****)</h2>
 
<P>
<P><h3>Installing the Pen Components - Minimum</h3>
 
<P>
This procedure will result in a system that will let you build applications
that contain hedit and bedit controls - and call any of the Windows for Pen
Computing APIs. You will not be able to perform handwriting recognition or
see ink on the screen.
<P>
SYSTEM.INI Changes:
<P>
Add or change the following items in your SYSTEM.INI file so that the pen
extensions will work.
<P>
NOTE: Back up your old SYSTEM.INI file before proceeding.

<OL><P><LI>In the "[boot]" section:
<P>
   a. Add "penwindows" to the list of drivers after the "drivers=" key.
<P><PRE>      For example:
</PRE><P>
<P><PRE>      drivers=mmsystem.dll penwindows
</PRE>
<P><LI>In the "[Drivers]" section:
<P>
   a. Add a new item "penwindows" and set it equal to the path to
<P><PRE>      PENWIN.DLL. For example:
</PRE><P>
<P><PRE>      penwindows=C:\MSVC\REDIST\PENWIN.DLL
</PRE><P>
</OL>When Windows is restarted, PENWIN.DLL will be loaded as an installed driver
and you will be able to run applications containing bedit and hedit
controls and call the Windows for Pen Computing APIs.
<P>
<P><h3>Installing the Pen Components - Complete</h3>
 
<P>
This procedure will result in a system that will run pen applications and
allow you to experiment with handwriting recognition and inking
functionalities in your applications. Once again, interaction with the
mouse will prove inferior in every respect to interaction with a true pen
device - but this system of using the special mouse driver will allow you
to experiment and perform rudimentary testing of your pen functionalities.
<P>
SYSTEM.INI Changes:
<P>
Add or change the following items in your SYSTEM.INI file so that the pen
extensions will work.
<P>
NOTE: Back up your old SYSTEM.INI file before proceeding.

<OL><P><LI>In the "[boot]" section:
<P>
   a. Change the "display.drv=" line so that the display driver is the pen
<P><PRE>      capable VGAP.DRV driver shipped with the Windows SDK. For example:
</PRE><P>
<P><PRE>      display.drv=C:\MSVC\PEN\VGAP.DRV
</PRE><P>
<P><PRE>      NOTE: Only the VGA display device is supported by the pen components
      in the Windows SDK.
</PRE><P>
   b. Add "pen penwindows" to the list of drivers after the "drivers=" key.
<P><PRE>      For example:
</PRE><P>
<P><PRE>      drivers=mmsystem.dll pen penwindows
</PRE><P>
   c. Change the "mouse.drv=" line so that it points to YESMOUSE.DRV.
<P><PRE>      For example:
</PRE><P>
<P><PRE>      mouse.drv=C:\MSVC\PEN\YESMOUSE.DRV
</PRE>
<P><LI>In the "[Drivers]" section:
<P>
   a. Add a new item "pen" and set it equal to the path to MSMOUSE.DRV.
<P><PRE>      For example:
</PRE><P>
<P><PRE>      pen=C:\MSVC\PEN\MSMOUSE.DRV
</PRE><P>
   b. Add a new item "penwindows" and set it equal to the path to
<P><PRE>      PENWIN.DLL. For example:
</PRE><P>
<P><PRE>      penwindows=C:\MSVC\REDIST\PENWIN.DLL
</PRE><P>
</OL>PENWIN.INI Changes:
<P>
The PENWIN.INI file contains a number of initialization settings for
Windows for Pen Computing.
<P>
There are also two explicit paths that must correctly identify the
locations of MARS.DLL and MARS.MOB. The Windows SDK installation procedure
did not update these paths for users who chose to install to a directory
other than the default, so you need to update them by hand.
<P>
Open PENWIN.INI with any generic text editor (like Windows Notepad) and
change the path to MARS.DLL so that it correctly identifies and points to
the current MARS.DLL location. Do the same for MARS.MOB.
<P>
Once the paths are correct, copy the file to the Windows version 3.1 root -
that is, the directory containing the Windows version 3.1 WIN.COM file.
<P>
IV. Shipping PENWIN.DLL with your application
 
<P>
PENWIN.DLL is a fully redistributable component of Windows for Pen
Computing. Because applications will seek to leverage the Pen API - hedit
and bedit controls in particular - PENWIN.DLL can be shipped with your
application. There are some considerations to keep in mind in shipping
PENWIN.DLL with your application:

<OL><P><LI>PENWIN.DLL functions only under Windows version 3.1. It will not work
   with Windows version 3.0 because it functions only as an installable
   device driver - a feature not present in Windows version 3.0.

<P><LI>As with other redistributable components such as COMMDLG.DLL and the OLE
   libraries, it is the responsibility of the application vendor to
   determine whether PENWIN.DLL has already been installed (there is a
   GetSystemMetrics() call for this) and to ensure that the version of
   PENWIN.DLL with the latest version stamping is the one that is running.
   These issues are the same for all redistributable components, and
   further information is contained elsewhere in the SDK.

<P><LI>Unlike some of the other redistributable components, if your application
   installs PENWIN.DLL for the first time, or replaces the current version
   with a later one, Windows will have to be restarted. As an installable
   driver PENWIN.DLL can be loaded only at Windows boot time. Restarting
   Windows can be accomplished by using an ExitWindows() call or by simply
   prompting the user to restart Windows.
<P>
   NOTE: To install PENWIN.DLL on a Windows 3.1 system follow the "Minimum"
   procedure listed above.

<P><LI>PENWIN.DLL may be in either the \WINDOWS or the \WINDOWS\SYSTEM
   directory. The default will be \WINDOWS but because Windows for Pen
   Computing is an OEM product. Microsoft cannot completely control where
   PENWIN.DLL is located on a particular machine.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00<BR>
KBCategory: kbreadme kbprg kbinterop<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
