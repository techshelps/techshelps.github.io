

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Pass a NULL String to a Windows API from Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162622">
<META NAME="KBModify" CONTENT="1997/03/26">
<META NAME="KBCreate" CONTENT="1997/01/24">
<META NAME="Keywords" CONTENT="kbusage PrgOther VB5All vb5howto kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes how to pass NULL as a parameter to any Windows API function that requires a pointer to a string from a Visual Basic 4.0 or 5.0 application.  MORE INFORMATION  Many Windows APIs have pointers to strings (for example, LPSTR or ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAD7,QAH7,QAH6,QAJQ,QDL9,QBWQ,QBWO,QBWN,QATX,QA5F,QAO3,QAO2,QAMA,QAHE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Pass a NULL String to a Windows API from Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162622</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional,
   Enterprise Editions for Windows, version 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to pass NULL as a parameter to any Windows API
function that requires a pointer to a string from a Visual Basic 4.0 or 5.0
application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Many Windows APIs have pointers to strings (for example, LPSTR or LPCSTR)
in their parameter lists. The documentation often indicates that special
processing occurs if a NULL is passed (instead of a pointer to a string).
With earlier versions of Visual Basic, you could accomplish this by using
0&amp; for the parameter. However, Visual Basic 4.0 and 5.0 include a special
constant, vbNullString, that you can use when you need to pass NULL to a
Windows API.
<P>
For example, here's the declaration for the Win32 function FindWindow that
accepts two pointers to strings:
<P>
<PRE>      HWND FindWindow(
          LPCTSTR lpClassName,   // pointer to class name
          LPCTSTR lpWindowName   // pointer to window name
          );

</PRE>If NULL is passed as the second parameter, FindWindow locates any window of
the specified class name. In a C or C++ program, the call might look like
this:
<P>
<PRE>      hRet = FindWindow("MyWindowClass", NULL);

</PRE>If you make the same call from Visual Basic, it looks like this:
<P>
<PRE>      hRet = FindWindow("MyWindowClass", vbNullString)

</PRE>Note that using vbNullString is equivalent to passing NULL as the
parameter. This is not the same as passing an empty string ("").
<P>
<P><h2>REFERENCES</h2>
 
<P>
Visual Basic Help file, versions 4.0, 5.0; Topic: "Declare Statement"
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage PrgOther VB5All vb5howto kbhowto<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 26, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
