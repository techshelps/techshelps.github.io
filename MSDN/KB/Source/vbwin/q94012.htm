

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Visual Basic MCI Control TimeFormat Property Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94012 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/12/22">
<META NAME="Keywords" CONTENT="kbprg kbdocerr kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Multimedia Device Control (MCI.VBX) TimeFormat property does not support all format settings with all device types. When you assign a value to TimeFormat that is not supported by the device, the TimeFormat retains its previous setting.  This ar...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QALG,QAMA,QAB5,QA5B,QAPN,QBAO,QA7O,QAOE,QAMN,QAKD,QABA,QA5F,QAY4,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Visual Basic MCI Control TimeFormat Property Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94012 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>The Microsoft Professional Toolkit for Microsoft Visual Basic
   programming system for Windows, version 1.0
<LI>The Professional Edition of Microsoft Visual Basic for Windows,
   version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Multimedia Device Control (MCI.VBX) TimeFormat property does not
support all format settings with all device types. When you assign a value
to TimeFormat that is not supported by the device, the TimeFormat retains
its previous setting.
<P>
This article also describes MCI_FORMAT_MSF (2) and shows how to separate
the four bytes of a time value.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To determine if the current device supports a particular TimeFormat
setting, assign the value to TimeFormat. Then check TimeFormat to see if it
returns the value assigned. For example:
<P>
<PRE>   For i = 0 To 10
      MMControl1.TimeFormat = i
      If MMControl1.TimeFormat = i Then
         MsgBox Format$(i) + " supported"
      Else
         MsgBox Format$(i) + " not supported"
      End If
   Next

</PRE>Some of the time formats, such as MCI_FORMAT_TMSF, provide four separate
byte size numbers packed into one four byte long integer. The following
sample statements show how you can extract the four bytes into separate
variables:
<P>
<PRE>   byte1 =  MMControl1.Position And       &amp;HFF&amp;
   byte2 = (MMControl1.Position And     &amp;HFF00&amp;) \     &amp;H100
   byte3 = (MMControl1.Position And   &amp;HFF0000)  \   &amp;H10000
   byte4 = (MMControl1.Position And &amp;H7F000000)  \ &amp;H1000000
   If (MMControl1.Position And &amp;H80000000) &lt;&gt; 0 Then
      ' put sign bit back into byte4
      byte4 = byte4 + &amp;H80
   End If

</PRE>The least significant byte is stored in byte1 and the most significant byte
is stored in byte4.
<P>
The following list shows all possible settings for TimeFormat:
<P>
<PRE>    0  MCI_FORMAT_MILLISECONDS
    1  MCI_FORMAT_HMS
    2  MCI_FORMAT_MSF
    3  MCI_FORMAT_FRAMES
    4  MCI_FORMAT_SMPTE_24
    5  MCI_FORMAT_SMPTE_25
    6  MCI_FORMAT_SMPTE_30
    7  MCI_FORMAT_SMPTE_30DROP
    8  MCI_FORMAT_BYTES
    9  MCI_FORMAT_SAMPLES
   10  MCI_FORMAT_TMSF

</PRE>The TimeFormat setting MCI_FORMAT_MSF is described in the README.TXT file
but is missing from the "Microsoft Visual Basic Professional Features
Custom Control Reference" for version 2.0. The following description of
MCI_FORMAT_MSF appears in the README.TXT file:
<P>
2  MCI_FORMAT_MSF  Minutes, seconds, and frames are packed into a
<PRE>                   four-byte integer.  From least significant byte to
                   most significant byte, the individual data values
                   follow:

                   Minutes (least significant byte)
                   Seconds
                   Frames
                   Unused (most significant byte)

</PRE>The TimeFormat property affects the following properties.
<P>
<PRE>   Position
   From
   To
   Start
   Length
   TrackLength
   TrackPosition

</PRE>Microsoft has confirmed that this information should be included in the
"Microsoft Visual Basic Professional Features Custom Control Reference"
for version 2.0. We will post new information here when the documentation
has been updated with this additional information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 kbdocerr<BR>
KBCategory: kbprg kbdocerr kbcode<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
