

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: No Error Produced when Data Changed in DataControl </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119244">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/08/10">
<META NAME="Keywords" CONTENT="kbprg kbcode kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article describes a scenario where two or more Visual Basic applications using the Microsoft Jet 2.0/Visual Basic 3.0 Compatibility Layer to edit and update the same record at the same time fail to produce error message 3197:  Data has changed...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBT6,QBXS,QBV4,QAB4,QAN0,QAXB,QATR,QBJZ,QAJZ,QAHP,QA5F,QAMA,QAH4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: No Error Produced when Data Changed in DataControl</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119244</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
<LI>Microsoft Jet 2.0/Visual Basic 3.0 Compatibility Layer
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
This article describes a scenario where two or more Visual Basic
applications using the Microsoft Jet 2.0/Visual Basic 3.0 Compatibility
Layer to edit and update the same record at the same time fail to produce
error message 3197: "Data has changed; operation stopped."
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Standard and Professional
Editions of Visual Basic for Windows, version 3.0, and the Jet 2.0/Visual
Basic 3.0 Compatibility Layer. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>On a computer with the Visual Basic 3.0 Compatibility Layer installed,
   start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a text box (Text1), command button (Command1), and data control
   (Data1) to the form.

<P><LI>Set the following properties of each of the controls according to the
   table listed below:
<P>
<PRE>Control    Property       Setting      Comment
</PRE></OL> 
<PRE>Data1      DatabaseName  BIBLIO.MDB  Sample MDB in the VB directory.
Data1      RecordSource  Authors     The Authors table is in BIBLIO.MDB.
Text1      DataSource    Data1       Bind the text box to the data control.
Text1      DataField     Author      Put author's name in the text box.
Command1   Caption       Update      What the button does.

</PRE><P><LI>Place the following code in the Click() event for the command button:
<P>
<PRE>      Sub Command1_Click()
         Data1.RecordSet.Update
      End Sub

</PRE><P><LI>Choose Make EXE File from the File menu, and compile the program as
   "DATAERR.EXE". Choose OK.

<P><LI>Exit Visual Basic, saving and naming the .MAK and .FRM files. In the
   Program Manager, choose Run from the File menu. Type "C:\VB\DATAERR.EXE"
   in the prompt and choose OK. Repeat this step so that you have two
   instances of the application running.

<P><LI>In the first instance, make a change to the author's name and choose
   Update (do not choose the data control).

<P><LI>In the second instance, make a different change to the author's name and
   choose Update. Notice that you did not get error message 3197 "Data has
   changed; operation stopped" as you should have.
<P>
</OL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, add the following lines of code to your
Form_Load Event().
<P>
<PRE>   Data1.Refresh        'Make sure the DatabaseName and RecordSource
                        'properties are set before you do this.
   Data1.RecordSet.Edit
   Data1.RecordSet.Update
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode kbbuglist<BR>
KBSubcategory: APrgDataAcc
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
