

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Manipulate File Shares with ADSI (VB Sample) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169398">
<META NAME="KBModify" CONTENT="1997/06/02">
<META NAME="KBCreate" CONTENT="1997/05/30">
<META NAME="Keywords" CONTENT="vb4win kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can use ADSI to manipulate file shares as shown in the Visual Basic sample code below.  MORE INFORMATION  You must install the ADSI runtime (ADS.EXE) available from www.microsoft.com/ntserver/info/adsi.htm, and then add a reference to Active DS...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3A,QA0K,QA9A,QBS0,QANF,QAH4,QDL9,QBWO,QBWN,QBW3,QBXS,QAW6,QAR7,QAPN,QBWD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Manipulate File Shares with ADSI (VB Sample)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169398</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions
   for Windows, version 4.0
<LI>Microsoft Windows 95
<LI>Microsoft Windows NT version 4.0
   on the following platforms: Alpha, MIPS, x86
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use ADSI to manipulate file shares as shown in the Visual Basic
sample code below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You must install the ADSI runtime (ADS.EXE) available from
www.microsoft.com/ntserver/info/adsi.htm, and then add a reference to
Active DS Type Library.
<P>
The following code first gets a fileshare object on a server and reads its
path property. Then it gets a fileservice object on a server, uses it to
enumerate the shares on the server, creates a new share \\SERVER\newshare
for C:\, and deletes the share it just created. You can omit the DOMAIN\ in
the code below, but you may see some performance degradation caused by
additional browsing to find the SERVER:
<P>
<PRE>   Sub foo()

   Dim comp As IADsComputer
   Dim serv As IADsService
   Dim fserv As IADsContainer
   Dim share As IADsFileShare
   Dim shareNew As IADsFileShare
   Dim v As Variant

   ' Replace DOMAIN, SERVER &amp; SHARE with the appropriate
   ' domain, server  and share names
   Set share = GetObject("WinNT://DOMAIN/SERVER/lanmanserver/SHARE")
   v = share.Path ' Gets directory path on server
   Set share = nothing

   ' Replace DOMAIN &amp; SERVER with the appropriate domain and server names
   Set fserv = GetObject("WinNT://DOMAIN/SERVER/lanmanserver")

   ' Enumerate existing shares
   For Each share In fserv
     v = share.Class
     v = share.ADsPath
     v = share.HostComputer
     v = share.Path
   Next share

   ' Create share in fileservice container
   Set shareNew = fserv.Create("fileshare", "newshare")
   shareNew.Path = "C:\"
   shareNew.SetInfo  ' Commit new share

   ' Delete share
   fserv.Delete "fileshare", "newshare"

   ' Fails since share is gone
   shareNew.GetInfo

   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
www.microsoft.com/ntserver/info/adsi.htm
<P>
ADSI specification document from the ADSI SDK
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : vb4win kbhowto<BR>
Version             : 4.0 95<BR>
Platform            : NT Win95 WINDOWS<BR>
Hardware            : ALPHA MIPS x86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 2, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
