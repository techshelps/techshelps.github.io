

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Button Image on the Toolbar Appears Incomplete </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138820">
<META NAME="KBModify" CONTENT="1996/05/07">
<META NAME="KBCreate" CONTENT="1995/10/29">
<META NAME="Keywords" CONTENT="kbusage kbprb kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Some portions of the image on a toolbar button do not appear and as a result the button image appears incomplete.  CAUSE =====  By default, the MaskColor property of the ImageList control is set to black. This causes the black portions of images on...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5D,QAPN,QBS0,QAG9,QANS,QAF0,QA7O,QAOE,QAMN,QAB5,QBWS,QAPG,QAJD,QBVV,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Button Image on the Toolbar Appears Incomplete</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138820</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Some portions of the image on a toolbar button do not appear and as a
result the button image appears incomplete.
<P>
<P><h2>CAUSE</h2>
 
<P>
By default, the MaskColor property of the ImageList control is set to
black. This causes the black portions of images on toolbar buttons (or any
other control that uses an ImageList) to be masked out and not appear.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the color dialog box that appears when you change a color property to
change the MaskColor property of the ImageList that is bound to the toolbar
to color other than black. Toolbar buttons that have already been created
will not change color at design time unless they are refreshed by having
one of their properties modified. However, all buttons will appear
correctly at run time.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. This problem has been corrected in
the Visual Basic version 4.0a for Windows synchronization release.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Double-click the Toolbar button in the toolbox to create a new instance
   of the Toolbar control, called Toolbar1.

<P><LI>Double-click the ImageList button in the toolbox to create a new
   instance of the ImageList control, called ImageList1.

<P><LI>Right-click the toolbar control to bring up the Properties dialog box.
   Change the ImageList property in the General tab to ImageList1. Click
   the Buttons tab, and click Insert Button to add a button to the toolbar.

<P><LI>Right-click the ImageList control to bring up its properties. Click the
   Images tab, and then click Insert Picture to insert a button image.
   (Look in \Vb\Bitmaps\Tlbr_w95 for sample bitmaps.)

<P><LI>Right-click Toolbar1, and then click the Buttons Tab. The Image property
   of the first button is set to 0 by default. Change it to a value of 1 to
   link the first button with the first image in ImageList1.
<P>
</OL>The image you have selected will appear on the toolbar; however, all black
portions of the button will be masked out and will not appear. To fix
this, change the MaskColor property of ImageList1 to a value other than
black (remember that changes will only take effect if the toolbar is
refreshed or if the program is run).
<P>
Every image in an ImageList collection has a corresponding mask associated
with it. The mask is a monochrome image derived from the image itself,
automatically generated using the MaskColor property as the specific color
of the mask. This mask is not used directly, but is applied to the original
bitmap in graphical operations such as the Overlay and Draw methods. For
example, the MaskColor property determines which color of an image will be
transparent in the Overlay method.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Custom Control Reference in the Visual Basic version 4.0 Help file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.00a ImageList MaskColor vb4all vb4win<BR>
KBCategory: kbusage kbprb kbbuglist kbfixlist<BR>
KBSubcategory: PrgCtrlsStd
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
