

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Setting Add Watch May Cause GP Fault or UAE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94292 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/01/04">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You may encounter the error message,  Module has changed; must reset  after which the program ends and returns to design mode. Setting a watch point contributes to the problem. In one case, you may receive the error and then get a general protectio...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QATK,QATL,QBKN,QBXS,QBC9,QBC8,QANO,QBWS,QAH4,QAY2,QAMN,QAB4,QAO4,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Setting Add Watch May Cause GP Fault or UAE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94292 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
WINDOWS
kbenv kbbuglist
<P>
 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 2.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may encounter the error message, "Module has changed; must reset"
after which the program ends and returns to design mode. Setting a
watch point contributes to the problem. In one case, you may receive
the error and then get a general protection (GP) fault or an unrecoverable
application error (UAE).
<P>
In general, this problem occurs under the following conditions:

<UL><LI>A global, form, or module-level watch point is set.
<LI>The watch point refers to a Visual Basic object such as a form or
   control.
<LI>The watch point is evaluated from break mode when a modal form is
   showing.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Visual Basic
version 2.0 for Windows. This problem was corrected in Microsoft Visual
Basic version 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps reproduce the problem:

<OL><P><LI>Run Visual Basic, or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running.

<P><LI>From the File menu, choose New form (ALT, F, F). Form2 will be created.

<P><LI>Add the following code to the Form_Click event procedure of Form1:
<P>
<PRE>       Sub Form_Click ()
          Form2.Show 1    '** Show the form modal
       End Sub

</PRE><P><LI>From the Debug menu, choose Add watch (ALT, D, A).

<P><LI>From the Add Watch dialog, add the expression Forms.Count, select
   the Form/Module context option for Form1.Frm, and choose the OK
   button.

<P><LI>Add the following code to the Form_Click event procedure of
   Form2, and press the F9 key to set a break point on the End Sub
   statement.
<P>
<PRE>      Sub Form_Click()
         Form2.Hide
      End Sub      '** Set the break point on this line, press F9

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S) or press the F5 key to run
   the sample program.

<P><LI>Click in the Form1 form. Form2 will be displayed.

<P><LI>From the Debug menu, choose Break (ALT, D, K) or press CTRL+BREAK
   to break execution. This causes the watch expression to be evaluated.

<P><LI>From the Run menu, choose Continue (ALT, R, C) or press the F5 key
<P><PRE>    to continue.
</PRE>
<P><LI>Click in the Form2 form. The click event of the Form2 form will cause
<P><PRE>    execution to break.
</PRE>
<P><LI>From the Debug menu, choose Single step (ALT, D, S) or press the F8
<P><PRE>    key to single step.
</PRE>
<P><LI>Repeat step 12 until you see the "Module has change; must reset" error
<P><PRE>    message.
</PRE>
<P><LI>Choose the OK button.
<P>
</OL>This results in a GP fault or UAE. In the case of a GP fault, the GP fault
normally occurs at address 0001:7F8A in module VB.EXE.
<P>
This problem also occurs if you select a global-level watch context in
step 5. However, the problem doesn't occur if you select a procedure-level
watch context in step 5.
<P>
To avoid the problem, either don't set a watch point on an expression that
contains a Visual Basic object or don't break execution while a modal form
is being shown.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 fixlist3.00 2.00 3.00 GPF<BR>
KBCategory: kbenv kbbuglist<BR>
KBSubcategory: EnvtDes<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
