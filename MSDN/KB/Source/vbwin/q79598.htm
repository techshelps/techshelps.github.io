

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Error Loading DLL" If VB .EXE Has Same Name as DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79598 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1991/12/30">
<META NAME="Keywords" CONTENT="kbenv kbprg kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you create a compiled executable program that has the same base name as a dynamic link library (DLL) that is called from the program, an  Error Loading DLL  message will be displayed when the compiled program attempts to call the DLL. If the DLL...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAJQ,QBS0,QAUJ,QDNN,QAJH,QAAP,QAB4,QABA,QARM,QDL9,QBWQ,QBWO,QBWN,QA5E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Error Loading DLL" If VB .EXE Has Same Name as DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79598 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create a compiled executable program that has the same base name as
a dynamic link library (DLL) that is called from the program, an "Error
Loading DLL" message will be displayed when the compiled program attempts
to call the DLL. If the DLL is loaded before the .EXE program is run (for
example, if the DLL is in use from another application), the executable
program will not run at all.
<P>
Similarly, if an .EXE program has the same name as a loaded device driver
(.DRV) and the driver is loaded before you run the .EXE program, your
executable program will not run. For example, if you name your executable
program TIMER.EXE, it will not run because Windows has already loaded a
device driver named TIMER.DRV.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs because Windows checks, by module name, to see if a
program is already loaded before it tries to execute that program. If the
requested module is already loaded, Windows creates another instance of
that module. Thus, attempting to load a DLL with the same module name as an
already executing program will fail (usually with the error "Error Loading
DLL"), and attempting to start an executable program with the same module
name as an already loaded DLL will not execute the program.
<P>
Because the module name for a DLL is often the same as the name of the DLL
itself (although this can be varied using the LIBRARY entry of the module
definition file used when creating the DLL), and the module name for a
compiled Visual Basic program is the same as the original base .EXE file
name, attempting to load a DLL and a Visual Basic .EXE program that share
the same name will often result in errors.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this problem, either recompile the Visual Basic program and change
the .EXE filename, or re-create the DLL, and change the LIBRARY entry in
the module definition file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. It can occur with any Windows-based
application, and may occur between any two Windows-based modules (either
from executable programs or DLLs).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbenv kbprg kbinterop kbprb<BR>
KBSubcategory: EnvtRun<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
