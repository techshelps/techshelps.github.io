

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Referential Integrity Enforced for DBs Created in Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104983">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/10/04">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Microsoft Visual Basic version 3.0 for Windows has no built-in features or properties that provide Referential Integrity. To make Visual Basic version 3.0 for Windows enforce referential integrity rules on a Microsoft Access database, build the dat...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA5V,QA1S,QDN9,QAPF,QAAP,QAB4,QA5F,QAMA,QAIB,QA5B,QDMH,QAZV,QBCT,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Referential Integrity Enforced for DBs Created in Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104983</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Visual Basic version 3.0 for Windows has no built-in features
or properties that provide Referential Integrity. To make Visual Basic
version 3.0 for Windows enforce referential integrity rules on a
Microsoft Access database, build the database in Microsoft Access. To
do this, open the Database window in Microsoft Access, and choose
Relationships... from the Edit menu. Then in the Relationships window,
select the Enforce Referential Integrity option.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information on the way Visual Basic version 3.0 handles and
enforces referential integrity, please refer to page 85 of "Professional
Features Book 2."
<P>
Visual Basic version 3.0 can enforce referential integrity between tables
as long as the Enforce Referential Integrity option was selected in
Microsoft Access. Visual Basic enforces these rules by providing certain
error codes when a database built in Microsoft Access has violated the
referential integrity rules in Visual Basic code. These are trappable
errors in Visual Basic, so you as the programmer have the option to
handle these violations as you wish.
<P>
Below are the possible errors you could get that refer to referential
integrity:

<UL><LI>Couldn't initialize data access because file 'SYSTEM.MDA' couldn't be
   opened.
<P>
   Error 3028
<P>
   In order to ensure referential integrity in databases created by
   Microsoft Access, Visual Basic must read the Access SYSTEM.MDA file.
   Make sure the file is in the location specified in the SystemDB entry
   in the [Options] section in the .INI file.

<LI>Can't delete or change record. Because related records exist in
   table 'Item', referential integrity rules would be violated.
<P>
   Error 3200
<P>
   You tried to perform an operation that would have violated referential
   integrity rules for related tables. For example, this error occurs if
   you try to delete or change a record in the "one" table in a one-to-many
   relationship when there are related records in the "many" table. If you
   want to delete or change the record, first delete the related records
   from the "many" table.

<LI>Can't add or change record. Referential integrity rules require a
   related record in table 'Item'.
<P>
   Error 3201
<P>
   You tried to perform an operation that would have violated referential
   integrity rules for related tables. For example, this error occurs if
   you try to change or insert a record in the "many" table in a
   one-to-many relationship, and that record doesn't have a related record
   in the table on the "one" side. If you want to add or change the record,
   first add a record to the "one" table that contains the same value for
   the matching field.
<P>
</UL>There is more information in the Visual Basic version 3.0 "Professional
Features Book 2" manual. Referential integrity implementation differences
between Microsoft Access and Visual Basic are described on page 119.
System table differences are explained on page 21, and using multiple
tables is described on page 85.
<P>
Dynaset objects can create an inconsistent dynaset with the DB_INCONSISTENT
flag. But it may be harder to keep referential integrity when this flag is
specified. See pages 58, 59, and 85 of "Professional Features Book 2."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: APrgDataAcc
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
