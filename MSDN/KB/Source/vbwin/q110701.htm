

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Get a Handle to MS-DOS Application and Change Title </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110701">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/01/27">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows by example how to get the handle to a MS-DOS application, and then use that handle to change the MS-DOS Window title or automatically unload the MS-DOS Window from Visual Basic.  MORE INFORMATION  Step-by-Step Example  1. Start a...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA4Q,QAH4,QBE7,QBE6,QBWS,QAUD,QAMB,QAFF,QAIJ,QAGB,QAJH,QANY,QAPN,QANF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Get a Handle to MS-DOS Application and Change Title</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110701</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows by example how to get the handle to a MS-DOS
application, and then use that handle to change the MS-DOS Window title or
automatically unload the MS-DOS Window from Visual Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add two command buttons (Command1 and Command2) to Form1.

<P><LI>Enter the following code in the General Declarations of a form or
   module:
<P>
<PRE>   ' Enter each of the following Declare statements on one, single line:
   Declare Function PostMessage Lib "User"
      (ByVal hWnd As Integer, ByVal wMsg As Integer,
      ByVal wParam As Integer, lParam As Any) As Integer
   Declare Sub SetWindowText Lib "User"
      (ByVal hWnd As Integer, ByVal lpString As String)
   Declare Function GetActiveWindow Lib "User" () As Integer
   Dim MhWnd as Integer
   Const WM_CLOSE = &amp;H10

</PRE><P><LI>Enter the following code in the Click Event of Command1:
<P>
<PRE>   Sub Command1_Click()
      Dim X as Integer
      X = Shell("c:\windows\dosprmpt.pif", 1) ' Open an MS-DOS Window
      For X = 0 To 100
         DoEvents
         ' a bunch of DOEVENTS to wait for the MS-DOS Window to open.
      Next X

      ' Get the handle when the MS-DOS Window has the focus:
      Mhwnd = GetActiveWindow()

      ' Now pass the handle to the window with a new title:
      Call SetWindowText(Mhwnd, "My Application!")
   End Sub

</PRE><P><LI>Place the following code in the Click Event of Command2:
<P>
<PRE>   Sub Command2_Click()
      Dim X as Integer
      ' Note: In order for this to work on a MS-DOS Window, you have
      ' to have a PIF setup that will allow an MS-DOS Window to be closed.
      ' In the PIF editor, select "Advanced", then click "Close When
      ' Active". This allows MS-DOS applications to be closed
      ' programatically
      X = PostMessage(MhWnd, WM_CLOSE, 0, 0) ' Return greater than zero
                                             ' if successful.
      If X = 0 Then
         MsgBox "Application did not close!"
      End If
   End Sub

</PRE><P><LI>Start the program, or press the F5 key.

<P><LI>Click the Command1 button to see the title change.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
