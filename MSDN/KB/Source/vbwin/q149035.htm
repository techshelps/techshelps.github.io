

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Use of 16-bit Client &amp; DAO Object Causes Error '8002802b' </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149035">
<META NAME="KBModify" CONTENT="1996/04/16">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Assigning a passed DAO object to a specific object variable fails with error  8002802b  when using the 16-bit edition of Microsoft Visual Basic version 4.0 for Windows. This error occurs on either the client or server side, if the DAO object in que...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAYL,QARL,QAH4,QAAP,QBS0,QBWS,QAB4,QASR,QAKP,QBXS,QA6A,QAY5,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Use of 16-bit Client &amp; DAO Object Causes Error '8002802b'</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149035</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Assigning a passed DAO object to a specific object variable fails with
error "8002802b" when using the 16-bit edition of Microsoft Visual Basic
version 4.0 for Windows. This error occurs on either the client or server
side, if the DAO object in question has been passed from the other
application.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Declare the variable(s) that hold the references to the passed object with
"As Object" instead of "As Database" or "As Recordset". The code that
manipulates these "As Object" variables does not need to change.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps To Reproduce Issue</h3>
 

<OL><P><LI>Create a minimal OLE server and a client that accesses the OLE server.
   To obtain step-by-step instructions on how to accomplish this
   functionality, please see the following article in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B>
<PRE>   TITLE     : How to Create and Use a Minimal OLE Automation Server

   For clarity purposes, the following steps assume a client and server
   created from the article referenced above. However, these steps can be
   implemented in any client and server to see the behavior described in
   this article.

</PRE><P><LI>Add this function to the class module in the server project:
<P>
<P><PRE>      Public Function GetDB() As Object
<PRE></PRE>         Set GetDB = OpenDatabase("Biblio.mdb")
      End Function

</PRE><P><LI>Press F5 or click Start on the Run menu to run the server application.

<P><LI>Change the Form_Click event in the client application to contain this
   code:
<P>
<P><PRE>      Private Sub Form_Click()
<PRE></PRE>         Dim x As Object
         Dim db As Database
         Dim rs As Recordset

         Set x = CreateObject("Project1.Class1")
         Set db = x.GetDB
         Set rs = db.OpenRecordset("Authors")
      End Sub

</PRE><P><LI>Press F5 or click Start on the Run menu to run the client application.
   Click on the form to execute the code added in step 4. The client
   returns the above mentioned error on the line calling the GetDB method
   of the server. If you change the declare for the db variable from
   "As Database" to "As Object" this line executes successfully. However,
   the next line fails with the same error, as the rs variable is
   declared "As Recordset." Changing the rs variable to "As Object"
   corrects this problem and the code runs to completion correctly.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataOther IAPOLE<BR>
Additional reference words: 4.00 vb4win vb416 buglist4.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
