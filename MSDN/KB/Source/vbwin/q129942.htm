

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Using TypeOf as Part of an If Statement Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129942">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Using TypeOf as part of an If statement fails when it is used it on a control that was passed to a server application.  CAUSE =====  To resolve the type of an object through the TypeOf interface, remoting is required for the actual control type. Ho...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QBV3,QAH4,QAFF,QAHP,QBJZ,QA01,QBWS,QBXS,QAB9,QBFY,QBE7,QBE6,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Using TypeOf as Part of an If Statement Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129942</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using TypeOf as part of an If statement fails when it is used it on a
control that was passed to a server application.
<P>
<P><h2>CAUSE</h2>
 
<P>
To resolve the type of an object through the TypeOf interface, remoting is
required for the actual control type. However, there is no remoting
capability for controls.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
MORE INFORMATION
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Develop and run a container and a server application:
<P>
<P><h3>Create the Container Application</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>From the Insert menu, choose Class Module to add Class1 to the project.

<P><LI>Set the properties of Class1 as follows:
<P>
<PRE>   Property      Value
   ------------------------------------
   Instancing    1-Creatable SingleUse
   Name          Class1
   Public        True

</PRE><P><LI>Add the following code to the general declarations section of Class1:
<P>
   Public Sub DataLoadList(c)
<P><PRE>      If TypeOf c Is ComboBox Then
<PRE></PRE>         MsgBox "ComboBox"
      Else
         MsgBox "Not a ComboBox"
      End If
   End Sub

</PRE><P><LI>From the File menu, choose Make EXE File, and name the executable as
   Project1.
<P>
</OL><h3>Create the Server Application</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the general declarations section of Form1:
<P>
<PRE>   Private Sub localcheck(c)
      If TypeOf c Is ComboBox Then
         MsgBox "ComboBox"
      Else
         MsgBox "Not a ComboBox"
      End If
   End Sub

</PRE><P><LI>Add two command buttons (Command1 and Command2) and a ComboBox to Form1.

<P><LI>Add the following code to the Command1_Click event procedure:
<P>
<PRE>   Private Sub Command2_Click()
      Call localcheck(Combo1)
   End Sub

</PRE><P><LI>Add the following code to the Command2_Click event procedure:
<P>
<PRE>   Private Sub Command1_Click()
      Dim x As Object
      Set x = CreateObject("Project1.Class1")
      Call x.DataLoadList(Combo1)
      Set x = Nothing
   End Sub

</PRE><P><LI>Run PROJECT1.EXE from Program Manager or File Manager.

<P><LI>Run Project2 from the Visual Basic design environment. Click the
   Command1 button for a local check of the TypeOf statement. The message
   "ComboBox" is displayed in a message box. Click the Command2 button to
   test the TypeOf statement across processes and the message "Not a
   ComboBox" is displayed in a message box.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
