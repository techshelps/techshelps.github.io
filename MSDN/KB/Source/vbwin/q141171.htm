

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: RDO Forward-Only Cursor Doesn't Allow MoveLast </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141171">
<META NAME="KBModify" CONTENT="1996/05/16">
<META NAME="KBCreate" CONTENT="1995/12/12">
<META NAME="Keywords" CONTENT="kbenv kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you try to use the MoveLast method on a forward-only remote data object recordset, you receive the error      S1106: [Microsoft][ODBC SQL Server Driver]Fetch type out of range .  Forward-only resultsets are the only type returned by the OpenResu...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA5V,QAPN,QBS0,QA9E,QAO2,QAUD,QANF,QAA7,QBWS,QAY5,QALQ,QAIJ,QAHE,QAC6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: RDO Forward-Only Cursor Doesn't Allow MoveLast</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141171</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic for Windows, 32-bit
   only, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you try to use the MoveLast method on a forward-only remote data object
recordset, you receive the error
<P>
<PRE>   "S1106: [Microsoft][ODBC SQL Server Driver]Fetch type out of range".

</PRE>Forward-only resultsets are the only type returned by the OpenResultset
method.
<P>
<P><h2>CAUSE</h2>
 
<P>
Forward-only cursors only allow the use of MoveNext methods. This is a
limitation of ODBC.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There is no direct way to implement an exact copy of MoveLast with code
when using a resultset with a forward-only cursor. The following code loops
through and touches all records in a resultset. When the loop finishes, the
current record will be the EOF marker.
<P>
<PRE>   'The following code loops through all the records in a resultset
   While Not rdoToMove.EOF
      'do any processing here
      rdoToMove.MoveNext
   Wend

</PRE>To determine the number of records in a resultset, code a loop like the one
above and increment a count variable inside the loop.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When RDO works with a forward-only resultset, it uses a call to the ODBC
API function SQLExtendedFetch to obtain data. As one of its parameters,
this function takes a value that specifies the type of fetch to be
performed. ODBC specifies that when a resultset has a forward-only cursor,
this fetch argument may only be SQL_FETCH_NEXT. If the argument is
something besides this constant, ODBC returns 'S1106: Fetch type out of
range,' indicating that the argument was invalid. For more information, see
the reference listed in the References section below.
<P>
<P><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Start Visual Basic.

<P><LI>On the File menu, click New Project.

<P><LI>Double-click the Command button icon in the Toolbox to create a command
   button on the form.

<P><LI>Insert the following code in the command button's Click event. Replace
   strDSN, strConnect, and strSQL with the relevant values for your
   database.
<P>
<PRE>   Private Sub Command1_Click()
             Dim ps As rdoPreparedStatement
             Dim conn As rdoConnection
             Dim strDSN As String
             Dim strConnect As String
             Dim strSQL As String

             strDSN = "pubs"
             strConnect = "uid=sa;pwd=;database=pubs"
             strSQL = "Select * From Authors"


             With rdoEnvironments(0)
                 .CursorDriver = rdUseOdbc
             Set conn = .OpenConnection _
               (strDSN, rdDriverNoPrompt, False, strConnect)
             End With
             Set ps = conn.CreatePreparedStatement("", strSQL)
             Set rs = ps.OpenResultset(rdOpenForwardOnly)

             rs.MoveLast      'this line causes the error

   End Sub

</PRE><P><LI>On the Run menu, click Start (ALT, R, S) or press the F5 key. The
   program will stop when it reaches the rs.Movelast line, and give the
   error listed above.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft ODBC 2.0 Programmer's Reference and SDK Guide: SQLExtendedFetch
function - return code S1106.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbenv kbprg kbprb<BR>
KBSubcategory: APrgDataODBC<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 16, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
