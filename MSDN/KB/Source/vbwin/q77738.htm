

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Extra Click Event If Double-Click When Mouse Button Down </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77738 ">
<META NAME="KBModify" CONTENT="1997/08/11">
<META NAME="KBCreate" CONTENT="1991/10/24">
<META NAME="Keywords" CONTENT="buglist3.00 PrgCtrlsStd buglist1.00 buglist2.00 kbbuglist kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When one mouse button is held down, double-clicking the other button generates one more Click event than necessary. The problem does not occur when double-clicking either mouse button individually.  STATUS ======  Microsoft has confirmed this to be...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAQ7,QBS0,QBWS,QAH4,QAO4,QAPN,QAHT,QAFF,QAOX,QAUD,QADX,QAKP,QA5D,QAE8,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Extra Click Event If Double-Click When Mouse Button Down</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77738 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versiona 2.0 and 3.0
<LI>Microsoft Visual Basic programming system for Windows, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When one mouse button is held down, double-clicking the other button
generates one more Click event than necessary. The problem does not occur
when double-clicking either mouse button individually.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code demonstrates that an extra Click event is generated
when double-clicking one mouse button while holding the other down.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic.

<P><LI>Double-click the form or press the F7 key to bring up the code window.
   Enter the following code in the Form_Click event procedure for Form1:
<P>
<PRE>   Private Sub Form_Click ()
      Print "Click"
   End Sub

</PRE><P><LI>Enter the following code in the Form_DblClick event procedure:
<P>
<PRE>   Private Sub Form_DblClick ()
      Print "DblClick"
   End Sub

</PRE><P><LI>Enter the following code in the Form_MouseDown event procedure:
<P>
<PRE>   ' Enter the following two lines as one, single line:
   Private Sub Form_MouseDown(Button As Integer, Shift As Integer,
      X As Single, Y As Single)
      Print "Down"; Button
   End Sub

</PRE><P><LI>Enter the following code in the Form_MouseUp event procedure:
<P>
<PRE>   ' Enter the following two lines as one, single line:
   Private Sub Form_MouseUp(Button As Integer, Shift As Integer,
      X As Single, Y As Single)
      Print "Up"; Button
   End Sub

</PRE><P><LI>From the Run menu, choose Start.

<P><LI>Using the right mouse button, double-click anywhere on the form. The
   output to Form1 should be:
<P>
   Down 2
   Up 2
   Click
   DblClick
   Up 2

<P><LI>Press and hold the left mouse button. The output to Form1 should be:
<P>
   Down 1

<P><LI>While holding the left mouse button down, double-click with the right
   mouse button. The output to Form1 should be:
<P>
   Down 2
   Up 2
   Click
   DblClick
   Up 2
   Click
<P>
</OL>The last Click was not generated when double-clicking with the right mouse
button alone (as illustrated in step 8 above). This additional call to the
Click event procedure is not expected behavior and is a problem with Visual
Basic. The problem also occurs when the right mouse button is held down and
you double-click the left mouse button.
<P>
<P>
 
<PRE>Keywords          : buglist3.00 PrgCtrlsStd buglist1.00 buglist2.00 kbbuglist kbtlc
Version           : 1.0 2.0 3.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
