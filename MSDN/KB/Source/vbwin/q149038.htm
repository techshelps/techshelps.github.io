

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: VB Registry Functions Are Limited with Nested Settings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149038">
<META NAME="KBModify" CONTENT="1996/04/11">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="kbprg PrgOther">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The SaveSetting statement and GetSetting function in Visual Basic 4.0 for Windows are used to create and retrieve information from nested levels in the Registry. However, the related DeleteSetting statement does not handle these nested settings. Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAEF,QAY5,QAB9,QAGI,QABA,QAJ8,QAH4,QBXS,QBV8,QDH6,QBAO,QA9N,QANJ,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: VB Registry Functions Are Limited with Nested Settings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 11, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149038</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows, 16-bit and 32-bit, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The SaveSetting statement and GetSetting function in Visual Basic 4.0 for
Windows are used to create and retrieve information from nested levels in
the Registry. However, the related DeleteSetting statement does not handle
these nested settings. The GetAllSettings function also has this
limitation.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Error 5 - Invalid Procedure Call appears when the DeleteSetting is
attempted.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. The ability to create and retrieve values from
nested levels in the registry was a fortunate byproduct of the design of
the set and get functions, and this wasn't extended to include all of the
related registry functions.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use more than one DeleteSetting statement to remove sections of the nested
keys before removing the top level key, rather than attempting to remove
the top key in isolation.
<P>
For example, in the following, do not use:
<P>
<PRE>   DeleteSetting "Test1"

</PRE>Instead, use the following two lines of code to remove the Test1 key and
its subkeys:
<P>
<PRE>   DeleteSetting "Test1\Test2"
   DeleteSetting "Test1"

</PRE>To enable all possible functionality, you can use the Registry API
functions to perform any desired operation manually.
<P>
For more information on the Registry API functions, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../vbapps/Q145679.htm">Q145679</A></B>
   TITLE     : How to Use the Registry API to Save and Retrieve Setting

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to reproduce problem</h3>
 

<OL><P><LI>Start Visual Basic 4.0, 32-bit version. Form1 is created by default.
   Place two command buttons on the form. Add the following code to Form1:
<P>
<PRE>   Private Sub Command1_Click()
       SaveSetting "Test1", "Test2\Test3", "TestKey", "TestValue"
   End Sub

   Private Sub Command2_Click()
       DeleteSetting "Test1"
   End Sub

</PRE><P><LI>On the Run menu, choose Start, or press F5 to begin the application.
   Choose Command1 to add the nested keys to the registry. Open the
   Registry Editor and confirm that the information has been correctly
   added under the key HKEY_CURRENT_USER\Software\VB and VBA Program
   Settings.

<P><LI>Return to the running application and choose Command2. VB will raise
   error 5 - Invalid Procedure Call. To view the workaround, stop the
   program and replace the single call to DeleteSetting with the two calls
   listed in the Workaround section above. Rerun the program and choose the
   second command button again. Use the Registry Editor to see that the
   keys have been removed correctly.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory: PrgOther<BR>
Additional reference words: 4.00 vb4win vb4all
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 11, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
