

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Force a DropDown and Retract of the List in a Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124057">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/12/18">
<META NAME="Keywords" CONTENT="kbprg kbui">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows you how to send a message to the Combo box to force the List portion to drop or retract at any time.  Usually, to drop the List portion of a Combo box, you click the dropdown button located to the right of the Combo's edit box, o...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV3,QAE1,QAHP,QAFF,QAH4,QACI,QA63,QA9N,QAPN,QAGC,QBS0,QBWS,QAEF,QA5D,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Force a DropDown and Retract of the List in a Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124057</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic
<PRE>  for Windows, versions 2.0 and  3.0
</PRE> 
<P>
SUMMARY
 
<P>
This article shows you how to send a message to the Combo box to force the
List portion to drop or retract at any time.
<P>
Usually, to drop the List portion of a Combo box, you click the dropdown
button located to the right of the Combo's edit box, or you can press the
F4 key when the control has the focus. To have the Combo box retract the
List portion, you click the dropdown button again, use the mouse or
keyboard to choose an item from the list, press the ESC or F4 key, or click
anywhere else on the screen.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To send the CB_SHOWDROPDOWN message to a Combo box of Style 0 - Dropdown
Combo or 2 - Dropdown List, call the SendMessage API function. If the
wParam parameter is any non-zero integer, the List will drop. If wParam
equals 0,  the List will retract. Note that a Combo box of Style 1 (Simple
Combo) always has its list visible.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic (ALT, F, N). Form1 is created by
   default.

<P><LI>Add the following statements to the General Declarations section of
   Form1:
<P>
<P>
<PRE>   ' Enter the following two lines as one, single line:
   Declare Function SendMessage Lib "User" (ByVal hWnd As Integer,
     ByVal wMsg As Integer, ByVal wParam As Integer, lParam As Any) As Long

   Const WM_USER = &amp;H400
   Const CB_SHOWDROPDOWN = (WM_USER + 15)

</PRE><P><LI>Add the following code to the Form's Load event:
<P>
<PRE>   Sub Form_Load ()
      combo1.AddItem "item# 1"
      combo1.AddItem "item# 2"
      combo1.AddItem "item# 3"
      combo1.AddItem "item# 4"
   End Sub

</PRE><P><LI>Place a Combo box (Combo1) on Form1.

<P><LI>Place a Command button (Command1) on Form1, and set its Caption property
   to DropDown.

<P><LI>Add the following code to the Command1 button's Click event:
<P>
<PRE>   Sub Command1_Click ()
      x% = SendMessage(combo1.hWnd, CB_SHOWDROPDOWN, 1, 0&amp;)
   End Sub

</PRE><P><LI>Place a second Command button (Command2) on Form1, and set its Caption
   property to Retract.

<P><LI>Add the following code to the Command2 button's Click event:
<P>
<PRE>   Sub Command2_Click ()
      x% = SendMessage(combo1.hWnd, CB_SHOWDROPDOWN, 0, 0&amp;)
   End Sub

</PRE><P><LI>Press the F5 key to run the program. Click the DropDown button to show
   the Combo box list, and click the Retract button to remove it.
<P>
</OL><h3>Notes</h3>
 
<P>
If the form is moved or resized while the List is down, the List will not
move with the form. To make it behave like the standard Combo Box, add the
following code to the Form's paint and resize events to force the
retraction of the list:
<P>
<PRE>   Sub Form_Paint ()
      x% = SendMessage(combo1.hWnd, CB_SHOWDROPDOWN, 0, 0&amp;)
   End Sub

   Sub Form_Resize ()
      x% = SendMessage(combo1.hWnd, CB_SHOWDROPDOWN, 0, 0&amp;)
   End Sub

</PRE></OL>You don't have to do this, if you want the List to be always on top, even
when the form is moved or resized. The List can be retracted only by
clicking the "Rectract" Button or choosing an item from the list.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00 ComboBox<BR>
KBCategory: kbprg kbui<BR>
KBSubCategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
