

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDE Conversation Can Cause Error Message: DDE Channel Locked </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95462 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/02/09">
<META NAME="Keywords" CONTENT="kbinterop kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The error message  DDE channel locked  indicates that an attempt is being made to open a DDE conversation between two objects that are already engaged in a conversation. However, usually the error message occurs in a Visual Basic application as a r...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB4,QAZ2,QA5F,QAMA,QAAP,QAEV,QBGP,QALZ,QAPN,QAYC,QBII,QA5E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DDE Conversation Can Cause Error Message: DDE Channel Locked</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95462 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The error message "DDE channel locked" indicates that an attempt is being
made to open a DDE conversation between two objects that are already
engaged in a conversation. However, usually the error message occurs in a
Visual Basic application as a result of a non-Visual Basic DDE Server
application failing to post or send a DDE message Visual Basic is
expecting.
<P>
The best overall solution is to alter the DDE server application so that it
correctly sends the appropriate DDE messages.
<P>
Both "DDE channel locked" and "Timeout while waiting for DDE response" are
errors that can be trapped in Visual Basic, so you can work around the
problem by performing the following steps:

<OL><P><LI>Turn on error trapping. For example:
<P>
<P><PRE>      On Local Error GoTo DDEerrhand:
</PRE>
<P><LI>In your error handling routine, trap error #284 ("DDE channel locked")
   and set the LinkTimeout property to 1. This triggers the error message
   "Timeout while waiting for DDE response" much quicker.

<P><LI>Also, in your error handling routine trap error #286 ("Timeout while
   waiting for DDE response"), reset the LinkTimeout value, re-establish
   the link, and execute a RESUME statement, as in this example:
<P>
<P><PRE>      DDEerrhand:
      Select Case Err
<PRE></PRE>         Case 284:
            OldLinkMode = Text1.LinkMode
            OldTimeout = Text1.LinkTimeout
            Text1.LinkTimeout = 1
            Resume
         Case 286:
            Text1.LinkTimeout = OldTimeout
            Text1.LinkMode = 0
            Text1.LinkMode = OldLinkMode
            Resume
       End Select

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
The DDE conversation guidelines set by the Windows Software Development Kit
(SDK) require that Visual Basic sometimes wait for an expected DDE message.
If that message is never correctly sent or posted to Visual Basic, the
following scenario is likely to occur, leading to the error message "DDE
channel locked":

<OL><P><LI>At some point between when Visual Basic established the conversation and
   the conversation terminated, the DDE server application fails to post or
   send a message that Visual Basic is expecting as a normal part of the
   DDE termination procedure.

<P><LI>At this point, Visual Basic is in a PeekMessage loop waiting for a
   message from the server indicating that the server application has also
   terminated the DDE conversation. Because Visual Basic is yielding the
   CPU inside the loop, the Visual Basic code continues to execute and the
   DDE conversation appears to have terminated normally from the server
   side.

<P><LI>Because Visual Basic is still waiting for the expected DDE message from
   the server application, the DDE channel is still open. Any attempt to
   reopen the channel (such as setting the LinkMode property for the
   control performing the DDE) results in a "DDE channel locked" error.
<P>
</OL>If no further DDE actions are attempted, you will receive a "Timeout while
waiting for DDE response" error message. The timeout will occur after a
number of milliseconds equal to the communicating control's LinkTimeout
property.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 errmsg<BR>
KBCategory: kbinterop kbprg<BR>
KBSubcategory: IAPDDE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
