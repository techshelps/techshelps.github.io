

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error 419 Occurs if RecordSet is Assigned to Data Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149041">
<META NAME="KBModify" CONTENT="1996/04/10">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Passing a Recordset object from a client to an OLE automation server (or vice versa) is allowed. However, this Recordset object cannot subsequently be assigned to a data control. Any attempt to do so results in error 419,  Permission to use object ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QARL,QAB5,QAIJ,QA9Q,QA7O,QAW6,QAOE,QAMN,QBS0,QBXS,QBE7,QBE6,QASR,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error 419 Occurs if RecordSet is Assigned to Data Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 10, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149041</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Passing a Recordset object from a client to an OLE automation server (or
vice versa) is allowed. However, this Recordset object cannot subsequently
be assigned to a data control. Any attempt to do so results in error 419,
"Permission to use object denied."
<P>
<P><h2>CAUSE</h2>
 
<P>
Notifications for the IConnectionPoint interface are not currently
marshaled by OLE, so setting the Recordset property of a data control
to a Recordset object that was passed in from another process fails
at some point during initialization. All properties and methods of the
Recordset object can be utilized normally, so code can be written to
access the passed Recordset object and perform all desired DAO operations.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to reproduce problem</h3>
 

<OL><P><LI>Create a minimal OLE server and a client that accesses the OLE server.
   Step-by-step instructions that describe this type of functionality can
   be found in the following article in the Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B>
<PRE>   TITLE     : How to Create and Use a Minimal OLE Automation Server

   The following steps assume a client and server created from <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B> for
   clarity purposes. However, the following steps can be implemented in any
   client and server to see the behavior described in this article.

</PRE><P><LI>In the server project, add a form by clicking Form on the Insert menu.
   On this new form, place a single data control.

<P><LI>Add the following procedure to Class1 (assuming the form added in step
   2 is named Form1):
<P>
<P><PRE>      Public Sub SetRecordset(x As Recordset)
<PRE></PRE>         Set Form1.Data1.Recordset = x
      End Sub

</PRE><P><LI>Press F5 or click Start on the Run menu to start the OLE server.

<P><LI>Load the client into another instance of Visual Basic.

<P><LI>Add a single data control to Form1 of the client. Set the properties of
   the data control to the following:
<P>
<P><PRE>      DatabaseName = BIBLIO.MDB
      RecordSource = Authors
</PRE>
<P><LI>Change the Form_Click event to contain the following code:
<P>
<P><PRE>      Private Sub Form_Click()
<PRE></PRE>         Dim x As Object
         Set x = CreateObject("Project1.Class1")
         Data1.Refresh
         x.SetRecordset Data1.Recordset
         Set x = Nothing
      End Sub

</PRE><P><LI>Press F5 or click Start on the Run menu to start the client
   application. Click on the form to execute the code added in step 7.
   Error 419 is displayed on the Set statement in the OLE server (you may
   need to minimize the client to see this error).
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: APrgDataOther<BR>
Additional reference words: 4.00 vb4win vb4all
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 10, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
