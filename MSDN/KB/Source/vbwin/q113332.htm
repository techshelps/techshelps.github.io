

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: AddNew Method Gives Error: Illegal Function Call </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113332">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1994/03/31">
<META NAME="Keywords" CONTENT="APrgDataAcc kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  It is possible to receive an  Illegal Function Call  error message in response to an AddNew method. This article demonstrates how this error can occur and how to work around it.  CAUSE =====  The cause of this problem has not yet been determined. W...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAGI,QDKW,QA5V,QAB4,QAOX,QAAP,QAPN,QAKP,QAH4,QDKY,QBV8,QBVV,QAY5,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: AddNew Method Gives Error: Illegal Function Call</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113332</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
It is possible to receive an "Illegal Function Call" error message in
response to an AddNew method. This article demonstrates how this error
can occur and how to work around it.
<P>
<P><h2>CAUSE</h2>
 
<P>
The cause of this problem has not yet been determined. We're researching
it.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two ways to work around this problem. The first method is to move
to the last record before adding the record. The following code
demonstrates this work around:
<P>
<PRE>   Form1.AutoRedraw = True
   Data1.DatabaseName = "DB.MDB"
   Data1.RecordSource = "SELECT * FROM Table1 WHERE Field1 = 'Record1'"
   Data1.Refresh
   Data1.Recordset.MoveLast
   Print "ReadOnly "; Data1.ReadOnly
   Print "Options "; Data1.Options
   Print "Updatable "; Data1.Recordset.Updatable
   Data1.Recordset.AddNew

</PRE>The other method is to delete the index. In the previous example, you would
delete Index1.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Microsoft Visual Basic version
3.0 for Windows. This problem has been corrected in Visual Basic version
4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A problem with the Microsoft Access database engine can cause an "Illegal
Function Call" error when adding a record to a database. This error should
not occur. This problem is not related to the data control and can also
occur when using methods from the Professional Edition of Visual Basic
version 3.0.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Use the Data Manager to create a database with these characteristics:
<P>
   DATABASE: DB.MDB
<PRE>   TABLES:   Table1
   FIELDS:   Field1 in Table1
   INDEXES:  Index1 on Field1 not Unique and not Primary

</PRE><P><LI>Add two records to Table1 with values of "Record1" and "Record2" for
   Field1.

<P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a data control (Date1) and a command button (Command1) to the form.

<P><LI>Add the following code to the command button's click event:
<P>
<PRE>   Sub Command1_Click ()
      Form1.AutoRedraw = True
      Data1.DatabaseName = "DB.MDB"
      Data1.RecordSource = "SELECT * FROM Table1 WHERE Field1 = 'Record1'"
      Data1.Refresh
      Print "ReadOnly "; Data1.ReadOnly
      Print "Options "; Data1.Options
      Print "Updatable "; Data1.Recordset.Updatable
      Data1.Recordset.AddNew
   End Sub

</PRE><P><LI>Run the code and click the Command1 button. You should receive the
   "Illegal function call" error on the on the Addnew line.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00 buglist3.00 fixlist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataAcc<BR>
Keywords          : APrgDataAcc kbbuglist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
