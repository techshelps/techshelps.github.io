

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Can't Connect Data Control to a Password Protected MDB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160169">
<META NAME="KBModify" CONTENT="1996/11/29">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you attempt to use the Data control to connect to a password-protected Access database at design time, you will receive the error message:      Not a valid password   Specifically, this error will occur when setting the RecordSource property of ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QBXS,QAB4,QA7O,QDKY,QAOE,QAMN,QAB5,QAI5,QAYY,QAIJ,QABA,QBWC,QA1S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Can't Connect Data Control to a Password Protected MDB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160169</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you attempt to use the Data control to connect to a password-protected
Access database at design time, you will receive the error message:
<P>
<PRE>   "Not a valid password"

</PRE>Specifically, this error will occur when setting the RecordSource property
of the Data control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In the Properties window, set the following properties for the Data
control:
<P>
<PRE>      Property             Value of Property
      ----------------   ---------------------
      DatabaseName         ATEST.MDB
      Connect              ;pwd=aaa
      RecordSource         Table1

</PRE>NOTE: You must set the DatabaseName property first, then set the connect
property. If the properties are not set in this order, you will receive the
same error message.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>In the Load event for Form1, place the following code:
<P>
<PRE>   Private Sub Form_Load()

     Dim DB As Database
     Dim tblDef As TableDef, fld As Field

     Set DB = DBEngine.Workspaces(0).CreateDatabase("C:\ATEST.MDB", _
         dbLangGeneral, dbEncrypt)
     DB.NewPassword "", "aaa"
     ' Create new TableDef.
     Set tblDef = DB.CreateTableDef("Table1")
     ' Add field to tblDef.
     Set fld = tblDef.CreateField("Field1", dbInteger)
     tblDef.Fields.Append fld
     ' Save TableDef definition by appending it to TableDefs collection.
     DB.TableDefs.Append tblDef
     DB.Close
     MsgBox "ATEST.MDB and Table1 is created."

   End Sub

</PRE><P><LI>Run the program by pressing the F5 key. A password-protected database
   called ATEST.MDB will be created.

<P><LI>Start another instance of Visual Basic 4.0. Form1 is again created by
   default.

<P><LI>Add a Data control to Form1.

<P><LI>In the Properties window, set the DatabaseName property of the Data
   control to "C:\ATEST.MDB." If you try to set the RecordSource property,
   you will receive the error message described above.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb<BR>
KBSubcategory: kbnocat<BR>
Additional reference words: 4.00 vb4win vb4all kbstream
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
