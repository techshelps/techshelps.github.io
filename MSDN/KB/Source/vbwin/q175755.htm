

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Run-time Error '3043' When Using Books Online or DAO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175755">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1997/10/27">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="   Run-time error '3043', disk or network error  message.  CAUSE =====  The above error is generated when you do not have a valid directory (usually the Temp directory) pointed to by the Environment User Variable TMP under Windows NT 4.0.  RESOLUTION...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAYL,QBXB,QBWP,QATJ,QBTX,QBS0,QBQU,QAFI,QBWS,QBHQ,QA6E,QAX1,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Run-time Error '3043' When Using Books Online or DAO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175755</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Professional, and Enterprise
   Editions for Windows, version 5.0
   on the following platform: NT
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
"Run-time error '3043', disk or network error" message.
<P>
<P><h2>CAUSE</h2>
 
<P>
The above error is generated when you do not have a valid directory
(usually the Temp directory) pointed to by the Environment User Variable
TMP under Windows NT 4.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Create a valid (Temp) directory for the TMP Environment User Variable. From
Control Panel, double-click the System icon. Select the Environment tab.
Under "User Variables for [UserName]," change the value of TMP to an
existing directory name.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Steps to Reproduce the Behavior:
 
<P>
There are two ways to reproduce this behavior under Windows NT 4.0 (both
server and workstation).
<P>
<P><h3>Using Books Online</h3>
 

<OL><P><LI>From Control Panel, double-click on the System icon.

<P><LI>Click on the Environment tab.

<P><LI>Under "User Variables for [Username]," change the value of TMP to a
   non-existing directory name, or delete or rename the existing directory
   pointed to by the TMP variable.

<P><LI>Run Books Online. You should get the following message:
<P>
   "Run-time error '3043', disk or network error"
<P>
</OL><h3>Using DAO</h3>
 

<OL><P><LI>Repeat steps 1 to 3 as above.

<P><LI>Start a new Visual Basic Standard EXE project.

<P><LI>Add one of the following references to your project:
<P>
<P><PRE>    - Microsoft DAO 2.5/3.0 Compatibility Library
    - DAO 2.5/3.5 Compatibility Library
    - DAO 3.0 Object Library
    - DAO 3.5 Object Library
</PRE>
<P><LI>Add the follow code to the Load event procedure in Form1:
<P>
<P><PRE>       Dim WS as WorkSpace
       Dim sPath as String
<PRE></PRE>       sPath = DBEngine.IniPath          ' This is fine
       Set WS = DBEngine.Workspaces(0)   ' Error at this point...

</PRE><P><LI>Run the project. You should get the following message:
<P>
<P><PRE>      "Run-time error '3043', disk or network error"
</PRE><P>
</OL>To correct this behavior, create a directory (such as Temp) for the TMP
variable.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on the cause of this error message, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q175756.htm">Q175756</A></B>
   TITLE     : PRB: Setup Wizard Displaying Message Box With '118' and
               OK Button
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Error 3034, Books Online, DAO, Disk or network<BR>
error.<BR>
Keywords          : vb5all<BR>
Version           : WINDOWS:5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
