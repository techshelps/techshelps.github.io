

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error 13 Type Mismatch Error on DAO OpenRecordset Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181542">
<META NAME="KBModify" CONTENT="1998/03/04">
<META NAME="KBCreate" CONTENT="1998/02/20">
<META NAME="Keywords" CONTENT="vb5all VBKBDAO VBKBRecordset kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you dimension an object as a Recordset and then set that object to databaseobject.OpenRecordset(source), you may get the following error message:     Run time error '13': Type mismatch  CAUSE =====  If your project contains references to both th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAB4,QBHQ,QBVR,QAAP,QABI,QAH4,QAB3,QA1S,QBXS,QANF,QBS0,QBQU,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error 13 Type Mismatch Error on DAO OpenRecordset Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181542</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Enterprise Edition for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you dimension an object as a Recordset and then set that object to
databaseobject.OpenRecordset(source), you may get the following error
message:
<P>
<PRE>   Run time error '13': Type mismatch

</PRE><h2>CAUSE</h2>
 
<P>
If your project contains references to both the Data Access Objects (DAO)
library and the ActiveX Data Objects (ADO) library, you may see multiple
Recordset entries in the list box when you dimension the Recordset object.
This error occurs when you list the ADO library with a higher priority than
the DAO library in the References dialog box, regardless of which Recordset
entry you select from the list box.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you need only the DAO Recordset object, make sure that the reference for
the DAO object library has a higher priority in the References dialog box,
or clear the reference to Microsoft ActiveX Data Objects.
<P>
If you need to reference and use both DAO and ADO Recordset objects,
dimension the objects explicitly as follows:
<P>
<PRE>   DIM adoRS As ADODB.Recordset
   DIM daoRS As DAO.Recordset

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>On the Project menu, point to References.

<P><LI>In the References dialog box, set references to both the Microsoft Data
   Access Objects 3.5 library and the Microsoft ActiveX Data Objects 1.5
   library.

<P><LI>Make sure that the ADO library appears in the list above the DAO
   library.

<P><LI>Place the following code in the General Declarations section of your
   project:
<P>
<P><PRE>      DIM dbs AS Database
      DIM rs AS Recordset  ' When you press the spacebar after "AS," the
<PRE></PRE>                           ' list box includes multiple Recordset entries.
                           ' Pick any Recordset item, or type "Recordset."

</PRE><P><LI>Place this code in the Form_Load procedure:
<P>
<P><PRE>      SET dbs=OpenDatabase(dbname)
      SET rs=dbs.OpenRecordset(source)  ' The error occurs when this line
<PRE></PRE>                                        ' of code executes.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OpenRecordset DAO mismatch<BR>
Keywords          : vb5all VBKBDAO VBKBRecordset kberrmsg<BR>
Version           : win95:5.0;winnt:5.0<BR>
Platform          : Win95 winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 4, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
