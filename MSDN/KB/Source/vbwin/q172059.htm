

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Show a Modal Form from an OLE Server DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172059">
<META NAME="KBModify" CONTENT="1997/08/04">
<META NAME="KBCreate" CONTENT="1997/07/28">
<META NAME="Keywords" CONTENT="PrgOther VB4ALL VB4WIN kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Showing a modal form from an out-of-process OLE Server is generally not recommended. One reason is that the modal form may be displayed behind the client program, making it difficult for the user to see that it needs to be addressed. Another proble...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA9Q,QBVP,QBJZ,QAY2,QAFF,QACI,QBXS,QBE5,QBWS,QARL,QAIJ,QBLX,QAMA,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Show a Modal Form from an OLE Server DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172059</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic for Windows, 32-bit only,
   version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Showing a modal form from an out-of-process OLE Server is generally not
recommended. One reason is that the modal form may be displayed behind the
client program, making it difficult for the user to see that it needs to be
addressed. Another problem is that while the method of the OLE Server is
still processing, the client program may not handle Paint messages, which
can cause the client screen to become cluttered by the images of other
windows that have overlaid it.
<P>
Finally, if an OLE Server is just performing a service and is not
responsible for any of the user interface, it is more appropriate to raise
an error and return that error to the client program than for the OLE
Server itself to show a message box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
One way to show a modal form from a client program is to use an OLE DLL as
the server application. The DLL will run in the address space of the
client. Consequently, any forms shown by the OLE DLL will automatically
have the client program's form as a parent.
<P>
The steps below outline how to create an out-of-process OLE Server DLL that
shows a modal form inside Excel 7.0.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project. Form1 is created by default.

<P><LI>On Form1, place a CommandButton, and place the following code in the
   CommandButton:
<P>
<P><PRE>      Private Sub Command1_Click()
      Unload Me
      End Sub
</PRE>
<P><LI>Insert a class module by choosing Insert...Class Module from the menu.

<P><LI>In the Class module, place the following code:
<P>
<P><PRE>      Public Sub ShowModal()
      Form1.Show 1
      End Sub
</PRE>
<P><LI>Press the F4 key to bring up the Properties window for the class, and
   change the Name of the class to clsShowForm. Set Instancing to
   Createable MultiUse, and set Public to True.

<P><LI>From the Tools menu, choose Options, and select the Project tab. Change
   the project name to prjShowForm, select OLE Server, and change the
   Application Description to "Show Project Example" (without the quotes).

<P><LI>Also in the Project tab, switch the Startup Form to Sub Main(). Click OK
   in the Options dialog box.

<P><LI>Add a regular module to the project by choosing Module from the Insert
   menu.

<P><LI>Place a main subroutine into it:
<P>
<PRE>      Sub main()
      
      End Sub

</PRE><P><LI>From the Filemenu, choose Make OLE DLL to make the OLE Server. This
<P><PRE>    creates the DLL and registers the OLE Server on the system.
</PRE>
<P><LI>Start Excel, and by default it will start in Book1. This is important
</OL>because the example above uses the Caption of Excel to find the window
handle. From the Insert menu, choose Macro Module to go into the VBA
editor.

<OL><P><LI>Place the following code in the editor:
<P>
<PRE>      Sub test()
      Dim x As Object
      Set x = CreateObject("prjShowForm.clsShowForm")
      x.ShowModal
      End Sub

</PRE></OL>Run the code in the Excel editor and it will show the modal form provided
by the OLE Server DLL. It will be shown modally in front of Excel until the
form is dismissed. If the same form is shown from an out-of-process OLE
Server, two undesirable characteristics will manifest themselves: Excel
will fail to paint as the modal form is moved around and it will be
possible to click on Excel to bring it to the foreground.
 
<PRE>Keywords          : PrgOther VB4ALL VB4WIN kbhowto
Technology        : kbole
Version           : 4.0
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
