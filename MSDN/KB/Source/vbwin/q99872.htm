

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Wrong Menu Click Event After Hiding Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99872 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/06/09">
<META NAME="Keywords" CONTENT="PrgCtrlsStd kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The wrong menu Click event is executed after hiding and showing menu items in Visual Basic.  CAUSE =====  This problem occurs when a menu is made invisible before another menu item is made visible.  WORKAROUND  Change the order followed to make men...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QBS0,QAFF,QBWS,QAVX,QAF0,QAH4,QA9N,QASB,QAO4,QAVI,QBWR,QAR4,QAPN,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Wrong Menu Click Event After Hiding Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99872 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 2.00 3.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The wrong menu Click event is executed after hiding and showing menu
items in Visual Basic.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when a menu is made invisible before another
menu item is made visible.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Change the order followed to make menus visible and invisible. For example
replace the following code (listed in step 4 in the More Information
section below):
<P>
<PRE>   Sub Command1_Click ()
      MnuFile.Visible = 0
      MnuEdit.Visible = -1
   End Sub

   Sub Command2_Click ()
      MnuEdit.Visible = 0
      MnuFile.Visible = -1
   End Sub

</PRE>with this code:
<P>
<PRE>   Sub Command1_Click ()
      MnuEdit.Visible = -1
      MnuFile.Visible = 0
   End Sub

   Sub Command2_Click ()
      MnuFile.Visible = -1
      MnuEdit.Visible = 0
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem has been corrected in Visual
Basic version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>From the menu design dialog box of Visual Basic (VB.EXE), create
   a set of menus using the following table as a guide:
<P>
<PRE>   Caption     CtlName (or Name)  Level   Visible
   ----------------------------------------------
   &amp;File       MnuFile            1       False
   &amp;New        MnuFileNew         2       True
   &amp;Edit       MnuEdit            1       False
   &amp;Copy       MnuEditCopy        2       True

</PRE><P><LI>Add two command buttons (Command1 and Command2) to the form.

<P><LI>Add the following code to your program in the appropriate places:
<P>
<PRE>   Sub Command1_Click ()
      MnuFile.Visible = 0
      MnuEdit.Visible = -1
   End Sub

   Sub Command2_Click ()
      MnuEdit.Visible = 0
      MnuFile.Visible = -1
   End Sub

   Sub MnuEdit_Click ()
      Debug.Print "Edit Click"
   End Sub

   Sub MnuEditCopy_Click ()
      Debug.Print "Copy Click"
   End Sub

   Sub MnuFile_Click ()
      Debug.Print "File Click"
   End Sub

   Sub MnuFileNew_Click ()
      Debug.Print "New Click"
   End Sub

</PRE><P><LI>From the Run menu, choose start (ALT, R, S), or press F5.

<P><LI>From the Window menu, choose debug (ALT, W, D), or press CTRL+B.

<P><LI>Click Command1. You will see the Edit menu on Form1.

<P><LI>Click the Edit menu on Form1. Then click the Copy menu. You will
   see Edit Click and Copy Click displayed in the Debug Window.

<P><LI>Click Command2. You will now see the File menu in place of the
   Edit menu on Form1.

<P><LI>Click the File menu on Form1. Then click the New menu. You will
<P><PRE>    see File Click and New Click in the Debug Window.
</PRE>
<P><LI>Repeat steps 7 and 8. Instead of seeing Edit Click and Copy Click
<P><PRE>    in the Debug Window, you will now see New Click and Copy Click in
    the Debug Window.
</PRE><P>
</OL>The click event for the previously visible menu is being executed
instead of the click event for the currently visible menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist1.00 buglist2.00 buglist3.00 1.00 2.00<BR>
3.00 fixlist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>
Keywords          : PrgCtrlsStd kbbuglist kbprg<BR>
Version           : 1.00 2.00 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
