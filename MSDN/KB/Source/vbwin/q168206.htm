

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Argument Not Optional" Error Using DAO 3.5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168206">
<META NAME="KBModify" CONTENT="1997/10/16">
<META NAME="KBCreate" CONTENT="1997/05/07">
<META NAME="Keywords" CONTENT="APrgDataAcc VB4WIN vb5all VBKBDAO kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After porting a Visual Basic 4.0 program that is written using DAO 3.0 (Data Access Objects) to DAO 3.5, the error message:      Argument Not Optional   will occur on the Update, Movelast, and CommitTrans methods. This does not happen in Visual Bas...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QBVV,QAHE,QAMS,QAHT,QAB4,QA5F,QAMA,QDNL,QAAP,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Argument Not Optional" Error Using DAO 3.5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168206</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After porting a Visual Basic 4.0 program that is written using DAO 3.0
(Data Access Objects) to DAO 3.5, the error message:
<P>
<PRE>   "Argument Not Optional"

</PRE>will occur on the Update, Movelast, and CommitTrans methods. This does not
happen in Visual Basic 5.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
In DAO 3.0, the methods listed above do not use optional arguments. They do
use optional arguments in DAO 3.5. This is a problem caused by adding the
Typed Optional Parameter feature to OLE Automation. Only newer Automation
controllers such as Visual Basic 5.0 are going to understand this. Visual
Basic 4.0 can accept optional parameters only if they are of the Variant
data type. The optional arguments for the methods listed above are not
Variant so it doesn't recognize them as optional.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are three options for this problem:

<OL><P><LI>Do not use DAO 3.5 with Visual Basic 4.0. Use DAO 3.0 or lower.

<P><LI>Use the optional arguments listed in the DAO 3.5 Help file.
<P>
   NOTE: The Help file states that the optional argument constant for
   Movelast is dbRunAsync. This is not true and it will not work. The
   actual argument is rdAsyncEnable.

<P><LI>Do not use early binding on the recordset object. For example, the
   following code will cause the error:
<P>
<P><PRE>      Dim myrecordset as recordset
</PRE><P>
<P><PRE>      Set myrecordset = mydatabase("Table1",dbOpenDynaset)
      myrecordset.Edit
      myrecordset.Update
</PRE><P>
   Removing the Dim statement will cause it to work as expected.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design. Microsoft does not support the use of DAO 3.5
in Visual Basic 4.0. It is recommended that DAO 3.0 or lower be used.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For information on how to use the methods mentioned above, refer to the
Visual Basic online help.
 
<PRE>Keywords          : APrgDataAcc VB4WIN vb5all VBKBDAO kberrmsg kbprb
Technology        : kbole
Version           : 4.0 5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
