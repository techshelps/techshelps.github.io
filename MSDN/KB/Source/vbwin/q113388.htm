

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: CreateDynaset Err: Can't open any more tables or queries </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113388">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/04/03">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After using the CreateDynaset method several times to create a dynaset from the dynaset itself, you will receive this error:     Can't open any more tables or queries.  Most often, you would be using the Sort or Filter property in this process. How...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXS,QAH4,QBT6,QBWS,QBV4,QAN0,QAPN,QANF,QABA,QAHP,QAY2,QAX6,QAO4,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: CreateDynaset Err: Can't open any more tables or queries</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113388</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After using the CreateDynaset method several times to create a dynaset
from the dynaset itself, you will receive this error:
<P>
<PRE>   Can't open any more tables or queries.

</PRE>Most often, you would be using the Sort or Filter property in this process.
However, it is not necessary to do this to re-create the problem.
<P>
<P><h2>CAUSE</h2>
 
<P>
The number of times a dynaset can be created from itself is limited in the
current design of Visual Basic.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around the problem, base all sorts or filters off of a different
dynaset. The following example illustrates this:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a command button (Command1) and a text box (Text1) to the form.

<P><LI>Add the following code in the command click event.
<P>
<PRE>   Sub Command1_Click()
      Dim db As Database
      Dim ds As Dynaset
      Dim ds2 As Dynaset
      Set db = OpenDatabase("C:\VB\BIBLIO.MDB")
      Set ds = db.CreateDynaset("SELECT * FROM Authors")
      Set ds2 = ds
      Do
         iCount = iCount + 1
         Text1.Text = iCount
         ds2.Sort = "Author"
         Set ds = ds2.CreateDynaset()
      Loop
   End Sub

</PRE><P><LI>Run the program or press the F5 key.
<P>
</OL>The problem does not occur with snapshot objects.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design in Visual Basic version 3.0 for Windows.
However, Microsoft is considering a change for future releases.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a command button (Command1) and a text box (Text1) to the form.

<P><LI>Add the following code in the Command1 click event:
<P>
<PRE>   Sub Command1_Click()
      Dim db As Database
      Dim ds As Dynaset
      Set db = OpenDatabase("C:\VB\BIBLIO.MDB")
      Set ds = db.CreateDynaset("SELECT * FROM Authors")
      Do
         iCount = iCount + 1
         Text1.Text = iCount
         Set ds = ds.CreateDynaset()
      Loop
   End Sub

</PRE><P><LI>Run the code.  The error should occur on the tenth iteration.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: PrgOptMemMgt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
