

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: RDC Refresh Method Failure with Bound DBListbox </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154817">
<META NAME="KBModify" CONTENT="1997/07/14">
<META NAME="KBCreate" CONTENT="1996/08/15">
<META NAME="Keywords" CONTENT="PrgOther vb432 vb4win">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you change the SQL Property of a Remote Data Control with a bound DBListbox at run time, the refresh method doesn't show the changes in the DBListbox as it does for other controls. The Refresh method must be called twice.  RESOLUTION  Refresh th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAN0,QBS0,QAPN,QABM,QA7O,QAOE,QAMN,QAB5,QAML,QAIJ,QAFF,QBWS,QAXB,QAUJ,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: RDC Refresh Method Failure with Bound DBListbox</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154817</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic, 32-bit only,
   for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you change the SQL Property of a Remote Data Control with a bound
DBListbox at run time, the refresh method doesn't show the changes in the
DBListbox as it does for other controls. The Refresh method must be
called twice.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Refresh the remote data control twice. Replace the Command1_Click in the
previous sample with the code below:
<P>
<PRE>   Private Sub Command1_Click()
     ' Restrict the SQL to display only the authors whose last name
     ' start with an R
     MSRDC1.SQL = "SELECT * FROM Authors WHERE AU_Lname LIKE'R%'"
     MSRDC1.Refresh
     MSRDC1.Refresh
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a new ODBC data source for SQL Server called "RefreshTest" using
   the "32-bit ODBC" section of the Control Panel. Set the database name to
   the "Pubs" Database.

<P><LI>Start a new Visual Basic Project. Form1 is created by default.

<P><LI>Add the following controls to Form1 and give them the properties
   indicated:
<P>
<PRE>      Default Name             Caption            Name
      --------------------   -----------------  ----------
      Remote Data Control      Authors            MSRDC1
      Command1                 Change SQL         Command1
      DBList                   Not Applicable     DBList1

</PRE><P><LI>Set the DBList Control RowSource property to MSRDC1.

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
   Option Explicit
<P>
<PRE>   Private Sub Form_Load()
     MSRDC1.DataSourceName = "RefreshTest"
     MSRDC1.SQL = "Select * from Authors"
     MSRDC1.Refresh
     DBList1.ListField = "Phone"
   End Sub

   Private Sub Command1_Click()
     ' Restrict the SQL to display only the authors whose last name
     ' start with an R
     MSRDC1.SQL = "SELECT * FROM Authors WHERE AU_Lname LIKE'R%'"
     MSRDC1.Refresh
   End Sub

</PRE><P><LI>Press the F5 key to run the project. The DBListbox will contain many
   rows of data.

<P><LI>Click the Command button "Change SQL," and note that the DBListbox
   doesn't change to reflect the new SQL.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Building Client / Server Applications with Visual Basic Chapter 11.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: remote data control rdc<BR>
Keywords            : PrgOther vb432 vb4win<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
