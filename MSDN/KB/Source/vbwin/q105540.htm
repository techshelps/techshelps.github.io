

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error or GP Fault When Pass Data Control as Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105540">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Trying to reference the properties of a Recordset or Database using a data control that was passed as Control to a Sub or Function results in this error message:     Invalid object reference  In addition, passing a data control into a Sub procedure...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QA7O,QAB5,QAOE,QAMN,QAH6,QAH7,QAD7,QAPN,QAB4,QAW6,QAH4,QBS0,QAYY,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error or GP Fault When Pass Data Control as Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105540</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic
<PRE>  programming system for Windows, version 3.0
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Trying to reference the properties of a Recordset or Database using a data
control that was passed as Control to a Sub or Function results in this
error message:
<P>
<PRE>   Invalid object reference

</PRE>In addition, passing a data control into a Sub procedure as Control may
result in a general protection (GP) fault, as it does in this example:
<P>
<PRE>   Sub subtest (crtname As Control)
      crtname.UpdateControls
      ' Simply having this line in the code causes the GP fault.
      ' If you turn the line into a comment, the GP fault does not occur.
   End Sub

</PRE><h2>CAUSE</h2>
 
<P>
Recordset and Database specific properties are not available to
objects passed as Control. You should replace the "As Control" with "As
Data."
<P>
NOTE: the Data object type is not easy to find in the Visual Basic
documentation. It is, however, listed with the other possible object data
types in the "Object Variables" popup on the Help menu topic, "Database
Objects." Object types include CheckBox, ComboBox, CommandButton,
CommonDialog, Control, Data, DirListBox, DriveListBox, FileListBox, Form,
Frame, Grid, HScrollBar, Image, Label, ListBox, MDIForm, OptionButton,
PictureBox, TextBox, Timer, and VScrollBar. The Professional Edition adds
the following additional object types: Database, Dynaset, Field, Fields,
Index, Indexes, QueryDef, Snapshot, Table, TableDef, and TableDefs.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Pass the data control as Data. For example, use the following code
instead of the code shown below in the MORE INFORMATION section:
<P>
<PRE>   Sub MySub(d As Data)
      Debug.Print d.Recordset.EOF

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following code example gives the error message:
<P>
<PRE>   Sub MySub(d As Control)
      Debug.Print d.Recordset.EOF    ' an error appears on this line
                             '^^^      with EOF highlighted
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 gpf<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubCategory: APrgDataOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
