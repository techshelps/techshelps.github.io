

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Setup Wizard Restarts Using Template (.vbz) File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158857">
<META NAME="KBModify" CONTENT="1996/11/11">
<META NAME="KBCreate" CONTENT="1996/11/06">
<META NAME="Keywords" CONTENT="kbusage kbsetup kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you load a template (.vbz) file into the Visual Basic 4.0 Setup Wizard, the following error message appears:     Either the project state or template file has changed since this    template was created. Setup will restart.  Click OK to restart...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBS0,QA36,QAB4,QDIZ,QDKW,QDK2,QDI2,QAXB,QAIJ,QAG4,QAMA,QBWS,QAJN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Setup Wizard Restarts Using Template (.vbz) File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158857</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic for Windows, 16-bit and 32-bit, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you load a template (.vbz) file into the Visual Basic 4.0 Setup
Wizard, the following error message appears:
<P>
<PRE>   Either the project state or template file has changed since this
   template was created. Setup will restart.

</PRE>Click OK to restart the Setup Wizard.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is by design. The Setup Wizard compares the date on the
template file to the dates on the project's .exe and source files. If the
date on the template file is older than the other files, then the error
message is generated. It also compares the checksum stored in the .vbz file
and generates the error condition if the values do not match.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Do not use template (.vbz) files. To work around the problem, add an entry
for the project .exe file to \Windows\Sw depend.ini. Also, add entries for
all of the additional components that need to be shipped with that .exe
file. This is not an effective workaround for projects that require
significant configuration, such as OLE servers, but it handles the
inclusion of a large number of files.
<P>
For detailed information on the format of Swdepend.ini, select the
"Help/Search For Help On..." menu option from the Visual Basic 4.0 IDE.
Type Swdepend.ini &lt;cr&gt;. Double-click the "Syntax in Swdepend.ini(ReadMe)"
topic.
<P>
<P><h3>Example</h3>
 
<P>
To include the files Bullet.bmp and Emdash.bmp when you create installation
disks for the CALC sample project, add the following entry to Swdepend.ini:
<P>
<PRE>   [calc.exe]
   Register=$(EXESelfRegister)
   Dest=$(AppPath)
   Uses1=c:\vb4\hc\bullet.bmp
   Uses2=c:\vb4\hc\emdash.bmp
   Uses3=

</PRE><h2>STATUS</h2>
 
<P>
A change in the design of the Setup Wizard is under review and
will be considered for inclusion in a future release of Visual Basic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbsetup kbprb<BR>
KBSubcategory: TlsSetWiz Setins<BR>
Additional reference words: 4.00 kbdsd vb4win vb4all setupwiz
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
