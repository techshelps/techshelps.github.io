

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Create a NetDDE Client and Server in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181946">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1998/03/02">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all vb5howto VBKBNet vbwin">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article demonstrates how to use NetDDE to communicate with a Microsoft Visual Basic application on a remote computer. This article assumes that you are familiar with DDE communications and demonstrates creating both the client and server appli...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA3A,QAZ2,QBWO,QAUJ,QBWS,QBV4,QA0K,QAJH,QBT6,QAMA,QAIJ,QBWQ,QA6A,QAHP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Create a NetDDE Client and Server in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181946</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to use NetDDE to communicate with a Microsoft
Visual Basic application on a remote computer. This article assumes that
you are familiar with DDE communications and demonstrates creating both the
client and server applications in Visual Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to establish a link to a remote application, a DDE share must be
created on the remote computer. A DDE share consists of a Share Name,
Application name, and a Topic. Shares may be created and edited using the
DDE Share Manager (DDESHARE.EXE), which may be found in the
&lt;WINNT\SYSTEM32&gt; directory on NT 4.0. For Windows 95 and Windows For
Workgroups, the Network DDE Share Manager can be found in the Windows for
Workgroups Resource Kit.
<P>
<P><h3>Creating the Visual Basic NetDDE Server</h3>
 

<OL><P><LI>Start Visual Basic and create a new Standard EXE application. Form1 is
   created by default.

<P><LI>Place a Textbox (Text1) on Form1 and set the Text Property to "The DDE
   Server is Running."

<P><LI>Change the LinkMode Property of Form1 to "1 - Source."

<P><LI>Select Project1 Properties from the Project menu, select the Make
   tab, and then change the application title to DDESRV.

<P><LI>Compile and save the application and name it DDESRV.EXE.

<P><LI>Install the application on a computer on your network that you want to
   use as the Server.
<P>
</OL><h3>Creating the DDE Share on the Server</h3>
 

<OL><P><LI>Start the DDE Share Manager Application on the Computer designated as
   the Server. Select Run from the Windows Start menu, and then run
   DDESHARE.

<P><LI>Select "DDE Shares" from the "Shares" menu. A list of shares that have
   previously been set up will be displayed in the list box.

<P><LI>Click the "Add a Share" button.

<P><LI>Enter "DDETEST$" in the "Share Name" textbox.
<P>
   NOTE: When creating the share name it is not necessary to place a
   trailing "$," although it is conventional to do so.

<P><LI>Enter the following values in the corresponding Application and Topic
   Text boxes:
<P>
<PRE>                      Application Name              Topic Name
                     -------------------          ---------------
   oldstyle             DDESRV.DDE                    Form1
   newsytle             DDESRV.OLE                    Form1
   static               DDESRV                        Form1

   NOTE: The DDESHARE utility for WFW/WIN95 only supports defining one
   Application and Topic name each. Use the static Application and Topic
   names from the list above.

</PRE><P><LI>Click OK to close the DDE Share Properties dialog.
<P>
   IMPORTANT: Due to a bug in the DDE Share Utility, when exiting the DDE
   Share application, a new serial number is created for the Share but is
   not updated in the Trusted DDE Shares section of the registry;
   therefore, the next two steps are very important.

<P><LI>Select the DDETEST$ share in the list and click on the "Trust Share"
   button.

<P><LI>Make sure that "Initiate to Application Enable" is selected and then
   click the "SET" button.

<P><LI>Press OK on both open dialogs and then exit the DDE Share Utility.
<P>
</OL><h3>Creating and Testing the Visual Basic NetDDE Client</h3>
 

<OL><P><LI>Start a new Standard EXE project in Visual Basic. Form1 is created by
   default.

<P><LI>Add a CommandButton to Form1. Change the following properties:
<P>
<PRE>   Name:     cmdConnect
   Caption:  Connect

</PRE><P><LI>Add a Text box to Form1 and name it txtData.

<P><LI>Paste the following code into the Declarations Section of Form1:
<P>
   NOTE: Replace the &lt;MACHINE NAME&gt; with the appropriate computer name
   where the DDE SRV application will be running.
<P>
<P><PRE>      Private Sub cmdConnect_Click()
<PRE></PRE>         txtData.linkMode = vbLinkNone
         txtData.linkTopic = "\\&lt;MACHINE NAME&gt;\NDDE$|DDETEST$
         txtData.LinkItem = "Text1"
         txtData.LinkMode = vbLinkManual
         txtData.LinkRequest
      End Sub

</PRE><P><LI>Start the DDESRV application on the Network computer acting as the DDE
   Server.

<P><LI>Press the F5 key to run this client within the Visual Basic 5.0 IDE.

<P><LI>Click the Command button labeled "Connect" and note that the string "The
   DDE Server is Running" appears within the txtData Text Box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WINNT/Q114089.htm">Q114089</A></B>
   TITLE     : Using the Windows NT NetDDE Share Manager
</PRE></OL> 
<PRE>Keywords          : VB4ALL VB4WIN vb5all vb5howto VBKBNet vbwin
Version           : WINDOWS:4.0,5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
