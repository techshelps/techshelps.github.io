

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Limitations of the Data Control in Visual Basic Version 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103808">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/08/30">
<META NAME="Keywords" CONTENT="kbprg kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Chapter 20 in the  Programmer's Guide  explains how to use a data control in Microsoft Visual Basic version 3.0 for Windows. You may want to use an object variable such as Snapshot instead of using the data control. Chapter 20 does not explain the ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QAB5,QAOE,QAMN,QAYY,QBS0,QAZV,QA28,QATJ,QAW6,QAHV,QABN,QAB6,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Limitations of the Data Control in Visual Basic Version 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103808</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Chapter 20 in the "Programmer's Guide" explains how to use a data control
in Microsoft Visual Basic version 3.0 for Windows. You may want to use an
object variable such as Snapshot instead of using the data control. Chapter
20 does not explain the limitations of using the data control, so this
article lists those limitations for you.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Because a data control is a special type of Dynaset, its limitations are
similar to those of Dynasets. Here are the limitations of data controls:

<UL><LI>You cannot use a QueryDef requiring a Parameter in the RecordSource
   property of the data control.

<LI>Using a data control along with other bound controls uses System
   Resources (memory). When you build larger programs, you may want to
   look at other programming methods (Database objects don't require
   controls, therefore you don't use System Resources) to display your
   database data.

<LI>Not every method and property specific to the Table object can be
   performed by the data control. Here are two such cases:
<P>
<P><PRE>    - You cannot take advantage of the Index property of the Table object
      to display your database data in a specific indexed order with the
      data control. This technique, described in the example shown in the
      Help file topic "Index Property (Data Access)," works only with the
      Table object, not the data control. As an alternative, you can use an
      ORDER BY clause in an SQL statement, as in this example:
</PRE><P>
<PRE>         Data1.RecordSource = "Select * From Publishers Order By PubID"

      The ORDER BY clause technique is also more flexible than the Index
      property technique. Using the ORDER BY clause, you can sort on any
      field, and no specified index is required.

    - You cannot use a Seek method on your database data for a specific
      record with the data control. The Seek method can only be used by the
      Table object. You can, however, perform a FindFirst method with the
      data control.

</PRE><LI>You cannot use the Sort property on a specific database record with the
   data control. The Sort property technique is specific to a Dynaset or
   Snapshot object. The following example proves this limitation:
<P>
<PRE>      Data1.Recordset.Sort = "City DESC"   '** No error occurs
      Data1.Refresh                        '** No change in order occurs

   If you try to sort the Publishers table by City, nothing happens. But if
   you use an ORDER BY clause in an SQL statement, as in the following
   example, you will see the database data displayed in descending order
   by the City names:

      Data1.RecordSource = "Select * From Publishers Order By City DESC"
      Data1.Refresh

</PRE><LI>A data control is bound to one, single form -- the form on which it
   resides. Therefore, when the form that contains the data control is
   not loaded, you cannot refer to the data control from another form.

<LI>You cannot perform a FileCopy statement on a database while a form that
   contains a data control is loaded. A "Permission Denied" error occurs if
   you try to use the FileCopy statement to make a backup of your database
   while a form containing a data control is loaded in memory. To prevent
   this error, first close or unload the form that contains the data
   control. Then run the FileCopy statement to make a database backup.

<LI>You cannot use a data control to display the results of a parameter
   query. It is possible to use the Database object of the data control to
   open and run a querydef which requires parameters.  For example:
<P>
<PRE>   Sub Command1_Click ()
      Dim db As Database
      Dim Qd As QueryDef
      Dim Sn As Snapshot

      Data1.DatabaseName = "c:\vb\biblio.mdb"
      Data1.RecordSource = "Authors"
      Data1.Refresh

      ' Open the "By date" query
      Set Qd = Data1.Database.OpenQueryDef("By date")
      ' Set the value of the dp parameter
      Qd!dp = 1991
      ' create a snapshot off of querydef
      Set Sn = Qd.CreateSnapshot()
      Sn.MoveFirst
      Do Until Sn.EOF
         For i = 1 To Sn.Fields.Count - 1
            Print Sn(i) &amp; " ";  'Display results of query
         Next
         Print
         Sn.MoveNext
      Loop
      Sn.Close
      Qd.Close
      db.Close
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 docerr<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
