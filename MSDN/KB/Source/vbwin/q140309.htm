

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Recordset Update Error Differs Between 16-Bit and 32-Bit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140309">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1995/11/29">
<META NAME="Keywords" CONTENT="APrgData APrgDataAcc APrgDataOther kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When running Update method on a recordset, the error message displayed for 16-bit Visual Basic and 32-bit Visual Basic are completely different. However, the cause of the error is the same. You didn't use the AddNew or Edit method before trying to ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB4,QAAP,QBWS,QAXB,QAPN,QAIJ,QBV4,QA5F,QAMA,QAH4,QAKP,QBT6,QBJZ,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Recordset Update Error Differs Between 16-Bit and 32-Bit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140309</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When running Update method on a recordset, the error message displayed for
16-bit Visual Basic and 32-bit Visual Basic are completely different.
However, the cause of the error is the same. You didn't use the AddNew or
Edit method before trying to save changes to a record.
<P>
<P><h3>16-Bit Error</h3>
 
<P>
<PRE>   Run-time error '3426':
   The action was canceled by an associated object.

</PRE><h3>32-Bit Error</h3>
 
<P>
<PRE>   Run-time error '3020':
   Update or CancelUpdate without AddNew or Edit.

</PRE><h2>CAUSE</h2>
 
<P>
The 16-bit error message is actually a Jet version 2.5 error message.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To workaround this bug, use the Edit method before the Update method, prior
to saving the changes to a recordset, as shown below:
<P>
<PRE>   Data1.RecordSet.Edit
   Data1.RecordSet.Update

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the 16-bit version of Visual
Basic 4.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce the Error in Visual Basic 4.0 16-Bit</h3>
 

<OL><P><LI>Start 16-bit Visual Basic 4.0, or if it is already running, click New
    Project on the File menu.

<P><LI>Place a Data control on the Form1 form.

<P><LI>Set the Data control's DatabaseName property to Biblio.mdb.

<P><LI>Set the Data control's RecordSource property to Authors.

<P><LI>Add a TextBox control to the Form1 form. First set the TextBox
    control's DataSource property to Data1 and then set the DataField
    property to Authors.

<P><LI>Add a command button to the Form1 form.

<P><LI>Copy the following code sample to the Form1 code window:
<P>
       Private Sub Command1_Click()
<PRE>          'To prevent the bug, uncomment the next line
          'Data1.RecordSet.Edit
          Data1.RecordSet.Update
       End Sub

</PRE><P><LI>Press the F5 key or click Start on the Run menu to start the program.

<P><LI>Enter some text in the text box.

<P><LI>Click the command button. The following error message appears in the
    Microsoft Visual Basic Dialog Box:
<P>
       Run-time error '3426':
       The action was canceled by an associated object.
<P>
    Click the End button to close the dialog box and end the program.

<P><LI>Save the project. The project can be used to re-create the 32-bit
    error.
<P>
</OL><h3>Steps to Reproduce the Error in Visual Basic 4.0 32-Bit</h3>
 

<OL><P><LI>Start 32-bit Visual Basic 4.0 or if it is already running, click Open
   Project on the File menu.

<P><LI>Open the project that you just saved in step 12 above.

<P><LI>Press the F5 key or click Start on the Run menu to start the program.

<P><LI>Enter some text in the text box.

<P><LI>Click the command button. The following error message appears in the
   Microsoft Visual Basic dialog box:
<P>
<P><PRE>      Run-time error '3020':
      Update or CancelUpdate without AddNew or Edit.
</PRE><P>
<P><PRE>    Click the end button to close the dialog box and end the program.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information on Visual Basic 4.0 error messages, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q136250.htm">Q136250</A></B>
   TITLE     : LONG: List of Trappable Errors for Visual Basic 4.0
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all buglist4.00<BR>
KBCategory: kbbuglist<BR>
KBSubcategory: APrgData* APrgDataAcc APrgDataOther<BR>
Keywords            : APrgData APrgDataAcc APrgDataOther kbbuglist<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
