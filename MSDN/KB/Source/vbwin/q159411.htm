

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Invalid Line in Setup Information File" Error Message </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159411">
<META NAME="KBModify" CONTENT="1997/04/23">
<META NAME="KBCreate" CONTENT="1996/11/13">
<META NAME="Keywords" CONTENT="kbinterop kbsetup kbtool TlsSetWiz vb432 vb4win">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  During the installation of a Visual Basic 4.0 application that uses Jet, a message box entitled  APPNAME Setup  appears with the following error message:     Invalid line in setup information file!     Section: Files    1,,DAO3032.DL_,DAO3032.DLL,$...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QAB4,QBS0,QDIZ,QAH4,QA5J,QA5I,QACI,QBXT,QA5V,QA1S,QAIB,QAEF,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Invalid Line in Setup Information File" Error Message</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159411</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
During the installation of a Visual Basic 4.0 application that uses Jet, a
message box entitled "APPNAME Setup" appears with the following error
message:
<P>
<PRE>   Invalid line in setup information file!

   Section: Files
   1,,DAO3032.DL_,DAO3032.DLL,$(MSDAOPath),$(DLLSelfRegister),$(Shared),
   1/12/1996,456464,3.0.0.2504

</PRE>NOTE: The date, version number, and size shown in the error message may
vary according to the build of Jet being distributed.
<P>
<P><h2>CAUSE</h2>
 
<P>
The 32-bit Jet components are registered as installed to a network server
with a UNC path. The error message appears because this registration occurs
before you install your Visual Basic 4.0 application.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
NOTE: Microsoft Developer Support does not support the modification of the
setup process or any of the setup files. Support is provided for the Setup
Wizard only on an "as is" basis.
<P>
Several workarounds are possible. The following three are recommended:

<OL><P><LI>"Trick" setup into thinking DAO is not installed by removing the
   offending registry reference to the UNC path. Use the Regedit utility to
   find the DAO key. The DAO key is located in:
<P>
   HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\DAO
<P>
   There will be a value named "Path" in the following form:
<P>
   "\\MyServer\DAO\DAO3032.DLL"
<P>
   Rename "Path" to "OldPath," and re-run the application setup.

<P><LI>If the Jet components are already installed on all the workstations,
   remove them from the application setup routine.

<P><LI>(NOTE: This is the most reliable method.) Modify the code in the
   Setup1.vbp project as follows:
<P>
   a. Open the Setup1.vbp project located in \VB\setupkit\setup1\setup1.vbp
<P><PRE>    in 32-bit Visual Basic 4.0.
</PRE><P>
   b. Go to the strGetDAOPath() subroutine in the basSetup1.bas module and
<P><PRE>    locate this section of code:
</PRE><P>
<P><PRE>      If RegOpenKey(HKEY_LOCAL_MACHINE, strKey, hkey) Then
<PRE></PRE>               RegQueryStringValue(hkey, strValueName, strPath)
               RegCloseKey(hkey)
      End If

      Insert this line of code immediately following the preceding section:

      If Left(strPath, 2) = "\\" Then strPath = ""

      If the DAO Path is a UNC Path, Setup1 does not consider Jet to be
      installed.

   c. Save basSetup1.bas and run the Setup Wizard again to re-create the
    setup process for your project.

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
The Setup1 project routines that check the validity of the installation
paths will mark UNC paths as invalid. UNC paths for DAO frequently occur on
systems where you install Office95 from a network server that uses UNC
paths, and select the option to leave system components on the network.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbinterop kbsetup kbtool TlsSetWiz vb432 vb4win<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 23, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
