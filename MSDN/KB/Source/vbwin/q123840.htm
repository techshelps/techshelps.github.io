

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Select a Specific Bar on a 2D Graph with the Mouse </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123840">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/12/13">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article explains how to detect which one of the Slices or Bars on a 2D Bar Graph was selected with the mouse.  MORE INFORMATION  The graph control does not have a built-in method that you can use to discover which bar or slice of a 2D Bar Grap...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGX,QAMN,QBS0,QAPN,QAG9,QA7O,QA2Q,QAYS,QAB5,QAOE,QAG2,QBXS,QAPG,QAH4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Select a Specific Bar on a 2D Graph with the Mouse</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123840</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to detect which one of the Slices or Bars on a 2D
Bar Graph was selected with the mouse.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The graph control does not have a built-in method that you can use to
discover which bar or slice of a 2D Bar Graph your mouse pointer is
currently over. However, the graph control's ColorData property does
correspond to Visual Basic's QBColor() function. Therefore, if you display
the Graph in a picture box by assigning the Graph's picture property to a
picture box, you can use the picture box's Point(x,y) method to compare the
color of the bar at the position of your mouse. You can use this method to
differentiate up to 14 different points.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Start a new project in Visual Basic (ALT, F, N). Form1 is created by
   default.

<P><LI>Add a Label and Graph control. Then add a Picture control on top of the
   graph control; give both controls identical Top, Left, Width, and Height
   property values. Set the GraphType to Pie or Bar chart.

<P><LI>Add the following code to the Form_Load event:
<P>
<PRE>   Sub Form_Load ()
      Picture1.Move Graph1.Left, Graph1.Top, Graph1.Width, Graph1.Height
      Graph1.Visible = False

      ' Set the color to between 1 and the number of slices or Bars you
      ' will have (up to 14).
      For I = 1 to Graph1.NumPoints
          Graph1.ThisPoint = I
          Graph1.ColorData = I
      Next I
      Graph1.DrawMode = 2                'Draw the graph
      Picture1.Picture = Graph1.Picture  'Display in picture box
   End Sub

</PRE><P><LI>Add the following code to the Picture1_MouseDown event:
<P>
<PRE>   ' Place the following two lines on one, single line:
   Sub Picture1_MouseDown (Button As Integer, Shift As Integer,
      X As Single, Y As Single)

      Select Case Picture1.Point(X, Y)
         Case QBColor(1)
             label1.Caption = "1st"
         Case QBColor(2)
             label1.Caption = "2nd"
         Case QBColor(3)
             label1.Caption = "3rd"
         Case QBColor(4)
             label1.Caption = "4th"
         Case QBColor(5)
             label1.Caption = "5th"
         Case QBColor(6)
             label1.Caption = "6th"
         Case QBColor(7)
             label1.Caption = "7th"
         Case QBColor(8)
             label1.Caption = "8th"
         Case QBColor(9)
             label1.Caption = "9th"
         Case QBColor(10)
             label1.Caption = "10th"
         Case QBColor(11)
             label1.Caption = "11th"
         Case QBColor(12)
             label1.Caption = "12th"
         Case QBColor(13)
             label1.Caption = "13th"
         Case QBColor(14)
             label1.Caption = "14th"
      End Select
   End Sub

</PRE><P><LI>Save the project (ALT, F, S).

<P><LI>Run the program by pressing the F5 key. When you click any of the bars
   or Slices, the label will tell you which one you selected.
<P>
</OL><h3>Notes</h3>
 
<P>
-  To change the Data in the graph control and refresh the picture use:
<P>
<PRE>   Graph1.DrawMode = 2
   Picture1.Picture = Graph1.Picture

</PRE></OL>-  ColorData 0 is Black and 15 is White. By default the background is white
<PRE>   and the lines are black, so don't use these colors. If you do, you might
   get invalid information.

</PRE>-  This method will not work reliably if multiple datasets (NumSets &gt; 1) or
<PRE>   3D versions of the bar graph are used. For multiple datasets, you may
   choose a specific color for each set. Then differentiate which set the
   user selects. A 3D bar uses black pixels for the shading effect, so it
   does not lend itself to this technique.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
