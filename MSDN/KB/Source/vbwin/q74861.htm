

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example of Client-Server DDE Between Visual Basic Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74861 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1991/07/31">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article outlines the steps necessary to initiate dynamic data exchange (DDE) between a Microsoft Visual Basic destination application and a Visual Basic source application.  This article demonstrates how to:   - Create a Visual Basic applicati...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBT6,QBV4,QAK6,QAJH,QAGI,QAHP,QAZ2,QAYV,QAD2,QA5F,QAMA,QAY2,QBJZ,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Example of Client-Server DDE Between Visual Basic Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74861 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article outlines the steps necessary to initiate dynamic data
exchange (DDE) between a Microsoft Visual Basic destination application
and a Visual Basic source application.
<P>
This article demonstrates how to:

<UL><LI>Create a Visual Basic application to function as a DDE source.
<LI>Create a Visual Basic application to function as a DDE destination.
<LI>Initiate a manual DDE link (information updated upon request from the
   destination) between the destination application and the source
   application.
<LI>Use LinkRequest to update information in the destination application
   from information in the source application.
<LI>Initiate a automatic DDE link (information updated automatically from
   source to destination) between the destination application and the
   source application.
<LI>Use LinkPoke to send information from the destination application to
   the source application.
<LI>Change the LinkMode property between automatic and manual.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This information is included with the Help file provided with Microsoft
Professional Toolkit for Visual Basic version 1.0, Microsoft Visual Basic
version 2.0, and Microsoft Visual Basic version 3.0.
<P>
A destination application sends commands through DDE to the source
application to establish a link. Through DDE, the source provides data to
the destination at the request of the destination or accepts information
at the request of the destination.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The steps below show how to establish a DDE conversation between two
Visual Basic applications.
<P>
<P><h3>STEP ONE: Create the Source Application in Visual Basic</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Change the Caption property of Form1 to Source.

<P><LI>Change the Form1 LinkMode property to 1 - Source.

<P><LI>Put a Text Box (Text1) on Form1.

<P><LI>Save the form and project with the name SOURCE.

<P><LI>From the File menu, choose Make EXE File. In the Make EXE File dialog
   box, choose OK to accept SOURCE.EXE as the name of the EXE file.
<P>
</OL><h3>STEP TWO: Create the Destination Application in Visual Basic</h3>
 

<OL><P><LI>From the File menu, choose New Project. Form1 is created by default.

<P><LI>Change the Caption property of Form1 to Destination.

<P><LI>Add the following controls to Form1, and give them the properties
   indicated:
<P>
<PRE>   Default Name   Caption            Name
   -----------------------------------------
   Text1          (Not applicable)   Text1
   Option1        Manual Link        ManualLink
   Option2        Automatic Link     AutomaticLink
   Command1       Poke               Poke
   Command2       Request            Request

</PRE><P><LI>Add the following code to the General Declaration section of Form1:
<P>
   Const AUTOMATIC= 1
   Const MANUAL = 2
   Const NONE = 0
<P>
<PRE>   '(NOTE:  For Visual Basic version 1.0, also add the following
   '        constants:
   'Const True = -1
   'Const False = 0

</PRE><P><LI>Add the following code to the Load event procedure of Form1:
<P>
<PRE>   Sub Form_Load ()
      'This procedure will start the VB source application.

      z% = Shell("SOURCE", 1)

      z% = DoEvents()   'Causes Windows to finish processing Shell command.

      Text1.LinkMode = NONE   'Clears DDE link if it already exists.

      Text1.LinkTopic = "Source|Form1"   'Sets up link with VB source.
      Text1.LinkItem = "Text1"           'Set link to text box on source.
      Text1.LinkMode = MANUAL            'Establish a manual DDE link.
      ManualLink.Value = TRUE            'Sets appropriate option button.
   End Sub

</PRE><P><LI>Add the following code to the Click event procedure of ManualLink:
<P>
<PRE>   Sub ManualLink_Click ()
      Request.Visible = TRUE    'Make request button valid.
      Text1.LinkMode = NONE     'Clear DDE Link.
      Text1.LinkMode = MANUAL   'Reestablish new LinkMode.
   End Sub

</PRE><P><LI>Add the following code to the Clink event procedure of AutomaticLink:
<P>
<PRE>   Sub AutomaticLink_Click ()
      Request.Visible = FALSE   'No need for button with automatic link.
      Text1.LinkMode = NONE     'Clear DDE Link.

      Text1.LinkMode = AUTOMATIC   'Reestablish new LinkMode.
   End Sub

</PRE><P><LI>Add the following code to the Click event procedure of Request:
<P>
<PRE>   Sub Request_Click ()
      'With a manual DDE link, this button will be visible, and when
      'selected it will request an update of information from the source
      'application to the destination application.
      Text1.LinkRequest
   End Sub

</PRE><P><LI>Add the following code to the Click event procedure of Poke:
<P>
<PRE>   Sub Poke_Click ()
      'With any DDE link, this button will be visible, and when it's
      'selected, will poke information from the destination application
      'into the source application.
      Text1.LinkPoke
   End Sub

</PRE></OL><h3>STEP THREE: Run the Visual Basic Destination Application</h3>
 
<P>
Choose one of these options:

<UL><LI>Run the Visual Basic destination application from the VB.EXE
   environment by skipping to step 4 below.
<LI>Save the application. Then create an .EXE file and run it from Windows
   by beginning with step 1 below.

</UL><OL><P><LI>From the File menu, choose Save, and save the form and project with
   the name DEST.

<P><LI>From the File menu, choose Make EXE File, and give it the name DEST.EXE.

<P><LI>Exit the Visual Basic environment (VB.EXE).

<P><LI>Run the application from Windows if it's an .EXE file or from the
   VB.EXE environment.

<P><LI>Form1 of the destination application will load and the source
   application will automatically start.
<P>
</OL><h3>STEP FOUR: Experiment with DDE Between Visual Basic Applications</h3>
 

<OL><P><LI>Try typing some text into the source application's text box. Then click
   the Request button. The text appears in the destination application's
   text box.

<P><LI>Click the Automatic Link button and then type some more text into the
   source application's text box. The text is automatically updated in the
   destination application's text box.

<P><LI>Type some text into the destination application's text box. Then click
   the Poke button to send the text to the source application's text box.
<P>
</OL>For additional information on dynamic data exchange (DDE) between Visual
Basic and other Windows-based applications, query on the following words
in the Microsoft Knowledge Base:
<P>
<PRE>   DDE and Visual Basic
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbinterop kbprg kbcode<BR>
KBSubcategory: IAPDDE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
