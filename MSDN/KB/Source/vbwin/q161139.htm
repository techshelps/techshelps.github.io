

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Custom ActiveX Property Sheet Entries Are Not Saved </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161139">
<META NAME="KBModify" CONTENT="1997/03/24">
<META NAME="KBCreate" CONTENT="1996/12/17">
<META NAME="Keywords" CONTENT="kbprg vb5all vb5howto VBKBAX VBKBProgramming kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  ActiveX control property changes entered via a property page are not saved. However, if you enter the properties via the standard property pane that comes with Visual Basic, the changes are saved.  CAUSE =====  The UserControl needs to explicitly i...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QAB5,QA7O,QAOE,QAMN,QBWC,QAHV,QAUR,QAU7,QAFF,QDN1,QBE7,QBE6,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Custom ActiveX Property Sheet Entries Are Not Saved</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161139</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation and Enterprise Editions,
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
ActiveX control property changes entered via a property page are not saved.
However, if you enter the properties via the standard property pane that
comes with Visual Basic, the changes are saved.
<P>
<P><h2>CAUSE</h2>
 
<P>
The UserControl needs to explicitly inform the host development environment
of any property changes that are made via property pages or are side
effects of other property changes.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To tell the host development environment of property changes, the
UserControl must invoke the PropertyChanged method of the Extender object.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When entering properties via the standard property pane, the host
application is setting the properties for your control and, therefore,
knows they have been changed.
<P>
The host application knows nothing about changes you make via property
pages or that there are side effects of other property changes. The user
control needs to explicitly tell the host application that properties have
been changed, so it can see the changes and save them.
<P>
The following example illustrates setting properties:
<P>
<PRE>   ------ in the property page ------

      Private Sub LabelCaption_Changed()
        Changed = True     ' Enable Apply button
      End Sub

      Private Sub ApplyChanges()
      Dim X As Variant
        For Each X In SelectedControls
          X.Caption = LabelCaption.Text
        Next X
      End Sub

   ------ in the user control ------

      Public Property Let Caption(ByVal NewVal As String)
        lblMain.Caption = NewVal
        PropertyChanged "Caption"
      End Sub

</PRE>This code assumes that you have all other supporting code working, such as
the InitProperties, ReadProperties, and WriteProperties events.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Visual Basic Online Help, PropertyChanged Method
<P>
Microsoft Visual Basic Component Tools Guide, Chapter 9, Building ActiveX
Controls, Adding Properties to Controls, Implement Control Properties Using
Property Procedures
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg vb5all vb5howto VBKBAX VBKBProgramming kbprb<BR>
Technology          : kbole<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 24, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
