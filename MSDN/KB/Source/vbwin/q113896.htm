

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: No Update When Delete All MESSAGE_SHOWADBOOK Recipients </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113896">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="APrgOther kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When using the MAPI message action MESSAGE_SHOWADBOOK (11) while composing a message, you can select entries from the address book and those entries are reflected in the recipients list. But if you then go into the address book and delete all the e...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAD2,QBXB,QBS0,QA01,QAGB,QBT6,QBV4,QBCT,QAXB,QAGC,QAEF,QBXD,QAR4,QBWS,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: No Update When Delete All MESSAGE_SHOWADBOOK Recipients</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113896</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows, version 3.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the MAPI message action MESSAGE_SHOWADBOOK (11) while composing
a message, you can select entries from the address book and those entries
are reflected in the recipients list. But if you then go into the address
book and delete all the entries, then when the dialog box terminates, it
will not update the recipients list. It leaves all prior entries
unmodified.
<P>
As a result, there's no way to detect if the user has used the dialog box
to delete all the entries on the "To:" line.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you use MESSAGE_SENDDLG to bring up the MAPI compose dialog box, you can
click the address button to display the address book. If you delete all the
entries from the dialog here, the changes are reflected in the Send dialog
box. The problem only occurs when you bring up the Address book dialog box
directly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem has been corrected in Visual
Basic version 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add two text boxes (Text1, Text2), a command button (Command1), a
   MAPISession control (MAPISession1), and a MAPIMessages control
   (MAPIMessages1) to Form1.

<P><LI>Add the following constants to the general declarations section:
<P>
   Const MESSAGE_SHOWADBOOK = 11
   Const SESSION_SIGNON = 1

<P><LI>Add the following code to your form in the appropriate event procedures:
<P>
<PRE>   Sub Form_Load ()
      MAPISession1.Action = SESSION_SIGNON
      MAPIMessages1.SessionID = MAPISession1.SessionID
   End Sub

   Sub Command1_Click ()
      MAPIMessages1.MsgIndex = -1
      MAPIMessages1.AddressEditFieldCount = 1
      MAPIMessages1.Action = MESSAGE_SHOWADBOOK
      Text1.Text = Str(MAPIMessages1.RecipCount)
      Text2.Text = ""
      For i = 0 To MAPIMessages1.RecipCount - 1
         MAPIMessages1.RecipIndex = i
         Text2.Text = Text2.Text &amp; MAPIMessages1.RecipDisplayName &amp; ";"
      Next i
      MAPIMessages1.RecipIndex = 0
   End Sub

</PRE><P><LI>Press the F5 key to run the program.

<P><LI>Click the command button and select some entries in the address book.
   You will see them in the text box.

<P><LI>Now click the button again. Delete all the entries in the dialog box.
   When you click OK and return, you'll see that it is as if nothing
   happened in the dialog box. This diminishes the usability of the Address
   dialog box.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 3.00 fixlist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgOther<BR>
Keywords          : APrgOther kbbuglist kbprg<BR>
Version           : 3.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
