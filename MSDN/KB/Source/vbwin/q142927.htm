

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: First of Two Bound Masked Edit Controls Clears on AddNew </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142927">
<META NAME="KBModify" CONTENT="1997/03/12">
<META NAME="KBCreate" CONTENT="1996/01/22">
<META NAME="Keywords" CONTENT="PrgCtrlsStd">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Only the first of two bound Masked Edit Controls clears when clicking on the move next button off the last record of the recordset when the EOFAction property of the data control is set to 2-Add New.  CAUSE =====  When you click on the move next bu...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAHP,QAJX,QADR,QA7O,QAB5,QAOE,QAMN,QBV4,QBS0,QAPN,QACI,QA9N,QA5V,QANJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: First of Two Bound Masked Edit Controls Clears on AddNew</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142927</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>4.00    | 4.00
</PRE>Windows | Windows NT
kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Only the first of two bound Masked Edit Controls clears when clicking on
the move next button off the last record of the recordset when the
EOFAction property of the data control is set to 2-Add New.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you click on the move next button to add a new record, both Masked
Edit Controls should clear. This is a bug between the interaction of the
data control and the Masked Edit Box control.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Place the following code in the Validate event of the data control:
<P>
<PRE>Private Sub Data1_Validate(Action As Integer, Save As Integer)
  If Action = vbDataActionAddNew Then
    MaskEdBox1.SelText = ""
    MaskEdBox2.SelText = ""
  End If
End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a issue in the Microsoft products listed
at the beginning of the article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem in Visual Basic Version 4.0</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Standard Data Control to Form1.

<P><LI>Connect Data1 on Form1 to a table in a database as follows: Select the
   Data Control and press the F4 key to display the Properties window. Set
   the DatabaseName property to BIBLIO.MDB, the RecordSource property to
   the source table name Authors, and set the EOFAction property to 2-
   AddNew.

<P><LI>Add two Masked Edit controls to Form1. If this control is not visible in
   your toolbar, select Custom Controls from the Tools menu and select the
   Microsoft Masked Edit Control from the list of controls. Set the
   DataSource property of each to Data1, and the DataField property of one
   to Author, and the other to Year Born.

<P><LI>Start the program, or press the F5 key. Move last, then move next to go
   to an empty record. Add data to both fields, then move next again. Only
   one of the Masked Edit Boxes will clear the displayed value. If you use
   Textboxes or SSPanels they will both correctly clear. From now on, each
   move next after an AddNew will clear only one of the masked edit boxes.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win<BR>
KBCategory: kpbrg kbbuglist<BR>
KBSubcategory: PrgCtrlsStd<BR>
Keywords            : PrgCtrlsStd<BR>
Version             : 4.00    | 4.00<BR>
Platform            : Windows<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
