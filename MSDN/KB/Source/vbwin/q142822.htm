

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use DDE with Visual Basic and Windows Program Manager </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142822">
<META NAME="KBModify" CONTENT="1996/01/23">
<META NAME="KBCreate" CONTENT="1996/01/21">
<META NAME="Keywords" CONTENT="kbinterop kbprg kbcode kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article demonstrates how to send dynamic data exchange (DDE) interface commands to the Microsoft Windows Program Manager from Microsoft Visual Basic for Windows using DDE.  The interface commands available through DDE with the Windows Program ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBS0,QBWQ,QAH4,QAH5,QAGU,QABO,QAD2,QAZ2,QAPN,QAGQ,QAJH,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use DDE with Visual Basic and Windows Program Manager</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142822</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to send dynamic data exchange (DDE)
interface commands to the Microsoft Windows Program Manager from
Microsoft Visual Basic for Windows using DDE.
<P>
The interface commands available through DDE with the Windows Program
Manager are as follows:
<P>
<PRE>   CreateGroup(GroupName,GroupPath)
   ShowGroup(GroupName,ShowCommand)
   AddItem(CommandLine,Name,IconPath,IconIndex,XPos,YPos)
   DeleteGroup(GroupName)
   ExitProgman(bSaveState)

</PRE>A full explanation of the above commands can be found in Chapter 22 of the
"Microsoft Windows Software Development Kit Guide to Programming" version
3.1 manual. The Microsoft Windows Software Development Kit can be found in
the MSDN/VB Starter Kit which is distributed with the Professional and
Enterprise editions of Visual Basic 4.0.
<P>
An application can also obtain a list of Windows groups from the Windows
Program Manager by issuing a LinkRequest to the "PROGMAN" item.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following program demonstrates how to use four of the five Windows
Program Manager DDE interface commands and the one DDE request:

<OL><P><LI>Run Visual Basic for Windows, or on the File menu, click New Project
   (ALT, F, N) if Visual Basic for Windows is already running. Form1 is
   created by default.

<P><LI>Create the following controls with the given properties on Form1:
<P>
<PRE>      Object     Name         Caption
      ------     --------     -------
      TextBox    Text1
      Button     Command1     Make
      Button     Command2     Delete
      Button     Command3     Request

    (In Visual Basic version 1.0 for Windows, set the CtlName Property
     for the above objects instead of the Name property.)

</PRE><P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Private Sub Command1_Click ()
      Text1.LinkTopic = "ProgMan|Progman"
      Text1.LinkMode = 2               ' Establish manual link.

      Text1.LinkExecute "[CreateGroup(Test Group)]"
          ' Make a group in Windows Program Manager.

      Text1.LinkExecute "[AddItem(c:\vb\vb.exe, Visual Basic)]"
          ' Add an item to that group.

      Text1.LinkExecute "[ShowGroup(Test Group, 7)]"
          ' Iconize the group and focus to VB application.

   On Error Resume Next  ' Disconnecting link with Windows Program
   Text1.LinkMode = 0    '  Manager causes an error in Windows 3.0.
             ' This is a known problem with Windows Program Manager.
   End Sub

</PRE><P><LI>Add the following code to the Command2_Click event:
<P>
<PRE>   Private Sub Command2_Click ()
      Text1.LinkTopic = "ProgMan|Progman"
      Text1.LinkMode = 2          ' Establish manual link.

      Text1.LinkExecute "[DeleteGroup(Test Group)]"
          ' Delete the group and all items within it.

      On Error Resume Next  ' Disconnecting link with Windows Program
      Text1.LinkMode = 0    '  Manager causes an error in Windows 3.0.
                 ' This is a known problem with Windows Program Manager.
   End Sub

</PRE><P><LI>Add the following code to the Command3_Click event:
<P>
<PRE>   Private Sub Command3_Click ()
      Text1.LinkTopic = "ProgMan|Progman"
      Text1.LinkItem = "PROGMAN"
      Text1.LinkMode = 2      ' Establish manual link.
      Text1.LinkRequest       ' Get a list of the groups.

      On Error Resume Next  ' Disconnecting link with Windows Program
      Text1.LinkMode = 0    '  Manager causes an error in Windows 3.0.
             ' This is a known problem with Windows Program Manager.
   End Sub

</PRE><P><LI>Press the F5 key to run the program.

<P><LI>Click the Make button, and then click the Delete button. Note the
   result.

<P><LI>Click the Request button. This puts a list of the groups in the Windows
   Program Manager to be placed in the text box. The individual items are
   delimited by a carriage return plus linefeed.
<P>
</OL>As noted in the Windows Software Development Kit (SDK) manual mentioned
above, the ExitProgman() command only works if the Windows Program Manager
is NOT the shell (the startup program when you start Windows).
<P>
For a more comprehensive explanation of the CreateGroup(), ShowGroup(),
AddItem(), DeleteGroup(), and ExitProgman() commands, query on the
following words in the Microsoft Knowledge Base:
<P>
<PRE>   DDE and CreateGroup
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 4.00 vb4win vb416<BR>
KBCategory: kbinterop kbprg kbcode kbhowto<BR>
KBSubcategory: IAPDDE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
