

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Use DDE Between Visual Basic and FoxPro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113477">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/04/05">
<META NAME="Keywords" CONTENT="kbinterop kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article outlines the steps necessary to initiate dynamic data exchange (DDE) between a FoxPro Macro and a Visual Basic application at run time. Specifically, this article demonstrates how to:   - Prepare and load a sample FoxPro Macro that wil...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAZ2,QBWS,QAYV,QAGI,QA5F,QAMA,QAPN,QAJH,QAUD,QAIJ,QBXS,QBUG,QBUF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use DDE Between Visual Basic and FoxPro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113477</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, version 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article outlines the steps necessary to initiate dynamic data exchange
(DDE) between a FoxPro Macro and a Visual Basic application at run time.
Specifically, this article demonstrates how to:

<UL><LI>Prepare and load a sample FoxPro Macro that will perform DDE.
<LI>Initiate a manual DDE link.
<LI>Use LinkRequest to return information generated by the FoxPro
   application.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
A destination application sends commands through DDE to the source
application to establish a link. Through DDE, the source provides data to
the destination at the request of the destination or accepts information at
the request of the destination.
<P>
The following example shows how to establish a DDE conversation between
a FoxPro application and a Visual Basic application.
<P>
Preparing FoxPro for DDE
 

<OL><P><LI>Start FoxPro for Windows.

<P><LI>From the FoxPro menu, choose Select Run Application. A dialog box should
   appear offering you the FoxPro applications available to run.

<P><LI>Locate \FoxPro\Sample\DDE\DDEData.Prg. Double-click the application name
   or click to select the application, and choose the Run button. This
   starts and runs a FoxPro application that will respond to the DDE
   commands from Visual Basic. This code sets up the equivalent of a Visual
   Basic Select Case to identify the commands sent and determine which'
   portion of the code to run. Examine the FoxPro code for more detail on
   how this is accomplished with FoxPro.
<P>
</OL><h3>Preparing Visual Basic for DDE</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a Text box (Text1) to Form1.

<P><LI>Add the following code in the Form_Click event of the form:
<P>
<PRE>   Sub Form_Click ()
      Text1.LinkMode = 0           ' Disable any existing links.
      ' Enter the following two lines as one, single line of code:
      Text1.LinkTopic =
         "ddedata|c:\foxpro\sample\organize\dbfs;TABLE personal"

      ' This sets your link to : foxapp|databasename;TABLE tablename
      Text1.LinkMode = 2           ' Set cold link.
      Text1.LinkItem = "FirstRow"
      ' This link item is a defined word that the foxapp searches on.
      Text1.LinkRequest            ' Ask for the return value from FoxPro.
   End Sub

</PRE></OL>This code initiates a manual DDE link from Visual Basic for Windows to
FoxPro for Windows. It then uses LinkRequest to request the FirstRow of
information from FoxPro, which is returned in Text1.Text.
<P>
The syntax for a more generic example would be:
<P>
Text1.LinkMode = 0
Text1.LinkTopic = "&lt;FoxAppName&gt;|&lt;PathToDB&gt;;&lt;FoxsDataParam&gt; &lt;FoxsItemParam&gt;"
<P>
FoxPro handles all of the recognized actions in a Do Case statement, which
is equivalent to a Visual Basic Select Case statement. In this case, the
action triggered is an INITIATE, which recognizes only certain sData, sItem
combinations. INITIATE expected data is: the keyword TABLE and the name of
the table (tablename). The next action triggered is REQUEST, which
recognizes only keywords in a nested Do Case statement.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: FOXPRO 2.50 Fox Pro 3.00<BR>
KBCategory: kbinterop kbcode<BR>
KBSubCategory: IAPDDE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
