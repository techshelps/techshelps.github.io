

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Iterate Controls on a Form from a Property Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161056">
<META NAME="KBModify" CONTENT="1997/03/18">
<META NAME="KBCreate" CONTENT="1996/12/16">
<META NAME="Keywords" CONTENT="kbusage vb5all vb5howto VBKBComp VBKBCtrl_VBKBAX_VB kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Microsoft Visual Basic version 5.0 enables you to create custom property pages for user-defined ActiveX controls. These property pages can contain controls and fields that change the properties of the user-defined control.  The property pages can a...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QAB5,QAMN,QAOE,QBS0,QAHV,QAH4,QAY5,QAW6,QAUD,QBWA,QAGU,QBWC,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Iterate Controls on a Form from a Property Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161056</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   for Windows, version 5.0
<LI>Microsoft Visual J++, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Visual Basic version 5.0 enables you to create custom property
pages for user-defined ActiveX controls. These property pages can contain
controls and fields that change the properties of the user-defined control.
<P>
The property pages can also be extended to change properties of other
controls that may be contained within the form where the user-defined
control is located.
<P>
The property page, by default, can only access public properties of the
user-defined control for which it was written. However, by using the
ParentControls collection and a Friend function, you can create a route
through which you can expose the other controls contained within the parent
form.
<P>
The use of the Friend function enables components within the ActiveX
control to use this function, while hiding it from use outside the
immediate project. The ParentControls collection returns the objects within
the parent container. This includes returning item(0) as a reference to the
parent container.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To enable a property page for a user-defined ActiveX control to gain access
to the container form's set of controls, do the following:

<OL><P><LI>Start Microsoft Visual Basic. Load an ActiveX control project, or create
   a new one.

<P><LI>Add the following code in the control's code window:
<P>
<P><PRE>      Friend Function FormControls() As Object
<PRE></PRE>          Set FormControls = ParentControls
          'Returns the collection of controls on the parent form.
      End Function

</PRE><P><LI>From the Project menu, click Add Property Page.

<P><LI>Add the following code in the Property Page's code window:
<P>
<P><PRE>      Private Sub PropertyPage_SelectionChanged()
<PRE></PRE>          Dim UC As UserControl1  'Make sure that UC is typed explicitly as
                                  'the user-defined control you are working
                                  'with. To use Friend functions, you must
                                  'early-bind your variables.
          Dim Ctrl As Object
          Set UC = SelectedControls(0)  'Return selected control.
          For Each Ctrl In UC.FormControls  'Iterate through the use of
                                            'UC's friend function.
          Debug.Print Ctrl.Name  'Output the name of each control.
          Next Ctrl
      End Sub

</PRE><P><LI>Switch to the UserControl1 object. On the properties list, click
   Property Pages. Turn on the option for PropertyPage1.
<P>
</OL>Now when you use this custom ActiveX control on a form, you can choose
<PRE>'Custom' from the properties list to bring up the Property Page.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Visual Basic Online Help
Keywords: Friend, Extender
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hidden private<BR>
Keywords            : kbusage vb5all vb5howto VBKBComp VBKBCtrl_VBKBAX_VB kbhowto<BR>
Version             : 5.00<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
