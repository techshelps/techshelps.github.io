

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Invalid Operation After Setting RDC Resultset = Nothing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153017">
<META NAME="KBModify" CONTENT="1996/10/09">
<META NAME="KBCreate" CONTENT="1996/06/26">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Executing a refresh method against a remote data control after setting the RDC's Resultset property to Nothing can cause one of these errors:      Invalid operation for forward only cursor      -or-      Unknown error or operation   CAUSE =====  Th...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QABA,QBS0,QBAO,QAPN,QAH4,QAB4,QAAP,QAKP,QBWS,QAY5,QAI4,QAIJ,QBWC,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Invalid Operation After Setting RDC Resultset = Nothing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153017</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Enterprise Editions of Microsoft Visual Basic for Windows,
   32-bit only, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Executing a refresh method against a remote data control after setting the
RDC's Resultset property to Nothing can cause one of these errors:
<P>
<PRE>   "Invalid operation for forward only cursor"

   -or-

   "Unknown error or operation"

</PRE><h2>CAUSE</h2>
 
<P>
This error occurs because setting the ResultSet property to Nothing also
causes the ResultsetType property to be set to 0. Zero is not a valid
setting for the ResultsetType property.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid this problem, set the ResultsetType property to the valid value of
1 after setting the Resultset equal to Nothing. For example, the following
code will work correctly and not cause any errors:
<P>
<PRE>   Set MSRDC1.Resultset = Nothing
   MSRDC1.ResultsetType = 1
   MSRDC1.Refresh

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. Microsoft is researching this problem and
will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps To Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic 4.0. Form1 is created by default.

<P><LI>Add a single Remote Data control to Form1.

<P><LI>Add the following code to the form, making sure to change the
   OpenConnection parameters to match an existing data source:
<P>
<PRE>   Private Sub Form_Click()
      Dim cn As rdoConnection
        Dim rsTemp As rdoResultset

        Set cn = rdoEnvironments(0).OpenConnection("", rdDriverNoPrompt, _
         False, "DSN=MyDSN;database=pubs;uid=sa;pwd=;")
        Set rsTemp = cn.OpenResultset("Select * From Authors;", _
         rdOpenKeyset)
        Set MSRDC1.Resultset = rsTemp
        MSRDC1.Refresh
        Set MSRDC1.Resultset = Nothing
        MSRDC1.Refresh
   End Sub

</PRE><P><LI>Press the F5 key, or select Start from the Run menu to run the
   application. Click once on the form to execute the code and to see the
   error.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb432<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgDataODBC
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
