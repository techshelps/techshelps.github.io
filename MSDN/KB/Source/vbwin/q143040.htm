

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Call a Visual Basic 4.0 OLE Server from Project 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143040">
<META NAME="KBModify" CONTENT="1996/05/20">
<META NAME="KBCreate" CONTENT="1996/01/24">
<META NAME="Keywords" CONTENT="kbusage kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Visual Basic 4.0 allows you to build OLE Servers, and to build applications that can use them. These calling applications are also referred to as containers. Microsoft Project 4.0 is an OLE Automation Client application; therefore it can be used to...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA9Q,QA01,QA2Q,QAGI,QBWS,QAG2,QAY2,QAYZ,QAH4,QBJZ,QAJN,QABI,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Call a Visual Basic 4.0 OLE Server from Project 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143040</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional and Enterprise Editions of Microsoft
   Visual Basic, version 4.0, for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic 4.0 allows you to build OLE Servers, and to build applications
that can use them. These calling applications are also referred to as
containers. Microsoft Project 4.0 is an OLE Automation Client application;
therefore it can be used to call methods and properties from OLE servers
created with Visual Basic 4.0. This article describes the process of using
OLE servers created by Visual Basic 4.0 with Project 4.0. The example uses
the OLE server example created in the following Microsoft Knowledge Base
article:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B>
   TITLE     : How to Create and Use a Minimal OLE Automation Server

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Prior to following this example, make sure you have built the OLE Server
discussed in <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B> and have created an EXE file.
<P>
<P><h3>Steps to Use a Visual Basic 4.0 OLE Server with Project 4.0</h3>
 

<OL><P><LI>Start Project 4.0 with the default project, Project1.

<P><LI>Select Project's Tools menu and choose the Macro item from this menu.
   The Macros dialog will then appear.

<P><LI>From the Macros dialog box, select the New button. The New Macro dialog
   box will appear with a default name of Macro1. Select OK.

<P><LI>Now select Project's Tools menu and choose the References item. This
   will bring up the References dialog box.

<P><LI>From the References dialog box, select the browse button. This will
   bring up the Browse dialog box.

<P><LI>In the FileName section of the browse dialog box, change the listings
   to *.EXE. This will allow us to look for our OLE Server we have
   already created as an executable file.

<P><LI>Use the dialog box to move to the drive and directory containing the OLE
   server and select it. Then select the OK button.

<P><LI>Now you will see Project1 in the Available References box in the
   References dialog. Project1 should be checked, if it is not then select
   it. Once you confirm Project1 is in the list and checked, click OK.
   You now have a reference to the OLE server in Project.

<P><LI>Place the following code into the macro.
<P>
<P><PRE>      Dim MyObj As Object
</PRE><P>
<PRE>        Set MyObj = CreateObject("Project1.Class1")

        MsgBox MyObj.MyString
        MsgBox MyObj.MyFunction()

        Set MyObj = Nothing

    Note the parentheses following the line MsgBox MyObj.Myfunction(). The
    parentheses are not required when calling an OLE Server from Visual
    Basic 4.0, but they are required when you call an OLE Server from
    Project 4.0.

</PRE><P><LI>Now select Project's Run menu and select the Start item. When this
   subroutine executes, you will get two message boxes. The first one will
   say "Life is like a box of chocolates." and the second one will say
   "You never know what you're gonna get."
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win<BR>
KBCategory: kbusage kbhowto<BR>
KBSubcategory: IAPOLE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
