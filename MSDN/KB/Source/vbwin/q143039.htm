

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calling Visual Basic 4.0 OLE Server from Microsoft Access 2.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143039">
<META NAME="KBModify" CONTENT="1996/05/22">
<META NAME="KBCreate" CONTENT="1996/01/24">
<META NAME="Keywords" CONTENT="kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Visual Basic 4.0 allows you to not only build OLE Servers but build applications which can use them. Microsoft Access 2.0 is an OLE Automation Client application, therefore it can be used to call methods and properties from OLE servers created with...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QAH4,QAYZ,QBWS,QDN9,QA2Q,QAUR,QBJZ,QA9Q,QAG2,QAY2,QA5F,QAMA,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Calling Visual Basic 4.0 OLE Server from Microsoft Access 2.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 22, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143039</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard, Professional, and Enterprise Editions of Microsoft Visual
<PRE>  Basic, for Windows, version 4.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Visual Basic 4.0 allows you to not only build OLE Servers but build
applications which can use them. Microsoft Access 2.0 is an OLE Automation
Client application, therefore it can be used to call methods and properties
from OLE servers created with Visual Basic 4.0. This article will describe
the process of using OLE servers created by Visual Basic 4.0 with Access
2.0. The example will be using the OLE server example created in the
Microsoft Knowledge Base article <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B>, "How to Create and Use a Minimal
OLE Automation Server."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Prior to following this example, make sure you have built the OLE Server
discussed in <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B>, and have built an EXE file.
<P>
<P><h3>Steps to Use a Visual Basic 4.0 OLE Server with Access 2.0</h3>
 

<OL><P><LI>Start Access 2.0, from the File menu select New Database and accept the
   default database, Db1.mdb.

<P><LI>From the Access 2.0 database window, select the Module Tab.

<P><LI>Now select the New button at the top of the database window to build a
   new Access Basic module.

<P><LI>Type the following code in the module.
<P>
   Function CallServer () As Integer
<P>
<P><PRE>     Dim MyObj As Object
</PRE><P>
<P><PRE>     Set MyObj = CreateObject("Project1.Class1")
</PRE><P>
<P><PRE>     MsgBox MyObj.MyString
     MsgBox MyObj.MyFunction
</PRE><P>
   End Function

<P><LI>Save this function, by selecting the File menu and choosing the Save
   item. Accept the default to save the module as Module1. You may now
   close the code window.

<P><LI>From the Access database window, now select the Macro Tab. Then select
   the new button. We will now be able to write a macro which calls our
   Access Basic code.

<P><LI>From the macro design screen, select Run code from the combo box under
   the Action column.

<P><LI>Now a textbox will appear at the bottom of this screen labeled as
   Function Name. Click on the text box, and a button with three dots will
   appear. Click on this button.

<P><LI>The Expression Builder dialog now appears. Double click on the functions
   folder in the lower-left corner of the dialog box.

<P><LI>You will see a sub folder of the functions folder labeled DB1, standing
<P><PRE>    for the name of our database. Double-click this folder.
</PRE>
<P><LI>Select the paste button. The CallServer() function will be pasted in as
<P><PRE>    the parameter to the RunCode Macro. Select OK from the Expression
    Builder dialog box to close the dialog box.
</PRE>
<P><LI>Save this macro, by selecting the File menu and choosing the Save item.
<P><PRE>    Accept the default to save the macro as Macro1. You may now close the
    macro window.
</PRE>
<P><LI>Select the macro in the Database window.

<P><LI>Select the run button to run the macro. When this function executes,
<P><PRE>    you will get two message boxes. The first one will say, "Life is like a
    box of chocolates." The second one will say, "You never know what
    you're gonna get."
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win text box<BR>
KBCategory: kbinterop<BR>
KBSubcategory: IAPOLE APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 22, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
