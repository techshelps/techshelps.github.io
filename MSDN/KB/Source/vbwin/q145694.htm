

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SaveSetting &amp; GetSetting Allow Nested Settings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145694">
<META NAME="KBModify" CONTENT="1996/02/09">
<META NAME="KBCreate" CONTENT="1996/02/05">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  It is possible to use the SaveSetting statement to create nested levels of keys and values in the Registry. This behavior is desirable in some cases.  For example, when receiving the location of a SYSTEM.MDA file, the Access engine expects the Syst...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAJQ,QAJ8,QABA,QBAO,QA5F,QAH4,QA1S,QALH,QAKD,QDMW,QBVV,QA5B,QAY5,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SaveSetting &amp; GetSetting Allow Nested Settings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145694</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
It is possible to use the SaveSetting statement to create nested levels of
keys and values in the Registry. This behavior is desirable in some cases.
<P>
For example, when receiving the location of a SYSTEM.MDA file, the Access
engine expects the SystemDB value to exist in a subkey of Engines\Jet, like
this:
<P>
HKEY_CURRENT_USER
<PRE>   \Software
      \VB and VBA Program Settings
         \MyApp
            \Engines
               \Jet
                  SystemDB = c:\access\system.mda

</PRE>Simply using the syntax for GetSetting supplied in the documentation and
online help does not allow for this functionality.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can create nested levels in the Registry by using this syntax:
<P>
<PRE>   SaveSetting "TestApp", "Test2\Test3", "TestVal", "TestSetting"

</PRE>This will create a section of the Registry that looks like:
<P>
HKEY_CURRENT_USER
<PRE>   \Software
      \VB and VBA Program Settings
         \TestApp
            \Test2
               \Test3
                  TestVal = TestSetting

</PRE>This will only work with the 32-bit version of Visual Basic 4.0. If the
same line of code is executed with Visual Basic 4.0 16-bit, the result will
be a file named TESTAPP.INI, with the following section:
<P>
<PRE>   [Test2\Test3]
   TestVal=TestSetting

</PRE>To retrieve values stored in the Registry like this, use the same syntax
with the GetSetting function.
<P>
Some restrictions are inherited when creating nested keys with SaveSetting.
<P>
DeleteSetting and GetAllSettings do not work in the same fashion as they do
with non-nested keys.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: Kbprg<BR>
KBSubcategory: prgother<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 9, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
