

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Visual Basic UserDocuments Are Displayed as Garbage Text </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172063">
<META NAME="KBModify" CONTENT="1997/08/04">
<META NAME="KBCreate" CONTENT="1997/07/28">
<META NAME="Keywords" CONTENT="vb5all VBKBAX VBKBComp VBKBInet">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When the UserDocument files are placed on a UNIX or NetScape Web server, Internet Explorer (IE) will fail to display the UserDocument correctly. IE will interpret the raw binary data of the .VBD as text and will display a series of random (garbage)...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVX,QAOG,QA6A,QABC,QAK9,QBRZ,QATX,QAMB,QAP2,QAPN,QBWA,QAVZ,QBVV,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual Basic UserDocuments Are Displayed as Garbage Text</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172063</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Professional, and Enterprise
   Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the UserDocument files are placed on a UNIX or NetScape Web server,
Internet Explorer (IE) will fail to display the UserDocument correctly. IE
will interpret the raw binary data of the .VBD as text and will display a
series of random (garbage) characters, including boxes or symbols.
<P>
<P><h2>CAUSE</h2>
 
<P>
This occurs because some Web servers often associate the incorrect content
type, or MIME type, with files whose extensions are unrecognized.
<P>
.VBD files are binary files that contain the persistent properties that are
exported by the UserDocument. When Internet Explorer downloads these files,
it must know to treat them as binary files, not as text files.
<P>
Some Web servers will, by default, associate all files whose extensions are
unrecognized with the content type "text/plain." Because .VBD is not a
commonly used file-extension, .VBD files on problem servers will often get
branded as "text/plain."
<P>
When Internet Explorer receives the "text/plain" content type HTTP header,
it will attempt to display the .VBD file as a text file. This results in
the garbage characters that appear in the window. When it receives the
"application/octet-stream" content type instead, it saves the .VBD file
into the Internet Explorer cache and then activates the associated Visual
Basic UserDocument for that .VBD file.
<P>
This problem will not occur on Microsoft Internet Information Server (IIS)
because it associates all files with unrecognized file extensions with the
content type "application/octet-stream."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two possible ways to avoid this problem on Web servers that cause
this problem:
<P>
<P><h3>Method 1</h3>
 
<P>
The Web server administrator can add a content type association manually
for .VBD files so that Internet Explorer will correctly display these
files. The exact steps to do this vary according to the Web server. In
general, the association needs to exist for the file extension .VBD to the
MIME content type "application/octet-stream."
<P>
<P><h3>Method 2</h3>
 
<P>
The actual extension for Structured Storage files is not very important.
Embedded within the .VBD file is the unique identifier for the UserDocument
that knows how to display and save the properties that are contained within
the .VBD file. This identifier is retrieved and used regardless of the
actual extension of the file. However, to avoid confusion and conflicts
with other file extensions, it is recommended that an extension is chosen
that is already associated with the content type "application/octet-stream"
and is not associated with other content types. The extension .BIN
generally works well.
<P>
However, following this method and making this change often requires a few
other changes as well. The .HTM file that is generated by the Application
Setup Wizard must be changed. Locate the line that causes Internet Explorer
to navigate to the .VBD file, and change the extension from .VBD to .BIN.
Also, if the Active Document code uses a Hyperlink object to navigate to
other .VBD files, these filename extensions will need to be renamed from
.VBD to .BIN as well.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
"Active Document" is the term for what was once called an "ActiveX
Document." When this article refers to a "UserDocument," this is taken to
mean the Visual Basic 5.0 technology that allows Visual Basic forms to be
hosted as Active Documents in Active Document containers such as Internet
Explorer.
 
<PRE>Keywords          : vb5all VBKBAX VBKBComp VBKBInet
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
