

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How To Use "DSN-Less" ODBC Connections with RDO and DAO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147875">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1996/03/01">
<META NAME="Keywords" CONTENT="APrgDataODBC vb432 VB4WIN kbcode kbhowto kbprg kbwebcontent">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  With Microsoft Visual Basic version 4.0 for Windows, you can specify your ODBC (Open Database Connectivity) driver and server in your connect string when using RDO (Remote Data Object) and DAO (Data Access Objects) which eliminates the need to set ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA9E,QAA1,QDI2,QAI5,QAH4,QAU9,QBSO,QAPN,QABM,QBXS,QBG2,QAZV,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Use "DSN-Less" ODBC Connections with RDO and DAO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147875</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>4.00    | 4.00
</PRE>WINDOWS | WINDOWS NT
kbprg kbcode kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   32-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With Microsoft Visual Basic version 4.0 for Windows, you can specify your
ODBC (Open Database Connectivity) driver and server in your connect string
when using RDO (Remote Data Object) and DAO (Data Access Objects) which
eliminates the need to set up a DSN (Data Source Name). We call this a "DSN-
Less" ODBC connection because you do not need to set up a DSN in order
to access your ODBC database server.
<P>
To do this, you specify a "driver=" and "server=" parameter in your connect
string as in the following example:
<P>
<PRE>   cnstr = "driver={SQL Server};server=myserver;" &amp; _
     "database=mydb;uid=myuid;pwd=mypwd;dsn=;"
   Set cn = en.OpenConnection("", False, False, cnstr)

</PRE>NOTE: The driver name must be surrounded by curly brackets. For example:
"{SQL Server}."
<P>
(CAUTION: DSN-Less connections will not work in Visual Basic 4.0 16-bit. If
you try to use them you will get a General Protection Fault in module
ODBC.DLL at 0006:080F.)
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Visual Basic version 3.0 for Windows, you had to create a DSN
that added an extra step when distributing your application because each
workstation had to have the DSN created in order to access the specified
server and database. This was done either manually with the ODBC Admin
utility, through code with the RegisterDatabase function, or through code
with the SQLConfigDatasource API function. For additional information on
how to do this setup manually, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q123008.htm">Q123008</A></B>
   TITLE     : How to Set Up ODBC Data Sources When Distributing an App

   ARTICLE-ID: <B><A HREF="../VBWIN/Q126940.htm">Q126940</A></B>
   TITLE     : RegisterDatabase Fails After ODBC Version 2.x Installed

   ARTICLE-ID: <B><A HREF="../ACCESS/Q132329.htm">Q132329</A></B>
   TITLE     : RegisterDatabase Method Does Not Modify ODBC.INI File

</PRE><h3>Sample Program</h3>
 
<P>
The following RDO example uses a "DSN-less" ODBC connection so you do not
need to set up a DSN with the ODBC Admin utility beforehand.

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a command button to Form1, Command1 by default.

<P><LI>Paste the following code into the General Declarations section of Form1:
<P>
<P><PRE>      Dim en As rdoEnvironment
      Dim cn As rdoConnection
      Private Sub Form_Load()
<PRE></PRE>        MousePointer = vbHourglass
        Dim strConnect As String
        ' Change the next line to reflect your driver and server.
        strConnect = "driver={SQL Server};server=jonfo5;" &amp; _
          "database=pubs;uid=sa;pwd="
        Set en = rdoEngine.rdoEnvironments(0)
        Set cn = en.OpenConnection( _
          dsName:="", _
          Prompt:=rdDriverNoPrompt, _
          ReadOnly:=False, _
          Connect:=strConnect)
        cn.QueryTimeout = 600
        MousePointer = vbNormal
      End Sub
      Private Sub Command1_Click()
        MousePointer = vbHourglass
        Dim rs As rdoResultset
        Set rs = cn.OpenResultset(Name:="Select * from authors", _
          Type:=rdOpenForwardOnly, _
          LockType:=rdConcurReadOnly, _
          Options:=rdExecDirect)
        Debug.Print rs(0), rs(1), rs(2)
        MousePointer = vbNormal
      End Sub

</PRE><P><LI>Note that you must change your DRIVER, SERVER, DATABASE, UID, and PWD
   parameters in the OpenConnection method. You also need to modify the SQL
   statement contained in the Command1_Click event to match your own SQL
   data source.

<P><LI>Start the program or press the F5 key.

<P><LI>Click the Command1 button to create a rdoResultset and display the first
   row of data in the debug window.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Hitchhiker's Guide to Visual Basic and SQL Server, Microsoft Press.
ISBN: 1-55615-906-4.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode kbhowto kbwebcontent<BR>
KBSubcategory: APrgDataODBC vb4win vb432<BR>
Additional reference words: 4.00<BR>
Keywords          : APrgDataODBC vb432 VB4WIN kbcode kbhowto kbprg kbwebcontent<BR>
Version           : 4.00    | 4.00<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
