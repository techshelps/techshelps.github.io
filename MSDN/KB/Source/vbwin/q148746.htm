

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Check Marks Work Only When Set in Top Level Menu Events </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148746">
<META NAME="KBModify" CONTENT="1996/10/03">
<META NAME="KBCreate" CONTENT="1996/03/20">
<META NAME="Keywords" CONTENT="kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A check mark only appears next to the previously selected item in a second level menu. The check mark appears next to the correct item only after the mouse passes over that item.  STATUS ======  Microsoft has confirmed this to be an issue in the Mi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QABI,QABH,QAPG,QBWS,QA28,QATJ,QAAW,QBS0,QBJZ,QAF0,QAIJ,QAFF,QAA3,QAVI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Check Marks Work Only When Set in Top Level Menu Events</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148746</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, version 4.0, for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A check mark only appears next to the previously selected item in a second
level menu. The check mark appears next to the correct item only after the
mouse passes over that item.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
issue and will post new information here in the Microsoft Knowledge Base as
it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this issue, set the Checked property of a second level menu
item in the top level menu event rather than the second level menu event.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start 16-bit or 32-bit Visual Basic 4.0, or if it is already running,
   click New Project on the File menu.

<P><LI>Use the Menu Editor to add the following menu items. Note that the Blue,
   Green, and Cyan should appear only if you click Color, and Color appears
   if you click Options. Click Menu Editor from the Tools menu.
<P>
<PRE>      Caption            Name                   Index
      -------            ----                   -----
      Options          mnuOption
        Color          mnuOptionsColor
          Blue         mnuOptionsColorArray       0
          Green        mnuOptionsColorArray       1
          Cyan         mnuOptionsColorArray       2

</PRE><P><LI>Copy the following code to the Code window of the Form1 form:
<P>
<P><PRE>      Option Explicit
      Dim ncol As Integer
</PRE><P>
<P><PRE>      Private Sub mnucol_Click(Index As Integer)
<PRE></PRE>         ncol = Index
         BackColor = QBColor(Index + 1)
      End Sub

      Private Sub mnuColor_Click()
         Dim i As Integer
         For i = 0 To 2
            If i = ncol Then
               mnuCol(i).Checked = True
            Else
               mnuCol(i).Checked = False
            End If
         Next
      End Sub

      Private Sub mnuOptions_Click()
         'Uncomment the following lines for workaround
         'Dim i As Integer
         'For i = 0 To 2
            'mnucol(i).Checked = (i = ncol)
            'Next
          End Sub

</PRE><P><LI>On the Run menu, click Start or press the F5 key to start the program.
   From the Options menu, click Color and note that a second level menu
   appears. Choose a color to change the background color of the form.
   Click Color again from the Options menu and choose another color. Click
   Color a third time and note that a check mark appears next to the
   original color you selected. Move the mouse over the previously selected
   color and note that a check mark appears on the correct choice.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 buglist4.00 vb4win vb4all checkmark<BR>
KBCategory: kbbuglist<BR>
KBSubcategory: PrgOther
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
