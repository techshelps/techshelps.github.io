

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Save Attachments to File with MSMAPI.VBX or MSMAPI.OCX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176535">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/11/10">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all vb5howto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The MAPIMessage Control has procedures to attach and remove attachments from a message, but nothing apparent to allow writing the attachment back out to a permanent file. This article contains a code sample demonstrating how this can be done.  MORE...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBF0,QA5T,QAH4,QA5B,QA2S,QAUR,QA9N,QA4Q,QANF,QAEF,QAEV,QDMW,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Save Attachments to File with MSMAPI.VBX or MSMAPI.OCX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176535</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MAPIMessage Control has procedures to attach and remove attachments
from a message, but nothing apparent to allow writing the attachment back
out to a permanent file. This article contains a code sample demonstrating
how this can be done.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a message that contains an attachment is opened, any attachments are
written to the system's temp directory. The path and filename to this
temporary file are stored in the AttachmentPathName property of the
message.
<P>
You can copy the file as desired using the Visual Basic FileCopy file
function.
<P>
NOTE: The filename is in 8.3 format, so long filenames will be lost.
<P>
The following code sample demonstrates how to access the path and filename
to the temporary file and copy the temporary file to the Root of drive C:
<P>
<PRE>   Sub Form_Load ()
       mapisession1.Action = 1 'session_signon
       mapimessages1.SessionID = mapisession1.SessionID
       mapimessages1.FetchUnreadOnly = True
       mapimessages1.Action = 1 'message_fetch
       Dim i As Integer
       For i = 0 To mapimessages1.AttachmentCount - 1
           mapimessages1.AttachmentIndex = i
           Dim intLenFileName As Integer
           Dim intStrPos As Integer
           intLenFileName = Len(mapimessages1.AttachmentPathName)
           For intStrPos = intLenFileName To 1 Step -1
               If InStr(1, _
                        Right$(mapimessages1.AttachmentPathName, _
                               intLenFileName - (intStrPos - 1)), _
                        "\", 1) Then
                   strNewFileName = _
                      Right$(mapimessages1.AttachmentPathName, _
                             intLenFileName - intStrPos)
                   Exit For
               End If
           Next
           FileCopy mapimessages1.AttachmentPathName, _
                    "c:\" &amp; strNewFileName
       Next
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MAPI<BR>
Keywords          : VB4ALL VB4WIN vb5all vb5howto<BR>
Version           : WINDOWS:4.0,5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
