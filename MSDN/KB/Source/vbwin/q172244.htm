

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: VBComponents Add Method Cannot Add a Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172244">
<META NAME="KBModify" CONTENT="1997/08/05">
<META NAME="KBCreate" CONTENT="1997/07/31">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When attempting to add a Form to a Visual Basic 5.0 project through the IDTExtensibility model with VBComponents' Add method and passing vbext_ct_MSForm, you get Run-time error '-2147467259 (800004005)':      System Error *h80004005(-2147467259). U...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAAP,QAB4,QAH0,QAKJ,QAJN,QBWS,QAKP,QA5F,QAPN,QAMA,QAIJ,QAH4,QAUD,QADZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: VBComponents Add Method Cannot Add a Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172244</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Professional, and Enterprise
   Editions for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to add a Form to a Visual Basic 5.0 project through the
IDTExtensibility model with VBComponents' Add method and passing
vbext_ct_MSForm, you get Run-time error '-2147467259 (800004005)':
<P>
<PRE>   "System Error &amp;h80004005(-2147467259). Unspecified error"

</PRE><h2>CAUSE</h2>
 
<P>
Visual Basic 5.0 does not support Forms3 designers, enum member
vbext_ct_MSForm is not valid.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use VBComponents' AddFromTemplate method. See the MORE INFORMATION
Section of this article.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a New AddIn Project in Visual Basic 5.0.

<P><LI>Add the following line to the Private Sub OKButton_Click() in
   frmAddIn:
<P>
<P><PRE>      VBInstance.VBProjects(1).VBComponents.Add (vbext_ct_MSForm)
</PRE>
<P><LI>Type "ADDTOINI" in the Immediate (debug) window and press the
   ENTER key.

<P><LI>Press the F5 key to run the project.

<P><LI>Start another instance of Visual Basic with a new standard EXE project*.

<P><LI>Under Add-Ins menu, select Add-In Manager, and then select My AddIn from
   the list.

<P><LI>Under Add-Ins menu, select My AddIn item.

<P><LI>Click OK on the Add-In Form. You will get: Run-time error '-2147467259
   (800004005)': System Error &amp;h80004005(-2147467259). Unspecified error.

<P><LI>Add a new form to the add-in project and save it in the 'Template'
   folder under Visual Basic folder as Form1.frm (for example, 'C:\Program
   Files\DevStudio\VB\Template', and then remove the form from the project.

<P><LI>Change the code:
<P>
<P><PRE>      VBInstance.VBProjects(1).VBComponents.Add (vbext_ct_MSForm)
</PRE><P>
<P><PRE>    in step 6 to:
</PRE><P>
<P><PRE>      VBInstance.VBProjects(1).VBComponents.AddFromTemplate _
      ("C:\Program Files\DevStudio\VB\Template\Form1.frm")
</PRE>
<P><LI>Repeat steps 3 through 8. This time a form should be added to your
<P><PRE>    project each time you click OK.
</PRE><P>
</OL>* If your project does not have a form, you will get 'Run-time error #9,
subscript out of range.'
 
<PRE>Keywords          : vb5all
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
