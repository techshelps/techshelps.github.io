

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Recompiling with SP2 Breaks Binary Compatibility </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171550">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/07/16">
<META NAME="Keywords" CONTENT="vb5all VBKBAX VBKBComp VBKBCtrl VBKBDLL VBKBExe VS97FixlistSP3 VB5FixListSP3">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  After adding functionality to a server application (.EXE, .DLL or .OCX) and recompiling several times with Microsoft Visual Basic version 5.0 with Visual Studio Service Pack 2 installed, the following errors may occur:  1. Existing client applicati...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDO3,QAR4,QA56,QA55,QAM1,QANZ,QAKP,QDNN,QA6A,QDIX,QDNE,QBMH,QA2O,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Recompiling with SP2 Breaks Binary Compatibility</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171550</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Control Creation, Learning, Professional, and
   Enterprise Editions for Windows, version 5.0
<LI>Microsoft Visual Studio versions 97, 97sps
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After adding functionality to a server application (.EXE, .DLL or .OCX) and
recompiling several times with Microsoft Visual Basic version 5.0 with
Visual Studio Service Pack 2 installed, the following errors may occur:

<OL><P><LI>Existing client applications may fail when attempting to create an
   object type from the server.

<P><LI>The Object Browser may not display all of the classes of the server
   or all of the members of a particular class of the server.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 3.
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VSTUDIO/Q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE></OL>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 3, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q175450.htm">Q175450</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 3

</PRE><h2>MORE INFORMATION</h2>
 
<P>
NOTE: The problems caused by this bug are difficult to reproduce
consistently.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Make an ActiveX DLL (Knowledge Base article <B><A HREF="../VBWIN/Q173407.htm">Q173407</A></B> contains the
   specific steps). After the first compilation (to create the DLL), copy
   the DLL and rename the copy to &lt;filename&gt;.CMP. This will create a file
   that will not be overwritten by future recompiles. (CMP is shorthand
   for compatible.) Then set the server project properties for version
   compatibility to Binary and refer to the .CMP file.

<P><LI>Add new functionality to the server without changing any existing
   functionality. Recompile the server to a new DLL. Make a copy of the DLL
   with the extension .CMP.

<P><LI>Change the server project version compatibility file to the new .CMP
   file. Add more functionality and recompile to a new DLL. The problems
   may not appear until the third generation of the DLL has been created.
<P>
</OL>One workaround for the problem is to recompile the server project to a new
DLL and use the new DLL as the binary compatibility file listed in the
project properties dialog.
 
<PRE>Keywords          : vb5all VBKBAX VBKBComp VBKBCtrl VBKBDLL VBKBExe VS97FixlistSP3 VB5FixListSP3
Version           : WINDOWS:5.0; WINNT:97sp2
Platform          : WINDOWS winnt
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
