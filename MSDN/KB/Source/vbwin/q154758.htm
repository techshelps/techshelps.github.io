

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HOWTO: Call a Stored Procedure Using the Data Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154758">
<META NAME="KBModify" CONTENT="1997/07/15">
<META NAME="KBCreate" CONTENT="1996/08/14">
<META NAME="Keywords" CONTENT="APrgDataODBC VB4ALL VB4WIN vb5all VBKBDB VBKBODBC kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When writing prototype or demo applications, it may sometimes be necessary to call a stored procedure on a SQL Server database from the Data Control. Because the Data Control behaves similarly to a Recordset in DAO code, it is possible to achieve t...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAGI,QA7O,QAOE,QAMN,QABM,QAB5,QAH6,QBT6,QBV4,QAZV,QAH7,QAH4,QAD7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Call a Stored Procedure Using the Data Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154758</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions, 16-bit and
   32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When writing prototype or demo applications, it may sometimes be necessary
to call a stored procedure on a SQL Server database from the Data Control.
Because the Data Control behaves similarly to a Recordset in DAO code, it
is possible to achieve this behavior.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to pass SQL Server syntax through the JET engine (the engine that
allows Visual Basic to connect to an Access databases), the
dbSQLPassThrough option must be used. This prevents the parser built into
JET from attempting to parse the SQL string.
<P>
This ability to pass through the JET engine allows the Visual Basic
programmer to call stored procedures on the SQL Server database. When using
the Data Control, you can set the SQLPassThrough option to use the Options
property of the data control.
<P>
The Options property Online Documentation describes dbSQLPassThrough
as follows:
<P>
<PRE>Constant          Value  Description
</PRE> 
<PRE>dbSQLPassThrough  64     When using Data controls with an SQL statement
                         in the RecordSource property, sends the SQL
                         statement to an ODBC database, such as a SQL
                         Server or Oracle database, for processing.

</PRE>The complete list of valid settings for the Options property is documented
in the Online Help. Search there for Options Property.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following sample uses the pubs database in SQL Server to demonstrate
the pass-through behavior. This contains a stored procedure called
"byroyalty" that takes an integer and returns all authors that match the
percentage royalty:

<OL><P><LI>Start a new program in Visual Basic. Form1 is created by default.

<P><LI>Add a Data Control and a Text Box to Form1.

<P><LI>Set the DataSource property of Text1 to Data1.

<P><LI>Add the following code to Form1:
<P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>         Data1.Connect = "ODBC;DSN=DSNToPubs;" &amp; _
                         ";Database=pubs; " &amp; _
                         "Uid=sa;Pwd=;"
         Data1.RecordSource = "Exec byroyalty 40"
         Data1.Caption = "Stored Procedure Test"
         Data1.Options = Data1.Options Or dbSQLPassThrough
         Data1.Refresh

         Text1.DataField = "Au_ID"
      End Sub

</PRE><P><LI>Press the F5 key to run the program. You should see the first author ID
   in the Text Box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
In Visual Basic Online Help, see Options property, OpenRecordset method.
 
<PRE>Keywords          : APrgDataODBC VB4ALL VB4WIN vb5all VBKBDB VBKBODBC kbhowto
Version           : 4.0 5.0
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
