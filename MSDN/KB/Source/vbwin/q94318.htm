

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Change the Size of the Text Cursor in a Text Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94318 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/01/04">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Although there is no property that will allow you to change the appearance of the text cursor (text caret) in a Visual Basic text box, you can use the Windows API call CreateCaret() function to do so.  MORE INFORMATION  API Calls ---------  In the ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QBB2,QAHP,QBS0,QAGI,QATX,QAMB,QAY5,QDIT,QAO2,QAIJ,QAIF,QADO,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Change the Size of the Text Cursor in a Text Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94318 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows,
<PRE>  versions 1.0, 2.0, and 3.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although there is no property that will allow you to change the
appearance of the text cursor (text caret) in a Visual Basic text box,
you can use the Windows API call CreateCaret() function to do so.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>API Calls</h3>
 
<P>
In the example below, API calls change the size of the text cursor.
The CreateCaret() function creates a new shape for the system caret
and assigns ownership of the caret to the given window. The caret
shape can be a line, block, or bitmap. Here's the syntax:
<P>
<PRE>   Void CreateCaret(hwnd, hbmp,nwidth,nheight)

   HWND hwnd      - handle of owner window
   HBITMAP hbmp   - handle of bitmap for caret shape
   int nwidth     - caret width
   int nheight    - caret height

</PRE>The ShowCaret() function shows the caret on the screen at the caret's
current position. Once shown, the caret begins flashing automatically.
<P>
<PRE>   Void ShowCaret(hwnd)

   HWND hwnd     - handle of window with caret

</PRE>The GetFocus() function retrieves the handle of the window that
currently has the input focus.
<P>
<PRE>   HWND GetFocus(void)

</PRE><h3>Example Code</h3>
 
<P>
To see these API calls in action do the following:

<OL><P><LI>Start Visual Basic or start a new project (ALT, F, N).

<P><LI>Add two text boxes to Form1.

<P><LI>Add the following declarations to the General Declarations section of
   Form1. Note that you must enter each declaration on a single line even
   though, for readability, the first declaration is shown on two lines:
<P>
<PRE>   Declare Sub CreateCaret Lib "user" (ByVal w%, ByVal x%,
         ByVal y%, ByVal z%)
   Declare Function showcaret% Lib "user" (ByVal x%)
   Declare Function getfocus% Lib "user" ()

</PRE><P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Sub Text1_GotFocus ()
      h% = getfocus%()                ' get the handle to the text box
      Call createcaret(h%, 0, 3, 24)  ' create new caret size
      x% = showcaret%(h%)             ' show the new caret
   End Sub

</PRE><P><LI>Run the program.
<P>
</OL>You will see that while the focus is on Text1 the size of the text
caret in the text box appears larger than normal.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
