

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Deleting VB Control Doesn't DeIete Its Code from Memory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73808 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1991/07/08">
<META NAME="Keywords" CONTENT="kbenv kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you delete a control in the Visual Basic environment, the code that you wrote for that control is not deleted, but is instead moved to the Object: (General) area for code.  Some programmers may not realize that these detached (unused) procedur...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAEF,QAGB,QBCT,QAGC,QA7O,QAPN,QAOE,QAMN,QAB5,QDKD,QAY2,QBWS,QAW6,QBS0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Deleting VB Control Doesn't DeIete Its Code from Memory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73808 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic programming system for Windows, versions
   1.0, 2.0, and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you delete a control in the Visual Basic environment, the code that
you wrote for that control is not deleted, but is instead moved to the
Object: (General) area for code.
<P>
Some programmers may not realize that these detached (unused) procedures
still exist and consume memory. The detached code is available for calling,
copying, or reuse. For example, when you add a control that shares the same
name as a detached procedure, the detached event procedure reassociates
with that control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want to delete both the control and its associated code, you need to
manually select and delete the code in each event procedure for that
control in addition to deleting the control itself.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates that your code goes into the Object:
(General) area after you delete the associated control (or object):

<OL><P><LI>From the File menu, choose New Project.

<P><LI>Double-click a command button from the Toolbox to put a Command1 button
   on your form.

<P><LI>Double-click the Command1 button to bring up the code window for the
   Command1_Click event procedure.

<P><LI>Enter the following code inside the Command1_Click procedure:
<P>
<PRE>   Sub Command1_Click()
      Print "Hello"
   End Sub

</PRE><P><LI>Press the F5 key to run the code. Click the Command1 button to see the
   text "Hello" display on Form1 in the upper left corner. From the Run
   menu, choose End to stop the program.

<P><LI>Click the Command1 button on Form1 to set the focus there and either
   press the DELETE key or choose the Delete command from the Edit menu.
   This deletes the Command1 button from the form.
<P>
   At this point, some programmers may incorrectly assume that the code
   associated with the Command1 button was also deleted. Actually, the code
   associated with any deleted object is automatically moved into the
   Object: (general) area of the Code window for that form. You can find
   the detached procedures in the Code window by choosing (general) from
   the Object: box, and choosing the procedures from the Proc: box. (Click
   the DOWN arrow symbol on the right of the Object: and Proc: boxes to see
   your choices.)
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbenv kbprg kbprb<BR>
KBSubcategory: EnvtDes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
