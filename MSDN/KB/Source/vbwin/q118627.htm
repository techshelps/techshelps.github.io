

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: PD*JET.DLL Conflict Compatibility Layer/Crystal Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118627">
<META NAME="KBModify" CONTENT="1996/12/03">
<META NAME="KBCreate" CONTENT="1994/07/25">
<META NAME="Keywords" CONTENT="kb3rdparty kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you install the Professional Edition of Crystal Reports version 3.0 (or updates to the files CRW.EXE, PDBJET.DLL, PDCTJET.DLL, and PDIRJET.DLL that you received from Crystal Services) and then install the Microsoft Jet 2.0/Visual Basic 3.0 Compa...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBS0,QATR,QANZ,QAC1,QDNN,QDN9,QAH4,QAXB,QAM0,QAH6,QAA1,QACK,QDI2,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: PD*JET.DLL Conflict Compatibility Layer/Crystal Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118627</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic Programming System for Windows, version 3.0
- Microsoft Jet 2.0/Visual Basic 3.0 Compatibility Layer
- Crystal Report Writer and Crystal Reports by Crystal Services
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you install the Professional Edition of Crystal Reports version 3.0 (or
updates to the files CRW.EXE, PDBJET.DLL, PDCTJET.DLL, and PDIRJET.DLL that
you received from Crystal Services) and then install the Microsoft Jet
2.0/Visual Basic 3.0 Compatibility Layer, the files CRW.EXE, PDBJET.DLL,
PDCTJET.DLL, and PDIRJET.DLL are replaced by the Crystal Reports 2.0
versions because these are the versions that come with the Compatibility
Layer.
<P>
The result is often a general protection (GP) fault because Crystal
Reports version 3.0 expects to find either an updated copy of the 2.x
version of these files or the 3.0 version of these files.
<P>
<P><h2>CAUSE</h2>
 
<P>
Visual Basic version 3.0 ships with the Crystal Reports version 2.0
PD*JET.DLL files, which are compatible with Microsoft Access version 1.1.
The Compatibility Layer provides updates to these 2.0 versions of the
PD*JET.DLL files to make them compatible with Microsoft Access version 2.0.
<P>
The Compatibility Layer replaces the 3.0 versions of the files with the 2.0
versions that are compatible with Microsoft Access version 2.0. This causes
a problem because Crystal Reports version 3.0 only works with the 3.0
version of the PD*JET.DLL files (or a fixed 2.x version of these files,
which can be acquired from Crystal Services). The result is often a GPF in
Crystal Reports.
<P>
NOTE: The 3.0 versions of the PD*JET.DLL files that ship with Crystal
Reports version 3.0 are only compatible with Microsoft Access version 1.1.
This could also be a problem if you installed the Compatibility Layer and
then installed Crystal Reports version 3.0. It would then not be able to
reference an Microsoft Access version 2.0 database.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
One alternative is to get the fixed 2.x versions of the PD*JET.DLL files
(which are compatible with Microsoft Access version 2.0). Contact Crystal
Services and ask for the file ACCESS20.ZIP.
<P>
However, it would be better to use the program called CRWACC20.EXE, which
comes with the Compatibility Layer. This program can modify any version of
the CRW.EXE, PDIRJET.DLL, PDCTJET.DLL, or PDBJET.DLL files so that they
will work with Microsoft Access version 2.0.
<P>
You can correct any of the problems listed above by following these steps:

<OL><P><LI>Reload the files CRW.EXE, PDIRJET.DLL, PDCTJET.DLL, and PDBJET.DLL that
   come with Crystal Reports version 3.0 (the versions compatible with
   Microsoft Access version 1.1) onto your machine if they are not already
   there. This could be accomplished by reinstalling the Crystal Reports
   product.

<P><LI>Run the CRWACC20.EXE program supplied with the Compatibility Layer.
<P>
   CRWACC20.EXE is an MS-DOS-based program that enables Crystal Reports for
   Visual Basic to work with the Microsoft Jet version 2.0 database engine.
   It modifies the following files:
<P>
<P><PRE>    - CRW.EXE
    - PDBJET.DLL
    - PDIRJET.DLL
    - PDCTJET.DLL
</PRE><P>
   You must put the Crystal Reports modification program (CRWACC20.EXE) in
   the same directory as the files it modifies or give it a full path to
   the files (CRW.EXE, PDBJET.DLL, PDCTJET.DLL, and PDIRJET.DLL), which
   usually reside in different directories. You will find the CRWACC20.EXE
   program in the root of the Visual Basic directory.
<P>
   The CRWACC20.EXE program gives confirmation that it has modified the
   CRW.EXE file, but it does not give confirmation that it has found and
   modified the .DLL files.
<P>
   You can verify that all these the files were modified by looking at the
   date stamp, which lists the following dates for these files:
<P>
<PRE>      CRW.EXE     - 3/16/94
      PDBJET.DLL  - 3/24/94
      PDIRJET.DLL - 3/24/94
      PDCTJET.DLL - 3/24/94

</PRE></OL>For information on obtaining the Compatibility Layer, please see the
following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A HREF="../VBWIN/Q113951.htm">Q113951</A></B>
<PRE>TITLE     : How to Obtain &amp; Distribute the Compatibility Layer

</PRE>If you need information on contacting Crystal Services, please see the
following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A HREF="../VBWIN/Q100368.htm">Q100368</A></B>
<PRE>TITLE     : How to Get Help w/ Crystal Reports -- International and U.S.

</PRE><h2>REFERENCES</h2>
 
<P>
For a complete list of Crystal Reports support, see the last three pages
(PSS 1 through PSS 3) of the "Microsoft Visual Basic Professional Features"
manual, book 2.
<P>
Crystal Report Writer and Crystal Reports are trademarks of Crystal
Services, Vancouver, B.C., Canada.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 Custom GPF<BR>
KBCategory: kb3rdparty kbinterop kbprb<BR>
KBSubCategory: IAPThird<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
