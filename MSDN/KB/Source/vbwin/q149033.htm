

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Pass Database Object to 16-Bit OLE Server Causes 80010104 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149033">
<META NAME="KBModify" CONTENT="1996/04/11">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Attempting to pass a DAO Database object to a 16-bit OLE server created with Visual Basic 4.0 16-bit can cause error -2147417852 (80010104) with early-binding, or run-time error 13 - Type Mismatch when using late- binding. This error is caused when...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QBS0,QA9Q,QAD7,QAH7,QAH6,QAH4,QAPN,QARL,QAW6,QAFF,QBWS,QA6A,QBXS,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Pass Database Object to 16-Bit OLE Server Causes 80010104</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 11, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149033</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic for
   Windows, 16-bit only, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to pass a DAO Database object to a 16-bit OLE server created
with Visual Basic 4.0 16-bit can cause error -2147417852 (80010104) with
early-binding, or run-time error 13 - Type Mismatch when using late-
binding. This error is caused when the parameter list in the OLE server for
the function or subroutine has an element declared As Database.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Declare the element of the parameter list As Object instead of As Database.
For example, instead of using
<P>
<PRE>   Public Sub PassDB(MyDB As Database)

</PRE>use:
<P>
<PRE>   Public Sub PassDB(MyDB As Object)

</PRE>All code in the body of the procedure or function that takes the database
object can be written in the same way as if the parameter had been passed
As database. Note that the As Database will work correctly with Visual
Basic 4.0 32-bit and Jet 3.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B>
   TITLE     : How to Create and Use a Minimal OLE Automation Server


</PRE><h3>Steps to Reproduce</h3>
 

<OL><P><LI>Create a minimal OLE server and a client that accesses the OLE server.
   (Step-by-step instructions for this procedure are found in the article
   [<B><A HREF="../VBWIN/Q129801.htm">Q129801</A></B>] referenced above and assume a client and server created from
   this article. However, they can be implemented in any client and server
   to see the behavior described in this article.) Add this code to the
   class module in the OLE server project:
<P>
   Public Sub PassDB(MyDB as Database)
<PRE>   End Sub

</PRE><P><LI>On the Run menu, choose Start or press F5 to run the server application.
   In the client application, add a reference to the running OLE server.

<P><LI>Modify the Form_Click event of Form1 in the client project to contain
   the following code:
<P>
   Public Sub Form_Click()
<P><PRE>      Dim x As Project1.Class1
      Dim db As Database
      Set x = New Project1.Class1
      Set db = OpenDatabase("Biblio.mdb")
      x.PassDB db
<PRE></PRE>   End Sub

</PRE><P><LI>On the Run menu, choose Start or press F5 to run the client application.
   Click on the form. The client program will raise the error mentioned
   above on the line calling the PassDB method of the OLE server. If the
   server is stopped and the type of MyDB is changed from Database to
   Object, the client code will work correctly.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: APrgData IAPOLE<BR>
Additional reference words: 4.00 vb4win vb4all
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 11, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
