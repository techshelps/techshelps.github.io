

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: 16-Bit Data Control Bound to OLE Control Returns Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140031">
<META NAME="KBModify" CONTENT="1995/11/28">
<META NAME="KBCreate" CONTENT="1995/11/21">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  A Visual Basic 16-bit program with a data control bound to an OLE container control does not retrieve the data stored in a database. When you try to retrieve the data through the data control, the error message  Error Loading From File  is displaye...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA7O,QAB4,QAOE,QAMN,QAB5,QAW6,QA9Q,QAH4,QBWS,QA01,QBJZ,QAAP,QAUD,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: 16-Bit Data Control Bound to OLE Control Returns Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 28, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140031</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Visual Basic 16-bit program with a data control bound to an OLE container
control does not retrieve the data stored in a database. When you try to
retrieve the data through the data control, the error message "Error
Loading From File" is displayed.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step to Reproduce Problem</h3>
 

<OL><P><LI>Start 16-bit Visual Basic 4.0, or if it is already running, click New
   Project on the File menu.

<P><LI>Add a data control, two command buttons, and an OLE container control
   to the Form1 form.

<P><LI>Set the DataSource property of the OLE container control to the Data1
   data control.

<P><LI>Copy the following code sample to the Form1 code window:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>         Data1.Recordset.AddNew
         Ole1.InsertObjDlg
      End Sub

      Private Sub Command2_Click()
         Data1.Recordset.Update
      End Sub

      Private Sub Form_Load()
         Dim db As Database
         Dim td As TableDef
         Dim fl As Field

         If Dir("C:\OLETEST.MDB") = "" Then
            Set db = CreateDatabase("C:\OLETEST.MDB", dbLangGeneral)
            Set td = db.CreateTableDef("OleObjects")
            Set fl = td.CreateField("Object", dbLongBinary)
            td.Fields.Append fl
            db.TableDefs.Append td
            db.Close
         End If

         Ole1.DataField = "Object"
         Data1.DatabaseName = "C:\OLETEST.MDB"
         Data1.RecordSource = "OleObjects"
         Data1.Refresh

         Command1.Caption = "&amp;Add New"
         Command2.Caption = "&amp;Update"
      End Sub

</PRE><P><LI>On the Run menu, click Start, or press the F5 key to start the
   program.

<P><LI>Click Add New. The error message "OLE Automation error" appears in the
   OLETEST dialog box. Click OK to close the message box. The Insert Object
   dialog box is displayed.

<P><LI>Use the following steps to insert an object into the OLE container:
<P>
   a. On the Object Type list box, click Paintbrush Picture, then click
<P><PRE>      OK. The Paintbrush window appears.
</PRE><P>
   b. Draw anything in the window.
<P>
   c. On the File menu, click Exit and return to the (Untitled) menu
<P><PRE>      item. The Paintbrush dialog box is displayed.
</PRE><P>
   d. Click Yes to close the Paintbrush dialog box and the Paintbrush
<P><PRE>      program. The image drawn in the Paintbrush program no longer
      appears in the OLE container in the Visual Basic program.
</PRE>
<P><LI>Click Update. The OLE container is now blank.

<P><LI>On the Data1 data control, click Back. While using Microsoft Windows NT
   or Microsoft Windows 95, the error "Error Loading From File" is
   displayed. While using Microsoft Windows for Workgroups, a general
   protection fault occurs.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words:  4.00 VB4WIN VB416 buglist4.00<BR>
KBCategory: kbprg kbbuglist kberrmsg<BR>
KBSubcategory: IAPOLE PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 28, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
