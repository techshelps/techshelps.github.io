

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using UP ARROW and DOWN ARROW Keys to Move the Focus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100413">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  You can trap for the UP ARROW and DOWN ARROW extended keyboard keys in some Visual Basic controls by placing code in the KeyDown event procedure. The code uses KeyCode values to trap the UP ARROW and DOWN ARROW keys. You cannot, however, trap the k...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBSV,QBS0,QAO2,QAMN,QAIJ,QACI,QAH4,QADO,QABB,QAB5,QBT6,QAJD,QBV4,QDIV,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using UP ARROW and DOWN ARROW Keys to Move the Focus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100413</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Visual Basic programming system for Windows, version 1.0
- Standard and Professional Edition of Microsoft Visual Basic for
<PRE>  MS-DOS, version 1.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can trap for the UP ARROW and DOWN ARROW extended keyboard keys in some
Visual Basic controls by placing code in the KeyDown event procedure. The
code uses KeyCode values to trap the UP ARROW and DOWN ARROW keys. You
cannot, however, trap the keys in all Visual Basic controls because some
controls already have built-in functionality for the UP ARROW and DOWN
ARROW keys, so there is no KeyDown event generated.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The information in this article is provided to show that it is possible to
trap the UP ARROW and DOWN ARROW keys, however Microsoft does not recommend
that you implement it because the UP ARROW and DOWN ARROW keys have
standard, predefined behavior on some controls. Microsoft recommends that
you use the standard method for using the keyboard to move the focus; that
is, use the TAB and SHIFT+TAB keys or use the access keys.
<P>
<P><h3>Step-by-Step Example for Moving the Focus Using UP ARROW and DOWN ARROW</h3>
 
1. Start Visual Basic or from the File menu, choose New Project
<PRE>   (ALT, F, N) if Visual Basic is already running.

</PRE><P><LI>Add a Picture box and two Text boxes to Form1.

<P><LI>In the Picture1_KeyDown event procedure, add this code:
<P>
<PRE>   Sub Picture1_KeyDown(KeyCode AS INTEGER, Shift AS INTEGER)
      IF KeyCode = 38 Then    '* 38 = up arrow key
         Text2.SetFocus
      Text2.SelStart = 0   '* set the cursor to the start
      END IF

      IF KeyCode = 40 Then    '* 40 = down arrow key
         Text1.SetFocus
      Text1.SelStart = 0   '* set the cursor to the start
      END IF
   END SUB

</PRE><P><LI>In the Text1_KeyDown event procedure, add this code:
<P>
<PRE>   Sub Text1_KeyDown(KeyCode AS INTEGER, Shift AS INTEGER)
      If KeyCode = 38 Then    '* 38 = UP ARROW key
         Picture1.SetFocus
      End If

      If KeyCode = 40 Then    '* 40 = DOWN ARROW key
         Text2.SetFocus
         Text2.SelStart = 0   '* set the cursor to the start
      End If
   End Sub

</PRE><P><LI>In the Text2_KeyDown event procedure, add this code:
<P>
<PRE>   Sub Text2_KeyDown(KeyCode AS INTEGER, Shift AS INTEGER)
      If KeyCode = 38 Then    '* 38 = UP ARROW key
         Text1.SetFocus
         Text1.SelStart = 0   '* set the cursor to the start
      End If

      If KeyCode = 40 Then    '* 40 = DOWN ARROW key
         Picture1.SetFocus
      End If
   End Sub

</PRE><P><LI>Choose Start from the Run menu or press F5 to run the example.
   Press the UP ARROW or DOWN ARROW key to see the focus move to a
   different control.
<P>
</OL>If you use the LEFT ARROW or RIGHT ARROW keys, you can scroll in a
Text box, but these keys are ignored in the Picture box in this example.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.00 B_VBmsdos 1.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
