

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Errors with Duplicate Keys and Modal/Modeless Forms </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137036">
<META NAME="KBModify" CONTENT="1995/09/26">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="kbprg kbbuglist kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  When you enter a duplicate value for a key field, you will notice different behavior depending on whether the form is shown as modal or modeless. When you have a modeless form and a duplicate value for a key field, the error  Can't have duplicate k...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QA5V,QBS0,QAHP,QAB4,QAFO,QAMB,QATX,QACI,QBWS,QBE5,QA7O,QA28,QATJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Errors with Duplicate Keys and Modal/Modeless Forms</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137036</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you enter a duplicate value for a key field, you will notice different
behavior depending on whether the form is shown as modal or modeless. When
you have a modeless form and a duplicate value for a key field, the error
"Can't have duplicate key; index changes were unsuccessful" appears as you
try to move to the next record. When you have a modal form, this error
appears as you try to unload the form. In both cases, Visual Basic does not
save the duplicate data.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Visual Basic version 3.0
for Windows. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic 3.0. Form1 is created by default.

<P><LI>Add a second form to the project by clicking New Form on the Visual
   Basic File menu. Form2 is created by default.

<P><LI>Place two command buttons (Command1 and Command2) on the Form1.

<P><LI>Set the Caption property of Command1 to Modeless and set the Caption
   property of Command2 to Modal.

<P><LI>Place the following code in the Click event procedure for Command1:
<P>
   form2.Show
<P>
   Then place the following code in the Click event procedure for
   Command2:
<P>
   form2.Show 1

<P><LI>Place a text box (Text1) and a data control (Data1) on Form2.

<P><LI>Set the following properties for these controls:
<P>
   Text1
<PRE>      DataSource     Data1
      DataField      ISBN

   Data1
      DatabaseName   Biblio.mdb
      Recordsource   Titles

</PRE><P><LI>Run the program by clicking Start on the Run menu.

<P><LI>Click the Modeless button. This will show Form2 with the first record of
   the database. Select the text in the text box, and copy it by pressing
   CTRL+INS. Move to the next record, and select the new text in the text
   box. Paste the text from the previous record into the text box by
   pressing SHIFT+INS. On trying to move to a new record, you will
   receive this error message.
<P>
   Can't have duplicate key; index changes were unsuccessful.

<P><LI>Close Form2 by double-clicking its control box.

<P><LI>Click the Modal button on Form1. Form2 will appear again with the first
<P><PRE>    record of the database. Select the text in the text box, and copy it by
    pressing CTRL-INS. Move to the next record, and select the new text in
    the text box. Paste the text from the previous record into the text box
    by pressing SHIFT-INS. On trying to move to a new record, you will not
    receive an error message.
</PRE>
<P><LI>Close Form2 by double-clicking its control box. Now you will get the
<P><PRE>    error message:
</PRE><P>
<P><PRE>    Can't have duplicate key; index changes were unsuccessful.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbbuglist kberrmsg<BR>
KBSubcategory:   PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 26, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
