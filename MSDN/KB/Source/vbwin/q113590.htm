

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VB3 How to Get Current Drive's Free Disk Space in VB 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113590">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1994/04/07">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  This article shows how to find out how much free disk space is available on the current drive by calling the DiskSpaceFree function found in SETUPKIT.DLL.  The SETUPKIT.DLL file ships with the Setup kit in Visual Basic version 3.0. The DiskSpaceFre...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW5,QBS0,QAY5,QAB9,QBV8,QAH4,QBFY,QAWH,QBWS,QAMN,QAMB,QAIJ,QAC9,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB3 How to Get Current Drive's Free Disk Space in VB 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113590</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows how to find out how much free disk space is available on
the current drive by calling the DiskSpaceFree function found in
SETUPKIT.DLL.
<P>
The SETUPKIT.DLL file ships with the Setup kit in Visual Basic version
3.0. The DiskSpaceFree function is useful for finding the total space
available on a drive. If you use the DiskSpaceFree function in your
Visual Basic program, you need to distribute the SETUPKIT.DLL file to
your customers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are also other functions in the SETUPKIT.DLL that may be useful.
You can use the AllocUnit function to get the disk Allocation unit for
the current drive and the SetTime function to set the destination file's
date and time to the source file's date and time. For the declarations
for these functions and others, please see the following article in the
Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A HREF="../VBWIN/Q109290.htm">Q109290</A></B>
<PRE>TITLE     : Popular Windows API Functions Used from Visual Basic 3.0

</PRE>Examples of using these SETUPKIT.DLL functions can also be found in the
\VB\SETUPKIT\SETUP1\SETUP1.MAK project which is part of the SetupWizard.
<P>
<P><h3>Steps to Finding Out How Much Free Space Is Available on Drive C:</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add one Label control (Label1) and one Command button (Command1)
   to Form1.

<P><LI>Using the following table as a guide, set the properties of the
   controls you added in step 2.
<P>
<PRE>   Control Name   Property       New Value
   --------------------------------------------------------------
   Command1       Caption        Press for Free Space on Drive C:
   Label1         AutoSize       True

</PRE><P><LI>Place the following code in the (general) (declarations) section
   of Form1:
<P>
<PRE>   Declare Function DiskSpaceFree Lib "SETUPKIT.DLL" () As Long

</PRE><P><LI>Place the following code in the Command1 Click event procedure of
   Form1:
<P>
<PRE>   Sub Command1_Click ()
     Dim free_space&amp; ' Holds number of bytes returned from DiskSpaceFree().

     ChDrive "c:"    ' Change to the drive you want to test.
     free_space&amp; = DiskSpaceFree()

     ' Enter the following two lines as one, single line:
     Label1.Caption = "The total free space on drive C: =  " &amp;
        Str$(free_space&amp;) &amp; " bytes"

   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S), or press the F5 key to run
   the program. Click the Command1 button to view the free disk space on
   drive C:.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgOther<BR>
Additional reference words: 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
