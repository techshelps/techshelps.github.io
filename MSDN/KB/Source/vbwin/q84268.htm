

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VB MCI Control Does Not Support PC Speaker Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84268 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/05/06">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The MCI custom does not support playing wave (.WAV) sound files through a PC speaker driver such as SPEAKER.DRV. The MCI custom control (and the Windows Media Player application) uses the MCI sound drivers, which do not support the PC speaker. The ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAYS,QAHR,QAB5,QAMN,QBIT,QDL9,QBWQ,QBWO,QBWN,QA7O,QAOE,QAH4,QBES,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB MCI Control Does Not Support PC Speaker Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84268 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Professional Edition of Microsoft Visual Basic for Windows,
<PRE>  versions 2.0 and 3.0
</PRE>- Microsoft Professional Toolkit for Microsoft Visual Basic programming
<PRE>  system for Windows, version 1.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MCI custom does not support playing wave (.WAV) sound files
through a PC speaker driver such as SPEAKER.DRV. The MCI custom
control (and the Windows Media Player application) uses the MCI sound
drivers, which do not support the PC speaker. The Windows default
sounds and the Sound Recorder application are the only way to play
sounds through the SPEAKER.DRV PC speaker driver.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The MCI control manages the recording and playback of multimedia files
on Media Control Interface (MCI) devices, such as audio boards, MIDI
sequencers, CD-ROM drives, audio CD players, video disc players, and
videotape recorders and players.
<P>
Although the MCI control will not allow you to play .WAV files through the
PC speaker, you can use the OLE Client Controls provided with the
Professional Edition of the Microsoft Visual Basic for Windows, or with the
Microsoft Visual Basic for Windows Professional Toolkit to create and play
a linked Sound Recorder object from your Visual Basic for Windows program.
The following is an example of this behavior. (Note that you must have the
appropriate Windows sound drivers loaded in order to run this program):

<OL><P><LI>Run Visual Basic for Windows, or from the File menu, choose New
   Project (press ALT, F, N) if Visual Basic for Windows is already
   running. Form1 is created by default.

<P><LI>From the File menu, choose Add File. In the Files box, select the
   OLECLIEN.VBX custom control file in Visual Basic 2.0 or the MSOLE2.VBX
   custom control file in Visual Basic 3.0. The OLE Client tool appears in
   the Toolbox of the Visual Basic 2.0 product, the OLE 2.0 tool appears in
   the Toolbox of the Visual Basic 3.0 product.

<P><LI>Double-click the OLE Client control on the toolbar to create an OLE
   Client control on your form in Visual Basic 2.0, or double-click the OLE
   2.0 control on the toolbar to create an OLE control on your form in
   Visual Basic 3.0.

<P><LI>Double-click the form to open the Code window, and enter the following
   code in the Form_Click event for Visual Basic 2.0:
<P>
   OLEClient1.Class = "SoundRec"
   OLEClient1.Protocol = "StdFileEditing"
<PRE>   OLEClient1.SourceDoc = "C:\windows\chimes.wav"   ' Name of .WAV file.
   OLEClient1.SourceItem = "LINK"
   OLEClient1.ServerType = 0      ' Linked object.

   OLEClient1.Action = 1      ' Create object from source file.
   OLEClient1.Action = 7      ' Activate Sound Recorder - plays sound.
   OLEClient1.Action = 10     ' Delete the object.

   -or-

</PRE><P><LI>Double-click the form to open the Code window, and enter the following
   code in the Form_Click event for Visual Basic 3.0:
<P>
   OLE1.Class = "SoundRec"
<PRE>   OLE1.SourceDoc = "C:\windows\chimes.wav"   ' Name of .WAV file.
   OLE1.SourceItem = "LINK"

   OLE1.Action = 1      ' Create object from source file.
   OLE1.Action = 7      ' Activate Sound Recorder - plays sound.
   OLE1.Action = 10     ' Delete the object.

</PRE><P><LI>Press the F5 key to run the program.
<P>
</OL>The specified .WAV file should be played each time you click the form.
<P>
For more information on SPEAKER.DRV, query on the following words in
the Microsoft Knowledge Base:
<P>
<PRE>   SPEAKER.DRV and WDL AND windows AND 3.10
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00 MCI.VBX<BR>
KBCategory: kbprg<BR>
KBSubcategory: PrgCtrlsCus<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
