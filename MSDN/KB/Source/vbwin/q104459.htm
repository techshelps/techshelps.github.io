

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Error 3219 When Updating Record Set Created w/ Distinct </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104459">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1993/09/16">
<META NAME="Keywords" CONTENT="kbprg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Trying to perform an update on a result set created with the Distinct predicate results in error 3219  Can't perform operation, it is illegal.   CAUSE =====  An object variable or a data control result set created with the Distinct predicate is not...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKH,QBS0,QAN0,QBXS,QA5V,QAXB,QAH4,QBWS,QAA1,QAPN,QAMN,QDI2,QBD2,QAL3,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error 3219 When Updating Record Set Created w/ Distinct</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104459</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 3.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Trying to perform an update on a result set created with the Distinct
predicate results in error 3219 "Can't perform operation, it is illegal."
<P>
<P><h2>CAUSE</h2>
 
<P>
An object variable or a data control result set created with the Distinct
predicate is not updatable according to Help. The following statement is in
the Distinct keyword Help topic:
<P>
<PRE>   The output of a query that uses Distinct is not updatable and doesn't
   reflect subsequent changes made by other users. Therefore, when you use
   the Distinct predicate in a query, you are prevented from trying to
   update your records.

</PRE><h2>WORKAROUND</h2>
 
<P>
The only workaround at this time is to not use the DISTINCT predicate
to build the results set. Note that you may have to handle the
duplicates by some other coding means.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Visual Basic or from the File menu, choose Open Project(ALT, F, O)
   if Visual Basic is already running. Form1 is created by default.

<P><LI>Add a data control, two command buttons, and one text box to Form1.

<P><LI>Using the following table as a guide, set the properties of the controls
   you added in step 2.
<P>
<PRE>   Control Name   Property       New Value                     Comment
   ------------------------------------------------------------------------
   Command1       Caption        "Set Up Distinct Predicate"
   Command2       Caption        "Press for Update"
   Data1          DatabaseName   BIBLIO.MDB                    Provide the
                                                               full path to
                                                               this file,
                                                               which should
                                                               be in C:\VB
   Data1          RecordSource   Authors
   Text1          DataSource     Data1
   Text1          DataField      Author

</PRE><P><LI>Add the following code to Command1 click event procedure:
<P>
<PRE>   Sub Command1_Click ()
      '* Enter the following two lines of code as one, single line:
      data1.RecordSource = "Select DISTINCT Author From authors
         where author &gt; 'a'"
      data1.Refresh
   End Sub

</PRE><P><LI>Add the following code to Command2 click event procedure:
<P>
<PRE>   Sub Command2_Click ()
      data1.Recordset.Update
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S), or press the F5 key to run
   the program. Click the Command1 button to set up the Distinct predicate.
   Delete the zero in "Arnson, Robert, 1970." Then click the Command2
   button. This should result in the 3219 error "Can't perform operation,
   it is illegal."
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbprg kbcode kbprb<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
