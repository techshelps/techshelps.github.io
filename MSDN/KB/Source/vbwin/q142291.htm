

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Error '80080005' with 16-Bit Remote Automation Clients </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142291">
<META NAME="KBModify" CONTENT="1996/12/03">
<META NAME="KBCreate" CONTENT="1996/01/09">
<META NAME="Keywords" CONTENT="kbole kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Accessing a property or method of a dependent and remotely served object from a 16-bit client may cause error '429' or error '-2146959355' (hex 80080005). This error occurs on machines on which remote automation was set up by installing Visual Basi...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAA1,QAPN,QAH4,QARL,QDI2,QAKP,QAW6,QAB4,QAAP,QDIR,QANN,QA9Q,QA2K,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error '80080005' with 16-Bit Remote Automation Clients</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142291</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic, 16-bit only, for
   Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Accessing a property or method of a dependent and remotely served object
from a 16-bit client may cause error '429' or error '-2146959355' (hex
80080005). This error occurs on machines on which remote automation was set
up by installing Visual Basic 4.0, 16-bit. If the Setup Wizard is used to
generate a setup program for the 16-bit client, the problem does not occur.
<P>
<P><h2>CAUSE</h2>
 
<P>
Visual Basic 4.0, 16-bit, does not register Autprx16.dll correctly during
installation. This DLL is used by 16-bit clients running on 32-bit
operating systems. Setup programs generated by the Setup Wizard perform the
registration successfully. In addition, 16-bit clients running on a 16-bit
operating system use Autprx.dll and do not have this problem, because the
Visual Basic 4.0 installation correctly registers Autprx.dll.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a issue in the products listed above. We
are researching the problem and will post more information in the Knowledge
Base as it becomes available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To enable dependent object access for 16-bit clients, manually register
Autprx16.dll. The program Regsvr.exe, which is included with Visual Basic
(in the Tools\PSS subdirectory), can be used to accomplish this.
<P>
To register the DLL, use this command line:
<P>
<PRE>   regsvr.exe autprx16.dll

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps To Reproduce</h3>
 

<OL><P><LI>Create and compile an OLE server that exposes an externally creatable
   object that contains dependent object(s). The Invoice server example
   that is outlined starting on page 32 of the Creating OLE Servers section
   of the Professional Features Guide demonstrates the problem.

<P><LI>Create a client program that uses the OLE server written in step 1. The
   code at the bottom of page 34 of the Creating OLE Servers section
   creates a new Invoice object and executes code that will reproduce the
   problem.

<P><LI>Remote your server by placing it on a separate machine and using the
   supplied tools (RacMan, CliReg) to configure your server and client for
   remote automation.

<P><LI>Execute a line of code that accesses a property or method of a dependent
   object. The appropriate error detailed above will be displayed.
   Registering Autprx16.dll should fix the problem.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.0 vb4win vb416<BR>
KBCategory: kbole kbbuglist<BR>
KBSubcategory: IAPOLE<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 3, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
