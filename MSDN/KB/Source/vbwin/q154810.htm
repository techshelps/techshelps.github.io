

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG:Errors When Accessing rdoPreparedStatements Not Consistent </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154810">
<META NAME="KBModify" CONTENT="1997/05/19">
<META NAME="KBCreate" CONTENT="1996/08/14">
<META NAME="Keywords" CONTENT="vb432 vb4win kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you attempt to access a non-existent rdoPreparedStatement, the error you receive depends on whether there are other rdoPreparedStatements in the collection.  If there are none, you will get error:     40054 - invalid parameter.  If there is at l...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAAP,QAB4,QBWS,QAH4,QAKP,QABM,QBXS,QAPN,QA5F,QANF,QAMA,QAIJ,QAFF,QBTX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG:Errors When Accessing rdoPreparedStatements Not Consistent</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154810</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Enterprise Edition of Microsoft Visual Basic, 32-bit only,
   for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you attempt to access a non-existent rdoPreparedStatement, the error you
receive depends on whether there are other rdoPreparedStatements in the
collection.
<P>
If there are none, you will get error:
<P>
<PRE>   40054 - invalid parameter.

</PRE>If there is at least one, you will get the error:
<P>
<PRE>   40041: Couldn't find object indicated by text.

</PRE><h2>WORKAROUND</h2>
 
<P>
To minimize the impact of this problem, ensure that any error handlers that
may trap the above errors perform the same code for both errors.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps To Reproduce Problem</h3>
 

<OL><P><LI>Create a DSN in the 32-Bit ODBC section of the Control Panel. Give it
   the name "pubs" and configure it to point to the pubs database on a
   Microsoft SQL server.

<P><LI>Start the 32-bit edition of Visual Basic version 4.0 for Windows. Form1
   is created by default.

<P><LI>Add two Command buttons to the form.

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>        Dim rdocon As rdoConnection
        Dim rdoprep As rdoPreparedStatement
        Set rdocon = rdoEngine(0).OpenConnection("pubs", False, _
                                                 False, "uid=;pwd=;")
        Set rdoprep = rdocon.rdoPreparedStatements("Test1")
      End Sub

      Private Sub Command2_Click()
        Dim rdocon As rdoConnection
        Dim rdoprep As rdoPreparedStatement
        Set rdocon = rdoEngine(0).OpenConnection("pubs", False, _
                                                 False, "uid=;pwd=;")
        Set rdoprep = rdocon.CreatePreparedStatement("Test", _
                                               "Select * from Authors")
        Set rdoprep = rdocon.rdoPreparedStatements("Test1")
      End Sub

</PRE><P><LI>Press the F5 key or click Start on the Run menu to run the application.
   Click Command1, and you should see that Visual Basic gives the error
   below: (At this point the prepared statement has not been created.)
<P>
<P><PRE>      40054 - invalid parameter.
</PRE>
<P><LI>Stop Visual Basic by using Stop on the Run Menu. Press the F5 key or
   click the Run menu again. Click the second button. This time the
   error will be different as the code has created a prepared statement:
<P>
<P><PRE>      40041: Couldn't find object indicated by text.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
Visual Basic OnLine Help CreatePreparedStatement,rdoPreparedStatements.
<P>
Building Client/Server Applications with Visual Basic Manual, Chapter 8.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : vb432 vb4win kbbuglist<BR>
Version             : 4.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 19, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
