

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FIX: Bad .MAK File Prevents Display of Make EXE File Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94939 ">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1993/01/25">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The Make EXE File dialog box is not displayed and the program is not compiled if you try to make an executable file when the project (.MAK) file was saved incorrectly. Specifically, this problem occurs if the .MAK file was saved with an invalid pat...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAFI,QBXB,QATJ,QBJZ,QAY2,QA5F,QAMA,QBFY,QBXS,QBVV,QAJN,QAUR,QAUJ,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Bad .MAK File Prevents Display of Make EXE File Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94939 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00
WINDOWS
kbenv kbbuglist
<P>
 
The information in this article applies to:
<P>
- Microsoft Visual Basic programming system for Windows, version 2.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Make EXE File dialog box is not displayed and the program is not
compiled if you try to make an executable file when the project (.MAK)
file was saved incorrectly. Specifically, this problem occurs if the
.MAK file was saved with an invalid path to the executable file.
<P>
The project file is saved incorrectly if the directory name containing
your project files is derived from the Visual Basic working (or current)
directory name. This problem occurs if the working directory for Visual
Basic has this pattern:
<P>
<PRE>   C:\XXXYYY

</PRE>and your project is in a directory that has this pattern:
<P>
<PRE>   C:\XXX\TEMP

</PRE>where XXX represents the same pattern of characters.
<P>
For example, if you run Visual Basic from a directory called C:\VB2 and
your project is in C:\VB\CALC, you will encounter this problem. The Make
EXE dialog is not displayed, and your program is not compiled.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around the problem, use a text editor such as Notepad to delete the
line containing "Path=" from your project's .MAK file. Then save the .MAK
file, and reload your project in Visual Basic. You will now be able to
display the Make EXE dialog box. You will need to delete this statement
each time you make an .EXE file.
<P>
Another alternative workaround is to place all the files for your project
in a new directory where the directory name is not derived from the Visual
Basic working directory name. You can then delete the "Path=" statement
from the .MAK file using a text editor such as Windows Notepad.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Microsoft Visual Basic
version 2.0 for Windows. This problem was corrected in Microsoft Visual
Basic version 3.0 for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
To reproduce this problem, set the working directory of Visual Basic to the
directory where VB.EXE is stored (C:\VB). To do this, highlight the Visual
Basic icon in Program Manager and choose Properties from the File menu of
Program Manager (PROGMAN.EXE). Then in the Properties dialog box, set the
working directory path the same path where VB.EXE is located.

<OL><P><LI>Create a directory with the same name as the directory where Visual
   Basic is located excluding the right most character. For example, if
   Visual Basic is in C:\VB2, create a directory called C:\VB.

<P><LI>Create a subdirectory named CALC on the new directory (C:\VB\CALC).

<P><LI>Copy all of the files from the Visual Basic SAMPLES\CALC directory to
   the C:\VB\CALC directory.

<P><LI>Start Visual Basic and open the CALC.MAK project in the new C:\VB\CALC
   directory.

<P><LI>From the File menu, choose Make EXE File (ALT, F, K) and choose the OK
   button to have Visual Basic create an executable using the default name.

<P><LI>From the File menu, choose Save Project (ALT, S, V). The project .MAK
   file will be saved incorrectly. Specifically an invalid relative path
   such as Path="..2" will be added to the project .MAK file.

<P><LI>From the File menu, choose Open Project (ALT, F, O) and open the
   CALC project.

<P><LI>From the File menu, choose Make EXE File (ALT, F, K) and choose the OK
   button to have Visual Basic create an executable using the default name.
<P>
</OL>The Make EXE dialog will not be displayed and your program will not be
compiled.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist2.00 fixlist3.00 2.00 3.00<BR>
KBCategory: kbenv kbbuglist<BR>
KBSubcategory: EnvtDes<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
