

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Programmatically Display or Hide a VB Combo Box List </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q85991 ">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1992/06/24">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The list of a Visual Basic drop-down combo box (Style=0 or 2) is usually opened and closed by using a mouse. However, you can also open and close the list of a combo box programmatically by using the Windows SendMessage function as described below....">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBV3,QAE1,QAY5,QAH4,QAB9,QA4Q,QADO,QBWS,QBV8,QA9Z,QA5F,QAMA,QAKJ,QAHP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Programmatically Display or Hide a VB Combo Box List</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q85991 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, versions 2.0 and 3.0
<LI>Microsoft Visual Basic programming system for Windows, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The list of a Visual Basic drop-down combo box (Style=0 or 2) is
usually opened and closed by using a mouse. However, you can also
open and close the list of a combo box programmatically by using the
Windows SendMessage function as described below.
<P>
However, there is an easy way. In visual basic, when a drop-down combo box
has the focus, you can press ALT-DOWN to open it up. Therefore, you can use
SendKeys to send these keys to the combo box, as in this example:
<P>
To do this programmatically, use the following code to change focus to the
combo box and send the necessary keystroke:
<P>
<PRE>   combo1.SetFocus
   SendKeys "%{Down}"

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The CB_SHOWDROPDOWN constant can be used with the SendMessage
function to programmatically open or close the list of a Visual
Basic drop-down combo box of Style=0 or Style=2 (Style=1 always has
the list displayed). The following steps demonstrate how to open the
list of a drop-down combo box:

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Place a combo box (Combo1) and a command button (Command1) on Form1.

<P><LI>Add the following declarations and constants to the general
   Declarations section of Form1:
<P>
<PRE>   ' Enter each Declare statement as one, single line:
   Declare Function GetFocus Lib "User" () as Integer
   Declare Function GetParent Lib "User" (ByVal hWnd as Integer)
      as Integer
   Declare Function SendMessage Lib "User" (ByVal hWnd as Integer,
      ByVal wMsg as Integer, ByVal wParam as Integer,
      ByVal lParam as Any) as Long
   Global Const WM_USER = &amp;H400
   Global Const CB_SHOWDROPDOWN = WM_USER + 15

</PRE><P><LI>Add the following code to the Form1 Load event procedure to put
   some items in the combo box:
<P>
<PRE>   Sub Form_Load ()
      Combo1.AddItem "apple"
      Combo1.AddItem "orange"
      Combo1.AddItem "banana"
   End Sub

</PRE><P><LI>Add the following code to the Command1_Click event procedure:
<P>
<PRE>   Sub Command1_Click ()
      Combo1.SetFocus
      cbhWnd% = GetFocus ()
      cblisthWnd% = GetParent (cbhWnd%)
      cbFunc% = -1           'cbFunc% = -1 displays the list
                             'cbFunc% = 0 hide the list
      retval&amp; = SendMessage (cblisthWnd%, CB_SHOWDROPDOWN, cbFunc%, 0&amp;)
   End Sub

</PRE><P><LI>Press the F5 key to run the program. Click Command1 to display the list
   of the combo box.
<P>
</OL>If Style=2 for the combo box, there is no need to use the GetParent
function. Use the return value of the GetFocus (cbhWnd% in the above
example) call as the first parameter of the SendMessage function.
<P>
NOTE: The list of a combo box with Style=0 or 2 will close when the combo
box loses focus.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 3.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: PrgCtrlsStd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
