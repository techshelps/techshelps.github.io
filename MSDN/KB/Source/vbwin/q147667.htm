

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: 'Invalid Picture' Error When Setting Metafile (WMF) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147667">
<META NAME="KBModify" CONTENT="1996/02/29">
<META NAME="KBCreate" CONTENT="1996/02/28">
<META NAME="Keywords" CONTENT="kbprg EnvtDes">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Setting the Picture property of picture box control to a metafile (.WMF) format file can cause Visual Basic to raise the error 'Invalid Picture'.  CAUSE =====  This error can be caused when attempting to set the picture property to a kind of image ...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH2,QBS0,QABA,QDNG,QAPF,QAYV,QBXS,QBCU,QAB4,QAAP,QAIH,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 'Invalid Picture' Error When Setting Metafile (WMF)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147667</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic, 16-bit and 32-bit, for Windows, version 4.0
<P>
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Setting the Picture property of picture box control to a metafile (.WMF)
format file can cause Visual Basic to raise the error 'Invalid Picture'.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error can be caused when attempting to set the picture property to a
kind of image that the control does not understand. If the file or other
source of the image is corrupt then the control may not be able to
interpret the image well enough to determine what kind of image it is, let
alone display and manipulate it.
<P>
With WMF (metafile) image formats, an additional wrinkle is relevant.
Visual Basic 4.0, and other Microsoft products such as Microsoft Word and
Microsoft Excel, do not use the 'standard' metafile format. Instead, these
applications use an 'Aldus Placeable Format' metafile. The formats differ
in that placeable metafiles include a 22-byte 'metafileheader' data
structure at the beginning of the file. The placeable metafile format is
incompatible with such Windows API functions as CreateMetaFile,
GetMetaFile, CopyMetaFile, and PlayMetaFile.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Sample code as well as compiled executables for utilities to convert
between these metafile formats exist on the Microsoft Software Library
(MSL). These samples are explained in the following Knowledge Base
articles.
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN16SDK/Q129658.htm">Q129658</A></B>
   TITLE     : SAMPLE: Reading and Writing Aldus Placeable Metafiles

</PRE>This provides a 16-bit utility that can convert between normal Windows
metafiles and the corresponding Aldus Placeable Format metafiles.
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../WIN32SDK/Q145999.htm">Q145999</A></B>
   TITLE     : SAMPLE: How to Create &amp; Play Enhanced Metafiles in Win32

</PRE>This sample provides a 32-bit utility to work with the 32-bit enhanced
metafile format. The utility can also convert between normal (16-bit)
metafiles and Aldus Placeable Format metafiles.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<B><A HREF="../WIN16SDK/Q129658.htm">Q129658</A></B> - SAMPLE: Reading and Writing Aldus Placeable Metafiles
<B><A HREF="../WIN32SDK/Q145999.htm">Q145999</A></B> - SAMPLE: How to Create &amp; Play Enhanced Metafiles in Win32
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprb kbprg<BR>
KBSubcategory: EnvtDes<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 29, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
