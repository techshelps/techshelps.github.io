

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: VFP CDX with EMPTY Function Is Not Recognized in VB5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175691">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1997/10/24">
<META NAME="Keywords" CONTENT="vb5all">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  FoxPro indexes that contain the function EMPTY or ISBLANK will not be recognized in Visual Basic 5.0. Indexes with this function are recognized by Visual Basic 4.0. The following error will be generated under NT:     An application error has occurr...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QBS0,QAEF,QAH4,QAGB,QBXS,QBVV,QAFF,QAAP,QAB4,QAA1,QDIJ,QAY5,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: VFP CDX with EMPTY Function Is Not Recognized in VB5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175691</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
FoxPro indexes that contain the function EMPTY or ISBLANK will not be
recognized in Visual Basic 5.0. Indexes with this function are recognized
by Visual Basic 4.0. The following error will be generated under NT:
<P>
<PRE>   An application error has occurred
   and an application error log is being generated.

   VB5.exe
   Exception Access Violation (0xc0000005),Address .........

</PRE>Visual Basic 5.0 is terminated by this error.
<P>
In Windows 95, no error is returned because the index is not seen.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Compare field to " " instead of using EMPTY. The same results are achieved.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a Visual Basic 5.0 project and choose DAO 3.5 under project
   references.
<P>
</OL>2 In FoxPro 2.5, use the customer table and set up some indexes on cno,
<PRE>  state and ono. The CDX file with the same name as the table file will
  contain the indexes.

</PRE><P><LI>Place 2 CommandButtons on the form, and paste in the following code:
<P>
<P><PRE>      Option Explicit
</PRE>   
<P><PRE>      Dim FoxDataDB As Database
      Dim RS As Recordset
      Dim myidx As Index
</PRE>   
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>        RS.Close
        FoxDataDB.Close
        Set RS = Nothing
        Set FoxDataDB = Nothing
        Unload Me
      End Sub
   
      Private Sub Command2_Click()
         For Each myidx In FoxDataDB.TableDefs("customer").Indexes
            Debug.Print myidx.Name
            RS.Index = myidx.Name
         Next
      End Sub
   
      Private Sub Form_Load()
   
      Set FoxDataDB = Workspaces(0).OpenDatabase( _
                         "d:\fpw26\tutorial", _
                         False, False, "FoxPro 2.5;")
         Set RS = FoxDataDB.OpenRecordset("customer", dbOpenTable)
   
      End Sub

</PRE><P><LI>Run the code above and note that the index names are printed.

<P><LI>Delete some phone numbers from the database above and add the following
   index by choosing Database Setup from the menu in FoxPro:
<P>
<P><PRE>      IIF(EMPTY(phone), state, phone)
</PRE>
<P><LI>Run the code above and note that you get the error above under NT. Under
   Windows 95, the index will not be recognized.

<P><LI>Remove the phone index, and the program will run successfully if the
   index has not become corrupted.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Dr. Watson function complex immediate inline<BR>
Keywords          : vb5all<BR>
Component         : dao<BR>
Version           : WINDOWS:5.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
