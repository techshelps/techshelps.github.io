

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BUG: Adding Multiple Files with 16-Bit SetupWiz Fails on Win95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147583">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1996/02/26">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  Attempting to add more than one file in Step 7 of the Visual Basic 4.0 Setup Wizard fails. After selecting multiple files and clicking OK, the Setup Wizard displays a dialog containing  This file may be required for your program to run correctly  a...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDL9,QBWO,QBWN,QBS0,QBWQ,QA36,QAI4,QDIR,QBWS,QA2Q,QASR,QA01,QDI2,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Adding Multiple Files with 16-Bit SetupWiz Fails on Win95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147583</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Professional and Enterprise Editions of Microsoft Visual Basic,
   16-bit only, for Windows, version 4.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Attempting to add more than one file in Step 7 of the Visual Basic 4.0
Setup Wizard fails. After selecting multiple files and clicking OK, the
Setup Wizard displays a dialog containing "This file may be required for
your program to run correctly" and prompts if a search for this file should
be continued. If the search is terminated, a dialog displays "The file(s)
you selected were already in the list. No new files have been added."
<P>
<P><h2>CAUSE</h2>
 
<P>
The Setup Wizard attempts to look for a single file with a filename that is
the concatenation of all the files selected. This problem only occurs with
the 16-bit version of the Microsoft Visual Basic 4.0 Setup Wizard for
Windows when run on Microsoft Windows 95. It does not occur on Microsoft
Windows NT version 3.51 or on any 16-bit Microsoft Windows operating
system. This problem does not occur using the 32-bit version of the
Microsoft Visual Basic 4.0 Setup Wizard for Windows.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use any of the following methods to work around this problem:

<UL><LI>Add each file one at a time.
<P>
  - or -

<LI>Create setup media or a template (.Vbz) file for the setup using an
   operating system other than Microsoft Windows 95. If a template is
   created on another machine, then the .Vbz file can be copied to the
   Microsoft Windows 95 machine and selected in Step 1 of the Setup Wizard
   using the Load Template button.
<P>
   - or -

<LI>Add files manually to a template file generated on the Windows 95
   machine. In step 7, click Save Template and save a template(.Vbz)
   file to disk. Open this template file in a text editor and manually add
   a line for each file that you want to add. Listed below are some sample
   added FileXX lines, just replace the first parameter with the path to
   the file you wish to include:
<P>
<P><PRE>      File17=C:\ENROLL\ENROLL.ICO,0,$(AppPath),,|32760|,-1,0,0,0,,,0
      File18=C:\ENROLL\MSTRS.EXE,0,$(AppPath),,|32760|,-1,0,0,0,,,0
      File19=C:\ENROLL\README.HLP,0,$(AppPath),,|32760|,-1,0,0,0,,,0
      File20=C:\ENROLL\TRAIN.HLP,0,$(AppPath),,|32760|,-1,0,0,0,,,0
</PRE><P>
   Then restart the Setup Wizard and click Open Template to load the
   modified template file.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. We will post new information about
this issue here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps To Reproduce Problem</h3>
 

<OL><P><LI>Start the 16-bit version of the Visual Basic 4.0 Setup Wizard for
   Windows.

<P><LI>In step 1, select the .Vbp file for the Calc sample (located in the
   Vb\Samples\Calc directory).

<P><LI>Click Next repeatedly until Step 7 is reached.

<P><LI>Click 'Add Files...' and select more than one file in the common dialog
   that displays. The above mentioned dialogs display after clicking OK to
   dismiss the dialog.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.00a vb4win vb416 buglist4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: TlsSetWiz<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
