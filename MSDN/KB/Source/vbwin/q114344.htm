

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Perform SubQuery on Microsoft Access 2.0 DB in VB 3.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114344">
<META NAME="KBModify" CONTENT="1995/06/21">
<META NAME="KBCreate" CONTENT="1994/05/01">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  The code sample in this article demonstrates how to set up and use a SubQuery on a Microsoft Access version 2.0 database (NWIND.MDB) and on a Microsoft Access version 1.x database (BIBLIO.MDB from Visual Basic version 3.0).  NOTE: For the NWIND.MDB...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QAMB,QATR,QDN9,QBXT,QA5V,QAEB,QAIB,QANZ,QDKY,QAZV,QAY4,QAY2,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Perform SubQuery on Microsoft Access 2.0 DB in VB 3.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 21, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114344</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
<P><h3>- Microsoft Visual Basic programming system for Windows, version 3.0</h3>
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The code sample in this article demonstrates how to set up and use a
SubQuery on a Microsoft Access version 2.0 database (NWIND.MDB) and
on a Microsoft Access version 1.x database (BIBLIO.MDB from Visual
Basic version 3.0).
<P>
NOTE: For the NWIND.MDB database, the code sample requires that you have
Microsoft Access version 2.0 and the Microsoft Jet 2.0/Visual Basic 3.0
Compatibility Layer.
<P>
For more information about the Compatibility layer, please see the
following articles in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A HREF="../VBWIN/Q113594.htm">Q113594</A></B>
<PRE>TITLE     : Updated ACC2COMP.TXT for Jet 2.0/VB 3.0 Compatibility Layer

</PRE>ARTICLE-ID: <B><A HREF="../VBWIN/Q113683.htm">Q113683</A></B>
<PRE>TITLE     : Fact Sheet on Microsoft Jet 2.0/VB 3.0 Compatibility Layer

</PRE>ARTICLE-ID: <B><A HREF="../VBWIN/Q113684.htm">Q113684</A></B>
<PRE>TITLE     : Installation Issues with Jet 2.0/VB 3.0 Compatibility Layer

</PRE>ARTICLE-ID: <B><A HREF="../VBWIN/Q113685.htm">Q113685</A></B>
<PRE>TITLE     : Files Included in Jet 2.0/ VB 3.0 Compatibility Layer

</PRE>ARTICLE-ID: <B><A HREF="../VBWIN/Q113951.htm">Q113951</A></B>
<PRE>TITLE     : How to Obtain &amp; Distribute the Compatibility Layer

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using the SubQuery in Visual Basic</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Load the following into a text editor and save it as SUBQ.FRM. Then
   load the SUBQ.FRM form into your Visual Basic project and set it
   as your start-up form. Edit each statement that appears on more than
   one line so that it appears on one, single line before loading the form
   into Visual Basic. Also double check the paths to the database files.
<P>
   VERSION 2.00
   Begin Form SubQ
<PRE>    Caption         =   "Form1"
    ClientHeight    =   4020
    ClientLeft      =   1095
    ClientTop       =   1485
    ClientWidth     =   7365
    Height          =   4425
    Left            =   1035
    LinkTopic       =   "Form1"
    ScaleHeight     =   4020
    ScaleWidth      =   7365
    Top             =   1140
    Width           =   7485
    Begin Data Data2
       Caption         =   "Data2"
       Connect         =   ""
       DatabaseName    =   "C:\VB\BIBLIO.MDB"
       Exclusive       =   0   'False
       Height          =   375
       Left            =   4680
       Options         =   0
       ReadOnly        =   0   'False
       RecordSource    =   "Titles"
       Top             =   3240
       Visible         =   0   'False
       Width           =   2175
    End
    Begin CommandButton Command2
       Caption         =   "VB 3.0 Biblio(Access 1.x) Subquery
        sample"
       Height          =   735
       Left            =   3480
       TabIndex        =   3
       Top             =   840
       Width           =   3855
    End
    Begin ListBox List2
       Height          =   1200
       Left            =   4320
       TabIndex        =   2
       Top             =   1800
       Width           =   2775
    End
    Begin ListBox List1
       Height          =   1200
       Left            =   360
       TabIndex        =   1
       Top             =   1800
       Width           =   2775
    End
    Begin CommandButton Command1
       Caption         =   "Access 2.0 Nwind Subquery sample"
       Height          =   735
       Left            =   120
       TabIndex        =   0
       Top             =   840
       Width           =   3255
    End
    Begin Data Data1
       Caption         =   "Data1"
       Connect         =   ""
       DatabaseName    =   "C:\ACCESS\SAMPAPPS\NWIND.MDB"
       Exclusive       =   0   'False
       Height          =   375
       Left            =   720
       Options         =   0
       ReadOnly        =   0   'False
       RecordSource    =   "Customers"
       Top             =   3240
       Visible         =   0   'False
       Width           =   1695
    End
    Begin Label Label1
       ' Edit the following four lines into one, single line:
       Caption         =   "Two samples of using Subqueries with
        an Access 2.0 NWIND database and another sample of using
        the Subquery with the VB 3.0 Biblio.MDB(Access 1.1)
        database"
       Height          =   615
       Left            =   1200
       TabIndex        =   4
       Top             =   120
       Width           =   5295
    End
   End

   Sub Command1_Click ()
   ' Edit the following five lines into one, single line:
   data1.RecordSource = "SELECT DISTINCTROW Customers.[Contact
   Name], Customers.[Company Name], Customers.[Contact Title],
   Customers.Phone FROM Customers WHERE ((Customers.[Customer ID]
   In (SELECT DISTINCTROW Orders.[Customer ID] FROM Orders WHERE
   Orders.[Order Date] &gt;= #04/1/93# &lt;#07/1/93#)));"
   data1.Refresh
   Do Until data1.Recordset.EOF
      list1.AddItem "" &amp; data1.Recordset("customers.[company name]")
      data1.Recordset.MoveNext
   Loop
   End Sub

   Sub Command2_Click ()
   ' Edit the following three lines into one, single line:
   data2.RecordSource = "SELECT titles.title FROM titles WHERE
   ((titles.pubid IN (SELECT DISTINCTROW publishers.pubid FROM
   publishers WHERE state = 'WA')));"
   data2.Refresh
   Do Until data2.Recordset.EOF
      list2.AddItem "" &amp; data2.Recordset("titles.title")
      data2.Recordset.MoveNext
   Loop
   End Sub

</PRE><P><LI>From the Run menu, choose Start (ALT, R, S), or press the F5 key
   to run the program. Click the Command1 button, then the Command2
   button.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 CompLayer<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: APrgDataAcc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 21, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
