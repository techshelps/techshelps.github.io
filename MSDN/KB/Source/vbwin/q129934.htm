

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: "Invalid Property Value" If TrueType Fonts Only Selected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129934">
<META NAME="KBModify" CONTENT="1995/10/30">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="kbprg kbprb kberrmsg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbwin">
<META NAME="Description" CONTENT="  If you have  TrueType fonts only  set in the Fonts applet in the Windows Control Panel, when you execute Visual Basic code that sets a Fontname property of a form or control to  MS Sans Serif  (or any other non-TrueType font), the program generates...">
<META NAME="Product" CONTENT="Visual Basic for Windows">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QBS0,QAH4,QAPN,QABA,QAIJ,QBTX,QBXS,QAFF,QAMA,QA3M,QAKD,QA5F,QDL9,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Invalid Property Value" If TrueType Fonts Only Selected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129934</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Standard and Professional Editions of Microsoft Visual Basic for
   Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you have "TrueType fonts only" set in the Fonts applet in the Windows
Control Panel, when you execute Visual Basic code that sets a Fontname
property of a form or control to "MS Sans Serif" (or any other non-TrueType
font), the program generates error 380:
<P>
<PRE>   Invalid property value

</PRE>This error can also be generated when you execute the following statement
if the FontName property of the Form is a Non-TrueType font (which it is by
default):
<P>
<PRE>   Form1.FontName = Form1.FontName

</PRE>This is true even though the default FontName value is MS Sans Serif.
This is because the FontName property is set by default to a non-TrueType
font. If you change the FontName property to Arial at design time, you will
not get the "Invalid property Value" error, because Arial is a TrueType
Font
<P>
<P><h2>CAUSE</h2>
 
<P>
MS Sans Serif is the default font for every control created in Visual
Basic. Visual Basic does not detect the 'True Types only' setting in
the Fonts applet and is, therefore, unaware of the fact that "MS Sans
Serif" is an invalid font choice. When the program causes an assignment of
the Fontname, Visual Basic is bound to the 'True Types only' setting and
rejects any Fontnames not on the list.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you need to set your Fontname property, you can guarantee that the
font chosen is valid by stepping through the Screen.Fonts collection with
this code:
<P>
<PRE>   Private Sub Form_Load()
      Dim AFontName As String
      Dim ItsLegal As Integer

      AFontName = "MS Sans Serif"

      For I = 1 To Screen.FontCount - 1
         If AFontName = Screen.Fonts(I) Then
            ItsLegal = True
            Exit For
         End If
      Next
      If ItsLegal Then
         Form1.FontName = AFontName
      Else
         MsgBox AFontName &amp; " is not available."
      End If
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start the Windows Control Panel in the Main group in Program Manager.

<P><LI>Start the Fonts applet.

<P><LI>Click the TrueType button, and select the "Show Only True Type Fonts in
   Applications" check box. Click OK.

<P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the Form1_Load procedure:
<P>
<PRE>   Sub Form1_Load()
      Form1.Fontname = Form1.Fontname
   End Sub

   -or-

   Sub Form1_Load ()
      Form1.Fontname = "MS Sans Serif"
   End Sub

</PRE><P><LI>Start the program by pressing the F5 key.
<P>
</OL>With either code segment, the application generates error 380.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 vb4win vb4all<BR>
KBCategory: kbprg kbprb kberrmsg kbcode<BR>
KBSubcategory: PrgOther<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1995</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
