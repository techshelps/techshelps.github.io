

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRB: Oracle Errors When Using Query-Based Updates Through ADO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178044">
<META NAME="KBModify" CONTENT="1997/12/22">
<META NAME="KBCreate" CONTENT="1997/12/12">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; oledb">
<META NAME="Description" CONTENT="  When using Query-Based Updates in ActiveX Data Objects (ADO), such as Visual InterDev's Data Form Wizard, only forward-only cursors are supported. If you use Static, Keyset, or Dynamic cursors and the ADO Update method, you raise the following erro...">
<META NAME="Product" CONTENT="oledb">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QA94,QBXS,QAKD,QAC1,QBWA,QA2Q,QAPN,QAO2,QAAP,QBD2,QAUJ,QAB4,QAYY,QAG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Oracle Errors When Using Query-Based Updates Through ADO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178044</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft OLE DB, versions 1.0, 2.0
<LI>Active Server Pages
<LI>ActiveX Data Objects (ADO)
<LI>Microsoft Active Server Pages, versions 1.0, 1.0b
<LI>Microsoft Data Access Components, version 1.5
<LI>Microsoft Internet Information Server version 3.0
<LI>Microsoft ODBC for Oracle, version 2.0 (Build 2.73.7269)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using Query-Based Updates in ActiveX Data Objects (ADO), such as
Visual InterDev's Data Form Wizard, only forward-only cursors are
supported. If you use Static, Keyset, or Dynamic cursors and the ADO Update
method, you raise the following error:
<P>
<PRE>   Microsoft][ODBC driver for Oracle]Degree of derived table does not match
   column list
   Source Microsoft OLE DB Provider for ODBC Drivers
   SQLState 21S02
   NativeError 0

</PRE><h2>CAUSE</h2>
 
<P>
Oracle offers limited support for server-side cursors.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use forward-only cursors.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The example below demonstrates the effect of using different cursors on
Oracle and SQL Server tables.
<P>
<P><h3>To run the sample</h3>
 

<OL><P><LI>Create an .asp file named "cursor_test" in one of your Webs.

<P><LI>Copy and Paste the ASP/HTML code below into the file created in the
   previous step.
<P>
<P>
   NOTE: The reader must point to his or her own database servers and
   modify the connect string to use the correct userid (UID) and password
   (PWD) arguments.
<P>
<P><PRE>     &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
</PRE><P>
<P><PRE>     &lt;HTML&gt;
     &lt;HEAD&gt;
     &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
     &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-
     1"&gt;
     &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
     &lt;/HEAD&gt;
     &lt;BODY&gt;
     &lt;%
     On Error Resume Next
     intCursorType=Request.Form("intCursorType")
     strServer=Request.Form("radServer")
</PRE><P>
<P><PRE>     If intCursorType="" Then%&gt;
     &lt;FORM ACTION="cursor_test.asp" METHOD=POST&gt;
     Select a cursor type:&lt;br&gt;
     &lt;SELECT NAME="intCursorType" SIZE="4"&gt;
     &lt;OPTION VALUE=0 SELECTED&gt;Forward Only
     &lt;OPTION VALUE=1&gt;Keyset
     &lt;OPTION VALUE=2&gt;Dynamic
     &lt;OPTION VALUE=3&gt;Static
     &lt;/SELECT&gt;
     &lt;P&gt;
     &lt;INPUT TYPE="RADIO" NAME="radServer" VALUE="oracle" CHECKED&gt;Oracle
     &lt;INPUT TYPE="RADIO" NAME="radServer" VALUE="sql"&gt;SQL Server
     &lt;P&gt;
     &lt;INPUT TYPE=SUBMIT VALUE="Test"&gt;
     &lt;/FORM&gt;
     &lt;%Else
     Set objConn = Server.CreateObject("ADODB.Connection")
     If strServer="oracle" Then
     objConn.Open "DRIVER={Microsoft ODBC for
     Oracle};UID=you;PWD=me;SERVER=dseOracle;ConnectString=dseOracle;"
     Else
     objConn.Open
     "DSN=LocalServer;SERVER=(local);UID=sa;PWD=;APP=Microsoft (R)
     Developer
     Studio;WSID=MAGISTER;DATABASE=pubs;OemToAnsi=Yes"
     End If
     Set cmdTemp = Server.CreateObject("ADODB.Command")
     Set objRst = Server.CreateObject("ADODB.Recordset")
     cmdTemp.CommandText = "SELECT colleague.* FROM colleague"
     cmdTemp.CommandType = 1
     Set cmdTemp.ActiveConnection = objConn
     objRst.CursorType=intCursorType
     objRst.Open cmdTemp, , , 3
     Response.Write("You selected a cursortype of " &amp; intCursorType
     &amp;";&lt;BR&gt;")
     Response.Write(strServer &amp; " used cursortype=" &amp; objRst.CursorType)
</PRE><P>
<P><PRE>     Randomize
     pk=cint(Rnd()*100)
     Response.Write "&lt;P&gt;Adding record with pk of " &amp; pk
     objRst.AddNew
     objRst(0)=pk
     objRst(1)="michael"
     objRst(2)="corning"
     objRst(3)=intCursorType
     objRst.Update
</PRE><P>
<P><PRE>     If objConn.Errors.Count&gt;0 Then%&gt;
     &lt;P&gt;
     &lt;HR&gt;
     A table with the following definition returns the error below when a
     query-based update is attempted against &lt;%=strServer%&gt;
     with cursortype = &lt;%=objRst.CursorType%&gt;.
     &lt;P&gt;
     &lt;FONT COLOR=GREEN&gt;
     &lt;PRE&gt;
     CREATE TABLE colleague
     (
<PRE></PRE>     id               INTEGER,
     firstname      VARCHAR2(35),
     lastname         VARCHAR2(35),
     address         VARCHAR2(33),
     PRIMARY KEY(id)
     )
     &lt;/PRE&gt;

     &lt;/FONT&gt;
     &lt;%For Each objErr in objConn.Errors
     Response.Write(objErr.Description)
     Response.Write("&lt;BR&gt; Source &amp;nbsp; &amp;nbsp;" &amp; objErr.Source)
     Response.Write("&lt;BR&gt; SQLState &amp;nbsp; &amp;nbsp;" &amp; objErr.SQLState)
     Response.Write("&lt;BR&gt; NativeError &amp;nbsp; &amp;nbsp;" &amp;
     objErr.NativeError)
     Response.Write("&lt;HR&gt;")
     Next
     Else
     Response.Write("&lt;P&gt;Record added successfully.")
     End If
     objRst.Close
     Set objRst=Nothing
     Set cmdTemp=Nothing
     objConn.Close
     Set objConn=Nothing
     End If%&gt;
     &lt;/BODY&gt;
     &lt;/HTML&gt;

</PRE></OL> 
<PRE>Technology        : kbInetDev
Version           : WINDOWS:1.0,1.5,2.0; WINNT:1.0,1.0b,3.0
Platform          : WINDOWS winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 22, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
