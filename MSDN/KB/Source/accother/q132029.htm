

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADT2: DOC GetRecordsetClone Method Unsuccessful Win 95/NT 3.5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132029">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1995/06/26">
<META NAME="Keywords" CONTENT="IntpCstm kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use the GetRecordSetClone method from the Data Outline control, you may receive the following error message:      The Microsoft Data Outline Control returned the fo...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIB,QBWP,QA1S,QA7O,QAMN,QAB5,QDN9,QAOE,QAB4,QBWS,QA9Q,QAYY,QAPN,QBT6,QBV4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ADT2: DOC GetRecordsetClone Method Unsuccessful Win 95/NT 3.5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132029</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access Developer's Toolkit version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use the GetRecordSetClone method from the Data Outline control,
you may receive the following error message:
<P>
<PRE>    The Microsoft Data Outline Control returned the following
    error: The control could not create an OLE RecordsetClone.

</PRE>This error message occurs after you have installed the OLE 2.02 DLL
(dynamic-link library) files from either the Microsoft Access version 2.0
Service Pack or from some other source containing the OLE 2.02 DLL files.
<P>
<P><h2>CAUSE</h2>
 
<P>
The OLE 2.02 DLLs include a registration script file named OLE2.REG. This
file is used by the Registry application to build a special tree that
contains information about the applications or DLLs in the REG.DAT file.
<P>
One branch of this tree contains registration information for the file
named DAO2016.DLL. This file is used by the GetRecordSetClone method that
is accessed by the Data Outline control.
<P>
When you run the OLE2.REG file to register the OLE 2.02 DLLs in Microsoft
Windows NT, it rebuilds this branch of the registration tree from scratch
and drops the registration information regarding the DAO2016.DLL file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, register the DAO2016.DLL file with the MSAREG.EXE
file that comes with Microsoft Access Developer's Toolkit.
<P>
To register the DAO2016.DLL file using the MSAREG.EXE file, follow these
steps:

<OL><P><LI>Locate the MSAREG.EXE file. The default location for this file is the
   \ACCESS\ADT directory.

<P><LI>Locate the DAO2016.DLL file. The default location for this file is the
   WINNT\SYSTEM directory.

<P><LI>Open File Manager, and on the File menu, click run. In the Run dialog
   box, type "c:\access\adt\msareg c:\winnt\system\dao2016.dll" (without
   the quotation marks) in the Command Line box. Click the OK button.
<P>
   Note that the MSAREG.EXE file gives no indication that the file is
   registered. It does this registration silently.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
2.0 running under Windows NT version 3.5. This problem no longer occurs
with the Data Outline Control version 1.1 distributed with the Microsoft
Access Developer's Toolkit for Windows 95 version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a computer running Windows NT version 3.5 and a clean version of
   Microsoft Access version 2.0 that has Microsoft Access Developer's
   Toolkit installed.

<P><LI>Create a new form and insert a Data Outline Control that refers to
   at least two levels. Save the form as MyDOC.
<P>
   NOTE: For instructions about how to use the Data Outline control, see
   the OLE Data Outline Control Help file, OUTL1016.HLP, in your ADT
   directory.

<P><LI>Add a text box to the MyDOC form and call it MyText.

<P><LI>Add a command button to the MyDOC form called MyButton, and set the
   control's OnClick property to the following event procedure:
<P>
<PRE>      Sub MyButton_Click ()
         Dim rs As Object, iLevel As Integer
         iLevel = MyDOC.Object.GetLevel()
         Set rs = MyDOC.Object.GetRecordsetClone(iLevel)
         MyText  = rs.fields(0)
         Set rs = Nothing
      End Sub

</PRE><P><LI>Save and close the MyDOC form.

<P><LI>Open the MyDOC form in Form view, select a level on the Data Outline
   control and click the Mybutton command button. Note that the text
   box named MyText changes to the first field in the level of the Data
   Outline control that you selected.

<P><LI>Quit Microsoft Access and install the OLE 2.02 DLLs.

<P><LI>Restart Microsoft Access. Open the form and click the Mybutton command
   button again. Note that you receive the following error message:
<P>
<P><PRE>      The Microsoft Data Outline Control returned the following
      error: control could not create an OLE RecordsetClone.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Windows NT Registry for 16-bit applications,
please see the Windows NT version 3.5 Resource Kit.
<P>
For an overview of the Windows NT Registry, please see Microsoft Windows
NT, "Resource Guide," pages 322-368.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpCstm kberrmsg kbinterop<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
