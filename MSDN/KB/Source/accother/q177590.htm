

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ODE97: Setup Not Completed Successfully Installing Custom App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177590">
<META NAME="KBModify" CONTENT="1997/12/04">
<META NAME="KBCreate" CONTENT="1997/12/03">
<META NAME="Keywords" CONTENT="OdeStf kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  When you use the Microsoft Office 97 Developer Edition Tools (ODE) Setup wizard or the Microsoft Access 7.0 Developer's Toolkit (ADT) to create a custom Setup program, and ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QAH4,QDN9,QDKX,QA1S,QAIB,QDIU,QBXT,QA5V,QBWS,QDNJ,QDKY,QBB0 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODE97: Setup Not Completed Successfully Installing Custom App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177590</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access Developer's Toolkit version 7.0
<LI>Microsoft Office 97 Developer Edition Tools
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
When you use the Microsoft Office 97 Developer Edition Tools (ODE) Setup
wizard or the Microsoft Access 7.0 Developer's Toolkit (ADT) to create a
custom Setup program, and you include a database file name on the screen
that asks
<P>
<PRE>   Do you want to run an executable file after your custom
   Setup program is completed?

</PRE>you may receive the following error message when you run your custom Setup
program on any computer:
<P>
<PRE>   Setup was not completed successfully

</PRE><h2>CAUSE</h2>
 
<P>
This behavior may occur if the custom Setup program cannot find or open the
executable file (msaccess.exe) that was specified in the "Enter or edit the
command line that is used to run the executable file:" text box.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can resolve this behavior by using one of the following methods. Both
of these methods are described in detail later in this article.

<UL><LI>Modify the Setup wizard program to include the correct path to the
   executable file.

<LI>Modify the SETUP.STF file to include the correct path to the executable
   file.
<P>
   NOTE: Modifications to an STF file should be made using a backup copy
   of the file and following the procedures outlined in the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A HREF="../SETUP/Q111248.htm">Q111248</A></B>
<PRE></PRE>      TITLE     : XL: Saving .STF File in Excel May Cause Setup Error
                  Messages

</PRE></UL><h3>Modifying the Setup Wizard Program</h3>
 

<OL><P><LI>Start the Setup wizard program.

<P><LI>Modify the "Enter or edit the command line that will be used to
   run the executable file:" text box to include a valid path. For
   example, if you are adding a line similar to the following to the
   command line
<P>
<P><PRE>       "$(Filepath)\msaccess.exe" /runtime FilePath)\Northwind.mdb"
</PRE><P>
   you should change it to the following:
<P>
<PRE>        "\Program Files\Microsoft Office\msaccess.exe" /runtime
        "$(FilePath)\Northwind.mdb"

</PRE><P><LI>Recreate your disk images.

<P><LI>Rerun your custom setup program.
<P>
</OL><h3>Modifying the SETUP.STF File</h3>
 
<P>
NOTE: This procedure makes changes to the SETUP.STF file, which is not
supported by Microsoft. Microsoft provides this information "as is" without
warranty of any kind, either express or implied, including but not limited
to the implied warranties of merchantability and/or fitness for a
particular purpose.

<OL><P><LI>Make a backup copy of the SETUP.STF file located in your DISK1
   folder (or the network folder if you chose a Network Setup), and name
   the backup copy SETUPSTF.BAK.

<P><LI>Open the SETUP.STF file that the Setup wizard program creates using
   Microsoft Excel.

<P><LI>Modify the line that contains the custom command line. For example, if
   the CustomAction for the command line reads as follows
<P>
<P><PRE>     "msacccah.dll","AsyncEXECalloutCAH","""%1325\msaccess.exe""
     ""/runtime"" ""%1325\Northwind.mdb"""
</PRE><P>
   you should change it to the following:
<P>
<P><PRE>    In Microsoft Access 97
    ----------------------
</PRE><P>
<P><PRE>     "msacccah.dll","AsyncEXECalloutCAH","""\Program Files\Microsoft
     Office\msaccess.exe"" ""/runtime"" ""%1325\Northwind.mdb"""
</PRE><P>
<P><PRE>     Note that in the example, you are modifying the first reference to
     "%1325" with "\Program Files\Microsoft Office".
</PRE><P>
<P><PRE>    In Microsoft Access 7.0
    -----------------------
</PRE><P>
<P><PRE>     "msacccah.dll","SyncEXECalloutCAH","""\Program Files\Common Files\
     Microsoft Shared\Microsoft Access Runtime\msaccess.exe"" ""/runtime""
     ""%1325\Northwind.mdb"""
</PRE><P>
<P><PRE>     Note that in the example, you are modifying the first part of the
     command that reads as "%825" with "\Program Files\Common Files\
     Microsoft Shared\Microsoft Access Runtime".
</PRE>
<P><LI>Close and save the SETUP.STF file.
<P>
   NOTE: Make sure that you replace the existing SETUP.STF file by
   specifying the correct folder for the newly saved file.

<P><LI>Rerun your custom Setup program.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In the Microsoft Access Developer's Toolkit 7.0 Setup wizard or the
   Microsoft Office 97 Developer Edition Tools Setup wizard, create a
   custom Setup program that includes the sample database Northwind.mdb.

<P><LI>On the screen that asks
<P>
<P><PRE>      Do you want to run an executable file after your custom Setup
      program is completed?
</PRE><P>
   enter the Northwind database as the file that you want to run after
   setup completes.

<P><LI>Type the following command line in the "Enter or edit command line that
   will be used to run the executable file.":
<P>
<P><PRE>      "$(AppPath)MSACCESS.EXE" /runtime "$(FilePath)\Northwind.mdb"
</PRE>
<P><LI>Click to select the "Allow Setup to Complete Before the File Finishes
   Executing" check box.

<P><LI>Create your disk images and install them on any computer. Note that you
   receive the message mentioned in the "Symptoms" section.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about customizing the SETUP.STF file, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A HREF="../OFFICE/Q119357.htm">Q119357</A></B>
   TITLE     : AppNote: "How to Create a Custom Installation Script"
               (WC1046)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prb<BR>
Keywords          : OdeStf kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 4, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
