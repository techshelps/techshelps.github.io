

<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADT2: How to Supply a Custom System Database with an ADT App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142601">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1996/01/16">
<META NAME="Keywords" CONTENT="kbsetup StpHowto">
<META NAME="KBArea" CONTENT="Support; KB; accother, access, office, officevba, vbapp">
<META NAME="Description" CONTENT="  When you install a custom application created with the Microsoft Access Developer's Toolkit (ADT), the Setup program creates a new, unsecured system database (named SYSTEM.MDA) and modifies the custom .INI file so that it references the new SYSTEM....">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAE1,QDI2,QA5V,QDMN,QAZV,QAH6,QDIZ,QACI,QAMB,QDIU,QAEF,QAJH,QA9N,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ADT2: How to Supply a Custom System Database with an ADT App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142601</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access Developer's Toolkit version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you install a custom application created with the Microsoft Access
Developer's Toolkit (ADT), the Setup program creates a new, unsecured
system database (named SYSTEM.MDA) and modifies the custom .INI file so
that it references the new SYSTEM.MDA. This article explains how you can
customize the Setup program to use your secured system database instead of
the new, unsecured SYSTEM.MDA.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you want to supply your own system database, there are two general steps
to follow. First, in the ADT Setup Wizard, you add the custom system
database along with the other files for your application. Second, after
creating your distribution disks, you modify the SETUP.STF file to prevent
the creation of a new SYSTEM.MDA file and to set the system database name
for the [Options] section of your application's .INI file.
<P>
To modify the SETUP.STF file to use your system database instead of a new,
unsecured SYSTEM.MDA, you can follow this procedure.
<P>
NOTE: This procedure makes changes to the SETUP.STF file which is not
supported by Microsoft. Microsoft provides this information "as is" without
warranty of any kind, either express or implied, including but not limited
to the implied warranties of merchantability and/or fitness for a
particular purpose.

<OL><P><LI>Make a backup copy of the SETUP.STF file located in your DISK1
    directory (or in the shared directory of the administrator's
    installation on the network server), and name the backup copy
    SETUPSTF.BAK.

<P><LI>Open the SETUP.STF file using an application that supports a delimited-
    text file format, such as Microsoft Excel.

<P><LI>In the first column of the SETUP.STF file, scroll down to the row that
    contains ObjID. Note that the ObjID row contains column headings. Three
    of these column headings (ObjID [column 1], Title [column 3], and
    Object Data [column 6]) are referenced in steps 4 through 10.

<P><LI>In the ObjID row, move the pointer to the Title column (column 3).

<P><LI>In the Title column, scroll down to the row that contains "Create
    SYSTEM.MDA." This row is usually located near the bottom of the
    SETUP.STF file.

<P><LI>In the Create SYSTEM.MDA row, move the pointer the ObjID column
    (column 1), and write down the ObjID value.

<P><LI>Move the pointer to the Title column (column 3), and scroll to the
    row that contains "User Non File Work."

<P><LI>In the User Non File Work row, move the pointer to the Object Data
    column (column 6), and delete the ObjID value that you wrote down in
    step 6.

<P><LI>In the Title column (column 3), scroll to the row that contains
    "USER_UserINI_1."

<P><LI>In the USER_UserINI_1 row (or the USER_UserINI_2 row), move the pointer
    to the Object Data column (column 6), and replace the name "SYSTEM.MDA"
    with the name of your system database. For example, if your system
    database is called SECURE.MDA, you can change the following sample
    line:
<P>
       "%322\myapp.ini", "Options", "SystemDB", "%26\SYSTEM.MDA"
<P>
    to:
<P>
       "%322\myapp.ini", "Options", "SystemDB", "%26\SECURE.MDA"
<P>
    NOTE: This step ensures that your program will find and use the custom
    system database, regardless of the application path specified by any
    user at the time the user installs your application.

<P><LI>Save the SETUP.STF file as a delimited-text file.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: workgroup<BR>
Keywords            : kbsetup StpHowto<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A HREF="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
