<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Toolbar Buttons</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2>

<A NAME="_toolbar_buttons"></A>Toolbar Buttons</H2>

<P>Toolbar buttons are bit images, not child windows as other buttons are. When a user clicks a toolbar button, the toolbar sends its parent window a WM_COMMAND message with the button's command identifier.</P>

<P>If you want to assign a shortcut key to a toolbar button, you can use the button's ToolTip to let the user know what the shortcut is. </P>

<P>Each button in a toolbar can include a bit image. A toolbar maintains an internal list that contains all of the bitmaps that have been assigned to each of its toolbar buttons. When you call the <B>CreateToolbarEx</B> function, you specify a monochrome or color bitmap that contains the initial images. The toolbar then adds the information to the internal list of images. You can add additional images later by using the TB_ADDBITMAP message. </P>

<P>Each image has a zero-based index. The first image added to the internal list has an index of zero, the second image has an index of one, and so on. TB_ADDBITMAP adds images to the end of the list and returns the index of the first new image that it added. You use an image's index to associate the image with a button.</P>

<P>Windows CE assumes that all of a toolbar's bitmaps are the same size. You specify the size when you create the toolbar by using <B>CreateToolbarEx</B>. If you use the <B>CreateWindowEx</B> function to create a toolbar, the size of its bitmaps is set to the default dimensions of 16 by 15 pixels. You can use the TB_SETBITMAPSIZE message to change the dimensions of the bitmaps, but you must do so before adding any images to the internal list of images.</P>

<P>Each button can display a string in addition to, or instead of, an image. A toolbar maintains an internal list that contains all of the strings available to toolbar buttons. You add strings to the internal list by using the TB_ADDSTRING message, specifying the address of the buffer containing the strings to add. Each string must be null-terminated, and the last string must be terminated with two null characters. </P>

<P>Each string has a zero-based index. The first string added to the internal list of strings has an index of zero, the second string has an index of one, and so on. TB_ADDSTRING adds strings to the end of the list and returns the index of the first new string. You use a string's index to associate the string with a button.</P>

</BODY>
</HTML>
