<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Examples of CEUTIL Functions</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H3>

<A NAME="_examples_of_ceutil_functions"></A>Examples of CEUTIL Functions</H3>

<P>The following code example shows how to enumerate device partnerships and get file sync folder path.</P>

<PRE><CODE>HCESVC   hsvc            = NULL;
HCESVC   hsvcSync        = NULL;
HCESVC   hsvcProfile     = NULL;
DWORD    cProfilesEnum   = 0;
DWORD    nProfileID      = 0;

while (SUCCEEDED (CeSvcEnumProfiles(&amp;hsvc, cProfilesEnum, &amp;nProfileID)))
{
   if (nProfileID != (DWORD)-1)
   {
      if (SUCCEEDED(CeSvcOpenEx(hsvcProfile, TEXT("Services\\Synchronization"), FALSE, &amp;hsvcSync)))
         {
            TCHAR szPath[MAX_PATH];
            if (SUCCEEDED(CeSvcGetString(hsvcSync, TEXT("Briefcase Path"), szPath, sizeof(szPath)/sizeof(TCHAR))))
            {
               //complete tasks
            }
            CeSvcClose(hsvcSync);
         }
         CeSvcClose(hsvcProfile);
      }
   }
   cProfilesEnum++;
}
</CODE></PRE>

<P>The following code example shows how to add a custom menu.</P>

<PRE><CODE>HCESVC    hsvcMyMenu = NULL;

if (SUCCEEDED(CeSvcOpen(CESVC_CUSTOM_MENUS, TEXT("MyApp"), TRUE, &amp;hsvcMyMenu)))
{
   CeSVCSetString(hsvcMyMenu, TEXT("DisplayName"), TEXT("&amp;My Calculator"));
   CeSVCSetString(hsvcMyMenu, TEXT("Command"), TEXT("calc.exe"));
   CeSVCSetString(hsvcMyMenu, TEXT("StatusHelp"), TEXT("Displays calculator"));
   CeSVCSetString(hsvcMyMenu, TEXT("Version"), 0x00020000);
   CeSvcClose(hsvcMyMenu);
}
</CODE></PRE>

<P></P>

</BODY>
</HTML>
