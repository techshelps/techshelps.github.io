<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MailPutAttachment</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mailatt">
</OBJECT>
</TD></TR></TABLE>



<H1>

<A NAME="_mailputattachment"></A>MailPutAttachment</H1>

<P>The <B>MailPutAttachment </B>function adds or change an attachment to a mail message.</P>

<H4>Syntax</H4>

<P><B>BOOL</B> <B>MailPutAttachment</B> (<B>HANDLE</B> <I>hMail</I>, <B>MailMsg *</B> <I>pmm</I>, <B>MailAtt *</B> <I>pma</I><B>);</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Msgstore.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Versions:</TD>
<TD width=67%>2.0 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>hMail</I></DT>

<DD>Handle to the current mail context. This handle is created by the <A HREF="ce_func_2zou.htm"><B>MailOpen</B></A><B> </B>function.</DD>

<DT><I>pmm</I></DT>

<DD>Pointer to the mail message structure to which the attachment is to be added. The message must have been written to the object store so that the <I>oid</I> field has been set properly.</DD>

<DT><I>pma</I></DT>

<DD>Pointer to the mail attachment structure to be added to the message if the attachment identification number, <I>uiAttachmentNumber</I>, is greater than the current number of attachments. Otherwise it points to the new attachment to replace the existing one of the same <I>uiAttachmentNumber</I> value.</DD>
</DL>

<H4>Return Values</H4>

<P>The function returns TRUE if the attachment is added or changed; FALSE otherwise. In the latter case, the caller is responsible for the disposition of the file. To get extended error information, use <A HREF="ce_func_7w36.htm"><B>MailError</B></A> or <A HREF="ce_func_557r.htm"><B>MailErrorMsg</B></A>.</P>

<H4>Remarks</H4>

<P>For a local attachment, that is, when <I>szLocalName</I> (a member of the <A HREF="JavaScript:hhobj_1.Click()"><B>MailAtt</B></A> structure) is set to a non-NULL value, the <B>MailPutAttachment</B> function stores a local copy of the original file in a special folder which is constructed from the registry entries for the attachment directory.</P>

<P>There can be up to 64 attachments to a message. When a single file is attached more than once, the <B>MailPutAttachment</B> function ensures that every local file has a unique path (<I>szLocalName</I>).</P>

<P>Since a local file gets moved, the local name (<I>szLocalName</I>) supplied to the <B>MailPutAttachment</B> function will be different from its counterpart retrieved from the <B>MailGetAttachment</B> function.</P>

<P>When a user composes a message with a file attached, she may want to make a copy of the attached file. In this case, the application should make a copy of the original before invoking the <B>MailPutAttachment</B> function. It is unwise to assume that the transport service will perform such an operation.</P>

</BODY>
</HTML>
