<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Accelerator Tables</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_ACCEL_str">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TranslateAccelerator">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_LoadAccelerators">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TranslateAccelerator">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_CreateAcceleratorTable">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_DestroyAcceleratorTable">
</OBJECT>
</TD></TR></TABLE>



<H2>

<A NAME="_accelerator_tables"></A>Accelerator Tables</H2>

<P>An <I>accelerator table</I> consists of an array of <A HREF="JavaScript:hhobj_1.Click()"><B>ACCEL</B></A> structures, each defining an individual accelerator. Each <B>ACCEL</B> structure includes the following information: 

<UL>
	<LI>The accelerator's keystroke combination</LI>

	<LI>The accelerator's identifier</LI>

	<LI>Various flags</LI>
</UL>

<P>To process accelerator keystrokes for a specified thread, call the <A HREF="JavaScript:hhobj_2.Click()"><B>TranslateAccelerator</B></A> function in the message loop associated with the thread's message queue. This function monitors keyboard input to the message queue, checking for key combinations that match an entry in the accelerator table. When <B>TranslateAccelerator</B> finds a match, it translates the keyboard input, that is, the WM_KEYUP and WM_KEYDOWN messages, into a WM_COMMAND or WM_SYSCOMMAND message. It then sends the message to the window procedure of the specified window. </P>

<P>The WM_COMMAND message includes the identifier of the accelerator that caused <B>TranslateAccelerator</B> to generate the message. The window procedure examines the identifier to determine the source of the message and then processes the message accordingly. </P>

<P><B>Note</B>  Unlike Windows-based desktop platforms, Windows CE does not maintain a system-wide accelerator table that applies to all applications. </P>

<P>Windows CE maintains accelerator tables for each application. An application can define any number of accelerator tables for use with its own windows. A unique 32-bit handle, <B>HACCEL</B>, identifies each table. However, only one accelerator table can be active at a time for a specified thread. The handle of the accelerator table passed to the <B>TranslateAccelerator</B> function determines which accelerator table is active for a thread. The active accelerator table can be changed at any time by passing a different accelerator-table handle to <B>TranslateAccelerator</B>. </P>

<H5><IMG SRC="../../images/wedge.gif" ALT="" BORDER=0>&nbsp;&nbsp;&nbsp;&nbsp;To create an accelerator table</H5>

<OL>
	<LI>Use a resource compiler to create an accelerator table resource and to add it your executable file. </LI>

	<LI>Call the <A HREF="JavaScript:hhobj_3.Click()"><B>LoadAccelerators</B></A> function at run time to load the accelerator table and to retrieve the handle of the accelerator table.</LI>

	<LI>Pass a handle to the accelerator table to the <A HREF="JavaScript:hhobj_4.Click()"><B>TranslateAccelerator</B></A> function to activate the accelerator table. </LI>
</OL>

<P>You can create an accelerator table for an application at run time by passing an array of <B>ACCEL</B> structures to the <A HREF="JavaScript:hhobj_5.Click()"><B>CreateAcceleratorTable</B></A> function. This method supports user-defined accelerators in the application. Like the <B>LoadAccelerators</B> function, <B>CreateAcceleratorTable</B> returns an accelerator-table handle that can be passed to <B>TranslateAccelerator</B> to activate the accelerator table. </P>

<P>Windows CE automatically destroys accelerator tables loaded by <B>LoadAccelerators</B>. An accelerator table created by <B>CreateAcceleratorTable</B> must be destroyed before an application closes. Use the <A HREF="JavaScript:hhobj_6.Click()"><B>DestroyAcceleratorTable</B></A> function to destroy an accelerator table. </P>

</BODY>
</HTML>
