<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CeReadRecordProps</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_the_fsdbase_component">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_localalloc">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_getlasterror">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_cepropval">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_localalloc">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_localfree">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_cepropval">
</OBJECT>
</TD></TR></TABLE>



<H1>

<A NAME="_cereadrecordprops"></A>CeReadRecordProps </H1>

<P>The <B>CeReadRecordProps</B> function reads properties from the current record. A RAPI version of this function exists and is also called <B>CeReadRecordProps</B>. </P>

<H4>Syntax</H4>

<P><B>CEOID</B> <B>CeReadRecordProps(HANDLE</B> <I>hDbase</I><B>, DWORD</B> <I>dwFlags</I><B>, LPWORD</B> <I>lpcPropID</I><B>, CEPROPID</B> <B>*</B> <I>rgPropID</I><B>, LPBYTE</B> <B>*</B> <I>lplpBuffer</I><B>, LPDWORD</B> <I>lpcbBuffer<B>)</B></I><B>;</B> </P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Winbase.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Component:</TD>
<TD width=67%><A HREF="JavaScript:hhobj_1.Click()">fsdbase</A></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Windows CE versions:</TD>
<TD width=67%>1.01 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>hDbase</I> </DT>

<DD>Handle to an open database. The database must have been opened by a previous call to the <A HREF="ce_func_5wyt.htm"><B>CeOpenDatabase</B></A> function. </DD>

<DT><I>dwFlags</I> </DT>

<DD>Read flags. The following value is supported:

<DL>
<DT>CEDB_ALLOWREALLOC</DT>

<DD>The <A HREF="JavaScript:hhobj_2.Click()"><B>LocalAlloc</B></A> function was used to allocate the buffer specified by the <I>lplpBuffer</I> parameter, and the server can reallocate the buffer if it is not large enough to hold the requested properties.</DD>
</DL>
</DD>

<DT><I>lpcPropID</I> </DT>

<DD>Number of property identifiers in the array specified by the <I>rgPropID</I> parameter. If <I>rgPropID</I> is NULL, this parameter receives the number of properties retrieved. </DD>

<DT><I>rgPropID</I> </DT>

<DD>Pointer to an array of property identifiers for the properties to be retrieved. If this parameter is NULL, <B>CeReadRecordProps</B> retrieves all properties in the record. </DD>

<DT><I>lplpBuffer</I> </DT>

<DD>Address of a pointer to a buffer that receives the requested properties. If the <I>dwFlags</I> parameter includes the CEDB_ALLOWREALLOC flag, the buffer may be reallocated if necessary. If the CEDB_ALLOWREALLOC flag is specified and this parameter is NULL, the server uses the <B>LocalAlloc</B> function to allocate a buffer of the appropriate size in the caller's address space and returns a pointer to the buffer. Note that if the CEDB_ALLOWREALLOC flag is specified, it is possible for the value of this pointer to change even on failure. For example, the old memory might be freed and the allocation might then fail, leaving the pointer set to NULL.</DD>

<DT><I>lpcbBuffer</I> </DT>

<DD>Pointer to a variable that contains the size, in bytes, of the buffer specified by the <I>lplpBuffer</I> parameter. When <B>CeReadRecordProps</B> returns, <I>lpcbBuffer</I> receives a value that indicates the actual size of the data copied to the buffer. If the buffer was too small to contain the data, this parameter can be used to calculate the amount of memory to allocate for the buffer if CEDB_ALLOWREALLOC was not specified. 
</DD>
</DL>

<H4>Return Values</H4>

<P>If the function succeeds, the return value is the object identifier of the record from which the function read. If the function fails, the return value is zero. To get extended error information when within a CE program call <A HREF="JavaScript:hhobj_3.Click()"><B>GetLastError</B></A>. If within a RAPI program, call <A HREF="ce_func_7lpu.htm"><B>CeGetLastError</B></A>. <B>GetLastError </B>and <B>CeGetLastError</B> may return one of the following values:

<DL>
<DT>ERROR_INVALID_PARAMETER</DT>

<DD>A parameter was invalid.</DD>

<DT>ERROR_NO_DATA</DT>

<DD>None of the requested properties was found. The output buffer and the size are valid.</DD>

<DT>ERROR_INSUFFICIENT_BUFFER</DT>

<DD>The given buffer was not large enough, and the reallocation failed — if the CEDB_ALLOWREALLOC flag was specified. The <I>lpcbBuffer</I> parameter contains the required buffer size.</DD>

<DT>ERROR_KEY_DELETED</DT>

<DD>The record that was about to be read was deleted by another thread. If the current record was reached as a result of an autoseek, this error is not returned, and the next record is returned.</DD>

<DT>ERROR_NO_MORE_ITEMS</DT>

<DD>The current seek pointer is at the end of the database.
</DD>
</DL>

<H4>Remarks</H4>

<P>The <B>CeReadRecordProps</B> function reads the specified set of properties from the current record. If the database was opened with the autoseek flag — that is, if the <I>dwFlags</I> parameter of <B>CeOpenDatabase</B> was set to CEDB_AUTOINCREMENT — <B>CeReadRecordProps</B> increments the seek pointer by one so that the next call reads the next record in the current sort order. That is, if the database was opened with a sort order active, then <B>CeReadRecordProps</B> will return the records in sorted order. If the database was not opened with a sort order active, then the order in which records are returned is not predictable. </P>

<P>Read all needed properties from the record in a single call. The entire record is stored in a compressed format, and each time a property is read it must be decompressed. All the properties are returned in a single marshalled structure, which consists of an array of <A HREF="JavaScript:hhobj_4.Click()"><B>CEPROPVAL</B></A> structures, one for each property requested — or one for each property found if the application set the <I>rgPropID</I> parameter to NULL when calling the function. </P>

<P>If a property was requested, such as strings or blobs that are packed in at the end of the array, the pointers in the <B>CEPROPVAL</B> structures point into this marshalled structure. This means that the only memory that must be freed is the original pointer to the buffer passed in to the call. Even if the function fails, it may have allocated memory on the caller's behalf. Free the pointer returned by this function if the pointer is not NULL. </P>

<P>For more information, see <A HREF="objstore_9zqd.htm">Accessing Persistent Storage</A>.</P>

<P>When writing applications for Windows CE version 1.0, use the <B>PegReadRecordProps</B> function.</P>

<H4>See Also</H4>

<P><A HREF="JavaScript:hhobj_5.Click()"><B>LocalAlloc</B></A>, <A HREF="JavaScript:hhobj_6.Click()"><B>LocalFree</B></A>, <A HREF="ce_func_5wyt.htm"><B>CeOpenDatabase</B></A>, <A HREF="ce_func_0zl1.htm"><B>CeSeekDatabase</B></A>, <A HREF="JavaScript:hhobj_7.Click()"><B>CEPROPVAL</B></A></P>

</BODY>
</HTML>
