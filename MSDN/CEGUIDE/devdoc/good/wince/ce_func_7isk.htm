<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TransportSetPassword</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H1>

<A NAME="_transportsetpassword"></A>TransportSetPassword </H1>

<P>The <B>TransportSetPassword</B> function serves to change a user's service password.</P>

<H4>Syntax</H4>

<P><B>BOOL</B> <B>TransportSetPassword</B>(<B>HANDLE *</B> <I>InPtr</I>, <B>LPWSTR</B> <I>pszPassword</I>, <B>BOOL</B> <I>fRemember</I><B>);</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Smtp.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Windows CE versions:</TD>
<TD width=67%>2.0 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>InPtr</I></DT>

<DD>Handle to the <B>SERVICE</B> structure.</DD>

<DT><I>lszPassword</I></DT>

<DD>String to hold the user's password. The Transport should make a copy of it.</DD>

<DT><I>fRemember</I></DT>

<DD>If TRUE, the new password is to be saved for use in the future. Otherwise, it is only to be used for the current session.</DD>
</DL>

<H4>Return Values</H4>

<P>Returns TRUE if the password is saved, depending on the value of <I>fRemember,</I> in memory for the current session or in the registry for future sessions. Otherwise it returns FALSE.</P>

<H4>Remarks</H4>

<P>Transport DLLs can expose this function. This practice is encouraged, but not required. A mail client, such as Inbox, calls the function when the user changes her service password through the client. </P>

<P>In Windows CE 2.0, the POP3 transport encrypts the user's password before saving it in the registry. Inbox is refrained from touching the transport's registry entries. Before connecting the transport, the client application calls the <B>TransportSetPassword</B> function whenever the user supplies a password. This makes the transport the sole partner responsible for password encryption. The client application does not need to have any knowledge of the encryption.</P>

<P>The transports in Windows CE 1.01 do not expose this function. The Inbox application updates the transport section of the registry with the unencrypted password as entered by the user in the Password dialog. </P>

<P>When transport DLLs in Windows CE 2.0 do not expose the <B>TransportSetPassword</B> function, they can prompt for and save the password themselves as they would in Windows CE 1.01.</P>

</BODY>
</HTML>
