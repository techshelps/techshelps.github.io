<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Image Lists</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_IMAGELISTDRAWPARAMS">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_ImageList_DrawIndirect">
</OBJECT>
</TD></TR></TABLE>



<H2>

<A NAME="_using_image_lists"></A>Using Image Lists</H2>

<P>You create an image list by calling the <B>ImageList_Create</B> function. For a nonmasked image list, this function creates a single bitmap large enough to hold a specified number of images of the specified dimensions. Then, it creates a screen-compatible device context and selects the bitmap into it. For a masked image list, the function creates two bitmaps and two screen-compatible device contexts. It selects the image bitmap into one device context and the mask bitmap into the other. </P>

<P>In <B>ImageList_Create</B>, you specify the initial number of images that will be in an image list, as well as the number of images by which the list can grow. If you attempt to add more images than you initially specified, the image list automatically grows to accommodate the images. </P>

<P>If <B>ImageList_Create</B> succeeds, it returns a handle to the HIMAGELIST type. You use this handle in other image list functions to access the image list and manage the images. You can add and remove images, copy images from one image list to another, and merge images from two different image lists. When you no longer need an image list, you destroy it by specifying its handle in a call to the <B>ImageList_Destroy</B> function. </P>

<P>You use the <B>ImageList_Duplicate</B>, <B>ImageList_SetImageCount</B>, and <B>ImageList_RemoveAll</B> functions to respectively copy, resize, or remove all images from an image list.</P>

<P>Windows CE supports a structure for image lists, called <A HREF="JavaScript:hhobj_1.Click()"><B>IMAGELISTDRAWPARAMS</B></A>, which is used with the <A HREF="JavaScript:hhobj_2.Click()"><B>ImageList_DrawIndirect</B></A> function. The <B>IMAGELISTDRAWPARAMS</B> structure contains information about how to draw an image from an image list, such as what part of the image to draw, the foreground and background colors, the style, and a raster operation (ROP) code specifying how to combine the image's colors with the background colors. </P>

</BODY>
</HTML>
