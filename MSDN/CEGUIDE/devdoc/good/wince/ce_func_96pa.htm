<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CommandBands_GetRestoreInformation</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_commandbandsrestoreinfo">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_rb_idtoindex">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_rebarbandinfo">
</OBJECT>
</TD></TR></TABLE>



<H1>

<A NAME="_commandbands_getrestoreinformation"></A>CommandBands_GetRestoreInformation</H1>

<P>The <B>CommandBands_GetRestoreInformation</B> function retrieves information necessary to restore a band's current state, and places it in a <B>COMMANDBANDSRESTOREINFO</B> structure. </P>

<H4>Syntax</H4>

<P><B>BOOL WINAPI CommandBands_GetRestoreInformation(HWND </B><I>hwndCmdBands</I>, <B>UINT</B> <I>uBand</I>, <B>LPCOMMANDBANDSRESTOREINFO</B> <I>pcbr</I><B>);</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Commctrl.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Windows CE versions:</TD>
<TD width=67%>2.0 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>hwndCmdBands</I></DT>

<DD>The command bands control's window handle. This handle is returned when the command bands control is created by the <B>CommandBands_Create</B> function.</DD>

<DT><I>uBand</I></DT>

<DD>Zero-based index of the band containing the command bar. Use RB_IDTOINDEX to get the index of the band before passing the index to this function.</DD>

<DT><I>pcbri</I></DT>

<DD>Pointer to an array of <B>COMMANDBANDSRESTOREINFO</B> structures that will receive information about the band's current state. </DD>
</DL>

<H4>Return Values</H4>

<P>Returns TRUE on success and FALSE on failure.</P>

<H4>Remarks</H4>

<P>Use <B>CommandBands_GetRestoreInformation</B> to save information about the bands in a command bands control before you close the application window. Save the information in the registry, so the bands can be restored to their current state the next time the application is opened. The next time the application is opened, use the values returned in the <B>fStyle</B> and <B>cxRestored</B> fields of the <B>COMMANDBANDSRESTOREINFO</B> structure for the <B>fStyle</B> and <B>cx</B> fields of the <B>REBARBANDINFO</B> structure you pass to the <B>CommandBands_AddBands</B> function. After you've added all the bands to the control, use the RB_MAXIMIZEBAND message to maximize any band whose <B>fMaximized</B> field in the <B>COMMANDBANDSRESTOREINFO</B> structure is set to TRUE.</P>

<H4>See Also</H4>

<P><A HREF="ce_func_34s3.htm"><B>CommandBands_AddBands</B></A>, <A HREF="ce_func_0k4l.htm"><B>CommandBands_Create</B></A>, <A HREF="JavaScript:hhobj_1.Click()"><B>COMMANDBANDSRESTOREINFO</B></A>, <A HREF="JavaScript:hhobj_2.Click()">RB_IDTOINDEX</A>, <A HREF="JavaScript:hhobj_3.Click()"><B>REBARBANDINFO</B></A> </P>

</BODY>
</HTML>
