<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RasGetEntryDevConfig</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H1>

<A NAME="_rasgetentrydevconfig"></A>RasGetEntryDevConfig </H1>

<P>The <B>RasGetEntryDevConfig</B> function retrieves the device information saved by the last successful call to the <A HREF="ce_func_6mcn.htm"><B>RasSetEntryDevConfig</B></A> function. </P>

<H4>Syntax</H4>

<P><B>DWORD</B> <B>RasGetEntryDevConfig(LPCTSTR</B> <I>lpszPhoneBook</I><B>, LPCTSTR</B> <I>szEntry</I><B>, LPDWORD</B> <I>pdwDeviceID</I><B>, LPDWORD</B> <I>pdwSize</I><B>, LPVARSTRING</B> <I>pDeviceConfig</I><B>);</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Afdfunc.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Module:</TD>
<TD width=67%>Ras</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Windows CE versions:</TD>
<TD width=67%>1.0 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>lpszPhoneBook</I> </DT>

<DD>This parameter is ignored and should be set to NULL. Dial-up networking stores phone-book entries in the registry rather than in a phone-book file.</DD>

<DT><I>szEntry</I> </DT>

<DD>Pointer to a null-terminated string containing an existing entry name. </DD>

<DT><I>pdwDeviceID</I> </DT>

<DD>Returns the saved device identifier. </DD>

<DT><I>pdwSize</I> </DT>

<DD>Pointer to the size of the structure pointed to by <I>pDeviceConfig</I>. This should be filled with the size required. </DD>

<DT><I>pDeviceConfig</I> </DT>

<DD>Pointer to the memory location of the type <B>VARSTRING</B> where the device configuration structure is returned. If NULL then only the correct size is returned. 
</DD>
</DL>

<H4>Return Values</H4>

<P>If the function succeeds, the return value is zero. If the function fails, the return value will be set to an error value:

<DL>
<DT>ERROR_CANNOT_OPEN_PHONEBOOK</DT>

<DD>Invalid phone book.</DD>

<DT>ERROR_CANNOT_FIND_PHONEBOOK_ENTRY</DT>

<DD>Invalid <I>szEntry</I>.</DD>

<DT>ERROR_INVALID_PARAMETER</DT>

<DD>Invalid <I>szEntry</I>, <I>pdwDeviceID</I> or <I>pdwSize</I> parameter.</DD>

<DT>ERROR_BUFFER_TOO_SMALL</DT>

<DD>Specified buffer was too small.
</DD>
</DL>

<H4>Remarks</H4>

<P>In Windows CE version 2.0 the <B>RasGetEntryProperty</B> function supports the same functionality as the <B>RasGetEntryDevConfig</B> function. An application should use the <B>RasGetEntryProperties</B> function to retrieve device information.</P>

<P>An example of how to use the <B>RasGetEntryDevConfig</B> function follows: </P>

<PRE><CODE>DWORD   dwDeviceID;
LPVARSTRING pDeviceConfig;
DWORD   dwSize;
TCHAR szBuf[50];

dwSize = 0;
if (RasGetEntryDevConfig (NULL, EntryName, &amp;dwDeviceID,
                &amp;dwSize, NULL)) {
    OutputDebugString(TEXT("\r\nError getting device info size\r\n"));
    return;
}
pDeviceConfig = LocalAlloc (LPTR, dwSize);
if (RasGetEntryDevConfig (NULL, EntryName, &amp;dwDeviceID,
    &amp;dwSize, pDeviceConfig)) {
    OutputDebugString(TEXT("\r\nError getting device info size\r\n"));
    return;
} else {
    wsprintf(szBuf, TEXT("dwDeviceID=%d\r\n"), dwDeviceID);    
    OutputDebugString(szBuf);
    if (pDeviceConfig) {
        wsprintf(szBuf, TEXT("Have a device config at: 0x%X\r\n"),
            pDeviceConfig));
        OutputDebugString(szBuf);
        LocalFree(pDeviceConfig);
    }
}
</CODE></PRE>

</BODY>
</HTML>
