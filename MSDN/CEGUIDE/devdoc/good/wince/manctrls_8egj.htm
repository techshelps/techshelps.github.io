<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Active and Inactive Property Sheet Pages</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H3>

<A NAME="_active_and_inactive_property_sheet_pages"></A>Active and Inactive Property Sheet Pages</H3>

<P>A property sheet can have only one active page at a time. The active sheet is at the top of the overlapping stack of pages. The user activates a page by selecting its tab; an application uses the PSM_SETCURSEL message to activate a page. Before the page that will become the active page is visible, the property sheet sends it the PSN_SETACTIVE notification message. The page should respond by initializing its control windows.</P>

<P>The property sheet determines whether to enable or disable the <B>Help</B> button for an active page by checking for the PSP_HASHELP style. If the page has this style, it supports the <B>Help</B> button. If the PSP_HASHELP style is not present, it disables the button. When the user clicks the <B>Help</B> button, the active page receives the PSN_HELP notification message. The page should respond by displaying help information.</P>

<P>When the user clicks the <B>OK</B> button, the property sheet sends the PSN_KILLACTIVE notification message to the active page, giving it an opportunity to validate the user's changes. If the page determines that the changes are valid, it should call the <B>SetWindowLong</B> function to set the DWL_MSGRESULT value for the page to FALSE. In this case, the property sheet sends the PSN_APPLY notification message to each page, directing it to apply the new properties to the corresponding item. If the page determines that the user's changes are not valid, it should set DWL_MSGRESULT to TRUE and display a dialog box informing the user of the problem. The page remains active until it sets DWL_MSGRESULT to FALSE in response to a PSN_KILLACTIVE message. </P>

<P>The property sheet sends the PSN_RESET notification message to all pages when the user clicks the <B>Cancel </B>button, indicating that it is about to destroy the property sheet. A page should use the notification to perform cleanup operations.</P>

<P><B>Note</B>  To set the position of a property sheet window in an application, use the <B>SetWindowPos</B> function rather than the <B>MoveWindow</B> function. Call <B>SetWindowPos</B> in the dialog box procedure of the property page that will open first when the user activates a property sheet. </P>

</BODY>
</HTML>
