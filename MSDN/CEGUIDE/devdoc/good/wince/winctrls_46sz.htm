<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scroll Bar Requests</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2>

<A NAME="_scroll_bar_requests"></A>Scroll Bar Requests</H2>

<P>The user makes scrolling requests by clicking various parts of a scroll bar. Windows CE sends the request to the specified window in the form of a WM_HSCROLL or WM_VSCROLL message for horizontal and vertical scroll bars, respectively. Each message includes a notification code that corresponds to the user's action to the handle of the scroll bar, for scroll bar controls only, and, in some cases, to the position of the scroll box. </P>

<P>Usually an application scrolls the content of a window in the direction opposite that indicated by the scroll bar. For example, when the user clicks the gray area below the scroll box, an application scrolls the object in the window upward to reveal a portion of the object that is below the visible portion. An application can also scroll a rectangular region using the <B>ScrollDC</B> function. </P>

<P>When you process the WM_CREATE message you can set scrolling units. It is convenient to base the scrolling units on the dimensions of the font associated with the window's display context (DC). To retrieve the font dimensions for a specific DC, use the <B>GetTextMetrics</B> function. When you process the WM_SIZE message, you can adjust the scrolling range and scrolling position to reflect the dimensions of the client area as well as the number of lines of text that will be displayed. </P>

<P>The scroll bar sends WM_HSCROLL and WM_VSCROLL messages to the window procedure whenever the user clicks the scroll bar or drags the scroll box. The low-order words of WM_VSCROLL and WM_HSCROLL each contain a notification message that indicates the direction and magnitude of the scrolling action. </P>

<P>When you process the WM_HSCROLL and WM_VSCROLL messages, you should examine the scroll bar notification message and calculate the scrolling increment. After you apply the increment to the current scrolling position, you can scroll the window to the new position by using the <B>ScrollWindowEx</B> function. You can use the <B>SetScrollInfo</B> function to adjust the position of the scroll box.</P>

<P>After you scroll a window, it makes part of the window's client area invalid. To ensure that the invalid region is updated, you use the <B>UpdateWindow</B> function to generate a WM_PAINT message.</P>

</BODY>
</HTML>
