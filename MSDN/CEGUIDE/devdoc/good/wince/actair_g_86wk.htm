<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example Channel Script</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H3>

<A NAME="_example_channel_script"></A>Example Channel Script</H3>

<PRE><CODE>&lt;html&gt;
&lt;%
    Set MC   = Server.CreateObject("MobileChannels.Utilities")
    URL      = Request.ServerVariables("URL")
    DataID   = Request.QueryString("DATAID")
    Pieces   = Split(URL,"/")
    ChanID   = Pieces(2)

' Get logo and title of channel  
    TopElem = MC.Locate(ChanID)
    ChanTitle = ""
    LogoHref = 0
    If TopElem Then
        ChanTitle = MC.Title(TopElem)
        LogoElem = TopElem
        LogoElem = MC.Navigate(LogoElem,"INMATCH","LOGO")
        Do While LogoElem
            LogoStyleElem = MC.Navigate(LogoElem,"INMATCH","STYLE")
            If LogoStyleElem Then
                If StrComp(MC.Value(LogoStyleElem),"IMAGE",1) = 0 Then
                    LogoHref = MC.Href(LogoElem)
                    If LogoHref Then
                        If MC.HrefExists(LogoHref) Then
                            Exit Do
                        Else
                            LogoHref = 0
                        End If
                   End If
                End If
            End If
            LogoElem = MC.Navigate(LogoElem,"NEXT")
                If LogoElem Then
                    LogoElem = MC.Navigate(LogoElem,"MATCH","LOGO")
                End If
        Loop
    End If

    NeedTitle = 1
    Response.Write("&lt;head&gt;&lt;title&gt;" &amp; ChanTitle &amp; "&lt;/title&gt;&lt;/head&gt;")
    If LogoHref Then
       Response.Write("&lt;body&gt;&lt;a href=mctp://" &amp; ChanID &amp; "&gt;
           &lt;img src=" &amp; LogoHref &amp; "&gt;&lt;/a&gt;&lt;br&gt;&amp;nbsp;&lt;br&gt;")
    ElseIf ChanTitle And Len(ChanTitle) Then
       Response.Write("&lt;body&gt;&lt;a href=mctp://" &amp; ChanID &amp; "&gt;
           &lt;h3&gt;" &amp; ChanTitle &amp; "&lt;/h3&gt;&lt;/a&gt;")
       NeedTitle = 0
    Else
        Response.Write("&lt;body&gt;")
    End If

' Decide whether you need a title for this chan/subchan
    If DataID And (DataID &lt;&gt; ChanID) Then
        NeedTitle = 1
    Else
        DataID = ChanID
    End If
    
    SubTitle = 0
    SubElem = MC.Locate(DataID)
    If SubElem Then
        SubTitle = MC.Title(SubElem)
        If SubTitle And NeedTitle Then
            Response.Write("&lt;b&gt;" &amp; SubTitle &amp; "&lt;/b&gt;&lt;br&gt;&amp;nbsp;&lt;br&gt;")
        End If

' Display contents of chan/subchan
        Response.Write("&lt;table border=0 cellpadding=-2 cellspacing=-2&gt;")
        ChildElem = MC.Navigate(SubElem,"In")
        Do While ChildElem
            ShowIt = 1
            IsChan = 0
            If MC.Tag(ChildElem) = "CHANNEL" Then
                IsChan = 1
                If Not MC.IsSubscribed(ChildElem) Then
                    ShowIt = 0
                End If
            ElseIf MC.Tag(ChildElem) = "ITEM" Then
                VisParElem = MC.Navigate(ChildElem,"InMatch","USAGE")
                    If VisParElem Then
                        Usage = MC.Value(VisParElem)
                            If Usage Then
                                If StrComp(Usage,"None",1) = 0 Then
                                    ShowIt  = 0
                                End If
                           End If
                    End If
' Be sure item exists
                    If ShowIt Then
                        ChildHref = MC.Href(ChildElem)
                        If ChildHref Then
                            If Not MC.HrefExists(ChildHref) Then
                                ShowIt = 0
                            End If
                        Else
                            ShowIt = 0
                        End If
                    End If
          Else
              ShowIt = 0
          End If

          If ShowIt Then
' Be sure you can get the ID
            IDVal = 0
            IDElem = MC.Navigate(ChildElem,"InMatch","ID")
                If IDElem Then
                    IDVal       = MC.Value(IDElem)
                End If
                If Not IDVal Then
                    ShowIt = 0
                End If
         End If
' Get title
        If ShowIt Then
            ItemTitle = MC.Title(ChildElem)
            If Not ItemTitle Or (Len(ItemTitle) = 0) Then
                ShowIt = 0
            Else
                If Len(ItemTitle) &gt; 26 Then
                    ItemTitle = Mid(ItemTitle,0,25) &amp; "..."
                End If
            End If
        End If
' You know what it is and are going to try to show it
        If ShowIt Then
            If IsChan Then
                Response.Write("&lt;tr&gt;&lt;td&gt;*")
            Else
                Response.Write("&lt;tr&gt;&lt;td&gt;")
            End If
            Response.Write("&lt;td&gt;&amp;nbsp;&lt;a href=mctp://" &amp; ChanID &amp; "/"
               &amp; IDVal &amp; "&gt;" &amp; ItemTitle &amp; "&lt;/a&gt;")
        End If
        ChildElem       = MC.Navigate(ChildElem,"Next")
        Loop
        Response.Write("&lt;/table&gt;")
    Else
        Response.Write("Data ID not found.")
    End If
%&gt;

&lt;br&gt;&amp;nbsp;&lt;br&gt;&lt;hr&gt;
&lt;b&gt;Note:&lt;/b&gt; This page was automatically generated because the correct
scripts could not be found.  If this problem persists after synchronization,
please contact the content provider.
&lt;/body&gt;
&lt;/html&gt;</CODE></PRE>

</BODY>
</HTML>
