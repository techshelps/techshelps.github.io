<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Fonts</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2>

<A NAME="_using_fonts"></A>Using Fonts</H2>

<P>Use the <B>AddFontResource</B> function to load a font from a font-resource file. When you finish using an installed font, use the <B>RemoveFontResource</B> function to remove it. Whenever you add or delete a font resources, you should use the <B>SendMessage</B> function to send a <B>WM_FONTCHANGE</B> message to all top-level windows in the system. This message notifies other applications that the an application has added or removed a font to the internal font table. You do not need to use <B>AddFontResources</B> to create or realize system fonts. </P>

<P>There are two stages to selecting a font. In the first stage, you specify the ideal font you would like to use. This theoretical font is called a logical font. In the second stage, an internal algorithm finds the physical font that is the closest match to your specified logical font. A physical font is a font stored on the device or in the operating system. The process of finding the physical font that most closely matches a specified logical font is called font mapping. </P>

<H5><IMG SRC="../../images/wedge.gif" ALT="" BORDER=0>&nbsp;&nbsp;&nbsp;&nbsp;To use a font</H5>

<OL>
	<LI>Use the <B>EnumFontFamilies</B> function to list the available fonts. This is especially useful when you want to determine which fonts are available from a specified font family or typeface.</LI>

	<LI>Use the values returned by the font enumeration function to initialize the members of a <B>LOGFONT</B> structure.</LI>

	<LI>Create the logical font by calling the <B>CreateFontIndirect</B> function and passing it a pointer to the initialized <B>LOGFONT</B> structure.</LI>

	<LI>Select the logical font into the current device context with the <B>SelectObject</B> function. </LI>
</OL>

<P></P>

<P>When you call <B>SelectObject</B>, Windows CE will load the physical font that most closely matches the logical font specified in the <B>LOGFONT</B> structure. </P>

<P>When initializing the members of the <B>LOGFONT </B>structure, be sure that the <B>lfCharSet</B> member specifies a specific character set. This member is used in the font mapping process and the results will be inconsistent if this member is not initialized correctly. If you specify a typeface name in the <B>lfFaceName </B>member of the <B>LOGFONT </B>structure, be sure that the <B>lfCharSet</B> value contains a matching value. </P>

<P>Windows CE keeps a table containing all the fonts available for application use. When you call <B>CreateFontIndirect</B>, Windows CE chooses a font from this table. </P>

<P>Windows CE provides six stock logical fonts. You can use the <B>GetStockObject</B> function to obtain a stock font. The stock font values are described in the following table. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TH align=left width=37%>Value</TH>
<TH align=left width=63%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=37%>ANSI_FIXED_FONT</TD>
<TD width=63%>Specifies a monospace font based on the Windows character set, usually represented by a Courier font. </TD>
</TR>

<TR VALIGN="top">
<TD width=37%>ANSI_VAR_FONT</TD>
<TD width=63%>Specifies a proportional font based on the Windows character set, usually represented by the MS Sans Serif font.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%>DEVICE_DEFAULT_FONT</TD>
<TD width=63%>Specifies the preferred font for the specified device, usually represented by the System font for display devices. </TD>
</TR>

<TR VALIGN="top">
<TD width=37%>OEM_FIXED_FONT</TD>
<TD width=63%>Specifies a monospace font based on an OEM character set. For IBM computers and compatibles, the OEM font is based on the IBM desktop computer character set.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%>SYSTEM_FONT</TD>
<TD width=63%>Specifies the System font. This is a proportional font based on the Windows character set, and is used by the operating system to display window titles, menu names, and text in dialog boxes. The System font is always available. Other fonts are available only if they have been installed.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%>SYSTEM_FIXED_FONT</TD>
<TD width=63%>Specifies a monospace font compatible with the System font in Windows versions earlier than 3.0.</TD>
</TR>
</TABLE><BR>

</BODY>
</HTML>
