<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CeSvcOpen</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H1>

<A NAME="_cesvcopen"></A>CeSvcOpen</H1>

<P>Opens and returns a handle to the registry root for a specified logical position, as specified by the CEUTIL constants shown in the table below. This is part of CEUTIL, a utility dll for dealing with desktop registry entries for Windows CE.</P>

<H4>Syntax</H4>

<P><B>HRESULT</B>  <B>CeSvcOpen(</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>UINT</B> <I>uSvc</I>,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>LPTSTR</B> <I>pszPath</I>,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>BOOL</B> <I>fCreate,</I><BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>PHCESVC</B> <I>phSvc</I><BR>
<B>);</B></P>

<H4>Parameters</H4>

<DL>
<DT><I>uSvc</I></DT>

<DD>Logical subkey in registry as identified by CESVC_* keys.

<P>The following table maps registry locations to pre-defined constants.<B> MACHINE_ROOT</B> is used for <B>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows CE</B> and <B>LOCAL_ROOT</B> is used for <B>HKEY_CURRENT_USER\Software\Microsoft\Windows CE Service</B>.


<TABLE cols=3>

<TR VALIGN="top">
<TH align=left width=30%>Registry Key</TH>
<TH align=left width=33%>CEUTIL Constants</TH>
<TH align=left width=37%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=30%>MACHINE_ROOT</TD>
<TD width=33%>CESVC_ROOT_MACHINE</TD>
<TD width=37%>Windows CE Services root hierarchy under HKEY_LOCAL_MACHINE</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MACHINE_ROOT\Filters</TD>
<TD width=33%>CESVC_FILTERS</TD>
<TD width=37%>the Filters registry root.  New filters should register themselves here</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MACHINE_ROOT\CustomMenus</TD>
<TD width=33%>CESVC_CUSTOM_MENUS</TD>
<TD width=37%>Custom menus reg root</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MACHINE_ROOT\Services</TD>
<TD width=33%>CESVC_SERVICES_COMMON</TD>
<TD width=37%>Services reg root</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MACHINE_ROOT\Services \Synchronization</TD>
<TD width=33%>CESVC_SYNC_COMMON</TD>
<TD width=37%>Synchronization registry root.  New sync services should register here</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>LOCAL_ROOT</TD>
<TD width=33%>CESVC_ROOT_USER</TD>
<TD width=37%>Windows CE Services root hierarchy under HKEY_CURRENT_USER</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>LOCAL_ROOT\Partners</TD>
<TD width=33%>CESVC_DEVICES</TD>
<TD width=37%>Individual device subkeys are created under this key</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>LOCAL_ROOT\Partners\&lt;device id&gt;</TD>
<TD width=33%>CESVC_DEVICEX</TD>
<TD width=37%>Particular device root subkey</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>LOCAL_ROOT\Partners\&lt;selected device id&gt;</TD>
<TD width=33%>CESVC_DEVICE_SELECTED</TD>
<TD width=37%>Root subkey for the currently selected device</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>LOCAL_ROOT\Partners\&lt;device id&gt;\Services</TD>
<TD width=33%>CESVC_SERVICES_USER</TD>
<TD width=37%>Root Services subkey for a particular device</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>LOCAL_ROOT\Partners\&lt;device id&gt;\Services\Synchronization</TD>
<TD width=33%>CESVC_SYNC</TD>
<TD width=37%>Synchronization reg root for a particular device</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>pszPath</I></DT>

<DD>Specifies either a subpath to append to the logical subkey, or a DWORD device identifier (if uSvc is CESVC_DEVICEX).</DD>

<DT><I>fCreate</I></DT>

<DD>TRUE—subkey should be created if it doesn't exist.</DD>

<DT><I>phSvc</I></DT>

<DD>Returns the logical handle to the registry subkey. This handle is equivalent to a HKEY and can be used by other CEUTIL APIs as well as Win32 registry manipulation routines. 
</DD>
</DL>

<H4>Return value</H4>

<DL>
<DT>HRESULT</DT>

<DD>Standard Win32 error code.
</DD>
</DL>

<H4>Remarks</H4>

<P>The first time a device is connected to the desktop and a partnership is created, the various synchronization and filter settings are copied from the MACHINE_ROOT to the partnership subkey under LOCAL_ROOT.</P>

</BODY>
</HTML>
