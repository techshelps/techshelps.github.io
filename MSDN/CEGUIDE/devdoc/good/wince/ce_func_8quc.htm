<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MailSetField</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mailmsg">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mailmsg">
</OBJECT>
</TD></TR></TABLE>



<H1>

<A NAME="_mailsetfield"></A>MailSetField</H1>

<P>The <B>MailSetField</B> function is used to add, update, or delete fields from the message header.</P>

<H4>Syntax</H4>

<P><B>BOOL</B> <B>MailSetField</B> (<B>MailMsg*</B><I>pmm</I>, <B>LPWSTR</B> <I>szName</I>, <B>LPCWSTR </B><I>szVal<B>)</B></I><B>;</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Msgstore.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Versions:</TD>
<TD width=67%>1.0 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>pmm</I></DT>

<DD>Mail message containing the header entry to be changed.</DD>

<DT><I>szName</I></DT>

<DD>Pointer to a string containing the name field of the header entry to be added, deleted, or changed. When looking for a match, this parameter can be any combination of uppercase and lowercase letters because the name field is not case-sensitive.</DD>

<DT><I>szVal</I></DT>

<DD>Pointer to the new value for the field. If this parameter is NULL, the entry is deleted from the header string.</DD>
</DL>

<H4>Return Values</H4>

<P>This function returns TRUE if successful; FALSE if it fails. For extended error information, use <A HREF="ce_func_7w36.htm"><B>MailError</B></A> or <A HREF="ce_func_557r.htm"><B>MailErrorMsg</B></A>.</P>

<H4>Remarks</H4>

<P>The <B>MailSetField</B> function searches the header (that is, the <B>pwcHeaders</B> field) of the <A HREF="JavaScript:hhobj_1.Click()"><B>MailMsg</B></A> structure in memory. Before calling <B>MailSetField</B>, the message must be retrieved from the message store by calling <A HREF="ce_func_03zo.htm"><B>MailGet</B></A>, <A HREF="ce_func_6x84.htm"><B>MailFirst</B></A>, or <A HREF="ce_func_6flg.htm"><B>MailNext</B></A>. </P>

<P>The <B>pwcHeaders</B> member of the <B>MailMsg</B> structure points to the message's header string. The header consists of entries made up of two fields: a name, and an associated value. The name fields are separated from the value fields by a NULL character, and the entries are separated from each other by a NULL character. The header string is terminated with two consecutive NULL characters.</P>

<P>If a matching name field is not found in the message store, the entry is added to the header. If the entry name is found, the value field is changed to the new value passed in. If the value field being passed in is NULL and the entry name exists in the header, the entry is deleted.</P>

<P>For more information, see <A HREF="mail_5ha0.htm"><B>Inbox</B></A>.</P>

<H4>See Also</H4>

<P><A HREF="ce_func_6i90.htm"><B>MailGetField</B></A>,<B> <A HREF="JavaScript:hhobj_2.Click()">MailMsg</A></B></P>

</BODY>
</HTML>
