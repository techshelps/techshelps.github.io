<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Load</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H1>

<A NAME="_load"></A>Load</H1>

<P>The <B>Load</B> function is the main entry point to download an application from the desktop PC to the target device.</P>

<H4>Syntax</H4>

<P><B>LOADERROR Load(HWND </B><I>hwndParent</I><B>, LPSTR</B><I>lpszCmdLine<B>)</B></I><B>;</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Ppcload.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Windows CE versions:</TD>
<TD width=67%>1.0 and 1.01</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>hwndParent</I></DT>

<DD>Handle to the parent window; used for displaying the progress bar.</DD>

<DT><I>lpszCmdLine</I></DT>

<DD>Pointer to the buffer containing the command-line string of arguments to be parsed:

<P><I>cpu_type  application_name  install_directory  total_bytes_to_copy<BR>
&nbsp;&nbsp;&nbsp;&nbsp;  user_name  user_company  load_file</I>


<P>The command-line arguments must be separated from one another by a space character. All of the items except <I>total_bytes_to_copy</I> should be enclosed by double quote (") characters. Following is a description of the <I>lpszCmdLine</I> command-line parameters:


<DL>
<DT><I>cpu_type</I></DT>

<DD>Type of CPU on the target platform device. This information can be obtained by calling the <A HREF="ce_func_619h.htm"><B>Load_PegCpuType</B></A> function. </DD>

<DT><I>application_name</I></DT>

<DD>Unique name for the application. This information is used to create a key in the Windows CE registry for storing information about the application.</DD>

<DT><I>install_directory</I></DT>

<DD>Directory on the target platform device where the application will be stored. Directory names must begin with a backslash (\).</DD>

<DT><I>total_bytes_to_copy</I></DT>

<DD>Total number of bytes to be copied to the device. The application installer uses this number to set the range of the progress bar displayed during the load process.</DD>

<DT><I>user_name</I></DT>

<DD>Name of the person using the device. Currently, this parameter is unused and should be an empty string, ("").</DD>

<DT><I>user_company</I></DT>

<DD>Name of the organization where the person using the device works. Currently, this parameter is unused and should be an empty string, ("").</DD>

<DT><I>load_file</I></DT>

<DD>Path and name of the file on the desktop PC containing the list of application installation statements to be executed during the load procedure. This file must be of the form "<I>application_name</I>.load".
</DD>
</DL>
</DD>
</DL>

<H4>Return Values</H4>

<P>This function returns one of the following error values:

<DL>
<DT>LOAD_ALREADY_LOADING</DT>

<DD>A previous call to the <B>Load</B> function has not yet completed.</DD>

<DT>LOAD_SUCCESS</DT>

<DD>Load process completed successfully.</DD>

<DT>LOAD_OUTOFSTORAGE</DT>

<DD>Out of memory on the device.</DD>

<DT>LOAD_CANCELLEDBYUSER</DT>

<DD>Load canceled by the user.</DD>

<DT>LOAD_INVALID_PARAMETER</DT>

<DD>Invalid command line parameter.</DD>

<DT>LOAD_FAILED</DT>

<DD>Generic load failure.</DD>

<DT>LOAD_FAILEDCANTCLEANUP</DT>

<DD>Load failure; clean-up cannot be performed on the device.</DD>

<DT>LOAD_DISCONNECTED</DT>

<DD>Communications disconnected.</DD>

<DT>LOAD_CANT_CREATE_DIR</DT>

<DD>Cannot create the destination directory.</DD>

<DT>LOAD_REG_ERROR</DT>

<DD>Cannot create the registry entry.</DD>

<DT>LOAD_ERROR</DT>

<DD>Unknown error.
</DD>
</DL>

<H4>Remarks</H4>

<P>The <B>Load</B> function requires a prior successful call to the <A HREF="ce_func_2xtg.htm"><B>Load_Init</B></A> function.</P>

<P><B>Load</B> is exported by Ppcload.dll, which runs on the desktop PC—it is intended to be called from a setup program.</P>

<P>The file name specified by the <I>application_name</I> parameter must match the file name specified by the <I>load_file</I> parameter. For example, if <I>application_name</I> is "MyFile" the file specified by <I>load_file</I> should be "MyFile.load".</P>

<P>This function is not supported on Windows CE version 2.0. For more information on installing applications for version 2.0, see Installing Applications.</P>

<H4>See Also</H4>

<P><A HREF="ce_func_2xtg.htm"><B>Load_Init</B></A>,<B> <A HREF="ce_func_1cc4.htm">Load_Exit</A></B></P>

</BODY>
</HTML>
