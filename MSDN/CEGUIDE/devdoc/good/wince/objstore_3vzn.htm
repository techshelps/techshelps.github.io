<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enumerating Databases</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeFindFirstDatabase">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeFindNextDatabase">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeFindFirstDatabase">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeFindFirstDatabase">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeFindNextDatabase">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeFindNextDatabase">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_GetLastError">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_CloseHandle">
</OBJECT>
</TD></TR></TABLE>



<H2>

<A NAME="_enumerating_databases"></A>Enumerating Databases</H2>

<P>Enumerating databases is the process of sequentially accessing each database in a group. The group can either include all databases in the object store or only those of a specified type. Enumeration can be used when a change needs to be made to all databases of a certain type, or when synchronizing data between the desktop computer and the Windows CE-based device. </P>

<P>To enumerate databases, call the <A HREF="JavaScript:hhobj_1.Click()"><B>CeFindFirstDatabase</B></A> and <A HREF="JavaScript:hhobj_2.Click()"><B>CeFindNextDatabase</B></A> functions.</P>

<P><A HREF="JavaScript:hhobj_3.Click()"><B>CeFindFirstDatabase</B></A> establishes and returns a handle to the enumeration context for the type identifier specified. If the type identifier was zero, the context will include all the databases. Note that <A HREF="JavaScript:hhobj_4.Click()"><B>CeFindFirstDatabase</B></A> does not give the object identifier for the first database. Use the handle to the enumeration context to call <A HREF="JavaScript:hhobj_5.Click()"><B>CeFindNextDatabase</B></A> repeatedly to obtain the object identifiers for each database in turn. When there are no more databases of that type, <A HREF="JavaScript:hhobj_6.Click()"><B>CeFindNextDatabase</B></A> returns the value zero. To ensure that there was no problem with the enumeration, call <A HREF="JavaScript:hhobj_7.Click()"><B>GetLastError</B></A> and check for the ERROR_NO_MORE_ITEMS value.</P>

<P>When the application is finished enumerating databases, it must close the handle to the enumeration context by using the <A HREF="JavaScript:hhobj_8.Click()"><B>CloseHandle</B></A> function.</P>

<P>The following code example enumerates all databases in the object store and adds their names to a combo box.</P>

<PRE><CODE>HANDLE hEnumDB;         // handle to a database enumerator
TCHAR szBuf[MAX_BUF];   // tmp string for combobox or message box
HWND hCB1;              // combo box; value set by calling GetDlgItem 
...
hEnumDB = CeFindFirstDatabase(0);
if (INVALID_HANDLE_VALUE == hEnumDB) 
{
                        // error handling omitted...uses GetLastError()
    return;             // continue only if FindFirst succeeds
}
while( (WceObjID = CeFindNextDatabase(hEnumDB)) != 0) 
{
   if (!CeOidGetInfo(WceObjID, &amp;WceObjInfo) ) 
   {
      CloseHandle(hEnumDB);
                        // error handling omitted...uses GetLastError()
      return;           // continue only if FindNext succeeds
   }
   else 
   {
      wsprintf(szBuf, WceObjInfo.infDatabase.szDbaseName);
      SendMessage(hCB1, CB_ADDSTRING, 0, LPARAM(szBuf));
   }
}
CloseHandle(hEnumDB);
</CODE></PRE>

</BODY>
</HTML>
