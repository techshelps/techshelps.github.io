<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CeSeekDatabase</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_the_fsdbase_component">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_cepropval">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_getlasterror">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sortorderspec">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_cepropval">
</OBJECT>
</TD></TR></TABLE>



<H1>

<A NAME="_ceseekdatabase"></A>CeSeekDatabase </H1>

<P>The <B>CeSeekDatabase</B> function seeks the specified record in an open database. A RAPI version of this function exists and is also called <B>CeSeekDatabase</B>. </P>

<H4>Syntax</H4>

<P><B>CEOID</B> <B>CeSeekDatabase(HANDLE</B> <I>hDatabase</I><B>, DWORD</B> <I>dwSeekType</I><B>, DWORD</B> <I>dwValue</I><B>, LPDWORD</B> <I>lpdwIndex<B>)</B></I><B>;</B> </P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Winbase.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Component:</TD>
<TD width=67%><A HREF="JavaScript:hhobj_1.Click()">fsdbase</A></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Windows CE versions:</TD>
<TD width=67%>1.01 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>hDatabase</I> </DT>

<DD>Handle to the open database in which to seek. </DD>

<DT><I>dwSeekType</I> </DT>

<DD>Type of seek operation to perform. This parameter can be one of the following values:

<DL>
<DT>CEDB_SEEK_CEOID</DT>

<DD>Seek until finding an object that has the given object identifier. The <I>dwValue</I> parameter specifies the object identifier. This type of seek operation is very efficient.</DD>

<DT>CEDB_SEEK_VALUESMALLER</DT>

<DD>Seek until finding the largest value that is smaller than the given value. If none of the records has a smaller value, the seek pointer is left at the end of the database and the function returns zero. The <I>dwValue</I> parameter is a pointer to a <A HREF="JavaScript:hhobj_2.Click()"><B>CEPROPVAL</B></A> structure.</DD>

<DT>CEDB_SEEK_VALUEFIRSTEQUAL</DT>

<DD>Seek until finding the first value that is equal to the given value. If the seek operation fails, the seek pointer is left pointing at the end of the database, and the function returns zero. The <I>dwValue</I> parameter is a pointer to a <B>CEPROPVAL</B> structure.</DD>

<DT>CEDB_SEEK_VALUENEXTEQUAL</DT>

<DD>Starting from the current seek position, seek exactly one position forward in the sorted order and check if the next record is equal in value to the given value. If so, return the object identifier of this next record; otherwise, return zero and leave the seek pointer at the end of the database. This operation can be used in conjunction with the CEDB_SEEK_VALUEFIRSTEQUAL operation to enumerate all records with an equal value. The <I>dwValue</I> parameter specifies the value for which to seek. </DD>

<DT>CEDB_SEEK_VALUEGREATER</DT>

<DD>Seek until finding a value greater than or equal to the given value. If all records are smaller, the seek pointer is left at the end of the database and the function returns zero. The <I>dwValue</I> parameter is a pointer to a <B>CEPROPVAL</B> structure. </DD>

<DT>CEDB_SEEK_BEGINNING</DT>

<DD>Seek until finding the record at the given position from the beginning of the database. The <I>dwValue</I> parameter specifies the number of records to seek. </DD>

<DT>CEDB_SEEK_CURRENT</DT>

<DD>Seek backward or forward from the current position of the seek pointer for the given number of records. The <I>dwValue</I> parameter specifies the number of records from the current position. The function seeks forward if <I>dwValue</I> is a positive value, or backward if it is negative. A forward seek operation is efficient.</DD>

<DT>CEDB_SEEK_END</DT>

<DD>Seek backward for the given number of records from the end of the database. The <I>dwValue</I> parameter specifies the number of records. </DD>
</DL>
</DD>

<DT><I>dwValue</I> </DT>

<DD>Value to use for the seek operation. The meaning of this parameter depends on the value of <I>dwSeekType</I>. </DD>

<DT><I>lpdwIndex</I> </DT>

<DD>Pointer to a variable that receives the index from the start of the database to the beginning of the record that was found. 
</DD>
</DL>

<H4>Return Values</H4>

<P>If the function succeeds, the return value is the object identifier of the record on which the seek ends. If the function fails, the return value is zero. To get extended error information when within a CE program call <A HREF="JavaScript:hhobj_3.Click()"><B>GetLastError</B></A>. If within a RAPI program, call <A HREF="ce_func_7lpu.htm"><B>CeGetLastError</B></A>. <B>GetLastError </B>and <B>CeGetLastError</B> may return ERROR_INVALID_PARAMETER if a parameter is invalid. </P>

<H4>Remarks</H4>

<P>The <B>CeSeekDatabase</B> function always uses the current sort order as specified in the call to the <A HREF="ce_func_5wyt.htm"><B>CeOpenDatabase</B></A> function. If the CEDB_AUTOINCREMENT flag was specified, an automatic seek of one from the current position is done with each read operation that occurs on the database. </P>

<P>Note that a seek can only be performed on a sorted property value. After creating a database (using <B>CeCreateDatabase</B>) and opening the database (using <B>CeOpenDatabase</B>), subsequent calls to <B>CeSeekDatabase</B> assume the sort order that was specified in the <I>propid</I> parameter of the call to <B>CeOpenDatabase</B>. Although property identifiers can be modified using <A HREF="ce_func_8uwj.htm"><B>CeWriteRecordProps</B></A>, it is best to use the same property identifier for <B>CeOpenDatabase</B> that was used for the <B>propid</B> member of the <A HREF="JavaScript:hhobj_4.Click()"><B>SORTORDERSPEC</B></A> structure that was passed in the call to <A HREF="ce_func_2lnp.htm"><B>CeCreateDatabase</B></A>.</P>

<P>To enter negative values for the CEDB_SEEK_CURRENT case, cast a signed long. This changes the effective range on the record indexes to 31 bits from 32.</P>

<P>Multiple sort orders cannot be specified for a single property.</P>

<P>For more information, see <A HREF="objstore_9zqd.htm">Accessing Persistent Storage</A>.</P>

<P>When writing applications for Windows CE version 1.0, use the <B>PegSeekDatabase</B> function.</P>

<H4>See Also</H4>

<P><A HREF="ce_func_2lnp.htm"><B>CeCreateDatabase</B></A>, <A HREF="ce_func_5wyt.htm"><B>CeOpenDatabase</B></A>, <A HREF="JavaScript:hhobj_5.Click()"><B>CEPROPVAL</B></A></P>

</BODY>
</HTML>
