<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IReplStore::ReportStatus</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H1>

<A NAME="_ireplstore_reportstatus"></A>IReplStore::ReportStatus</H1>

<P>ActiveSync service manager calls Report Status to get information on the status of the synchronization. See the definition of <I>uStatus</I> for available status codes. This is an API exported by the store.dll for the synchronization engine.</P>

<H4>Syntax</H4>

<P><B>HRESULT ReportStatus(<BR>
HREPLFLD </B><I>hFolder</I><B>,<BR>
HREPLITEM </B><I>hItem</I><B>,<BR>
UINT </B><I>uStatus</I><B>,<BR>
UINT </B><I>uParam</I><B><BR>
);</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Cesync.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Windows CE versions:</TD>
<TD width=67%>2.0 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>hFolder</I></DT>

<DD>Handle to the folder this status applies to. This parameter is NULL if status applies to all folders.</DD>

<DT><I>hItem</I></DT>

<DD>Handle to the object this status applies to. This parameter is NULL if status applies to all objects.</DD>

<DT><I>uStatus</I></DT>

<DD>Status code. Can be one of the following:

<DL>
<DT>RSC_BEGIN_SYNC</DT>

<DD>Synchronization is about to start; <I>uReserved</I> is a combination of bit flags:

<P>BSF_AUTO_SYNC  synchronization is started as a result of changes while "autosync on change" is turned on.


<P>BSF_REMOTE_SYNC  consistent with RSC_REMOTE_SYNC, set if synchronization is done remotely.
</DD>

<DT>RSC_END_SYNC</DT>

<DD>Synchronization has ended.</DD>

<DT>RSC_BEGIN_CHECK</DT>

<DD>The ActiveSync service manager is about to call <B>FindFirstItem</B> and <B>FindNextItem</B>.</DD>

<DT>RSC_END_CHECK</DT>

<DD>The ActiveSync service manager has completed all enumeration calls (<B>FindItemClose</B> has been called).</DD>

<DT>RSC_DATE_CHANGED</DT>

<DD>The user has changed the system date. This code is called on every existing object in the store to give the ActiveSync service provider a chance to reset the synchronization options that depend on date. For example, if an ActiveSync service provider wants to synchronize files that are modified in the last two weeks, it can respond to this code to reset the enable bit for each item such that when <B>IsItemReplicated</B> is called later, it will re-evaluate based on the new date.</DD>

<DT>RSC_RELEASE</DT>

<DD>The ActiveSync service manager is about to release the <B>IReplStore</B> object. This is called before the final <B>IReplStore::Release</B> call.</DD>

<DT>RSC_REMOTE_SYNC</DT>

<DD>If <I>uParam</I> is TRUE, the ActiveSync service manager is about to start remote synchronization. The ActiveSync service provider should not show any UI that requires user interaction from now on until this status code is used again with <I>uParam</I> equal to FALSE.</DD>

<DT>RSC_INTERRUPT</DT>

<DD>ActiveSync service manager is about to interrupt the current operation.

<P>these values of <I>uParam</I> are defined only for RSC_INTERRUPT:


<P>PSA_RESET_INTERRUPT


<P>This flag is set if the interrupt state is being cleared (that is, normal operation is resuming).


<P>PSA_SYS_SHUTDOWN


<P>User has shut down Windows operating system
</DD>

<DT>RSC_BEGIN_SYNC_OBJ</DT>

<DD>Synchronization is about to start on an object type. <I>uReserved</I> is a combination of bit flags (see RSC_BEGIN_SYNC).</DD>

<DT>RSC_END_SYNC_OBJ</DT>

<DD>Synchronization is about to end on an object type.</DD>

<DT>RSC_OBJ_TYPE_ENABLED</DT>

<DD>Synchronization of the given object is enabled; hFolder is indeed a pointer to a string (object type name)</DD>

<DT>RSC_OBJ_TYPE_DISABLED</DT>

<DD>Synchronization of the given object is disabled; hFolder is indeed a pointer to a string (object type name)</DD>

<DT>RSC_BEGIN_BATCH_WRITE</DT>

<DD>A series of SetPackets will be called on a number of objects. This is the time for ActiveSync service provider to start a transaction.</DD>

<DT>RSC_END_BATCH_WRITE</DT>

<DD>RSC_BEGIN_BATCH_WRITE has ended. This is the time for the ActiveSync service provider to commit the transaction.</DD>

<DT>RSC_CONNECTION_CHG</DT>

<DD>The connection status has changed. <I>uParam</I> is TRUE if a connection has been established, otherwise it is FALSE.</DD>

<DT>RSC_WRITE_OBJ_FAILED</DT>

<DD>There was a failure while writing to an object on the device. <I>uParam</I> is the HRESULT code.</DD>

<DT>RSC_DELETE_OBJ_FAILED</DT>

<DD>There was a failture while deleting an object on the device. <I>uParam</I> is the HRESULT code.</DD>
</DL>
</DD>

<DT><I>uParam</I></DT>

<DD>Additional information about the status, based on <I>uStatus</I> code. 
</DD>
</DL>

<H4>Return Values</H4>

<DL>
<DT>NOERROR</DT>

<DD>the process indicated by <I>uStatus</I> is successful.</DD>

<DT>E_FAIL</DT>

<DD>the process indicated by <I>uStatus</I> has failed or encountered problems.
</DD>
</DL>

<H4>Remarks</H4>

<P>The ActiveSync service provider can simply return NOERROR for all cases if it is not interested.</P>

<H4>See Also</H4>

<P><A HREF="ce_int_963y.htm"><B>IReplStore</B></A></P>

</BODY>
</HTML>
