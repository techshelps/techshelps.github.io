<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MailFirst</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mailmsg">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mailmsg">
</OBJECT>
</TD></TR></TABLE>



<H1>

<A NAME="_mailfirst"></A>MailFirst</H1>

<P>The <B>MailFirst </B>function retrieves the first of a specified type of message from a folder in the message store.</P>

<H4>Syntax</H4>

<P><B>BOOL</B> <B>MailFirst</B> (<B>HANDLE</B> <I>hMail</I>, <B>MailMsg* </B><I>pmm</I><B>);</B></P>

<H4>At a Glance</H4>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%>Header file:</TD>
<TD width=67%>Msgstore.h</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Platforms:</TD>
<TD width=67%>H/PC</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Versions:</TD>
<TD width=67%>1.0 and later</TD>
</TR>
</TABLE><BR>

<H4>Parameters</H4>

<DL>
<DT><I>hMail</I></DT>

<DD>Handle to the mail context. This handle is created by the <A HREF="ce_func_2zou.htm"><B>MailOpen</B></A><B> </B>function.</DD>

<DT><I>pmm</I></DT>

<DD>Pointer to the <A HREF="JavaScript:hhobj_1.Click()"><B>MailMsg</B></A> structure that contains the flags determining which folder the message is in, what type of message it is, and how much of the message to retrieve. The mail flag value in the <B>dwFlags</B> member of the structure is a combination of folder, status, and message flags. The folder flag determines which folder the entry will be retrieved from. One folder flag can be combined with any number of status flags and message flags. The status flags determine what type of message to retrieve and the message flags determine how much of the message is returned.

<P>When <B>MailFirst</B> returns, this structure contains the message retrieved from the message store. Two of the message flags determine how much of the message to retrieve. If MAIL_GET_FLAGS is set, only the flags and the object identifier are returned. Using this option does not require any memory to be allocated for the message. If the MAIL_GET_BODY flag is set, the entire message is loaded into memory. This requires the system to allocate memory from the global heap. If neither of these flags is set, all of the message except the body is retrieved. Memory for this option is allocated from the private heap. To free memory allocated by this function, use the <A HREF="ce_func_2lk5.htm"><B>MailFree</B></A> function.
</DD>
</DL>

<H4>Return Values</H4>

<P>This function returns TRUE if successful; FALSE if it fails. To get extended error information, use <A HREF="ce_func_7w36.htm"><B>MailError</B></A> or <A HREF="ce_func_557r.htm"><B>MailErrorMsg</B></A>.</P>

<H4>Remarks</H4>

<P>The <B>MailFirst</B> function obtains the information and fills a <B>MailMsg</B> structure variable with the values retrieved from the message store. Changing the values in <B>MailMsg</B> does not affect the message store until it is reinserted by a call to the <B>MailUpdate</B> function.</P>

<P>For more information, see <A HREF="mail_5ha0.htm"><B>Inbox</B></A>.</P>

<H4>See Also</H4>

<P><A HREF="ce_func_2lk5.htm"><B>MailFree</B></A>, <A HREF="ce_func_03zo.htm"><B>MailGet</B></A>, <A HREF="ce_func_6flg.htm"><B>MailNext</B></A>, <A HREF="ce_func_06w5.htm"><B>MailUpdate</B></A>, <A HREF="JavaScript:hhobj_2.Click()"><B>MailMsg</B></A></P>

</BODY>
</HTML>
