<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Built-In Infrared Serial Port</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_EscapeCommFunction">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_CreateFile">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_EscapeCommFunction">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_DCB_str">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_GetCommState">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_SetCommState">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_SetCommTimeouts">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_ReadFile">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_WriteFile">
</OBJECT>
</TD></TR></TABLE>



<H3>

<A NAME="_using_the_built_in_infrared_serial_port"></A>Using the Built-In Infrared Serial Port</H3>

<P>The H/PC IR port supports point-to-point serial connections with any IrDA-compliant device. IR links are an ideal method for exchanging data between two H/PCs. You can establish connections between two IrDA-compliant devices whose ports are aligned within 15 degrees of each other. They must also be no more than three feet apart. IrDA specifications provide for serial IR links operating at speeds up to 115.2 KBps.</P>

<P>Some manufacturers supply only one universal asynchronous receiver transmitter (UART) to control the built-in serial port and the IR port. To access the IR port on H/PCs with a shared UART, you must redirect communications by using the <A HREF="JavaScript:hhobj_1.Click()"><B>EscapeCommFunction</B></A>. </P>

<H5><IMG SRC="../../images/wedge.gif" ALT="" BORDER=0>&nbsp;&nbsp;&nbsp;&nbsp;To open and use the IR port on H/PCs with one UART for both ports</H5>

<OL>
	<LI>Call <A HREF="JavaScript:hhobj_2.Click()"><B>CreateFile</B></A> to open the built-in, nine-pin serial port, usually "COM1:."</LI>

	<LI>Call <A HREF="JavaScript:hhobj_3.Click()"><B>EscapeCommFunction</B></A><B> </B>with the handle obtained from <B>CreateFile</B> as the <I>hFile</I> parameter, and SETIR as the <I>dwFunc</I> parameter. 
<P>The SETIR flag indicates the serial port is to be set to IR mode. <B>EscapeCommFunction</B> will return TRUE if an IR capable port has been selected.
</LI>

	<LI>Fill the device control block structure <A HREF="JavaScript:hhobj_4.Click()"><B>DCB</B></A> with the existing communication port settings by calling the <A HREF="JavaScript:hhobj_5.Click()"><B>GetCommState</B></A><B> </B>function.</LI>

	<LI>Configure the communication port by assigning values to the members of the <B>DCB</B> and calling the <A HREF="JavaScript:hhobj_6.Click()"><B>SetCommState</B></A> function.</LI>

	<LI>Set the timeout values for read/write operations on the port with a call to the <A HREF="JavaScript:hhobj_7.Click()"><B>SetCommTimeouts</B></A> function.</LI>

	<LI>Perform <A HREF="JavaScript:hhobj_8.Click()"><B>ReadFile</B></A> and <A HREF="JavaScript:hhobj_9.Click()"><B>WriteFile</B></A> operations on the device handle returned from <B>CreateFile</B>.</LI>
</OL>

<P>Windows CE supports Windows Sockets (Winsock) and the IR extensions to Winsock (IrSock) for developing communications applications for the H/PC. </P>

</BODY>
</HTML>
