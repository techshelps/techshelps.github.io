<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with Database Records</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeWriteRecordProps">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CEPROPVAL">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeWriteRecordProps">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CEVALUNION">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeWriteRecordProps">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeDeleteRecord">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CEPROPVAL">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_CeWriteRecordProps">
</OBJECT>
</TD></TR></TABLE>



<H2>

<A NAME="_working_with_database_records"></A>Working with Database Records</H2>

<P>You use several functions to work with database records. These functions allow you to create, modify, and delete records and their properties.</P>

<P>You can create new records or modify existing records using the <A HREF="JavaScript:hhobj_1.Click()"><B>CeWriteRecordProps</B></A> function. The function parameters include the handle to the database and the object identifier of the record to add. If the object identifier is zero, <B>CeWriteRecordProps</B> creates a new record. </P>

<P>To write properties to a record, fill an array of <A HREF="JavaScript:hhobj_2.Click()"><B>CEPROPVAL</B></A> structures and pass the address of the array to <A HREF="JavaScript:hhobj_3.Click()"><B>CeWriteRecordProps</B></A> along with the database handle and the record's object identifier. Each structure contains a property identifier and the data value for that property. To specify the data value, fill the <B>val</B> member, which is defined as a <A HREF="JavaScript:hhobj_4.Click()"><B>CEVALUNION</B></A> union. The <B>CEPROPVAL</B> structure also includes a flag member that you can set to CEDB_PROPDELETE in order to delete the specified property or properties. If the <A HREF="JavaScript:hhobj_5.Click()"><B>CeWriteRecordProps</B></A> function succeeds, the object identifier of the new or modified record is returned. </P>

<P>Use the <A HREF="JavaScript:hhobj_6.Click()"><B>CeDeleteRecord</B></A> function to delete a record from a database, supplying the object identifier of the record and the handle to the open database that contains the record. </P>

<P>The following code example creates and writes a new property that is a byte array, or BLOB.</P>

<PRE><CODE>CEPROPVAL NewProp;       // the new property contains a BLOB
CEBLOB blob;             // the BLOB contains a byte array
BYTE * pBuf = NULL;      // the actual BLOB data
UINT cbBuf;              // count of bytes needed in BLOB
...
                         // figure out the size needed, then allocate it
pBuf = (BYTE *) LocalAlloc(LMEM_FIXED, cbBuf); 
                         // put the actual data into pBuf here...

                         // now set up to write the new BLOB property
NewProp.propid = CEVT_BLOB;
NewProp.wFlags = 0;    
blob.dwCount = cbBuf;    // count of bytes in the buffer
blob.lpb = pBuf;         // set CEBLOB field to point to buffer
NewProp.val.blob = blob; // BLOB itself points to the buffer
oid = CeWriteRecordProps(hDb,
   0,                    // new record
   1,                    // one property
   &amp;NewProp);            // pointer to the BLOB property
                         // perform error handling by checking oid... 
</CODE></PRE>

<P>Write a record into a database by filling an array of <A HREF="JavaScript:hhobj_7.Click()"><B>CEPROPVAL</B></A> structures and passing the array to the <A HREF="JavaScript:hhobj_8.Click()"><B>CeWriteRecordProps</B></A> function, along with an open handle to the database in which to add the record. The following code example shows how to add a record to a database. </P>

<PRE><CODE>// SetAddressData - Adds a name and address to an address database in 
//    the object store.
// Returns the object identifier of the record in which the name and 
//    address are written.
// pAddressData - Pointer to a structure that contains the name and
//    address to add

// Global variable:
//    g_hAddressDatabase - Open handle to the address database

CEOID SetAddressData(PADDRESSDATA pAddressData)
{
   CEPROPVAL rgPropVal[ADDRESS_PROP_COUNT];
   WORD wCurrent = 0;

// Use a C runtime function to zero-fill the array of property 
// values.   
   memset(&amp;rgPropVal, 0, sizeof(CEPROPVAL) * ADDRESS_PROP_COUNT);

   rgPropVal[wCurrent].propid = HHPR_NAME;
   rgPropVal[wCurrent++].val.lpwstr = pAddressData-&gt;pwszName;

   rgPropVal[wCurrent].propid = HHPR_STREET;
   rgPropVal[wCurrent++].val.lpwstr = pAddressData-&gt;pwszStreet;

   rgPropVal[wCurrent].propid = HHPR_CITY;
   rgPropVal[wCurrent++].val.lpwstr = pAddressData-&gt;pwszCity;

   rgPropVal[wCurrent].propid = HHPR_STATE;
   rgPropVal[wCurrent++].val.lpwstr = pAddressData-&gt;pwszState;

   rgPropVal[wCurrent].propid = HHPR_ZIP_CODE;
   rgPropVal[wCurrent++].val.ulVal = pAddressData-&gt;dwZip;

   oid = CeWriteRecordProps(g_hAddressDatabase, 0, wCurrent, 
      rgPropVal);
    
   return oid;
}
</CODE></PRE>

</BODY>
</HTML>
