<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Message Flags</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MailFirst">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MailNext">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MailGet">
</OBJECT>
</TD></TR></TABLE>



<H3>

<A NAME="_using_message_flags"></A>Using Message Flags</H3>

<P>Message flags provide you with many options to manipulate mail messages. In fact, you do not write code to perform the low-level operations. You simply set appropriate flags and the system takes care of the rest. For example, if you want to retrieve a message from the <B>Inbox</B> folder only, you set the <B>dwFlags</B> member of the <B>MailMsg</B> structure to MAIL_FOLDER_INBOX before you call <B>MailFirst</B>.</P>

<P>You can use other message flags to enhance the performance of your application. You use MAIL_GET_BODY and MAIL_GET_FLAGS to determine how much of the message is to be read into memory. If you set MAIL_GET_BODY, the entire message is read into memory. Otherwise, everything except the message body is read into memory. In either case, the system allocates memory from the local heap. A handle to the heap is passed back through the <B>hHeap</B> member of the <B>MailMsg </B>structure.</P>

<P>To get minimal information about the messages, without allocating memory, you set <B>dwFlags </B>to MAIL_GET_FLAGS. MAIL_GET_FLAGS instructs the system to read only the <B>dwFlags </B>member of the <B>MailMsg</B> structure. For example, you can build an array of pointers to unopened messages stored in the Inbox folder.</P>

<H5><IMG SRC="../../images/wedge.gif" ALT="" BORDER=0>&nbsp;&nbsp;&nbsp;&nbsp;To build an array of pointers to unopened messages stored in the Inbox folder</H5>

<OL>
	<LI>Call <A HREF="JavaScript:hhobj_1.Click()"><B>MailFirst</B></A> to get the flags and object identifier of the first unopened message in the Inbox.</LI>

	<LI>Store the identifier number and any other desired information.</LI>

	<LI>Reset the flags to specify the same folder and type of message.</LI>

	<LI>Call <A HREF="JavaScript:hhobj_2.Click()"><B>MailNext</B></A> with the MAIL_GET_FLAGS flag set to retrieve the flags and object identifier of the next message.</LI>

	<LI>Save the information.</LI>

	<LI>Repeat steps 3, 4, and 5 until you have handled all of the messages in the Inbox.</LI>
</OL>

<P>To retrieve a particular message body, you can pass the object identifier to <A HREF="JavaScript:hhobj_3.Click()"><B>MailGet</B></A>.</P>

</BODY>
</HTML>
