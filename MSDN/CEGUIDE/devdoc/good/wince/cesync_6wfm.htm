<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registry Settings for a Desktop Computer</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_IReplStore_IUnknown">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_IReplObjHandler_IUnknown">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_IReplStore_IUnknown">
</OBJECT>
</TD></TR></TABLE>



<H3>

<A NAME="_registry_settings_for_a_desktop_computer"></A>Registry Settings for a Desktop Computer</H3>

<P>On the desktop computer, you must register the object type to be synchronized and you must also register ActiveSync as an in-process server. For object-type registration, you must enter values under <B>HKEY_LOCAL_MACHINES\Software\Microsoft\Windows CE Services\Services\Synchronization\Objects</B>. The keys under <B>Objects</B> are the object types to be synchronized. For each object type, you must define five values: <I>Default, Display Name, Plural Name, Store, </I>and<I> Disabled.</I> </P>

<P>The <I>Default</I> value can be anything; it is usually a description of the object type. The <I>Display Name </I>and<I> Plural Name</I> are<I> </I>names for the object, for example, "Appointment" and "Appointments." The <I>Store</I> value is the OLE programmatic identifier, ProgID, of the store that implements the <A HREF="JavaScript:hhobj_1.Click()"><B>IReplStore</B></A> and <A HREF="JavaScript:hhobj_2.Click()"><B>IReplObjHandler</B></A><B> </B>interfaces. The <I>Disabled</I> value indicates whether the service is shown as disabled or enabled in Windows CE Services. A non-zero value indicates the service is disabled. </P>

<P>Using Schedule+ synchronization as an example, the desktop component is Scdstore.dll. This DLL synchronizes data for five different object types: Appointment, Contact, File, Inbox, and Task. A 32-bit OLE in-process server implements <B>IReplStore</B> and various <B>IReplObjHandler</B> interfaces, one for each object type. The following screen shot illustrates the desktop registry location for synchronization objects.</P>

<P>&nbsp;&nbsp;&nbsp;&nbsp;<IMG SRC="syncdoc1.gif" ALT="" BORDER=0></P>

<P>&nbsp;&nbsp;&nbsp;&nbsp;<IMG SRC="syncdoc2.gif" ALT="" BORDER=0></P>

<P><B>Desktop registry structure</B></P>

<P>You must register ActiveSync for OLE to recognize it as a valid in-process server. To do this, you must register the ProgID, the Class ID, and the GUID under <B>HKEY_CLASSES_ROOT</B>. Register the ProgID under <B>HKEY_CLASSES_ROOT\&lt;ProgID&gt;\Clsid</B>, where the <I>Default</I> value of the <B>Clsid</B> key is the GUID for the store; in this case, it is {a417bc10-7be1-11ce-ad82-00aa006ec559}.</P>

<P>To specify the location of the OLE in-process server, use the following keys: <B>HKEY_CLASSES_ROOT\Clsid\&lt;Class ID&gt;\InProcServer32</B> and <B>HKEY_CLASSES_ROOT\Clsid\&lt;Class ID&gt;\ProgID</B>. The <I>Default</I> value of the <B>InprocServer32</B> key is the full path of the 32-bit DLL that implements the <A HREF="JavaScript:hhobj_3.Click()"><B>IReplStore</B></A> interface. In the Schedule+ example, this is the path to Scdstore.dll. The <I>Default<B> </B></I>value of <B>ProgID</B> key is the ProgID of the store. In this example, it is <B>MS.WinCE.Outlook</B>. For more information on registration, see the OLE documentation in the Microsoft Platform SDK.</P>

<P>For another example of the required desktop registry keys, see the Stockpor program in the SDK.<B> </B> </P>

</BODY>
</HTML>
