<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tree View Item States</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_TVM_GETITEM">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_TVM_SETITEM">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_TreeView_GetItem">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_TreeView_SetItem">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TV_ITEM_str">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TVN_ITEMEXPANDING">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TVN_ITEMEXPANDED">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TV_ITEM_str">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_INDEXTOOVERLAYMASK">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_ImageList_SetOverlayImage">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TV_ITEM_str">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_INDEXTOSTATEIMAGEMASK">
</OBJECT>
</TD></TR></TABLE>



<H2>

<A NAME="_tree_view_item_states"></A>Tree View Item States</H2>

<P>Every tree view item has a current state that determines its appearance and functionality. You can retrieve and set this state by sending the <A HREF="JavaScript:hhobj_1.Click()">TVM_GETITEM</A> and <A HREF="JavaScript:hhobj_2.Click()">TVM_SETITEM</A> messages, or by using the <A HREF="JavaScript:hhobj_3.Click()"><B>TreeView_GetItem</B></A> and <A HREF="JavaScript:hhobj_4.Click()"><B>TreeView_SetItem</B></A> macros. You set or retrieve the item state by using the <B>state</B> member of the <A HREF="JavaScript:hhobj_5.Click()"><B>TV_ITEM</B></A> structure that you pass in the <I>pItem</I> parameter <I>(lParam</I>) to these messages and macros.</P>

<P>Windows CE supports the TVIS_EXPANDPARTIAL item state. This state indicates that a tree view item is partially expanded. This could happen if an error occurs during data retrieval and some of the child items cannot be retrieved from the data source. The tree view displays the items that were successfully retrieved, but continues to display the plus symbol next to the parent item as well. This indicates to the user that more information is available. When the user clicks the plus symbol again, the application repeats the query.</P>

<P>Item states supported by Windows CE are described in the following table. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TH align=left width=38%>State</TH>
<TH align=left width=62%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_BOLD </TD>
<TD width=62%>Windows CE uses a bold font to draw the item. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_CUT </TD>
<TD width=62%>Windows CE selects the item for cutting and pasting. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_DROPHILITED </TD>
<TD width=62%>Windows CE selects the item for dropping and dragging. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_EXPANDED </TD>
<TD width=62%>Windows CE expands the items list of child items so that the child items are visible. This state applies only to parent items. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_EXPANDEDONCE </TD>
<TD width=62%>Windows CE expands the the item's list of child items at least once. Windows CE does not send the <A HREF="JavaScript:hhobj_6.Click()">TVN_ITEMEXPANDING</A> and <A HREF="JavaScript:hhobj_7.Click()">TVN_ITEMEXPANDED</A> notifications for parent items that have specified this value. This value applies only to parent items. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_EXPANDPARTIAL</TD>
<TD width=62%>Windows CE partially expands the items. This could happen if an error occurs during data retrieval and some of the child items cannot be retrieved from the data source.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_FOCUSED </TD>
<TD width=62%>Windows CE gives the item the focus, and surrounds it with a standard focus rectangle. Although more than one item may be selected, only one item can have the focus. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_OVERLAYMASK </TD>
<TD width=62%>Windows CE includes the item's overlay image when it draws the image. The index of the overlay image must be specified in the <B>state</B> member of the <A HREF="JavaScript:hhobj_8.Click()"><B>TV_ITEM</B></A> structure by using the <A HREF="JavaScript:hhobj_9.Click()"><B>INDEXTOOVERLAYMASK</B></A> macro. The overlay image must be added to the tree view's image list by using the <A HREF="JavaScript:hhobj_10.Click()"><B>ImageList_SetOverlayImage</B></A> function. This value should not be combined with any other value. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_SELECTED </TD>
<TD width=62%>Windows CE selects the item. The appearance of a selected item depends on whether it has the focus and on whether the system colors are used for selection. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>TVIS_STATEIMAGEMASK </TD>
<TD width=62%>Windows CE includes the item's state image when it draws the item. The index of the state image must be specified in the <B>state</B> member of the <A HREF="JavaScript:hhobj_11.Click()"><B>TV_ITEM</B></A> structure by using the <A HREF="JavaScript:hhobj_12.Click()"><B>INDEXTOSTATEIMAGEMASK</B></A> macro. This value should not be combined with any other value. </TD>
</TR>
</TABLE><BR>

</BODY>
</HTML>
