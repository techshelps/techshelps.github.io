<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Custom Menus to Windows CE Explorer</TITLE>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H1>

<A NAME="_adding_custom_menus_to_windows_ce_explorer"></A>Adding Custom Menus to Windows CE Explorer</H1>

<P>Windows CE Services allows additional menu items to be added to the <B>Tools</B> menu in the Explorer window in two different ways. The method described in this section uses code to directly place values in the proper registry locations. You can also use the CEUTIL utility DLL to create custom menus and perform other tasks.</P>

<P>In order to add a custom menu, create a subkey and add several values under <B>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows CE Services\ CustomMenus</B> as follows:</P>

<PRE><CODE>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WINDOWS CE Services\CustomMenus]
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WINDOWS 
CE Services\CustomMenus\<I>subkey</I>]
"DisplayName"="<I>displayName</I>"
"Command"="<I>myApp.exe</I>"
"StatusHelp"="<I>StatusHelpText</I>"
"Version"=<I>version_number</I>
</CODE></PRE>

<DL>
<DT><I>subkey</I></DT>

<DD>String that identifies the subkey to be created under the <B>Tools</B> menu.</DD>

<DT><I>DisplayName</I></DT>

<DD>String that identifies the display name of the menu item. An ampersand (&amp;) specifies a hot key.</DD>

<DT><I>myApp.exe</I></DT>

<DD>String that identifies the command that will be executed by WinExec when a user chooses the menu item.</DD>

<DT><I>StatusHelpText</I></DT>

<DD>String that identifies the status and Help text that appears in the status bar when a user browses the menu item.</DD>

<DT><I>version_number</I></DT>

<DD>Application version. This value should be 0x00020000.
</DD>
</DL>

<P>The following sample registry file adds a calculator menu item.</P>

<PRE><CODE>REGEDIT4
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WINDOWS CE Services\CustomMenus]
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WINDOWS 
CE Services\CustomMenus\MyApp]
"DisplayName"="&amp;My Calculator"
"Command"="calc.exe"
"StatusHelp"="Brings up the calculator"
"Version"=dword:00020000
</CODE></PRE>

</BODY>
</HTML>
