<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 2: Set a WinEvent Hook</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_msaa_step_2_set_a_winevent_hook"></a>Step 2: Set a WinEvent Hook</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
After initializing the COM library, you must set a WinEvent hook by calling the <b>SetWinEventHook</b> function. The Babble application calls this function in its InitMSAA application-defined function. The following code illustrates how to call <b>SetWinEventHook</b>. </p>
<pre><code>BOOL InitMSAA(void) {
  // Set up an event hook.
  hEventHook = SetWinEventHook(EVENT_MIN,         // We want all events
                               EVENT_MAX,
                               GetModuleHandle(NULL),// Use this module
                               WinEventProc,
                               0,        // All processes
                               0,        // All threads
                               WINEVENT_OUTOFCONTEXT);
    // Did we install correctly? 
    if (hEventHook)
        return(TRUE);

    // Did not install properly - fail
    return(FALSE);
}
 </code></pre>
<p>
<b>Note</b>  InitMSAA specifies the <b>EVENT_MIN</b> and <b>EVENT_MAX</b> event constants. This causes Active Accessibility to notify the hook procedure for all possible events. Additionally, InitMSAA tests the returned hook identifier to determine if the hook was successfully installed. If the return value is non-NULL, then the call succeeded. </p>
<p>
For more information, see <i>WinEvents</i>. </p>
<p>&nbsp;</p></body>
</HTML>
