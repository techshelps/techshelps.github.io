<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Appendix B - Variant Types</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msaa_appendix_b_variant_types"></a>Appendix B - Variant Types</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Data Type </th>
<th align=left width=22%>Member </th>
<th align=left width=47%>VARTYPE </th>
</tr>
<tr valign=top>
<td width=31%>unsigned char </td>
<td width=22%>bVal </td>
<td width=47%>VT_UI1 </td>
</tr>
<tr valign=top>
<td width=31%>short </td>
<td width=22%>iVal </td>
<td width=47%>VT_I2 </td>
</tr>
<tr valign=top>
<td width=31%>long </td>
<td width=22%>lVal </td>
<td width=47%>VT_I4 </td>
</tr>
<tr valign=top>
<td width=31%>float </td>
<td width=22%>fltVal </td>
<td width=47%>VT_R4 </td>
</tr>
<tr valign=top>
<td width=31%>double </td>
<td width=22%>dblVal </td>
<td width=47%>VT_R8 </td>
</tr>
<tr valign=top>
<td width=31%>VARIANT_BOOL </td>
<td width=22%>bool </td>
<td width=47%>VT_BOOL </td>
</tr>
<tr valign=top>
<td width=31%>SCODE </td>
<td width=22%>scode </td>
<td width=47%>VT_ERROR </td>
</tr>
<tr valign=top>
<td width=31%>CY </td>
<td width=22%>cyVal </td>
<td width=47%>VT_CY </td>
</tr>
<tr valign=top>
<td width=31%>DATE </td>
<td width=22%>date </td>
<td width=47%>VT_DATE </td>
</tr>
<tr valign=top>
<td width=31%>BSTR </td>
<td width=22%>bstrVal </td>
<td width=47%>VT_BSTR </td>
</tr>
<tr valign=top>
<td width=31%>LPUNKNOWN </td>
<td width=22%>punkVal </td>
<td width=47%>VT_UNKNOWN </td>
</tr>
<tr valign=top>
<td width=31%>LPDISPATCH </td>
<td width=22%>pdispVal </td>
<td width=47%>VT_DISPATCH </td>
</tr>
<tr valign=top>
<td width=31%>SAFEARRAY * </td>
<td width=22%>parray </td>
<td width=47%>VT_ARRAY|* </td>
</tr>
<tr valign=top>
<td width=31%>unsigned char * </td>
<td width=22%>pbVal </td>
<td width=47%>VT_BYREF|VT_UI1 </td>
</tr>
<tr valign=top>
<td width=31%>short * </td>
<td width=22%>piVal </td>
<td width=47%>VT_BYREF|VT_I2 </td>
</tr>
<tr valign=top>
<td width=31%>long * </td>
<td width=22%>plVal </td>
<td width=47%>VT_BYREF|VT_I4 </td>
</tr>
<tr valign=top>
<td width=31%>float * </td>
<td width=22%>pfltVal </td>
<td width=47%>VT_BYREF|VT_R4 </td>
</tr>
<tr valign=top>
<td width=31%>double * </td>
<td width=22%>pdblVal </td>
<td width=47%>VT_BYREF|VT_R8 </td>
</tr>
<tr valign=top>
<td width=31%>VARIANT_BOOL * </td>
<td width=22%>pbool </td>
<td width=47%>VT_BYREF|VT_BOOL </td>
</tr>
<tr valign=top>
<td width=31%>SCODE * </td>
<td width=22%>pscode </td>
<td width=47%>VT_BYREF|VT_ERROR </td>
</tr>
<tr valign=top>
<td width=31%>CY * </td>
<td width=22%>pcyVal </td>
<td width=47%>VT_BYREF|VT_CY </td>
</tr>
<tr valign=top>
<td width=31%>DATE * </td>
<td width=22%>pdate </td>
<td width=47%>VT_BYREF|VT_DATE </td>
</tr>
<tr valign=top>
<td width=31%>BSTR * </td>
<td width=22%>pbstrVal </td>
<td width=47%>VT_BYREF|VT_BSTR </td>
</tr>
<tr valign=top>
<td width=31%>LPUNKNOWN * </td>
<td width=22%>ppunkVal </td>
<td width=47%>VT_BYREF|VT_UNKNOWN </td>
</tr>
<tr valign=top>
<td width=31%>LPDISPATCH * </td>
<td width=22%>ppdispVal </td>
<td width=47%>VT_BYREF|VT_DISPATCH </td>
</tr>
<tr valign=top>
<td width=31%>SAFEARRAY ** </td>
<td width=22%>pparray </td>
<td width=47%>VT_BYREF|VT_ARRAY|* </td>
</tr>
<tr valign=top>
<td width=31%>VARIANT * </td>
<td width=22%>pvarVal </td>
<td width=47%>VT_BYREF|VT_VARIANT </td>
</tr>
</table><br>
<p>
In addition to the tag and arm, the VARIANTARG contains additional reserved members to properly align the arm on 8-byte boundaries (to support efficient copying of 8-byte doubles); these members (along with any unused bytes in the arm) must be properly initialized with the VariantInit API. Once initialized, the tag and arm of each VARIANTARG are assigned the proper values. It is important to note that arguments are stored in the array in right to-left order. The DISPPARAMS structure bundles the VARIANTARG array with an array of DISPIDs that correspond to the names of each argument. </p>
<pre><code>typedef struct tagDISPPARAMS {
// Array of arguments
    VARIANTARG FAR* rgvarg;
// DISPIDS of named arguments
    DISPID FAR* rgdispidNamedArgs;
// Number of arguments
    unsigned int cArgs; 
// Number of named arguments
    unsigned int cNamedArgs; 
} DISPPARAMS;
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
