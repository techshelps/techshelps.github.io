<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AccessibleObjectFromEvent</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_msaa_accessibleobjectfromevent"></a>AccessibleObjectFromEvent</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
Retrieves the address of the <b>IAccessible</b> interface for an object that generated a given event. </p>
<pre><code><b>STDAPI AccessibleObjectFromEvent(
</b>  <b>HWND</b> <i>hwnd</i><b>,</b>
  <b>DWORD</b> <i>dwId</i><b>,</b>
  <b>DWORD</b> <i>dwChildId</i><b>,</b>
  <b>IAccessible</b>** <i>ppacc</i><b>,</b>
  <b>VARIANT</b>* <i>pvarChild</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hwnd</i> </dt>
<dd>
Handle to the window that generated the event. </dd>
<dt>
<i>dwId</i> </dt>
<dd>
Object ID. This value can be one of the standard <i>object identifier constants</i> or a custom object ID. </dd>
<dt>
<i>dwChildId</i> </dt>
<dd>
ID of the child element that triggered the event, or CHILDID_SELF if the object itself triggered the event. </dd>
<dt>
<i>ppacc</i> </dt>
<dd>
Address of a variable that will contain the address of the child object's <b>IAccessible</b> interface if the child is an accessible object. If not, this is the address of the <b>IAccessible</b> interface of the child's parent object. See the description for the <i>pvarChild</i> parameter for information about which interface is returned. </dd>
<dt>
<i>pvarChild</i> </dt>
<dd>
Address of a <b>VARIANT</b> structure that will contain information describing the call's result. The <b>vt</b> member will always be set to VT_I4. If the <b>lVal</b> member is set to zero, then the <b>IAccessible</b> interface pointer at <i>ppacc</i> belongs to the child object specified in <i>dwChildId</i>. Otherwise, <i>ppacc</i> is the address of the <b>IAccessible</b> interface of the child's parent object. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns S_OK if successful or a standard COM error code otherwise. When the <i>idObject</i> parameter identifies a system object, oleacc.dll checks for a valid <i>idChild</i> value. However, if the object identified by the <i>idObject</i> parameter is not a system object, the server is responsible for returning failure when the <i>idChild</i> parameter is invalid. </p>
<p>
Clients call this function to retrieve a specific child object that generated an event. The client uses the parameters sent to its <b>WinEventProc</b> callback function to fill this function's parameters. </p>
<h4>Remarks</h4>
<p>
This function retrieves the lowest-level accessible object that is associated with an event. If the child that generated the event is not an accessible object (that is, does not support <b>IAccessible</b>), then the function returns that child's parent. The parent is assumed to support the functionality extended by the <b>IAccessible</b> interface on the child's behalf. </p>
<p>
This function increases an object's reference count, and must have a corresponding call to Release. Even though an object has a reference count greater than zero, that object can still be destroyed, and clients are not guaranteed that getting properties from or calling methods on an object will succeed. This is what Microsoft® Word does with its objects when it shuts down: As with standard OLE Automation objects, Word will quit and CoDisconnect the object so that if anyone tries to access it cross-process after the quit, OLE will return an error. A reference count on a OLE Automation object does not affect the reference count in the application. </p>
<h4>See Also</h4>
<p>
AccessibleObjectFromPoint, AccessibleObjectFromWindow, WinEventProc, <i>VARIANT Structure</i> </p>
<p>&nbsp;</p></body>
</HTML>
