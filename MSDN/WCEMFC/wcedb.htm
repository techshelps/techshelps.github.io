<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WCEDBTST</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_vcce_wcedbtst"></a>WCEDBTST</h2>
<p>
The WCEDBTST sample demonstrates how to use the <b>CCeDBDatabase</b>, <b>CCeDBRecord</b>, <b>CCeDBProp</b>, and <b>CCeDBEnum</b> classes to create, destroy, sort, enumerate, access, and edit a Windows CE database in the object store. </p>
<p>
To test the various operations you can perform on a Windows CE database, select any of the following commands from the File menu.
<ul>
<li>
The Clear command clears the display.</li>
<li>
The Basic Test command checks to see if a certain database exists in the object store. If the database exists, it opens it and then deletes it. Then it creates a new database, checks to verify that it was created, closes it, opens it again, and deletes it.</li>
<li>
The Enumeration Test command creates three databases, and assigns the application-defined identifier '99' to each of them. It then creates two enumerators. The first enumerator enumerates all the databases in the object store; the second one enumerates only those databases that have the identifier '99.' The enumerators iterate through the specified databases, and the application retrieves the name and latest modification time of each one, and prints it to the display.</li>
<li>
The Sort Test command creates a sample database and prints its contents to the display. Then it opens the database three times specifying a different sort property each time, and prints the results of each sort operation to the display. The first time, it specifies Age as the sort property. The second time it specifies Gender. Then it uses the sort property flags to reverse the sort order of the Last Names sort property, so the database is sorted alphabetically by last name, but in descending order, rather than ascending. </li>
<li>
The Modify Test command creates a sample database and prints its contents to the display. Then it searches for a record that contains a specific value for a specific property (a person's last name), and changes the value of a different property in the retrieved record (the person's age). Then it prints the contents of the database to the display again.</li>
<li>
The Seek Test command creates a sample database and prints its contents to the display. Then it performs several seek operations, printing the retrieved record to the display after each successful seek. It seeks the first record, the last record, and the second record, and saves a pointer to the second record so it can return to it later. Then it seeks the second from the last record, then the previous record, and then it returns to the record to which it previously saved a pointer. After that, it seeks the first record that has the value "Smith" for the Last Name property. Then it proceeds to seek the next two records in the database that also have the value "Smith" for their Last Name property. The last seek fails, because there are only two Smiths in the database.</li>
<li>
The Deletion Test command creates a sample database and prints its contents to the display. Then it deletes a record and writes the contents of the database to the display again. Then it seeks a different record and deletes two properties from the record. After writing the contents of the database to the display again, it seeks another record, deletes a single property, and updates the display one more time.</li>
</ul>
<p>
These samples demonstrate the following keywords:</p>
<table cellspacing=4 cols=2 width=456>
<tr valign=top>
<td width=50%><a href="ccedbdb_2.htm"><b>CCeDBDatabase::AddRecord</b></a></td>
<td width=50%><a href="ccedbprp_9.htm"><b>CCeDBProp::GetString</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_4.htm"><b>CCeDBDatabase::Close</b></a></td>
<td width=50%><a href="ccedbprp_12.htm"><b>CCeDBProp::GetUShort</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_5.htm"><b>CCeDBDatabase::Create</b></a></td>
<td width=50%><a href="ccedbprp_24.htm"><b>CCeDBProp::operator =</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_6.htm"><b>CCeDBDatabase::Delete</b></a></td>
<td width=50%><a href="ccedbprp_18.htm"><b>CCeDBProp::SetSortFlags</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_7.htm"><b>CCeDBDatabase::DeleteCurrRecord</b></a></td>
<td width=50%><a href="ccedbprp_22.htm"><b>CCeDBProp::SetUShort</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_9.htm"><b>CCeDBDatabase::Exists</b></a></td>
<td width=50%><a href="ccedbrec_4.htm"><b>CCeDBRecord::AddProps</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_10.htm"><b>CCeDBDatabase::GetCurrIndex</b></a></td>
<td width=50%><a href="ccedbrec_5.htm"><b>CCeDBRecord::DeleteAllProps</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_11.htm"><b>CCeDBDatabase::GetCurrRecord</b></a></td>
<td width=50%><a href="ccedbrec_6.htm"><b>CCeDBRecord::DeleteProp</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_13.htm"><b>CCeDBDatabase::GetLastModified</b></a></td>
<td width=50%><a href="ccedbrec_8.htm"><b>CCeDBRecord::GetPropFromIdent</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_14.htm"><b>CCeDBDatabase::GetName</b></a></td>
<td width=50%><a href="cdc_44.htm"><b>CDC::GetTextMetrics</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_17.htm"><b>CCeDBDatabase::GetSortProps</b></a></td>
<td width=50%><a href="cdc_21.htm"><b>CDC::FillSolidRect</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_36.htm"><b>CCeDBDatabase::m_bAutoSeekNext</b></a></td>
<td width=50%><a href="cdc_15.htm"><b>CDC::DrawText</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_18.htm"><b>CCeDBDatabase::Open</b></a></td>
<td width=50%><a href="cdocumnt_26.htm"><b>CDocument::UpdateAllViews</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_19.htm"><b>CCeDBDatabase::ReadCurrRecord</b></a></td>
<td width=50%><a href="cobarray_2.htm"><b>CObArray::Add</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_20.htm"><b>CCeDBDatabase::SeekFirst</b></a></td>
<td width=50%><a href="cobarray_10.htm"><b>CObArray::GetSize</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_21.htm"><b>CCeDBDatabase::SeekFirstEqual</b></a></td>
<td width=50%><a href="cobarray_13.htm"><b>CObArray::RemoveAll</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_22.htm"><b>CCeDBDatabase::SeekLast</b></a></td>
<td width=50%><a href="crect_13.htm"><b>CRect::OffsetRect</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_24.htm"><b>CCeDBDatabase::SeekNextEqual</b></a></td>
<td width=50%><a href="cscrolvw_6.htm"><b>CScrollView::GetScrollPosition</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_25.htm"><b>CCeDBDatabase::SeekPrev</b></a></td>
<td width=50%><a href="cstring_34.htm"><b>CString::operator =</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_26.htm"><b>CCeDBDatabase::SeekToIndex</b></a></td>
<td width=50%><a href="cstring_38.htm"><b>CString::operator +=</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_27.htm"><b>CCeDBDatabase::SeekToRecord</b></a></td>
<td width=50%><object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="wcesdk_FileTimeToSystemTime">
</object><a href=JavaScript:alink_1.Click()><b>FileTimeToSystemTime</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_33.htm"><b>CCeDBDatabase::SetSortProps</b></a></td>
<td width=50%><object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="wcesdk_Sleep">
</object><a href=JavaScript:alink_2.Click()><b>Sleep</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbdb_34.htm"><b>CCeDBDatabase::WriteCurrRecord</b></a></td>
<td width=50%><object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="wcesdk_wsprintf">
</object><a href=JavaScript:alink_3.Click()><b>wsprintf</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="ccedbenm_3.htm"><b>CCeDBEnum::Next</b></a></td>
<td width=50%></td>
</tr>
</table><br>
<p>
You can find the WCEDBTST project files in the Wce\Samples\Mfc\WCEDBTST directory.</p>
<p>
To build the WCEDBTST sample, follow the procedure described in <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_Building_the_Sample_Applications">
</object><a href=JavaScript:alink_4.Click()>Building the Sample Applications</a>, selecting one or more of the following project configurations. </p>
<ul>
<li>
WCE x86em (Desktop PC Windows CE emulation)</li>
<li>
WCE x86</li>
<li>
WCE PPC</li>
<li>
WCE MIPS</li>
<li>
WCE SH</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
