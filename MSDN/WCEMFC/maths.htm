<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MATHS</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_vcce_maths"></a>MATHS</h2>
<p>
The MATHS, MATHS1, MATHS2, and MATHS3 samples demonstrate how you can create ActiveX controls and embed them in an MFC ActiveX container.</p>
<p>
The main dialog class in this application, CMathsDlg, has two controls, a check box, labeled "Opposite," and a control of the class CMathsCtl, which is derived from <b>CWnd</b>.</p>
<p>
CMathsDlg's override of <b>OnInitDialog</b> displays a query dialog with a list box that presents three options. 
<ul>
<li>
Maths1</li>
<li>
Maths2</li>
<li>
Maths3</li>
</ul>
<p>
When you select a control from the list box and dismiss the query dialog, the main dialog retrieves the index of the control you selected. It then creates a CMathsCtl object below the check box.</p>
<p>
CMathsDlg assigns the index of the control you selected to it's CMathsCtrl member's m_idControl member. The CMathsCtl object uses this identifier to determine which <b>CLSID</b> to pass to its <b>CreateControl</b> function. This <b>CLSID</b> determines which of the three ActiveX controls will be instantiated.</p>
<p>
The three controls, MATHS1, MATHS2, and MATHS3 are very similar. MATHS1 draws a horizontal line and a vertical line. If the "Opposite" check box is checked, it only draws the horizontal line. When you tap one of the lines with the stylus, the control fires an "Inside" event to its container. When you tap any other part of the control, it fires an "Outside" event.</p>
<p>
When the control's container, the CMathsDlg object, receives an "Inside" event, it reverses the foreground and background colors of its CMathCtl object. When it receives an "Outside" event, it toggles the check state of the "Opposite" check box. Whenever the state changes, the ActiveX control redraws itself.</p>
<p>
The MATHS2 and MATHS3 controls behave the same way as MATHS1, except that MATHS2 draws diagonal lines, instead of horizontal and vertical, and MATHS3 draws a vertical line if "Opposite" is not checked, or a circle, if it is.</p>
<p>
These samples demonstrate the following keywords:</p>
<table cellspacing=4 cols=2 width=444>
<tr valign=top>
<th align=left width=50%>MATHS</th>
<th align=left width=50%>MATHS1, MATHS2, MATHS3</th>
</tr>
<tr valign=top>
<td width=50%><a href="cbutton_6.htm"><b>CButton::GetCheck</b></a></td>
<td width=50%><a href="cbrush_5.htm"><b>CBrush::CreateSolidBrush</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cbutton_9.htm"><b>CButton::SetCheck</b></a></td>
<td width=50%><a href="cdc_16.htm"><b>CDC::Ellipse</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cdialog_13.htm"><b>CDialog::OnInitDialog</b></a></td>
<td width=50%><a href="cdc_20.htm"><b>CDC::FillRect</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="clistbox_2.htm"><b>CListBox::AddString</b></a></td>
<td width=50%><a href="cdc_51.htm"><b>CDC::LineTo</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="clistbox_16.htm"><b>CListBox::GetCurSel</b></a></td>
<td width=50%><a href="cdc_54.htm"><b>CDC::MoveTo</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cstring_17.htm"><b>CString::LoadString</b></a></td>
<td width=50%><a href="cdc_70.htm"><b>CDC::SelectObject</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwinapp_16.htm"><b>CWinApp::LoadIcon</b></a></td>
<td width=50%><a href="colectrl_46.htm"><b>COleControl::GetClientRect</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_14.htm"><b>CWnd::Create</b></a></td>
<td width=50%><a href="colectrl_64.htm"><b>COleControl::InitializeIIDs</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_15.htm"><b>CWnd::CreateControl</b></a></td>
<td width=50%><a href="colectrl_68.htm"><b>COleControl::InvalidateControl</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_44.htm"><b>CWnd::GetDlgItem</b></a></td>
<td width=50%><a href="colectrl_149.htm"><b>COleControl::TranslateColor</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_61.htm"><b>CWnd::GetProperty</b></a></td>
<td width=50%><a href="coleprpg.htm"><b>COlePropertyPage</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_85.htm"><b>CWnd::InvokeHelper</b></a></td>
<td width=50%><a href="cwnd_126.htm"><b>CWnd::OnLButtonDown</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_141.htm"><b>CWnd::OnSysCommand</b></a></td>
<td width=50%><object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mfc_AfxOleRegisterPropertyPageClass">
</object><a href=JavaScript:alink_1.Click()><b>AfxOleRegisterPropertyPageClass</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_180.htm"><b>CWnd::SetIcon</b></a></td>
<td width=50%><object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mfc_AfxOleUnregisterClass">
</object><a href=JavaScript:alink_2.Click()><b>AfxOleUnregisterClass</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_183.htm"><b>CWnd::SetProperty</b></a></td>
<td width=50%><object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mfc_DDP_PostProcessing">
</object><a href=JavaScript:alink_3.Click()><b>DDP_PostProcessing</b></a></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_192.htm"><b>CWnd::ShowWindow</b></a></td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%><a href="cwnd_198.htm"><b>CWnd::UpdateWindow</b></a></td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%><object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mfcAfxGetApp">
</object><a href=JavaScript:alink_4.Click()><b>AfxGetApp</b></a></td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=50%><object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_GetSystemMenu">
</object><a href=JavaScript:alink_5.Click()><b>GetSystemMenu</b></a></td>
<td width=50%></td>
</tr>
</table><br>
<p>
You can find the MATHS project files in the Wce\Samples\Mfc\MATHS directory.</p>
<p>
The MATHS1 project files are in the Wce\Samples\Mfc\MATHS1 directory.</p>
<p>
The MATHS2 project files are in the Wce\Samples\Mfc\MATHS2 directory</p>
<p>
The MATHS3 project files are in the Wce\Samples\Mfc\MATHS3 directory.</p>
<p>
To build these<b> </b>samples, follow the procedure described in <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_Building_the_Sample_Applications">
</object><a href=JavaScript:alink_6.Click()>Building the Sample Applications</a>, selecting one or more of the following project configurations. </p>
<ul>
<li>
WCE x86em (Desktop PC Windows CE emulation)</li>
<li>
WCE x86</li>
<li>
WCE PPC</li>
<li>
WCE MIPS</li>
<li>
WCE SH</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
