<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Eliminate Blinking Cursor, MFC Style</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<p><font color="#000000" size="5" face="verdana,arial,helvetica">Eliminate
Blinking Cursor, MFC Style</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<h2><font color="#000000" size="2" face="verdana,arial,helvetica">Dear
Dr. GUI:</font></h2>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">I
am using Microsoft Visual C++ 1.0 to develop an image processing
application. Basically, I started my work by modifying code from
an MFC sample, DIBLOOK. The application has a tool palette. If
the user has selected a tool from the palette, the cursor will
change to the selected tool shape (such as an eyedropper or
magnifying glass) when the cursor is moved into the view. To
achieve this, I called <b>SetCursor</b> in <b>CDibView::OnMouseMove</b>.
The problem I run into is the cursor blinks between IDC_ARROW and
IDC_EYEDROP when the mouse is moved. I suspect this is caused by
the system restoring the previous shape of the class cursor of
the view. What should I do to change the class cursor of windows
created by the framework? </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Michael
Feng </font></p>

<h2><font color="#000000" size="2" face="verdana,arial,helvetica">Dr.
GUI replies:</font></h2>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Well,
Michael, you correctly guessed that the system is drawing the
cursor registered with the window class before drawing yours;
this is what is giving you the cursor &quot;blink.&quot; Rather
than call <b>::SetCursor</b> from your view's <b>OnMouseMove</b>
function, I would suggest overriding the <b>OnSetCursor</b>
function in your <b>CView</b> derived class. </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">By
using Spy to watch mouse messages sent to your view object
(select Mouse And Input Messages from the Options menu), you will
notice that WM_SETCURSOR and WM_MOUSEMOVE are sent in tandem
whenever you move the mouse in the window's view. From this
information, you can surmise that your code is calling the
default implementation of <b>OnSetCursor</b> before you set the
cursor again in <b>OnMouseMove</b>. Fortunately this is a pretty
easy problem to fix, because you only need to make a message map
entry for WM_SETCURSOR, via ClassWizard, and move your <b>::SetCursor</b>
call to the resultant message handler, <b>CViewDerivedClass::OnSetCursor</b>.
If you'd like to retain the default cursor shape for child
windows, such as the I-bar in edit controls and the arrow for
check boxes and buttons, you should return FALSE from this
function. To maintain the cursor shape you've set when you move
over child windows, return TRUE. There you go!! Flash-free
cursors!! </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">For
specific implementation issues, please review the VIEWPROP sample
in the January 1995 Development Library.</font></p>
</font></body>
</html>
