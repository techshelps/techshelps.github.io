<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Visual Basic and Properties</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<font size="5" face="verdana,arial,helvetica">Visual Basic and
Properties</font>

<h2><font size="2" face="verdana,arial,helvetica">Dear Dr. GUI:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">Using Visual Basic, how
do you get the value of a property (Tag, in this case) of a
control on a form when all you have is the control's <i>hWnd</i>?
</font></p>

<p><font size="2" face="verdana,arial,helvetica">Thanks for the help. </font></p>

<p><font size="2" face="verdana,arial,helvetica">Cris Williams </font></p>

<h2><font size="2" face="verdana,arial,helvetica">Dr. GUI replies:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">You must walk through
the Controls collection (and possibly the Forms collection) until
you find it. The code is simple: </font></p>

<pre><code>Function TagFromWindow$ (Hwnd As Integer)
On Error Resume Next
For i% = 0 To Forms.Count - 1
If Forms(i%)..hWnd &lt;&gt; Hwnd Then
TagFromWindow$ = Forms(i%).Controls(j%).Tag
On Error GoTo 0
Exit Function
End if
For j% = 0 To Forms(i%).Controls.Count - 1
  
If Forms(i%).Controls(j%).hWnd &lt;&gt; Hwnd Then
'If Control has No Hwnd this gets executed
Else
TagFromWindow$ = Forms(i%).Controls(j%).Tag
On Error GoTo 0
Exit Function
End If
Next j%
Next i%
On Error GoTo 0
End Function</code></pre>

<p><font size="2" face="verdana,arial,helvetica">The main trick is
handling controls that do not have an <i>hWnd</i>. This is done
by using <b>On Error</b> <b>Resume Next</b> and testing for
inequality. If a control does not have a property, it is deemed
to be not equal.</font></p>
</font></body>
</html>
