<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Menu Resource ID and Buttons</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<font size="5" face="verdana,arial,helvetica">Menu Resource ID and
Buttons</font>

<h2><font size="2" face="verdana,arial,helvetica">Dear Dr. GUI:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">Somewhere I read or was
told that if you want a dialog box button (for example, Exit) to
do the same thing as a menu item (File Exit), just give the
button the same resource ID as the menu item (ID_APP_EXIT). Then
the Microsoft Foundation Class Library (MFC) message machinery
will cause the menu item command handler to get called magically
when the button is clicked. I tried this long ago and gave up
when it just didn't work. I tried it again today and it still
doesn't work. Now I'd like to know why. </font></p>

<h2><font size="2" face="verdana,arial,helvetica">Dr. GUI replies:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">I just tried it. It
worked. For fun, add a button to a default AppWizard
application's About box. Use ID_APP_EXIT as the ID for the
button. Run the application, choose the About dialog box, click
the button, and the application exits. </font></p>

<p><font size="2" face="verdana,arial,helvetica">This works so well in
App Studio 1.0 that, if you place a button on your own dialog box
in the dialog editor, go into test mode, and click the newly
created ID_APP_EXIT button, App Studio will exit! </font></p>

<p><font size="2" face="verdana,arial,helvetica">One thing that may be
causing your problems: This is designed to work only for IDs with
the high bit set.</font></p>
</font></body>
</html>
