<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tool Tip Agony: ALT Key Troubles</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<font size="5" face="verdana,arial,helvetica">Tool Tip Agony: ALT Key
Troubles</font>

<h2><font size="2" face="verdana,arial,helvetica">Dear Dr. GUI:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">I have implemented tool
tips in my applications by subclassing the <b>CToolBar</b> class
in Visual C++ 1.5 and overriding the <b>OnMouseMove</b> function.
When I determine the cursor is positioned over one of the toolbar
icons, I pop up a small, topmost window with the tool tip. I then
call <b>SetCapture</b> so I will be notified when the mouse
cursor is moved off the toolbar. At that time, I remove the tool
tip. This all works just fine. </font></p>

<p><font size="2" face="verdana,arial,helvetica">My problem is that <b>SetCapture</b>
disables the alt key. If a tool tip is displayed on the screen,
the user cannot press alt+f (or any shortcut key that uses alt)
to select a menu. What's even worse, Windows will pass a WM_CHAR
message with the f key. This sometimes has terrible effects, such
as replacing a field in an active dialog box with the letter F. </font></p>

<p><font size="2" face="verdana,arial,helvetica">Do you have a better
mouse trap? I'm sure people will beat a path to your door if you
do &lt;grin&gt;. </font></p>

<p><font size="2" face="verdana,arial,helvetica">Randy L. Pearson<br>
70573,441<br>
interlink@aol.com </font></p>

<h2><font size="2" face="verdana,arial,helvetica">Dr. GUI replies:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">Do I have a better mouse
trap? No, but this reminds me of a personal goal of mine. I have
always wanted to invent something simple and easy to produce.
Something like the bottle opener or the thumbtack. It would be so
unique that it would be embraced by our culture and sell in the
millions. I would retire to some remote island and provide bogus
treatments for the imagined ills of the rich and famous. </font></p>

<p><font size="2" face="verdana,arial,helvetica">As luck would have it, I
stumbled upon a sample in the Development Library called </font><a
href="#"><font size="2" face="verdana,arial,helvetica">TOOLTIPS</font></a><font
size="2" face="verdana,arial,helvetica"> that implements ToolTips for
your toolbar under Microsoft Visual C++ version 1.5 and Microsoft
Foundation Class Library (MFC) version 2.5. If you take a look at
the source file, TOOLBARX.CPP, you will notice that this sample
relies upon the use of an undocumented member function (<b>CToolBar::HitTest</b>)
of the <b>CToolBar</b> class to implement ToolTips without this
nasty problem with the alt key. </font></p>

<p><font size="2" face="verdana,arial,helvetica">Of course, this problem
is no problem at all under Visual C++ version 2.0 because the
newest release has ToolTips built into the toolbar class. If
possible, it would be a very good idea for you to use version 2.0
of Visual C++ (MFC 3.0) so that you can use this built-in
feature. </font></p>
</font></body>
</html>
