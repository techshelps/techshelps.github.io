<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Metafiles and Scaling</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<font size="5" face="verdana,arial,helvetica">Metafiles and Scaling</font>

<h2><font size="2" face="verdana,arial,helvetica">Dear Dr. GUI:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">I must display graphic
information in such a way that the user can scale and move the
drawing interactively. For some reason, I decided the best way is
to store my graphical information in a metafile; the
visualization mechanism takes care of playing this metafile in
the screen context, after preparing an MM_ANISOTROPIC mapping
mode with the window and viewport origin and extents set
properly. This works fine. </font></p>

<p><font size="2" face="verdana,arial,helvetica">I must include, as part
of my graphical information, a metafile. The metafiles are Aldus
placeable metafiles, but my problem is that they include records
as <b>SetWindowExt</b> and <b>SetWindowOrg</b> (and possibly even
<b>SetViewportExt</b> and <b>SetViewportOrg</b>). I save my
mapping mode and metrics with <b>SaveDC</b> and <b>RestoreDC</b>,
but the included metafile always appears with the same position
and size. </font></p>

<p><font size="2" face="verdana,arial,helvetica">How can I force such a
metafile to draw itself in a position and size controlled by my
own initial calls to <b>Set...Ext</b> and <b>Set...Org</b>, as
the rest of the elements I draw? </font></p>

<p><font size="2" face="verdana,arial,helvetica">Thank you very much,
doc. (A T-shirt will be appreciated.) </font></p>

<p><font size="2" face="verdana,arial,helvetica">Regards,<br>
Alfredo Moran </font></p>

<h2><font size="2" face="verdana,arial,helvetica">Dr. GUI replies:</font></h2>

<p><font size="2" face="verdana,arial,helvetica">They always render the
same size. The placeable metafile was designed to address WYSIWYG
concerns. It worked well but has always been confusing to
developers. The ultimate solution is to use enhanced metafiles
(EMF). There are Win32 functions that convert older-style Windows
metafiles (WMF) to EMF. But this still does not address all
issues associated with placeable metafiles. </font></p>

<p><font size="2" face="verdana,arial,helvetica">The problem you are
encountering is the tight coupling between the window origin and
extents (that are included in the metafile), and the boundaries
and extents used in the subsequent metafile records. The only way
to decouple these effectively is to enumerate the metafile and
skip over any coordinate mapping records. However, you will want
at least to observe what was going on in these records, because
you will need to set your own coordinate mapping system to
achieve the scaling you are looking for. It is better to do this
than adjusting the parameters of all subsequent records. </font></p>
</font></body>
</html>
