<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DirectXSetupCallbackFunction</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dx5_directxsetupcallbackfunction_dsetup"></a>DirectXSetupCallbackFunction</h1>
<p>
DirectXSetupCallbackFunction is a placeholder name for a callback function supplied by the setup program. The callback function reports the status of the current installation process. It also can provide information for use by the <b>MessageBox</b> function.</p>
<pre><code><b>DWORD DirectXSetupCallbackFunction(
  DWORD </b><i> Reason</i><b>,   </b>// reason for the callback
<b>  DWORD </b><i> MsgType</i><b>,  </b>// same as MessageBox
<b>  char</b><i> *szMessage</i><b>, </b>// message string
<b>  char</b><i> *szName,    </i>// depends on <i>Reason</i>
<b>  void</b><i> *pInfo      </i>// upgrade information
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Reason</i></dt>
<dd>
Reason for the callback. It can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_BEGIN_INSTALL </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%><b>DirectXSetup</b> is about to begin installing DirectX components and device drivers. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_BEGIN_INSTALL_DRIVERS </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%><b>DirectXSetup</b> is about to begin installing device drivers. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_BEGIN_INSTALL_RUNTIME </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%><b>DirectXSetup</b> is about to begin installing DirectX components. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_BEGIN_RESTORE_DRIVERS </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%><b>DirectXSetup</b> is about to begin restoring previous drivers. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_CANTINSTALL_BETA </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>A pre-release beta version of Windows 95 was detected. The DirectX component or device driver can't be installed. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_CANTINSTALL_NOTWIN32 </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The operating system detected is not Windows 95 or Windows NT®. DirectX is not compatible with Windows 3.<i>x</i>. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_CANTINSTALL_NT </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The DirectX component or device driver can't be installed on versions of Windows NT prior to version 4.0. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_CANTINSTALL_UNKNOWNOS </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The operating system is unknown. The DirectX component or device driver can't be installed. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_CANTINSTALL_WRONGLANGUAGE </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The DirectX component or device driver is not localized to the language being used by Windows. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_CANTINSTALL_WRONGPLATFORM </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The DirectX component or device driver is for another type of computer. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_CHECK_DRIVER_UPGRADE </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>Driver is being considered for upgrade. Verification from user is recommended. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_INTERNAL_ERROR </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>An internal error has occurred. Setup of the DirectX component or device driver has failed. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_NOMESSAGE </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>No message to be displayed. The callback function should return. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_NOTPREINSTALLEDONNT </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The DirectX component or device driver can't be installed on the version of Windows NT in use. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_PREINSTALL_NT </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>DirectX is already installed on the version of Windows NT in use. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_MSG_SETUP_INIT_FAILED </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>Setup of the DirectX component or device driver has failed. </td>
</tr>
</table><br>

</dd>
<dt>
<i>MsgType</i></dt>
<dd>
Contains flags that control the display of a message box. These flags can be passed to the <b>MessageBox</b> function. An exception is when <i>MsgType</i> is equal to zero. In that case, the setup program can display status information but should not wait for input from the user.</dd>
<dt>
<i>szMessage</i> </dt>
<dd>
A localized character string containing error or status messages that can be displayed in a message box created with the <b>MessageBox</b> function. </dd>
<dt>
<i>szName</i></dt>
<dd>
The value of <i>szName </i>is NULL unless the <i>Reason</i> parameter is DSETUP_CB_MSG_CHECK_DRIVER_UPGRADE. In that case, <i>szName </i> contains the name of driver to be upgraded.</dd>
<dt>
<i>pInfo</i></dt>
<dd>
Pointer to a structure containing upgrade information. When <i>Reason</i> is DSETUP_CB_MSG_CHECK_DRIVER_UPGRADE, the setup program is in the process of upgrading a driver and asking the user whether the upgrade should take place. This structure contains information about the upgrade in its <b>UpgradeType</b><i> </i>member, which can have the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_CANTBACKUP</td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The old system components can't be backed up. Upgrade can be performed, but the components or drivers can't be restored later.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_DEVICE_ACTIVE </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The device is currently in use. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_DEVICE_DISPLAY </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The device driver being upgraded is for a display device. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_DEVICE_MEDIA </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The device driver being upgraded is for a media device. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_FORCE </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>Windows may not function correctly if the component is not upgraded. The upgrade will be performed. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_HASWARNINGS </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%><b>DirectXSetup</b> can upgrade the driver for this device, but doing so may affect one or more programs on the system<i>. szMessage </i>contains the names of which programs may be affected. Upgrade not recommended. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_KEEP</td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The system may fail if this device driver is upgraded. Upgrade not allowed. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_SAFE </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%><b>DirectXSetup</b> can safely upgrade this device driver. Upgrade recommended. A safe upgrade will not adversely affect the operation of Windows. Some hardware-dependent programs may be adversely affected.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_UNKNOWN </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%><b>DirectXSetup</b> does not recognize the existing driver for this device. This value will occur frequently. Upgrading may adversely affect the use of the device. It is strongly recommended that the upgrade not be performed. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DSETUP_CB_UPGRADE_UNNECESSARY </td>
</tr>
<tr valign=top>
<td width=10%></td>
<td width=90%>The existing device driver is newer than the driver being installed. An upgrade is not recommended. </td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
The return value should be the same as the <b>MessageBox</b> function, with one exception. If this function returns zero, the <b>DirectXSetup</b> function will act as if no callback function was present. That is, it will perform the default action for upgrade of the DirectX component or driver.</p>
<h4>Remarks</h4>
<p>
The name of the DirectXSetupCallbackFunction is supplied by the setup program. The <a href="dsetup_6ca8.htm"><b>DirectXSetupSetCallback</b></a> function is used to pass the address of the callback function to DirectSetup.</p>
<p>
If <i>MsgType</i> is equal to zero, the setup program may display status information, but it should not wait for user input. This is useful for displaying ongoing status information.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dsetup.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>User-defined.</p>
<h4>See Also</h4>
<p>
<b>MessageBox</b>, <a href="dsetup_6ca8.htm"><b>DirectXSetupSetCallback</b></a><b>, </b><a href="dsetup_9yuo.htm">Customizing Setup With the DirectSetup Callback Function</a></p>
<p>&nbsp;</p></body>
</HTML>
