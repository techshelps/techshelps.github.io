<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the DirectSound Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_dx5_creating_the_directsound_object_dsound"></a>Creating the DirectSound Object</h3>
<p>
The simplest way to create the DirectSound object is with the <a href="dsound_86ec.htm"><b>DirectSoundCreate</b></a> function. The first parameter of this function specifies the GUID of the device to be associated with the object. You can obtain this GUID by <a href="dsound_39pg.htm">Enumeration of Sound Devices</a>, or you can simply pass NULL to create the object for the default device. </p>
<pre><code>LPDIRECTSOUND lpDirectSound; 
HRESULT       hr;
hr = DirectSoundCreate(NULL, &amp;lpDirectSound, NULL));
 </code></pre>
<p>
The function returns an error if there is no sound device or if the sound device is being used by the waveform-audio (non-DirectSound) functions. You should prepare your applications for this call to fail so that they can either continue without sound or prompt the user to close the application that is already using the sound device.</p>
<p>
You can also create the DirectSound object by using the <b>CoCreateInstance</b> function, as follows:
<ol>
<li>
Initialize COM at the start of your application by calling <b>CoInitialize</b> and specifying NULL.<pre><code>if (FAILED(CoInitialize(NULL)))
    return FALSE;
 </code></pre>
</li>
<li>
Create your DirectSound object by using <b>CoCreateInstance</b> and the <a href="dsound_4n6s.htm"><b>IDirectSound::Initialize</b></a> method, rather than the <a href="dsound_86ec.htm"><b>DirectSoundCreate</b></a> function.<pre><code>dsrval = CoCreateInstance(&amp;CLSID_DirectSound,
                          NULL, 
                          CLSCTX_INPROC_SERVER,
                          &amp;IID_IDirectSound,
                          &amp;lpds);
    if (SUCCEEDED(dsrval))
        dsrval = IDirectSound_Initialize(lpds, NULL);
 </code></pre>
</li>
</ol>
<p>
<i>CLSID_DirectSound</i> is the class identifier of the DirectSound driver object class and <i>IID_IDirectSound</i> is the DirectSound interface that you should use. The <i>lpds</i> parameter is the uninitialized object <b>CoCreateInstance</b> returns.</p>
<p>
Before you use a DirectSound object created with the <b>CoCreateInstance</b> function, you must call the <a href="dsound_4n6s.htm"><b>IDirectSound::Initialize</b></a> method. This method takes the driver GUID parameter that <a href="dsound_86ec.htm"><b>DirectSoundCreate</b></a> typically uses (NULL in this case). After the DirectSound object is initialized, you can use and release the DirectSound object as if it had been created by using the <b>DirectSoundCreate</b> function.</p>
<p>
Before you close the application, shut down COM by calling the <b>CoUninitialize</b> function, as follows:</p>
<pre><code>CoUninitialize(); 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
