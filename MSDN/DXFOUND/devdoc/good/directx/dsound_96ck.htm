<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDirectSoundBuffer::SetFormat</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dx5_idirectsoundbuffer_setformat_dsound"></a>IDirectSoundBuffer::SetFormat</h1>
<p>
The <b>IDirectSoundBuffer::SetFormat</b> method sets the format of the <a href="glossary_33qr.htm#_dx5_primary_sound_buffer_glos">primary sound buffer</a> for the application. Whenever this application has the input focus, DirectSound will set the primary buffer to the specified format.</p>
<pre><code><b>HRESULT SetFormat(
  LPCWAVEFORMATEX</b><i> lpcfxFormat  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpcfxFormat</i></dt>
<dd>
Address of a <b>WAVEFORMATEX</b> structure that describes the new format for the <a href="glossary_33qr.htm#_dx5_primary_sound_buffer_glos">primary sound buffer</a>.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the method succeeds, the return value is DS_OK.</p>
<p>
If the method fails, the return value may be one of the following error values:</p>
<p>
<a href="dsound_9y3p.htm#_dx5_dserr_badformat_dsound">DSERR_BADFORMAT</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_invalidcall_dsound">DSERR_INVALIDCALL</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_invalidparam_dsound">DSERR_INVALIDPARAM</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_outofmemory_dsound">DSERR_OUTOFMEMORY</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_priolevelneeded_dsound">DSERR_PRIOLEVELNEEDED</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_unsupported_dsound">DSERR_UNSUPPORTED</a> </p>
<h4>Remarks</h4>
<p>
If this method is called on a primary buffer that is being accessed in write-primary cooperative level, the buffer must be stopped before <b>IDirectSoundBuffer::SetFormat</b> is called. If this method is being called on a primary buffer for a non-write-primary level, DirectSound will implicitly stop the primary buffer, change the format, and restart the primary; the application need not do this explicitly.</p>
<p>
If the hardware does not support the requested format, DirectSound may be able to mix the sound in the requested format and then convert it before sending it to the primary buffer. To determine whether this is happening, an application can call the <a href="dsound_7b38.htm"><b>IDirectSoundBuffer::GetFormat</b></a> method for the primary buffer and compare the result with the format that was requested with the <b>SetFormat</b> method.</p>
<p>
If the hardware does not support the requested format and DirectSound is unable to emulate it, the call to <b>SetFormat</b> fails.</p>
<p>
A call to this method also fails if the calling application has the DSSCL_NORMAL cooperative level.</p>
<p>
This method is not valid for secondary sound buffers. If a <a href="glossary_5583.htm#_dx5_secondary_sound_buffer_glos">secondary sound buffer</a> requires a format change, the application should create a new DirectSoundBuffer object using the new format.</p>
<p>
DirectSound supports PCM formats; it does not currently support compressed formats.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dsound.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use dsound.lib.</p>
<h4>See Also</h4>
<p>
<a href="dsound_317o.htm"><b>IDirectSoundBuffer</b></a>, <a href="dsound_7b38.htm"><b>IDirectSoundBuffer::GetFormat</b></a></p>
<p>&nbsp;</p></body>
</HTML>
