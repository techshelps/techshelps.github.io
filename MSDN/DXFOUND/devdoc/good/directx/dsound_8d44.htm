<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Capturing Sounds</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_dx5_capturing_sounds_dsound"></a>Capturing Sounds</h3>
<p>
Capturing a sound consists of the following steps:
<ol>
<li>
Start the buffer by calling the <a href="dsound_0d0k.htm"><b>IDirectSoundCaptureBuffer::Start</b></a> method. Audio data from the input device begins filling the buffer from the beginning. </li>
<li>
Wait until the desired amount of data is available. See <a href="dsound_542s.htm">Capture Buffer Notification</a> for one method of determining when the capture position reaches a certain point. </li>
<li>
When sufficient data is available, lock a portion of the capture buffer by calling the <a href="dsound_1nc5.htm"><b>IDirectSoundCaptureBuffer::Lock</b></a> method. <p>
To make sure you are not attempting to lock a portion of memory that is about to be used for capture, you should first obtain the current read position by calling <a href="dsound_8bxg.htm"><b>IDirectSoundCaptureBuffer::GetCurrentPosition</b></a>. For an explanation of the read position, see <a href="dsound_9iec.htm">Capture Buffer Information</a>.
<p>
As parameters to the <b>Lock</b> method, you pass the size and offset of the block of memory you want to read. The method returns a pointer to the address where the memory block begins, and the size of the block. If the block wraps around from the end of the buffer to the beginning, two pointers are returned, one for each section of the block. The second pointer is NULL if the locked portion of the buffer does not wrap around.
</li>
<li>
Copy the data from the buffer, using the addresses and block sizes returned by the <b>Lock</b> method.</li>
<li>
Unlock the buffer with the <a href="dsound_8uzo.htm"><b>IDirectSoundCaptureBuffer::Unlock</b></a> method.</li>
<li>
Repeat steps 2 to 5 until all the data is captured. Then call the<a href="dsound_9zvo.htm"> <b>IDirectSoundCaptureBuffer::Stop</b></a> method.</li>
</ol>
<p>
Normally the buffer stops capturing automatically when the capture position reaches the end of the buffer. However, if the DSCBSTART_LOOPING flag was set in the <i>dwFlags</i> parameter to the <b>IDirectSoundCaptureBuffer::Start</b> method, the capture will continue until the application calls the <b>IDirectSoundCaptureBuffer::Stop</b> method, at which point the capture position is moved to the beginning of the buffer.</p>
<p>&nbsp;</p></body>
</HTML>
