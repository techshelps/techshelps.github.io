<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 6: Changing an Effect</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_dx5_step_6_changing_an_effect_dinput"></a>Step 6: Changing an Effect</h3>
<p>
Your chain saw is merrily rattling away, and now you want to modify the effect to simulate the slowing down of the engine as the saw bites into wood. Fortunately, DirectInput lets you modify the parameters of an effect while it is playing.</p>
<p>
To change the effect, you need to set up a <a href="dinput_6l2s.htm"><b>DIEFFECT</b></a> structure or have access to the one you used to create the effect. If you are setting up a new structure with local scope, you need to initialize only the <b>dwSize</b> member and any members that contain or point to data that is to be changed. </p>
<p>
In this case you want to change a type-specific parameter — the period of the effect — so you need to have access to the <a href="dinput_3fsk.htm"><b>DIPERIODIC</b></a> structure you used when creating the effect, or else create a local copy with all members initialized. Make sure that the address of the <b>DIPERIODIC</b> structure is in the <b>lpvTypeSpecificParams</b> member of the <b>DIEFFECT</b> structure.</p>
<p>
Now set the new period of the effect:</p>
<pre><code>diPeriodic.dwPeriod = (DWORD) (0.08 * DI_SECONDS); 
 </code></pre>
<p>
Then call the method that actually makes the changes:</p>
<pre><code>HRESULT hr = g_lpdiEffect-&gt;SetParameters(&amp;diEffect,
                           DIEP_TYPESPECIFICPARAMS)
 </code></pre>
<p>
Note the flag that restricts the changes to a single member of the <b>DIEFFECT</b> structure. </p>
<p>
You can control the way changes are handled by using other flags. For example, by using the DIEP_NODOWNLOAD flag you could change the parameters immediately after starting the effect but delay the implementation until the user actually started cutting wood. Then you would call the <a href="dinput_5644.htm"><b>IDirectInputEffect::Download</b></a> method. For more information on how to use the various control flags, see <a href="dinput_4ptg.htm"><b>IDirectInputEffect::SetParameters</b></a>.</p>
<p>&nbsp;</p></body>
</HTML>
