<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting an IDirectDraw2 Interface</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h4><a name="_dx5_getting_an_idirectdraw2_interface_ddraw"></a>Getting an IDirectDraw2 Interface</h4>
<p>
The Component Object Model on which DirectX is built specifies that an object can provide new functionality can be added through new interfaces, without affecting backward compatibility. To this end, the <a href="ddref_6t2v.htm"><b>IDirectDraw2</b></a> interface supersedes the <b>IDirectDraw</b> interface. This new interface can be obtained by using the <b>IDirectDraw::QueryInterface</b> method, as shown in the following C++ example:</p>
<pre><code>// Create an IDirectDraw2 interface. 
LPDIRECTDRAW  lpDD; 
LPDIRECTDRAW2 lpDD2; 
 
ddrval = DirectDrawCreate(NULL, &amp;lpDD, NULL); 
if(ddrval != DD_OK) 
    return; 
 
ddrval = lpDD-&gt;SetCooperativeLevel(hwnd, 
    DDSCL_NORMAL); 
if(ddrval != DD_OK) 
    return; 
 
ddrval = lpDD-&gt;QueryInterface(IID_IDirectDraw2, 
    (LPVOID *)&amp;lpDD2); 
if(ddrval != DD_OK) 
    return; 
 </code></pre>
<p>
The preceding example creates a DirectDraw object, then calls the <a href="dxintro_0pgv.htm"><b>IUnknown::QueryInterface</b></a> method of the <b>IDirectDraw</b> interface it received to create an <a href="ddref_6t2v.htm"><b>IDirectDraw2</b></a> interface.</p>
<p>
After getting an <b>IDirectDraw2</b> interface, you can begin calling its methods to take advantage of new features, performance improvements, and behavioral differences. Because some methods might change with the release of a new interface, mixing methods from an interface and its replacement (between <b>IDirectDraw</b> and <b>IDirectDraw2</b>, for example) can cause unpredictable results.</p>
<p>&nbsp;</p></body>
</HTML>
