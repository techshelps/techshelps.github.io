<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating an Effect</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_dx5_creating_an_effect_dinput"></a>Creating an Effect</h3>
<p>
You create an effect object by using the <a href="dinput_92d0.htm"><b>IDirectInputDevice2::CreateEffect</b></a> method, as in the following C++ example, where <i>pdev2</i> points to an instance of the interface. This example creates a very simple effect that will pull the joystick away from the user at full force for half a second.</p>
<pre><code>HRESULT  hr;
LPDIRECTINPUTEFFECT lpdiEffect;  // receives pointer to created effect
DIEFFECT diEffect;               // parameters for created effect

DWORD    dwAxes[2] = { DIJOFS_X, DIJOFS_Y };
LONG     lDirection[2] = { 18000, 0 };

DICONSTANTFORCE diConstantForce; 
 
diConstantForce.lMagnitude = DI_FFNOMINALMAX;   // full force

diEffect.dwSize = sizeof(DIEFFECT); 
diEffect.dwFlags = DIEFF_POLAR | DIEFF_OBJECTOFFSETS; 
diEffect.dwDuration = 0.5 * DI_SECONDS;
diEffect.dwSamplePeriod = 0;               // = default 
diEffect.dwGain = DI_FFNOMINALMAX;         // no scaling
diEffect.dwTriggerButton = DIEB_NOTRIGGER; // not a button response
diEffect.dwTriggerRepeatInterval = 0;      // not applicable
diEffect.cAxes = 2; 
diEffect.rgdwAxes = &amp;dwAxes; 
diEffect.rglDirection = &amp;lDirection; 
diEffect.lpEnvelope = NULL; 
diEffect.cbTypeSpecificParams = sizeof(DICONSTANTFORCE);
diEffect.lpvTypeSpecificParams = &amp;diConstantForce;  

hr = pdev2-&gt;CreateEffect(GUID_ConstantForce,
                         &amp;diEffect,
                         &amp;lpdiEffect,
                         NULL);
 </code></pre>
<p>
In the method call, the first parameter identifies the supported effect with which the created effect is to be associated. The example uses one of the predefined GUIDs found in Dinput.h. Note that if you use a predefined GUID, the call will fail if the device doesn't support the effect.</p>
<p>
The second parameter sets the parameters as specified in the <a href="dinput_6l2s.htm"><b>DIEFFECT</b></a> structure. </p>
<p>
The third parameter receives a pointer to the effect object if the call is successful.</p>
<p>
The DIEFF_POLAR flag specifies the type of coordinates used for the direction of the force. (See <a href="dinput_567o.htm">Effect Direction</a>.) It is combined with DIEFF_OBJECTOFFSETS, which indicates that any buttons or axes used in other members will be identified by their offsets within the <a href="dinput_0xtg.htm"><b>DIDATAFORMAT</b></a> structure for the device. The alternative is to use the DIEFF_OBJECTIDS flag, signifying that buttons and axes will be identified by the <b>dwType</b> member of the <a href="dinput_26yc.htm"><b>DIDEVICEOBJECTINSTANCE</b></a> structure returned for the object when it was enumerated with the <a href="dinput_0eus.htm"><b>IDirectInputDevice::EnumObjects</b></a> method.</p>
<p>
For more information on the members of the <b>DIEFFECT</b> structure, see <a href="dinput_567o.htm">Effect Direction</a>.</p>
<p>&nbsp;</p></body>
</HTML>
