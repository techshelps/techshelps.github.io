<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDirectSound::DuplicateSoundBuffer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dx5_idirectsound_duplicatesoundbuffer_dsound"></a>IDirectSound::DuplicateSoundBuffer</h1>
<p>
The <b>IDirectSound::DuplicateSoundBuffer</b> method creates a new DirectSoundBuffer object that uses the same buffer memory as the original object.</p>
<pre><code><b>HRESULT DuplicateSoundBuffer(
  LPDIRECTSOUNDBUFFER</b><i> lpDsbOriginal</i><b>,  </b>
<b>  LPLPDIRECTSOUNDBUFFER</b><i> lplpDsbDuplicate  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpDsbOriginal</i></dt>
<dd>
Address of the DirectSoundBuffer object to be duplicated.</dd>
<dt>
<i>lplpDsbDuplicate</i></dt>
<dd>
Address of a pointer to the new DirectSoundBuffer object.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the method succeeds, the return value is DS_OK.</p>
<p>
If the method fails, the return value may be one of the following error values:</p>
<p>
<a href="dsound_9y3p.htm#_dx5_dserr_allocated_dsound">DSERR_ALLOCATED</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_invalidcall_dsound">DSERR_INVALIDCALL</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_invalidparam_dsound">DSERR_INVALIDPARAM</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_outofmemory_dsound">DSERR_OUTOFMEMORY</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_uninitialized_dsound">DSERR_UNINITIALIZED</a> </p>
<h4>Remarks</h4>
<p>
The new object can be used just like the original.</p>
<p>
Initially, the duplicate buffer will have the same parameters as the original buffer. However, the application can change the parameters of each buffer independently, and each can be played or stopped without affecting the other.</p>
<p>
If data in the buffer is changed through one object, the change will be reflected in the other object because the buffer memory is shared.</p>
<p>
The buffer memory will be released when the last object referencing it is released.</p>
<p>
Applications cannot assume that an attempt to duplicate a sound buffer will always succeed. In particular, DirectSound will not create a software duplicate of a hardware buffer. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dsound.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use dsound.lib.</p>
<h4>See Also</h4>
<p>
<a href="dsound_0604.htm"><b>IDirectSound::CreateSoundBuffer</b></a></p>
<p>&nbsp;</p></body>
</HTML>
