<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 1: Creating the Palette</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_dx5_step_1_creating_the_palette_ddraw"></a>Step 1: Creating the Palette</h3>
<p>
The DDEX2 sample first loads the palette into a structure by using the following code:</p>
<pre><code>lpDDPal = DDLoadPalette(lpDD, szBackground); 
 
if (lpDDPal == NULL) 
    goto error; 
 </code></pre>
<p>
The sample function DDLoadPalette is part of the common DirectDraw functions found in the Ddutil.cpp file located in the \Dxsdk\Sdk\Samples\Misc directory. Most of the DirectDraw sample files in this Programmer's Reference use this file. Essentially, it contains the functions for loading bitmaps and palettes from either files or resources. To avoid having to repeat code in the example files, these functions were placed in a file that could be reused. Make sure you include Ddutil.cpp in the list of files to be compiled with the rest of the DDEX samples.</p>
<p>
For DDEX2, the DDLoadPalette sample function creates a DirectDrawPalette object from the Back.bmp file. The DDLoadPalette sample function determines if a file or resource for creating a palette exists. If one does not, it creates a default palette. For DDEX2, it extracts the palette information from the bitmap file and stores it in a structure pointed to by <i>ape</i>.</p>
<p>
DDEX2 then creates the DirectDrawPalette object, as shown in the following example:</p>
<pre><code>pdd-&gt;CreatePalette(DDPCAPS_8BIT, ape, &amp;ddpal, NULL); 
return ddpal; 
 </code></pre>
<p>
When the <a href="ddref_383b.htm"><b>IDirectDraw2::CreatePalette</b></a> method returns, the <i>ddpal</i> parameter points to the DirectDrawPalette object, which is then returned from the DDLoadPalette call.</p>
<p>
The <i>ape</i> parameter is a pointer to a structure that can contain either 2, 4, 16, or 256 entries, organized linearly. The number of entries depends on the <i>dwFlags</i> parameter in the <b>IDirectDraw2::CreatePalette</b> method. In this case, the <i>dwFlags</i> parameter is set to DDPCAPS_8BIT, which indicates that there are 256 entries in this structure. Each entry contains 4 bytes (a red channel, a green channel, a blue channel, and a flags byte).</p>
<p>&nbsp;</p></body>
</HTML>
