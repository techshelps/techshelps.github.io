<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cooperative Levels</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_dx5_cooperative_levels_dsound"></a>Cooperative Levels</h3>
<p>
Because Windows is a multitasking environment, more than one application may be working with a device driver at any one time. Through the use of cooperative levels, DirectX makes sure that each application does not gain access to the device in the wrong way or at the wrong time. Each DirectSound application has a cooperative level that determines the extent to which it is allowed to access the device.</p>
<p>
After creating a DirectSound object, you must set the cooperative level for the device with the <a href="dsound_4e78.htm"><b>IDirectSound::SetCooperativeLevel</b></a> method before you can play sounds. </p>
<p>
The following example sets the cooperative level for the DirectSound device initialized at <a href="dsound_18f9.htm">Creating the DirectSound Object</a>. The <i>hwnd</i> parameter is the handle to the application window. </p>
<pre><code>HRESULT hr = lpDirectSound-&gt;lpVtbl-&gt;SetCooperativeLevel(
                      lpDirectSound, hwnd, DSSCL_NORMAL);
 </code></pre>
<p>
DirectSound defines four cooperative levels for sound devices: normal, priority, exclusive, and write-primary. Most applications will use the sound device at the normal cooperative level, which allows for orderly switching between applications that use the sound card. </p>
<h4>Normal Cooperative Level</h4>
<p>
At the normal cooperative level, the application cannot set the format of the <a href="glossary_33qr.htm#_dx5_primary_sound_buffer_glos">primary sound buffer</a>, write to the primary buffer, or compact the on-board memory of the device. All applications at this cooperative level use a primary buffer format of 22 kHz, stereo sound, and 8-bit samples, so that the device can switch between applications as smoothly as possible. </p>
<h4>Priority Cooperative Level</h4>
<p>
When using a DirectSound device with the priority cooperative level, the application has first rights to hardware resources, such as hardware mixing, and can set the format of the primary sound buffer and compact the on-board memory of the device.</p>
<h4>Exclusive Cooperative Level</h4>
<p>
At the exclusive cooperative level, the application has all the privileges of the priority level. In addition, when the application is in the foreground, its buffers are the only ones that are audible.</p>
<h4>Write-primary Cooperative Level</h4>
<p>
The highest cooperative level is write-primary. When using a DirectSound device with this cooperative level, your application has direct access to the primary sound buffer. In this mode, the application must write directly to the primary buffer. Secondary buffers cannot be played while this is going on.</p>
<p>
An application must be set to the write-primary level in order to obtain direct write access to the audio samples in the primary buffer. If the application is not set to this level, then all calls to the <a href="dsound_2c84.htm"><b>IDirectSoundBuffer::Lock</b></a> method for the primary buffer will fail.</p>
<p>
When your application is set to the write-primary cooperative level and gains the foreground, all secondary buffers for other applications are stopped and marked as lost. When your application in turn moves to the background, its primary buffer is marked as lost and must be restored when the application again moves to the foreground. For more information, see <a href="dsound_3ftw.htm">Buffer Management</a>.</p>
<p>
You cannot set the write-primary cooperative level if a DirectSound driver is not present on the user's system. To determine whether this is the case, call the <a href="dsound_8eec.htm"><b>IDirectSound::GetCaps</b></a> method and check for the DSCAPS_EMULDRIVER flag in the <a href="dsound_9144.htm"><b>DSCAPS</b></a> structure.</p>
<p>
For more information, see <a href="dsound_8qg4.htm">Access to the Primary Buffer</a>.</p>
<p>&nbsp;</p></body>
</HTML>
