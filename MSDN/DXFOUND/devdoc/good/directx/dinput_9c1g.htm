<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDirectInputDevice::SetCooperativeLevel</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dx5_idirectinputdevice_setcooperativelevel_dinput"></a>IDirectInputDevice::SetCooperativeLevel</h1>
<p>
The <b>IDirectInputDevice::SetCooperativeLevel</b> method establishes the cooperative level for this instance of the device. The cooperative level determines how this instance of the device interacts with other instances of the device and the rest of the system.</p>
<pre><code><b>HRESULT SetCooperativeLevel(
  HWND</b><i> hwnd</i><b>,     </b>
<b>  DWORD</b><i> dwFlags  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hwnd</i></dt>
<dd>
Window handle to be associated with the device. This parameter must be a valid top-level window handle that belongs to the process. The window associated with the device must not be destroyed while it is still active in a DirectInput device.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Flags that describe the cooperative level associated with the device. This parameter can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td colspan=2 width=100%>DISCL_BACKGROUND </td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=85%>The application requires background access. If background access is granted, the device may be acquired at any time, even when the associated window is not the active window. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DISCL_EXCLUSIVE </td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=85%>The application requires exclusive access. If exclusive access is granted, no other instance of the device may obtain exclusive access to the device while it is acquired. Note, however, non-exclusive access to the device is always permitted, even if another application has obtained exclusive access. </td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=85%>An application that acquires the mouse or keyboard device in exclusive mode should always unacquire the devices when it receives WM_ENTERSIZEMOVE and WM_ENTERMENULOOP messages. Otherwise, the user will not be able to manipulate the menu or move and resize the window. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DISCL_FOREGROUND </td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=85%>The application requires foreground access. If foreground access is granted, the device is automatically unacquired when the associated window moves to the background. </td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>DISCL_NONEXCLUSIVE </td>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=85%>The application requires non-exclusive access. Access to the device will not interfere with other applications that are accessing the same device. </td>
</tr>
</table><br>


<p>
Applications must specify either DISCL_FOREGROUND or DISCL_BACKGROUND; it is an error to specify both or neither. Similarly, applications must specify either DISCL_EXCLUSIVE or DISCL_NONEXCLUSIVE.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the method succeeds, the return value is DI_OK.</p>
<p>
If the method fails, the return value may be one of the following error values:</p>
<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%><a href="dinput_7yk4.htm#_dx5_dierr_invalidparam_dinput">DIERR_INVALIDPARAM</a></td>
</tr>
<tr valign=top>
<td width=100%><a href="dinput_7yk4.htm#_dx5_dierr_notinitialized_dinput">DIERR_NOTINITIALIZED</a> </td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
If the system mouse is acquired in exclusive mode, then the pointer will be removed from the screen until the device is unacquired.</p>
<p>
Applications must call this method before acquiring the device by using the <a href="dinput_2qlw.htm"><b>IDirectInputDevice::Acquire</b></a> method.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dinput.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use dinput.lib.</p>
<p>&nbsp;</p></body>
</HTML>
