<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDirectSoundBuffer::GetCurrentPosition</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dx5_idirectsoundbuffer_getcurrentposition_dsound"></a>IDirectSoundBuffer::GetCurrentPosition</h1>
<p>
The <b>IDirectSoundBuffer::GetCurrentPosition</b> method retrieves the current position of the play and write cursors in the <a href="glossary_5583.htm#_dx5_sound_buffer_glos">sound buffer</a>.</p>
<pre><code><b>HRESULT GetCurrentPosition(
  LPDWORD</b><i> lpdwCurrentPlayCursor</i><b>,  </b>
<b>  LPDWORD</b><i> lpdwCurrentWriteCursor  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpdwCurrentPlayCursor</i></dt>
<dd>
Address of a variable to contain the <a href="glossary_0xbn.htm#_dx5_current_play_position_glos">current play position</a> in the DirectSoundBuffer object. This position is an offset within the <a href="glossary_5583.htm#_dx5_sound_buffer_glos">sound buffer</a> and is specified in bytes. This parameter can be NULL if the current play position is not wanted.</dd>
<dt>
<i>lpdwCurrentWriteCursor</i></dt>
<dd>
Address of a variable to contain the <a href="glossary_0xbn.htm#_dx5_current_write_position_glos">current write position</a> in the DirectSoundBuffer object. This position is an offset within the sound buffer and is specified in bytes. This parameter can be NULL if the current write position is not wanted.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the method succeeds, the return value is DS_OK.</p>
<p>
If the method fails, the return value may be one of the following error values: </p>
<p>
<a href="dsound_9y3p.htm#_dx5_dserr_invalidparam_dsound">DSERR_INVALIDPARAM</a> <br>
<a href="dsound_9y3p.htm#_dx5_dserr_priolevelneeded_dsound">DSERR_PRIOLEVELNEEDED</a> </p>
<h4>Remarks</h4>
<p>
The write cursor indicates the position at which it is safe to write new data to the buffer. The write cursor always leads the play cursor, typically by about 15 milliseconds' worth of audio data. For more information, see <a href="dsound_4nl0.htm">Current Play and Write Positions</a>.</p>
<p>
It is always safe to change data that is behind the position indicated by the <i>lpdwCurrentPlayCursor</i> parameter.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dsound.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use dsound.lib.</p>
<h4>See Also</h4>
<p>
<a href="dsound_317o.htm"><b>IDirectSoundBuffer</b></a>, <a href="dsound_602s.htm"><b>IDirectSoundBuffer::SetCurrentPosition</b></a></p>
<p>&nbsp;</p></body>
</HTML>
