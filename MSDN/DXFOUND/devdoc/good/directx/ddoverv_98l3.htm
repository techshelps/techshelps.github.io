<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 3: Blitting the Off-Screen Surfaces to the Back Buffer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_dx5_step_3_blitting_the_off_screen_surfaces_to_the_back_buffer_ddraw"></a>Step 3: Blitting the Off-Screen Surfaces to the Back Buffer</h3>
<p>
The WM_TIMER message contains the code for writing to surfaces and <a href="glossary_2ysz.htm#_dx5_flipping_surface_glos">flipping surfaces</a>. In the case of DDEX3, it contains the following code to select the proper <a href="glossary_938z.htm#_dx5_off_screen_surface_glos">off-screen surface</a> and to blit it to the back buffer:</p>
<pre><code>rcRect.left = 0; 
rcRect.top = 0; 
rcRect.right = 640; 
rcRect.bottom = 480; 
if(phase) 
{ 
    pdds = lpDDSTwo; 
    phase = 0; 
} 
else 
{ 
    pdds = lpDDSOne; 
    phase = 1; 
} 
while(1) 
{ 
    ddrval = lpDDSBack-&gt;BltFast(0, 0, pdds, &amp;rcRect, FALSE); 
    if(ddrval == DD_OK) 
    { 
        break; 
    } 
 </code></pre>
<p>
The phase variable determines which <a href="glossary_938z.htm#_dx5_off_screen_surface_glos">off-screen surface</a> will be blitted to the <a href="glossary_6wtv.htm#_dx5_back_buffer_glos">back buffer</a>. The <a href="ddref_8nqv.htm"><b>IDirectDrawSurface3::BltFast</b></a> method is then called to blit the selected off-screen surface onto the back buffer, starting at position (0, 0), the upper-left corner. The <i>rcRect</i> parameter points to the <b>RECT</b> structure that defines the upper-left and lower-right corners of the off-screen surface that will be blitted from. The last parameter is set to FALSE (or 0), indicating that no specific transfer flags are used.</p>
<p>
Depending on the requirements of your application, you could use either the <a href="ddref_6ref.htm"><b>IDirectDrawSurface3::Blt</b></a> method or the <b>IDirectDrawSurface::BltFast</b> method to blit from the off-screen buffer. If you are performing a blit from an off-screen plain buffer that is in display memory, you should use <b>IDirectDrawSurface3::BltFast</b>. Although you will not gain speed on systems that use <a href="glossary_0zsj.htm#_dx5_hardware_blitter_glos">hardware blitter</a> on their display adapters, the blit will take about 10 percent less time on systems that use hardware emulation to perform the blit. Because of this, you should use <b>IDirectDrawSurface3::BltFast</b> for all display operations that blit from display memory to display memory. If you are blitting from system memory or require special hardware flags, however, you have to use <b>IDirectDrawSurface3::Blt</b>.</p>
<p>
After the <a href="glossary_938z.htm#_dx5_off_screen_surface_glos">off-screen surface</a> is loaded in the <a href="glossary_6wtv.htm#_dx5_back_buffer_glos">back buffer</a>, the back buffer and the <a href="glossary_33qr.htm#_dx5_primary_surface_glos">primary surface</a> are flipped in much the same way as shown in the previous tutorials.</p>
<p>&nbsp;</p></body>
</HTML>
