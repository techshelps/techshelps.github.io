<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDirectInputEffect::Initialize</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dx5_idirectinputeffect_initialize_dinput"></a>IDirectInputEffect::Initialize</h1>
<p>
The <b>IDirectInputEffect::Initialize</b> method initializes a DirectInputEffect object.</p>
<pre><code><b>HRESULT Initialize(
  HINSTANCE</b><i> hinst</i><b>,  </b>
<b>  DWORD</b><i> dwVersion</i><b>,  </b>
<b>  REFGUID</b><i> rguid     </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hinst</i></dt>
<dd>
Instance handle to the application or DLL that is creating the DirectInputEffect object. DirectInput uses this value to determine whether the application or DLL has been certified and to establish any special behaviors that may be necessary for backwards compatibility. It is an error for a DLL to pass the handle of the parent application. </dd>
<dt>
<i>dwVersion</i></dt>
<dd>
Version number of DirectInput for which the application is designed. This value will normally be DIRECTINPUT_VERSION. Passing the version number of a previous version will cause DirectInput to emulate that version. For more information, see <a href="dinput_8gfo.htm">Designing for Previous Versions of DirectInput</a>.</dd>
<dt>
<i>rguid</i></dt>
<dd>
Identifier of the effect with which the interface is associated. The <a href="dinput_3i5w.htm"><b>IDirectInputDevice2::EnumEffects</b></a> method can be used to determine which effect GUIDs are supported by the device.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the method succeeds, the return value is DI_OK.</p>
<p>
If the method fails, the return value may be <a href="dinput_7yk4.htm#_dx5_dierr_devicenotreg_dinput">DIERR_DEVICENOTREG</a>.</p>
<h4>Remarks</h4>
<p>
If this method fails, the underlying object should be considered to be an indeterminate state and needs to be reinitialized before it can be subsequently used.</p>
<p>
The <a href="dinput_92d0.htm"><b>IDirectInputDevice2::CreateEffect</b></a> method automatically initializes the effect after creating it. Applications normally do not need to call the <b>Initialize</b> method.</p>
<p>
In C++ the <i>rguid</i> parameter must be passed by reference; in C, which does not have pass-by-reference, it must be passed by address. The following is an example of a C++ call:</p>
<pre><code>lpeff-&gt;Initialize(g_hinstDll, DIRECTINPUT_VERSION, GUID_Effect);
 </code></pre>
<p>
The following shows the same call in C:</p>
<pre><code>lpeff-&gt;lpVtbl-&gt;Initialize(lpeff, g_hinstDll, 
                          DIRECTINPUT_VERSION, &amp;GUID_Effect);
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later. Available as a redistributable for Windows 95.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in dinput.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use dinput.lib.</p>
<p>&nbsp;</p></body>
</HTML>
