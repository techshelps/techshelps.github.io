<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Migration Algorithm</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="remigthemigrationalgorithm"></a>The Migration Algorithm</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="ReMigTechnicalNotes; ReMigMappingIssues ">
</object><a href=JavaScript:alink_1.Click()>See Also</a></p>
<p>
The Migration Wizard uses the Repository 2.0 engine to create Microsoft Repository 2.0 tables. Pure SQL Data Manipulation Language (DML) and Data Definition Language (DDL) are used to move all the Repository information — both Information Models and instance data.</p>
<h2>The General Flow</h2>
<p>
The following sections describe the algorithm that converts Repository 1.0 to Repository 2.0.</p>
<h4>Application Startup</h4>
<ul>
<li>
Ascertain nationality.<br><br></li>
<li>
Load the correct localization resource file.</li>
</ul>
<h4>ODBC Initialization</h4>
<ul>
<li>
Determine all DSNs defined to the machine.</li>
</ul>
<h4>Preparation</h4>
<ul>
<li>
Read Type Information Model control tables to acquire any other Type Information Model tables and column definitions.<br><br></li>
<li>
If any Repository 2.0 tables exist, destroy them, then recreate them.</li>
</ul>
<h4>Copy Type Information Model </h4>
<ul>
<li>
Allow Repository 2.0 engine to build Type Information Model.<br><br></li>
<li>
Add any Repository 1.0 Information Models into the Repository 2.0.<br><br></li>
<li>
Synchronize all relationships.<br><br></li>
<li>
Convert <b>RTblObjects</b> into <b>RTblVersions</b> and set the values of <b>Z_VE_Z </b>and <b>Z_BranchID_Z </b>to zero.<br><br></li>
<li>
Verify that no additional columns are defined in the Repository 1.0 Type Information Model tables; provide an error message if additional data is found.</li>
</ul>
<h4>Copy Information Models </h4>
<ul>
<li>
Copy data in Repository 1.0 tables using SQL <b>SELECT</b>/<b>INSERT</b> statements.<br><br></li>
<li>
All inserts use default version and branch information.</li>
</ul>
<h2>Table Mapping</h2>
<table border=1 cols=2 frame=box rules=all width=308>
<tr valign=top>
<td width=46%><b>Version 1 </b></td>
<td width=54%><b>Version 2</b></td>
</tr>
<tr valign=top>
<td width=46%>RtblClassDefs</td>
<td width=54%>RTblClassDefs</td>
</tr>
<tr valign=top>
<td width=46%>RtblIfaceDefs</td>
<td width=54%>RTblIfaceDefs</td>
</tr>
<tr valign=top>
<td width=46%>RtblIfaceMem</td>
<td width=54%>RTblIfaceMem</td>
</tr>
<tr valign=top>
<td width=46%>RtblITimestamp</td>
<td width=54%>RTblITimestamp</td>
</tr>
<tr valign=top>
<td width=46%>RtblNamedObj</td>
<td width=54%>RTblNamedObj</td>
</tr>
<tr valign=top>
<td width=46%>RtblObjects</td>
<td width=54%>RTblVersions</td>
</tr>
<tr valign=top>
<td width=46%>RtblPropDefs</td>
<td width=54%>RTblPropDefs</td>
</tr>
<tr valign=top>
<td width=46%>RtblProps</td>
<td width=54%>RTblProps</td>
</tr>
<tr valign=top>
<td width=46%>RtblRelColDefs</td>
<td width=54%>RTblRelColDefs</td>
</tr>
<tr valign=top>
<td width=46%>RtblRelColPairs</td>
<td width=54%>RTblRelColPairs</td>
</tr>
<tr valign=top>
<td width=46%>RtblRelshipProps</td>
<td width=54%>RTblRelshipProps</td>
</tr>
<tr valign=top>
<td width=46%>RtblRelships</td>
<td width=54%>RTblRelships</td>
</tr>
<tr valign=top>
<td width=46%>RtblRoot</td>
<td width=54%>RTblRoot</td>
</tr>
<tr valign=top>
<td width=46%>RtblSites</td>
<td width=54%>RTblSites</td>
</tr>
<tr valign=top>
<td width=46%>RtblTypeLibs</td>
<td width=54%>RTblTypeLibs</td>
</tr>
<tr valign=top>
<td width=46%>None needed</td>
<td width=54%>RTblWorkspaceItems</td>
</tr>
</table><br>
<p>
<b>Notes</b>
<ol type=1>
<li>
For each row in <b>RTblObjects</b> table, the Migration Wizard creates one row in the <b>RTblVersions</b> table.<br><br></li>
<li>
The <b>RTblWorkspaceItems</b> table is created with no rows.</li>
</ol>
</BODY>
</HTML>
