<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IVoiceCmd::Register</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>IVoiceCmd::Register</H2><P></P>
<P>HRESULT Register(PTSTR pszSite, PIVCMDNOTIFYSINK pNotifyInterface,<BR>  IID IIDNotifyInterface, DWORD dwFlags, PVCSITEINFO pSiteInfo);</P>
<P></P>
<P>Registers an application to use voice commands on a site. An application must call this function before it can use voice commands.</P>
<P> <FONT FACE="Symbol">·</FONT>    Returns NOERROR if successful, or one of these error values:</P>
<P>E_INVALIDARG<BR>VCMDERR_CANTCREATEAUDIODEVICE<BR>VCMDERR_CANTCREATESRENUM<BR>VCMDERR_CANTSELECTENGINE<BR>VCMDERR_CANTSETDEVICE<BR>VCMDERR_INVALIDMODE<BR>VCMDERR_NOFINDINTERFACE<BR>VCMDERR_NOSITEINFO<BR>VCMDERR_OUTOFMEM<BR>VCMDERR_SRFINDFAILED<BR>VCMDERR_VALUEOUTOFRANGE</P>
<P></P>
<P>pszSite</P>
<P>[in] Address of a string that identifies the site the application wants to use. This parameter can be a null string ("") or NULL to use the computer, or "LineX" to use a phone line, where "X" is the number of the line. The site identifier is used to save settings for the site in the registry so that they remain in effect the next time an application registers to use the site. The site identifier can also be used to restore settings from the registry. If a site has not been used, the default attributes are likely to be set for the computer. All applications on a site share the attributes of that site, such as the instance of the speech-recognition engine.</P>
<P>-If a particular site (such as "LineX") requires an input device other than the default, the device must be set the first time the site is used. You can use the <B>IVCmdAttributes::DeviceSet</B> member function to set the device or specify the device in the <B>VCSITEINFO</B> structure pointed to by pSiteInfo. During subsequent registrations, this same device is used unless it is changed by using <B>DeviceSet</B>.</P>
<P></P>
<P>pNotifyInterface</P>
<P>[in] Address of the notification interface that receives notifications from the voice-command object. The interface identifier is specified by IIDNotifyInterface. If this parameter is NULL,<B> </B>no notifications will be sent.</P>
<P>Because passing the pointer to the voice-command object does not transfer ownership of the notification interface, the voice-command object must call the <B>AddRef</B> member function of the notification interface before returning from the call to <B>Register</B>. The voice-command object must also call the <B>Release</B> member function of the notification interface when it closes. The calling application must release any reference counts it holds on the notification interface after calling <B>Register</B>, unless it needs the notification object to be valid when the voice-command object releases it. </P>
<P></P>
<P>IIDNotifyInterface</P>
<P>[in] GUID that uniquely identifies the type of notification sink being passed to the voice-command object. It must be IID_IVCmdNotifySinkA (for ANSI) or IID_IVCmdNotifySinkW (for Unicode).</P>
<P></P>
<P>dwFlags</P>
<P>[in] Flag that indicates whether the application is to receive all notifications. This parameter can be one of these values:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="161pt" VALIGN="TOP"><COL WIDTH="173pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Value</P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>VCMDRF_ALLMESSAGES</P></TD><TD VALIGN="TOP"><P>Sends all notifications to <I>pNotifyInterface</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>VCMDRF_ALLBUTVUMETER</P></TD><TD VALIGN="TOP"><P>Sends all but VUMeter notifications to <I>pNotifyInterface</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>VCMDRF_VUMETER</P></TD><TD VALIGN="TOP"><P>Sends VUMeter notifications to <I>pNotifyInterface</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P>VCMDRF_NOMESSAGES</P></TD><TD VALIGN="TOP"><P>Does not send notifications.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>If <I>dwFlags</I> is 0 (zero) or NULL, only the <B>IVCmdNotifySink::CommandRecognize</B> notification is sent.</P>
<P>pSiteInfo</P>
<P>[in] Address of a <B>VCSITEINFO </B>structure that contains settings to apply to the site, such as the speaker, confidence threshold, and speech-recognition mode. The settings are applied even if the site is already open. If this parameter is NULL, the voice-command object uses the settings from the registry. If there are no registry settings, it uses the default settings, typically those for the computer.</P>
<P>Telephony applications will pass this information to ensure that the proper settings are selected. Other applications will set this parameter to NULL to leave the site settings unchanged from previous values.</P>
<P></P>
<P>An application cannot call <B>Register</B> a second time for the same voice-command object. If a voice-command object is already registered, calling <B>Register</B> returns an error. To change sites, the application must call <B>CoCreateInstance</B> to create a new voice-command object for the desired site.</P>
<P>An application must call <B>Register</B> before it can call any of the following member functions:</P>
<P><B>IVCmdMenu::Deactivate<BR>IVCmdMenu::ListGet<BR>IVCmdMenu::ListSet<BR>IVCmdMenu::TrainMenuDlg<BR></B>Any <B>IVCmdDialogs</B> member function</P></FONT></BODY></HTML>
