<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IVoiceText::Register</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>IVoiceText::Register</H2><P></P>
<P>HRESULT Register(PTSTR pszSite, PTSTR pszApplication, <BR>    PIVTXTNOTIFYSINK pNotifyInterface, IID IIDNotifyInterface,<BR>    DWORD dwFlags, PVTSITEINFO pSiteInfo);</P>
<P></P>
<P>Registers an application to use voice text on a site.</P>
<P> <FONT FACE="Symbol">·</FONT>    Returns NOERROR if successful, or one of these error values:</P>
<P>VTXTERR_INVALIDPARAM<BR>VTXTERR_OUTOFMEM</P>
<P></P>
<P><I>pszSite</I></P>
<P>[in] Address of a string identifying the voice-text site that the application needs to use. This parameter can be a null string (" ") or NULL to use the computer, or "LineX" to use a phone line, where "X" is the number of the line. The site identifier is used to save settings for the site in the registry so that they remain in effect the next time an application registers to use the site. The site identifier can also be used to restore settings from the registry. If a site has not been used, the default attributes are likely to be set for the computer. All applications on a site share the attributes of the site, such as the instance of the text-to-speech engine.</P>
<P>If a particular site (such as "LineX") requires an output device other than the default, the device must be set the first time the site is used. To set the device, an application can use the <B>IVTxtAttributes::DeviceSet</B> member function, or specify the device in the <B>VTSITEINFO</B> structure pointed to by this parameter. During subsequent registrations, the same device is used unless it is changed using <B>DeviceSet</B>.</P>
<P></P>
<P><I>pszApplication</I></P>
<P>[in] Address of a string that identifies the application — for example, "Microsoft Word." An application can use this information to display the source of text. This parameter must not be NULL.</P>
<P></P>
<P><I>pNotifyInterface</I></P>
<P>[in] Address of the notification interface through which the voice-text object notifies the application about text-to-speech information. If this parameter is NULL, no notifications will be sent. The interface identifier is specified by <I>IIDNotifyInterface</I>.</P>
<P>Because passing the pointer to the voice-text object does not transfer ownership of the notification interface, the voice-text object must call the <B>AddRef</B> member function of the notification interface before returning from the call to <B>Register</B>. The voice-text object must also call the <B>Release </B>member function of the notification interface when it closes. The calling application must release any reference counts it holds on the notification interface after calling <B>Register</B>, unless it needs the notification object to be valid when the voice-text object releases it. </P>
<P></P>
<P><I>IIDNotifyInterface</I></P>
<P>[in] GUID of the interface used for notification. This parameter must be IID_IVTxtNotifySinkA (for ANSI) or IID_IVTxtNotifySinkW (for Unicode).</P>
<P></P>
<P><I>dwFlags</I></P>
<P>[in] Flag that indicates whether the application is to receive all notifications. If this parameter is the VTXTF_ALLMESSAGES value, all notifications are sent to <I>pNotifyInterface</I>. If this parameter is zero (0) or null, only the <B>IVTxtNotifySink::SpeakingStarted</B> and <B>IVTxtNotifySink::SpeakingDone</B> notifications are sent.</P>
<P></P>
<P><I>pSiteInfo</I></P>
<P>[in] Address of a <B>VTSITEINFO </B>structure that contains settings to apply to the site, such as the voice and talking speed. The settings are applied, even if the site is already open. If a <B>VTSITEINFO</B> structure is not specified, the voice-text object uses the settings from the registry. If there are no registry settings, it uses the default settings, typically those for the computer. </P>
<P>Telephony applications pass this information to ensure that the proper settings are selected. Other applications will set this parameter to NULL to leave the site settings unchanged.</P>
<P></P>
<P>An application must call <B>Register</B> before it can call other functions in the <B>IVoiceText</B> interface or any function in the <B>IVTxtDialogs</B> interface. </P>
<P>An application cannot call <B>Register</B> a second time for the same voice-text object. To change sites, the application must call the <B>CoCreateInstance</B> function to create a new voice-text object for the desired site.</P>
<P></P></FONT></BODY></HTML>
