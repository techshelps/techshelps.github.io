<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Voice-Navigation Applications</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>Voice-Navigation Applications</H2><P>Speech-recognition engines and text-to-speech engines provide dialog boxes that enable the user to configure the engine. An application can direct an engine to display one of its dialog boxes by using the <B>IVCmdDialogs</B> or <B>IVTxtDialogs </B>interface. However, if a voice-navigation application, such as Microsoft Voice, is running, an application does not need to use these interfaces because the voice-navigation application gives the user access to the engine's dialog boxes. </P>
<P>At a minimum, a voice-navigation application has the following characteristics:</P>
<P> <FONT FACE="Symbol">·</FONT>    Allows the user to turn voice commands and voice text on and off and allows access to engine dialog boxes and attribute settings, such as the awake and enabled states. </P>
<P> <FONT FACE="Symbol">·</FONT>    Provides feedback that tells the user whether the voice-command or voice-text capability is on or off and, optionally, the current state of the voice-command and voice-text objects.</P>
<P></P>
<P>An application should assume that a voice-navigation application is always present in the system. An application can determine if a voice-navigation application is running by checking the value of the <B>UseSpeech</B> registry entry located under <B>HKEY_CURRENT_USER</B>\<B>Software</B>\<B>Voice</B> key. <B>UseSpeech</B> is TRUE if a voice-navigation application is running. If <B>UseSpeech</B> if FALSE or not present in the registry, there is no voice-navigation application. (The <B>UseSpeech</B> entry is not present if no speech software is installed in the system.)</P>
<P>When the user turns speech on or off, the voice-navigation application must change the value of the <B>UseSpeech</B> entry and broadcast the WM_SPEECHSTARTED or WM_SPEECHENDED message to all top-level windows. Changing the entry and broadcasting the messages is best accomplished by using a control panel application.</P>
<P>If <B>UseSpeech</B> is FALSE when an application starts, but the application requires speech to be useful, it should display a dialog box asking the user to turn on speech and then exit. An application that is useful even without speech features should just start without loading its speech code.</P>
<P>If <B>UseSpeech</B> is TRUE when the application starts, it should use the current attribute settings of its voice-command and voice-text sites and defer changing settings to the voice-navigation application. For sites other than the system speaker, the application should provide an interface that allows the user to adjust the attributes.</P>
<P>You can provide your own voice-navigation application, or you can rely on one supplied by a third party for voice-navigation features. Applications that only use telephony features or send speech output to a device other than the primary sound card can ignore the <B>UseSpeech</B> entry. </P></FONT></BODY></HTML>
