<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handing Echo Cancellation</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Handing Echo Cancellation</H3><P>If an engine is recognizing speech input from the computer's microphone while speaking output over an audio speaker on that computer, the engine may recognize its own output as input. The same problem occurs over telephone lines. However, the engine can act as if the computer's output signal has been removed and echo-cancellation has been done on any digital-audio data passed to the engine. </P>
<P>The audio driver that handles the output to the attached speakers and the input from the microphone prevents this echoing problem by removing the output signal (referred to as echo cancellation). Echo cancellation is best left to the audio driver because:</P>
<P> <FONT FACE="Symbol">·</FONT>    The speech-recognition engine should be hardware-independent. If the engine performed its own echo cancellation, it would need to receive the digital-audio stream from the computer's speaker or telephone line.</P>
<P> <FONT FACE="Symbol">·</FONT>    Every application that plays digital audio cannot be expected to forward all audio through the speech-recognition engine because multimedia drivers do not guarantee synchronization of the digital input with the digital output. Only the driver can guarantee the synchronization of the analog-to-digital converter (ADC) and the digital-to-analog converter (DAC).</P>
<P> <FONT FACE="Symbol">·</FONT>    The sampling rate of the output wave may differ from the input source. The volume level and waveform-audio format can also differ.</P>
<P> <FONT FACE="Symbol">·</FONT>    Even if these issues were resolved, there are other ways to produce audio from a computer, such as with music synthesis.</P>
<P></P>
<P>The following mechanisms for echo canceling exist:</P>
<P> <FONT FACE="Symbol">·</FONT>    Assume that the audio source is already echo canceled and that the computer will not be hearing itself.</P>
<P> <FONT FACE="Symbol">·</FONT>    Because many engines are already working in the frequency domain, some engines may be able to do their own echo canceling if they know what's being summed with the input channel. Engines that can do this should invent a new waveform-audio format and register it with Multimedia Systems. The waveform-audio format should contain two channels, one with the input signal and the other with the signal being summed/output to the channel. </P>
<P>When an engine starts, it tries to call the <B>IAudio::WaveFormatSet</B> member function with the custom format. If the hardware drivers that the engine is connecting to can handle the format, the drivers can return the echo information. Audio sources that cannot provide echo-canceling features return an AUDERR_WFNOTSUPPORTED error. The engine can then attempt to open the device with a more traditional format, like PCM mono.</P>
<P></P></FONT></BODY></HTML>
