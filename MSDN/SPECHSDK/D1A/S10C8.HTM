<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UseSpeech Registry Entry</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>UseSpeech Registry Entry</H2><P>Some users do not wish to have the computer speak or to talk to the computer. These users can indicate their preferences by using a voice-navigation application, which records their preferences in the registry. Microsoft Voice is an example of a voice-navigation application. An application can check the value of this entry before trying to load its voice-command or voice-text code and can save memory by not loading the code if it is not needed.</P>
<P>An application that uses voice commands or voice text on the local computer (not necessarily over the telephone) should check the following registry entry.</P>
<P><B>HKEY_CURRENT_USER\Software\Voice\UseSpeech</B></P>
<P><B>UseSpeech</B> is a <B>DWORD</B> value under the <B>Voice</B> key that is TRUE if the user has turned on speech recognition or text-to-speech using the installed voice-navigation application. An application should assume that the value is FALSE if the <B>UseSpeech</B> entry is not in the registry. </P>
<P>If the value of <B>UseSpeech</B> is FALSE when the application starts, it should not call the <B>CoCreateInstance</B> function for the CLSID_VCmd or CLSID_VTxt class identifier.</P>
<P>An application can use the following code to obtain the value of <B>UseSpeech</B> from the registry.</P>
<P>HKEY  hKey;</P>
<P>DWORD dwValue, dwType = REG_DWORD, dwSize = sizeof(DWORD);</P>
<P></P>
<P>if (RegOpenKeyEx(HKEY_CURRENT_USER, "Software\\Voice", 0, KEY_READ, </P>
<P>        &amp;hKey) == ERROR_SUCCESS) {</P>
<P>    RegQueryValueEx(hKey, "UseSpeech", 0, &amp;dwType, (LPBYTE) &amp;dwValue, </P>
<P>        &amp;dwSize);</P>
<P>    RegCloseKey(hKey);</P>
<P>}</P>
<P></P>
<P>Whenever speech is turned on or off, the voice-navigation application sends the WM_SPEECHSTARTED or WM_SPEECHENDED message to all top-level windows in the system. An application can use these messages to determine when to dynamically create or release instances of its voice-command or voice-text objects. Although highly recommended, the use of these messages by applications is optional. These messages are not defined in the SPEECH.H header file. You can use the <B>RegisterWindowMessage</B> function to obtain the message identifiers to use in your application.</P></FONT></BODY></HTML>
