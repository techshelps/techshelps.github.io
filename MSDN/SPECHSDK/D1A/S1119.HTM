<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Defining Additional Interfaces</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Defining Additional Interfaces</H3><P>An engine can provide additional functionality to an application by supporting custom interfaces. These can be used to expose features not yet supported by the text-to-speech API. To do this:</P>
<P> <FONT FACE="Symbol">·</FONT>    Define an interface that follows the OLE COM and that contains all of the functions necessary to support the additional functionality.</P>
<P> <FONT FACE="Symbol">·</FONT>    Provide marshaling for the interface so the engine can run in a different process than the calling application.</P>
<P> <FONT FACE="Symbol">·</FONT>    Enable the engine to return a pointer to the interface when the engine receives a call of the <B>IUnknown::QueryInterface</B> member function for that interface.</P>
<P> <FONT FACE="Symbol">·</FONT>    Provide documentation for the interface so that application developers can take advantage of it.</P>
<P>The main thread of any engine and audio object runs at the priority of the thread that created the engine or object. Following are four general rules that an engine should follow with regards to thread priorities:</P>
<P>    1.    An engine should not adjust the priority of the thread that created the engine. </P>
<P>    2.    A multithreaded engine may run one or more threads at a higher priority than its main thread.</P>
<P>    3.    An engine may check the priority of the calling thread for hints about what priority to use for the threads that the engine creates.</P>
<P>    4.    An engine should avoid boosting priorities except under the circumstances described in documentation included with the Microsoft Win32 Software Development Kit (SDK).</P></FONT></BODY></HTML>
