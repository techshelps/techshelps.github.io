<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ANSI and Unicode Versions of Speech Interfaces and Structures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>ANSI and Unicode Versions of Speech Interfaces and Structures</H2><P>In the speech API, every interface and structure that uses strings, and every structure that contains strings, actually has two versions: ANSI and Unicode. Each version is identified by a one-character suffix to the interface or structure name: A for ANSI and W for Unicode. (This is similar to the way Windows NT handles ANSI/Unicode portability.) For example, the two versions of the <B>IAudioSource</B> interface are <B>IAudioSourceA</B> for ANSI and <B>IAudioSourceW</B> for Unicode.</P>
<P>The ANSI version of an interface or structure supports characters (TCHAR) as one-byte ANSI or multibyte characters. The Unicode version supports characters as two-byte Unicode. The two interfaces have different GUIDs.</P>
<P>Typically, an application does not need to specify which version to use, because the base name of the interface or structure is automatically mapped to either ANSI or Unicode as follows:</P>
<P> <FONT FACE="Symbol">·</FONT>    The name of an interface or structure is ordinarily mapped to the ANSI version. For example, an application that specifies <B>SRMODEINFO</B> gets <B>SRMODEINFOA</B>.</P>
<P> <FONT FACE="Symbol">·</FONT>    If the application declares Unicode as its default (#define _S_UNICODE), the name of the interface or structure is mapped to the Unicode version. In this case, an application that specifies <B>SRMODEINFO</B> gets <B>SRMODEINFOW</B>.</P>
<P>If the application needs the version that is not automatically mapped, it must specify that version explicitly. For more information about Unicode in Windows-based applications, see the Win32 SDK.</P></FONT></BODY></HTML>
