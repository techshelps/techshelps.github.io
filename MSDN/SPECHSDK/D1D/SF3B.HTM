<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Grammar Object Creation</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Grammar Object Creation</H3><P>After the application loads the grammar description into memory (or into a memory-mapped file), it loads the grammar by using the <B>ISRCentral::GrammarLoad</B> member function. When calling <B>GrammarLoad</B>, the application indicates the type of the grammar (context-free, dictation, or limited-domain) and its format (standard or engine-native). The application also specifies an <B>SDATA</B> structure that contains the address of the beginning of the grammar memory, and a value that indicates the number of bytes in the grammar data. </P>
<P>Optionally, an application can specify the address of an <B>ISRGramNotifySink</B> interface that the grammar object uses to notify the application of recognition events, and to pass information about the event to the application. To receive recognition notifications, an application must create a COM object that supports the <B>ISRGramNotifySink</B> interface. When a recognition event occurs, the grammar object notifies the application by calling the appropriate member function of the <B>ISRGramNotifySink</B> interface. You determine how the application responds to notifications. For more information about the <B>ISRGramNotifySink</B> interface, see "Grammar-Specific Notifications" later in this section.</P>
<P>When the application calls the <B>GrammarLoad </B>member function, the engine compiles the binary format into an internal format that the engine understands. Compiling the grammar may take some time, perhaps several seconds. If the grammar uses any features that the mode cannot support, such as links and lists, the <B>GrammarLoad</B> member function returns an error.</P>
<P>After the engine compiles the grammar into its own format, it creates a grammar object used to control the grammar. The grammar object supports several interfaces, including <B>IUnknown</B> and <B>ISRGramCommon</B>. Grammar objects attached to context-free grammars also support the <B>ISRGramCFG </B>interface. </P>
<P>If the grammar cannot be loaded because it is too complex or too large, or if it requires features not supported by the engine, the <B>GrammarLoad</B> member function returns an error. If the function succeeds, the fifth parameter receives the address of an <B>IUnknown</B> interface on the grammar object. An application can use the <B>IUnknown</B> interface to retrieve addresses of other interfaces supported by the grammar object.</P></FONT></BODY></HTML>
