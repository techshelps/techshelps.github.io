<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ISRGramCommon::Activate</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>ISRGramCommon::Activate</H2><P></P>
<P>HRESULT Activate(HWND hWndListening, BOOL fAutoPause, PTCHAR pszInfo);</P>
<P></P>
<P>Activates a grammar so that the speech-recognition engine can begin using the grammar to recognize speech.</P>
<P> <FONT FACE="Symbol">·</FONT>    Returns NOERROR if successful, or one of these error values:</P>
<P>E_INVALIDARG<BR>E_OUTOFMEMORY<BR>SRERR_GRAMMARTOOCOMPLEX<BR>SRERR_INVALIDRULE<BR>SRERR_INVALIDWINDOW<BR>SRERR_RULEALREADYACTIVE</P>
<P></P>
<P><I>hWndListening</I></P>
<P>[in] Handle of the window for which this grammar should be used for recognition. This window is compared against the window returned by the <B>GetForegroundWindow</B> function at the beginning of the speech. If the windows match, the grammar is used; if they don't match, the grammar is not used. If <I>hWndListening</I> is NULL, the grammar is used continuously, which allows the application to recognize a global vocabulary. However, in case of a recognition conflict, a grammar whose <I>hWndListening</I> parameter is NULL has a lower priority than a grammar whose <I>hWndListening</I> parameter matches the foreground window. If the window is invalid, the member function returns E_INVALIDARG.</P>
<P></P>
<P><I>fAutoPause</I></P>
<P>[in] TRUE if the engine should automatically pause when this grammar is involved in a recognition (whether successful or unsuccessful) and send a <B>PhraseFinish</B> notification to the application. FALSE if the engine should not pause for this grammar. (The engine pauses once for any grammar for which this parameter is TRUE.) Even if more than one rule of a context-free grammar is active, this still increases the pause count by only 1.</P>
<P></P>
<P><I>pszInfo</I></P>
<P>[in] For a dictation or limited-domain grammar, this parameter is not used and should be NULL. For a context-free grammar, this parameter points to the name of the rule to activate. If the rule is already activated, this parameter is ignored. More than one rule can be active at a time; however, too many active rules can diminish recognition accuracy. If <I>pszInfo</I> is NULL for a context-free grammar, it activates the rule that has the rule name of "Start." If the rule is already active, the <B>Activate</B> member function returns an error.</P>
<P></P>
<P>Many engines restrict the number and type of grammars that can be active at the same time. Typically, an engine allows many context-free grammars but only one dictation or limited-domain grammar to be active at a time.</P>
<P>Because speaking is asynchronous, changes to the active grammar must be made before the speaker begins to speak. Changing the active grammar during speech may not have any effect until after the utterance ends. In addition, the engine may respond as if it has activated a grammar and postpone its real activation until an opportune time, such as when an utterance stops.</P>
<P>If any rule in a grammar has the auto-pause flag set, and the grammar has at least one rule active, the pause count is increased by 1 after a <B>PhraseFinish</B> notification. If multiple rules have the auto-pause flag set, the pause count is still increased only by 1. Likewise, only one <B>ISRGramNotifySink::Paused</B> notification is sent, even if more than one rule has the auto-pause flag set.</P></FONT></BODY></HTML>
