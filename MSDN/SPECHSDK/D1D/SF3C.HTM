<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Grammar Activation</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Grammar Activation</H3><P>For a speech-recognition engine to begin actively recognizing the words from a grammar, the application must activate the grammar by calling the <B>ISRGramCommon::Activate</B> member function, using the following syntax:</P>
<P>pISRGramCommon-Activate(NULL, FALSE, szRule);</P>
<P></P>
<P>This member function works only if the application has previously obtained the address of  the <B>ISRGramCommon</B> interface by calling the <B>IUnknown::QueryInterface</B> member function on the grammar object.</P>
<P>In this call, the <I>szRule</I> parameter is the name of the context-free grammar rule to activate, as specified by an <B>SRCFGXRULE</B> structure. If the rule is already active or cannot be found, the <B>Activate</B> member function returns an error. (NULL causes the grammar to be active continuously rather than when a particular window is active, and FALSE ensures that the engine does not pause after this grammar is involved in a recognition.)</P>
<P>When the application calls the <B>Activate</B> member function, the engine starts the audio source if it is not already started and begins recognizing from it. If the engine is currently processing some audio, the grammar may not be activated until the next period of silence. Recognition continues until the application calls the <B>Deactivate</B> member function.</P>
<P>If the application specifies the handle of a window instead of NULL when calling the <B>Activate </B>member function, the engine "listens" for the grammar only when the specified window is the foreground window (that is, when the <B>GetForegroundWindow</B> function returns the window's handle). When a different window takes the foreground, the engine stops listening for the grammar. This saves the application from having to activate and deactivate a grammar whenever the application window gains and loses the foreground.</P>
<P>If the application passes TRUE with the <B>Activate</B> member function instead of FALSE, the engine pauses processing after the <B>ISRGramNotifySink::PhraseFinish</B> member function returns. This provides time for the application to process the recognition result and change the grammar. The application must call the <B>ISRCentral::Resume</B> member function to allow the engine to begin processing again.</P></FONT></BODY></HTML>
