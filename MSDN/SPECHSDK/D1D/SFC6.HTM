<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ISRGramNotifySink::PhraseFinish</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>ISRGramNotifySink::PhraseFinish</H2><P></P>
<P>HRESULT PhraseFinish(DWORD dwFlags, QWORD qTimeStampBegin, </P>
<P>    QWORD qTimeStampEnd, PSRPHRASE pSRPhrase, <BR>    PIUNKNOWN pIUnknownResult);</P>
<P></P>
<P>Informs the application that the speaker has finished a phrase and the speech-recognition engine is certain about the words that were spoken.</P>
<P> <FONT FACE="Symbol">·</FONT>    Return value is ignored.</P>
<P></P>
<P><I>dwFlags</I></P>
<P>[in] This parameter can be one or both of the following values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="151pt" VALIGN="TOP"><COL WIDTH="182pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Value</P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ISRNOTEFIN_RECOGNIZED</P></TD><TD VALIGN="TOP"><P>The recognition was above the threshold set with the <B>ISRAttributes::ThresholdSet </B>member function. If this flag is not set, the engine did not have enough confidence in the recognition, and it should be declared as an "unknown utterance."</P></TD></TR><TR><TD VALIGN="TOP"><P>ISRNOTEFIN_THISGRAMMAR</P></TD><TD VALIGN="TOP"><P>This grammar had the highest score of all active grammars and claimed the recognition. If this flag is not set, another grammar had a higher score and claimed the recognition.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>For an application to accept a recognition as valid, both ISRNOTEFIN_RECOGNIZED and ISRNOTEFIN_THISGRAMMAR should be set.</P>
<P></P>
<P><I>qTimeStampBegin</I></P>
<P>[in] Time, in bytes, when the phrase began. Most applications ignore this parameter.</P>
<P></P>
<P><I>qTimeStampEnd</I></P>
<P>[in] Time, in bytes, when the phrase ended. Most applications ignore this parameter.</P>
<P></P>
<P><I>pSRPhrase</I></P>
<P>[in] Address of an <B>SRPHRASE</B> structure that contains the engine's best recognition choice for the phrase. If <I>dwFlags</I> does not contain either ISRNOTEFIN_RECOGNIZED or ISRNOTEFIN_THISGRAMMAR, <I>pSRPhrase</I> may be NULL.</P>
<P></P>
<P><I>pIUnknownResult</I></P>
<P>[in] Address of an <B>IUnknown</B> interface of the speech-recognition results object created for this recognition. If this parameter is NULL, this engine has no object to return. The <B>IUnknown</B> interface and the object are released when the application returns from the <B>PhraseFinish</B> member function. Unless the application calls the <B>IUnknown::QueryInterface</B> member function on one of the object's interfaces, the results object is freed. This allows the application to ignore the <I>pIUnknownResult</I> parameter without causing results objects to accumulate and consume memory needlessly.</P>
<P></P>
<P>Depending on the grammar, a phrase can be the following:</P>
<P> <FONT FACE="Symbol">·</FONT>    <B>Context-free grammar</B>. An ordered list of spoken words that traverse and complete the grammar tree from start to finish. A phrase should be sent even if it is grammatically incorrect.</P>
<P> <FONT FACE="Symbol">·</FONT>    <B>Limited-domain or dictation grammar</B>. An ordered set of words. Typically, the <B>PhraseFinish</B> member function is sent once per utterance, but this is not guaranteed. In some cases, <B>PhraseFinish</B> may be sent several times per utterance; in other cases one <B>PhraseFinish</B> may be sent for several utterances.</P>
<P></P>
<P>The information provided in <I>pSRPhrase</I> should satisfy most applications. Those that need more information can use the speech-recognition results object, if the engine provides it. This object probably supports one or more of the speech-recognition results interfaces (<B>ISRResAudio</B>, <B>ISRResBasic</B>, and so on), but the application must query for each interface desired. </P>
<P>The application can keep a speech-recognition results object for later reference, although this object can consume large amounts of memory. However, from the engine's point of view, it doesn't really have to create the whole object until the <B>QueryInterface</B> member function is called.</P>
<P>If two or more grammars contain the same phrase, and this phrase is recognized, it is indeterminant which of the grammars will cause the engine to set the ISRNOTEFIN_THISGRAMMAR flag in the <I>dwFlags</I> parameter of the <B>ISRGramNotifySink::PhraseFinish </B>member function.</P></FONT></BODY></HTML>
