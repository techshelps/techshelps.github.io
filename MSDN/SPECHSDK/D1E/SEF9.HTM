<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITTSCentral::Phoneme</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<h2>ITTSCentral::Phoneme</H2><P></P>
<P>HRESULT Phoneme(VOICECHARSET eCharacterSet, DWORD dwFlags, <BR>    SDATA dText, PSDATA pdPhoneme);</P>
<P></P>
<P>Converts text to a phonemic representation, which is an intermediate stage between Unicode text and digital-audio data.</P>
<P> <FONT FACE="Symbol">·</FONT>    Returns NOERROR if successful, or one of these error values:</P>
<P>&lt;E_INVALIDARG&gt;<BR>&lt;E_OUTOFMEMORY&gt;<BR>&lt;TTSERR_INVALIDCHAR&gt;<BR>&lt;TTSERR_NOTSUPPORTED&gt;</P>
<P></P>
<P><I>eCharacterSet</I></P>
<P>[in] Character set to use to convert the text. This parameter can be one of these values:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="143pt" VALIGN="TOP"><COL WIDTH="191pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Value</P></TD><TD VALIGN="TOP"><P>Meaning</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>CHARSET_ENGINEPHONETIC</P></TD><TD VALIGN="TOP"><P>An engine-specific phonetic character set</P></TD></TR><TR><TD VALIGN="TOP"><P>CHARSET_IPAPHONETIC</P></TD><TD VALIGN="TOP"><P>The International Phonetic Alphabet (IPA) character set</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>CHARSET_TEXT cannot be used as the character set for converted text.</P>
<P></P>
<P><I>dwFlags</I></P>
<P>[in] TTSDATAFLAG_TAGGED if the text contains text-to-speech control tags that alter inflection, speed, and so on, or NULL if the text does not contain tags. Note that an engine-specific phonetic character set may use a different tagging protocol than that used by the IPA character set. This is left for future expansion.</P>
<P></P>
<P><I>dText</I></P>
<P>[in] <B>SDATA</B> structure that contains the address of the null-terminated text string to be converted. If the engine supports the IPA character set, tags can be used to intersperse words written in IPA phonemes with words in the language's character set. The application should not change this memory until the function returns. </P>
<P></P>
<P><I>pdPhoneme</I></P>
<P>[out] Address of an <B>SDATA</B> structure that receives a pointer to the phonemic representation of the text using the specified character set. The text string is null-terminated. The character set is wide or multibyte, depending upon the interface used (<B>ITTSCentralW</B> or <B>ITTSCentralA</B>). Engine-specific character sets must follow the wide/multibyte convention.</P>
<P></P>
<P>The calling application allocates the <B>SDATA</B> structure and passes its address to <B>Phoneme</B>. <B>Phoneme</B> allocates memory (using the OLE task allocator) for the returned data and sets the <B>pData</B> member of <B>SDATA</B> to point to the memory. If the allocation fails, the <B>pData</B> member is set to NULL and the <B>dwSize</B> member is set to zero. The calling application must free the memory pointed to by <B>pData</B>, as well as the <B>SDATA</B> structure itself.</P>
<P>This function can be used to adjust the phonetic representation of text before it is spoken by the engine, such as correcting mispronounced words. </P>
<P><B>Phoneme</B> is synchronous; that is, the member function does not return until the conversion is complete. Depending on the amount of text passed, this process can take some time to complete, so an application should call <B>Phoneme</B> with a background thread. </P>
<P>If the CHARSET_IPAPHONETIC value is used in the ANSI version of <B>Phoneme</B>, the function returns an error.</P>
<P>It is up to the calling application to free the memory allocated by the function, using the <B>CoTaskMemAlloc</B> and <B>CoTaskMemFree</B> functions.</P></FONT></BODY></HTML>
