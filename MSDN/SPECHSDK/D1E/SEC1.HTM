<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Buffer Notifications</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,atial,helvetica" SIZE="2"><FORM NAME="x"><OBJECT CLASSID="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" NAME="iv"></OBJECT></FORM>
<H3>Buffer Notifications</H3><P>An application can receive notifications about the status of the buffers that it places in the engine's speaking queue. For example, the engine can notify the application when a particular buffer starts playing or when the audio for certain words is played. </P>
<P>To receive buffer notifications from the engine, the application must create a COM object that supports the <B>ITTSBufNotifySink</B> interface and specify the address of the interface when calling the <B>ITTSCentral::TextData</B> member function. When a buffer-related event occurs, the engine calls the member function of the <B>ITTSBufNotifySink</B> interface that corresponds to the event. The application developer determines how the member function responds to the notification.</P>
<P>When the engine starts playing a text buffer, it calls the <B>ITTSBufNotifySink::TextDataStarted</B> member function, which receives a <B>QWORD</B> value indicating the time when the engine started reading text from the buffer. The engine calls the <B>ITTSBufNotifySink::TextDataDone</B> member function when it finishes processing the last text-to-speech buffer. The engine does not wait for the audio object to finish speaking the audio before sending the notification. The function receives a <B>QWORD</B> value that indicates the time when the engine finished sending text to the audio-destination object and a flag indicating the reason that the engine finished sending the text. The flag is the TTSBNS_ABORTED value if the application called the <B>ITTSCentral::AudioReset</B> member function.</P>
<P>Some text-to-speech engines notify the application as each word is being spoken by calling the <B>ITTSBufNotifySink::WordPosition</B> member function. The notification includes a <B>QWORD</B> value that indicates the time when the engine started playing the word and the offset from the beginning of the buffer to the word that is currently being played. An application can use this information to highlight the word being played. </P>
<P>An application can use the <B>ITTSCentral::ToFileTime</B> member function to convert <B>QWORD</B> values to Win32 <B>FILETIME</B> structures.</P>
<P>The engine calls the <B>ITTSBufNotifySink::Bookmark</B> member function when it encounters a bookmark in the text. An application can tag text with bookmarks to receive <B>Bookmark</B> notifications when the engine plays the text. These bookmarks can be used as cues for animation or other actions.</P></FONT></BODY></HTML>
