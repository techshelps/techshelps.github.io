<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Developing Active Desktop items for IE 4.0 </title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000 dir=ltr>
<Font face="verdana,arial,helvetica" size="2">
<h1><a name="developingactivedesktopitemsforie40"></a>Developing Active Desktop items for IE 4.0</h1>
<p>
Microsoft's Internet Explorer 4.0 can change the way you've traditionally reached your intended audience. For example, to go beyond creating a compelling Web site, you can augment your content offering by providing your audience a more immediate, condensed experience. Indeed, you can do so by taking advantage of IE4.0's Active Desktop feature.</p>
<p>
An Active Desktop item can be any HTML component; it works in the same manner as an Active Channel. The difference is, just as the name implies, the Desktop item stays on the user desktop—not on the channel bar as does an Active Channel. In this article, we'll show you how to create a Desktop item for your users. But before we begin, let's take a look at the underlying technology behind Active Desktop in IE 4.0.</p>
<h3>Under the hood</h3>
<p>
The Active Desktop in Internet Explorer 4.0 is built from two separate layers: the transparent icon layer, which exposes all the user's existing desktop shortcuts, and the background HTML layer that hosts all Active Desktop items. The HTML layer is a single, local HTML file called Desktop.htm that's created and edited automatically by Internet Explorer 4.0. This file contains the following items: 
<ul type=disc>
<li>
HTML tags that represent each Active Desktop item. Each Active Desktop item consists of a single HTML tag with arbitrary x- and y-positions. The HTML tag for an Active Desktop item can be either an image (IMG tag) or a floating frame (IFRAME tag) and is generated automatically by Internet Explorer 4.0. The floating frame is the most commonly used approach, because it neatly encapsulates an entire arbitrary HTML document that can contain anything the publisher desires. In either case, there's a single URL that points to the actual content. <br><br></li>
<li>
An ActiveX control that enables moving and resizing the Active Desktop items and helps manage the list of items. <br><br></li>
<li>
Any other static HTML that the user wants to have in the background. By default, this is just a reference to the user's chosen wallpaper, which is exposed as the background watermark for the HTML page. Users can customize their desktops by installing Active Desktop items designed for Internet Explorer 4.0. They can install such items by dragging and dropping, or by manually specifying a URL for an image or floating frame. (Manual setup requires the user to access the new Web option tab in the Display control panel.)</li>
</ul>
<p>
Now that we've explored how the Active Desktop works, let's take a look inside a Desktop item.</p>
<h3>Elements of a Desktop item</h3>
<p>
As we mentioned, the Desktop item shares the same technology as the Active Channel. Consequently, you define the content of a Desktop item in a Channel Definition File (CDF), within a &lt;CHANNEL&gt;…&lt;/CHANNEL&gt; tag. However, unlike an Active Channel, you'll use different attributes inside the &lt;CHANNEL&gt; tag to identify a Desktop item. You can use any HTML-based component, such as Dynamic HTML, ActiveX Controls, Java applets, and scripting, to create your Desktop item.</p>
<p>
As a publisher you can specify the initial size and update intervals of the Desktop item. As part of the IE 4.0's information delivery system, the URL associated with any Active Desktop item is automatically added to the user's subscription folder. All contents of the Desktop item are automatically cached in the system so it's visible even when the user isn't connected to the Internet. Moreover, since Desktop items become part of the user's desktop, they're fully customizable by the user. A user can resize, move, or delete a desktop item at any time. Now that we've learned about some of the underlying technology behind Active Desktop and Desktop item, it's time to create our own.</p>
<h3>Find the links</h3>
<p>
For this example, we'll first create a simple HTML page that contains two links, one for the back issues and another for the demo page. This is the page that the users will see on their desktops.</p>
<p>
Next, we'll create a channel file and define our update intervals, pointing the file to the HTML page we've created. When we're finished, we'll add our Desktop item to our desktop. <b>Figure A</b> displays our Microsoft Web Builder Desktop item.</p>
<p>
<b>Figure A</b></p>
<p>
<img src="mit97c1a.gif" border=0></p>
<p>
<b>We've added our Microsoft Web Builder Active Desktop item to our desktop.</b></p>
<h3>Create the content</h3>
<p>
Using your HTML editor, create a simple HTML page. It's important to keep your page light and simple so it will load faster. Begin by defining a style sheet definition as we show here:</p>
<pre>&lt;HTML&gt;
<code>&lt;HEAD&gt;</code>
<code>&lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;</code>
<code>&lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;</code>
<code>&lt;TITLE&gt;Web Builder Desktop&lt;/TITLE&gt;</code>
<code>&lt;STYLE type="text/css"&gt;</code>
<code>&lt;!--</code>
<code>   BODY  {font-size: 10pt; color: yellow; font-family: Verdana, Arial, Helvetica;z-index:1;}</code>
<code>   P.INITIAL:FIRST-LETTER {font-size:200%; float:left;}</code>
<code>   .dropcap:First-letter {font-size:20; float:left;}</code>
<code>   H1 {{font-size: 16pt; color: orange; font-family: Verdana, Arial, Helvetica;z-index:1;}</code>
<code>   A:link {font-size: 10pt; color: lime; text-decoration: none; font-weight: bold; font-family: Verdana, Arial, Helvetica;}</code>
<code>   A:visited {font-size: 10pt; color: lime; text-decoration: none; font-weight: bold; font-family: Verdana, Arial, Helvetica;}</code>
<code>   STRONG {font-size: 14pt; color: #003366; text-decoration: none; font-family: Verdana, Arial, Helvetica;}</code>
<code>   SMALL {font-size: 7pt; color: gray; text-decoration: none; font-family: Verdana, Arial, Helvetica;}</code>
<code>   .subhead {font-size: 11pt; font-weight: bold; color: #003366; text-decoration: none; font-family: Verdana, Arial, Helvetica;}</code>
<code>   .thanks {font-size: 25pt; font-weight: bold; color: lightgrey; text-decoration: none; font-family: Tahoma, Times, Helvetica;}</code>
<code>--&gt;</code>
<code>&lt;/STYLE&gt;</code>
<code>&lt;/HEAD&gt;</code></pre>
<p>
Now add the text to finish the page, like this:</p>
<pre><code>&lt;BODY bgcolor="navy"&gt;
&lt;p&gt;
&lt;h1&gt;Microsoft Web Builder&lt;/h1&gt;
&lt;p&gt;&lt;small&gt;
Missed an issue? Not to worry! Click here to grab the back issues of Microsoft Web Builder:&lt;/small&gt;&lt;br&gt;
&lt;a href="http://209.48.162.17/mswb/backissues.asp"&gt;Back Issues&lt;/a&gt;&lt;br&gt;&lt;br&gt;
&lt;p&gt;&lt;small&gt;
You've seen the code, now see these projects in action! Click here to go to our demo site and see 
your favorite project in action:&lt;/small&gt;&lt;br&gt;
&lt;a href="http://209.48.162.17/mswb/demos.asp"&gt;In Action&lt;/a&gt;&lt;br&gt;&lt;br&gt;
&lt;p&gt;
Every month Microsoft Web 
Builder offers you a hands-on 
approach to the hottest Web technologies available 
from Microsoft.

&lt;/BODY&gt;
&lt;/HTML&gt;</code></pre>
<p>
Notice that we didn't add any table definitions to size the text block. We'll define the size of this page in the channel definition file, which we'll create next.</p>
<h3>Create a channel</h3>
<p>
The Channel Definition File (CDF) for the Active Desktop item works similarly to the one in an Active Channel. To create the CDF, start with the XML header and the &lt;CHANNEL&gt; tag, like this:</p>
<pre><code>&lt;?XML version="1.0"?&gt;
&lt;Channel&gt; </code></pre>
<p>
Next, we'll add the item's update schedule with a &lt;SCHEDULE&gt; tag. You can use any future date as the EndDate attribute. You'll also need to specify an update interval for the content. If your content is updated frequently, you can use WEEK, DAY, and HOUR. In our case, we've set the update interval to MONTH to correspond with our Web site updates, like so:</p>
<pre><code>&lt;Schedule EndDate="1998.11.05T08:15-0500"&gt;
        &lt;IntervalTime MONTH="1" /&gt;
        &lt;EarliestTime HOUR="12" /&gt;
        &lt;LatestTime HOUR="18" /&gt;
&lt;/Schedule&gt;</code></pre>
<p>
Now it's time to add the actual link to the HTML we've previously created and to title the item. To do so, use the following line of code:</p>
<pre><code>&lt;Item HREF="http://www.mswebbuilder.com/WBDesktop.asp"&gt;
&lt;Title&gt;Web Builder Desktop&lt;/Title&gt;</code></pre>
<p>
At this point, we must ensure that IE4.0 knows to use this item as a Desktop component. In the line of code </p>
<pre><code>&lt;Usage VALUE="DesktopComponent"&gt;
&lt;OpenAs VALUE="html" /&gt;</code></pre>
<p>
the OpenAs attributes define how IE 4.0 should host the content. You can use HTML as we've done here, or you can use IMAGE if you want your Desktop item to appear as an icon on the desktop.</p>
<p>
Next, we'll define the width and height of the Desktop item. Keep in mind that most users are still using a relatively small 640 by 480 pixel display, so don't use a size that will take over the entire desktop. In our case, we've used a conservative 220 by 337 pixel image for our item, with code like this:</p>
<pre><code>&lt;Width VALUE="220" /&gt;
&lt;Height VALUE="337" /&gt;</code></pre>
<p>
Finish the CDF file by closing the open tags with the lines</p>
<pre><code>&lt;/Usage&gt;
    &lt;/Item&gt;
&lt;/Channel&gt;</code></pre>
<p>
Now, save the file as <i>ActiveWB.CDF</i>. At this point, we've finished creating the CDF file and are ready to use our Desktop component.</p>
<h3>Add a link</h3>
<p>
To make your Desktop item accessible, you'll need to provide a link from your Web site to the CDF file you've just created. You can use a simple text link or an image to create your link as we show here:</p>
<pre><code>&lt;a href=</code>http://www.mswebbuilder.com/ActiveWB.cdf<code>&gt;Click here to add to desktop&lt;/a&gt;</code></pre>
<p>
That's it! Your Desktop item is now ready to be installed in thousands of desktops worldwide. To test the item, click on the link from IE 4.0. When you do, IE 4.0 will display the Subscribe dialog box, as shown in <b>Figure B</b>.</p>
<p>
<b>Figure B</b></p>
<p>
<img src="mit97c1b.gif" border=0></p>
<p>
<b>You can customize the update schedule of a Desktop item just like you would a channel.</b></p>
<p>
Click OK to accept the default schedules. IE 4.0 will now download the content and place it on your Active Desktop.</p>
<h3>Conclusion</h3>
<p>
An Active Desktop item works much like an Active Channel to improve the content delivery to your intended users. In this article, we've demonstrated the simple process of creating a Desktop item to do just that.</p>
<p>
-----------------------------------------------</p>
<p>
This article is reproduced from the December 1997 issue of <i>Microsoft Web Builder</i>. <i>Microsoft Web Builder</i> is an independently produced publication of The Cobb Group. No part of this article may be used or reproduced in any fashion (except in brief quotations used in critical articles and reviews) without prior consent of The Cobb Group. To contact The Cobb Group, please call (800) 223-8720 or (502) 493-3200.</p>
<p>
Copyright © 1997 The Cobb Group, a division of Ziff-Davis Inc. The Cobb Group and The Cobb Group logo are trademarks of Ziff-Davis Inc. All rights reserved. Reproduction in whole or in part in any form or medium without express written permission of Ziff-Davis is prohibited. </p>
</font></BODY>
</HTML>
