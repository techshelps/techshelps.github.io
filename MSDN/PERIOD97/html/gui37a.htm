<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Can I Get a Summary of That, Please?</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<font face="verdana,arial,helvetica" size="2"><form name=x><object name=iv classid="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016">
</object></form>
<h1><a name="msdn_gui37a"></a>Can I Get a Summary of That, Please?</h1>
<p>
<b>Dear Dr. GUI,</b></p>
<p>
I am a graduate student in computing science from Holland.</p>
<p>
I am writing a small application that runs under Windows 95. The key to making this app a success is the ability to read the SummaryInformation stream and the DocumentSummaryInformation stream from a structured storage file (such as Word, PowerPoint, and Visio files). It's not just about reading the "raw" stream but making sense of it as well. </p>
<p>
The questions: </p>
<p>
1) Are there (and what are they) Windows API calls that will do the job for me? I would expect to get the info about all the standard properties of a summary info in some easy way, without having to worry about addresses and offsets within the stream. Is there an easy way to do this? </p>
<p>
2) Is the SummaryInformation stream subject to change in the future? Or will its internal structure remain as it exists?</p>
<p>
3) If there are no Windows API calls, where can I find detailed information on the internal structure of the SummaryInformation stream and the DocumentSummaryInformation stream? </p>
<p>
So it's either the API calls that unburden the programmer of the "raw" task of figuring the stream out himself, or a detailed description of the stream's internal structure. Have I overlooked another possibility?</p>
<p>
Regards,<br>
<i>Ralph (co-author of the SEA graphics viewer)</i></p>
<p>
<b>Dr. GUI replies:</b></p>
<p>
Dr. GUI remembers Cliff's Notes from his undergrad years (not that he ever used them, of course!) and how important summary information was. The good doctor is glad indeed, then, to tell you that yes, there are APIs to help you read DocumentSummaryInformation and SummaryInformation streams. If created properly by the document's application, these are structured storage property sets and reading and writing properties to them is as simple as calling <b>IPropertyStorage::ReadMultiple()</b> and <b>IPropertyStorage::WriteMultiple()</b>. For information on the properties contained in both of these streams, please refer to the Platform SDK documentation on the MSDN Library CD (or online at http://www.microsoft.com/msdn/). Specifically, do a query on "The Summary Information Property Set" for the SummaryInformation stream and "The DocumentSummaryInformation Property Set." <b>IPropertyStorage</b> and <b>IPropertySetStorage</b> are described in the Interface reference in the Platform SDK online docs. </p>
<p>
As far as whether these stream formats will change in the future, remember that Dr. GUI is a programmer, not a fortune-teller. But at least the format won't change as it conforms to the <b>IPropertySetStorage</b> specification. And since the interfaces you use to read and write them are COM interfaces, they won't change, either. The IDs for existing properties in these sets are not likely to change since adding new properties will have no effect on existing ones. The types for existing properties may change, but that is unlikely also.</p>
</font></BODY>
</HTML>
