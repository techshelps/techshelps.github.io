<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="doccomm"
content="The Unused style macro was run!_10/26/94_11:28 AM">
<meta name="Template" content="C:\MSOffice\Templates\msin60b.dot">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VB pressed into Windows NT's service</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">


    <p><font size="5" face="Verdana">VB pressed into Windows NT's
    service</font></p>
    <h2><font size="2" face="Verdana">Hello, Doctor!</font></h2>
    <p><font size="2" face="Verdana">How can I take a normal VB
    .exe file (for example, project1.exe) and turn it into a
    service so that the system will load it every time it starts,
    and not when I enter my own account (even when I have admin
    privilege...)?</font></p>
    <p><font size="2" face="Verdana"><i>Erez Chocva</i></font></p>
    <h2><font size="2" face="verdana">Dr. GUI replies:</font></h2>
    <p><font size="2" face="Verdana">This is more like it. No
    decorating. (If you've ever seen Dr. GUI's office, you'd
    never ask him for decorating advice, anyway.) No mail or
    postal question. Good.</font></p>
    <p><font size="2" face="Verdana">A service process under
    Windows NT has a special program architecture and is
    different from a regular Win32 application (such as
    Notepad.exe) in several ways. The Microsoft Platform SDK
    (formerly called the Win32 SDK) documents in detail how one
    can write a Windows NT service.</font></p>
    <p><font size="2" face="Verdana">What this means is that one
    cannot take an existing regular Win32 program and run it as a
    Windows NT service without some effort. The application needs
    to be recoded so that it conforms to the Windows NT service
    architecture. And as far as the good doctor knows, that's not
    possible for Visual Basic applications. </font></p>
    <p><font size="2" face="Verdana">One can, however, spawn a
    Win32 regular application from a Windows NT service. This
    allows you to have some of the benefits of a Windows NT
    service, such as the ability to run a process under a
    specified user account, the ability to run a process even
    when no one is logged on the machine, and so on.</font></p>
    <p><font size="2" face="Verdana">The Windows NT version 4.0
    resource kit provides a tool called SrvAny.exe for this
    purpose. This tool is actually a simple Windows NT service,
    which when started, spawns any regular Win32 application
    specified in its startup parameters. Please see SrvAny.wri in
    the Windows NT 4.0 resource kit for documentation of this
    tool.</font></p>
    <p><font size="2" face="Verdana">Please note that spawning a
    process from a service is different from converting the
    process itself into a service. The latter may be the
    preferable option under certain circumstances (for example,
    if the process in question is an OLE server).</font></p>

</font></body>
</html>
