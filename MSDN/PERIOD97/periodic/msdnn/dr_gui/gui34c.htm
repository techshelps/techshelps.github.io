<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Oh where, oh where has my ToolHelp gone</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF" text="#000000">


<p><a name="msdn_gui34c"><font size="5" face="verdana"></font></a><font
size="5" face="verdana">Oh where, oh where has my ToolHelp
gone&nbsp;.&nbsp;.&nbsp;.</font></p>

<h2><font size="2" face="verdana">Dear Dr GUI,</font></h2>

<p><font size="2" face="verdana">I&#146;ve lost my
ToolHelp&#151;do you think you could help me find it? My
ToolHelp32 code works just fine in Windows 95 but causes all
sorts of GPFs in Windows NT 4.0. I&#146;ve searched without
success through the whole MSDN and all my hundreds of books and I
can&#146;t find NT 4&#146;s version of the Toolhelp32 functions.
They must be there somewhere or Task Manager could not work.</font></p>

<p><font size="2" face="verdana">Yours in hope,<br>
<i>Nigel</i> <i>[Ed: No, he&#146;s not Nigel Thompson]</i></font></p>

<h2><font size="2" face="verdana">Dr. GUI replies:</font></h2>

<p><font size="2" face="verdana">It seems like everyone is losing
things nowadays. Dr. GUI, for instance, sometimes feels as though
he&#146;s losing his mind, especially when listening to Scott
MacNealy. (Or is it that the good doctor feels he&#146;s losing
his temper?)</font></p>

<p><font size="2" face="verdana">Windows NT does not implement
TOOLHELP32. Instead you can use the psapi.dll that is shipped
with the Win32 SDK to accomplish nearly everything that
TOOLHELP32 accomplishes on Windows 95. You can, for example,
enumerate the list of processes in the system, as well as
enumerate the list of DLLs in each process. There are also APIs
to get loaded device driver information as well as process memory
usage information, working set information, and memory-mapped
file information.</font></p>

<p><font size="2" face="verdana">The PSAPI DLL can be found in
the BIN directory of the Win32 SDK; psapi.h and psapi.lib can be
found as a part of a Win32 SDK sample in the
samples\sdktools\image\winnt\pfmon directory. </font></p>

<p><font size="2" face="verdana">There are two <i>Microsoft
Systems Journal </i>articles in the &#147;Under the Hood&#148;
column by Matt Pietrek (August 1996 and November 1996) that cover
pretty much everything that is in PSAPI.</font></p>

<p><font size="2" face="verdana">If you want to do this in Java,
either use a native interface or, better yet, write wrappers for
the functions you need as COM objects and call the COM objects
from Java. Dr. GUI prefers using COM objects despite the fact
that they&#146;re not even 99 44/100% pure Java, let alone 100%
pure Java. Why? Well, they&#146;re no harder to write than the
wrapper DLLs you&#146;d need to use a native interface, they
allow the Microsoft Java VM to deal with multithreading and
garbage collection issues for you, and they&#146;re reusable in
other languages (such as Visual Basic) on your Windows system.
Remember, you&#146;re not going to see psapi.dll on Solaris
anyway.</font></p>

<p><font size="2" face="verdana">Also, if you&#146;re doing
Windows development in Java, be sure to check out the classes
provided in the Microsoft SDK for Java 2.0&#151;they include many
classes that provide access to the Windows and DirectX APIs.</font></p>
</font></body>
</html>
