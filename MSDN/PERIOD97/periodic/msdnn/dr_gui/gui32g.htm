<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Environmental Impact</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<p><!--webbot bot="HTMLMarkup" startspan --><basefont face="verdana,arial,helvetica" size=2 color="#000000"><!--webbot
bot="HTMLMarkup" endspan --><font size="5">Environmental Impact</font></p>

<h2><font size="2">Dear Dr. GUI: </font></h2>

<p><font size="2">I wish to create or set an MS-DOS
&quot;Environment Variable&quot; in Visual Basic 4.0. How is this
done?</font></p>

<p><font size="2">Dan</font></p>

<h2><font size="2">Dr. GUI replies: </font></h2>

<p><font size="2">It isn't possible to directly modify the
environment table from Visual Basic. Modifying the DOS
environment table would involve searching memory (Visual Basic
has no Peek) for the table and then directly modifying the
table's contents (this would get you a Protection Violation,
since you don't own that memory). </font></p>

<p><font size="2">You can achieve this effect by creating a DOS
batch file (Open and Print), which sets the environment that the
user desires and then invokes COMMAND.COM. Visual Basic could
then invoke the batch file by using the <b>Shell</b> statement.</font></p>
</font></body>
</html>
