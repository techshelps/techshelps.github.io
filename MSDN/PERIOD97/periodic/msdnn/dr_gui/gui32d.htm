<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Zzzzzzz. . . .Suspending a Thread</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<p><!--webbot bot="HTMLMarkup" startspan --><basefont face="verdana,arial,helvetica" size=2 color="#000000"><!--webbot
bot="HTMLMarkup" endspan --><font size="5">Zzzzzzz. . .
.Suspending a Thread</font></p>

<h2><font size="2">Dear Dr. GUI: </font></h2>

<p><font size="2">This problem has puzzled me for over a year. Do
you know how to implement a &quot;SLEEP&quot; function in Visual
Basic that puts the program on hold, while other programs
continue to run (while preventing the held program from getting
new events)?</font></p>

<p><font size="2">It would be extra cool if when sleep is over
(or when the &quot;WAKE UP&quot; function is called), the missed
events get executed. </font></p>

<p><font size="2">How about using a message hook (like Message
Blaster)? How would I store messages to be sent later? </font></p>

<p><font size="2">Andy Rosa</font></p>

<h2><font size="2">Dr. GUI replies: </font></h2>

<p><font size="2">OOOOH! You are soooo close. The function you
want is . . . <b>Sleep()</b>, which is from the Windows API.</font></p>

<p><font size="2" face="Courier New">Declare Sub Sleep Lib
&quot;kernel32&quot; (ByVal dwMilliseconds As Long)</font></p>

<p><font size="2">This function suspends execution of your thread
for a specified number of milliseconds. Messages sent to your
application are still queued up, and you get them as soon as you
wake up. If you want a wake-up call, just put in a call to your
wake-up function right after the <b>Sleep()</b> call. </font></p>

<p><font size="2" face="Courier New">Private Sub Command1_Click()</font></p>

<p><font size="2" face="Courier New">Sleep(10000)</font></p>

<p><font size="2" face="Courier New">ret = MsgBox(&quot;Time to
wake up!&quot;, vbInformation)</font></p>

<p><font size="2" face="Courier New">End Sub</font></p>

<p><font size="2">Dr. GUI hastens to point out that the <b>WakeUpCall()</b>
function exported from NIGHTCLERK.DLL is unreliable and so should
never be used.</font></p>
</font></body>
</html>
