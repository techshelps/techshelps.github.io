<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Oh, font of mystery</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF" text="#000000">


<p><a name="msdn_gui34b"><font size="5" face="verdana"></font></a><font
size="5" face="verdana">Oh, font of mystery</font></p>

<h2><font size="2" face="verdana">Dear Dr. GUI,</font></h2>

<p><font size="2" face="verdana">Windows 95 and Windows NT 4.0
provide the user the option of choosing the font for the window
title bar. I have read Knowledge Base articles that mention the
programmer should not rely on the win.ini settings because the
user can change the font at any time via the Control Panel.
However, in no case did I find mention of how to actually
retrieve this information via the Win32 API. Can you please tell
me how to get the current font, size, etc. for the window title
bar?</font></p>

<p><font size="2" face="verdana">Thanks,<br>
<i>Steve Rosburg</i></font></p>

<h2><font size="2" face="verdana">Dr. GUI replies:</font></h2>

<p><font size="2" face="verdana">I&#146;m glad you&#146;ve come
to the font of wisdom to ask this question.</font></p>

<dl>
    <dt><font size="2" face="verdana">You&#146;re absolutely
        right that you shouldn&#146;t get this information from
        the registry from an .ini file. Instead, you should use
        the <b>SystemParametersInfo()</b> API. (Take a look at
        the Win32 SDK for details.) The following code snippet
        shows how to obtain a handle to the title bar font under
        Windows 95 or Windows NT 4.0:</font></dt>
    <dd><pre><font size="3" face="new courier">    NONCLIENTMETRICS ncm;
    memset(&amp;ncm, 0, _
		sizeof(ncm));
    ncm.cbSize = sizeof(ncm);
    SystemParametersInfo( _
	  SPI_GETNONCLIENTMETRICS, 
	  0, &amp;ncm, 0);
        //Get caption bar 
		//font handle.
    hFontConsole = CreateFontIndirect( _
  &amp;ncm.lfCaptionFont); </font></pre>
    </dd>
</dl>

<p><font size="2" face="verdana">In this case, you&#146;re lucky
to be programming in C/C++ because Java 1.0 has support for only
five fonts. As Henry Ford said of the Model T, &#147;You can get
any color you want&#151;as long as it&#146;s black.&#148;
Thankfully, Java 1.1 has some minor improvements, and the AFC
library, included with the prerelease of the Microsoft SDK for
Java 2.0, will give you access to all the fonts you can use, and
then some.</font></p>
</font></body>
</html>
