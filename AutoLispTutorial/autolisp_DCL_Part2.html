<html>


<!-- Mirrored from www.jefferypsanders.com/autolisp_DCL_Part2.html by HTTrack Website Copier/3.x [XR&CO'2004], Thu, 23 Sep 2004 01:09:08 GMT -->
<head>
<meta name="description" content="AutoLisp Dialog Control Language">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="keywords" content="autolisp, DCL, dialog, control, language">
<title>The AutoLisp Ultimate Tutorial&nbsp; - DCL</title>
</head>

<body>

<p align="center"><font color="#000000"><big><big><big><strong>The
    AutoLisp Tutorial - DCL</strong></big></big></big></font><font face="Helvetica"></p>
    </font><p align="center"><font color="#000000"><big><big><strong>Dialog Control Language -
    Part 2</strong></big></big></font></p>
    <hr size="4" color="#0000FF">
    <p>&nbsp; <big><strong>Part 2 - Edit_Box</strong></big>&nbsp;&nbsp; </p>
    <hr size="4" color="#0000FF">
    <p>&nbsp;&nbsp; Let's build a working DCL file showing us exactly how to handle edit
    boxes. </p>
    <p>&nbsp;We will build a DCL file containing two edit boxes plus a Okay and Cancel&nbsp;
    button.&nbsp; The information in the two edit boxes will be displayed after selecting the
    Okay button.</p>
    <hr size="4" color="#0000FF">
    <p>&nbsp; <strong>Layout thoughts:&nbsp;</strong>&nbsp; I will place the edit boxes in a
    column, (stacked on top of each other).&nbsp; Then I'll put the Okay and Cancel buttons at
    the bottom in a row.&nbsp; So...I'll need something like this:</p>
    <p><font face="Courier New">: column { <br>
    &nbsp; : boxed_column { <br>
    &nbsp;&nbsp;&nbsp; : edit_box { <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#FF0000">// Put code for edit_box 1 here</font><br>
    &nbsp;&nbsp;&nbsp; }&nbsp; <br>
    &nbsp;&nbsp;&nbsp; : edit_box {&nbsp; <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">// Put code for edit_box 3 here</font>&nbsp;
    <br>
    &nbsp;&nbsp;&nbsp; }&nbsp; <br>
    &nbsp; }&nbsp; <br>
    &nbsp; : boxed_row { <br>
    &nbsp;&nbsp;&nbsp; : button { </font><br>
    <font face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#FF0000">// Put
    code for the Okay button here</font><br>
    &nbsp;&nbsp;&nbsp; }&nbsp; <br>
    &nbsp;&nbsp;&nbsp; : button { </font><br>
    <font face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#FF0000">// Put
    code for the Cancel button here</font><br>
    &nbsp;&nbsp;&nbsp; } <br>
    &nbsp; }&nbsp;&nbsp; <br>
    } </font></p>
    <hr size="4" color="#0000FF">
    <p>Let's copy in the code for the header and all of the controls above.&nbsp; I'll show
    them in red.&nbsp; Notice the key names and labels had to be changed.</p>
    <p><font color="#FF0000"><font face="Courier New">SAMPLE2 : dialog { <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; label = &quot;Sample Dialog Box Routine
    - Part 2&quot;;</font> </font><br>
    <font face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; : column { <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; : boxed_column { <br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : edit_box {<br>
    <font color="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key = &quot;username&quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    label = &quot;Enter your Name:&quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edit_width
    = 15;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value
    = &quot;&quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
    initial_focus = true;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : edit_box
    {<br>
    <font color="#FF0000">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key
    = &quot;userage&quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label
    = &quot;Enter your Age:&quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edit_width
    = 15;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value
    = &quot;&quot;;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : boxed_row {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : button {<br>
    <font color="#FF0000">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key
    = &quot;accept&quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label
    = &quot; Okay &quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is_default
    = true;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : button {<br>
    <font color="#FF0000">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key
    = &quot;cancel&quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label
    = &quot; Cancel &quot;;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is_default
    = false;<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is_cancel
    = true;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; } </font></p>
    <p><font face="Courier New">}</font></p>
    <p><strong>Right click and copy the above. Open NotePad and paste it.&nbsp; Save the file
    as SAMPLE2.DCL&nbsp; <em>Be sure to change the &quot;Save as Type&quot; drop down box to
    &quot;All Files&quot; before saving it or it will put a&nbsp; &quot;.txt&quot; extension
    on the file name.&nbsp; Save this file somewhere in the AutoCAD search path.</em></strong></p>
    <hr size="4" color="#0000FF">
    <p>&nbsp; Next we will get a copy of the AutoLisp model and revise it.&nbsp; All new code
    is shown in red.</p>
    <p><small><font face="Courier New">(defun C:<font color="#FF0000">SAMPLE2</font>()<br>
    <br>
    &nbsp; ;;;--- Load the dcl file<br>
    &nbsp; (setq dcl_id (load_dialog &quot;<font color="#FF0000">SAMPLE2</font>.dcl&quot;))<br>
    <br>
    &nbsp; ;;;--- Load the dialog definition if it is not already loaded<br>
    &nbsp; (if (not (new_dialog &quot;<font color="#FF0000">SAMPLE2</font>&quot; dcl_id) )
    (exit))<br>
    <br>
    &nbsp; ;;;--- If an action event occurs, do this function<br>
    &nbsp; (action_tile &quot;accept&quot; &quot;(setq ddiag 2)<font color="#0000FF">(saveVars)</font>(done_dialog)&quot;)<br>
    &nbsp; (action_tile &quot;cancel&quot; &quot;(setq ddiag 1)(done_dialog)&quot;)<br>
    <br>
    &nbsp; ;;;--- Display the dialog box<br>
    &nbsp; (start_dialog)<br>
    <br>
    &nbsp; ;;;--- Unload the dialog box<br>
    &nbsp; (unload_dialog dcl_id)<br>
    <br>
    &nbsp; ;;;--- If the user pressed the Cancel button<br>
    &nbsp; (if(= ddiag 1)<br>
    &nbsp;&nbsp;&nbsp; (princ &quot;\n <font color="#FF0000">Sample2</font> cancelled!&quot;)<br>
    &nbsp; )<br>
    <br>
    &nbsp; ;;;--- If the user pressed the Okay button<br>
    &nbsp; (if(= ddiag 2)<br>
    &nbsp;&nbsp;&nbsp; (progn<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (princ &quot;\n The user pressed Okay!&quot;)<br>
    &nbsp;&nbsp;&nbsp; )<br>
    &nbsp; )<br>
    <br>
    &nbsp; ;;;--- Suppress the last echo for a clean exit<br>
    &nbsp; (princ)<br>
    <br>
    )</font></small>&nbsp; </p>
    <p>&nbsp; <strong>Right click and copy the above. Open NotePad and paste it.&nbsp; Save
    the file as SAMPLE2.LSP&nbsp; <em>Be sure to change the &quot;Save as Type&quot; drop down
    box to &quot;All Files&quot; before saving it or it will put a&nbsp; &quot;.txt&quot;
    extension on the file name.&nbsp; Save this file somewhere in the AutoCAD search path.</em></strong></p>
    <hr size="4" color="#0000FF">
    <p>&nbsp; Let's load the program and see what the DCL file looks like.&nbsp; On the
    command line type this:</p>
    <p>Command: (load &quot;sample2&quot;) and press enter</p>
    <p>&nbsp; You should see this</p>
    <p>C:Sample2 <br>
    Command:</p>
    <p>&nbsp; Now type Sample2 and press enter.&nbsp; If everything went according to plan you
    should see this on your screen:</p>
    <p>&nbsp;</p>
    <p align="center">
    <img src="images/DCL_PART201.jpg" alt="DCL_PART201.jpg (10710 bytes)" WIDTH="287" HEIGHT="161"></p>
    <hr size="4" color="#0000FF">
    <p>&nbsp;&nbsp; Looking good so far.&nbsp; We need to add the <font color="#0000FF">SaveVars</font>
    function to save the strings in the edit boxes when the Okay button is pressed.&nbsp; <em>Look
    at the blue text in the Sample2.lsp program above.</em></p>
    <p>&nbsp; The edit box for the name needs to be a string.&nbsp; Dialog boxes return
    strings, so we do not need to modify it.&nbsp; All we have to do is use the get_tile
    function.</p>
    <p><small><font face="Courier New">&nbsp; (setq userName(get_tile &quot;username&quot;))</font></small></p>
    <p><small><font face="Courier New"><br>
    </font></small>&nbsp; The edit box for Age needs to be an integer.&nbsp; We will have to
    modify the get_tile results by using the ATOI function.&nbsp; This function converts a
    string to an integer.</p>
    <p><font face="Courier New" color="#000000"><small>&nbsp; (setq userAge( <strong>atoi</strong>
    (get_tile &quot;username&quot;)))<br>
    </small></font></p>
    <p><em>&nbsp; If we needed to convert to an Real number we would use DISTOF function
    instead of the ATOI function.&nbsp; </em></p>
    <p>&nbsp; Our SaveVars routine would look like this:</p>
    <p><font color="#FF0000" face="Courier New"><small>(defun saveVars()<br>
    &nbsp; (setq userName(get_tile &quot;username&quot;))<br>
    &nbsp; (setq userAge( atoi (get_tile &quot;username&quot;)))<br>
    )</small></font></p>
    <hr size="4" color="#0000FF">
    <p><font color="#000000"> Our program would now look like this:</font></p>
    <p><font face="Courier New" color="#000000"><small>(defun saveVars()<br>
    &nbsp; (setq userName(get_tile &quot;username&quot;))<br>
    &nbsp; (setq userAge(atoi(get_tile &quot;username&quot;)))<br>
    )</small></font></p>
    <p><small><font face="Courier New" color="#000000">(defun C:SAMPLE2()<br>
    <br>
    &nbsp; ;;;--- Load the dcl file<br>
    &nbsp; (setq dcl_id (load_dialog &quot;SAMPLE2.dcl&quot;))<br>
    <br>
    &nbsp; ;;;--- Load the dialog definition if it is not already loaded<br>
    &nbsp; (if (not (new_dialog &quot;SAMPLE2&quot; dcl_id) ) (exit))<br>
    <br>
    &nbsp; ;;;--- If an action event occurs, do this function<br>
    &nbsp; (action_tile &quot;accept&quot; &quot;(setq ddiag 2)(saveVars)(done_dialog)&quot;)<br>
    &nbsp; (action_tile &quot;cancel&quot; &quot;(setq ddiag 1)(done_dialog)&quot;)<br>
    <br>
    &nbsp; ;;;--- Display the dialog box<br>
    &nbsp; (start_dialog)<br>
    <br>
    &nbsp; ;;;--- Unload the dialog box<br>
    &nbsp; (unload_dialog dcl_id)<br>
    <br>
    &nbsp; ;;;--- If the user pressed the Cancel button<br>
    &nbsp; (if(= ddiag 1)<br>
    &nbsp;&nbsp;&nbsp; (princ &quot;\n Sample2 cancelled!&quot;)<br>
    &nbsp; )<br>
    <br>
    &nbsp; ;;;--- If the user pressed the Okay button<br>
    &nbsp; (if(= ddiag 2)<br>
    &nbsp;&nbsp;&nbsp; (progn<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font face="Courier New" color="#0000FF">(princ
    &quot;\n The user pressed Okay!&quot;)</font><font face="Courier New" color="#000000"><br>
    &nbsp;&nbsp;&nbsp; )<br>
    &nbsp; )<br>
    <br>
    &nbsp; ;;;--- Suppress the last echo for a clean exit<br>
    &nbsp; (princ)<br>
    <br>
    )</font></small></p>
    <hr size="4" color="#0000FF">
    <p><font face="Courier New">&nbsp; </font>Last item.&nbsp; We need to replace the line in
    the program:<font face="Courier New" color="#0000FF"><small> (princ &quot;\n The user
    pressed Okay!&quot;)</small></font>&nbsp; with something to modify and display the
    userName and userAge data.&nbsp; Let's do something simple.&nbsp; We will find out how
    many days old this person is.&nbsp; </p>
    <p align="left"><font face="Courier New" color="#000000"><small>;;;--- If the user pressed
    the Okay button<br>
    &nbsp; (if(= ddiag 2)<br>
    &nbsp;&nbsp;&nbsp; (progn</small></font></p>
    <p align="left"><small><font face="Courier New" color="#000000">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;;;--- Multiply the users age x 365 to get the number of
    days.<br>
    &nbsp;&nbsp;&nbsp; </font><font face="Courier New" color="#0000FF">&nbsp; (setq userAge(*
    userAge 365))</font></small></p>
    <p align="left"><small><font face="Courier New" color="#000000">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;;;--- Display the results<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font face="Courier New" color="#0000FF">(alert
    (strcat userName &quot; is &quot; (itoa userAge) &quot; days old.&quot;))</font><font face="Courier New" color="#000000"><br>
    &nbsp;&nbsp;&nbsp; )<br>
    &nbsp; )</font><font face="Courier New"><br>
    <br>
    </font></small></p>
    <hr size="4" color="#0000FF">
    <p><font color="#000000">Add the above to the file, save it and test it out. &nbsp;
    Everything working okay?</font></p>
    <p align="center">
    <img src="images/DCL_PART202.jpg" alt="DCL_PART202.jpg (4381 bytes)" WIDTH="146" HEIGHT="100"></p>
    <hr size="4" color="#0000FF">
    <p><font color="#000000">&nbsp; </font></p>
    <p>&nbsp; When you get your program tested and everything is working, move the blue line
    above, [ <font color="#0000FF" face="Courier New"><small>(defun C:SAMPLE2()</small></font>
    ] all the way to the top of the file.&nbsp; This will make all of your variables local and
    will reset them all to nil when the program ends.</p>
    <p>&nbsp; That's it.&nbsp; We're done.</p>
    <p align="center"><a href="autolisp_DCL.html">Back</a></p>
    <hr size="4" color="#0000FF">
    <p align="center"><a href="index.html">AutoLisp Tutorial Home</a></p>
</body>

</html>
