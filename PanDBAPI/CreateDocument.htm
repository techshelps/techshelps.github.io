<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>CreateDocument</title>

<!--(Meta)==========================================================-->

<meta name=generator content="Microsoft FrontPage 4.0">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1073>
<meta name=layout-width content=527>
<meta name=date content="12 16, 2002 10:46:04 AM">


<!--(Links)=========================================================-->

<link rel=StyleSheet href=default.css>



</head>

<!--(Body)==========================================================-->


<body>

<p style="font-weight: bold; color: #000080;">CreateDocument</p>

<p>Creates a document within a specified folder. </p>

<p><i>Public Function CreateDocument(DocumentProp() As Byte, ByVal FileName As String) As Long</i></p>

<p>&nbsp;</p>

<p style="font-weight: bold; color: #000080;">Parameters </p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="x-cell-content-align: top; width: 100%; border-spacing: 0"
		cellspacing=0
		width=100% height="121">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">

<tr valign=top>
<td style="background-color: #c0c0c0; border: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	bgcolor=#C0C0C0
	width=25% height="18">
<p style="font-weight: bold;">In/out </p></td>
<td style="background-color: #c0c0c0; border-right: 1px Solid #000000; border-top: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	bgcolor=#C0C0C0
	width=25% height="18">
<p style="font-weight: bold;">Name </p></td>
<td style="background-color: #c0c0c0; border-right: 1px Solid #000000; border-top: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	bgcolor=#C0C0C0
	width=25% height="18">
<p style="font-weight: bold;">Data type </p></td>
<td style="background-color: #c0c0c0; border-right: 1px Solid #000000; border-top: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	bgcolor=#C0C0C0
	width=25% height="18">
<p style="font-weight: bold;">Description</p></td></tr>

<tr valign=top>
<td style="border-left: 1px Solid #000000; border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>&nbsp; </p>
<p>In,Out </p>
<p>&nbsp;</p></td>
<td style="border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>DocumentProp </p></td>
<td style="border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>Byte[TagDocument] </p></td>
<td style="border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>[In]Document properties to be set for the new created folder</p>
<p>[out]Properties set </p>
<p>&nbsp;</p></td></tr>
<tr>
<td style="border-left: 1px Solid #000000; border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>In </p>
<p>&nbsp;</p></td>
<td style="border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>FileName </p></td>
<td style="border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>String </p></td>
<td style="border-right: 1px Solid #000000; border-bottom: 1px Solid #000000; padding-left: 10px; padding-right: 10px"
	width=25% height="81">
<p>This specifies the name by which new document is to be created.</p>
  </td>
</tr>
</table>

<p>&nbsp;</p>

<p style="font-weight: bold; color: #000080;">Description</p>

<p>This function is called in both local and shared cabinet .It is passed 
 with the properties of the document that has to be set .Incase if a document 
 is to be imported with the new name, then the name of document is passed in the
parameter 'FileName'. In Local cabinet, in case 
 of importing, image of document is stored as a dob file on hard disk. For every 
 new document created this function also creates its thumbnail image. This 
 function returns the property set for the newly created document.</p>

<p><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p style="font-weight: bold; color: #000080;">Return value </p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0;"
		cellspacing=0
		width=100%>
<col style="width: 50%;">
<col style="width: 50%;">

<tr valign=top>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-left-color: #000000;
			border-left-style: Solid;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-left-width: 1px;
			border-top-width: 1px;
			border-bottom-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0
	width=50%>
<p style="font-weight: bold;">Name </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-top-width: 1px;
			border-bottom-width: 1px;
			border-right-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0
	width=50%>
<p style="font-weight: bold;">Description</p></td></tr>

<tr valign=top>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-left-width: 1px;
			border-left-color: #000000;
			border-left-style: Solid;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;"
	width=50%>
<p>&nbsp;1 </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;"
	width=50%>
<p>In case of success</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>-1</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>Invalid cabinet name</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>-2</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>Local cabinet is read-only</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>-3</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>Cabinet not connected</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>-12</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>Invalid folder Name</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>-24</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>Invalid File Path</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>-201</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>Insufficient rights for the current operation</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>-133</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=50%>
<p>User not logged in</p></td></tr>
</table>

<p>&nbsp;</p>

<p style="font-weight: bold; color: #000080;">Example</p>

<p style="font-style: italic;">&nbsp;&nbsp;&nbsp; Dim <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo 
 <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->
As 
 TagDocument</p>

<p style="font-style: italic;">&nbsp;&nbsp;&nbsp; Dim <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Document 
 <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp; <!--kadov_tag{{</spaces>}}--> As 
 Byte </p>

<p style="font-style: italic;">&nbsp;&nbsp;&nbsp; Dim gPDb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
As PanDb.pdbCls<br>
&nbsp;&nbsp;&nbsp; Dim l<!--kadov_tag{{</spaces>}}-->RetVal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
As Long&nbsp;&nbsp;&nbsp; </p>

<p style="font-style: italic;">&nbsp;&nbsp;&nbsp; Dim <i> FileName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
As String</i> </p>

<p style="font-style: italic;">&nbsp; </p>

<p style="font-style: italic;">&nbsp;&nbsp;&nbsp; Set gPDb = New PanDb.pdbCls<br>
 </p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.FolderId 
 = 54</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.NoOfPages 
 = 0</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.Owner 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->= 8</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.DataDefId 
 <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->= 
 0</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.DocumentSize 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->= 0</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.FTSDocId 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->= 0</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.CheckOutBy 
 = 0 <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.FinalizedBy 
 = 0</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.FiledBy 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->= 0</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.AccessType 
 = “I”</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.DocType 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->= “txt”</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.ExpiryDateTime 
 = “11/13/12 1:00:05 PM”</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.DocName 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->= “mydoc”</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->DocInfo.Author 
 = “Nikesh”</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}--></p>

<p style="font-style: italic;"><!--kadov_tag{{</spaces>}}-->&nbsp;&nbsp;&nbsp;
Redim Document(len(DocInfo) -1)</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp; &nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Call 
 CopyMemory(Document(0), DocInfo, Len(DocInfo))</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}--></p>

<p style="font-style: italic;">&nbsp;&nbsp;&nbsp; FileName = &quot;&quot;</p>

<p style="font-style: italic;">&nbsp;<!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp; &nbsp;l<!--kadov_tag{{</spaces>}}-->RetVal=gPDb.CreateDocument(DocInfo,<i>FileName</i>)</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->If 
 lRetVal &lt;&gt; NG_SUCCESS Then</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->MsgBox
gPDb.ErrDescription, vbInformation</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Screen.MousePointer 
 = vbNormal</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Exit 
 Sub</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->End 
 If</p>

</body>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
