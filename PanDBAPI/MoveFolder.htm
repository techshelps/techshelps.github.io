<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>MoveFolder</title>

<!--(Meta)==========================================================-->

<meta name=generator content="Microsoft FrontPage 4.0">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=1044>
<meta name=layout-width content=623>
<meta name=date content="12 12, 2002 6:52:14 PM">


<!--(Links)=========================================================-->

<link rel=StyleSheet href=default.css>



</head>

<!--(Body)==========================================================-->


<body>

<p style="font-weight: bold; color: #000080;">MoveFolder</p>

<p>Moves the folder from one folder to another within a cabinet or across
cabinet.</p>

<p><i>Public Function MoveFolder(ByVal FolderId As Long,                ByVal DestinationCabId As Integer,                ByVal DestinationFolderId As Long,&nbsp;<br>
                ByVal FolderName As String,                ByVal DuplicateNameFlag As String,                ByRef FolderProp() As Byte) As Long</i></p>

<p>&nbsp;</p>

<p style="font-weight: bold; color: #000080;">Parameters </p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0;"
		cellspacing=0
		width=100%>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">

<tr valign=top>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-left-color: #000000;
			border-left-style: Solid;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-left-width: 1px;
			border-top-width: 1px;
			border-bottom-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0
	width=25%>
<p style="font-weight: bold;">In/out </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-top-width: 1px;
			border-bottom-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0
	width=25%>
<p style="font-weight: bold;">Name </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-top-width: 1px;
			border-bottom-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0
	width=25%>
<p style="font-weight: bold;">Data type </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-top-width: 1px;
			border-bottom-width: 1px;
			border-right-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0
	width=25%>
<p style="font-weight: bold;">Description</p></td></tr>

<tr valign=top>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-left-width: 1px;
			border-left-color: #000000;
			border-left-style: Solid;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;"
	width=25%>
<p>In</p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;"
	width=25%>
<p>FolderId </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;"
	width=25%>
<p>Long </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;"
	width=25%>
<p>Index of the folder being moved</p></td></tr>

<tr valign=top>
<td style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>In</p></td>
<td style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>DestinationCabId </p></td>
<td style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Integer </p></td>
<td style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Index of destination cabinet&nbsp;</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>In</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>DestinationFolderId </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Long </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Index of destination folder</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>In</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>FolderName </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>String </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Name of Folder</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>In</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>DuplicateNameFlag </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>String </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Whether duplicate name is to be allowed</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>In/Out</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>FolderProp </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Byte </p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;"
	width=25%>
<p>Properties of folder in the form of byte array as a return parameter</p></td></tr>
</table>

<p>&nbsp;</p>

<p style="font-weight: bold; color: #000080;">Description</p>

<p>This function is called on both local and shared cabinet. It is called 
 when any folder is moved to some other folder either in the same cabinet 
 or other cabinet. Folder properties of the moved folder are returned after getting successfully 
 moved.</p>

<p><!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}--></p>

<p style="font-weight: bold; color: #000080;">Return value </p>

<!--(Table)=========================================================-->
<table x-use-null-cells
		style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0;"
		cellspacing=0
		width=100%>
<col style="width: 50%;">
<col style="width: 50%;">

<tr valign=top>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-left-color: #000000;
			border-left-style: Solid;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-left-width: 1px;
			border-top-width: 1px;
			border-bottom-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0>
<p style="font-weight: bold;">Name </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-top-color: #000000;
			border-top-style: Solid;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-color: #000000;
			border-bottom-style: Solid;
			border-top-width: 1px;
			border-bottom-width: 1px;
			border-right-width: 1px;
			background-color: #c0c0c0;"
	bgcolor=#C0C0C0>
<p style="font-weight: bold;">Description</p></td></tr>

<tr valign=top>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-left-width: 1px;
			border-left-color: #000000;
			border-left-style: Solid;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;">
<p>&nbsp;1 </p></td>
<td style="padding-right: 10px;
			padding-left: 10px;
			border-right-width: 1px;
			border-right-color: #000000;
			border-right-style: Solid;
			border-bottom-width: 1px;
			border-bottom-color: #000000;
			border-bottom-style: Solid;">
<p>In case of success</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;">
<p>-2</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;">
<p>Invalid operation in <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->read 
 only cabinet</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;">
<p>-3</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;">
<p>Cabinet not connected</p></td></tr>

<tr valign=top>
<td colspan=1
	rowspan=1
	style="border-left-style: Solid;
			border-left-color: #000000;
			border-left-width: 1px;
			border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;">
<p>-201</p></td>
<td colspan=1
	rowspan=1
	style="border-right-style: Solid;
			border-right-color: #000000;
			border-right-width: 1px;
			border-bottom-style: Solid;
			border-bottom-color: #000000;
			border-bottom-width: 1px;
			padding-right: 10px;
			padding-left: 10px;">
<p>Insufficient rights for the current operation</p></td></tr>
</table>

<p>&nbsp;</p>

<p style="font-weight: bold; color: #000080;">Example</p>

<p style="font-style: italic;">Dim FolderId <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->&nbsp;&nbsp;
As 
 Long</p>

<p style="font-style: italic;">Dim DestinationCabId <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->&nbsp;&nbsp;
As 
 Integer</p>

<p style="font-style: italic;">Dim DestinationFolderId <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->&nbsp;&nbsp;
As 
 Long</p>

<p style="font-style: italic;">Dim FolderName <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->&nbsp;
As 
 String</p>

<p style="font-style: italic;">Dim DuplicateNameFlag <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->&nbsp;
As 
 String</p>

<p style="font-style: italic;">Dim FolderProp() <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->
As 
 Byte </p>

<p style="font-style: italic;">Dim lRetval <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->As 
 Long</p>

<p style="font-style: italic;">Dim gPDb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
As PanDb.pdbCls</p>

<p style="font-style: italic;"><br>
Set gPDb = New PanDb.pdbCls</p>

<p style="font-style: italic;">FolderId = 45</p>

<p style="font-style: italic;">DestinationCabId = 3</p>

<p style="font-style: italic;">DestinationFolderId = 34</p>

<p style="font-style: italic;">FolderName = “”</p>

<p style="font-style: italic;">DuplicateNameFlag = “N”</p>

<p style="font-style: italic;">lRetVal=gPDb.MoveFolder(FolderId,DestinationCabId,DestinationFolderId,FolderName,DuplicateNameFlag,FolderProp)</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}--><!--kadov_tag{{</spaces>}}-->if 
 lRetVal &lt;&gt; NG_SUCCESS Then</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}--> &nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->MsgBox
gPDb.ErrDescription, vbInformation</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Screen.MousePointer 
 = vbNormal</p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--kadov_tag{{</spaces>}}-->Exit 
 Sub </p>

<p style="font-style: italic;"><!--kadov_tag{{<spaces>}}--><!--kadov_tag{{</spaces>}}-->End 
 If</p>

</body>

</html>
