<html dir="ltr"><head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META HTTP-EQUIV="assetid" CONTENT="HP05238551"><META NAME="lcid" CONTENT="1033"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>About creating an OLAP cube from relational data</title><link rel="stylesheet" type="text/css" href="office10.css"><script type="text/javascript" language="Javascript" src="ExpCollapse.js"></script><script type="text/javascript" language="JavaScript" src="inline.js"></script></head><body><p id="ExpandAllLine" class="ExpFav"><a href="#" onclick="ExpandAll()" onkeypress="ExpandAll()" class="DropDown"><img id="picHeader" border="0" src="expandtri.gif" alt="Show All"><span id="ExpandAll">Show All</span></a></p><h1>About creating an OLAP cube from relational data</h1><p>This topic explains how you can create an OLAP <a href="#" class="glossary" onclick="AppendPopup(this,'xldefCubeDef')" onkeypress="AppendPopup(this,'xldefCubeDef')">cube</a> from a query that retrieves data from a relational database, such as Microsoft Access or Microsoft SQL Server. You do not need an OLAP server product to create and use this type of OLAP cube. To understand and use this capability of Microsoft Query, you should be familiar with managing databases and using Microsoft Query to retrieve data for Microsoft Excel <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_qudefPivotTable')" onkeypress="AppendPopup(this,'IDH_qudefPivotTable')">PivotTable reports</a> or <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefPivotChart')" onkeypress="AppendPopup(this,'IDH_xldefPivotChart')">PivotChart reports</a>.</p><p>This topic provides reference information about the following:</p><p><a href="#quconaboutcreatingolapcubeforquerieddata_1">What is an OLAP cube</a>?</p><p><a href="#quconaboutcreatingolapcubeforquerieddata_2">Creating a query for the data</a></p><p><a href="#quconaboutcreatingolapcubeforquerieddata_3">Creating a cube</a></p><p><a href="#quconaboutcreatingolapcubeforquerieddata_4">Refreshing and changing a cube</a></p><h2><a id="quconaboutcreatingolapcubeforquerieddata_1" name="quconaboutcreatingolapcubeforquerieddata_1"></a>What is an OLAP cube?</h2><p>On-Line Analytical Processing (<a href="#" class="glossary" onclick="AppendPopup(this,'xldefOLAP')" onkeypress="AppendPopup(this,'xldefOLAP')">OLAP</a>) is a way of organizing data to fit the way you analyze and manage it, so that less time and effort is needed to create your reports. When you create an OLAP cube from a <a href="#" class="glossary" onclick="AppendPopup(this,'xldefQuery')" onkeypress="AppendPopup(this,'xldefQuery')">query</a>, you turn the flat set of records into a structured hierarchy, or cube, that allows reports to focus on the desired level of detail. You also predefine the summary values for the reports, which speeds up report calculation.</p><p>Create an OLAP cube when you want to provide a large amount of external data for use in Microsoft Excel reports, especially if you have more records to analyze than you can return to Excel without running out of system resources. Because a cube allows Excel to retrieve only the data it needs for the current view of the report, creating and updating a report is usually faster for large amounts of data than if you retrieved the entire set of records from the database.</p><p>The data from your OLAP cube can be returned to Excel only as a PivotTable or PivotChart report, unlike the relational database records in your query, which can also be returned to Excel as an <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefExternalDataRange')" onkeypress="AppendPopup(this,'IDH_xldefExternalDataRange')">external data range</a> on a worksheet.</p><p>Return to <a href="#quconaboutcreatingolapcubeforquerieddata">top</a></p><h2><a id="quconaboutcreatingolapcubeforquerieddata_2" name="quconaboutcreatingolapcubeforquerieddata_2"></a>Creating a query for the data</h2><p>To create an OLAP cube from relational database records, you <a href="quhowSpecifySourceToRetrieveDataFrom1.htm" id="HP05206804" lcid=" ">set up a data source</a> for the relational database and then <a href="qutbcCreateNewQuery1.htm" id="HP05206400" lcid=" ">create a query</a> to retrieve the fields and records to supply the data for the cube.</p><p><b class="bterm">Selecting fields for the query</b>   To ensure that the query runs as efficiently as possible, include only the <a href="#" class="glossary" onclick="AppendPopup(this,'qudefTable')" onkeypress="AppendPopup(this,'qudefTable')">tables</a> and fields that you need for the cube in the query. However, make sure you <a href="quhowAddFieldToQuery1.htm" id="HP05206144" lcid=" ">add all the fields</a> you want. After you have created a cube, you cannot add more <a href="#" class="glossary" onclick="AppendPopup(this,'qudefTable')" onkeypress="AppendPopup(this,'qudefTable')">fields</a> to the query and then incorporate the new fields into the cube. To add more fields to a cube, you must completely re-create the cube.</p><p><b class="bterm">Adding fields more than once</b>   Sometimes, you might want to use a field more than once in a cube. For example, you might want to summarize a Sales field in two different ways, by adding up the sales amounts and by counting the number of sales. Or you might want to include two different versions of a Date field: one that organizes the dates by quarter and month, and another that organizes the dates by quarter and week. To use a field more than once in a cube, you must <a href="quhowAddFieldToQuery1.htm" id="HP05206144" lcid=" ">add the field to the query</a> once for each use. For example, add the Sales field to the query twice if you plan to both add up and count the values in the field.</p><p>See Help in the OLAP Cube Wizard for specifics of when to include a field in the query more than once. If you find that you need to add fields to the query while running the wizard, you can cancel the wizard, add the fields, and then run the wizard again.</p><p><b class="bterm">Saving the query</b>   If you think you might want to re-create the cube later with different fields, be sure to <a href="quhowSaveQueryFileForReuse1.htm" id="HP05206763" lcid=" ">save the query in a database query (.dqy) file</a>. You can then open the .dqy file, change the query, and create new cubes from the changed query.</p><p>Return to <a href="#quconaboutcreatingolapcubeforquerieddata">top</a></p><h2><a id="quconaboutcreatingolapcubeforquerieddata_3" name="quconaboutcreatingolapcubeforquerieddata_3"></a>Creating a cube</h2><p>To create a cube, you <a href="quhowCreateOLAPCube.htm" id="HP05248094" lcid=" ">run the OLAP Cube Wizard</a>. See Help in this wizard for specific instructions for each wizard step.</p><p><b class="bterm">Temporary cubes and offline cube files</b>   The wizard lets you create two types of cubes. One type is a <a href="#" class="glossary" onclick="AppendPopup(this,'xldefCubeDef')" onkeypress="AppendPopup(this,'xldefCubeDef')">cube definition</a> that the wizard saves in an .oqy file. When you open a report that's based on this type of .oqy file, the cube is built temporarily in memory. The second type is a separate <a href="#" class="glossary" onclick="AppendPopup(this,'xldefOfflineCubeFile')" onkeypress="AppendPopup(this,'xldefOfflineCubeFile')">offline cube file</a> that you store on your local disk or a network share. If stored on your local disk, this type of cube allows you to continue working with the data when you are disconnected from the network. You can set up an offline cube file as a <a href="#" class="glossary" onclick="AppendPopup(this,'qudefDataSource')" onkeypress="AppendPopup(this,'qudefDataSource')">data source</a> for reports.</p><p><b class="bterm">Saving a cube definition file</b>   Whether or not you save a separate offline cube file, the wizard saves a cube definition (.oqy) file. This file contains the information that Microsoft Query needs to load the cube so that you can change it, and the information Excel needs to either build the cube in memory or connect to an offline cube file, if you created one.</p><p><b class="bterm">Using the cube definition file to create reports</b>   Instead of returning the records in your relational database query to Microsoft Excel, you can open the .oqy file in Excel to create a PivotTable report that's based on your OLAP cube. You can then save the PivotTable report in a workbook or create PivotChart reports that are based on the PivotTable report. For instructions to open .oqy files and create reports, see Help in Excel.</p><p>Return to <a href="#quconaboutcreatingolapcubeforquerieddata">top</a></p><h2><a id="quconaboutcreatingolapcubeforquerieddata_4" name="quconaboutcreatingolapcubeforquerieddata_4"></a>Refreshing and changing a cube</h2><p><b class="bterm">Refreshing an OLAP cube</b>   To refresh a cube, you open a report that's based on the cube in Microsoft Excel and refresh the report. When you do this, new and changed data from the original database is brought into the cube, if the cube is built temporarily in memory. If the cube is an offline cube file, the file is rebuilt with the new data and the existing file is replaced. To create your own cubes and refresh them, you must have an <a href="#" class="glossary" onclick="AppendPopup(this,'xldefOLAPProvider')" onkeypress="AppendPopup(this,'xldefOLAPProvider')">OLAP provider</a>, such as Microsoft SQL Server OLAP Services, that supports these capabilities. See Help in Excel for the procedure to refresh a PivotTable or PivotChart report that's based on an OLAP cube.</p><p><b class="bterm">Changing an OLAP cube</b>   You can <a href="qudecChangeCube.htm" id="HP05248097" lcid=" ">change an OLAP cube</a> that you created in the OLAP Cube Wizard to organize the data differently or remove fields that you don't want to use in reports. If you created an offline cube file, you can save the file with your changes.</p><p>After you create an OLAP cube, you cannot add more fields to it from the original relational database. You can, however, create a new OLAP cube from the same database query (.dqy) file so that you can use different fields from the original database.</p><p>Return to <a href="#quconaboutcreatingolapcubeforquerieddata">top</a></p></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>