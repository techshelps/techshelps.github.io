<html dir="ltr"><head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META HTTP-EQUIV="assetid" CONTENT="HP05206488"><META NAME="lcid" CONTENT="1033"><title>Fetch and Fetch.Advise Commands (DDE)</title><link rel="stylesheet" type="text/css" href="office10.css"><script type="text/javascript" language="Javascript" src="ExpCollapse.js"></script><script type="text/javascript" language="JavaScript" src="inline.js"></script></head><body><p id="ExpandAllLine" class="ExpFav"><a href="#" onclick="ExpandAll()" onkeypress="ExpandAll()" class="DropDown"><img id="picHeader" border="0" src="expandtri.gif" alt="Show All"><span id="ExpandAll">Show All</span></a></p><h1>Fetch and Fetch.Advise Commands (DDE)</h1><p>The <b class="ui">Fetch</b> command retrieves data from Microsoft Query and sends it directly to the destination program.</p><p>The <b class="ui">Fetch.Advise</b> command updates the destination program automatically as values in Microsoft Query change, not just when the <b class="ui">Fetch.Advise</b> command is sent.</p><p>These commands are available on both the <a href="#" class="glossary" onclick="AppendPopup(this,'defSystemChannel')" onkeypress="AppendPopup(this,'defSystemChannel')">system channel</a> and the <a href="#" class="glossary" onclick="AppendPopup(this,'defQueryChannel')" onkeypress="AppendPopup(this,'defQueryChannel')">query channel</a>.</p><p><b class="bterm">Syntax 1</b></p><p><b class="bterm">Fetch.Advise</b>(<i>appname, topic, range, values</i>)</p><p><b class="bterm">Syntax 2</b></p><p><b class="bterm">Fetch</b>(<i>appname</i>, <i>topic</i>, <i>range</i>, <i>values</i>)</p><p><i>appname</i>   The name of the destination program to which the data is to be sent. Here are the <i>appname</i> arguments you'd use for Office programs:</p><table>
			<tr>
				<th>Program</th>
				<th>Value of appname</th>
			</tr>
			<tr>
				<td>Microsoft Access</td>
				<td>MSAccess</td>
			</tr>
			<tr>
				<td>Microsoft Excel</td>
				<td>Excel</td>
			</tr>
			<tr>
				<td>Microsoft Word</td>
				<td>WinWord</td>
			</tr>
		</table><br><p><i>topic</i>   The name of the worksheet, document, or control to which the data is to be sent.</p><p><i>range</i>   The area of the worksheet, document, or control to which the data is to be sent.</p><p><i>values</i>   The values to be retrieved from Microsoft Query. (For valid values, see the table below.)</p><p><b>Note</b>  The <b class="ui">Fetch.Advise</b> command automatically updates only query data, not request items or row#col# references.</p><p>Can be one of the following values:</p><table>
			<tr>
				<th>Value</th>
				<th>Description</th>
			</tr>
			<tr>
				<td>Request_item</td>
				<td>The information to return; for example, QueryDefinition.</td>
			</tr>
			<tr>
				<td><i>row#col#</i></td>
				<td>A reference to retrieve specific rows and columns, such as R3C5 from Microsoft Excel.</td>
			</tr>
			<tr>
				<td>/Headers</td>
				<td>Retrieves column names.</td>
			</tr>
			<tr>
				<td>/Rownum</td>
				<td>Retrieves row numbers.</td>
			</tr>
			<tr>
				<td>All</td>
				<td>Retrieves all records.</td>
			</tr>
		</table><br><b class="ui">Remarks</b><p>For <b class="ui">Fetch.Advise</b>, the channel created to return data to the destination program isn't closed until a <a href="DDEFetchUnadviseCommand1.htm" id="HP05206489" lcid=" ">Fetch.Unadvise</a> or <a href="DDECloseCommand1.htm" id="HP05206359" lcid=" ">Close</a> command is sent.</p><p><b class="bterm">Example</b></p><p>This example uses the NumRows and NumCols request items to return the number of rows and columns in the query, and then returns the values with column headings to a Microsoft Excel worksheet named "Sheet1."</p><pre>
<code>rows=REQUEST(Chan,"NumRows")
cols=REQUEST(Chan,"NumCols")
DDEExecute chan, "[Fetch(""Excel"", ""Data.xls!Sheet1"", _
    ""R1C1:R"&amp;rows&amp;"C"&amp;cols&amp;""", ""All/Headers"")]"</code>
		</pre></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>