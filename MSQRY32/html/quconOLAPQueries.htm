<html dir="ltr"><head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META HTTP-EQUIV="assetid" CONTENT="HP05248091"><META NAME="lcid" CONTENT="1033"><title>About OLAP queries</title><link rel="stylesheet" type="text/css" href="office10.css"><script type="text/javascript" language="Javascript" src="ExpCollapse.js"></script><script type="text/javascript" language="JavaScript" src="inline.js"></script></head><body><p id="ExpandAllLine" class="ExpFav"><a href="#" onclick="ExpandAll()" onkeypress="ExpandAll()" class="DropDown"><img id="picHeader" border="0" src="expandtri.gif" alt="Show All"><span id="ExpandAll">Show All</span></a></p><h1>About OLAP queries</h1><p>Microsoft Query allows you to create and work with data from On-Line Analytical Processing (<a href="#" class="glossary" onclick="AppendPopup(this,'xldefOLAP')" onkeypress="AppendPopup(this,'xldefOLAP')">OLAP</a>) databases by setting up <a href="#" class="glossary" onclick="AppendPopup(this,'qudefDataSource')" onkeypress="AppendPopup(this,'qudefDataSource')">data sources</a>, creating OLAP cubes from relational data, and saving OLAP <a href="#" class="glossary" onclick="AppendPopup(this,'xldefCubeDef')" onkeypress="AppendPopup(this,'xldefCubeDef')">cube definition</a> files. This topic explains how to use Microsoft Query to prepare OLAP data for use in Microsoft Excel <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_qudefPivotTable')" onkeypress="AppendPopup(this,'IDH_qudefPivotTable')">PivotTable reports</a> and <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefPivotChart')" onkeypress="AppendPopup(this,'IDH_xldefPivotChart')">PivotChart reports</a>.</p><p>This topic provides information about the following:</p><p><a href="#quconolapqueries_1">What is OLAP</a>?</p><p><a href="#quconolapqueries_2">Connecting to OLAP databases</a></p><p><a href="#quconolapqueries_3">Creating an OLAP cube from records in a query</a></p><p><a href="#quconolapqueries_4">Saving OLAP query files</a></p><h2><a id="quconolapqueries_1" name="quconolapqueries_1"></a>What is OLAP?</h2><p>OLAP is a way to organize large business databases. OLAP data is organized by a database administrator to fit the way users analyze and manage it, so less time and effort is needed to create your reports.</p><p><b class="bterm">Levels of detail</b>   OLAP databases organize data by level of detail, using the same kinds of categories that you use when you analyze the data. For example, a database of worldwide sales information for a company's products might have separate fields identifying the country, region, city, and site of each sale. In an OLAP database, this geographical information could be organized from lowest to highest level of detail, like this:</p><p><img border="0" src="../img/olapd.gif" alt="Levels in geography dimension"></p><p>Levels in a geography dimension</p><p>This organization makes it easy both to display high-level sales summaries, such as sales totals across an entire country or region, and to display the details for sites where sales are particularly strong or weak. In a Microsoft Excel PivotTable or PivotChart report, you can display summarized data at different levels and, when you view the levels that contain greater detail, display only the items of interest.</p><p><b class="bterm">Dimensions and cubes</b>   A set of levels that encompasses one aspect of the data, such as geographic areas, is called a dimension. Similarly, information about when sales were made can be organized in a time dimension with levels for year, quarter, month, and day. OLAP databases are called cubes because they combine several dimensions, such as time, geography, and products, with summarized data, such as sales or inventory figures. An OLAP database calculates a summarized value for every intersection of every level of every dimension, such as the total sales for each day, month, and year of each site, region, and country and each product and product line.</p><p>Return to <a href="#quconolapqueries">top</a></p><h2><a id="quconolapqueries_2" name="quconolapqueries_2"></a>Connecting to OLAP databases</h2><p><b class="bterm">OLAP providers</b>   To connect to an OLAP database, you need an <a href="#" class="glossary" onclick="AppendPopup(this,'xldefOLAPProvider')" onkeypress="AppendPopup(this,'xldefOLAPProvider')">OLAP provider</a> that supports that particular type of OLAP database. Microsoft Office includes OLAP provider software for the Microsoft OLAP server product, Microsoft SQL Server OLAP Services. For other products that provide OLAP data and services, you need to install additional drivers and client software. For information about using a third-party OLAP provider, consult your system administrator or the vendor for your OLAP product. Learn about <a href="quhowInstallOLAP.htm" id="HP05238845" lcid=" ">installing OLAP providers</a>.</p><p><b class="bterm">Data sources</b>   OLAP client software includes a <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefDataSourceDriver')" onkeypress="AppendPopup(this,'IDH_xldefDataSourceDriver')">data source driver</a> for your OLAP database. Office includes a driver, named <b class="ui">Microsoft OLE DB Provider for OLAP Services</b>, to access databases that were created by using Microsoft SQL Server OLAP Services. When you <a href="#quconolapqueries_3">create cubes or offline cube files from within Microsoft Query</a>, you also create data sources to access these cubes.</p><p>When you run Microsoft Query to connect to an OLAP database or offline cube file, you set up a new data source just as you do for any other kind of data, except that you use the <b class="ui">OLAP Cubes</b> tab in the <b class="ui">Choose Data Source</b> dialog box to name the data source, specify the data source driver for your OLAP provider, and connect to the database. <a href="quhowSpecifySourceToRetrieveDataFrom1.htm" id="HP05206804" lcid=" ">How to set up a data source</a>.</p><p><b class="bterm">Returning data to Excel</b>   After you set up an OLAP data source and select it for use, you don't create a query to select tables and fields as you do for other kinds of data. The data source gives you access to all data in the OLAP cube. The data fields are immediately returned to Excel as a PivotTable report.</p><p>Return to <a href="#quconolapqueries">top</a></p><h2><a id="quconolapqueries_3" name="quconolapqueries_3"></a>Creating an OLAP cube from records in a query</h2><p>By using Microsoft Query and the OLAP client software that's provided with Microsoft Office, you can create your own OLAP cube or <a href="#" class="glossary" onclick="AppendPopup(this,'xldefOfflineCubeFile')" onkeypress="AppendPopup(this,'xldefOfflineCubeFile')">offline cube file</a> from data that you query from a relational database, such as Microsoft SQL Server. Creating an OLAP cube can make accessing large amounts of relational data more efficient and can help organize the data for use in reports. You do not need an OLAP server product to create and use this type of OLAP cube.</p><p><b class="bterm">Retrieving the data for the cube</b>   To create your own cube, you first <a href="quhowSpecifySourceToRetrieveDataFrom1.htm" id="HP05206804" lcid=" ">set up a data source</a> for the relational database, <a href="qutbcCreateNewQuery1.htm" id="HP05206400" lcid=" ">create a query</a> to retrieve the data, and then run the OLAP Cube Wizard to define a cube structure for the queried data and, optionally, save an offline cube file.</p><p><b class="bterm">Creating a cube that's built in memory</b>   In the OLAP Cube Wizard, you can create a temporary cube that's rebuilt in memory whenever you open a report that's based on the cube. See Help in the OLAP Cube Wizard for information about when to create this type of cube. Learn about <a href="quconAboutCreatingOLAPCubeForQueriedData.htm" id="HP05238551" lcid=" ">running the wizard to create an OLAP cube</a>.</p><p><b class="bterm">Creating an offline cube file</b>   The OLAP Cube Wizard also lets you create an offline cube (.cub) file that you can store on your local disk or a network share. When stored on your local disk, you can use a .cub file to continue working with the data when you're disconnected from the network or the server is unavailable. If you store the file on a network share, you and other users can <a href="quhowSpecifySourceToRetrieveDataFrom1.htm" id="HP05206804" lcid=" ">set up data sources</a> to access the offline cube file and base reports on it. Learn about <a href="quconAboutCreatingOLAPCubeForQueriedData.htm" id="HP05238551" lcid=" ">running the wizard to create an offline cube file</a>.</p><p>Return to <a href="#quconolapqueries">top</a></p><h2><a id="quconolapqueries_4" name="quconolapqueries_4"></a>Saving OLAP query files</h2><p><b class="bterm">OLAP data sources</b>   When you use the <b class="ui">OLAP Cubes</b> tab of the <b class="ui">Choose Data Source</b> dialog box to set up a data source, Microsoft Query saves an .oqy file in your <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_ofdefUserProfile')" onkeypress="AppendPopup(this,'IDH_ofdefUserProfile')">user profile folder</a> under Application Data\Microsoft\Queries. In addition to specifying the data source when you create a PivotTable or PivotChart report in Excel, you can open the .oqy file directly from Excel to create a PivotTable report. If the .oqy file connects to an OLAP server database or to an offline cube file on a network share, you can make the .oqy file available to other users, who can then open it to create reports without having to set up their own data sources.</p><p><b class="bterm">OLAP Cube Wizard cubes</b>   After the final step in the OLAP Cube Wizard, you are prompted to save a <a href="#" class="glossary" onclick="AppendPopup(this,'xldefCubeDef')" onkeypress="AppendPopup(this,'xldefCubeDef')">cube definition</a> file with the extension .oqy. This file contains the information that Excel needs to either build the cube in memory or connect to an offline cube file, if you created one. Instead of returning the records in your query to Microsoft Excel, you can open this file in Microsoft Excel to create a PivotTable report. You do not have to set up a separate data source for the OLAP cube, although you can <a href="quhowSpecifySourceToRetrieveDataFrom1.htm" id="HP05206804" lcid=" ">set up a separate data source</a> for an offline cube file if you want to connect directly to the cube file in order to create reports.</p><p>Saving the .oqy file is not the same as saving a copy of the query for the relational database records that you used to create the OLAP cube. If you want to keep a copy of that query so that you can add data to your cube later on, you must <a href="quhowSaveQueryFileForReuse1.htm" id="HP05206763" lcid=" ">save the query in a database query (.dqy) file</a>.</p><p>Return to <a href="#quconolapqueries">top</a></p></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>