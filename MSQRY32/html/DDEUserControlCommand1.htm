<html dir="ltr"><head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META HTTP-EQUIV="assetid" CONTENT="HP05206890"><META NAME="lcid" CONTENT="1033"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>UserControl Command (DDE)</title><link rel="stylesheet" type="text/css" href="office10.css"><script type="text/javascript" language="Javascript" src="ExpCollapse.js"></script><script type="text/javascript" language="JavaScript" src="inline.js"></script></head><body><p id="ExpandAllLine" class="ExpFav"><a href="#" onclick="ExpandAll()" onkeypress="ExpandAll()" class="DropDown"><img id="picHeader" border="0" src="expandtri.gif" alt="Show All"><span id="ExpandAll">Show All</span></a></p><h1>UserControl Command (DDE)</h1><p>Activates Microsoft Query and allows users to create, open, or edit a query as if they were running Microsoft Query as a standalone program.</p><p>This command is available only on the <a href="#" class="glossary" onclick="AppendPopup(this,'defSystemChannel')" onkeypress="AppendPopup(this,'defSystemChannel')">system channel</a>.</p><p><b class="bterm">Syntax</b></p><p><b class="bterm">UserControl</b>(<i>exittext, appstate, newquery</i>)</p><p><i>exittext</i>   The name of the <b class="ui">Exit</b> command used to exit Microsoft Query after a <a href="#" class="glossary" onclick="AppendPopup(this,'defDDEConversation')" onkeypress="AppendPopup(this,'defDDEConversation')">DDE conversation</a>. If this argument is omitted, "Return" is used.</p><p><i>appstate</i>   The state of the program. Can be one of the following values.</p><table>
			<tr>
				<th>Value</th>
				<th>Description</th>
			</tr>
			<tr>
				<td>1</td>
				<td>Normal</td>
			</tr>
			<tr>
				<td>2</td>
				<td>Minimized (Microsoft Windows only)</td>
			</tr>
			<tr>
				<td>3</td>
				<td>Maximized</td>
			</tr>
		</table><br><p>If this argument is omitted, the current state of Microsoft Query is used.</p><p><i>newquery</i>   Specifies whether the <b class="ui">Choose Data Source</b> dialog box is displayed when Microsoft Query is started during a DDE conversation. Can be True or False.</p><p>If <i>newquery</i> is True, the <b class="ui">Choose Data Source</b> dialog box is displayed, asking the user to select a <a href="#" class="glossary" onclick="AppendPopup(this,'qudefDataSource')" onkeypress="AppendPopup(this,'qudefDataSource')">data source</a>. If <i>newquery</i> is False (the default), no dialog box is displayed and any open queries for that channel are accessible.</p><p><b class="bterm">Remarks</b></p><p>User control ends when the user clicks <b class="ui">Exit</b> on the <b class="ui">File</b> menu in Windows or <b class="ui">Quit</b> on the <b class="ui">File</b> menu on the Macintosh. Microsoft Query then returns to its previous program state and returns control to the destination program.</p><p><b class="bterm">Important</b>   Do not allow a program that includes a time-out feature to time out before user control ends.</p><p>While Microsoft Query is running under user control, any new or existing queries are opened on the same DDE channel.</p><p><b class="bterm">Example</b></p><p>This example starts Microsoft Query as a maximized program and replaces the <b class="ui">Exit</b> command on the <b class="ui">File</b> menu (or the <b class="ui">Quit</b> command on the <b class="ui">File</b> menu on the Macintosh) with the <b class="ui">Return Data to Microsoft Excel</b> command. Then it displays the <b class="ui">Choose Data Source</b> dialog box.</p><pre>
<code>DDEExecute chan, "[UserControl(""&amp;Return To Excel"",3,True)]")</code>
		</pre></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>