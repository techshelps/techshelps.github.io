<html dir="ltr"><head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META HTTP-EQUIV="assetid" CONTENT="HP05274749"><META NAME="lcid" CONTENT="1033"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>About using Microsoft Query to retrieve external data</title><link rel="stylesheet" type="text/css" href="office10.css"><script type="text/javascript" language="Javascript" src="ExpCollapse.js"></script><script type="text/javascript" language="JavaScript" src="inline.js"></script></head><body><p id="ExpandAllLine" class="ExpFav"><a href="#" onclick="ExpandAll()" onkeypress="ExpandAll()" class="DropDown"><img id="picHeader" border="0" src="expandtri.gif" alt="Show All"><span id="ExpandAll">Show All</span></a></p><h1>About using Microsoft Query to retrieve external data</h1><a id="quhowThumbAboutQuery" name="quhowThumbAboutQuery"></a><p>This topic contains information about:</p><p><a href="#quhowThumbAboutQuery_1">What is Microsoft Query</a>?</p><p><a href="#quhowThumbAboutQuery_2">Setting up data sources</a></p><p><a href="#quhowThumbAboutQuery_3">Defining your query</a></p><p><a href="#quhowThumbAboutQuery_4">Working with the data in Microsoft Excel</a></p><h2><a id="quhowThumbAboutQuery_1" name="quhowThumbAboutQuery_1"></a>What is Microsoft Query?</h2><p>Microsoft Query is a program for bringing data from external sources into other Microsoft Office programs<nbsp />— in particular, Microsoft Excel. By using Query to retrieve data from your corporate <a href="#" class="glossary" onclick="AppendPopup(this,'ofDatabase')" onkeypress="AppendPopup(this,'ofDatabase')">databases</a> and files, you don't have to retype the data you want to analyze in Excel. You can also update your Excel reports and summaries automatically from the original source database whenever the database is updated with new information.</p><p><b class="bterm">Types of databases you can access</b>   You can retrieve data from several types of databases, including Microsoft Access, Microsoft SQL Server, and Microsoft SQL Server OLAP Services. You can also retrieve data from Excel lists and from text files. See a list of <a href="qurefDatabasesYouCanAccessWithMicrosoftQuery.htm" id="HP05262724" lcid=" ">types of databases you can access</a>.</p><p>In Excel, you can also retrieve data from Web pages, but you don't need Query to do this. For information about retrieving data from Web pages, see Excel Help.</p><p><b class="bterm">Selecting data from a database</b>   You retrieve data from a database by creating a query, which is a question you ask about data stored in an external database. For example, if your data is stored in an Access database, you might want to know the sales figures for a specific product by region. You can retrieve a part of the data by selecting only the data for the product and region you want to analyze and omitting the data you don't need.</p><p><img border="0" src="../img/xqry01.gif" alt="Example of selecting data in Query"></p><p>With Query, you can select the columns of data that you want and bring only that data into Excel.</p><p><b class="bterm">Updating your worksheet in one operation</b>   After you have external data in an Excel workbook, whenever your database changes, you can <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefRefresh')" onkeypress="AppendPopup(this,'IDH_xldefRefresh')">refresh</a> the data to update your analysis<nbsp />— without having to recreate your summary reports and charts. For example, you can create a monthly sales summary and refresh it every month when the new sales figures come in.</p><p><b class="bterm">Using Query to retrieve data</b>   Bringing external data into Excel with Query takes three steps: First you <a href="#quhowThumbAboutQuery_2">set up a data source</a> to connect to your database, then you <a href="#quhowThumbAboutQuery_3">use the Query Wizard</a> to select the data you want, and finally you <a href="#quhowThumbAboutQuery_4">return the data to Excel</a> where you can format it, summarize it, and create reports from it.</p><p>Return to <a href="#quhowThumbAboutQuery">top</a></p><h2><a id="quhowThumbAboutQuery_2" name="quhowThumbAboutQuery_2"></a>Setting up data sources</h2><p><b class="bterm">What is a data source</b>?   A <a href="#" class="glossary" onclick="AppendPopup(this,'qudefDataSource')" onkeypress="AppendPopup(this,'qudefDataSource')">data source</a> is a stored set of information that allows Microsoft Excel and Microsoft Query to connect to an external database. When you use Query to set up a data source, you give the data source a name, and then supply the name and location of the database or server, the type of database, and your logon and password information. The information also includes the name of an <a href="#" class="glossary" onclick="AppendPopup(this,'ofdefODBCDriver')" onkeypress="AppendPopup(this,'ofdefODBCDriver')">ODBC driver</a> or a <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefDataSourceDriver')" onkeypress="AppendPopup(this,'IDH_xldefDataSourceDriver')">data source driver</a>, which is a program that makes connections to a specific type of database. For some types of external databases (<a href="#" class="glossary" onclick="AppendPopup(this,'xldefOLAP')" onkeypress="AppendPopup(this,'xldefOLAP')">OLAP</a> cubes), all you need to do to retrieve the data is to <a href="quhowSpecifySourceToRetrieveDataFrom1.htm" id="HP05206804" lcid=" ">set up a data source</a>.</p><p><b class="bterm">How Query uses data sources</b>   After you set up a data source for a particular database, you can use it whenever you want to create a query to select and retrieve data from that database<nbsp />— without having to retype all of the connection information. Query uses the data source to connect to the external database and show you what data is available. After you create your query and return the data to Excel, Query retrieves the data and provides the Excel workbook with both the query and data source information so you can reconnect to the database when you want to refresh the data.</p><p><img border="0" src="../img/xqry02.gif" alt="Diagram of how Query uses data sources"></p><p>A data source is the means through which Query and Excel connect to a specific database and retrieve data.</p><p>Return to <a href="#quhowThumbAboutQuery">top</a></p><h2><a id="quhowThumbAboutQuery_3" name="quhowThumbAboutQuery_3"></a>Defining your query</h2><p><b class="bterm">Use the Query Wizard for most queries</b>   The Query Wizard, which is part of Microsoft Query, is designed for users who are new to creating queries. The wizard makes it easy to select and bring together data from different tables and fields in your database. After you select the data, you can also use the wizard to filter and sort the results of your query. You can <a href="quhowCreateQueryUsingQueryWizard1.htm" id="HP05206402" lcid=" ">use the Query Wizard</a> either to create a complete query or to start a query that you make further changes to directly in Query.</p><p><b class="bterm">Work directly in Query for other types of queries</b>   If you are familiar with creating queries or you want to create a more complex query, you can <a href="quhowCreateNewQuery1.htm" id="HP05206399" lcid=" ">work directly in Query</a>. You can use Query to view and change queries you start creating in the Query Wizard, or you can create new queries without using the wizard.</p><p>Use Query directly when you want to create queries that do the following:</p><ul>
			<li><b class="bterm">Select specific data from a field</b>   In a large database, you might want to choose some of the data in a field and omit data you don't need. For example, if you need data for two of the products in a field that has information for many products, you can use <a href="#" class="glossary" onclick="AppendPopup(this,'ofCriteria')" onkeypress="AppendPopup(this,'ofCriteria')">criteria</a> to select data for only the two products you want. Learn about <a href="quhowThumbAboutCriteria.htm" id="HP05262293" lcid=" ">using criteria</a>.</li>
			<li><b class="bterm">Retrieve data based on different criteria each time you run the query</b>   If you need to create the same Excel report or summary for several areas in the same external data<nbsp />— such as a separate sales report for each region<nbsp />— you can create a type of query called a <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefParameterQuery')" onkeypress="AppendPopup(this,'IDH_xldefParameterQuery')">parameter query</a>. When you run a parameter query, you are prompted for the data to use as the criteria when the query selects records. For example, a parameter query might prompt you to enter a specific region, and you could reuse this query to create each of your regional sales reports. Learn about <a href="quhowCreateParameterQuery1.htm" id="HP05206401" lcid=" ">parameter queries</a>.</li>
			<li><b class="bterm">Combine data in different ways</b>   You can use Query to combine, or join, the data from different tables in your database. For example, if you have a table of product sales information and a table of customer information, you might join these tables in ways that show which customers have not made purchases recently. Learn about <a href="quhowRetrieveRecordsThumb.htm" id="HP05262300" lcid=" ">joining tables</a>.</li>
		</ul><p><b class="bterm">Creating an OLAP cube from the data in a query</b>   On-Line Analytical Processing (<a href="#" class="glossary" onclick="AppendPopup(this,'xldefOLAP')" onkeypress="AppendPopup(this,'xldefOLAP')">OLAP</a>) is a way of organizing data for querying and reporting instead of processing transactions. In an OLAP database, data is organized hierarchically and stored in <a href="#" class="glossary" onclick="AppendPopup(this,'ofCube')" onkeypress="AppendPopup(this,'ofCube')">cubes</a> instead of tables.</p><p>You can use Query to create an OLAP cube from the data in a query so that it takes less time and effort to create Microsoft Excel reports based on the data. To create an OLAP cube, you run the OLAP Cube Wizard from the Query Wizard or directly from Query. You can return the data to Excel as a <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_qudefPivotTable')" onkeypress="AppendPopup(this,'IDH_qudefPivotTable')">PivotTable report</a>. Learn about <a href="quconAboutCreatingOLAPCubeForQueriedData.htm" id="HP05238551" lcid=" ">creating an OLAP cube from queried data</a>.</p><h2>More information</h2><p><a href="quconGuidelinesForConstructingQuery1.htm" id="HP05206527" lcid=" ">When to use the Query Wizard versus Microsoft Query</a></p><p>Return to <a href="#quhowThumbAboutQuery">top</a></p><h2><a id="quhowThumbAboutQuery_4" name="quhowThumbAboutQuery_4"></a>Working with the data in Microsoft Excel</h2><p>After you create a query in either the Query Wizard or Microsoft Query, you can return the data to a Microsoft Excel worksheet. The data becomes an <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefExternalDataRange')" onkeypress="AppendPopup(this,'IDH_xldefExternalDataRange')">external data range</a> or a <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_qudefPivotTable')" onkeypress="AppendPopup(this,'IDH_qudefPivotTable')">PivotTable report</a> that you can format, analyze, and refresh.</p><p><b class="bterm">Formatting and analyzing the data</b>   In Excel, you can use familiar tools such as the Chart Wizard or automatic subtotals to present and summarize the data. You can format the data, and your formatting is retained when you refresh the external data from the source database. If you add columns of formulas to the external data range, the formulas can be copied automatically to any new rows that are added to the range when you refresh the data. You can use your own column labels instead of the field names, and add row numbers automatically. For information about controlling the formatting and layout of an external data range, see Excel Help.</p><p><b class="bterm">Reusing and sharing queries</b>   In both the Query Wizard and Query, you can <a href="quhowSaveQueryFileForReuse1.htm" id="HP05206763" lcid=" ">save a .dqy query file</a> that you can modify, reuse, and share. Excel can open .dqy files directly, which allows you or other users to create additional external data ranges from the same query.</p><p>If you want to share an Excel summary or report that is based on external data, you can give other users a workbook that contains an external data range, or you can create a <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefQueryTemplate')" onkeypress="AppendPopup(this,'IDH_xldefQueryTemplate')">report template</a>. A report template lets you save the summary or report without saving the external data so that the file is smaller. The external data is retrieved when a user opens the report template. For information about creating report templates, see Excel Help.</p><p><b class="bterm">Refreshing external data</b>   When you <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefRefresh')" onkeypress="AppendPopup(this,'IDH_xldefRefresh')">refresh</a> external data, you run the query to retrieve any new or changed data that matches your specifications. You can refresh a query in both Query and Excel. Excel provides several options for refreshing queries, including refreshing the data whenever you open the workbook and automatically refreshing it at timed intervals. You can continue to work in Excel while data is being refreshed, and you can also check the status while it's being refreshed. For information about refreshing external data in Excel, see Excel Help.</p><p>Return to <a href="#quhowThumbAboutQuery">top</a></p></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>