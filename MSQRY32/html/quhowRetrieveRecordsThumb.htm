<html dir="ltr"><head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META HTTP-EQUIV="assetid" CONTENT="HP05262300"><META NAME="lcid" CONTENT="1033"><title>Retrieve related records from multiple tables with joins</title><link rel="stylesheet" type="text/css" href="office10.css"><script type="text/javascript" language="Javascript" src="ExpCollapse.js"></script><script type="text/javascript" language="JavaScript" src="inline.js"></script></head><body><p id="ExpandAllLine" class="ExpFav"><a href="#" onclick="ExpandAll()" onkeypress="ExpandAll()" class="DropDown"><img id="picHeader" border="0" src="expandtri.gif" alt="Show All"><span id="ExpandAll">Show All</span></a></p><h1>Retrieve related records from multiple tables with joins</h1><p>This topic provides information about the following:</p><p><a href="#quhowRetrieveRecordsThumb_1">Joining tables</a></p><p><a href="#quhowRetrieveRecordsThumb_2">Inner joins</a></p><p><a href="#quhowRetrieveRecordsThumb_3">Outer joins</a></p><p><a href="#quhowRetrieveRecordsThumb_4">Self joins</a></p><p><a href="#quhowRetrieveRecordsThumb_5">Full outer joins</a></p><p><a href="#quhowRetrieveRecordsThumb_6">Subtract joins</a></p><h2><a id="#quhowRetrieveRecordsThumb_1" name="#quhowRetrieveRecordsThumb_1"></a>Joining tables</h2><p>Databases consist of multiple tables of related information. When you add two (or more) tables to a query, Microsoft Query automatically creates a "join" between the tables when it recognizes a <a href="#" class="glossary" onclick="AppendPopup(this,'IDH_xldefPrimaryKey')" onkeypress="AppendPopup(this,'IDH_xldefPrimaryKey')">primary key</a> field in one table and a <a href="#" class="glossary" onclick="AppendPopup(this,'qudefField')" onkeypress="AppendPopup(this,'qudefField')">field</a> with the same name in the other table. <a href="#" class="glossary" onclick="AppendPopup(this,'qudefJoinLine')" onkeypress="AppendPopup(this,'qudefJoinLine')">Join lines</a> show the relationships of the data in the tables.</p><p><img border="0" src="../img/xjoin1.gif" alt="Join lines between tables"></p><p>Join lines connect the Products table to the Order Details table by joining the ProductID field in each table. The Order Details table and the Orders table are also joined by their OrderID fields.</p><p>There are two basic types of joins that can be used to retrieve <a href="#" class="glossary" onclick="AppendPopup(this,'qudefRecord')" onkeypress="AppendPopup(this,'qudefRecord')">records</a> from multiple tables. An inner join retrieves only related records from the tables. An outer join retrieves all of the records from one table and related records from another table.</p><p>In addition to inner and outer joins, there are three other types of joins you can create<nbsp />— self, full outer, and subtract joins. A self-join returns a result set that combines information contained in one table. A full outer join returns all of the records from both tables, even if the records are not related. A subtract join returns only those records from the first table that do not match records in a second table.</p><p>Return to <a href="#quhowRetrieveRecordsThumb">top</a></p><h2><a id="#quhowRetrieveRecordsThumb_2" name="#quhowRetrieveRecordsThumb_2"></a>Inner joins</h2><p>An inner join<nbsp />— the default type of join<nbsp />— retrieves only records that have the same value in the joined fields in both tables. Microsoft Query combines the matching records from each table and displays them in the result set.</p><p><img border="0" src="../img/inerjoin.gif" alt="Example of an inner join"></p><p><b class="ui">More information</b></p><p><a href="qudecJoinTablesInQuery1.htm" id="HP05206576" lcid=" ">Join tables in a query</a></p><p><a href="quhowChangeTypeOfJoinBetweenTablesInQuery1.htm" id="HP05206345" lcid=" ">Change the type of join between tables in a query</a></p><p>Return to <a href="#quhowRetrieveRecordsThumb">top</a></p><h2><a id="#quhowRetrieveRecordsThumb_3" name="#quhowRetrieveRecordsThumb_3"></a>Outer joins</h2><p>An outer join retrieves all of the records from one table and any matching records from another table. When values in the two tables are the same, Microsoft Query combines the matching records and displays them as one record in the result set. When a record from the table that's contributing all of its records can't be matched with a record from the other table, the record still appears in the result set. However, Query displays empty cells where no matching record was present in the other table.</p><p><img border="0" src="../img/outerjoi.gif" alt="Example of an outer join"></p><p><b class="ui">More information</b></p><p><a href="qudecJoinTablesInQuery1.htm" id="HP05206576" lcid=" ">Join tables in a query</a></p><p><a href="quhowChangeTypeOfJoinBetweenTablesInQuery1.htm" id="HP05206345" lcid=" ">Change the type of join between tables in a query</a></p><p>Return to <a href="#quhowRetrieveRecordsThumb">top</a></p><h2><a id="#quhowRetrieveRecordsThumb_4" name="#quhowRetrieveRecordsThumb_4"></a>Self joins</h2><p>When you want to combine information in one table, use a self-join. For example, in a table of employees, each record includes the employee ID for the manager that an employee reports to. Because the manager is also in the same table as the employee, you can join the table to itself to return both the name and the employee ID of the manager.</p><p><img border="0" src="../img/xjoin8.gif" alt="Example of a self-join"></p><p>By joining the table to itself, you can retrieve both the ID and the name of the manager.</p><p><b class="ui">More information</b></p><p><a href="quhowCreateSelfJoin.htm" id="HP05252670" lcid=" ">Retrieve multiple fields with a self-join</a></p><p>Return to <a href="#quhowRetrieveRecordsThumb">top</a></p><h2><a id="#quhowRetrieveRecordsThumb_5" name="#quhowRetrieveRecordsThumb_5"></a>Full outer joins</h2><p>When you want to combine all of the data from two <a href="#" class="glossary" onclick="AppendPopup(this,'qudefTable')" onkeypress="AppendPopup(this,'qudefTable')">tables</a>, you can create a full outer join query. This type of query returns all of the data from both tables, even when the data is not related.</p><p><img border="0" src="../img/xjoin4.gif" alt="Tables with similar data before a full outer join"></p><p>For example, if you have a Customers table and an Orders table, you can use a full outer join to return all of the orders that are pending (from the Orders table) and all of the customers who have not placed an order (from the Customers table).</p><p><img border="0" src="../img/xjoin5.gif" alt="Result set showing customers who have not placed orders"></p><p>The first two names in this list have not placed orders.</p><p><b>Note</b>  When you create a full outer join, Query displays only the result set of the query, not the tables used within the query.</p><p><b class="ui">More information</b></p><p><a href="qutbcQueryWontLetMeCombineDataFromTwoMicrosoftExcelLists1.htm" id="HP05206607" lcid=" ">Combine all the data from two tables</a></p><p>Return to <a href="#quhowRetrieveRecordsThumb">top</a></p><h2><a id="#quhowRetrieveRecordsThumb_6" name="#quhowRetrieveRecordsThumb_6"></a>Subtract joins</h2><p>When you have two <a href="#" class="glossary" onclick="AppendPopup(this,'qudefTable')" onkeypress="AppendPopup(this,'qudefTable')">tables</a> that have similar data, such as two tables of customers, and each table has some information that is not included in the other table, you can create a subtract join. A subtract join returns only the <a href="#" class="glossary" onclick="AppendPopup(this,'qudefRecord')" onkeypress="AppendPopup(this,'qudefRecord')">records</a> from the first table that do not match the records from the second table.</p><p><img border="0" src="../img/xjoin6.gif" alt="Tables with similar data before a subtract join"></p><p>Two tables with similar customer data</p><p><img border="0" src="../img/xjoin7.gif" alt="Example of a subtract join"></p><p><b class="ui">More information</b></p><p><a href="qutbcIWantToSeeRecordsThatTwoTablesDontHaveInCommon1.htm" id="HP05206543" lcid=" ">Retrieve records that two tables do not have in common</a></p><p>Return to <a href="#quhowRetrieveRecordsThumb">top</a></p></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>