<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>KeyDown, KeyUp Events (ActiveX Controls)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtkeydownactivexcontrols"></a>KeyDown, KeyUp Events (ActiveX Controls)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtKeyDownActiveXControls_C;vbevtKeyDownActiveXControlsC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtKeyDownActiveXControls_X;vbevtKeyDownActiveXControlsX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtKeyDownActiveXControls_A;vbevtKeyDownActiveXControlsA">
</object></p>
<p>
Occur when the user presses (KeyDown) or releases (KeyUp) a key while an object has the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deffocus">
</object><a href=JavaScript:alink_4.Click()>focus</a>. (To interpret <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defansi">
</object><a href=JavaScript:alink_5.Click()>ANSI</a> characters, use the KeyPress event.)</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub</b> <b>Form_KeyDown(</b><i>keycode</i> <b>As Integer</b>, <i>shift</i> <b>As Integer)</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_KeyDown(</b>[<i>index</i> <b>As Integer</b>,]<i>keycode</i> <b>As Integer</b>, <i>shift</i> <b>As Integer)</b></p>
<p>
<b>Private Sub</b> <b>Form_KeyUp(</b><i>keycode</i> <b>As Integer</b>, <i>shift</i> <b>As Integer)</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_KeyUp(</b>[<i>index</i> <b>As Integer</b>,]<i>keycode</i> <b>As Integer</b>, <i>shift</i> <b>As Integer)</b></p>
<p>
The KeyDown and KeyUp event syntaxes have these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Part</b></td>
<td class=label width=81%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><i>object</i></td>
<td width=81%>An <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_6.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=19%><i>index</i></td>
<td width=81%>An integer that uniquely identifies a control if it's in a <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcontrolarray">
</object><a href=JavaScript:alink_7.Click()>control array</a>.</td>
</tr>
<tr valign=top>
<td width=19%><i>keycode</i></td>
<td width=81%>A key code, such as <b>vbKeyF1</b> (the F1 key) or <b>vbKeyHome</b> (the HOME key). To specify key codes, use the constants in the Visual Basic (VB) <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectlibrary">
</object><a href=JavaScript:alink_8.Click()>object library</a> in the <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectbrowser">
</object><a href=JavaScript:alink_9.Click()>Object Browser</a>.</td>
</tr>
<tr valign=top>
<td width=19%><i>shift</i></td>
<td width=81%>An integer that corresponds to the state of the SHIFT, CTRL, and ALT keys at the time of the event. The <i>shift</i> argument is a bit field with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2 ). These bits correspond to the values 1, 2, and 4, respectively. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys are pressed. For example, if both CTRL and ALT are pressed, the value of <i>shift</i> is 6.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
For both events, the object with the focus receives all keystrokes. A form can have the focus only if it has no visible and enabled controls. Although the KeyDown and KeyUp events can apply to most keys, they're most often used for:
<ul type=disc>
<li>
Extended character keys such as <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdeffunctionkey">
</object><a href=JavaScript:alink_10.Click()>function keys</a>.<br><br></li>
<li>
Navigation keys.<br><br></li>
<li>
Combinations of keys with standard keyboard modifiers.<br><br></li>
<li>
Distinguishing between the numeric keypad and regular number keys.</li>
</ul>
<p>
Use KeyDown and KeyUp event procedures if you need to respond to both the pressing and releasing of a key.</p>
<p>
KeyDown and KeyUp aren't invoked for:
<ul type=disc>
<li>
The ENTER key if the form has a <b>CommandButton </b>control with the <b>Default</b> property set to <b>True</b>.<br><br></li>
<li>
The ESC key if the form has a <b>CommandButton </b>control with the <b>Cancel</b> property set to <b>True</b>.<br><br></li>
<li>
The TAB key.</li>
</ul>
<p>
KeyDown and KeyUp interpret the uppercase and lowercase of each character by means of two arguments: <i>keycode</i>, which indicates the physical key (thus returning A and a as the same key) and <i>shift</i>, which indicates the state of <i>shift</i>+<i>key</i> and therefore returns either A or a.</p>
<p>
If you need to test for the <i>shift</i> argument, you can use the <i>shift</i> constants which define the bits within the argument. The constants have the following values:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Constant</b></td>
<td class=label width=21%><b>Value</b></td>
<td class=label width=45%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=34%><b>vbShiftMask</b></td>
<td width=21%>1</td>
<td width=45%>SHIFT key bit mask.</td>
</tr>
<tr valign=top>
<td width=34%><b>VbCtrlMask</b></td>
<td width=21%>2</td>
<td width=45%>CTRL key bit mask.</td>
</tr>
<tr valign=top>
<td width=34%><b>VbAltMask</b></td>
<td width=21%>4</td>
<td width=45%>ALT key bit mask.</td>
</tr>
</table><br>
<p>
The constants act as <object id=alink_11 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdefbitmask">
</object><a href=JavaScript:alink_11.Click()>bit masks</a> that you can use to test for any combination of keys.</p>
<p>
You test for a condition by first assigning each result to a temporary integer variable and then comparing <i>shift</i> to a bit mask. Use the <b>And</b> operator with the <i>shift</i> argument to test whether the condition is greater than 0, indicating that the modifier was pressed, as in this example:</p>
<pre><code>ShiftDown = (Shift And vbShiftMask) &gt; 0
</code></pre>
<p>
In a procedure, you can test for any combination of conditions, as in this example:</p>
<pre><code>If ShiftDown And CtrlDown Then
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If the <b>KeyPreview</b> property is set to <b>True</b>, a form receives these events before controls on the form receive the events. Use the <b>KeyPreview</b> property to create global keyboard-handling routines.</p>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
