<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>OLEDragDrop Event (ActiveX Controls)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtoledragdropeventactivexcontrols"></a>OLEDragDrop Event (ActiveX Controls)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtOLEDragDropEventActiveXControls_C;vbevtOLEDragDropEventActiveXControlsC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtOLEDragDropEventActiveXControls_X;vbevtOLEDragDropEventActiveXControlsX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtOLEDragDropEventActiveXControls_A;vbevtOLEDragDropEventActiveXControlsA">
</object></p>
<p>
Occurs when a source component is dropped onto a target component when the source component determines that a drop can occur.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This event occurs only if <b>OLEDropMode</b> is set to <b>1</b> (<b>Manual</b>).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_OLEDragDrop</b>(<i>data</i> <b>As</b> <b>DataObject</b>, <i>effect</i> <b>As Long</b>, <i>button</i> <b>As Integer</b>, <i>shift</i> <b>As Integer</b>, <i>x</i> <b>As Single</b>, <i>y</i> <b>As Single</b>)</p>
<p>
The OLEDragDrop event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=15%><b>Part</b></td>
<td class=label width=85%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=15%><i>object</i></td>
<td width=85%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=15%><i>data</i></td>
<td width=85%>A <b>DataObject</b> object containing formats that the source will provide and, in addition, possibly the data for those formats. If no data is contained in the <b>DataObject</b>, it is provided when the control calls the <b>GetData</b> method. The <b>SetData</b> and <b>Clear</b> methods cannot be used here.</td>
</tr>
<tr valign=top>
<td width=15%><i>effect</i></td>
<td width=85%>A long integer set by the target component identifying the action that has been performed (if any), thus allowing the source to take appropriate action if the component was moved (such as the source deleting the data). The possible values are listed in Settings.</td>
</tr>
<tr valign=top>
<td width=15%><i>button</i></td>
<td width=85%>An integer which acts as a bit field corresponding to the state of a mouse button when it is depressed. The left button is bit 0, the right button is bit 1, and the middle button is bit 2. These bits correspond to the values 1, 2, and 4, respectively. It indicates the state of the mouse buttons; some, all, or none of these three bits can be set, indicating that some, all, or none of the buttons are depressed.</td>
</tr>
<tr valign=top>
<td width=15%><i>shift</i></td>
<td width=85%>An integer which acts as a bit field corresponding to the state of the <small>shift</small>, <small>ctrl</small>, and <small>alt</small> keys when they are depressed. The <small>shift</small> key is bit 0, the <small>ctrl</small> key is bit 1, and the <small>alt</small> key is bit 2. These bits correspond to the values 1, 2, and 4, respectively. The <i>shift</i> parameter indicates the state of these keys; some, all, or none of the bits can be set, indicating that some, all, or none of the keys are depressed. For example, if both the <small>ctrl</small> and <small>alt</small> keys were depressed, the value of <i>shift</i> would be 6.</td>
</tr>
<tr valign=top>
<td width=15%><i>x,y</i></td>
<td width=85%>A number which specifies the current location of the mouse pointer. The <i>x</i> and <i>y</i> values are always expressed in terms of the coordinate system set by the <b>ScaleHeight</b>, <b>ScaleWidth</b>, <b>ScaleLeft</b>, and <b>ScaleTop</b> properties of the object.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>effect</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=35%><b>Constant</b></td>
<td class=label width=20%><b>Value</b></td>
<td class=label width=45%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%><b>vbDropEffectNone</b></td>
<td width=20%>0</td>
<td width=45%>Drop target cannot accept the data.</td>
</tr>
<tr valign=top>
<td width=35%><b>vbDropEffectCopy</b></td>
<td width=20%>1</td>
<td width=45%>Drop results in a copy of data from the source to the target. The original data is unaltered by the drag operation.</td>
</tr>
<tr valign=top>
<td width=35%><b>vbDropEffectMove</b></td>
<td width=20%>2</td>
<td width=45%>Drop results in data being moved from drag source to drop source. The drag source should remove the data from itself after the move.</td>
</tr>
<tr valign=top>
<td width=35%><b>VbDropEffectScroll</b></td>
<td width=20%>-2147483648</td>
<td width=45%>A mask to indicate that the drop target window has scrolled/would scroll.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The source ActiveX component should always mask values from the <i>effect</i> parameter to ensure compatibility with future implementations of ActiveX components. Presently, only three of the 32 bits in the <i>effect</i> parameter are used. In future versions of Visual Basic, however, these other bits may be used. Therefore, as a precaution against future problems, drag sources and drop targets should mask these values appropriately before performing any comparisons.</p>
<p>
For example, a source component should not compare an <i>effect</i><b> </b>against, for example, <b>vbDropEffectCopy</b>, such as:</p>
<pre><code>If Effect = vbDropEffectCopy... 
</code></pre>
<p>
Instead, the source component should mask the value or values being sought, as here:</p>
<pre><code>If Effect And vbDropEffectCopy = vbDropEffectCopy... 
</code></pre>
<p class=tl>
-or-</P><pre><code>If (Effect And vbDropEffectCopy)... 
</code></pre>
<p>
This allows for the definition of new drop effects in future versions of Visual Basic while preserving backwards compatibility with your existing code.</p>
<p>
Most components support manual OLE drag and drop events, and some support automatic OLE drag and drop events.</p>
</BODY>
</HTML>
