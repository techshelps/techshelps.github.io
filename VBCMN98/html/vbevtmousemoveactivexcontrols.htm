<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>MouseMove Event (ActiveX Controls)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtmousemoveactivexcontrols"></a>MouseMove Event (ActiveX Controls)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtMouseMoveActiveXControls_C;vbevtMouseMoveActiveXControlsC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtMouseMoveActiveXControls_X;vbevtMouseMoveActiveXControlsX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtMouseMoveActiveXControls_A;vbevtMouseMoveActiveXControlsA">
</object></p>
<p>
Occurs when the user moves the mouse.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Private Sub Form_MouseMove(</b><i>button</i><b> As Integer</b>,<b> </b><i>shift</i><b> As Integer</b>,<b> </b><i>x</i><b> As Single</b>,<b> </b><i>y</i><b> As Single)</b></p>
<p>
<b>Private Sub MDIForm_MouseMove(</b><i>button</i><b> As Integer</b>,<b> </b><i>shift</i><b> As Integer</b>,<b> </b><i>x</i><b> As Single</b>,<b> </b><i>y</i><b> As Single)</b></p>
<p>
<b>Private Sub</b> <i>object</i><b>_MouseMove(</b>[<i>index</i> <b>As Integer</b>,] <i>button</i> <b>As Integer</b>, <i>shift</i> <b>As Integer</b>, <i>x</i> <b>As Single</b>, <i>y</i> <b>As Single)</b></p>
<p>
The MouseMove event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Part</b></td>
<td class=label width=81%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><i>object</i></td>
<td width=81%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=19%><i>index</i></td>
<td width=81%>An integer that uniquely identifies a control if it's in a <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcontrolarray">
</object><a href=JavaScript:alink_5.Click()>control array</a>.</td>
</tr>
<tr valign=top>
<td width=19%><i>button</i></td>
<td width=81%>An integer that corresponds to the state of the mouse buttons in which a bit is set if the button is down. The <i>button</i> argument is a bit field with bits corresponding to the left button (bit 0), right button (bit 1), and middle button (bit 2). These bits correspond to the values 1, 2, and 4, respectively. It indicates the complete state of the mouse buttons; some, all, or none of these three bits can be set, indicating that some, all, or none of the buttons are pressed.</td>
</tr>
<tr valign=top>
<td width=19%><i>shift</i></td>
<td width=81%>An integer that corresponds to the state of the SHIFT, CTRL, and ALT keys. A bit is set if the key is down. The <i>shift</i> argument is a bit field with the least-significant bits corresponding to the SHIFT key (bit 0), the CTRL key (bit 1), and the ALT key (bit 2 ). These bits correspond to the values 1, 2, and 4, respectively. The <i>shift</i> argument indicates the state of these keys. Some, all, or none of the bits can be set, indicating that some, all, or none of the keys are pressed. For example, if both CTRL and ALT were pressed, the value of <i>shift</i> would be 6.</td>
</tr>
<tr valign=top>
<td width=19%><i>x</i>, <i>y</i></td>
<td width=81%>A number that specifies the current location of the mouse pointer. The <i>x</i> and <i>y</i> values are always expressed in terms of the coordinate system set by the <b>ScaleHeight</b>, <b>ScaleWidth</b>, <b>ScaleLeft</b>, and <b>ScaleTop</b> properties of the object.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The MouseMove event is generated continually as the mouse pointer moves across objects. Unless another object has captured the mouse, an object recognizes a MouseMove event whenever the mouse position is within its borders.</p>
<p>
If you need to test for the <i>button</i> or <i>shift</i> arguments, you can use constants listed in the Visual Basic (VB) <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectlibrary">
</object><a href=JavaScript:alink_6.Click()>object library</a> in the <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectbrowser">
</object><a href=JavaScript:alink_7.Click()>Object Browser</a> to define the bits within the argument:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=36%><b>Constant (Button)</b></td>
<td class=label width=24%><b>Value</b></td>
<td class=label width=40%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=36%><b>vbLeftButton</b></td>
<td width=24%>1</td>
<td width=40%>Left button is pressed.</td>
</tr>
<tr valign=top>
<td width=36%><b>vbRightButton</b></td>
<td width=24%>2</td>
<td width=40%>Right button is pressed.</td>
</tr>
<tr valign=top>
<td width=36%><b>vbMiddleButton</b></td>
<td width=24%>4</td>
<td width=40%>Middle button is pressed.</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=36%><b>Constant (Shift)</b></td>
<td class=label width=24%><b>Value</b></td>
<td class=label width=40%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=36%><b>vbShiftMask</b></td>
<td width=24%>1</td>
<td width=40%>SHIFT key is pressed.</td>
</tr>
<tr valign=top>
<td width=36%><b>vbCtrlMask</b></td>
<td width=24%>2</td>
<td width=40%>CTRL key is pressed.</td>
</tr>
<tr valign=top>
<td width=36%><b>vbAltMask</b></td>
<td width=24%>4</td>
<td width=40%>ALT key is pressed.</td>
</tr>
</table><br>
<p>
The constants then act as bit masks you can use to test for any combination of buttons without having to figure out the unique bit field value for each combination.</p>
<p>
You test for a condition by first assigning each result to a temporary integer variable and then comparing the <i>button</i> or <i>shift</i> arguments to a bit mask. Use the <b>And</b> operator with each argument to test if the condition is greater than zero, indicating the key or button is pressed, as in this example:</p>
<pre><code>LeftDown = (Button And vbLeftButton) &gt; 0
CtrlDown = (Shift And vbCtrlMask) &gt; 0
</code></pre>
<p>
Then, in a procedure, you can test for any combination of conditions, as in this example:</p>
<pre><code>If LeftDown And CtrlDown Then
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;You can use MouseDown and MouseUp event procedures to respond to events caused by pressing and releasing mouse buttons.</p>
<p class=indent>
The <i>button</i> argument for MouseMove differs from the <i>button</i> argument for MouseDown and MouseUp. For MouseMove, the <i>button</i> argument indicates the current state of all buttons; a single MouseMove event can indicate that some, all, or no buttons are pressed. For MouseDown and MouseUp, the <i>button</i> argument indicates exactly one button per event.</p>
<p class=indent>
Any time you move a window inside a MouseMove event, it can cause a <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdefcascadingevent">
</object><a href=JavaScript:alink_8.Click()>cascading event</a>. MouseMove events are generated when the window moves underneath the pointer. A MouseMove event can be generated even if the mouse is perfectly stationary.</p>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
