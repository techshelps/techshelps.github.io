<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Location Steps</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmreflocationsteps"></A>Location Steps</H1>

<P>A location step selects a set of nodes (a node-set) relative to the context node.</P>

<P>There are three parts to a location step: an optional axis, a node test, and an optional predicate. The syntax for a location step is the axis name followed by a double colon, then the node test, and finally zero or more predicates, each in square brackets. The most basic form of this syntax is as follows:</P>

<PRE class="code"><I>axis::nodetest[predicate]</I></PRE>

<DL>
<DT><I>axis</I></DT>

<DD>Specifies the tree relationship between the context node and the nodes to be selected by the location step. In other words, the axis indicates the general direction that the location step proceeds from the context node. In a location step, the axis is optional. If omitted, the axis defaults to <code class="ce">child::</code>. Furthermore, several axes have shortcut forms; for instance, the ampersand (<code class="ce">@</code>) character is a shortcut for the attribute axis.</dd>

<DT><I>nodetest</I></DT>

<DD>Specifies the node type or expanded name of the nodes to be initially selected by the location step. Basically, the node test indicates which node(s), from among all nodes on the indicated axis, to consider as candidates, that is, potential, matches for the location step.</dd>

<DT><I>predicate</I></DT>

<DD>Uses an XPath expression (condition to be met) to further refine the set of nodes selected by the location step. The predicate is a filter, specifying a selection criterion for further refining the list of candidate nodes. The predicate is optional. If there is no predicate, there are no square brackets (<code class="ce">[</code> and <code class="ce">]</code>) in the location step.</dd>
</DL>

<H2 class="dtH2">Selecting Nodes</H2>

<P>The node-set selected by a location step results from generating an initial node-set based on the relationship between the axis and node test, and then filtering that initial node-set by each of the predicates in turn.</P>

<P>The initial node-set consists of those nodes that meet the following two criteria:

<UL type="disc">
	<LI>The nodes have the relationship to the context node specified by the axis.</li>

	<LI>The nodes have the node type and expanded name specified by the node test.</li>
</UL>

<P>XPath then uses the first predicate in the location step to filter the initial node-set to generate a new node-set. XPath then uses the second predicate to filter the node-set resulting from the first predicate. This filtering process repeats until XPath has evaluated all the predicates. The node-set that results after applying all the predicates is the node-set selected by the location step.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;Because the axis affects the evaluation of the expression in each predicate, the semantics of a predicate is defined with respect to the specified axis.</BLOCKQUOTE>

<P>Some sample location steps using the complete syntax are shown in the following table.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Location step</TH>
<TH width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">child::*[position()=1]</code></TD>
<TD width=50%>Locates the first child node of the context node</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">ancestor-or-self::book[@catdate="2000-12-31"]</code></TD>
<TD width=50%>Locates all ancestors of any <code class="ce">&lt;book&gt;</code> child of the context node, as well as the <code class="ce">&lt;book&gt;</code> child itself, as long as the element in question has a <code class="ce">catdate</code> attribute with the value <code class="ce">"2000-12-31"</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">//self::parent[name()="book"] | descendant::node[name()="author"]</code></TD>
<TD width=50%>Locates any node in the document whose parent node is named "book", or any node descended from the context node whose name is "author".</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_syntax2_6tv7.htm">Axes</A> | <A HREF="xpath_syntax2_42gj.htm">Node Tests</A> | <A HREF="xpath_syntax2_3a5v.htm">Predicates</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
