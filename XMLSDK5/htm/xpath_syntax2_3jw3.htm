<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Location Paths</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmreflocationpaths"></A>Location Paths</H1>

<P>A location path is an XPath expression used for selecting a set of nodes relative to the context node. The evaluation of a location path expression results in a node-set containing the nodes specified by the location path. A location path can recursively contain expressions used to filter sets of nodes.</P>

<P>Syntactically, a location path consists of one or more location steps, each separated by a forward slash (<code class="ce">/</code>):</P>

<PRE class="code">locationstep/locationstep/locationstep</PRE>

<P>Each location step in turn selects a set of nodes relative to the context node&#0151;that is, to the node selected by the preceding location step. A location path expressed this way is a relative location path. An absolute location path starts from the root element:</P>

<PRE class="code">/locationstep/locationstep/locationstep</PRE>

<P>In a location path, location steps are evaluated from left to right. The leftmost location step selects a set of nodes relative to the context node. These nodes then become the context used to process the next location step. This processing of steps and updating of the context node repeats itself until all the location steps have been processed.</P>

<P>A location path can be unabbreviated or abbreviated. </P>

<P>In an unabbreviated location path, a location step has the following syntax:</P>

<PRE class="code">axis::node-test[predicate]</PRE>

<P>In this syntax, <code class="ce">axis</code> specifies how the nodes selected by the location step are related to the context node; <code class="ce">node-test</code> specifies the node type and expanded name of the nodes selected by the location step; and <code class="ce">predicate</code> is a filter expression to further refine the selection of nodes in the location step. Predicates are optional. In this case, a location step consists of <code class="ce">axis::</code> and <code class="ce">node-test</code> only. The following table provides some examples. </P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Unabbreviated Location Path</TH>
<TH width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">child::para[last()]</PRE>
</TD>
<TD width=50%>Selects the last <code class="ce">&lt;para&gt;</code> element of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">parent::para</PRE>
</TD>
<TD width=50%>Selects the <code class="ce">&lt;para&gt;</code> element that is the parent of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">child::text()</PRE>
</TD>
<TD width=50%>Selects all text node children of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">child::div/child::para</PRE>
</TD>
<TD width=50%>Selects the <code class="ce">&lt;para&gt;</code> child elements of the <code class="ce">&lt;div&gt;</code> element that is a child of the context node.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>In an abbreviated location path, the axis specifier, <code class="ce">axis::</code>, is not expressed explicitly in a location step, but implied by a set of shot cuts instead. The following table provides some examples.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Abbreviated Location Path</TH>
<TH width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">para</PRE>
</TD>
<TD width=50%>Selects the <code class="ce">&lt;para&gt;</code> elements of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">../para</PRE>
</TD>
<TD width=50%>Selects the <code class="ce">&lt;para&gt;</code> element that is the parent of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">text()</PRE>
</TD>
<TD width=50%>Selects all text node children of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">./div/para</PRE>
</TD>
<TD width=50%>Selects the <code class="ce">&lt;para&gt;</code> element children of the <code class="ce">&lt;div&gt;</code> element children of the context node.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>The following is a summary of some of the abbreviations:</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Unabbreviated</TH>
<TH width=50%>Abbreviated</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">child::*</PRE>
</TD>
<TD width=50%><code class="ce">*</code></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">attribute::*</PRE>
</TD>
<TD width=50%><code class="ce">@*</code></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">/descendant-or-self::node()</PRE>
</TD>
<TD width=50%><code class="ce">//</code></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">self::node()</PRE>
</TD>
<TD width=50%><code class="ce">.</code></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">parent::node()</PRE>
</TD>
<TD width=50%><code class="ce">..</code></TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">In This Section</H4>

<P>The following topics discuss in detail the syntax and usage of the pieces of location paths.

<UL type="disc">
	<LI><A HREF="xpath_syntax2_7s6r.htm">Location Steps</A></li>

	<LI><A HREF="xpath_syntax2_6tv7.htm">Axes</A></li>

	<LI><A HREF="xpath_syntax2_42gj.htm">Node Tests</A></li>

	<LI><A HREF="xpath_syntax2_3a5v.htm">Predicates</A></li>

	<LI><A HREF="xpath_syntax2_7z1v.htm">Location Path Examples</A></li>
</UL>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
