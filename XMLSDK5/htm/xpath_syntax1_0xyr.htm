<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Filters and Filter Patterns</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmreffiltersandfilterpatterns"></A>Filters and Filter Patterns</H1>

<P>Constraints and branching can be applied to any collection by adding a filter clause, [<I>pattern</I>], to the collection. The filter is analogous to the SQL WHERE clause. The filter contains a pattern within it called the <I>filter pattern</I>. The filter pattern evaluates to a Boolean value and is tested for each element in the collection. Any elements in the collection failing the filter pattern test are omitted from the result collection.</P>

<P>For convenience, if a collection is placed within the filter, a Boolean TRUE is generated if the collection contains any members and a FALSE is generated if the collection is empty. An expression such as <code class="ce">author/degree</code> implies a collection-to-Boolean conversion function that evaluates to TRUE if there exists an <code class="ce">&lt;author&gt;</code> element with a child element named <code class="ce">&lt;degree&gt;</code>.</P>

<P>Note that any number of filters can appear at a given level of an expression. Empty filters are not allowed.</P>

<P>Filters are always evaluated with respect to a context. In other words, the expression <code class="ce">book[author]</code> means that for every <code class="ce">&lt;book&gt;</code> element that is found, test whether it has an <code class="ce">&lt;author&gt;</code> child element. Likewise, <code class="ce">book[author = 'Bob']</code> means that for every <code class="ce">&lt;book&gt;</code> element that is found, test whether it has an <code class="ce">&lt;author&gt;</code> child element with the value <code class="ce">Bob</code>. One can examine the value of the context as well by using the period (.) character. For example, <code class="ce">book[. = 'Trenton']</code> means that for every book that is found in the current context, test whether its value is <code class="ce">Trenton</code>.</P>

<H4 class="dtH4">Examples</H4>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Expression</TH>
<TH width=50%>Refers to</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">book[excerpt]</code></TD>
<TD width=50%>All <code class="ce">&lt;book&gt;</code> elements that contain at least one <code class="ce">&lt;excerpt&gt;</code> element.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">book[excerpt]/title</code></TD>
<TD width=50%>All <code class="ce">&lt;title&gt;</code> elements inside <code class="ce">&lt;book&gt;</code> elements that contain at least one <code class="ce">&lt;excerpt&gt;</code> element.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">book[excerpt]/author[degree]</code></TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;degree&gt;</code> element, and are inside of <code class="ce">&lt;book&gt;</code> elements that contain at least one <code class="ce">&lt;excerpt&gt;</code> element.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">book[author/degree]</code></TD>
<TD width=50%>All <code class="ce">&lt;book&gt;</code> elements that contain at least one <code class="ce">&lt;author&gt;</code> element with at least one <code class="ce">&lt;degree&gt;</code> child element.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">book[excerpt][title]</code></TD>
<TD width=50%>All <code class="ce">&lt;book&gt;</code> elements that contain at least one <code class="ce">&lt;excerpt&gt;</code> element and at least one <code class="ce">&lt;title&gt;</code> element.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_syntax2_9wz0.htm">Sample XML File for XPath Syntax (inventory.xml)</A> | <A HREF="xpath_syntax2_3prn.htm">XPath Examples</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
