<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Navigating Along the preceding-sibling Axis</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconnavigatingalongtheprecedingsiblingaxis"></A>Navigating Along the preceding-sibling Axis</H1>

<P>Similar to the <code class="ce">following-sibling:: </code>axis, the preceding-sibling:: axis locates all nodes, elements, by default, which share the same parent node and which appear before the context node, in document order. Since the root node has no parent, it also has no preceding-siblings. If the context node is an attribute or namespace node, the <code class="ce">preceding-sibling::</code> node locates an empty node-set.</P>

<P>You can override the default elements only selection of preceding-siblings by using the <code class="ce">node()</code> node test in the location step. For example, you can locate all of the root <code class="ce">&lt;chairman&gt;</code> element's preceding-sibling nodes of type element, node, or processing instruction (PI) using an XSLT template such as the one in the sample XSLT file.</P>

<P>The template rule in the sample XSLT file contains two references to the <code class="ce">preceding-sibling::</code> axis. The first appears as the value of the <code class="ce">&lt;xsl:if&gt;</code> element's <code class="ce">test</code> attribute. It ensures that the template is instantiated in the result tree only if the context node has at least one node along the <code class="ce">preceding-sibling::</code> axis.</P>

<H4 class="dtH4">Example</H4>

<P class="label"><B>XML File (orgchart.xml)</B></P>

<P>Use <B>orgchart.xml</B> (in <A HREF="xpath_hdi_2_4ldf.htm">Sample XML File for Navigating XPath Axes</A>) and edit its <code class="ce">href</code> attribute to refer to <B>orgchart-presibl.xsl</B>.</P>

<P class="label"><B>XSLT File (orgchart-presibl.xsl)</B></P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"&gt;
&lt;!-- suppress text nodes not covered in subsequent template rule --&gt;
&lt;xsl:template match="text()"/&gt;

&lt;xsl:template match="chairman"&gt;
    &lt;xsl:if test="<code><b class="cfe">preceding-sibling::node()</b></code>"&gt;
        &lt;h2&gt;preceding-siblings of '&lt;xsl:value-of select="name"/&gt;'&lt;/h2&gt;
    &lt;table border="1"&gt;
            &lt;tr&gt;
                &lt;th&gt;Node name&lt;/th&gt;
                &lt;th&gt;Node value&lt;/th&gt;
        &lt;/tr&gt;
        &lt;xsl:for-each select="<code><b class="cfe">preceding-sibling::node()</b></code>"&gt;
            &lt;tr&gt;
               &lt;td&gt;&lt;xsl:value-of select="name()"/&gt;&lt;/td&gt;
                &lt;td&gt;&lt;xsl:value-of select="."/&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/xsl:for-each&gt;
        &lt;/table&gt;
   &lt;/xsl:if&gt;
   &lt;xsl:apply-templates/&gt;
&lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</PRE>

<P class="label"><B>Formatted Output</B></P>

<P>Since the root element, by definition, has no siblings, the only node located along its <code class="ce">preceding-sibling::</code> axis in this case is the <code class="ce">&lt;?xml-stylesheet?&gt;</code> processing instruction.</P>

<P class="fig"><IMG SRC="xsltorgchart-presibl.gif" ALT="" BORDER=0></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_hdi_2_3wdv.htm">Navigating Along the following-sibling Axis</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
