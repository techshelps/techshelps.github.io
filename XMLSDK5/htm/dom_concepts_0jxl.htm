<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Working with Processing Instructions</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconworkingwithxmldocumentparts_pi"></A>Working with Processing Instructions</H1>

<P>Processing instructions provide a loosely-structured mechanism for conveying application-specific information within a document. Processing instructions can appear within document, element, document fragment, entity reference, or entity nodes. They have only two components&#0151;a name (also called the target) and a value. The value may contain content that looks like attribute values (often called pseudo-attributes), but this content is stored as simple text.</P>

<P>Processing instructions can appear in the document content&#0151;within the root element or an element that is the descendant of the root element&#0151;or they can appear before or after the root element. The <code class="ce">&lt;?xml-stylesheet?&gt;</code> processing instruction, used to connect XML documents to cascading style sheets or XSL Transformations (XSLT) style sheets, usually appears in the prolog.</P>

<H4 class="dtH4">Examples</H4>

<P class="label"><B>JScript</B></P>

<P>The following JScript example identifies which style sheet to use in a processing instruction in the prolog.</P>

<PRE class="code">var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.5.0");
var stylePI=xmlDoc.createProcessingInstruction("xml-stylesheet", 
  ' type="text/xsl" href="show_book.xsl"');
xmlDoc.appendChild(stylePI);</PRE>

<P class="label"><B>VBScript</B></P>

<PRE class="code">Set xmlDoc = CreateObject("Msxml2.DOMDocument.5.0")
Set stylePI = xmlDoc.createProcessingInstruction("xml-stylesheet", 
  "type=""text/xsl"" href=""show_book.xsl""")
xmlDoc.appendChild(stylePI)</PRE>

<P>The XML document begins with the following.</P>

<PRE class="code">&lt;?xml-stylesheet type="text/xsl" href="show_book.xsl"?&gt;</PRE>

<P>The target of a processing instruction can be retrieved through its <code class="ce">nodeName</code> property while the rest of the processing instruction is stored in the <code class="ce">nodeValue</code> property. MSXML treats the XML declaration as a processing instruction within its DOM representation. This can have a significant effect on character encoding.</P>

<P>For more information about properties and methods of <code class="ce">XMLDOMProcessingInstruction</code> objects, see the <A HREF="xml_obj_ixmldomprocessinginstruction_6ilw.htm">IXMLDOMProcessingInstruction</A>.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
