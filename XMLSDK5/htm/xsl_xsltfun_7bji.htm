<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>current Function</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmrefcurrentfunction"></A>current Function</H1>

<P>Returns a node set that has the current node as its only member.</P>

<PRE class="syntax"><I>node-set</I> current()</PRE>

<H4 class="dtH4">Remarks</H4>

<P>The function returns a node set that has the current node as its only member. For an outermost expression, an expression not occurring within another expression, the current node is always the same as the context node. Thus,</P>

<PRE class="code">&lt;xsl:value-of select="current()"/&gt;</PRE>

<P>is the same as</P>

<PRE class="code">&lt;xsl:value-of select="."/&gt;</PRE>

<P>However, within square brackets, the current node is usually different from the context node. For example,</P>

<PRE class="code">&lt;xsl:apply-templates select="//glossary/item[@name=current()/@ref]"/&gt;</PRE>

<P>processes all <code class="ce">&lt;item&gt;</code> elements that have a <code class="ce">&lt;glossary&gt;</code> parent element and a <code class="ce">name</code> attribute with value equal to the value of the current node's <code class="ce">ref</code> attribute. This is different from</P>

<PRE class="code">&lt;xsl:apply-templates select="//glossary/item[@name=./@ref]"/&gt;</PRE>

<P>which means the same as</P>

<PRE class="code">&lt;xsl:apply-templates select="//glossary/item[@name=@ref]"/&gt;</PRE>

<P>and so would process all <code class="ce">&lt;item&gt;</code> elements that have a <code class="ce">&lt;glossary&gt;</code> parent element and that have a <code class="ce">name</code> attribute and a <code class="ce">ref</code> attribute with the same value.</P>

<H4 class="dtH4">Example</H4>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;To test this example, you need to use a script. For more information, see <A HREF="xslt_howdoi_2put.htm">Initiate XSLT in a Script</A>.</BLOCKQUOTE>

<P class="label"><B>XML File (current.xml)</B></P>

<P><code class="ce">&lt;?xml version='1.0'?&gt;</code></P>

<P><code class="ce">&lt;?xml-stylesheet type="text/xsl" href="current.xsl" ?&gt;</code></P>

<P><code class="ce">&lt;nodes&gt;</code></P>

<P><code class="ce">&lt;node&gt;first&lt;/node&gt;</code></P>

<P><code class="ce">&lt;node&gt;1&lt;/node&gt;</code></P>

<P><code class="ce">&lt;node&gt;</code></P>

<P><code class="ce">&lt;obj&gt;class&lt;/obj&gt;</code></P>

<P><code class="ce">&lt;/node&gt;</code></P>

<P><code class="ce">&lt;/nodes&gt;</code></P>

<P class="label"><B>XSLT File (current.xsl)</B></P>

<PRE class="code"><code class="ce">&lt;?xml version='1.0'?&gt;
&lt;xsl:stylesheet version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;

&lt;xsl:template match="/"&gt;
  &lt;xsl:apply-templates/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="text()"&gt;
  &lt;xsl:value-of select="</code><B>current()</B><code class="ce">"/&gt;</code>
<code class="ce">&lt;/xsl:template&gt;</code>

<code class="ce">&lt;xsl:template match="*"&gt;</code>
<code class="ce">  &lt;blockquote&gt;&lt;xsl:apply-templates/&gt;&lt;/blockquote&gt;</code>
<code class="ce">&lt;/xsl:template&gt;</code>

<code class="ce">&lt;/xsl:stylesheet&gt;</code></PRE>

<P class="label"><B>Output</B></P>

<P>The following is the formatted output shown in the browser.</P>

<PRE class="code">     first

     1

          class</PRE>

<P>The following is the output from the XSLT processor. To obtain this output, right-click on the browser and select the <B>View XSL Output</B> menu item.</P>

<PRE class="code">&lt;?xml version="1.0" encoding="UTF-16"?&gt;
&lt;blockquote&gt;
   &lt;blockquote&gt;first&lt;/blockquote&gt;
   &lt;blockquote&gt;1&lt;/blockquote&gt;
   &lt;blockquote&gt;
      &lt;blockquote&gt;class&lt;/blockquote&gt;
   &lt;/blockquote&gt;
&lt;/blockquote&gt;</PRE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xsd_devdatatypes_065v.htm">Data Types in Schemas</A> | <A HREF="xsd_xdrref_3w6d.htm">XDR Schema Data Types Reference</A> | <A HREF="xsd_ref_5bc5.htm">XML Data Types Reference</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
