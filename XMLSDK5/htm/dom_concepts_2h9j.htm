<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Modeling Documents as Node Trees</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconintroductiontothedom_modeling"></A>Modeling Documents as Node Trees</H1>

<P>The DOM provides you with an interface for loading, accessing, manipulating, and serializing XML documents. The DOM provides a representation of a complete XML document stored in memory, providing random access to the contents of the entire document. The DOM allows applications to rely on the logic provided by the MSXML parser to handle XML-based information, using its facilities rather than writing custom code to read and process XML.</P>

<P>When the MSXML parser loads an XML document into a DOM, it reads it from start to finish and creates a logical model of nodes from the structures and content within the XML document. The document itself is considered a single node that contains all of the other nodes, including a node representing the root element, which, in turn, contains all of the element, attribute, and text nodes in the document.</P>

<H4 class="dtH4">Example</H4>

<P>The following XML document has a simple multi-tier structure.</P>

<PRE class="code">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="show_book.xsl"?&gt;
&lt;!DOCTYPE catalog [ 
&lt;!NOTATION XLS PUBLIC "http://www.microsoft.com/office/excel/"&gt;
&lt;!ELEMENT COLLECTION    (DATE? , BOOK+) &gt;
&lt;!ATTLIST COLLECTION
    xmlns:dt CDATA #FIXED "urn:schemas-microsoft-com:datatypes"&gt;
&lt;!ELEMENT BOOK (TITLE, AUTHOR, PUBLISHER) &gt;
&lt;!ELEMENT DATE          (#PCDATA) &gt;
&lt;!ELEMENT TITLE         (#PCDATA)  &gt;
&lt;!ELEMENT AUTHOR        (#PCDATA)  &gt;
&lt;!ELEMENT PUBLISHER     (#PCDATA)  &gt;
]&gt;
&lt;!--catalog last updated 2000-11-01--&gt;
&lt;catalog xmlns="http://www.example.com/catalog/"&gt;
  &lt;book id="bk101"&gt;
     &lt;author&gt;&amp;#71;ambardella, Matthew&lt;/author&gt;
     &lt;title&gt;XML Developer's &amp;#x47;uide&lt;/title&gt;
     &lt;genre&gt;Computer&lt;/genre&gt;
     &lt;price&gt;44.95&lt;/price&gt;
     &lt;publish_date&gt;2000-10-01&lt;/publish_date&gt;
     &lt;description&gt;&lt;![CDATA[An in-depth look at creating applications with XML, using &lt;, &gt;,]]&gt; and &amp;amp;.&lt;/description&gt;
  &lt;/book&gt;
  &lt;book id="bk109"&gt;
     &lt;author&gt;Kress, Peter&lt;/author&gt;
     &lt;title&gt;Paradox Lost&lt;/title&gt;
     &lt;genre&gt;Science Fiction&lt;/genre&gt;
     &lt;price&gt;6.95&lt;/price&gt;
     &lt;publish_date&gt;2000-11-02&lt;/publish_date&gt;
     &lt;description&gt;After an inadvertant trip through a Heisenberg Uncertainty Device, James Salway discovers the problems of being quantum.&lt;/description&gt;
  &lt;/book&gt;
&lt;/catalog&gt;</PRE>

<P>After MSXML parsing, the top two levels of the node structure representing this document will look like this.</P>

<P class="fig"><IMG SRC="domtree1.gif" ALT="" BORDER=0></P>

<P>The topmost node is the document itself, which contains all of the other nodes. Immediately within the document are nodes representing the XML declaration, the style sheet processing instruction, the DOCTYPE declaration, and the root element for the document, in this case, <code class="ce">catalog</code>.</P>

<P>The <code class="ce">catalog</code> element contains the real content of the document, and its structure is shown below.</P>

<P class="fig"><IMG SRC="domtree2.gif" ALT="" BORDER=0></P>

<P>This part of the DOM contains element, attribute, text, and CDATA nodes. (The character references and built-in entities are converted to ordinary text by the parser, but the CDATA section has its own node.)</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
