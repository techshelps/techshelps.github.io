<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>setStoreHandle Method</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - Digital Signatures</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmth_setstorehandle"></A>setStoreHandle Method</H1>
<font face="verdana" color=red>[This feature was first implemented for MSXML 5.0.]</font>
<P>Sets a certificate store handle on the signature object, so that certificate information can be inserted into the <code class="ce">&lt;ds:KeyInfo&gt;</code> element.</P>

<P>This method is callable in C/C++ applications only.</P>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT setStoreHandle (void* hCertStore);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>hCertStore</I></DT>

<DD>Handle to a certificate store created using CryptoAPI functions, such as <code class="ce">CertOpenSystemStore</code> or <code class="ce">CertOpenStore</code>.</dd>
</DL>

<H4 class="dtH4">Return Values</H4>

<DL>
<DT>S_OK </DT>

<DD>Certificate store handle was set without error.</dd>

<DT>E_FAIL</DT>

<DD>Failed to set the certificate store handle.</dd>
</DL>

<H4 class="dtH4">Remarks</H4>

<P>Calling this method releases all the certificates previously assigned to this object. </P>

<H4 class="dtH4">Example</H4>

<P>The example below is functionally similar to the <A HREF="dsig_ref_873k.htm">store property example</A>. It shows the effect of setting the certificate store on an <code class="ce">IXMLDigitalSignatureEx</code> object by calling the <code class="ce">setStoreHandle</code> method. When a signature is signed without calling this method and the CERTIFICATES flag is set in the call to the <code class="ce">sign</code> method, the resultant signature document contains the certificate of the key used in <code class="ce">sign</code>. However, when the signature is signed after this method is called to set the certificate store, the resultant signature document contains all the certificates in the store, in addition to the certificate of the key used in <code class="ce">sign</code>. </P>

<P>In this example, the certificate store has three certificates. So the signed signature document contains four <code class="ce">&lt;ds:Certificate&gt;</code> entries, two of which are identical. 

<UL type="disc">
	<LI><A HREF="dsig_ref2_1d45.htm">Resource File (signature_template.setStoreHandle.rsa.xml)</A></li>

	<LI><A HREF="dsig_ref2_44c0.htm">C/C++ Code (setStoreHandle.cpp)</A></li>

	<LI><A HREF="dsig_ref2_1wok.htm">Output for the setStoreHandle Method Example</A></li>
</UL>

<H4 class="dtH4">Applies To</H4>

<P><A HREF="dsig_ref_82t4.htm">IXMLDigitalSignatureEx</A></P>

<H4 class="dtH4">Versioning</H4>

<P>MSXML 5.0 and later</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="dsig_ref_82t4.htm">IXMLDigitalSignatureEx Interface</A> | <A HREF="dsig_ref2_0ey6.htm">sign Method</A> | <A HREF="dsig_ref2_61o9.htm">verify Method</A> | <A HREF="dsig_ref_2okl.htm">store Property</A> </P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
