<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>setAttribute Method</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmthsetattribute"></A>setAttribute Method</H1>

<P>Sets the value of the named attribute.</P>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">oXMLDOMElement.setAttribute(name, value);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>name</I></DT>

<DD>The string specifying the name of the attribute. If the attribute with that name already exists, its value is changed. If the attribute with that name does not exist, it is created.</dd>

<DT><I>value</I></DT>

<DD>The variant that supplies the value for the named attribute.</dd>
</DL>

<H4 class="dtH4">Example</H4>

<PRE class="code">var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.5.0");
var nodeBook;
xmlDoc.async = false;
xmlDoc.load("books.xml");
if (xmlDoc.parseError.errorCode &lt;&gt; 0) {
&nbsp;&nbsp;&nbsp;var myErr = xmlDoc.parseError;
&nbsp;&nbsp;&nbsp;alert("You have error " + myErr.reason);
} else {
&nbsp;&nbsp;&nbsp;nodeBook = xmlDoc.selectSingleNode("//book");
&nbsp;&nbsp;&nbsp;nodeBook.setAttribute("PublishDate", String(Date()))
&nbsp;&nbsp;&nbsp;alert(nodeBook.getAttribute("PublishDate"));
}</PRE>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">oXMLDOMElement.setAttribute(name, value)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>name</I></DT>

<DD>The string specifying the name of the attribute. If the attribute with that name already exists, its value is changed. If the attribute with that name does not exist, it is created.</dd>

<DT><I>value</I></DT>

<DD>The variant that supplies the value for the named attribute.</dd>
</DL>

<H4 class="dtH4">Example</H4>

<PRE class="code">Dim xmlDoc As New Msxml2.DOMDocument50
Dim nodeBook As IXMLDOMElement
xmlDoc.async = False
xmlDoc.Load "books.xml"
If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
&nbsp;&nbsp;&nbsp;Dim myErr
&nbsp;&nbsp;&nbsp;Set myErr = xmlDoc.parseError
&nbsp;&nbsp;&nbsp;MsgBox("You have error " &amp; myErr.reason)
Else
&nbsp;&nbsp;&nbsp;Set nodeBook = xmlDoc.selectSingleNode("//book")
&nbsp;&nbsp;&nbsp;nodeBook.setAttribute "PublishDate", Now
&nbsp;&nbsp;&nbsp;MsgBox nodeBook.getAttribute("PublishDate")
End If</PRE>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT setAttribute(
    BSTR name,
    VARIANT value);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>name</I> [in]</DT>

<DD>The name of the attribute. If an attribute with that name already exists, its value is changed. If an attribute with that name does not exist, it is created.</dd>

<DT><I>value</I> [in]</DT>

<DD>The value for the named attribute.</dd>
</DL>

<H4 class="dtH4">C/C++ Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>The value returned if successful.</dd>

<DT>E_FAIL</DT>

<DD>The value returned if an error occurs.</dd>
</DL>

<H4 class="dtH4">C/C++ Example</H4>

<P>See the example in the <code class="ce">getAttribute</code> method.</P>
</div><!-- [C/C++] -->

<H4 class="dtH4">Remarks</H4>

<P>If an attribute with the supplied name already exists, this method changes its value to the supplied <code class="ce">value</code> parameter. The supplied string is not parsed, so any markup, such as syntax intended to be recognized as an entity reference, is treated as literal text and must be appropriately escaped by the implementation when it is written out.</P>

<P>To assign an attribute value that contains entity references, the user must create <code class="ce">IXMLDOMAttribute</code> plus any <code class="ce">IXMLDOMText</code> and <code class="ce">IXMLDOMEntityReference</code> objects, build the appropriate subtree, and call the <code class="ce">setAttributeNode</code> method.</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_obj_ixmldomattribute_34kl.htm">IXMLDOMAttribute</A> | <A HREF="xml_obj_ixmldomtext_8sxg.htm">IXMLDOMText</A> | <A HREF="xml_obj_ixmldomentityreference_25k5.htm">IXMLDOMEntityReference</A> | <A HREF="xml_mth_sz_6o9x.htm">setAttributeNode method</A></P>

<P>Applies to: <A HREF="xml_obj_ixmldomelement_8yyc.htm">IXMLDOMElement</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
