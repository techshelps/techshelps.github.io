<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Enveloped Signature</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - Digital Signatures</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xml_dsig_dev_concepts_sigtypes_enveloped"></A>Enveloped Signatures</H1>

<P>In an enveloped signature, the signed or to-be-signed data is an XML document and contains the <code class="ce">&lt;ds:Signature&gt;</code> element as its child element. </P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;The content of <code class="ce">&lt;ds:Signature&gt;</code> element is excluded from the calculations of the signature value (that is, the content of <code class="ce">&lt;ds:SignatureValue&gt;</code>) of an enveloped signature. </BLOCKQUOTE>

<P>The following is an example of enveloped signatures.</P>

<PRE class="code"><code class="ce">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE Envelope [
  &lt;!ENTITY ds "http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;!ENTITY c14n "http://www.w3.org/TR/2001/REC-xml-c14n-20010315"&gt;
  &lt;!ENTITY xpath "http://www.w3.org/TR/1999/REC-xpath-19991116"&gt;
  &lt;!ENTITY xslt "http://www.w3.org/TR/1999/REC-xslt-19991116"&gt;
  &lt;!ENTITY digest "http://www.w3.org/2000/09/xmldsig#sha1"&gt;
]&gt;
&lt;Letter&gt;
   &lt;Return-address&gt;...&lt;/Return-address&gt;
   &lt;To&gt;...&lt;/To&gt;
   &lt;Message&gt;...&lt;/Message&gt;
   &lt;From&gt;
      &lt;ds:Signature xmlns:ds="&amp;ds;"&gt;
         &lt;ds:SignedInfo&gt;
         ...
         &lt;ds:Reference </code><B>URI=""&gt;</B>
<code class="ce">             &lt;ds:Transforms&gt;</code>
<code class="ce">                &lt;ds:Transform Algorithm="&amp;xpath;"&gt;</code>
<code class="ce">                    &lt;XPath xmlns:dsig="&amp;ds;"&gt;</code>
<code class="ce">                       not(ancestor-or-self::dsig:Signature)</code>
<code class="ce">                    &lt;/XPath&gt;</code>
<code class="ce">                &lt;/ds:Transform&gt;</code>
<code class="ce">             &lt;/ds:Transforms&gt;</code>
<code class="ce">             &lt;ds:DigestMethod Algorithm="&amp;digest;"/&gt;</code>
<code class="ce">             &lt;ds:DigestValue&gt;&lt;/ds:DigestValue&gt;</code>
<code class="ce">         &lt;/ds:Reference&gt;</code>
<code class="ce">         &lt;/ds:SignedInfo&gt;</code>
<code class="ce">      &lt;/ds:Signature&gt;</code>
<code class="ce">   &lt;/From&gt;</code>
<code class="ce">   &lt;Attach&gt;...&lt;/Attach&gt;</code>
<code class="ce">&lt;/Letter&gt;</code></PRE>

<P>The data referenced in the <code class="ce">&lt;ds:Signature&gt;</code> element and specified by the <code class="ce">"URI=''"</code> attribute of the <code class="ce">&lt;ds:Reference&gt;</code> descendant element is the entire <code class="ce">&lt;Letter&gt;</code> element, including <code class="ce">&lt;ds:Signature&gt;</code> itself. </P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
