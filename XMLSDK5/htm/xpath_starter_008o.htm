<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Introduction to XPath Syntax</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconintroductiontoxpathsyntax"></A>Introduction to XPath Syntax</H1>

<P>XPath enables you to locate any one or more nodes within an XML document, often by using multiple alternate routes. In essence, XPath provides the syntax for performing basic queries upon your XML document data. It works by utilizing the ability to work with XML documents as hierarchically structured data sets.</P>

<P>All XML documents can be represented as a hierarchy or tree of nodes. This aspect of XML shares a similarity to how paths are encoded in file system URLs, which are used in Windows Explorer to produce tree views of files and folders on your computer. The following table compares some of the analogous features of both XPath and file system URLs, both of which are used to pass information.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>File System URLs</TH>
<TH width=50%>XPath Patterns</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>Hierarchy comprised of directories and files in a file system.</TD>
<TD width=50%>Hierarchy comprised of elements and other nodes in an XML document.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Files at each level have unique names.</TD>
<TD width=50%>Element names at each level might not be unique.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>URLs always identify a single file.</TD>
<TD width=50%>XPath patterns identify a set of all the matching elements that match the pattern, which can be either one or many nodes.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Evaluated relative to a particular directory, called the "current directory."</TD>
<TD width=50%>Evaluated relative to a particular node called the "context" for the query.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>The following XML sample document shows a simple hierarchy, which can be used to demonstrate some of the facilities of XPath.</P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;authors&gt;
  &lt;author period="modern"&gt;
    &lt;name&gt;Eva Corets&lt;/name&gt;
    &lt;nationality&gt;British&lt;/nationality&gt;
  &lt;/author&gt;
  &lt;author&gt;
    &lt;name&gt;Cynthia Randall&lt;/name&gt;
    &lt;nationality&gt;Canadian&lt;/nationality&gt;
  &lt;/author&gt;
  &lt;author period="modern"&gt;
    &lt;name&gt;Paula Thurman&lt;/name&gt;
    &lt;nationality&gt;British&lt;/nationality&gt;
  &lt;/author&gt;
&lt;/authors&gt;</PRE>

<P>A basic XPath pattern describes a path through the XML hierarchy with a slash-separated list of child element names. For example, starting from the document root of the previous sample, the following pattern traverses down through the hierarchy to the <code class="ce">&lt;name&gt;</code> elements.</P>

<PRE class="code">authors/author/name</PRE>

<P>The XPath pattern identifies all elements that match the path. In addition to describing an exact path down a known hierarchy, XPath can include wildcards for describing unknown elements and selecting a set of nodes. This provides the basics of an XML query facility. For example, an element of any name can be represented by the "*" wildcard as shown in the following pattern.</P>

<PRE class="code">authors/*/name</PRE>

<P>The preceding sample identifies all the <code class="ce">&lt;name&gt;</code> elements that are grandchildren (children of any child element for the <code class="ce">&lt;authors&gt;</code> element), but without requiring them to be children of an <code class="ce">&lt;author&gt;</code> element. Here is another example that can be used to find both <code class="ce">&lt;name&gt;</code> and <code class="ce">&lt;nationality&gt;</code> elements in our sample document.</P>

<PRE class="code">authors/author/*</PRE>

<P>Using additional patterns within square brackets can specify branches on the path. For example, the following query describes a branch on the <code class="ce">&lt;author&gt;</code> element, indicating that only the <code class="ce">&lt;author&gt;</code> elements with <code class="ce">&lt;nationality&gt;</code> children should be considered as a pattern match.</P>

<PRE class="code">authors/author[nationality]/name</PRE>

<P>This becomes even more useful for the sample data when comparisons are added. The following query returns the names of Canadian authors.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;comparisons can be used only within brackets.</BLOCKQUOTE>

<PRE class="code">authors/author[nationality='Canadian']/name</PRE>

<P>Attributes are indicated in a query by preceding the name of the attribute with "@". The attribute can be tested as a branch off the main path, or the query can identify attribute nodes. The following examples return authors from the modern period, and just the two period attributes, respectively.</P>

<PRE class="code">authors/author[@period="modern"]
authors/author/@period</PRE>

<P>The above XPath expressions are also presented in the <A HREF="xpath_starter_5u7i.htm">XML Tutorial Application</A>. To practice using XPath, build and run the interactive tutorial to see which XML nodes are selected by various XPath patterns and expressions.</P>

<P>For a complete list of XPath features supported by MSXML, see <A HREF="xpath_syntax1_0fjs.htm">XPath Syntax</A>.</P>

<H4 class="dtH4">Other Resources <IMG SRC="leave-ms.gif" ALT="Other Resources" BORDER=0></H4>

<P><A HREF="http://go.microsoft.com/fwlink/?LinkId=4873">XML Path Language (XPath) Version 1.0</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
