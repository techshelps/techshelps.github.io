<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ISAXDeclHandler Interface</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - SAX2 Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="isaxdeclhandler_interface"></A>ISAXDeclHandler Interface</H1>

<P>The <code class="ce">ISAXDeclHandler/IVBSAXDeclHandler</code> interface allows you to access declaration information about the following:

<UL>
	<LI>Element and attribute types</li>

	<LI>Internal and external entities</li>
</UL>

<P>If you are using the <code class="ce">DeclHandler</code> with a <code class="ce">LexicalHandler</code>, all of the events occur between the <code class="ce">startDTD</code> and the <code class="ce">endDTD</code> events.</P>

<P>To set the <code class="ce">DeclHandler</code> for a SAX2 reader, use the <code class="ce">putProperty</code> method with the property ID, <code class="ce">"http://xml.org/sax/properties/declaration-handler"</code>.</P>

<H4 class="dtH4">Methods</H4>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TD width=29%><A HREF="sax_declhandler_5i90.htm">attributeDecl</A></TD>
<TD width=71%>Receives/reports an attribute type declaration.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%><A HREF="sax_declhandler_2jl0.htm">elementDecl</A></TD>
<TD width=71%>Receives/reports an element type declaration.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%><A HREF="sax_declhandler_4u5g.htm">externalEntityDecl</A></TD>
<TD width=71%>Receives/reports a parsed external entity declaration.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%><A HREF="sax_declhandler_8vms.htm">internalEntityDecl</A></TD>
<TD width=71%>Receives/reports a parsed internal entity declaration.</TD>
</TR>
</table></div>

<P class="fineprint"></P>
<div class=filtered><span class="lang">[Visual Basic]</span>

<P>The <code class="ce">IVBSAXDeclHandler</code> interface enables a Simple API for XML (SAX2) application to implement an optional extension handler that receives information about DTD declarations in an XML document. SAX2 readers are not required to support this handler, and this handler is not included in the core SAX2 distribution.</P>

<P>Data-related DTD declarations (unparsed entities and notations) are already reported through the <code class="ce">IVBSAXDTDHandler</code> interface.</P>

<P>The <code class="ce">IVBSAXDeclHandler</code> interface includes a series of methods that are invoked by the reader during the parsing operation. The reader passes the appropriate information to the parameters of the method. To perform some type of processing for a method, you add code to the method in the <code class="ce">DeclHandler</code> implementation. In general, you will rarely call these methods yourself from within the <code class="ce">DeclHandler</code>. Therefore, the syntax shown for the <code class="ce">IVBSAXDeclHandler</code> interface focuses on the implementation syntax, rather than the usage syntax.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Important</b>&nbsp;&nbsp;&nbsp;The SAX2 reader passes string values to <code class="ce">IVBSAXDeclHandler</code> methods by reference, rather than by value.</BLOCKQUOTE>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<P>This is an optional extension handler for SAX2 that provides information about DTD declarations in an XML document. Data-related DTD declarations (unparsed entities and notations) are already reported through the <code class="ce">ISAXDTDHandler</code> interface.</P>

<P>The following code shows how to use the <code class="ce">putProperty</code> method with the property ID, <code class="ce">http://xml.org/sax/properties/declaration-handler</code>, to set the <code class="ce">DeclHandler</code> for a SAX2 reader.</P>

<PRE class="code">... SAXXMLReader * r = ...
SAXDeclHandler * dh = new SAXDeclHandler();
r-&gt;putProperty("http://xml.org/sax/properties/declaration-handler", _variant_t(dh));</PRE>
</div><!-- [C/C++] -->

<H4 class="dtH4">Versioning</H4>

<P>MSXML 3.0 and later</P>

<H4 class="dtH4">Requirements</H4>

<P><B>Implementation:</B> msxml5.dll</P>
<div class=filtered><span class="lang">[C/C++]</span>

<P><B>Header and LIB files:</B> msxml2.h, msxml2.lib</P>
</div><!-- [C/C++] -->

<P>To view reference information for Visual Basic or C/C++ only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="sax_isaxlexicalhandler_6h44.htm">endDTD Method</A> | <A HREF="sax_dtdhandler_3qjp.htm">ISAXDTDHandler Interface</A> | <A HREF="sax_isaxxmlreader_41wk.htm">putProperty Method</A> | <A HREF="sax_isaxlexicalhandler_3yn8.htm">startDTD Method</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
