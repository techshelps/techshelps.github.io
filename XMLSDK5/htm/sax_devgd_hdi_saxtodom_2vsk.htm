<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Setting a DOMDocument Object as MXXMLWriter Output</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - SAX2 Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="sax_saxtodom_settingdomdocument"></A>Setting a DOMDocument Object as MXXMLWriter Output</H1>

<P>The following code shows how to set the <code class="ce">DOMDocument</code> object as <code class="ce">MXXMLWriter</code> output and how to get the <code class="ce">DOMDocument</code> output using <code class="ce">DOMDocument</code> methods.</P>

<H2 class="dtH2">Setting Output</H2>

<P>The following code shows how to set writer output as a <code class="ce">DOMDocument</code> object.</P>

<PRE class="code">Private Sub Command1_Click()
    'Create the DOMDocument object.
    Dim xmlDoc As New Msxml2.DOMDocument50
    'Create an MXXMLWriter object.
    Dim wrt As New MXXMLWriter50
    'Reference the ContentHandler interface.
    Dim cnth As IVBSAXContentHandler

    'Set the writer as the content handler.
    Set cnth = wrt
    'Set the writer output to the xmlDoc object.
    wrt.output = xmlDoc</PRE>

<H2 class="dtH2">Getting Output</H2>

<P>You can read the document at any time after the <code class="ce">startDocument</code> event is called. However, you cannot modify the document until after the <code class="ce">endDocument</code> event is called. The following code shows <code class="ce">DOMDocument</code> methods called on the <code class="ce">xmlDoc</code> object after the <code class="ce">endElement</code> method is called.</P>

<PRE class="code">    cnth.endDocument
     
    'Displays the author's name in a message box.
    Set objNodeList = xmlDoc.getElementsByTagName("author")
    MsgBox objNodeList.Item(0).Text</PRE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="sax_devgd_hdi_saxtodom_884z.htm">SAX to DOM Implementation Notes</A> | <A HREF="sax_mxxmlwriter_0m5v.htm">MXXMLWriter CoClass</A> | <A HREF="sax_mxxmlwriter_9hdf.htm">output Property</A> | <A HREF="xml_obj_ixmldomdocument_7gqc.htm">DOMDocument</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
