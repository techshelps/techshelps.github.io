<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Resource: books.xml and books.xsd</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="dom_hdi_cpp_validate_resource_smart"></A>Resource books.xml and books.xsd</H1>

<P>This example uses two resources files. One is an XML data file (<B>books.xml</B>) and the other is the XML schema definition file (<B>books.xsd</B>). According to <B>books.xsd</B>, the second <code class="ce">&lt;book&gt;</code> element in <B>books.xml</B> is missing the required <code class="ce">&lt;pub_date&gt;</code> child element. Therefore, when we attempt to validate the XML file against the given schema, we should get a validation error. </P>

<P class="label"><B>XML File (books.xml)</B></P>

<PRE class="code">&lt;?xml version="1.0"?&gt;
&lt;x:books xmlns:x="urn:books"&gt;
   &lt;book id="bk001"&gt;
      &lt;author&gt;Writer&lt;/author&gt;
      &lt;title&gt;The First Book&lt;/title&gt;
      &lt;genre&gt;Fiction&lt;/genre&gt;
      &lt;price&gt;44.95&lt;/price&gt;
      &lt;pub_date&gt;2000-10-01&lt;/pub_date&gt;
      &lt;review&gt;An amazing story of nothing.&lt;/review&gt;
   &lt;/book&gt;

   &lt;book id="bk002"&gt;
      &lt;author&gt;Poet&lt;/author&gt;
      &lt;title&gt;The Poet's First Poem&lt;/title&gt;
      &lt;genre&gt;Poem&lt;/genre&gt;
      &lt;price&gt;24.95&lt;/price&gt;
      &lt;review&gt;Least poetic poems.&lt;/review&gt;
   &lt;/book&gt;
&lt;/x:books&gt;</PRE>

<P class="label"><B>XSD File (books.xsd)</B></P>

<PRE class="code">&lt;xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
            targetNamespace="urn:books"
            xmlns:bks="urn:books"&gt;

  &lt;xsd:element name="books" type="bks:BooksForm"/&gt;

  &lt;xsd:complexType name="BooksForm"&gt;
    &lt;xsd:sequence&gt;
      &lt;xsd:element name="book" 
                  type="bks:BookForm" 
                  minOccurs="0" 
                  maxOccurs="unbounded"/&gt;
      &lt;/xsd:sequence&gt;
  &lt;/xsd:complexType&gt;

  &lt;xsd:complexType name="BookForm"&gt;
    &lt;xsd:sequence&gt;
      &lt;xsd:element name="author"   type="xsd:string"/&gt;
      &lt;xsd:element name="title"    type="xsd:string"/&gt;
      &lt;xsd:element name="genre"    type="xsd:string"/&gt;
      &lt;xsd:element name="price"    type="xsd:float" /&gt;
      &lt;xsd:element name="pub_date" type="xsd:date" /&gt;
      &lt;xsd:element name="review"   type="xsd:string"/&gt;
    &lt;/xsd:sequence&gt;
    &lt;xsd:attribute name="id"   type="xsd:string"/&gt;
  &lt;/xsd:complexType&gt;
&lt;/xsd:schema&gt;</PRE>

<P class="labelproc"><B>To add books.xml and books.xsd to the project</B>

<OL type="1">
	<LI>Create a new C++ source file. For detailed instructions on how to do this, see <A HREF="dom_hdi_9ypf.htm">Set Up My Visual C++ Project</A>. Name the new file <B>books.xml</B>.</li>

	<LI>Copy <B>books.xml</B> and paste it into the source file you just created.</li>

	<LI>Create another new C++ source file.</li>

	<LI>Copy <B>books.xsd</B> and paste it into the source file you just created.
<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;You can also copy the files into the project's main directory using Windows Explorer (or a command prompt).</BLOCKQUOTE>
</li>
</OL>

<P>Next, <A HREF="dom_hdi_9ypf.htm#dom_hdi_cpp_setupvs_br">build and run</A> the <B>validateDOMsmart</B> project. The result should be the <A HREF="dom_hdi_smart_8v78.htm">output</A> shown in the following topic.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
