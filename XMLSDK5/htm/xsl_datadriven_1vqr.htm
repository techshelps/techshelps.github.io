<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Data-Driven Transformations</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmcondatadriventransformations"></A>Data-Driven Transformations</H1>

<P><A HREF="xsl_fund_1pir.htm">Template-Driven Transformations</A> are useful for processing source documents with regular and homogenous data structures. Data-driven transformations, however, are usually better for processing source documents with complex and irregular data structures. The following book review article is an example of an irregular data structure.</P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;?xml-stylesheet type="text/xsl" href="book-review.xsl"?&gt;
&lt;book-review&gt;
   &lt;title&gt;A Good Book&lt;/title&gt; by &lt;author&gt;The Good Writer&lt;/author&gt;, 
   published by &lt;publisher&gt;The Publisher&lt;/publisher&gt; on &lt;date&gt;A Good 
   Day&lt;/date&gt;, is indeed a good book. However, the one titled &lt;title&gt;
   A Bad Book&lt;/title&gt; by the same publisher is very bad. This reviewer
   is left to wonder whether this is because &lt;title&gt;A Bad Book&lt;/title&gt;
   was written by &lt;author&gt;A Bad Author&lt;/author&gt;, or because it was 
   published on &lt;date&gt;A Bad Date&lt;/date&gt;.
&lt;/book-review&gt;</PRE>

<P>The elements contained in <code class="ce">&lt;book-review&gt;</code> can be arbitrary, and there is no intrinsic order of elements. The best way to display the content in this case is to follow the order in which the elements appear in the source document. To do this, you cannot set up templates to decide where different data elements appear in the output, and feed the source document into the predefined template, as you would in a template-driven transformation. In a data-driven transformation, templates are reactive &#0151; that is, they are called whenever a matching data element is encountered.</P>

<P>The following is an example of a data-driven XSLT style sheet for displaying the book review article above.</P>

<P class="label"><B>XSLT File (book-review.xsl)</B></P>

<PRE class="code">&lt;?xml version="1.0"?&gt;
&lt;xsl:stylesheet version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
  &lt;xsl:template match="/"&gt;
    &lt;HTML&gt;
      &lt;HEAD&gt;
      &lt;/HEAD&gt;
      &lt;BODY&gt;
         &lt;xsl:apply-templates /&gt;
      &lt;/BODY&gt; 
    &lt;/HTML&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="book-review"&gt;
      &lt;P&gt;&lt;xsl:apply-templates /&gt;&lt;/P&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="title"&gt;
      &lt;SPAN style="font-weight:bold"&gt;&lt;xsl:value-of select="."/&gt;&lt;/SPAN&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="author"&gt;
      &lt;SPAN style="font-style:italic"&gt;&lt;xsl:value-of select="."/&gt;&lt;/SPAN&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="publisher"&gt;
      &lt;SPAN style="color:blue"&gt;&lt;xsl:value-of select="."/&gt;&lt;/SPAN&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match="date"&gt;
      &lt;SPAN style="font-family:courier"&gt;&lt;xsl:value-of select="."/&gt;&lt;/SPAN&gt;
  &lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</PRE>

<P>The following topics discuss data-driven transformations in more detail.

<UL type="disc">
	<LI><A HREF="xsl_datadriven_9stv.htm">Handling Irregular Data Hierarchies</A></li>

	<LI><A HREF="xsl_datadriven_5ahx.htm">Defining Match Patterns in &lt;xsl:template&gt;</A></li>

	<LI><A HREF="xsl_datadriven_6ugk.htm">Debugging a Style Sheet</A></li>

	<LI><A HREF="xsl_datadriven_3l83.htm">Using the Built-in Template Rules</A></li>

	<LI><A HREF="xsl_datadriven_5b1u.htm">Translating from One XML Schema to Another</A></li>

	<LI><A HREF="xsl_datadriven_6acz.htm">Generating Comments, Processing Instructions, and Elements</A></li>
</UL>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
