<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sample HTML File for XML Data Islands</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconsamplehtmlfileforxmldataislands"></A>Sample HTML File for XML Data Islands</H1>

<P class="label"><B>XML File (book_catalog.xml)</B></P>

<PRE class="code">&lt;?xml version="1.0"?&gt;
&lt;catalog&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk101"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;XML Developer's Guide&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Gambardella, Matthew&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Computer&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;44.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-10-01&lt;/publish_date&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;An in-depth look at creating applications with XML.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk102"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Midnight Rain&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Ralls, Kim&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Fantasy&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;5.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-12-16&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;A former architect battles corporate zombies, an evil sorceress, and her own childhood to become queen of the world.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk103"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Maeve Ascendant&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Corets, Eva&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Fantasy&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;5.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-11-17&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;After the collapse of a nanotechnology society in England, the young survivors lay the foundation for a new society.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk104"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Oberon's Legacy&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Corets, Eva&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Fantasy&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;5.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2001-03-10&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;In post-apocalypse England, the mysterious agent known only as Oberon helps to create a new life for the inhabitants of London. Sequel to Maeve Ascendant.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk105"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;The Sundered Grail&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Corets, Eva&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Fantasy&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;5.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2001-09-10&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;The two daughters of Maeve, half-sisters, battle one another for control of England. Sequel to Oberon's Legacy.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk106"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Lover Birds&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Randall, Cynthia&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Romance&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;4.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-09-02&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;When Carla meets Paul at an ornithology conference, tempers fly as feathers get ruffled.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk107"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Splish Splash&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Thurman, Paula&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Romance&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;4.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-11-02&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;A deep sea diver finds true love twenty thousand leagues beneath the sea.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk108"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Creepy Crawlies&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Knorr, Stefan&lt;/author&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Horror&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;4.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-12-06&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;An anthology of horror stories about roaches, centipedes, scorpions  and other insects.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk109"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Paradox Lost&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Kress, Peter&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Science Fiction&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;6.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-11-02&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;After an inadvertant trip through a Heisenberg Uncertainty Device, James Salway discovers the problems of being quantum.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk110"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Microsoft .NET: The Programming Bible&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;O'Brien, Tim&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Computer&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;36.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-12-09&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;Microsoft's .NET initiative is explored in detail in this deep programmer's reference.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk111"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;MSXML3: A Comprehensive Guide&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;O'Brien, Tim&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Computer&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;36.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2000-12-01&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;The Microsoft MSXML3 parser is covered in detail, with attention to XML DOM interfaces, XSLT processing, SAX and more.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;
&nbsp;&nbsp;&nbsp;&lt;book id="bk112"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;Visual Studio 7: A Comprehensive Guide&lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;Galos, Mike&lt;/author&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;genre&gt;Computer&lt;/genre&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;price&gt;49.95&lt;/price&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;2001-04-16&lt;/publish_date&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;Microsoft Visual Studio 7 is explored in depth, looking at how Visual Basic, Visual C++, C#, and ASP+ are integrated into a comprehensive development environment.&lt;/description&gt;
&nbsp;&nbsp;&nbsp;&lt;/book&gt;&nbsp;&nbsp;&nbsp;
&lt;/catalog&gt;</PRE>

<P class="label"><B>HTML File (DataIsland.htm)</B></P>

<PRE class="code">&lt;HTML&gt;
&lt;HEAD&gt;
&nbsp;&nbsp;&nbsp;&lt;TITLE&gt;Untitled&lt;/TITLE&gt;
    &lt;STYLE&gt;
        .catalog_genre_head {background-color:darkGreen;font-size:24pt;color:white;font-family:Impact;}
        .catalog_head {background-color:green;font-size:18pt;color:white;font-family:Impact;}
        .catalog_row0 {background-color:lightGreen;}
        .catalog_row1 {background-color:white;}
        .catalog_row_end {background-color:darkGreen;}
    &lt;/STYLE&gt;
&lt;/HEAD&gt;

&lt;BODY&gt;
&lt;H1&gt;Scootney Press Book Catalog&lt;/H1&gt;
&lt;P&gt;Select a genre to see all books in that genre:&lt;/P&gt;
&lt;DIV id="catalog_table"&gt;&lt;/DIV&gt;

&lt;xml id="book_catalog" src="book_catalog.xml"&gt;
&lt;/xml&gt;

<B>&lt;xml id="catalog_filter"&gt;</B>
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns:msxsl="urn:schemas-microsoft-com:xslt"
        version="1.0"&gt;
    
        &lt;xsl:output method="xml" omit-xml-declaration="yes"/&gt;
        
        &lt;xsl:param name="selected_genre" select="'all'"/&gt;
        
        &lt;xsl:template match="/"&gt;
                &lt;div&gt;
                    &lt;form method="post" action="catalog.asp"&gt;
                    Genre
                    &lt;select name="genre" value="{$selected_genre}" onchange="showGenre(this.value)"&gt;
                        &lt;option value="all"&gt;&lt;xsl:if test="$selected_genre='all'"&gt;&lt;xsl:attribute name="selected"&gt;Selected&lt;/xsl:attribute&gt;&lt;/xsl:if&gt;All&lt;/option&gt;
                        &lt;option value="Computer"&gt;&lt;xsl:if test="$selected_genre='Computer'"&gt;&lt;xsl:attribute name="selected"&gt;Selected&lt;/xsl:attribute&gt;&lt;/xsl:if&gt;Computer&lt;/option&gt;
                        &lt;option value="Fantasy"&gt;&lt;xsl:if test="$selected_genre='Fantasy'"&gt;&lt;xsl:attribute name="selected"&gt;Selected&lt;/xsl:attribute&gt;&lt;/xsl:if&gt;Fantasy&lt;/option&gt;
                        &lt;option value="Horror"&gt;&lt;xsl:if test="$selected_genre='Horror'"&gt;&lt;xsl:attribute name="selected"&gt;Selected&lt;/xsl:attribute&gt;&lt;/xsl:if&gt;Horror&lt;/option&gt;
                        &lt;option value="Romance"&gt;&lt;xsl:if test="$selected_genre='Romance'"&gt;&lt;xsl:attribute name="selected"&gt;Selected&lt;/xsl:attribute&gt;&lt;/xsl:if&gt;Romance&lt;/option&gt;
                        &lt;option value="Science Fiction"&gt;&lt;xsl:if test="$selected_genre='Science Fiction'"&gt;&lt;xsl:attribute name="selected"&gt;Selected&lt;/xsl:attribute&gt;&lt;/xsl:if&gt;Science Fiction&lt;/option&gt;
                    &lt;/select&gt;
                    &lt;/form&gt;
                    &lt;br/&gt;
                    &lt;xsl:apply-templates select="catalog"/&gt;
            &lt;/div&gt;                    
        &lt;/xsl:template&gt;
        
        &lt;xsl:template match="catalog"&gt;
            &lt;table class="catalog_table"&gt;
                &lt;xsl:apply-templates select="book[($selected_genre='all') or ($selected_genre=./genre)]"&gt;
                    &lt;xsl:sort select="title"/&gt;
                &lt;/xsl:apply-templates&gt;
            &lt;/table&gt;
        &lt;/xsl:template&gt;
        
        &lt;xsl:template match="book"&gt;
            &lt;xsl:if test="position()=1"&gt;
            &lt;tr class="catalog_genre_head"&gt;&lt;td colspan="6"&gt;
            &lt;xsl:choose&gt;
            &lt;xsl:when test="$selected_genre='all'"&gt;
            All Genres
            &lt;/xsl:when&gt;
            &lt;xsl:otherwise&gt;
            Genre: &lt;xsl:value-of select="genre"/&gt;
            &lt;/xsl:otherwise&gt;
            &lt;/xsl:choose&gt;
            &lt;/td&gt;&lt;/tr&gt;            
            &lt;tr class="catalog_head"&gt;
                &lt;td&gt;#&lt;/td&gt;
                &lt;td&gt;Title&lt;/td&gt;
                &lt;td&gt;Author&lt;/td&gt;
                &lt;td&gt;Publication Date&lt;/td&gt;
                &lt;td&gt;Description&lt;/td&gt;
                &lt;xsl:if test="$selected_genre='all'"&gt;
                &lt;td&gt;Genre&lt;/td&gt;
                &lt;/xsl:if&gt;
            &lt;/tr&gt;
            &lt;/xsl:if&gt;
            &lt;tr class="catalog_row{position() mod 2}"&gt;
                &lt;td&gt;&lt;xsl:value-of select="position()"/&gt;&lt;/td&gt;
                &lt;td class="catalog_cell"&gt;&lt;xsl:value-of select="title"/&gt;&lt;/td&gt;
                &lt;td class="catalog_cell"&gt;&lt;xsl:value-of select="author"/&gt;&lt;/td&gt;
                &lt;td class="catalog_cell"&gt;&lt;xsl:value-of select="publish_date"/&gt;&lt;/td&gt;                    
                &lt;td class="catalog_cell"&gt;&lt;xsl:value-of select="description"/&gt;&lt;/td&gt;
                &lt;xsl:if test="$selected_genre='all'"&gt;
                &lt;td class="catalog_cell"&gt;&lt;xsl:value-of select="genre"/&gt;&lt;/td&gt;
                &lt;/xsl:if&gt;
            &lt;/tr&gt;
            &lt;xsl:if test="position()=last()"&gt;
            &lt;tr class="catalog_row_end"&gt;&lt;td colspan="6"&gt; &lt;/td&gt;&lt;/tr&gt;
            &lt;/xsl:if&gt;
        &lt;/xsl:template&gt;
    &lt;/xsl:stylesheet&gt;
&lt;/xml&gt;


&lt;SCRIPT language="JavaScript"&gt;
function loadSource(sourceObj){
    var xmlDoc=new ActiveXObject("Msxml2.FreeThreadedDOMDocument.5.0");
    xmlDoc.async=false;
    xmlDoc.load(sourceObj.XMLDocument);
    return xmlDoc;
    }

var table_proc=null;

function getProcessor(transformObj){
    if (table_proc==null){
        var xslDoc=new ActiveXObject("Msxml2.FreeThreadedDOMDocument.5.0");
        var xslTemplate=new ActiveXObject("Msxml2.XSLTemplate.5.0");
        xslDoc.async=false;
        xslDoc.load(transformObj.XMLDocument);
        xslTemplate.stylesheet=xslDoc;
        xslProcessor=xslTemplate.createProcessor();
        table_proc=xslProcessor;
        }
    else {
        xslProcessor=table_proc;
        }
    return xslProcessor;
    }
    
function transformData(srcDoc,processor){
    var resultDoc=new ActiveXObject("MSXML.DOMDocument");
    processor.input=srcDoc;
    processor.output=resultDoc;
    processor.transform();
    return resultDoc;
    }

function showGenre(genre){
    var srcDoc=loadSource(book_catalog);
    var processor=getProcessor(catalog_filter);
    processor.addParameter("selected_genre",genre);
    var rsltDoc=transformData(srcDoc,processor);
    catalog_table.innerHTML=rsltDoc.xml
    }    

showGenre("all");    

&lt;/SCRIPT&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;</PRE>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
