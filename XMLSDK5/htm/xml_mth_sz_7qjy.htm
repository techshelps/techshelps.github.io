<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>setOption Method</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmthsetoption"></A>setOption Method</H1>

<P>Sets one of the following options:

<UL type="disc">
	<LI><code class="ce">SXH_OPTION_URL_CODEPAGE</code></li>

	<LI><code class="ce">SXH_OPTION_ESCAPE_PERCENT_IN_URL</code></li>

	<LI><code class="ce">SXH_OPTION_IGNORE_SERVER_SSL_CERT_ERROR_FLAGS</code></li>

	<LI><code class="ce">SXH_OPTION_SELECT_CLIENT_SSL_CERT</code></li>
</UL>

<P>For more information about these options, see <B>Remarks</B>.</P>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">oServerXMLHTTPRequest.setOption(option, value);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>option</I></DT>

<DD>The option whose value is to be set.</dd>

<DT><I>value</I></DT>

<DD>The value to which the specified option is to be set.</dd>
</DL>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">oServerXMLHTTPRequest.setOption(option, value)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>option</I></DT>

<DD>The option whose value is to be set.</dd>

<DT><I>value</I></DT>

<DD>The value to which the specified option is to be set.</dd>
</DL>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT setOption(SERVERXMLHTTP_OPTION option, VARIANT value);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>option</I> [in]</DT>

<DD>The option whose value is to be set. </dd>

<DT><I>value</I> [in]</DT>

<DD>The value to which the specified option is to be set.</dd>
</DL>

<H4 class="dtH4">C/C++ Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>Value returned if successful.</dd>
</DL>
</div><!-- [C/C++] -->

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">Remarks</H4>

<P>The following table lists the options available to the <code class="ce">setOption</code> method.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=14%>Option</TH>
<TH width=86%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=14%><code class="ce">0</code></TD>
<TD width=86%><code class="ce">SXH_OPTION_URL_CODEPAGE</code>
<P>By default, CP_UTF8 is the code page used to convert the Unicode URL string (specified in the <code class="ce">open</code> method) to a single-byte representation.</P>

<P>The <code class="ce">SXH_OPTION_URL_CODEPAGE</code> option allows the client to override this default with a different code page value. The client should specify an unsigned integer value for the code page.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=14%><code class="ce">1</code></TD>
<TD width=86%><code class="ce">SXH_OPTION_ESCAPE_PERCENT_IN_URL</code>
<P>By default, escaping unsafe ANSI characters in the URL (for example, " " -&gt; "%20") does not escape the % character itself.</P>

<P>The SXH_OPTION_ESCAPE_PERCENT_IN_URL option allows the client to change this behavior. The client should specify a Boolean True/False value for this option.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=14%><code class="ce">2</code></TD>
<TD width=86%><code class="ce">SXH_OPTION_IGNORE_SERVER_SSL_CERT_ERROR_FLAGS</code>
<P><code class="ce">The SXH_OPTION_IGNORE_SERVER_SSL_CERT_ERROR_FLAGS</code> option is a DWORD mask of various flags that can be set to change this default behavior. The default value is to ignore all problems. You must set this option before calling the <code class="ce">send</code> method. The flags are as follows:</P>

<P><code class="ce">SXH_SERVER_CERT_IGNORE_UNKNOWN_CA = 256</code></P>

<BLOCKQUOTE class="dtBlock">
Unknown certificate authority</BLOCKQUOTE>

<P><code class="ce">SXH_SERVER_CERT_IGNORE_WRONG_USAGE = 512</code></P>

<BLOCKQUOTE class="dtBlock">
Malformed certificate such as a certificate with no subject name.</BLOCKQUOTE>

<P><code class="ce">SXH_SERVER_CERT_IGNORE_CERT_CN_INVALID = 4096</code></P>

<BLOCKQUOTE class="dtBlock">
Mismatch between the visited hostname and the certificate name being used on the server. </BLOCKQUOTE>

<P><code class="ce">SXH_SERVER_CERT_IGNORE_CERT_DATE_INVALID = 8192</code></P>

<BLOCKQUOTE class="dtBlock">
The date in the certificate is invalid or has expired.</BLOCKQUOTE>

<P><code class="ce">SXH_SERVER_CERT_IGNORE_ALL_SERVER_ERRORS = 13056</code></P>

<BLOCKQUOTE class="dtBlock">
All certificate errors.</BLOCKQUOTE>

<P>To turn off a flag, you subtract it from the default value, which is the sum of all flags. For example, to catch an invalid date in a certificate, you turn off the <code class="ce">SXH_SERVER_CERT_IGNORE_CERT_DATE_INVALID</code> flag as follows:</P>

<PRE class="code">shx.setOption(2, shx.getOption(2) _
                    - SXH_SERVER_CERT_IGNORE_CERT_DATE_INVALID)</PRE>
</TD>
</TR>

<TR VALIGN="top">
<TD width=14%><code class="ce">3</code></TD>
<TD width=86%><code class="ce">SXH_OPTION_SELECT_CLIENT_SSL_CERT</code>
<P>By default, the value of this option is an empty string (""), which means pick the first certificate in the local store to send if the server requests a client certificate.</P>

<P>The <code class="ce">SXH_OPTION_SELECT_CLIENT_SSL_CERT</code> option is a string that lets you select which client certificate from the local store should be sent. You must set this option before calling the <code class="ce">send</code> method. The following example sets the client certificate option to request the client certificate named "MSXML":</P>

<PRE class="code">shx.setOption(3, "MSXML")</PRE>
</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;Option &#0150;1, <code class="ce">SXH_OPTION_URL</code>, is a read-only return value, and can therefore not be set by the <code class="ce">setOption</code> method. For more information about this option, see <A HREF="xml_mth_dg_4gmm.htm">getOption Method</A>.</BLOCKQUOTE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_mth_or_7nxs.htm">open Method</A></P>

<P>Applies to: <A HREF="xml_obj_iserverxmlhttprequest_7zlc.htm">IServerXMLHTTPRequest/ServerXMLHTTP</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
