<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ms:string-compare Function</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="msstringcomparefunction"></A>ms:string-compare Function</H1>

<P>Performs string comparison. This function is necessary because two strings cannot be compared lexicographically using XPath.</P>

<PRE class="syntax"><I>number</I> ms:string-compare(string x,<I> </I>string y, [,string language _
                                             [,string options]])</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>string x</I></DT>

<DD>String value for comparison. Nonstring values are converted to a string value before comparison.</dd>

<DT><I>string y</I> </DT>

<DD>String value for comparison. Nonstring values are converted to a string value before comparison.</dd>

<DT><I>string language</I> [optional]</DT>

<DD>Defines the language to determine the sort order. This is similar to the <code class="ce">&lt;xsl:sort&gt; lang</code> attribute (for example, <code class="ce">"en-US"</code> or <code class="ce">"fr-CA"</code>). If this parameter is omitted or an empty string, the language is defined by the system environment (language of the current thread).</dd>

<DT><I>string options</I> [optional]</DT>

<DD>By default, comparison is case-sensitive, with lowercase first.

<P class="fineprint">

<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=19%>option</TH>
<TH width=81%>description</TH>
</TR>

<TR VALIGN="top">
<TD width=19%>u</TD>
<TD width=81%>Makes the comparison case-sensitive, uppercase first.</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>i</TD>
<TD width=81%>Makes the comparison case-insensitive to all traditional differences between characters, such as case, kana, and width. (Character width only applies to some languages.)</TD>
</TR>
</table></div>


<P class="fineprint">
</dd>
</DL>

<H4 class="dtH4">Return values</H4>

<P>Returns one of the following three numerical values.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>If </TH>
<TH width=50%>The example function returns</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>x &lt; y </TD>
<TD width=50%>-1 </TD>
</TR>

<TR VALIGN="top">
<TD width=50%>x = y </TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>x &gt; y </TD>
<TD width=50%>1</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">Remarks</H4>

<P>Comparisons between strings are made in lexicographical (dictionary) order. Specifying an unsupported language or option causes a runtime error to occur. For MSXML components, E_FAIL is returned.</P>

<H4 class="dtH4">Example</H4>

<P>The following code example shows how to compare two strings by using the <code class="ce">ms:string-compare</code> function. The example compares three strings of numbers ("1", "2", and "3") with "2". The results of the comparisons are shown in the table that follows the code.</P>

<P class="label"><B>XML File</B></P>

<PRE class="code">&lt;?xml version="1.0"?&gt;
&lt;string-sample&gt;
   &lt;string&gt;1&lt;/string&gt;
   &lt;string&gt;2&lt;/string&gt;
   &lt;string&gt;3&lt;/string&gt;
&lt;/string-sample&gt;</PRE>

<P class="label"><B>XSLT File (translate.xsl)</B></P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;xsl:stylesheet  version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
      xmlns:ms="urn:schemas-microsoft-com:xslt"&gt;
   &lt;xsl:output method="html" omit-xml-declaration="yes"/&gt;
   &lt;xsl:template match="/string-sample"&gt;
      &lt;xsl:for-each select="string"&gt;
         &lt;xsl:value-of select="ms:string-compare(., '2', 'en-US', 'i')"/&gt;,
     &lt;/xsl:for-each&gt;
  &lt;/xsl:template&gt;</PRE>

<P>The results of the comparisons are as follows:</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>x, y</TH>
<TH width=50%>Result</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>"1" , "2" </TD>
<TD width=50%>-1</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>"2" , "2" </TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>"3" , "2" </TD>
<TD width=50%>1</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">See Also</H4>

<DL>
<DT><A HREF="xsd_devdatatypes_065v.htm">Data Types in Schemas</A> | <A HREF="xsd_ref_7gh1.htm">XML Schema Reference (XSD)</A> | <A HREF="xsd_ref_5bc5.htm">XML Data Types Reference</A></DT>
</DL>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
