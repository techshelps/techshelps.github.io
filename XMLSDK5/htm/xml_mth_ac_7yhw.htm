<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>appendChild Method</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmthappendchild"></A>appendChild Method</H1>

<P>Appends a new child node as the last child of the node.</P>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">var objXMLDOMNode = oXMLDOMNode.appendChild(newChild);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>newChild</I></DT>

<DD>An object. Address of the new child node to be appended at the end of the list of children belonging to this node.</dd>
</DL>

<H4 class="dtH4">Return Value</H4>

<P>An object. Returns the new child node successfully appended to the list.</P>

<H4 class="dtH4">Example</H4>

<P>The following script example creates a new <code class="ce">IXMLDOMNode</code> object, and then uses the <code class="ce">appendChild</code> method to append it to the document's list of children.</P>

<PRE class="code">var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.5.0");
var root;
var newNode;
xmlDoc.async = false;
xmlDoc.load("books.xml");
if (xmlDoc.parseError.errorCode &lt;&gt; 0) {
&nbsp;&nbsp;&nbsp;var myErr = xmlDoc.parseError;
&nbsp;&nbsp;&nbsp;alert("You have error " + myErr.reason);
} else {
&nbsp;&nbsp;&nbsp;root = xmlDoc.documentElement;
&nbsp;&nbsp;&nbsp;alert(root.xml);
&nbsp;&nbsp;&nbsp;newNode = xmlDoc.createNode(1, "VIDEOS", "");
&nbsp;&nbsp;&nbsp;root.appendChild(newNode);
&nbsp;&nbsp;&nbsp;alert(root.xml);
}</PRE>

<H4 class="dtH4">Remarks</H4>

<P>This is equivalent to calling <code class="ce">insertBefore(newChild, null)</code>. For more information, see <A HREF="xml_mth_hn_0j51.htm">insertBefore Method</A>.</P>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">Set objXMLDOMNode = oXMLDOMNode.appendChild(newChild)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>newChild</I></DT>

<DD>An object. The address of the new child node to be appended at the end of the list of children belonging to this node.</dd>
</DL>

<H4 class="dtH4">Return Value</H4>

<P>An object. Returns the new child node successfully appended to the list.</P>

<H4 class="dtH4">Example</H4>

<P>The following Microsoft&reg; Visual Basic&reg; example creates a new <code class="ce">IXMLDOMNode</code> object, and then uses the <code class="ce">appendChild</code> method to append it to the document's list of children.</P>

<PRE class="code">Dim xmlDoc As New Msxml2.DOMDocument50
Dim root As IXMLDOMElement
Dim newNode As IXMLDOMNode

xmlDoc.async = False
xmlDoc.Load ("books.xml")
If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
&nbsp;&nbsp;&nbsp;Dim myErr
&nbsp;&nbsp;&nbsp;Set myErr = xmlDoc.parseError
&nbsp;&nbsp;&nbsp;MsgBox("You have error " &amp; myErr.reason)
Else
&nbsp;&nbsp;&nbsp;Set root = xmlDoc.documentElement
&nbsp;&nbsp;&nbsp;MsgBox root.xml
&nbsp;&nbsp;&nbsp;Set newNode = xmlDoc.createNode(NODE_ELEMENT, "VIDEOS", "")
&nbsp;&nbsp;&nbsp;root.appendChild newNode
&nbsp;&nbsp;&nbsp;MsgBox root.xml
End If</PRE>

<H4 class="dtH4">Remarks</H4>

<P>This is equivalent to calling <code class="ce">insertBefore(newChild, null)</code>. For more information, see <A HREF="xml_mth_hn_0j51.htm">insertBefore Method</A>.</P>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT appendChild(
    IXMLDOMNode *newChild,
    IXMLDOMNode **outNewChild);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>newChild</I> [in]</DT>

<DD>The address of the new child node to be appended to the end of the list of children of this node.</dd>

<DT><I>outNewChild</I> [out, retval]</DT>

<DD>The new child node successfully appended to the list. If Null, no object is created.</dd>
</DL>

<H4 class="dtH4">C/C++ Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>The value returned if successful.</dd>

<DT>E_INVALIDARG</DT>

<DD>The value returned if the <code class="ce">newChild</code> parameter is Null.</dd>

<DT>E_FAIL</DT>

<DD>The value returned if an error occurs.</dd>
</DL>
</div><!-- [C/C++] -->

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">Remarks</H4>

<P>If the <code class="ce">newChild</code> parameter has an existing parent, the node is automatically removed from that parent before being inserted into its new location.</P>

<P>A node retains its namespace information even when moved. Moving a node does not create a namespace declaration; declarations are added when retrieving the XML source (through the <code class="ce">save</code> method or the <code class="ce">xml</code> property) to ensure that all namespaces are properly declared.</P>

<P>When inserting a node tree under another node that has a different owner document, the <code class="ce">ownerDocument</code> property for each inserted node is changed to match the owner document of its new parent.</P>

<P>When moving a node tree to another document, the content of all entity reference nodes contained therein is updated to conform to the new document. If the new document does not declare an entity that was moved into it, the entity reference will have no children, and the old content is removed. Existing references to nodes under the entity reference are still valid, but the node whose parent previously was the entity reference now has a null parent.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_mth_sz_0z1h.htm">save Method</A> | <A HREF="xml_pro_sz_9ooc.htm">xml Property</A> | <A HREF="xml_pro_no_38c4.htm">ownerDocument Property</A></P>

<P>Applies to: <A HREF="xml_obj_ixmldomattribute_34kl.htm">IXMLDOMAttribute</A> | <A HREF="xml_obj_ixmldomcdatasection_4u9a.htm">IXMLDOMCDATASection</A> | <A HREF="xml_obj_ixmldomcharacterdata_4ov5.htm">IXMLDOMCharacterData</A> | <A HREF="xml_obj_ixmldomcomment_40ac.htm">IXMLDOMComment</A> | <A HREF="xml_obj_ixmldomdocument_7gqc.htm">DOMDocument</A> | <A HREF="xml_obj_ixmldomdocumentfragment_0zxw.htm">IXMLDOMDocumentFragment</A> | <A HREF="xml_obj_ixmldomdocumenttype_619h.htm">IXMLDOMDocumentType</A> | <A HREF="xml_obj_ixmldomelement_8yyc.htm">IXMLDOMElement</A> | <A HREF="xml_obj_ixmldomentity_2c8p.htm">IXMLDOMEntity</A> | <A HREF="xml_obj_ixmldomentityreference_25k5.htm">IXMLDOMEntityReference</A> | <A HREF="xml_obj_ixmldomnode_5xwl.htm">IXMLDOMNode</A> | <A HREF="xml_obj_ixmldomnotation_5d7y.htm">IXMLDOMNotation</A> | <A HREF="xml_obj_ixmldomprocessinginstruction_6ilw.htm">IXMLDOMProcessingInstruction</A> | <A HREF="xml_obj_ixmldomtext_8sxg.htm">IXMLDOMText</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
