<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Gathering Document Information</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmcongatheringdocumentinformation"></A>Gathering Document Information</H1>

<P>These properties can be used to get the following information about the document parsing process.

<UL type="disc">
	<LI><A HREF="xml_pro_ae_5n8l.htm">doctype</A>
<P>The document type definition (DTD) accompanying the document.
</li>

	<LI><A HREF="xml_pro_fm_7yy6.htm">implementation</A>
<P>The implementation for the document.
</li>

	<LI><A HREF="xml_pro_pr_2v1u.htm">parseError</A>
<P>The last error to occur while parsing.
</li>

	<LI><A HREF="xml_pro_pr_2r1w.htm">readyState</A>
<P>Information about the state of the XML document.
</li>

	<LI><A HREF="xml_pro_sz_3jw4.htm">url</A>
<P>The URL, if any, of the XML file being loaded and parsed.
</li>
</UL>

<P>For more information about error reporting, see <A HREF="xml_obj_ixmldomparseerror_7jqq.htm">IXMLDOMParseError</A>.</P>

<P>The <code class="ce">readyState</code> property is critical for programs that use Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office asynchronously to improve performance. When loading XML documents asynchronously, your programs may need to check the state of the parsing process. MSXML provides four states, numbered one through four: loading, loaded, interactive (parsing), and completed. The following Microsoft JScript® and HTML example demonstrates the sequence of ready states when asynchronously loading a document.</P>

<PRE class="code">&lt;script&gt;
var xmldoc;
function Load()
{
    xmldoc = new ActiveXObject("Msxml2.DOMDocument.5.0");
    xmldoc.onreadystatechange = CheckState;
    xmldoc.load(URL.value);
&nbsp;&nbsp;&nbsp;if (xmlDoc.parseError.errorCode &lt;&gt; 0) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var myErr = xmlDoc.parseError;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("You have error " + myErr.reason);
&nbsp;&nbsp;&nbsp;}
}
function CheckState()
{
    var state = xmldoc.readyState;
    RESULTS.innerHTML += "readyState = " + state + "&lt;BR&gt;"
    if (state == 4)
    {
      var err = xmldoc.parseError;
        if (err.errorCode != 0)
          RESULTS.innerHTML += err.reason + "&lt;BR&gt;"
        else
          RESULTS.innerHTML +="success" + "&lt;BR&gt;"
    }
}
&lt;/script&gt;
URL: &lt;input type=text size=60 id=URL&gt;
&lt;input type=button value=LOAD onclick="jscript:Load()"&gt;
&lt;div id=RESULTS style="color:red; font-weight:bold;"&gt;&lt;/div&gt;</PRE>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
