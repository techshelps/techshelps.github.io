<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Constructing a Multi-step XPath Expression</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconconstructamultistepxpathexpression"></A>Constructing a Multi-step XPath Expression</H1>

<P>Location paths can contain more than one location step, separated from one another by slashes. Each succeeding location step, reading the pattern from left to right, is evaluated in the context of the nodes selected by all the location steps which precede it.</P>

<P>Consider the following location path:</P>

<PRE class="code">person[@birthdate &amp;lt;= "1951-06-18"]/surname[substring(., 1, 1)="S"]</PRE>

<P>This location path consists of two location steps. We have already seen in this section the first step (preceding the slash). It locates a node-set consisting of only one node, or none, or several. If there is at least one node in the resulting node-set, the second step (following the slash) kicks in, and restricts the list of matching nodes even further. Specifically, of the node(s) selected by the first step, the location path as a whole selects only those (if any) with a child named <code class="ce">&lt;surname&gt;</code> whose content begins with the letter "S".</P>

<P>Note that the above location path moves you down the document tree, from the context node, to its <code class="ce">&lt;person&gt;</code> child(ren), to the <code class="ce">&lt;surname&gt;</code> child(ren) of each of the matching <code class="ce">&lt;person&gt;</code> elements. Because of the wide variety of XPath axes, however, this downward direction is not the only option available to you. For example, a location path might be constructed as follows:</P>

<PRE class="code">person[@birthdate &amp;lt;= "1951-06-18"]/surname[substring(., 1, 1)="S"]/<code><b class="cfe">../preceding-sibling::*</b></code></PRE>

<P>The two addition location steps in this path move you from the node(s) selected in the earlier example up to their parents (<code><b class="cfe">..</b></code>), and then sideways to include only the nodes which are preceding siblings of those parents (<code><b class="cfe">preceding-sibling::*</b></code>).</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_hdi_2_4s4h.htm">Use XPath Axes to Navigate through XML Data</A> | <A HREF="xpath_concepts2_8a40.htm">Constructing the Node-Test Portion of a Location Step</A> | <A HREF="xpath_concepts7_6uur.htm">Filtering XML Data Using XPath Predicates</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
