<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating the Main Form</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - SAX2 Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="sax2vb_mainform_creating"></A>Creating the Main Form</H1>

<P>The main form provides the user interface for the JumpStart application and consists of four elements.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=30%>Interface Element</TH>
<TH width=70%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=30%>Text1</TD>
<TD width=70%>A text box for entering the file name of the file to parse.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>Command1</TD>
<TD width=70%>A button to start the parse process.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>Command2</TD>
<TD width=70%>A button to exit the application.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>Text2</TD>
<TD width=70%>A text box that displays the results of the parse operation.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>In addition to providing the interface elements, the main form also provides code that creates the required instances of the classes and starts the parse process.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=37%>To</TH>
<TH width=63%>The main form uses this code</TH>
</TR>

<TR VALIGN="top">
<TD width=37%>Create an instance of the reader (<code class="ce">SAXXMLReader</code>)</TD>
<TD width=63%><code class="ce">Dim reader As New SAXXMLReader</code></TD>
</TR>

<TR VALIGN="top">
<TD width=37%>Create an instance of <code class="ce">ContentHandlerImpl</code> and set it to receive events from the reader</TD>
<TD width=63%><code class="ce">Dim contentHandler As New ContentHandlerImpl</code><BR>
<code class="ce">Set reader.contentHandler = contentHandler</code></TD>
</TR>

<TR VALIGN="top">
<TD width=37%>Create an instance of <code class="ce">ErrorHandlerImpl</code> and set it to receive events from the reader</TD>
<TD width=63%><code class="ce">Dim errorHandler As New ErrorHandlerImpl</code><BR>
<code class="ce">Set reader.errorHandler = errorHandler</code></TD>
</TR>

<TR VALIGN="top">
<TD width=37%>Start the parse process</TD>
<TD width=63%><code class="ce">reader.parseURL (Text1.text)</code></TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H2 class="dtH2">Complete Code for the Main Form</H2>

<P>The following is the complete code for the main form of the JumpStart application.</P>

<PRE class="code">Option Explicit

Private Sub Command1_Click()

    Dim reader As New SAXXMLReader    'Reads the XML document
    Dim contentHandler As New ContentHandlerImpl 'Receives parsing events
    Dim errorHandler As New ErrorHandlerImpl        'Receive error events
    Text2.text = ""
    Set reader.contentHandler = contentHandler    'They work together
    Set reader.errorHandler = errorHandler        'They also work together
    On Error GoTo 10
    reader.parseURL (Text1.text)               'Parse the document

    Exit Sub                                   'That's all, folks!

10: Text2.text = Text2.text &amp; "*** Error *** " &amp; Err.Number _
                 &amp; " : " &amp; Err.Description
End Sub

Private Sub Command2_Click()
    End
End Sub</PRE>

<P>The <code class="ce">Exit Sub</code> and line marked <code class="ce">10:</code> are required only if you want to handle processing outside the <code class="ce">ErrorHandler</code>. Otherwise, you can use <code class="ce">On Error Resume Next</code>.</P>

<P class="labelproc"><B>To run the JumpStart application</B>

<OL type="1">
	<LI>Download the JumpStart application, available from the <IMG SRC="leave-ms.gif" ALT="Other Resources" BORDER=0><A HREF="http://go.microsoft.com/fwlink/?LinkId=4845">MSDN Code Center</A>, to your computer.</li>

	<LI>On your computer, double-click <B>VBSAXExample.exe</B>.</li>

	<LI>In the <B>File name</B> box, type "Test.xml" and then click <B>Parse</B>. The JumpStart application parses the file and displays the results in the <B>Text2</B> text box.</li>
</OL>

<P>You can use this introduction to the Simple API for XML (SAX2) as a starting point for writing your own applications. For more information about the Microsoft&reg; XML Core Services (MSXML) 5.0 for Microsoft Office implementation of the SAX2 interfaces, see the <A HREF="sax2_reference_4y3p.htm">SAX2 Reference</A>.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
