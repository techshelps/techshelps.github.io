<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>XML Schema Regular Expressions</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XML Schemas</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xsdrefxmlschemaregularexpressions"></A>XML Schema Regular Expressions</H1>

<P>XML Schema regular expressions are used with the <B>pattern</B> facet to provide constraints or restrictions on a string of characters that conform to the defined pattern.</P>

<P>The <B>pattern</B> facet is a constraint on the value space of a data type, achieved by constraining the lexical space to literals that match a specific pattern. The value of <B>pattern</B> must be a regular expression.</P>

<P><B>Pattern</B> provides for constraining a value space to values that are denoted by literals that match a specific regular expression.</P>

<H4 class="dtH4">Example</H4>

<P>The following example defines a user-derived data type that creates a representation of postal codes in the United States, limited to strings that match a specific regular expression.</P>

<P class="label"><B>Input file: T.xml</B></P>

<PRE class="code">&lt;zips xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="t.xsd"&gt;
  &lt;zip&gt;12345&lt;/zip&gt;
  &lt;zip&gt;12345-1234&lt;/zip&gt;
&lt;/zips&gt;</PRE>

<P class="label"><B>XML Schema: T.xsd</B></P>

<PRE class="code">&lt;?xml version="1.0"?&gt;
&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" &gt;
    &lt;xs:element name="zips"&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence maxOccurs="unbounded"&gt;
      &lt;xs:element name="zip" type="better-us-zipcode"&gt;&lt;/xs:element&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
    &lt;xs:simpleType name="better-us-zipcode"&gt;
        &lt;xs:restriction base="xs:string"&gt;
            &lt;xs:pattern value="[0-9]{5}(-[0-9]{4})?"/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
&lt;/xs:schema&gt;</PRE>

<P>There are two types of characters that are used in regular expressions: metacharacters and normal characters. A metacharacter is one of the following characters: <B>.</B>, <B>\</B>, <B>?</B>, <B>*</B>, <B>+</B>, <B>{</B>, <B>}</B>, <B>(</B>, <B>)</B>, <B>[</B>, or <B>]</B>. These characters have special meaning in regular expressions, but can be escaped to from atoms that denote the sets of strings containing only themselves. An escaped metacharacter has the behavior of a normal character.</P>

<P>A normal character is any XML character that is not a metacharacter. In regular expressions, a normal character is an atom that denotes the singleton set of strings containing only itself.</P>

<P>The following topics describe the XML Schema regular expressions.

<UL type="disc">
	<LI><A HREF="xsd_ref_1kq5.htm">Atom</A></li>

	<LI><A HREF="xsd_ref_1eia.htm">Normal Character</A></li>

	<LI><A HREF="xsd_ref_2279.htm">Piece</A></li>

	<LI><A HREF="xsd_ref_1hrm.htm">Quantifier</A></li>

	<LI><A HREF="xsd_ref_0k2w.htm">Branch</A></li>

	<LI><A HREF="xsd_ref_2ylq.htm">Regular Expression</A></li>

	<LI><A HREF="xsd_ref_1rg3.htm">Character Classes</A></li>

	<LI><A HREF="xsd_ref_0q7n.htm">Character Class Escapes</A></li>
</UL>

<P>To understand the relationships in XML Schema Regular Expressions, see the <A HREF="xsd_ref_0q7n.htm">XML Schema Regular Expressions Reference Chart</A>.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xsd_ref_7gh1.htm">XML Schema Reference (XSD)</A> | <A HREF="xsd_ref_5nck.htm">XML Schema Regular Expressions Reference Chart</A> | <A HREF="xsd_ref_1kq5.htm">Atom</A> | <A HREF="xsd_ref_9rar.htm">Data Type Facets</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
