<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating New Nodes</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconcreatingnewnodes"></A>Creating New Nodes</H1>

<P>The <code class="ce">DOMDocument</code> object exposes the <code class="ce">createNode</code> method, which allows you to create a qualified node by supplying the node type, name, and <code class="ce">namespaceURI</code> of the new node.</P>

<P><code class="ce">DOMDocument</code> also exposes the following eight methods, which allow you to create specific Document Object Model (DOM) nodes.

<UL type="disc">
	<LI><A HREF="xml_mth_ac_4ehx.htm">createAttribute method</A></li>

	<LI><A HREF="xml_mth_ac_786m.htm">createCDATASection method</A></li>

	<LI><A HREF="xml_mth_ac_4jjo.htm">createComment method</A></li>

	<LI><A HREF="xml_mth_ac_762c.htm">createDocumentFragment method</A></li>

	<LI><A HREF="xml_mth_ac_9i7o.htm">createElement method</A></li>

	<LI><A HREF="xml_mth_ac_5nhh.htm">createEntityReference method</A></li>

	<LI><A HREF="xml_mth_ac_3cq6.htm">createProcessingInstruction method</A></li>

	<LI><A HREF="xml_mth_ac_7339.htm">createTextNode method</A></li>
</UL>

<P>These methods return objects and interfaces and are described in the XML Reference. These specific objects and interfaces expose properties and methods associated with that node. For example, the following sample code assigns an <code class="ce">XMLDOMElement</code> object with the name of <code class="ce">"item"</code> to the variable <code class="ce">xmlElem</code>.</P>

<PRE class="code">xmlElem = xmlDoc.createElement("item")</PRE>

<P>You can then add an attribute to that element by calling the <code class="ce">setAttribute</code> method and passing that method a string containing the attribute name and a string containing the attribute value.</P>

<PRE class="code">xmlElem.setAttribute("id","bar")</PRE>

<P>Using <B>books.xml</B> again as an example, the following code creates a new element, <code class="ce">PAGES</code>, and uses the <code class="ce">appendChild</code> method to add it to the second child node of the root, <code class="ce">COLLECTION</code>. It then sets the <code class="ce">text</code> property for the new element to <code class="ce">"400"</code>.</P>

<PRE class="code">Dim xmlDoc
Dim root
Dim newElem
Set xmlDoc = CreateObject("Msxml2.DOMDocument.5.0")
xmlDoc.async = False
xmlDoc.load("c:\books.xml")
If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
&nbsp;&nbsp;&nbsp;Dim myErr
&nbsp;&nbsp;&nbsp;Set myErr = xmlDoc.parseError
&nbsp;&nbsp;&nbsp;MsgBox("You have error " &amp; myErr.reason)
Else
&nbsp;&nbsp;&nbsp;Set root = xmlDoc.documentElement
&nbsp;&nbsp;&nbsp;Set newElem = xmlDoc.createElement("PAGES")
&nbsp;&nbsp;&nbsp;root.childNodes.item(1).appendChild newElem
&nbsp;&nbsp;&nbsp;root.childNodes.item(1).lastChild.text = "400"
&nbsp;&nbsp;&nbsp;MsgBox root.childNodes.item(1).xml
End If</PRE>

<P>You can assign a new document to a document object by assigning the document a new root element using the <code class="ce">documentElement</code> property.</P>

<PRE class="code">XMLDoc.documentElement = XMLNode</PRE>

<P>In order for this operation to work, <code class="ce">XMLNode</code> must be an element type node.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;Assigning the document object a new document element does not change the other children of the document. For example, the <code class="ce">doctype</code> element does not change.</BLOCKQUOTE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="dom_howdoi_0lyd.htm">Accessing the Document Tree</A> | <A HREF="xml_mth_ac_7yhw.htm">appendChild Method</A> | <A HREF="xml_mth_ac_5d5x.htm">createNode Method</A> | <A HREF="xml_pro_ae_6xro.htm">documentElement Property</A> | <A HREF="xml_mth_sz_3krp.htm">setAttribute Method</A> | <A HREF="xml_ref_overview_9yg5.htm">XML Reference</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
