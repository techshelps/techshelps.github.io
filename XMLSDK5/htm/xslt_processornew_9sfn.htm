<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Processing Multiple Matching Template Rules</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="_processing_multiple_matching_template_rules"></A>Processing Multiple Matching Template Rules</H1>

<P>If more than one template rule matches a given node in the source tree, MSXML gives the highest priority to the template rule that matches the most specific pattern. Specifically, the conflict is resolved as follows:</P>

<P>First, MSXML selects the pattern with the highest import precedence. An XSLT file can import other XSLT files, and the order in which the corresponding <code class="ce">&lt;xsl:import&gt;</code> elements appear in the original file determines the import precedence. If there is still more than one match after this step, proceed to the next step.</P>

<P>The second step is to assign a numeric priority to each conflicting pattern, as shown in the following table. Select the pattern with the highest priority. If there is still more than one match after this step, proceed to the next step.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Assign a priority of...</TH>
<TH width=50%>If the match pattern...</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>0 (zero)</TD>
<TD width=50%>Is an element or attribute name.
<P>&#0151;Or&#0151;</P>

<P>Is a processing instruction with a specific target.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>-0.25</TD>
<TD width=50%>Includes the wildcard character (*).</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>-0.5</TD>
<TD width=50%>Consists of only a <A HREF="xpath_syntax2_42gj.htm">node test</A>, such as <code class="ce">text()</code>, for selecting nodes.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>0.5</TD>
<TD width=50%>Does not match any of the other criteria.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<BLOCKQUOTE class="dtBlock">
<B>Note&nbsp;&nbsp;&nbsp;</B>If the pattern contains a pipe symbol (|) that specifies alternate XPath expressions, treat each expression as if it were a separate match pattern.</BLOCKQUOTE>

<P>Finally, if everything else is equal, the last matching pattern is used as default.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xslt_processornew_78dv.htm">Processing Template Rules</A> | <A HREF="xslt_processornew_6303.htm">Understanding the Built-in Template Rules</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
