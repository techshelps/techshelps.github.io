<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Using XSLT Keys to Group Data</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconusingxsltkeystogroupdata"></A>Using XSLT Keys to Group Data</H1>

<P>One of the most common uses of keys is for grouping data in a document. We've already discussed the <code class="ce">&lt;xsl:sort&gt;</code> element in <A HREF="xsl_advanced1_5it0.htm">Sorting with XSLT</A>. However, with sorting alone, you must repeat each of the items establishing a category. What if you want to display the category only once, followed by a list of all items that fall under it?</P>

<P>The public library participating in Scootney's promotional exhibit wants to produce a single Web page that groups the titles in the exhibit in two ways. One grouping will show the titles grouped by category. The other grouping will show them grouped by author.</P>

<P>The style sheet developed by the library, <B>lib_cat2.xsl</B>, defines the following two keys that correspond to these two groupings.

<UL type="disc">
	<LI><code class="ce">&lt;xsl:key name="categ_key" match="book" use="genre"/&gt;</code></li>

	<LI><code class="ce">&lt;xsl:key name="author_key" match="book" use="author"/&gt;</code></li>
</UL>

<P>There are also two template rules for the root <code class="ce">&lt;catalog&gt;</code> element. These template rules use modes to enable the element to be processed twice&#0151;once for each grouping. These template rules are invoked by <code class="ce">&lt;xsl:apply-templates&gt;</code> elements within the template rule for the document root:</P>

<PRE class="code">&lt;xsl:template match="/"&gt;
...
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;xsl:apply-templates select="catalog" <code><b class="cfe">mode="grp_categ"</b></code>/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;xsl:apply-templates select="catalog" <code><b class="cfe">mode="grp_author"</b></code>/&gt;
...
&lt;/xsl:template&gt;</PRE>

<P>The two template rules for the <code class="ce">&lt;catalog&gt;</code> element take two slightly different approaches to the problem of grouping, although both use keys to do so. The following topics describe these two approaches.

<UL type="disc">
	<LI><A HREF="xsl_advanced2_9cms.htm">Grouping Data by Examining the Keyed Node-set</A></li>

	<LI><A HREF="xsl_advanced2_6h7o.htm">Grouping Data by Using generate-id()</A></li>
</UL>

<H4 class="dtH4">Files Used for This Topic</H4>

<UL type="disc">
	<LI><A HREF="xsl_advanced2_8reb.htm">Sample XML Data File for XSLT Keys</A> (booksvariant.xml)</li>

	<LI><A HREF="xsl_advanced2_23eb.htm">Sample XSLT File for XSLT Keys</A> (lib_cat.xsl)</li>
</UL>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
