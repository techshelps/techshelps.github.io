<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Implementing the ErrorHandler</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - SAX2 Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="sax2vb_errorhandler_creating"></A>Implementing the ErrorHandler</H1>

<P>For the JumpStart application, you create the <code class="ce">ErrorHandler</code> by implementing the <code class="ce">IVBSAXErrorHandler</code> interface.</P>

<P class="labelproc"><B>To create the ErrorHandlerImpl class</B>

<OL type="1">
	<LI>On the <B>Project</B> menu, click <B>Add Class Module</B>.</li>

	<LI>In the <B>Add Class Module</B> dialog box, double-click <B>Class Module</B>.</li>

	<LI>On the <B>View</B> menu, select <B>Properties Window</B>.</li>

	<LI>In the Properties Window, enter "ErrorHandlerImpl" for the <B>Name</B> property.</li>
</OL>

<P class="labelproc"><B>To implement the ErrorHandlerImpl class</B>

<OL type="1">
	<LI>In the Class Window, type "Implements", press the spacebar, and then double-click <B>IVBSAXErrorHandler</B> from the drop-down list that appears.</li>

	<LI>In the <B>Object</B> drop-down list on the left side of the Class Window, select <B>IVBSAXErrorHandler</B>.</li>

	<LI>In the <B>Procedure</B> drop-down list on the right side of the Class Window, select a method or property to add to the class.</li>

	<LI>Add the desired code to the selected method or property.</li>

	<LI>Repeat steps 3 and 4 until you have added the desired methods and properties.
<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;If you have trouble implementing methods and procedures for the <code class="ce">ErrorHandlerImpl</code> class, refer back to <A HREF="sax_starter_15bn.htm">Implementing the ContentHandler</A> to see how methods and properties were implemented for the <code class="ce">ContentHandlerImpl</code> class.</BLOCKQUOTE>
</li>
</OL>

<H2 class="dtH2">Complete Code for the ErrorHandlerImpl Class</H2>

<P>The following is the complete code for the <code class="ce">ErrorHandlerImpl</code> class of the JumpStart application.</P>

<PRE class="code">Option Explicit

Implements IVBSAXErrorHandler


Private Sub IVBSAXErrorHandler_fatalError(ByVal lctr As IVBSAXLocator, _
                                          msg As String, _
                                          ByVal errCode As Long)
    Form1.Text2.text = Form1.Text2.text &amp; "*** error *** " &amp; msg
    
End Sub

Private Sub IVBSAXErrorHandler_error(ByVal lctr As IVBSAXLocator, _
                                     msg As String, ByVal errCode As Long)
End Sub

Private Sub IVBSAXErrorHandler_ignorableWarning( _
                                 ByVal oLocator As MSXML2.IVBSAXLocator, _
                                 strErrorMessage As String, _
                                 ByVal nErrorCode As Long)
End Sub</PRE>

<P>In the preceding code, only the <code class="ce">fatalError</code> method contains code for handling events. For this version of Microsoft&reg; XML Core Services (MSXML) 5.0 for Microsoft Office, only the <code class="ce">fatalError</code> method is called for <code class="ce">IVBSAXErrorHandler</code>.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
