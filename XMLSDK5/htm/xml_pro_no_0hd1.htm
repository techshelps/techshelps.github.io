<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ontransformnode Property</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmproontransformnode"></A>ontransformnode Property</H1>

<P>Specifies the event handler for the <code class="ce">ontransformnode</code> event.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Important</b>&nbsp;&nbsp;&nbsp;Sample code used for demonstration purposes in this topic assumes a side-by-side installation of another previous version of MSXML. The use of <code class="ce">"http://www.w3.org/TR/WD-xsl"</code> to declare the older deprecated XSL namespace causes this requirement.</BLOCKQUOTE>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">oXMLDOMDocument.ontransformnode = funcMyEventHandler;</PRE>

<H4 class="dtH4">Example</H4>

<P>In this example, the XML data island named "target" contains the XML source data, and the XML data island named "ss" contains the XSL (XSL) style sheet.</P>

<PRE class="code">&lt;XML id=target&gt;
    &lt;PEOPLE&gt;
        &lt;PERSON name="Atkinson, Teresa"  /&gt;
&lt;PERSON name="Debroux, Steve" /&gt;
&lt;PERSON name="O'Hara, Robert" /&gt;
&lt;PERSON name="Porzuczek, Peter" /&gt;
    &lt;/PEOPLE&gt;
&lt;/XML&gt;
&lt;XML id=ss&gt;
  &lt;xsl:template match="/" xmlns:xsl="http://www.w3.org/TR/WD-xsl"&gt;
   &lt;xsl:for-each select="/PEOPLE/PERSON/@name" &gt;   
&lt;P&gt;&lt;xsl:value-of /&gt;&lt;/P&gt;
   &lt;/xsl:for-each&gt;
  &lt;/xsl:template&gt;
&lt;/XML&gt;</PRE>

<P>This script contains the <code class="ce">Verify</code> function, which sets the <code class="ce">ontransformnode</code> property to the event handler, onxform. The event handler is called before the transformation operation on each node, so given the sample data provided in the data islands, this sample calls the alert several times.</P>

<PRE class="code">&lt;SCRIPT LANGUAGE="javascript" FOR="window" EVENT="onload"&gt;
document.expando = false;
Verify();
&lt;/SCRIPT&gt;
&lt;Script LANGUAGE="javascript"&gt;
function onxform ( code, doc ) {
    alert("Target document node being transformed:\n\n" + doc.xml +
       "\n\nStylesheet node used for the transform:\n\n" + code.xml);
   if (doc.value == "O'Hara, Robert") 
return false;  // stop processing
   else
return true;
}
function Verify() {
   target.ontransformnode = onxform;
   var sOut = target.XMLDocument.transformNode(ss.XMLDocument);
   div.innerHTML += sOut;
}
&lt;/Script&gt;
&lt;DIV id=div&gt;&lt;/DIV&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</PRE>

<P>The return value from the event handler indicates whether to continue processing. In this example, the event handler checks for a particular data value and returns the value "false" to stop transformation processing.</P>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">oXMLDOMDocument.ontransformnode = funcMyEventHandler</PRE>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT put_ontransformnode(
    VARIANT ontransformnodeSink);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>ontransformnodeSink</I> [in]</DT>

<DD>Name of the function that should be called when a transformation is about to be performed.</dd>
</DL>
</div><!-- [C/C++] -->

<H4 class="dtH4">Remarks</H4>

<P>The property is write-only. A transformation involves two trees: the XML source and the style sheet that is applied to it. The <code class="ce">ontransformnode</code> event fires before each node in the style sheet is applied to each node in the XML source.</P>

<P>The <code class="ce">ontransformnode</code> property provides a way for developers to specify an event handler to override the default handler.</P>

<P>This member is an extension of the World Wide Web Consortium (W3C) Document Object Model (DOM).</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_evt_8u44.htm">ontransformnode Event</A></P>

<P>Applies to: <A HREF="xml_obj_ixmldomdocument_7gqc.htm">DOMDocument</A> | <A HREF="xml_mth_sz_095x.htm">transformNode Method</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
