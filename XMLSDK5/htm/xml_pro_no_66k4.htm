<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>output Property</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmprooutput"></A>output Property</H1>

<P>Gets a custom output to write the result of the transformation.</P>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">output = objXSLProcessor.output;
objXSLProcessor.output (output);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>output</I></DT>

<DD>The object to which to write the output of the transformation.</dd>
</DL>

<H4 class="dtH4">Example</H4>

<PRE class="code">var xslt = new ActiveXObject5.0("Msxml2.XSLTemplate.5.0");
var xslDoc = new ActiveXObject5.0("Msxml2.FreeThreadedDOMDocument.5.0");
var xslProc;
xslDoc.async = false;
xslDoc.load("sample2.xsl");
if (xmlDoc.parseError.errorCode &lt;&gt; 0) {
&nbsp;&nbsp;&nbsp;var myErr = xmlDoc.parseError;
&nbsp;&nbsp;&nbsp;alert("You have error " + myErr.reason);
} else {
&nbsp;&nbsp;&nbsp;xslt.stylesheet = xslDoc;
&nbsp;&nbsp;&nbsp;var xmlDoc = new ActiveXObject5.0("Msxml2.DOMDocument.5.0");
&nbsp;&nbsp;&nbsp;xmlDoc.async = false;
&nbsp;&nbsp;&nbsp;xmlDoc.load("books.xml");
&nbsp;&nbsp;&nbsp;if (xmlDoc.parseError.errorCode &lt;&gt; 0) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var myErr = xmlDoc.parseError;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("You have error " + myErr.reason);
&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xslProc = xslt.createProcessor();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xslProc.input = xmlDoc;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xslProc.transform();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(xslProc.output);
&nbsp;&nbsp;&nbsp;}
}</PRE>

<P class="label"><B>Sample2.xsl</B></P>

<PRE class="code">&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"&gt;
   &lt;xsl:output method="html"/&gt;
   &lt;xsl:param name="param1"/&gt;
  &lt;xsl:template match="/"&gt;
      Hello
  &lt;/xsl:template&gt;
  &lt;xsl:template match="/" mode="edit"&gt;
      In Edit Mode
  &lt;/xsl:template&gt;
  &lt;xsl:template match="/" mode="view"&gt;
      In View Mode
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</PRE>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">output = objXSLProcessor.output
objXSLProcessor.output (output)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>output</I></DT>

<DD>The object to which to write the output of the transformation.</dd>
</DL>

<H4 class="dtH4">Example</H4>

<PRE class="code">Dim xslt As New Msxml2.XSLTemplate50
Dim xslDoc As New Msxml2.FreeThreadedDOMDocument50
Dim xmlDoc As New Msxml2.DOMDocument50
Dim xslProc As IXSLProcessor
xslDoc.async = False
xslDoc.Load "sample2.xsl"
If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
&nbsp;&nbsp;&nbsp;Dim myErr
&nbsp;&nbsp;&nbsp;Set myErr = xmlDoc.parseError
&nbsp;&nbsp;&nbsp;MsgBox("You have error " &amp; myErr.reason)
Else
&nbsp;&nbsp;&nbsp;Set xslt.stylesheet = xslDoc
&nbsp;&nbsp;&nbsp;xmlDoc.async = False
&nbsp;&nbsp;&nbsp;xmlDoc.Load "books.xml"
&nbsp;&nbsp;&nbsp;If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim myErr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set myErr = xmlDoc.parseError
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox("You have error " &amp; myErr.reason)
&nbsp;&nbsp;&nbsp;Else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set xslProc = xslt.createProcessor()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xslProc.input = xmlDoc
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xslProc.Transform
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox xslProc.output
End If</PRE>

<P class="label"><B>Sample2.xsl</B></P>

<PRE class="code">&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"&gt;
   &lt;xsl:output method="html"/&gt;
   &lt;xsl:param name="param1"/&gt;
  &lt;xsl:template match="/"&gt;
      Hello
  &lt;/xsl:template&gt;
  &lt;xsl:template match="/" mode="edit"&gt;
      In Edit Mode
  &lt;/xsl:template&gt;
  &lt;xsl:template match="/" mode="view"&gt;
      In View Mode
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</PRE>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT get_output (VARIANT* pOutput);
HRESULT put_output (VARIANT output);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>pOutput</I> [out, retval]</DT>

<DD>The custom output object or a BSTR containing the transformation result.</dd>

<DT><I>output</I> [in]</DT>

<DD>The object to write the output of the transformation to.</dd>
</DL>

<H4 class="dtH4">C/C++ Return Values</H4>

<DL>
<DT>E_NOINTERFACE</DT>

<DD>Value returned if the given output object does not support a supported interface.</dd>

<DT>E_FAIL</DT>

<DD>Value returned if the <code class="ce">readyState</code> property is READYSTATE_INTERACTIVE.</dd>
</DL>
</div><!-- [C/C++] -->

<H4 class="dtH4">Remarks</H4>

<P>The output property can be any object/interface that supports <code class="ce">IStream</code>, <code class="ce">IPersistStream</code>, <code class="ce">DOMDocument</code>, <code class="ce">ASP IResponse</code>, <code class="ce">ADODB.Stream</code>, or <A HREF="sax_imxwriter_9f39.htm">IMXWriter</A>.</P>

<P>When a new <code class="ce">transform</code> is started, the processor will use a <code class="ce">QueryInterface</code> this output for <code class="ce">IStream</code>. When the transform is complete or <code class="ce">reset</code> is called, <code class="ce">IStream</code> is released. The only method that is used on <code class="ce">IStream</code> is <code class="ce">Write</code>. The bytes written to the stream will be encoded according to the encoding attribute on the <code class="ce">&lt;xsl:output&gt;</code> element.</P>

<P>If you do not provide a custom output, then you will get a string when you read this property. The string contains the incrementally buffered transformation result.</P>

<P>Reading this property has the side effect of resetting that internal buffer so that each time you read the property you get the next chunk of output. In this case, the output is always generated in the Unicode encoding, and the encoding attribute on the &lt;xsl:output&gt; element is ignored.</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P>Applies to: <A HREF="xml_obj_ixslprocessor_9j8y.htm">IXSLProcessor</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
