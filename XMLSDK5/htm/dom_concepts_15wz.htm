<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Working with Attributes</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconworkingwithxmldocumentparts_attributes"></A>Working with Attributes</H1>

<P>Although attributes belong to a particular element, they are not considered child nodes of element nodes. Instead, they behave more like properties of <code class="ce">IXMLDOMElement</code>.</P>

<P>Most of the methods for working with attributes come from <code class="ce">IXMLDOMElement</code>. Attributes can be manipulated in the following ways.

<UL type="disc">
	<LI>Directly, through the <code class="ce">getAttribute</code> and <code class="ce">setAttribute</code> methods of <code class="ce">IXMLDOMElement</code>.</li>

	<LI>As named <code class="ce">IXMLDOMAttribute</code> nodes, with <code class="ce">getAttributeNode</code> and <code class="ce">setAttributeNode</code>.</li>

	<LI>As a set of nodes accessible through the <code class="ce">attributes</code> property and returned as an <code class="ce">IXMLNamedNodeMap</code>.</li>
</UL>

<H4 class="dtH4">Examples</H4>

<P class="label"><B>JScript</B></P>

<P>The following JScript example creates a new document containing a <code class="ce">&lt;memo&gt;</code> element, and then creates an attribute named <code class="ce">author</code> with a value of <code class="ce">"Pat Coleman"</code>.</P>

<PRE class="code">var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.5.0");
var rootElement=xmlDoc.createElement("memo");
rootElement.setAttribute("author", "Pat Coleman");
xmlDoc.appendChild(rootElement);</PRE>

<P class="label"><B>VBScript</B></P>

<PRE class="code">Set xmlDoc = CreateObject("Msxml2.DOMDocument.5.0")
Set rootElement=xmlDoc.createElement("memo")
rootElement.setAttribute("author", "Pat Coleman")
xmlDoc.appendChild(rootElement)</PRE>

<P>If you prefer to work with attribute nodes, you can create the attribute, and then create a text node to store its value. Attribute nodes can only contain text nodes and entity reference nodes. (If you need to create an attribute containing an entity reference, you must use this approach.)</P>

<P>Working with attribute nodes requires using the <code class="ce">DOMDocument</code> object to create attribute and text (and entity reference, if necessary) nodes before assigning the nodes to the element.</P>

<P class="label"><B>JScript</B></P>

<P>The following JScript code uses this approach to perform the same work as the preceding examples, creating a <code class="ce">&lt;memo&gt;</code> element with an <code class="ce">author</code> attribute holding the value <code class="ce">"Pat Coleman"</code>.</P>

<PRE class="code">var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.5.0");
var rootElement=xmlDoc.createElement("memo");
var memoAttribute=xmlDoc.createAttribute("author");
var memoAttributeText=xmlDoc.createTextNode("Pat Coleman");
memoAttribute.appendChild(memoAttributeText);
rootElement.setAttributeNode(memoAttribute);
xmlDoc.appendChild(rootElement);</PRE>

<P><B>VBScript</B></P>

<PRE class="code">Set xmlDoc = CreateObject("Msxml2.DOMDocument.5.0")
Set rootElement=xmlDoc.createElement("memo")
Set memoAttribute=xmlDoc.createAttribute("author")
Set memoAttributeText=xmlDoc.createTextNode("Pat Coleman")
memoAttribute.appendChild(memoAttributeText)
rootElement.setAttributeNode(memoAttribute)
xmlDoc.appendChild(rootElement)</PRE>

<P>Developers who want to work with attributes as a set can also use the <code class="ce">IXMLDOMNamedNodeMap</code> collection returned by the <code class="ce">attribute</code> property of <code class="ce">IXMLDOMElement</code>.</P>

<P>For more information about properties and methods of <code class="ce">IXMLDOMAttribute</code>, see <A HREF="xml_obj_ixmldomattribute_34kl.htm">IXMLDOMAttribute</A>.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
