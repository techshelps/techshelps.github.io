<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IServerXMLHTTPRequest/ServerXMLHTTP</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XML Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmobjxmldomserverxmlhttp"></A>IServerXMLHTTPRequest/ServerXMLHTTP</H1>

<P>Provides methods and properties that enable you to establish an HTTP connection between files or objects on different Web servers.</P>

<P>The <code class="ce">ServerXMLHTTP</code> object offers functionality similar to that of the <code class="ce">XMLHTTP</code> object. Unlike <code class="ce">XMLHTTP</code>, however, the <code class="ce">ServerXMLHTTP</code> object does not rely on the WinInet control for HTTP access to remote XML documents. <code class="ce">ServerXMLHTTP</code> uses a new HTTP client stack. Designed for server applications, this server-safe subset of WinInet offers the following advantages:

<UL type="disc">
	<LI><B>Reliability</B> &#0151; The HTTP client stack offers longer uptimes. WinInet features that are not critical for server applications, such as URL caching, auto-discovery of proxy servers, HTTP/1.1 chunking, offline support, and support for Gopher and FTP protocols are not included in the new HTTP subset.</li>

	<LI><B>Security</B> &#0151; The HTTP client stack does not allow a user-specific state to be shared with another user's session. <code class="ce">ServerXMLHTTP</code> provides support for client certificates.
<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;For more information about the limitations of the WinInet control, see <IMG SRC="leave-ms.gif" ALT="Other Resources" BORDER=0><A HREF="http://go.microsoft.com/fwlink/?LinkId=4868">WinInet Limits Connections Per Server</A>.</BLOCKQUOTE>
</li>
</UL>

<H4 class="dtH4">Usage</H4>

<P>The <code class="ce">ServerXMLHTTP</code> object is commonly used to:

<UL type="disc">
	<LI>Receive XML documents from an Active Server Pages (ASP) page on a local or remote Web server (HTTP <code class="ce">GET</code>).</li>

	<LI>Post XML documents to an ASP page on a local or remote Web server (HTTP <code class="ce">POST</code>).</li>

	<LI>Post and process response XML documents from an ASP page (HTTP <code class="ce">POST</code>).</li>
</UL>

<P>You can use the <code class="ce">ServerXMLHTTP</code> object either indirectly using the <code class="ce">setProperty</code> method of <code class="ce">DOMDocument</code> or directly using the <code class="ce">ServerXMLHTTP</code> object itself. For examples of these two approaches, as well as examples of how to use the <code class="ce">ServerXMLHTTP</code> security options and how to use <code class="ce">ServerXMLHTTP</code> in a multitiered environment, see <A HREF="xml_obj_iserverxmlhttprequest_00j7.htm">IServerXMLHTTPRequest/ServerXMLHTTP Examples</A>.</P>

<H4 class="dtH4">Remarks</H4>

<P>The <code class="ce">ServerXMLHTTP</code> <A HREF="xml_mth_or_7nxs.htm">open</A><B> </B>method makes the connection between servers and the <A HREF="xml_mth_sz_8prk.htm">send</A><B> </B>method sends the request.</P>

<P>You can read the response using one of the four following properties: <A HREF="xml_pro_pr_6ovk.htm">responseBody</A>, <A HREF="xml_pro_pr_0168.htm">responseStream</A>, <A HREF="xml_pro_pr_8gog.htm">responseText</A>, and <A HREF="xml_pro_pr_4a28.htm">responseXML</A>.</P>
<div class=filtered><span class="lang">[C/C++]</span>

<P>With <code class="ce">ServerXMLHTTP</code>, the usual sequence is to call the <code class="ce">open</code> method, set any custom header information through the <code class="ce">setRequestHeader</code> method, call the <code class="ce">send</code> method, and then check one of the four response properties.</P>
</div><!-- [C/C++] -->

<P>For example, an ASP, Microsoft&reg; Visual Basic&reg;, or C++ component on a server computer can send an HTTP request to another server and then receive the response as a stream or XML document object. The response can then be fed to downstream clients, saved to a file on the server, or combined with other XML data (potentially collected from other Web servers).</P>

<P><code class="ce">ServerXMLHTTP</code> offers additional benefits for transporting XML data:

<UL type="disc">
	<LI><code class="ce">ServerXMLHTTP</code> maintains state, so transactional XML data can be used in business applications that require real-time responses.</li>

	<LI><code class="ce">ServerXMLHTTP</code> allows you to serve the response object as a stream or Document Object Model (DOM) object. As a stream, this offers considerable performance benefits when moving data through the HTTP protocol.</li>
</UL>

<P><code class="ce">ServerXMLHTTP</code> offers backward compatibility with <code class="ce">XMLHTTP</code>. Source code (JScript, Visual Basic Scripting Edition, Visual Basic, or C++) that uses the XMLHTTP component can be easily modified to use the new <code class="ce">ServerXMLHTTP</code> component.</P>

<P>The number of instances of <code class="ce">ServerXMLHTTP</code> that can exist simultaneously within a single process primarily depends upon the amount of memory available for applications on the system. However, other factors, such as CPU processing capacity, or available socket connections can further limit the number of instances that can be active simultaneously.</P>

<P>The <code class="ce">IServerXMLHTTPRequest</code> interface inherits from <code class="ce">IXMLHTTPRequest</code> and extends it with the following four new methods: <A HREF="xml_mth_dg_4gmm.htm">getOption</A>, <A HREF="xml_mth_sz_7qjy.htm">setOption</A>, <A HREF="xml_mth_sz_9fs5.htm">waitForResponse</A>, and <A HREF="xml_mth_sz_0cj7.htm">setTimeouts</A>.</P>

<H4 class="dtH4">Versioning</H4>

<P>MSXML  3.0 and later</P>

<H4 class="dtH4">Requirements</H4>

<P>Supported platforms include Microsoft Windows&reg; 2000, or Microsoft Windows NT&reg; 4.0 with Microsoft Internet Explorer 5.01 (or later) installed. <code class="ce">ServerXMLHTTP</code> fails on other platforms, such as Microsoft Windows 98.</P>

<P><B>Implementation:</B> msxml5.dll, msxml2.lib</P>
<div class=filtered><span class="lang">[C/C++]</span>

<P><B>Header and IDL files:</B> msxml2.h, msxml2.idl</P>
</div><!-- [C/C++] -->

<P><B>Version-Dependent ProgID:</B> Msxml2.ServerXMLHTTP.5.0</P>

<P><B>Version-Dependent CLSID:</B> 88D969C6-F192-11D4-A65F-0040963251E5</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_obj_ixmlhttprequest_8bp0.htm">IXMLHTTPRequest</A> | <A HREF="xml_obj_iserverxmlhttprequest_54ds.htm">IServerXMLHTTPRequest/ServerXMLHTTP Members</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
