<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>setTimeouts Method</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmthsettimeouts"></A>setTimeouts Method</H1>

<P>Specifies timeout settings for resolving the domain name, establishing the connection to the server, sending the data, and receiving the response. The timeout parameters of the <code class="ce">setTimeouts</code> method are specified in milliseconds, so a value of 1000 would represent 1 second. A value of zero represents an infinite timeout. There are four separate timeout parameters: <code class="ce">resolveTimeout</code><I>, </I><code class="ce">connectTimeout</code><I>, </I><code class="ce">sendTimeout</code>, and<I> </I><code class="ce">receiveTimeout</code><I>. </I>When calling the <code class="ce">setTimeouts</code> method, all four values must be specified. The timeouts are applied at the Winsock layer.</P>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">oServerXMLHTTPRequest.setTimeouts(resolveTimeout, connectTimeout, 
 sendTimeout, receiveTimeout);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>resolveTimeout</I></DT>

<DD>A long integer. The value is applied to mapping host names (such as "www.microsoft.com") to IP addresses; the default value is infinite, meaning no timeout.</dd>

<DT><I>connectTimeout</I></DT>

<DD>A long integer. The value is applied to establishing a communication socket with the target server, with a default timeout value of 60 seconds.</dd>

<DT><I>sendTimeout</I></DT>

<DD>A long integer. The value applies to sending an individual packet of request data (if any) on the communication socket to the target server. A large request sent to a server will normally be broken up into multiple packets; the send timeout applies to sending each packet individually. The default value is 5 minutes.</dd>

<DT><I>receiveTimeout</I></DT>

<DD>A long integer. The value applies to receiving a packet of response data from the target server. Large responses will be broken up into multiple packets; the receive timeout applies to fetching each packet of data off the socket. The default value is 60 minutes.</dd>
</DL>

<H4 class="dtH4">Example</H4>

<PRE class="code">var xmlServerHttp = new ActiveXObject("Msxml2.ServerXMLHTTP.5.0");
var lResolve = 5 * 1000;
var lConnect = 5 * 1000;
var lSend = 15 * 1000;
var lReceive = 15 * 1000;
xmlServerHttp.setTimeouts(lResolve, lConnect, lSend, lReceive);
xmlServerHttp.open("GET", "http://localhost/sample.xml", false);
xmlServerHttp.send();</PRE>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">oServerXMLHTTPRequest.setTimeouts(resolveTimeout, connectTimeout, 
sendTimeout, receiveTimeout)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>resolveTimeout</I></DT>

<DD>A long integer. The value is applied to mapping host names (such as "www.microsoft.com") to IP addresses; the default value is infinite, meaning no timeout.</dd>

<DT><I>connectTimeout</I></DT>

<DD>A long integer. The value is applied to establishing a communication socket with the target server, with a default timeout value of 60 seconds.</dd>

<DT><I>sendTimeout</I></DT>

<DD>A long integer. The value applies to sending an individual packet of request data (if any) on the communication socket to the target server. A large request sent to a server will normally be broken up into multiple packets; the send timeout applies to sending each packet individually. The default value is 5 minutes.</dd>

<DT><I>receiveTimeout</I></DT>

<DD>A long integer. The value applies to receiving a packet of response data from the target server. Large responses will be broken up into multiple packets; the receive timeout applies to fetching each packet of data off the socket. The default value is 60 minutes.</dd>
</DL>

<H4 class="dtH4">Example</H4>

<PRE class="code">Dim xmlServerHttp As New Msxml2.ServerXMLHTTP50
Dim lResolve, lConnect, lSend, lReceive As Long
lResolve = 5 * 1000
lConnect = 5 * 1000
lSend = 15 * 1000
lReceive = 15 * 1000
xmlServerHttp.setTimeouts lResolve, lConnect, lSend, lReceive
xmlServerHttp.open "GET", "http://localhost/sample.xml", False
xmlServerHttp.send</PRE>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT setTimeouts (long resolveTimeout, long connectTimeout,
 long sendTimeout, long receiveTimeout)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>resolveTimeout </I>[in]</DT>

<DD>A long integer. The value is applied to mapping host names (such as "www.microsoft.com") to IP addresses; the default value is infinite, meaning no timeout.</dd>

<DT><I>connectTimeout </I>[in]</DT>

<DD>A long integer. The value is applied to establishing a communication socket with the target server, with a default timeout value of 60 seconds.</dd>

<DT><I>sendTimeout </I>[in]</DT>

<DD>A long integer. The value applies to sending an individual packet of request data (if any) on the communication socket to the target server. A large request sent to a server will normally be broken up into multiple packets; the send timeout applies to sending each packet individually. The default value is 5 minutes.</dd>

<DT><I>receiveTimeout </I>[in]</DT>

<DD>A long integer. The value applies to receiving a packet of response data from the target server. Large responses will be broken up into multiple packets; the receive timeout applies to fetching each packet of data off the socket. The default value is 60 minutes.</dd>
</DL>

<H4 class="dtH4">C/C++ Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>Value returned if successful.</dd>
</DL>
</div><!-- [C/C++] -->

<H4 class="dtH4">Remarks</H4>

<P>The <code class="ce">setTimeouts</code> method should be called before the <code class="ce">open</code> method. None of the parameters is optional.</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_mth_or_7nxs.htm">open Method</A></P>

<P>Applies to: <A HREF="xml_obj_iserverxmlhttprequest_7zlc.htm">IServerXMLHTTPRequest/ServerXMLHTTP</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
