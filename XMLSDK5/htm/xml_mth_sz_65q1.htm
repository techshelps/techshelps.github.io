<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>setProxy Method (ServerXMLHTTP/IServerXMLHTTPRequest)</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmthsetproxy"></A>setProxy Method (ServerXMLHTTP/IServerXMLHTTPRequest)</H1>

<P>Specify proxy configuration.</P>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">oSrvXMLHTTPRequest.setProxy(proxySetting, varProxyServer, varBypassList);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>proxySetting</I></DT>

<DD>The proxy configuration whose value is to be set. For a list of available settings and a description of how to use those settings, see <B>Remarks</B>.</dd>

<DT><I>varProxyServer</I></DT>

<DD>The name of a proxy server or a list of proxy server names.</dd>

<DT><I>varBypassList</I></DT>

<DD>The list of locally known host names or IP addresses for which you want to permit bypass of the proxy server.</dd>
</DL>

<H4 class="dtH4">Example</H4>

<P>No examples available at this time.</P>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">oSrvXMLHTTPRequest.setProxy(proxySetting, varProxyServer, varBypassList)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>proxySetting</I></DT>

<DD>The proxy configuration whose value is to be set. For a list of available settings and a description of how to use those settings, see <B>Remarks</B>.</dd>

<DT><I>varProxyServer</I></DT>

<DD>The name of a proxy server or a list of proxy server names.</dd>

<DT><I>varBypassList</I></DT>

<DD>The list of locally known host names or IP addresses for which you want to permit bypass of the proxy server.</dd>
</DL>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT setProxy(
    SXH_PROXY_SETTING proxySetting,
    VARIANT varProxyServer,
    VARIANT varBypassList);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>proxySetting</I> [in]</DT>

<DD>The proxy configuration whose value is to be set. For a list of available settings and a description of how to use those settings, see <B>Remarks</B>.</dd>

<DT><I>varProxyServer</I> [in, optional]</DT>

<DD>The name of a proxy server or a list of proxy server names.</dd>

<DT><I>varBypassList</I> [in, optional]</DT>

<DD>The list of locally known host names or IP addresses for which you want to permit bypass of the proxy server.</dd>
</DL>

<H4 class="dtH4">C/C++ Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>Value returned if successful.</dd>

<DT>E_FAIL</DT>

<DD>Value returned if name or value is invalid.</dd>
</DL>
</div><!-- [C/C++] -->

<H4 class="dtH4">Remarks</H4>

<P>The following table lists the settings available for use with the <code class="ce">setProxy</code> method.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=20%>Setting</TH>
<TH width=80%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=20%><code class="ce">0</code></TD>
<TD width=80%><code class="ce">SXH_PROXY_SET_PRECONFIG </code>
<P>- <I>or</I> -</P>

<P><code class="ce">SXH_PROXY_SET_DEFAULT</code></P>

<P>The <code class="ce">SXH_PROXY_SET_PRECONFIG</code> option can be used to specify that a previously established static proxy configuration should be used. When this option is used, the configuration is taken from the Windows registry. This is the case if you used the WinHTTP proxy configuration utility, proxycfg.exe, to set proxy settings at the client computer.</P>

<P>Currently, the <code class="ce">SXH_PROXY_SET_DEFAULT</code> shares the same settings level as <code class="ce">SXH_PROXY_SET_PRECONFIG</code>. It is intended, however, to support auto-proxy configuration features that might be included with future released products.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=20%><code class="ce">1</code></TD>
<TD width=80%><code class="ce">SXH_PROXY_SET_DIRECT</code>
<P>The <code class="ce">SXH_PROXY_SET_DIRECT</code> option can be used to specify that all HTTP and HTTPS servers should be accessed directly.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=20%><code class="ce">2</code></TD>
<TD width=80%><code class="ce">SXH_PROXY_SET_PROXY</code>
<P>The <code class="ce">SXH_PROXY_SET_PROXY</code> option can be used to specify one or more proxy servers, and an optional bypass list. If a proxy is not specified for a given protocol, and the server is not in the bypass list, the server cannot be accessed.</P>
</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_mth_sz_5ypf.htm">setProxyCredentials Method</A></P>

<P>Applies to: <A HREF="xml_obj_iserverxmlhttprequest_54ds.htm">IServerXMLHTTPRequest /ServerXMLHTTP Members</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
