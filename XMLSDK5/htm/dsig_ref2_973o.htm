<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Output</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - Digital Signatures</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="dsigexamples_sign_output"></A>Output</H1>

<P>When you build and run the <B>sign</B> code, you should get output similar to the following. The differences are due to the cryptographic key used. Compare the output from the two cases where the <code class="ce">fwWriteKeyInfo</code> parameter is set to CERTIFICATES versus set to CERTIFICATES|PURGE.</P>

<PRE class="code">Sign with fwWriteKeyInfo = NOKEYINFO:
The specified data was signed successfully.
Resultant signature:
&lt;?xml version="1.0"?&gt;
&lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;ds:SignedInfo&gt;
    &lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n
-20010315"/&gt;
    &lt;ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;

    &lt;ds:Reference URI="#obj" Type="http://www.w3.org/2000/09/xmldsig#;Object"&gt;
      &lt;ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
      &lt;ds:DigestValue&gt;8UIaiFvvufk+ybGUHcMk5+2Nmh4=&lt;/ds:DigestValue&gt;
    &lt;/ds:Reference&gt;
  &lt;/ds:SignedInfo&gt;
  &lt;ds:SignatureValue&gt;
    dvMOHXb+YMNV1xBloLAHJXYm4QoXN5ykEUfYRV9ZXySf9bhdDBrq9JtxOGpm0SzjUV66NWJF
    XW5TgnVvv6L3nA==
  &lt;/ds:SignatureValue&gt;
  &lt;ds:Object Id="obj" MimeType="text/plain"&gt;Hello, World!&lt;/ds:Object&gt;
   &lt;ds:KeyInfo&gt;&lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;

Sign with fwWriteKeyInfo = KEYVALUE:
The specified data was signed successfully.
Resultant signature:
&lt;?xml version="1.0"?&gt;
&lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;ds:SignedInfo&gt;
    &lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n
-20010315"/&gt;
    &lt;ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;

    &lt;ds:Reference URI="#obj" Type="http://www.w3.org/2000/09/xmldsig#;Object"&gt;
      &lt;ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
      &lt;ds:DigestValue&gt;8UIaiFvvufk+ybGUHcMk5+2Nmh4=&lt;/ds:DigestValue&gt;
    &lt;/ds:Reference&gt;
  &lt;/ds:SignedInfo&gt;
  &lt;ds:SignatureValue&gt;
    dvMOHXb+YMNV1xBloLAHJXYm4QoXN5ykEUfYRV9ZXySf9bhdDBrq9JtxOGpm0SzjUV66NWJF
    XW5TgnVvv6L3nA==
  &lt;/ds:SignatureValue&gt;
  &lt;ds:Object Id="obj" MimeType="text/plain"&gt;Hello, World!&lt;/ds:Object&gt;
   &lt;ds:KeyInfo&gt;
  &lt;KeyValue xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
    &lt;RSAKeyValue&gt;
      &lt;Modulus&gt;
        4yn1pJsP1PC8Ii3961dqcHm8OGYRxMgGREwq5WyMEvnnQAinRoN6LFk0jKrBMNQqpt/KgeaI

        gkVKs4kfSwJDAw==
      &lt;/Modulus&gt;
      &lt;Exponent&gt;AQAB&lt;/Exponent&gt;
    &lt;/RSAKeyValue&gt;
  &lt;/KeyValue&gt;
&lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;

Sign with fwWriteKeyInfo = CERTIFICATES:
The specified data was signed successfully.
Resultant signature:
&lt;?xml version="1.0"?&gt;
&lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;ds:SignedInfo&gt;
    &lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n
-20010315"/&gt;
    &lt;ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;

    &lt;ds:Reference URI="#obj" Type="http://www.w3.org/2000/09/xmldsig#;Object"&gt;
      &lt;ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
      &lt;ds:DigestValue&gt;8UIaiFvvufk+ybGUHcMk5+2Nmh4=&lt;/ds:DigestValue&gt;
    &lt;/ds:Reference&gt;
  &lt;/ds:SignedInfo&gt;
  &lt;ds:SignatureValue&gt;
    dvMOHXb+YMNV1xBloLAHJXYm4QoXN5ykEUfYRV9ZXySf9bhdDBrq9JtxOGpm0SzjUV66NWJF
    XW5TgnVvv6L3nA==
  &lt;/ds:SignatureValue&gt;
  &lt;ds:Object Id="obj" MimeType="text/plain"&gt;Hello, World!&lt;/ds:Object&gt;
   &lt;ds:KeyInfo&gt;
  &lt;KeyValue xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
    &lt;RSAKeyValue&gt;
      &lt;Modulus&gt;
        4yn1pJsP1PC8Ii3961dqcHm8OGYRxMgGREwq5WyMEvnnQAinRoN6LFk0jKrBMNQqpt/KgeaI

        gkVKs4kfSwJDAw==
      &lt;/Modulus&gt;
      &lt;Exponent&gt;AQAB&lt;/Exponent&gt;
    &lt;/RSAKeyValue&gt;
  &lt;/KeyValue&gt;

  &lt;X509Data xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
    &lt;X509Certificate&gt;
      MIIFIjCCBIugAwIBAgIKOMW2EAAAAAAAAjANBgkqhkiG9w0BAQUFADCBjTEkMCIGCSqGSIb3
      DQEJARYVa2RlZGluZ0BtaWNyb3NvZnQuY29tMQswCQYDVQQGEwJVUzELMAkGA1UECBMCd2Ex
      EDAOBgNVBAcTB3JlZG1vbmQxEjAQBgNVBAoTCW1pY3Jvc29mdDEOMAwGA1UECxMFeG1sdWUx
      FTATBgNVBAMTDHRlc3RDQW1zRUNTUDAeFw0wMjAzMjIxODUwNDhaFw0wMzAzMjIxOTAwNDha
      MH4xJDAiBgkqhkiG9w0BCQEWFWtkZWRpbmdAbWljcm9zb2Z0LmNvbTELMAkGA1UEBhMCVVMx
      CzAJBgNVBAgTAndhMRAwDgYDVQQHEwdyZWRtb25kMQ0wCwYDVQQKEwRtc2Z0MQ4wDAYDVQQL
      EwV4bWx1ZTELMAkGA1UEAxMCbWUwXDANBgkqhkiG9w0BAQEFAANLADBIAkEA4yn1pJsP1PC8
      Ii3961dqcHm8OGYRxMgGREwq5WyMEvnnQAinRoN6LFk0jKrBMNQqpt/KgeaIgkVKs4kfSwJD
      AwIDAQABo4IC2TCCAtUwDgYDVR0PAQH/BAQDAgbAMBMGA1UdJQQMMAoGCCsGAQUFBwMDMB0G
      A1UdDgQWBBRwJHnJ2w26IBlunPoqzJREZEayNjCByQYDVR0jBIHBMIG+gBSAkq3y1qiTJL9F
      ajLJbP2Wktrqa6GBk6SBkDCBjTEkMCIGCSqGSIb3DQEJARYVa2RlZGluZ0BtaWNyb3NvZnQu
      Y29tMQswCQYDVQQGEwJVUzELMAkGA1UECBMCd2ExEDAOBgNVBAcTB3JlZG1vbmQxEjAQBgNV
      BAoTCW1pY3Jvc29mdDEOMAwGA1UECxMFeG1sdWUxFTATBgNVBAMTDHRlc3RDQW1zRUNTUIIQ
      TvdcKS97h49Pds+/biO1DjCBrwYDVR0fBIGnMIGkME+gTaBLhklodHRwOi8va3VydGRpbmct
      MDEucmVkbW9uZC5jb3JwLm1pY3Jvc29mdC5jb20vQ2VydEVucm9sbC90ZXN0Q0Ftc0VDU1Au
      Y3JsMFGgT6BNhktmaWxlOi8vXFxrdXJ0ZGluZy0wMS5yZWRtb25kLmNvcnAubWljcm9zb2Z0
      LmNvbVxDZXJ0RW5yb2xsXHRlc3RDQW1zRUNTUC5jcmwwggEPBggrBgEFBQcBAQSCAQEwgf4w
      fAYIKwYBBQUHMAKGcGh0dHA6Ly9rdXJ0ZGluZy0wMS5yZWRtb25kLmNvcnAubWljcm9zb2Z0
      LmNvbS9DZXJ0RW5yb2xsL2t1cnRkaW5nLTAxLnJlZG1vbmQuY29ycC5taWNyb3NvZnQuY29t
      X3Rlc3RDQW1zRUNTUC5jcnQwfgYIKwYBBQUHMAKGcmZpbGU6Ly9cXGt1cnRkaW5nLTAxLnJl
      ZG1vbmQuY29ycC5taWNyb3NvZnQuY29tXENlcnRFbnJvbGxca3VydGRpbmctMDEucmVkbW9u
      ZC5jb3JwLm1pY3Jvc29mdC5jb21fdGVzdENBbXNFQ1NQLmNydDANBgkqhkiG9w0BAQUFAAOB
      gQCNHTpOxFuzk7x834gZz98Yr4OUNJnVtDbUrCEPbruZKGGOBxjSqg4ZEZO6e8GpT7+M5IzT
      IQSuwlJO5pkOQOOmYI9c4f+gE9pZGnJYnKPVrnhWMv+EWb/BQsX2BdEijOfLKWy+JqPP98YW
      9xhGzxnqIcldcOwY/8Qw/o+6BaOIYA==
    &lt;/X509Certificate&gt;
  &lt;/X509Data&gt;
&lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;

Sign with fwWriteKeyInfo = CERTIFICATES|PURGE:
The specified data was signed successfully.
Resultant signature:
&lt;?xml version="1.0"?&gt;
&lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;ds:SignedInfo&gt;
    &lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n
-20010315"/&gt;
    &lt;ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;

    &lt;ds:Reference URI="#obj" Type="http://www.w3.org/2000/09/xmldsig#;Object"&gt;
      &lt;ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
      &lt;ds:DigestValue&gt;8UIaiFvvufk+ybGUHcMk5+2Nmh4=&lt;/ds:DigestValue&gt;
    &lt;/ds:Reference&gt;
  &lt;/ds:SignedInfo&gt;
  &lt;ds:SignatureValue&gt;
    dvMOHXb+YMNV1xBloLAHJXYm4QoXN5ykEUfYRV9ZXySf9bhdDBrq9JtxOGpm0SzjUV66NWJF
    XW5TgnVvv6L3nA==
  &lt;/ds:SignatureValue&gt;
  &lt;ds:Object Id="obj" MimeType="text/plain"&gt;Hello, World!&lt;/ds:Object&gt;
   &lt;ds:KeyInfo&gt;
  &lt;X509Data xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
    &lt;X509Certificate&gt;
      MIIFIjCCBIugAwIBAgIKOMW2EAAAAAAAAjANBgkqhkiG9w0BAQUFADCBjTEkMCIGCSqGSIb3
      DQEJARYVa2RlZGluZ0BtaWNyb3NvZnQuY29tMQswCQYDVQQGEwJVUzELMAkGA1UECBMCd2Ex
      EDAOBgNVBAcTB3JlZG1vbmQxEjAQBgNVBAoTCW1pY3Jvc29mdDEOMAwGA1UECxMFeG1sdWUx
      FTATBgNVBAMTDHRlc3RDQW1zRUNTUDAeFw0wMjAzMjIxODUwNDhaFw0wMzAzMjIxOTAwNDha
      MH4xJDAiBgkqhkiG9w0BCQEWFWtkZWRpbmdAbWljcm9zb2Z0LmNvbTELMAkGA1UEBhMCVVMx
      CzAJBgNVBAgTAndhMRAwDgYDVQQHEwdyZWRtb25kMQ0wCwYDVQQKEwRtc2Z0MQ4wDAYDVQQL
      EwV4bWx1ZTELMAkGA1UEAxMCbWUwXDANBgkqhkiG9w0BAQEFAANLADBIAkEA4yn1pJsP1PC8
      Ii3961dqcHm8OGYRxMgGREwq5WyMEvnnQAinRoN6LFk0jKrBMNQqpt/KgeaIgkVKs4kfSwJD
      AwIDAQABo4IC2TCCAtUwDgYDVR0PAQH/BAQDAgbAMBMGA1UdJQQMMAoGCCsGAQUFBwMDMB0G
      A1UdDgQWBBRwJHnJ2w26IBlunPoqzJREZEayNjCByQYDVR0jBIHBMIG+gBSAkq3y1qiTJL9F
      ajLJbP2Wktrqa6GBk6SBkDCBjTEkMCIGCSqGSIb3DQEJARYVa2RlZGluZ0BtaWNyb3NvZnQu
      Y29tMQswCQYDVQQGEwJVUzELMAkGA1UECBMCd2ExEDAOBgNVBAcTB3JlZG1vbmQxEjAQBgNV
      BAoTCW1pY3Jvc29mdDEOMAwGA1UECxMFeG1sdWUxFTATBgNVBAMTDHRlc3RDQW1zRUNTUIIQ
      TvdcKS97h49Pds+/biO1DjCBrwYDVR0fBIGnMIGkME+gTaBLhklodHRwOi8va3VydGRpbmct
      MDEucmVkbW9uZC5jb3JwLm1pY3Jvc29mdC5jb20vQ2VydEVucm9sbC90ZXN0Q0Ftc0VDU1Au
      Y3JsMFGgT6BNhktmaWxlOi8vXFxrdXJ0ZGluZy0wMS5yZWRtb25kLmNvcnAubWljcm9zb2Z0
      LmNvbVxDZXJ0RW5yb2xsXHRlc3RDQW1zRUNTUC5jcmwwggEPBggrBgEFBQcBAQSCAQEwgf4w
      fAYIKwYBBQUHMAKGcGh0dHA6Ly9rdXJ0ZGluZy0wMS5yZWRtb25kLmNvcnAubWljcm9zb2Z0
      LmNvbS9DZXJ0RW5yb2xsL2t1cnRkaW5nLTAxLnJlZG1vbmQuY29ycC5taWNyb3NvZnQuY29t
      X3Rlc3RDQW1zRUNTUC5jcnQwfgYIKwYBBQUHMAKGcmZpbGU6Ly9cXGt1cnRkaW5nLTAxLnJl
      ZG1vbmQuY29ycC5taWNyb3NvZnQuY29tXENlcnRFbnJvbGxca3VydGRpbmctMDEucmVkbW9u
      ZC5jb3JwLm1pY3Jvc29mdC5jb21fdGVzdENBbXNFQ1NQLmNydDANBgkqhkiG9w0BAQUFAAOB
      gQCNHTpOxFuzk7x834gZz98Yr4OUNJnVtDbUrCEPbruZKGGOBxjSqg4ZEZO6e8GpT7+M5IzT
      IQSuwlJO5pkOQOOmYI9c4f+gE9pZGnJYnKPVrnhWMv+EWb/BQsX2BdEijOfLKWy+JqPP98YW
      9xhGzxnqIcldcOwY/8Qw/o+6BaOIYA==
    &lt;/X509Certificate&gt;
  &lt;/X509Data&gt;
&lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;

Sign with fwWriteKeyInfo = PURGE:
The specified data was signed successfully.
Resultant signature:
&lt;?xml version="1.0"?&gt;
&lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;ds:SignedInfo&gt;
    &lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n
-20010315"/&gt;
    &lt;ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;

    &lt;ds:Reference URI="#obj" Type="http://www.w3.org/2000/09/xmldsig#;Object"&gt;
      &lt;ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
      &lt;ds:DigestValue&gt;8UIaiFvvufk+ybGUHcMk5+2Nmh4=&lt;/ds:DigestValue&gt;
    &lt;/ds:Reference&gt;
  &lt;/ds:SignedInfo&gt;
  &lt;ds:SignatureValue&gt;
    dvMOHXb+YMNV1xBloLAHJXYm4QoXN5ykEUfYRV9ZXySf9bhdDBrq9JtxOGpm0SzjUV66NWJF
    XW5TgnVvv6L3nA==
  &lt;/ds:SignatureValue&gt;
  &lt;ds:Object Id="obj" MimeType="text/plain"&gt;Hello, World!&lt;/ds:Object&gt;
   &lt;ds:KeyInfo&gt;&lt;/ds:KeyInfo&gt;
&lt;/ds:Signature&gt;</PRE>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
