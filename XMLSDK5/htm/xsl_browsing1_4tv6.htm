<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Serving Out XML Files from an HTTP Server</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconservingoutxmlfilesfromanhttpserver"></A>Serving Out XML Files from an HTTP Server</H1>

<P>XML documents can be delivered through a standard HTTP server by registering the "text/xml"<code class="ce"> </code>Multipurpose Internet Mail Extension (MIME) type on the server. Installing Microsoft&reg; Internet Explorer 5.0 on the server registers the XML MIME type and associates it with the .xml and .xsl file extensions. This association is used by Microsoft Internet Information Services (IIS) and the Microsoft Personal Web Server (PWS) to determine the MIME type.</P>

<P>When using either of these servers on systems that do not have Internet Explorer 5.0 installed, the XML MIME type can be registered by running the <B>register-xml.regregister-xml.reg</B> file. This file inserts the appropriate keys into the registry. The changes will not take effect until the computer has been restarted.</P>

<P>Alternatively, for IIS on systems that do not have Internet Explorer 5.0 installed, the XML MIME type can be registered using the Internet Service Manager console.

<OL type="1">
	<LI>Select <B>Default Web Site</B> and open the <B>Properties </B>dialog box.</li>

	<LI>Select the <B>HTTP Headers</B> tab, click the <B>File Types</B> button, and select <B>New Type</B>.</li>

	<LI>Type .xml in the <B>Associated extension</B> box, and text/xml in the <B>Content type (MIME)</B> box. Click <B>OK</B>.</li>
</OL>

<P>The .xsl extension can be registered in a similar fashion.</P>

<P>The .xml and .xsl extensions can also be registered to the XML MIME type manually from the <B>File Types</B> dialog box under <B>Folder Options</B>. Extensions indicating other types of XML files for purposes of browsing must be manually registered as MIME type "text/xml".</P>

<H2 class="dtH2">Declaring the XML MIME Type in an Active Server Page</H2>

<P>When generating XML dynamically using Active Server Pages (ASP), the content type must be declared in the .ASP file itself. The <code class="ce">ContentType</code> property of the <code class="ce">Response</code> object indicates that the result is XML. Include the following line in Active Server Pages that are delivering XML.</P>

<PRE class="code">&lt;% Response.ContentType = "text/xml" %&gt;</PRE>

<BLOCKQUOTE class="dtBlock">
<b class="le">Important</b>&nbsp;&nbsp;&nbsp;If the XML MIME type is not registered on the server, the MIME type sent to Internet Explorer in the HTTP header will be incorrect &#0151; often "text/plain". Although Internet Explorer 5.0 often can detect and process these documents, conflicts can arise between the various detection algorithms. For example, part of Channel Definition Format (CDF) file detection involves looking for <code class="ce">&lt;CHANNEL&gt;</code> tags &#0151; an XML document delivered with an incorrect MIME type and that uses elements named <code class="ce">&lt;CHANNEL&gt;</code> could mistakenly be handed off to the CDF processor instead of displayed as an XML document. Avoid these tricky and hard-to-debug problems by making sure your server correctly sends the XML MIME type.</BLOCKQUOTE>

<P>Internet Explorer 5.0 also recognizes documents of MIME type "application/xml" as XML. For more information, see <A HREF="http://go.microsoft.com/fwlink/?LinkId=4885">Internet Engineering Task Force Request for Comments 2376, XML Media Types</A> <IMG SRC="leave-ms.gif" ALT="Other Resources" BORDER=0>.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xslt_starter_5jar.htm">Deploying XSLT Solutions</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
