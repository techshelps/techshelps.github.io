<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sample Files (XML Extractor)</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - SAX2 Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="sax_hdi_extractdata_samplefiles"></A>Sample Files (XML Extractor)</H1>

<P>To run the application you must create the following files:

<UL type="disc">
	<LI>A sample XML file, <B>invoices.xml.</B> This file contains the patient invoices for a fictitious doctor's office.</li>

	<LI>A sample XSLT style sheet file, <B>invoice.xsl</B>. This file is used to transform the patient invoice data, which is extracted using SAX content handling. Each set of patient data is transformed into an HTML file.</li>

	<LI>A GIF image file. This file contains a piece of business logo art for the fictitious medical center using this application.</li>
</UL>

<H2 class="dtH2">Complete Code for invoices.xml</H2>

<P class="labelproc"><B>To create the sample XML file</B>

<OL type="1">
	<LI>Open Notepad.</li>

	<LI>Select the code for <B>invoices.xml </B>(below). Then copy it, and paste it in Notepad.</li>

	<LI>From Notepad, save the file as <B>invoices.xml</B> to the same folder that will contain the XML Extractor application.</li>
</OL>

<P class="label"><B>invoices.xml</B></P>

<PRE class="code">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE invoices [
&lt;!ELEMENT invoices (invoice)*&gt;
&lt;!ELEMENT invoice ( patient, insurance?, procedure* )&gt;
&lt;!ATTLIST invoice number        CDATA   #REQUIRED
                  date          CDATA   #REQUIRED&gt;
&lt;!ELEMENT patient ( phone | address )*&gt;
&lt;!ATTLIST patient       firstname   CDATA #REQUIRED
                        familyname  CDATA #REQUIRED
                        SSN         CDATA ""&gt;
&lt;!ELEMENT insurance ( address | phone )*&gt;
&lt;!ATTLIST insurance     name CDATA ""
                        plannumber      CDATA ""
                        planname        CDATA ""&gt;
&lt;!ELEMENT procedure  (#PCDATA) &gt;
&lt;!ATTLIST procedure     code    CDATA #REQUIRED
                        name    CDATA ""
                        cost    CDATA ""
                        insurance_estimate      CDATA  ""
                        submitted (yes|no) "yes"&gt;
&lt;!ELEMENT phone EMPTY&gt;
&lt;!ATTLIST phone         type (home|work|mobile|other)   "other"
                        number  CDATA  ""&gt;
&lt;!ELEMENT address EMPTY&gt;
&lt;!ATTLIST address         type (home|work|business|other)   "other"
                        company CDATA  ""
                        line1   CDATA  ""
                        line2   CDATA  ""
                        city    CDATA  ""
                        state   CDATA  ""
                        zip     CDATA  ""&gt;
]&gt;
&lt;invoices&gt;
  &lt;invoice number="25" date="February 28, 2001"&gt;
    &lt;patient firstname="Jeff" familyname="Smith" SSN="123456789"&gt;
      &lt;phone type="home" number="123-4567890"/&gt;
      &lt;phone number="321-76543321" type="work"/&gt;
      &lt;address type="home" line1="123 Street" city="City" state="US" zip="12345"/&gt;
    &lt;/patient&gt;
    &lt;insurance name="Humongous First Medical Insurance" plannumber="12345" planname="The Client Company"&gt;
    &lt;phone number="098-76543321"/&gt;
    &lt;address type="business" line1="321 Street" city="City" state="US" zip="54321"/&gt;
    &lt;/insurance&gt;
    &lt;procedure code="123" name="Cleaning nose" cost="50.00" insurance_estimate="50.00"/&gt;
    &lt;procedure code="124" name="Tarot reading of illnesses" cost="150.00" insurance_estimate="120.00"/&gt;
    &lt;procedure code="125" name="Just for fun" cost="100.00" insurance_estimate="80.00"/&gt;
  &lt;/invoice&gt;
  &lt;invoice number="27" date="February 28, 2001"&gt;
      &lt;patient firstname="James" familyname="Smith" SSN="123456765"&gt;
         &lt;phone type="home" number="123-4562245"/&gt;
         &lt;address type="home" line1="432 Street" city="City" state="US" zip="12343"/&gt;
       &lt;/patient&gt;
       &lt;insurance name="Humongous Second Medical Insurance" plannumber="3455" planname="Another Client Company"&gt;
          &lt;phone number="098-76543321"/&gt;
          &lt;address type="business" line1="344 Street" city="Some City" state="US" zip="54323"/&gt;
       &lt;/insurance&gt;
       &lt;procedure code="123" name="Cleaning nose" cost="50.00" insurance_estimate="50.00"/&gt;
       &lt;procedure code="124" name="Tarot reading of illnesses" cost="150.00" insurance_estimate="120.00"/&gt;
  &lt;/invoice&gt;
  &lt;invoice number="29" date="February 28, 2001"&gt;
    &lt;patient firstname="Neil" familyname="Smith" SSN="123456345"&gt;
      &lt;phone type="home" number="125-4345890"/&gt;
      &lt;address type="home" line1="187 Street" city="Lost City" state="US" zip="42145"/&gt;
    &lt;/patient&gt;
    &lt;insurance name="Humongous Third Medical Insurance" plannumber="12345" planname="The Lost City Client Company"&gt;
      &lt;phone number="198-76345321"/&gt;
      &lt;address type="business" line1="342 Street" city="Completely Lost City" state="US" zip="111111-0000"/&gt;
    &lt;/insurance&gt;
    &lt;procedure code="123" name="Cleaning nose" cost="50.00" insurance_estimate="50.00"/&gt;
    &lt;procedure code="125" name="Maybe they wouldn't see this line..." cost="100.00" insurance_estimate="80.00"/&gt;
  &lt;/invoice&gt;
&lt;/invoices&gt;</PRE>

<H2 class="dtH2">Complete Code for invoice.xsl</H2>

<P class="labelproc"><B>To create the sample XSLT file</B>

<OL type="1">
	<LI>Open Notepad.</li>

	<LI>Select the code for <B>invoice.xsl</B> (below). Then copy it, and paste it in Notepad.</li>

	<LI>From Notepad, save the file as <B>invoice.xsl</B> to the same folder that will contain the XML Extractor application.</li>
</OL>

<P class="label"><B>invoices.xsl</B></P>

<PRE class="code">&lt;?xml version="1.0"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"&gt;
&lt;xsl:output method="html"/&gt;
&lt;xsl:template match="/"&gt;
&lt;HTML&gt;
&lt;BODY bgcolor="#FFFFE0"&gt;
&lt;TABLE border="0" width="100%"&gt;&lt;TR&gt;&lt;TD&gt;
&lt;H1&gt;Invoice #
&lt;xsl:value-of select="invoice/@number"/&gt;,&lt;BR/&gt;
&lt;xsl:value-of select="invoice/@date"/&gt;
&lt;/H1&gt;
&lt;/TD&gt;&lt;TD align="right"&gt;&lt;img src="sax_extractData_logo.gif"/&gt;
&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;

&lt;TABLE border="0" width="100%"&gt;
  &lt;TR valign="top"&gt;
    &lt;TD&gt;
      &lt;xsl:for-each select="/invoice/patient"&gt;
            To: &lt;xsl:value-of select="@firstname"/&gt;&lt;xsl:text&gt; &lt;/xsl:text&gt;
                &lt;xsl:value-of select="@familyname"/&gt;
            &lt;BR/&gt;Account #&lt;xsl:value-of select="@SSN"/&gt;
            &lt;BR/&gt;
            &lt;xsl:value-of select="address/@line1"/&gt;&lt;BR/&gt;
            &lt;xsl:if test="address/@line2!=''"&gt;
                &lt;xsl:value-of select="address/@line2"/&gt;&lt;BR/&gt;
            &lt;/xsl:if&gt;
            &lt;xsl:value-of select="address/@city"/&gt;,
            &lt;xsl:value-of select="address/@state"/&gt;
            &lt;xsl:value-of select="address/@zip"/&gt;&lt;BR/&gt;
      &lt;/xsl:for-each&gt;
    &lt;/TD&gt;
    &lt;TD&gt;
        &lt;xsl:for-each select="/invoice/insurance"&gt;
            Insurance: &lt;xsl:value-of select="@name"/&gt;&lt;BR/&gt;
            Plan name: &lt;xsl:value-of select="@planname"/&gt;&lt;BR/&gt;
            Plan #&lt;xsl:value-of select="@plannumber"/&gt;&lt;BR/&gt;
            &lt;xsl:value-of select="address/@line1"/&gt;&lt;BR/&gt;
            &lt;xsl:if test="address/@line2!=''"&gt;
                &lt;xsl:value-of select="address/@line2"/&gt;&lt;BR/&gt;
            &lt;/xsl:if&gt;
            &lt;xsl:value-of select="address/@city"/&gt;,
            &lt;xsl:value-of select="address/@state"/&gt;
            &lt;xsl:value-of select="address/@zip"/&gt;&lt;BR/&gt;
            &lt;xsl:value-of select="phone/@number"/&gt;&lt;BR/&gt;
      &lt;/xsl:for-each&gt;
    &lt;/TD&gt;
  &lt;/TR&gt;
&lt;/TABLE&gt;
&lt;P&gt; &lt;/P&gt;
&lt;TABLE border="1" width="100%"&gt;
  &lt;TR&gt;
    &lt;TD width="20%"&gt;Code&lt;/TD&gt;
    &lt;TD width="20%"&gt;Name&lt;/TD&gt;
    &lt;TD width="20%"&gt;Cost&lt;/TD&gt;
    &lt;TD width="20%"&gt;Insurance estimate&lt;/TD&gt;
    &lt;TD width="20%"&gt;Submitted&lt;/TD&gt;
  &lt;/TR&gt;
  &lt;xsl:for-each select="/invoice/procedure"&gt;
  &lt;TR&gt;
    &lt;TD width="20%"&gt;&lt;xsl:value-of select="@code"/&gt;&lt;/TD&gt;
    &lt;TD width="20%"&gt;&lt;xsl:value-of select="@name"/&gt;&lt;/TD&gt;
    &lt;TD width="20%"&gt;&lt;xsl:value-of select="@cost"/&gt;&lt;/TD&gt;
    &lt;TD width="20%"&gt;&lt;xsl:value-of select="@insurance_estimate"/&gt;&lt;/TD&gt;
    &lt;TD width="20%"&gt;&lt;xsl:value-of select="@submitted"/&gt;&lt;/TD&gt;
  &lt;/TR&gt;
  &lt;/xsl:for-each&gt;
&lt;/TABLE&gt;
&lt;P&gt; &lt;/P&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
&lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</PRE>

<H2 class="dtH2">Creating the Logo Art File</H2>

<P class="labelproc"><B>To create the GIF logo art file</B>

<OL type="1">
	<LI>Open Paint.</li>

	<LI>Right-click on the image (below).
<P class="fig1"><IMG SRC="sax_extractdata_logo.gif" ALT="" BORDER=0>
</li>

	<LI>Select <B>Copy</B> to copy the image to the Windows Clipboard.</li>

	<LI>From Paint, paste the image and save it to file as <B>sax_extractData_logo.gif</B>. Save the image in the same folder that will contain the XML Extractor application.</li>
</OL>

<H4 class="dtH4">See Also</H4>

<P><A HREF="sax_devgd_hdi_extractdata_7wtr.htm">Extract Data From a Large Document</A> | <A HREF="sax_devgd_hdi_extractdata_73g7.htm">Overview of the XML Extractor Application</A> | <A HREF="sax_devgd_hdi_extractdata_0ldf.htm">Application Forms (XML Extractor)</A> | <A HREF="sax_devgd_hdi_extractdata_6h0z.htm">MyExtractor Class (XML Extractor)</A> | <A HREF="sax_devgd_hdi_extractdata_8asu.htm">Run the Application (XML Extractor)</A> | <A HREF="sax_devgd_hdi_extractdata_5mb7.htm">How the XML Extractor Application Works</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
