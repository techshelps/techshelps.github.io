<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Axes</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmrefaxes"></A>Axes</H1>

<P>A location path uses an axis to specify the relationship between the nodes selected by the location step and the context node.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=26%>Axes</TH>
<TH width=74%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">ancestor::</code></TD>
<TD width=74%>The ancestors of the context node.
<P>The ancestors of the context node consist of the parent of the context node and the parent's parent and so on; thus the <code class="ce">ancestor::</code> axis always includes the root node unless the context node is the root node.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">ancestor-or-self::</code></TD>
<TD width=74%>The context node and its ancestors.
<P>The <code class="ce">ancestor-or-self::</code> axis always includes the root node.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">attribute::</code></TD>
<TD width=74%>The attributes of the context node.
<P>This axis will be empty unless the context node is an element.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">child::</code></TD>
<TD width=74%>The children of the context node.
<P>A child is any node immediately below the context node in the tree. However, neither attribute or namespace nodes are considered children of the context node.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">descendant::</code></TD>
<TD width=74%>The descendants of the context node.
<P>A descendant is a child or a child of a child and so on; thus the <code class="ce">descendant::</code> axis never contains attribute or namespace nodes.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">descendant-or-self::</code></TD>
<TD width=74%>The context node and its descendants.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">following::</code></TD>
<TD width=74%>All nodes that are after the context node in the tree, excluding any descendants, attribute nodes, and namespace nodes.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">following-sibling::</code></TD>
<TD width=74%>All the following siblings of the context node.
<P>The <code class="ce">following-sibling::</code> axis identifies just those children of a parent node who appear in the tree after the context node. This axis excludes all other children that appear before the context node.</P>

<P>If the context node is an attribute node or namespace node, the <code class="ce">following-sibling::</code> axis is empty.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">namespace::</code></TD>
<TD width=74%>The namespace nodes of the context node.
<P>There is a namespace node for every namespace which is in scope for the context node.</P>

<P>This axis will be empty unless the context node is an element.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">parent::</code></TD>
<TD width=74%>The parent of the context node, if there is one.
<P>The parent is the node immediately above the context node in the tree.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">preceding::</code></TD>
<TD width=74%>All nodes that are before the context node in the tree, excluding any ancestors, attribute nodes, and namespace nodes.
<P>One way to think of the preceding axis is all nodes whose content occurs in their entirety before the start of the context node.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">preceding-sibling::</code></TD>
<TD width=74%>All the preceding siblings of the context node.
<P>The <code class="ce">preceding-sibling::</code> axis identifies just those children of a parent node who appear in the tree before the context node. This axis excludes all other children that appear after the context node.</P>

<P>If the context node is an attribute node or namespace node, the <code class="ce">preceding-sibling::</code> axis is empty.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><code class="ce">self::</code></TD>
<TD width=74%>Just the context node itself.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">Remarks</H4>

<DL>
<DT><B>namespace</B></DT>
</DL>

<P>Each element has an associated set of namespace nodes, one for each distinct namespace prefix that is in scope for the element (including the <code class="ce">xml</code> prefix, which is implicitly declared by the XML Namespaces Recommendation) and one for the default namespace if one is in scope for the element. The element is the parent of each of these namespace nodes; however, a namespace node is not a child of its parent element. Elements never share namespace nodes: if one element node is not the same node as another element node, then none of the namespace nodes of the one element node will be the same node as the namespace nodes of another element node. This means that an element will have a namespace node:

<UL type="disc">
	<LI>For every attribute on the element whose name starts with <code class="ce">xmlns:</code>.</li>

	<LI>For every attribute on an ancestor element whose name starts with <code class="ce">xmlns:</code>&#0151;unless the element itself or a nearer ancestor redeclares the prefix.</li>

	<LI>For an <code class="ce">xmlns</code> attribute, if the element or some ancestor has an <code class="ce">xmlns</code> attribute, and the value of the <code class="ce">xmlns</code> attribute for the nearest such element is non-empty.</li>
</UL>

<P>The <code class="ce">&lt;sample&gt;</code> element in the following instance:</P>

<PRE class="code">&lt;A xmlns="urn:A"&gt;
  &lt;B xmlns:test="sample"&gt;
    &lt;sample xmlns:sampletest="sampletest"/&gt;
  &lt;/B&gt;
&lt;/A&gt;</PRE>

<P>contains the following namespace nodes:</P>

<PRE class="code">xmlns="urn:A"
xmlns:test="sample"
xmlns:sampletest="sampletest"</PRE>

<P>The <code class="ce">&lt;sample&gt;</code> element in the following instance:</P>

<PRE class="code">&lt;A xmlns="urn:A"&gt;
  &lt;B xmlns="" xmlns:test="sample"&gt;
    &lt;sample xmlns:sampletest="sampletest" xmlns:bar="test"/&gt;
  &lt;/B&gt;
&lt;/A&gt;</PRE>

<P>contains the following namespace nodes:</P>

<PRE class="code">xmlns:sampletest="sampletest"
xmlns:test="test"</PRE>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;An attribute <code class="ce">xmlns=""</code> undeclares the default namespace.</BLOCKQUOTE>

<P>A namespace node has an expanded-name: the local part is the namespace prefix (this is empty if the namespace node is for the default namespace); the namespace Uniform Resource Identifier (URI) is always null.</P>

<P>The string-value of a namespace node is the namespace URI that is being bound to the namespace prefix; if it is relative, it must be resolved just like a namespace URI in an expanded-name.</P>

<H4 class="dtH4">Examples</H4>

<P class="label"><B>following::</B></P>

<P>The examples for the <code class="ce">following::</code> axis refer to this instance document:</P>

<PRE class="code">&lt;A&gt;
  &lt;B&gt;
    &lt;C&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
  &lt;/B&gt;
  &lt;B&gt;
    &lt;C&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
    &lt;D&gt;sample3&lt;/D&gt;
  &lt;/B&gt;
&lt;/A&gt;</PRE>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Query</TH>
<TH width=50%>Returned nodes</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">A/B[1]/following::*</code></TD>
<TD width=50%>
<PRE class="code">&lt;B&gt;
<PRE class="code">    &lt;C&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
    &lt;D&gt;sample3&lt;/D&gt;
&lt;/B&gt;
&lt;C&gt;sample&lt;/C&gt;
&lt;C&gt;sample2&lt;/C&gt;
&lt;D&gt;sample3&lt;/D&gt;</PRE>
</PRE>
</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">A/B[1]/following::node()</code></TD>
<TD width=50%>
<PRE class="code">&lt;B&gt;
<PRE class="code">    &lt;C&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
    &lt;D&gt;sample3&lt;/D&gt;
&lt;/B&gt;
&lt;C&gt;sample&lt;/C&gt;
sample
&lt;C&gt;sample2&lt;/C&gt;
sample2
&lt;D&gt;sample3&lt;/D&gt;
sample3</PRE>
</PRE>
</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P class="label"><B>preceding::</B></P>

<P>The example for the <code class="ce">preceding::</code> axis refer to this instance document:</P>

<PRE class="code">&lt;A&gt;
  &lt;B&gt;
    &lt;C test="sampletest"&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
  &lt;/B&gt;
  &lt;B&gt;
    &lt;C&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
    &lt;D&gt;sample3&lt;/D&gt;
  &lt;/B&gt;
&lt;/A&gt;</PRE>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Query</TH>
<TH width=50%>Returned nodes</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">A/B[2]/preceding::*</code></TD>
<TD width=50%>
<PRE class="code">&lt;B&gt;
<PRE class="code">  &lt;C test="sampletest"&gt;sample&lt;/C&gt;
  &lt;C&gt;sample2&lt;/C&gt;
&lt;/B&gt;
&lt;C&gt;sample&lt;/C&gt;
&lt;C&gt;sample2&lt;/C&gt;</PRE>
</PRE>
</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P class="label"><B>following-sibling::</B></P>

<P>The example for the <code class="ce">following-sibling::</code> axis refers to this instance document:</P>

<PRE class="code">&lt;A&gt;
  &lt;B&gt;
    &lt;C test="sampletest"&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
  &lt;/B&gt;
  &lt;B&gt;
    &lt;C&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
    &lt;D&gt;sample3&lt;/D&gt;
  &lt;/B&gt;
&lt;/A&gt;</PRE>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Query</TH>
<TH width=50%>Returned nodes</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">A/B[1]/following-sibling::*</code></TD>
<TD width=50%>
<PRE class="code">&lt;B&gt;
<PRE class="code">  &lt;C&gt;sample&lt;/C&gt;
  &lt;C&gt;sample2&lt;/C&gt;
  &lt;D&gt;sample3&lt;/D&gt;</PRE>

<P><code class="ce">&lt;/B&gt;</code></P>
</PRE>
</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P class="label"><B>preceding-sibling::</B></P>

<P>The example for the <code class="ce">preceding-sibling::</code> axis refers to this instance document:</P>

<PRE class="code">&lt;A&gt;
  &lt;B&gt;
    &lt;C test="sampletest"&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
  &lt;/B&gt;
  &lt;B&gt;
    &lt;C&gt;sample&lt;/C&gt;
    &lt;C&gt;sample2&lt;/C&gt;
    &lt;D&gt;sample3&lt;/D&gt;
  &lt;/B&gt;
&lt;/A&gt;</PRE>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Query</TH>
<TH width=50%>Returned nodes</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">A/B[2]/preceding-sibling::*</code></TD>
<TD width=50%>
<PRE class="code">&lt;B&gt;
<PRE class="code">  &lt;C test="sampletest"&gt;sample&lt;/C&gt;
  &lt;C&gt;sample2&lt;/C&gt;</PRE>

<P><code class="ce">&lt;/B&gt;</code></P>
</PRE>
</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_syntax2_7s6r.htm">Location Steps</A> | <A HREF="xpath_syntax2_42gj.htm">Node Tests</A> | <A HREF="xpath_syntax2_3a5v.htm">Predicates</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
