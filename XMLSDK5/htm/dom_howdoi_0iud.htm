<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Getting and Setting Data Within a Node</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmcongettingandsettingdatawithinanode"></A>Getting and Setting Data Within a Node</H1>

<P>Data marked up as text within elements, attributes, comments, and processing instructions is exposed in the Document Object Model (DOM) as node values.</P>

<P>The following code sets the value of an attribute to <code class="ce">"hello world"</code>.</P>

<PRE class="code">newAttNode = myElementNode.createAttribute("newAtt")
newAttNode.nodeValue = "hello world"</PRE>

<P>There are three ways to access text within an element node.

<UL type="disc">
	<LI>The <code class="ce">nodeValue</code> property provides direct access to values of certain types of nodes, including attributes, text nodes, comments, processing instructions, and CDATA sections. Navigate down to the element's children (the text nodes within) and call <code class="ce">nodeValue</code>.</li>

	<LI>The <code class="ce">text</code> property returns the text within the element. The text within an element can also be changed using the <code class="ce">text</code> property, but this will overwrite any child elements.
<P>The following sample code tests to see if the text within the element <code class="ce">elem1</code> is equal to <code class="ce">"hello world"</code>. If so, the element is assigned the text <code class="ce">"hi! world"</code>.

<PRE class="code">if (elem1.text == "hello world")
  elem1.text = "hi! world"</PRE>
</li>

	<LI>The <code class="ce">nodeTypedValue</code> property is part of the data type support built into Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office and returns the typed value of the node. This property is only for typed elements. The <code class="ce">dataType</code> property, which returns the data type of the element, can be used in conjunction with this property. The <code class="ce">nodeTypedValue</code> and <code class="ce">datatype</code> properties can both be set. However, the parser will return an error if the new <code class="ce">nodeTypedValue</code> is of the wrong data type or if the new data type does not match the <code class="ce">nodeTypedValue</code>. For more information about data type support, see <A HREF="xsd_xdrref_3w6d.htm">XDR Schema Data Types Reference</A>.</li>
</UL>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_pro_ae_3omd.htm">dataType Property</A> | <A HREF="xml_pro_no_7sth.htm">nodeValue Property</A> | <A HREF="xml_pro_no_81b9.htm">nodeTypedValue Property</A> | <A HREF="xml_pro_sz_6pkk.htm">text Property</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
