<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>validateNode Method</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmth_validatenode"></A>validateNode Method</H1>

<P>Validates a specified DOM fragment. A DOM fragment is a sub-tree spanning from a given node.</P>
<div class=filtered><span class="lang">[JScript]</span>

<H4 class="dtH4">Script Syntax</H4>

<PRE class="syntax">var objErr = objXMLDOMDocument3.validateNode(node);</PRE>
</div><!-- [JScript] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">Set objErr = objXMLDOMDocument3.validateNode(node);</PRE>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax Using Smart Pointers</H4>

<PRE class="syntax">IXMLDOMParseErrorPtr objErr = objXMLDOMDocument3-&gt;validateNode(node);</PRE>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT IXMLDOMDocument3::validateNode(
...[in] IXMLDOMNode* node,
...[out, retval] IXMLDOMParseError** objErr);</PRE>

<P class="fineprint"></P>
</div><!-- [C/C++] -->

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>node</I></DT>

<DD>An <code class="ce">IXMLDOMNode</code> object representing the node from which the fragment or sub-tree expands.</dd>

<DT><I>objErr</I></DT>

<DD>A reference to the <code class="ce">IXMLDOMParseError</code> object that indicates exactly what error occurred, if any. Use the properties on this object to examine specific parse error information.</dd>
</DL>

<H4 class="dtH4">Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>Validation was successful.</dd>

<DT>E_FAIL</DT>

<DD>The node failed to validate for one of the following reasons:

<UL type="disc">
	<LI>The DOM document was not completely loaded</li>

	<LI>The DOM node does not belong to this DOM document instance</li>

	<LI>The DOM node type was not element or attribute.</li>
</UL>
</dd>

<DT>S_FALSE</DT>

<DD>Validation errors were encountered. Check the returned <code class="ce">objErr</code> object for detailed parse error information.</dd>
</DL>

<BLOCKQUOTE class="dtBlock">
<B><b class="le">Note</b>&nbsp;&nbsp;&nbsp;</B>This method returns the same <code class="ce">HRESULT</code> value that is returned by the <code class="ce">IXMLDOMDocument2::import</code> method.</BLOCKQUOTE>

<H4 class="dtH4">Remarks</H4>

<P>In the syntax for Visual Basic and JScript above, an <code class="ce">objXMLDOMDocument3</code> object is a <code class="ce">DOMDocument</code> instance that implements the <code class="ce">IXMLDOMDocument3</code> interface.</P>

<P>Unlike <code class="ce">IXMLDOMDocument2::validate</code>, <code class="ce">validateNode</code> will not cause a new schema to load. Furthermore, <code class="ce">validateNode</code> assumes that the rest of the document is valid. Without this assumption it would not be possible to validate ID/IDREFs at all with the <code class="ce">validateNode</code> method.</P>

<P>The <code class="ce">validateNode</code> method is applicable only to element or attribute nodes located within the same DOM document. Any attempt to call it on other types of nodes or nodes in other DOM documents results in an error.</P>

<H4 class="dtH4">Example</H4>

<P>The <B>validateNode</B> example shows how to validate a DOM fragment at run time. The example uses two resource files, <B>validateNode.xml</B> and <B>validateNode.xsd</B>. The first is an XML data file, and the second is the XML Schema for the XML data. The first <code class="ce">&lt;book&gt;</code> element in <B>validateNode.xml</B> is valid against <B>validateNode.xsd</B>; the second <code class="ce">&lt;book&gt;</code> element is not. </P>

<P>We've provided source files for the sample in three languages: JScript, Visual Basic, and C++. The output is the same in each language. 

<UL type="disc">
	<LI><A HREF="xml_mth_sz_2m5h.htm">Resource Files (validateNode.xml and validateNode.xsd)</A></li>

	<LI><A HREF="xml_mth_sz_8jqr.htm">JScript Code (validateNode.js)</A></li>

	<LI><A HREF="xml_mth_sz_6qy5.htm">Visual Basic Code (validateNode.frm)</A></li>

	<LI><A HREF="xml_mth_sz_6hdc.htm">C/C++ Code (validateNode.cpp)</A></li>

	<LI><A HREF="xml_mth_sz_3j1w.htm">Output for validateNode Example</A></li>
</UL>

<H4 class="dtH4">Applies To</H4>

<P><A HREF="xml_obj_ixmldomdocument3_12r7.htm">IXMLDOMDocument3</A></P>

<H4 class="dtH4">Versioning</H4>

<P>MSXML 5.0 and later</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_obj_ixmldomnode_5xwl.htm">IXMLDOMNode</A> | <A HREF="xml_obj_ixmldomnodelist_4kvo.htm">IXMLDOMNodeList</A> | <A HREF="xml_obj_ixmldomparseerror_7jqq.htm">IXMLDOMParseError</A> | <A HREF="xml_obj_ixmldomschemacollection_11ke.htm">IXMLDOMSchemaCollection/XMLSchemaCache</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
