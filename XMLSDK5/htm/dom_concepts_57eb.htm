<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Working with Text Nodes</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconworkingwithxmldocumentparts_textnodes"></A>Working with Text Nodes</H1>

<P>Text nodes store the character sequences that make up the content of XML elements and attributes. Text nodes cannot have child nodes because they represent content, not structure. Text nodes must be contained by element, attribute, document fragment, or entity reference nodes&#0151;they cannot be contained by the top-level document node, though the <code class="ce">DOMDocument</code> object is used to create text nodes. For more information, see <A HREF="xml_concepts_0mb8.htm">Textual Content</A>.</P>

<H4 class="dtH4">Examples</H4>

<P>The <code class="ce">createTextNode</code> method of <code class="ce">DOMDocument</code> object is used to create new text nodes, instances of <code class="ce">XMLDOMText</code>. </P>

<P class="label"><B>JScript</B></P>

<P>In the following JScript example, <code class="ce">createTextNode</code> is called twice&#0151;once to create a text node for an attribute value, and once to create a text node for element content.</P>

<PRE class="code">var xmlDoc = new ActiveXObject("Msxml2.DOMDocument.5.0");
var rootElement=xmlDoc.createElement("memo");
var memoAttribute=xmlDoc.createAttribute("author");
var memoAttributeText=xmlDoc.createTextNode("Pat Coleman");
var toElement=xmlDoc.createElement("to");
var toElementText=xmlDoc.createTextNode("Carole Poland");
memoAttribute.appendChild(memoAttributeText);
xmlDoc.appendChild(rootElement);
rootElement.setAttributeNode(memoAttribute);
rootElement.appendChild(toElement);
toElement.appendChild(toElementText);</PRE>

<P class="label"><B>VBScript</B></P>

<PRE class="code">Set xmlDoc = CreateObject("Msxml2.DOMDocument.5.0")
Set rootElement=xmlDoc.createElement("memo")
Set memoAttribute=xmlDoc.createAttribute("author")
Set memoAttributeText=xmlDoc.createTextNode("Pat Coleman")
Set toElement=xmlDoc.createElement("to")
Set toElementText=xmlDoc.createTextNode("Carole Poland")
memoAttribute.appendChild(memoAttributeText)
xmlDoc.appendChild(rootElement)
rootElement.setAttributeNode(memoAttribute)
rootElement.appendChild(toElement)
toElement.appendChild(toElementText)</PRE>

<P>Although you can read the textual content of a text node using its <code class="ce">nodeValue</code> property, it is more common to use the <code class="ce">text</code> property of the <code class="ce">IXMLDOMElement</code> object to avoid problems created by elements containing multiple text, CDATA section, and entity reference nodes. The <code class="ce">normalize</code> method of <code class="ce">IXMLDOMElement</code> can also simplify text processing.</P>

<P>For more information on properties and methods of <code class="ce">IXMLDOMText</code>, see <A HREF="xml_obj_ixmldomtext_8sxg.htm">IXMLDOMText</A>.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
