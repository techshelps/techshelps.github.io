<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>signature Property</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - Digital Signatures</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmpro_signature"></A>signature Property</H1>
<font face="verdana" color=red>[This feature was first implemented for MSXML 5.0.]</font>
<P>This is a read/write property for getting or setting a signature to be processed. </P>

<P>The <code class="ce">signature</code> property takes an <code class="ce">IXMDOMNode</code> object as its value. The DOM object holds a signature template or signed signature document as represented by a <code class="ce">&lt;ds:Signature&gt;</code> element that belongs to the <code class="ce">http://www.w3.org/2000/09/xmldsig#</code> namespace. The <code class="ce">ds</code> alias is used for this namespace throughout this document. </P>
<div class=filtered><span class="lang">[JScript]</span>

<H4 class="dtH4">JScript Syntax</H4>

<PRE class="syntax">var objSigNode = objXMLDigitalSignature.signature;
objXMLDigitalSignature.signature = objSigNode;</PRE>
</div><!-- [JScript] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Visual Basic Syntax</H4>

<PRE class="syntax">Set objSigNode = objXMLDigitalSignature.signature
Set objXMLDigitalSignature.signature = objSigNode</PRE>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">C/C++ Syntax Using Smart Pointers</H4>

<PRE class="syntax">IXMLDOMNodePtr objSigNode = objXMLDigitalSignature.signature;
objXMLDigitalSignature.signature = objSigNode;</PRE>

<H4 class="dtH4">C/C++ Syntax</H4>

<PRE class="syntax">HRESULT get_signature (IXMLDOMNode** objSigNode);
HRESULT putref_signature (IXMLDOMNode* objSigNode);</PRE>
</div><!-- [C/C++] -->

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>objSigNode</I></DT>

<DD>An XML DOM node corresponding to the <code class="ce">&lt;ds:Signature&gt;</code> element of the XML document.</dd>
</DL>

<H4 class="dtH4">Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>Getting or setting signature succeeded.</dd>

<DT>E_FAIL</DT>

<DD>Getting or setting signature failed.</dd>
</DL>

<H4 class="dtH4">Remarks</H4>

<P>Setting this property resets all the data previously assigned using the <code class="ce">setReferenceData</code> method, but does not have any side effects on cryptographic keys already created by the selected key creation method or by the <code class="ce">createSAXProxy</code> method.</P>

<P>After this property is set, you must not modify the XML data referenced to or embedded in the corresponding <code class="ce">&lt;ds:Signature&gt;</code> element until the data has been signed or verified. Otherwise, the outcome is not defined.</P>

<P>For both signing and verification, the <code class="ce">signature</code> property must meet certain requirements. The following topics provide tables that describe these requirements.

<UL type="disc">
	<LI><A HREF="dsig_ref_1ylj.htm">Signature Template Requirements for Signing</A></li>

	<LI><A HREF="dsig_ref_0432.htm">Signature Object Requirements for Verification</A></li>
</UL>

<H4 class="dtH4">Example</H4>

<P>This example illustrates how to get and set the <code class="ce">signature</code> property. The sample code performs the following tasks.

<OL type="1">
	<LI>Loads an XML signature template file, <B>signature_template.xml</B>, to a DOM object.</li>

	<LI>Assigns the <code class="ce">&lt;ds:signature&gt;</code> element selected from the loaded DOM object to the <code class="ce">sigature</code> property of an <code class="ce">MXDigitalSignature50</code> object.</li>

	<LI>Signs the data referenced in the signature template. This data is the text "Hello, World!" contained in a <code class="ce">&lt;ds:Object Id="objData"&gt;</code> element.</li>
</OL>

<P>The example uses a resource file, <B>signature_template.xml</B>. We've provided source files for the sample in three languages: JScript, Visual Basic, and C++. The output is the same from each language. 

<UL type="disc">
	<LI><A HREF="dsig_ref_5z51.htm">Resource Files</A></li>

	<LI><A HREF="dsig_ref_0sxf.htm">JScript Code (signature.js)</A></li>

	<LI><A HREF="dsig_ref_12st.htm">Visual Basic Code (signature.frm)</A></li>

	<LI><A HREF="dsig_ref_0t80.htm">C/C++ Code (signature.cpp)</A></li>

	<LI><A HREF="dsig_ref_0tkk.htm">Output for the signature Example</A></li>
</UL>

<H4 class="dtH4">Applies To</H4>

<P><A HREF="dsig_ref_499h.htm">IXMLDigitalSignature</A></P>

<H4 class="dtH4">Versioning</H4>

<P>MSXML 5.0 and later</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="dsig_ref_82t4.htm">IXMLDigitalSignatureEx</A> | <A HREF="dsig_ref2_0ey6.htm">sign Method</A> | <A HREF="dsig_ref2_61o9.htm">verify Method</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
