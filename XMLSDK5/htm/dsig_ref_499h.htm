<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>IXMLDigitalSignature</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - Digital Signatures</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xml_obj_ixmldigitalsignature"></A>IXMLDigitalSignature</H1>
<font face="verdana" color=red>[This feature was first implemented for MSXML 5.0.]</font>
<P>The <code class="ce">IXMLDigitalSignature</code> interface supports the following properties and methods to allow application developers to sign XML documents or verify signatures. </P>

<H4 class="dtH4">Properties</H4>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref_2hd1.htm">signature</A> </TD>
<TD width=50%>This read/write property allows you to get or set a signature template or object to be processed by the <code class="ce">IXMLDigitalSignature</code> object. </TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref_2okl.htm">store</A></TD>
<TD width=50%>This read/write property allows you to get or set a certificate store object.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">Methods</H4>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref_0tgw.htm">createKeyFromCSP</A></TD>
<TD width=50%>Retrieves a key handle from a key container within a specified cryptographic service provider (CSP). This key handle is used to access the private key used for signing or the public key for signature verification.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref_93xw.htm">createKeyFromHMACSecret</A></TD>
<TD width=50%>Extracts and returns a key handle from a base-64 encoded secret value used in the HMAC algorithm. This key handle is used to access a key that can be used for both signing and signature verification.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref_3tut.htm">createKeyFromNode</A></TD>
<TD width=50%>Creates and returns a key handle based on the information contained in the <code class="ce">&lt;ds:KeyInfo&gt;</code> element and its descendant elements (<code class="ce">&lt;ds:KeyInfo&gt;</code> is a child of a <code class="ce">&lt;ds:Signature&gt;</code> element). The key handle is used to access the key that is used for signature verification.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref_11fd.htm">createSAXProxy</A></TD>
<TD width=50%>Creates and returns a SAX proxy object. The <code class="ce">setReferenceData</code> method uses this object to assign a SAX stream as the new data source of the signature object or template.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref2_7xep.htm">setReferenceData</A></TD>
<TD width=50%>Assigns a new data source to a specified <code class="ce">&lt;ds:Reference&gt;</code> element in a signature object.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref2_0ey6.htm">sign</A></TD>
<TD width=50%>Signs data referenced in a <code class="ce">&lt;ds:Signature&gt;</code> element.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="dsig_ref2_61o9.htm">verify</A></TD>
<TD width=50%>Verifies the signature of data referenced in the <code class="ce">&lt;ds:Signature&gt;</code> element.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">Events</H4>

<P>None.</P>

<H4 class="dtH4">Remarks</H4>

<P>Using the <code class="ce">IXMLDigitalSignature</code> interface typically involves the following tasks.

<OL type="1">
	<LI>Create an XML DOM object, and load it with a digital signature as represented by a <code class="ce">&lt;ds:Signature&gt;</code> element belonging to the <code class="ce">http://www.w3.org/2000/09/xmldsig#</code> namespace. </li>

	<LI>Create an <code class="ce">IXMLDigitalSignature</code> object, and assign the XML DOM object to its <code class="ce">signature</code> property.</li>

	<LI>Optionally call <code class="ce">setReferenceData</code>, and possibly <code class="ce">createSAXProxy</code>, to set or replace the data source referenced in the signature object.</li>

	<LI>Create a cryptographic key using one of the key creation methods. See <A HREF="dsig_ref_70tv.htm">XML Digital Signature Methods</A> for more information. </li>

	<LI>Call <code class="ce">sign</code> or <code class="ce">verify</code> on the <code class="ce">IXMLDigitalSignature</code> object to process the signature on the XML document or fragment. </li>

	<LI>Optionally call <code class="ce">setReferenceData</code> to assign a different data source on the signature object, and repeat Step 5 to sign or verify the new data with the existing signature information.</li>
</OL>

<P>The implementation of the <code class="ce">IXMLDigitalSignature</code> interface conforms to the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8066">XML-Signature Syntax and Processing W3C Recommendation 12 February 2002</A>. </P>

<H4 class="dtH4">Requirements</H4>

<P><B>Implementation:</B> msxml5.dll</P>
<div class=filtered><span class="lang">[C/C++]</span>

<P><B>Header and IDL files:</B> msxml2.h, msxml2.idl</P>
</div><!-- [C/C++] -->

<P><B>Version-Dependent ProgID:</B> Msxml2.MXDigitalSignature.5.0</P>

<P><B>Version-Dependent CLSID:</B> 88d969e5-f192-11d4-a65f-0040963251e5, "MXDigitalSignature50"</P>

<H4 class="dtH4">Versioning</H4>

<P>MSXML 5.0 and later</P>

<P>To view reference information for Visual Basic, C/C++, or Script only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="dsig_ref_0svt.htm">IXMLDSigKey</A> </P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
