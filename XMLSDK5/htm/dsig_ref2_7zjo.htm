<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Output</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - Digital Signatures</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="dsigexamples_setref_output"></A>Output</H1>

<P>When you build and run the <B>setRef</B> code, you should get an output similar to the following. There will be differences in the key information, and therefore in the final signature values and digest values.</P>

<P>Notice that in the output the signature values and digest values are different for "obj1" and "obj2".</P>

<PRE class="code">Attempting to sign the object of 'obj1'

The specified data was signed successfully.
Resultant signature:

&lt;?xml version="1.0"?&gt;
&lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;ds:SignedInfo&gt;
    &lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n
-20010315"/&gt;
    &lt;ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;

    &lt;ds:Reference URI="#obj2" Type="http://www.w3.org/2000/09/xmldsig#;Object"&gt;
      &lt;ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
      &lt;ds:DigestValue&gt;TjR4fN1q3zgKhIrr/o7iY/la22A=&lt;/ds:DigestValue&gt;
    &lt;/ds:Reference&gt;
  &lt;/ds:SignedInfo&gt;
  &lt;ds:SignatureValue&gt;
    lcP+UrGnWPb9b61Ny4zJmeQnzkkbOt+g+UsEXLBOaebFD38PTOKQ5YFJ8udOBtbRSsEThFia
    PbSSvzk9Hjv0udabuMkSI5EJLtM/clrvFO08XZxcNJ7c+j/eH0GnlAOgSimCVN3GquENFpss
    k39o6JUG50R/KAoJ4B5NhCJlGUk=
  &lt;/ds:SignatureValue&gt;
  &lt;ds:Object Id="obj1" MimeType="text/plain"&gt;Hello, World!&lt;/ds:Object&gt;
  &lt;ds:Object Id="obj2"&gt;Hi, everyone!&lt;/ds:Object&gt;
&lt;KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
&lt;KeyValue&gt;
&lt;RSAKeyValue&gt;
&lt;Modulus&gt;
yQAHaJRtZledINO8A88UbmCE38cUnIi5TbqSAkH0jL8xghT45FNM+MmR5YVdfSNKqn8eeH06
HYEQxjpw007Ai+o7ZO8K3UWcYSUmSyTPF1cVdfj6VkiN0AU3BVEA3GKBnccTd2wjRb/p3CXo
puhNlmJwSZKL7sWifHqGZrOqar0=
&lt;/Modulus&gt;
&lt;Exponent&gt;AQAB&lt;/Exponent&gt;
&lt;/RSAKeyValue&gt;
&lt;/KeyValue&gt;
&lt;/KeyInfo&gt;
&lt;/ds:Signature&gt;

Signature verified on the data.
Attempting to sign the object of 'obj2'

The specified data was signed successfully.
Resultant signature:

&lt;?xml version="1.0"?&gt;
&lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;ds:SignedInfo&gt;
    &lt;ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n
-20010315"/&gt;
    &lt;ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;

    &lt;ds:Reference URI="#obj2" Type="http://www.w3.org/2000/09/xmldsig#;Object"&gt;
      &lt;ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
      &lt;ds:DigestValue&gt;UDmNPz5eONRovrmzaXoZ2vm5YJs=&lt;/ds:DigestValue&gt;
    &lt;/ds:Reference&gt;
  &lt;/ds:SignedInfo&gt;
  &lt;ds:SignatureValue&gt;
    FcFn47QoREOwzd34S3qkhGYbp7cIMBagwp8+VurTK+ImUX9NjVRKiA02ps+2FRrd6Ixw2CpV
    ZuX1cvep9x91njy0ssWN/imkqKSEo08wlSX73hrWA5a6vedS/7+sisrkvnW+vY4BU6Y70CoR
    eztcH6ETMnBxwRafqKvwVtO+09Y=
  &lt;/ds:SignatureValue&gt;
  &lt;ds:Object Id="obj1" MimeType="text/plain"&gt;Hello, World!&lt;/ds:Object&gt;
  &lt;ds:Object Id="obj2"&gt;Hi, everyone!&lt;/ds:Object&gt;
&lt;KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;KeyValue&gt;
    &lt;RSAKeyValue&gt;
      &lt;Modulus&gt;
        yQAHaJRtZledINO8A88UbmCE38cUnIi5TbqSAkH0jL8xghT45FNM+MmR5YVdfSNKqn8eeH06

        HYEQxjpw007Ai+o7ZO8K3UWcYSUmSyTPF1cVdfj6VkiN0AU3BVEA3GKBnccTd2wjRb/p3CXo

        puhNlmJwSZKL7sWifHqGZrOqar0=
      &lt;/Modulus&gt;
      &lt;Exponent&gt;AQAB&lt;/Exponent&gt;
    &lt;/RSAKeyValue&gt;
  &lt;/KeyValue&gt;
&lt;/KeyInfo&gt;
&lt;/ds:Signature&gt;
</PRE>

<P>Signature verified on the data.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
