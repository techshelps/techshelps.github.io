<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Author XML Data Islands</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XML Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmtuttut3authoringdataislands"></A>Author XML Data Islands</H1>
<script SRC="domformatter2.js"></script>
<H2 class="dtH2">What is an XML data island?</H2>

<P>A data island is an XML document that exists within an HTML page. It allows you to script against the XML document without having to load it through script or through the <code class="ce">&lt;OBJECT&gt;</code> tag. Almost anything that can be in a well-formed XML document can be inside a data island.</P>

<P>The <code class="ce">&lt;XML&gt;</code> element marks the beginning of the data island, and its <code class="ce">ID</code> attribute provides a name that you can use to reference the data island.</P>

<P>The XML for a data island can be either inline:</P>

<PRE class="code">&lt;XML ID="XMLID"&gt;
  &lt;customer&gt;
    &lt;name&gt;Mark Hanson&lt;/name&gt;
    &lt;custID&gt;81422&lt;/custID&gt;
  &lt;/customer&gt;
&lt;/XML&gt;</PRE>

<P>or referenced through a <code class="ce">SRC</code> attribute on the <code class="ce">&lt;XML&gt;</code> tag:</P>

<PRE class="code">&lt;XML ID="XMLID" SRC="customer.xml"&gt;&lt;/XML&gt;</PRE>

<P>You can also use the <code class="ce">&lt;SCRIPT&gt;</code> tag to create a data island.</P>

<PRE class="code">&lt;SCRIPT LANGUAGE="xml" ID="XMLID"&gt;
  &lt;customer&gt;
    &lt;name&gt;Mark Hanson&lt;/name&gt;
    &lt;custID&gt;81422&lt;/custID&gt;
  &lt;/customer&gt;
&lt;/SCRIPT&gt;</PRE>

<H2 class="dtH2">Authoring guidelines</H2>

<P>Simply author an XML document, place that XML document within an <code class="ce">&lt;XML&gt;</code> element, and give that <code class="ce">&lt;XML&gt;</code> element an <code class="ce">ID</code> attribute.</P>

<H2 class="dtH2">Try it!</H2>

<P>In the following text box, type a well-formed XML document.</P>
<textarea STYLE="color:#8B0000" NAME="xmldata" ROWS="10" COLS="50"></textarea>
<P>Type an ID for the data island.</P>
<input STYLE="color:#8B0000" TYPE="TEXT" NAME="idName" onkeypress="checkPress(xmldata.value)"><br><br>
<P>Click the <B>Insert Data Island</B> button to display an HTML page with your data island inserted.</P>
<input style="background-color:#66CCFF" TYPE="BUTTON" NAME="INSERTBUTTON" VALUE="Insert Data Island" ONCLICK="processIsland(xmldata.value)"><script SRC="utilityfuncs.js"></script><script LANGUAGE="JavaScript">	function processIsland(island)		{		if(msieversion() >= 5)		{	    if (xmldata.value != "")			{				xmlid.loadXML(xmldata.value);				if (xmlid.parseError.reason != "")					alert("Your XML data island is malformed.\n" +xmlid.parseError.reason + "\n" + "Please reenter the data island and try again.");				else if (idName.value == "")					alert("You must enter an ID for your data island.");				else			    ShowDI(xmlid, idName.value, xslid);			}			else alert ("Please enter an XML data island into the text box.");		} else				versionerror();		}	function checkPress(xml)	{		if (event.keyCode == 13 && event.srcElement.name == "idName")		{			processIsland(xml);			event.keyCode = 0;		}	}</script><xml id="xslid" src="raw-xml.xsl"></xml><xml id="xmlid"></xml><H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
