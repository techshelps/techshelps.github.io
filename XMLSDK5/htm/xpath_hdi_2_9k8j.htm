<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Navigating Along the ancestor Axis</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconnavigatingalongtheancestoraxis"></A>Navigating Along the ancestor Axis</H1>

<P>The <code class="ce">ancestor::</code> axis locates all nodes in the document hierarchy above the context node. It locates the parent of the context node, the parent's parent, and so on up to the root node. The root node is an ancestor of all other nodes in the document, and itself has no ancestors.</P>

<P>Because <code class="ce">ancestor::</code> extends <code class="ce">the parent::</code> axis all the way back through the document tree, all limitations and effects of the <code class="ce">parent::</code> axis apply to the <code class="ce">ancestor::</code> axis as well.</P>

<P>If you wanted to show the names of all employees along the ancestor axis of the employee whose name is Peter Porzuczek&#0151;that is, all of Peter Porzuczek's supervisors&#0151;you could use the sample XSLT template rule below.</P>

<P>The ancestors are retrieved in reverse document order. That is, the ancestor closest to context node is displayed first, followed by that ancestor's parent, followed by its parent's parent.</P>

<H4 class="dtH4">Example</H4>

<P class="label"><B>XML File (orgchart.xml)</B></P>

<P>Use orgchart.xml (in <A HREF="xpath_hdi_2_4ldf.htm">Sample XML File for Navigating XPath Axes</A>) and edit its <code class="ce">href</code> attribute to refer to <B>orgchart-ancestor.xsl</B>.</P>

<P class="label"><B>XSLT File (orgchart-ancestor.xsl)</B></P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"&gt;
&lt;!-- suppress text nodes not covered in subsequent template rule --&gt;
&lt;xsl:template match="text()"/&gt;

&lt;xsl:template match="*[name='Peter Porzuczek']"&gt;
    &lt;h2&gt;Peter Porzuczek's superiors:&lt;/h2&gt;
        &lt;xsl:for-each select="<code><b class="cfe">ancestor::*</b></code>"&gt;
            &lt;h4&gt;&lt;xsl:value-of select="name"/&gt;&lt;/h4&gt;
        &lt;/xsl:for-each&gt;
&lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</PRE>

<P class="label"><B>Formatted Output</B></P>

<P class="fig"><IMG SRC="xsltorgchart-ancestor.gif" ALT="" BORDER=0></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_hdi_2_2d9v.htm">Navigating Along the parent Axis</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
