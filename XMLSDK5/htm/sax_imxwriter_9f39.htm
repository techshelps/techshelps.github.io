<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IMXWriter Interface</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - SAX2 Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="imxwriter_interface"></A>IMXWriter Interface</H1>

<P>The <code class="ce">IMXWriter</code> interface is a complementary application programming interface (API) to the latest version of the Simple API for XML (SAX2) implementation of Microsoft&reg; XML Core Services (MSXML) 5.0 for Microsoft Office. MSXML provides two CoClasses that implement <code class="ce">IMXWriter</code>.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>CoClass</TH>
<TH width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="sax_mxxmlwriter_0m5v.htm">MXXMLWriter</A></TD>
<TD width=50%>Generates XML or DOM output.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="sax_mxhtmlwriter_11rn.htm">MXHTMLWriter</A></TD>
<TD width=50%>Generates HTML output.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>The following can be set as output for <code class="ce">IMXWriter</code>:

<UL type="disc">
	<LI>Any implementation of the <code class="ce">IStream</code> interface. (The resulting document will be written into the provided <code class="ce">IStream</code>.)</li>

	<LI>A string.</li>

	<LI>A <code class="ce">DOMDocument</code> object.
<P>For more information about setting the <code class="ce">output</code> property to a <code class="ce">DOMDocument</code> object, see <A HREF="sax_devgd_hdi_saxtodom_6q2c.htm">Create a DOMDocument Object from SAX Events</A>.
</li>
</UL>

<P><code class="ce">IMXWriter</code> also enables you to:

<UL type="disc">
	<LI>control the output of a document by setting properties, such as <code class="ce">omitXMLDeclaration</code>, <code class="ce">indent</code>, and <code class="ce">encoding</code>.</li>

	<LI>generate XML or HTML content by invoking methods of the <code class="ce">ISAXContentHandler</code>, <code class="ce">ISAXDTDHandler</code>, <code class="ce">ISAXDeclHandler</code>, and <code class="ce">ISAXLexicalHandler</code> interfaces.
<BLOCKQUOTE class="dtBlock">
<b class="le">Important</b>&nbsp;&nbsp;&nbsp;The <code class="ce">IMXWriter</code> interface implements the <code class="ce">ISAXContentHandler</code>, <code class="ce">ISAXDTDHandler</code>, <code class="ce">ISAXErrorHandler</code>, <code class="ce">ISAXDeclHandler</code>, and <code class="ce">ISAXLexicalHandler</code> interfaces. However, to enable the writer to catch handler events passed by <code class="ce">SAXXMLReader</code>, you must set the writer<B> </B>as the <code class="ce">ContentHandler</code>, and, optionally, as any of the other handlers. For more information about how to set a writer as a handler, see <A HREF="sax_devgd_hdi_usemxxmlwriter_00of.htm">Use MXXMLWriter</A>.</BLOCKQUOTE>
</li>
</UL>

<P>Ideally, a writer<B> </B>connected to <code class="ce">SAXXMLReader</code> produces the same document as provided on the input. However, the writer may miss content deemed ignorable by XML 1.0 specifications or may output in a different encoding. For example, national encoding can be replaced with Unicode Transformation Format (UTF-8 or UTF-16). Replacing the encoding becomes useful if you use a custom <code class="ce">SAXXMLFilter</code> between <code class="ce">SAXXMLReader</code> and the writer.</P>

<P><code class="ce">IMXWriter</code> uses the generous input approach, which means it outputs what is entered. It is the responsibility of the application to ensure that SAX events and parameters match those of a well-formed or valid XML document.</P>

<H4 class="dtH4">Properties</H4>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_3055.htm">byteOrderMark</A></TD>
<TD width=70%>Determines whether to write the Byte Order Mark (BOM). The <code class="ce">byteOrderMark</code> property has no effect for BSTR or DOM output.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_7j3t.htm">disableOutputEscaping</A></TD>
<TD width=70%>Matches the <code class="ce">disable-output-escaping</code> attribute of the <code class="ce">&lt;xsl:text&gt;</code> and <code class="ce">&lt;xsl:value-of&gt;</code> elements. When set to True, special symbols such as "&amp;" are passed through literally.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_4gah.htm">encoding</A></TD>
<TD width=70%>Sets and gets encoding for the output.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_3mk9.htm">indent</A></TD>
<TD width=70%>Sets whether to indent output.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_5dkp.htm">omitXMLDeclaration</A></TD>
<TD width=70%>Forces the <code class="ce">IMXWriter</code> to skip the XML declaration. Useful for creating document fragments.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_8ant.htm">output</A></TD>
<TD width=70%>Sets the destination and the type of output for <code class="ce">IMXWriter</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_8po9.htm">standalone</A></TD>
<TD width=70%>Sets the value of the <code class="ce">standalone</code> attribute in the XML declaration to "yes" or "no".</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_7omx.htm">version</A></TD>
<TD width=70%>Specifies the version to include in XML declarations.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">Methods</H4>

<P>In addition to the preceding properties, the following method also applies to the <code class="ce">IMXWriter</code> interface.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TD width=30%><A HREF="sax_imxwriter_1vs4.htm">flush</A></TD>
<TD width=70%>Flushes the object's internal buffer to its destination IStream/string. The <code class="ce">flush</code> method has no effect for DOM output.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">Versioning</H4>

<P>MSXML 3.0 and later</P>

<H4 class="dtH4">Requirements</H4>
<div class=filtered><span class="lang">[Visual Basic, C/C++]</span>

<P><B>Implementation:</B> msxml5.dll, msxml2.lib</P>
</div><!-- [Visual Basic, C/C++] -->
<div class=filtered><span class="lang">[C/C++]</span>

<P><B>Header and LIB files:</B> msxml2.h, msxml2.lib</P>
</div><!-- [C/C++] -->

<P><B>Version 5.0 Dependent ProgID:</B> msxml2.MXXMLWriter50</P>

<P><B>Version 4.0 Dependent CLSID:</B> 88d969c8-f192-11d4-a65f-0040963251e5</P>

<P><B>Version 5.0 Dependent ProgID:</B> msxml2.MXHTMLWriter50</P>

<P><B>Version 4.0 Dependent CLSID:</B> 88d969c9-f192-11d4-a65f-0040963251e5</P>

<P>To view reference information for Visual Basic or C/C++ only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
