<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Patterns</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconpatterns"></A>Patterns</H1>

<P>A <I>pattern</I> is a type of expression that returns a set of nodes based on a set of conditions for a node. Nodes that satisfy the conditions match the pattern. The syntax for patterns is a subset of the syntax for expressions. In particular, location paths that meet certain restrictions can be used as patterns. An expression that is also a pattern always evaluates to an object of type node-set. A node matches a pattern if the node is a member of the result of evaluating the pattern as an expression with respect to some possible context; the possible contexts are those whose context node is the node being matched or one of its ancestors.</P>

<P>The following table lists examples of patterns.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Pattern</TH>
<TH width=50%>Matches</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">Para</code></TD>
<TD width=50%>any <code class="ce">para</code> element</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">*</code></TD>
<TD width=50%>any element</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">chapter|appendix</code></TD>
<TD width=50%>any <code class="ce">chapter</code> element and any <code class="ce">appendix</code> element</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">olist/item</code></TD>
<TD width=50%>any <code class="ce">item</code> element with an <code class="ce">olist</code> parent</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">appendix//para</code></TD>
<TD width=50%>any <code class="ce">para</code> element with an <code class="ce">appendix</code> ancestor element</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">/</code></TD>
<TD width=50%>the root node</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">text()</code></TD>
<TD width=50%>any text node</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">processing-instruction()</code></TD>
<TD width=50%>any processing instruction</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">node()</code></TD>
<TD width=50%>any node other than an attribute node and the root node</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">id("W11")</code></TD>
<TD width=50%>the element with unique ID <code class="ce">W11</code></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">para[1]</code></TD>
<TD width=50%>any <code class="ce">para</code> element that is the first <code class="ce">para</code> child element of its parent</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">*[position()=1 and self::para]</code></TD>
<TD width=50%>any <code class="ce">para</code> element that is the first child element of its parent</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">para[last()=1]</code></TD>
<TD width=50%>any <code class="ce">para</code> element that is the only <code class="ce">para</code> child element of its parent</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">items/item[position()&amp;gt;1]</code></TD>
<TD width=50%>any <code class="ce">item</code> element that has an <code class="ce">items</code> parent and that is not the first <code class="ce">item</code> child of its parent</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">item[position() mod 2 = 1]</code></TD>
<TD width=50%>any <code class="ce">item</code> element that is an odd-numbered <code class="ce">item</code> child of its parent</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">div[@class="appendix"]//p</code></TD>
<TD width=50%>any <code class="ce">p</code> element with a <code class="ce">div</code> ancestor element that has a <code class="ce">class</code> attribute with value <code class="ce">appendix</code></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">@class</code></TD>
<TD width=50%>any <code class="ce">class</code> attribute (<I>not</I> any element that has a <code class="ce">class</code> attribute)</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">@*</code></TD>
<TD width=50%>any attribute</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_syntax2_3jw3.htm">Location Paths</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
