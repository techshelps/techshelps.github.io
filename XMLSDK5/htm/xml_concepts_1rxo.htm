<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Character Encoding, XML, and MSXML</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XML Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconcharacterencodingxmlandmsxml"></A>Character Encoding, XML, and MSXML</H1>

<P>Character encodings provide a map between a series of numbers and the characters people expect to see when they enter text into computers. The capital letter "A", for example, is represented by the decimal number 65 (41 in hexadecimal) in a variety of character encodings, including the ASCII text familiar to many Western programmers and Windows Code Page-1252, the default encoding used by most Microsoft&reg; Windows&reg; Western systems.</P>

<P>Character encodings are not fonts, which provide graphic representations, glyphs, that map to a particular character encoding. Microsoft Word, for example, includes a version of Arial (Arial Unicode MS) with tens of thousands of characters.</P>

<P>All XML processors are required to understand two transformations of the Unicode character encoding, UTF-8 and UTF-16. Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office supports more encodings, but all text in XML documents is treated internally as the Unicode UCS-2 character encoding.</P>

<P>Even different platforms representing the same set of Western characters can use different bytes to represent the same character, as shown in the following table.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=15%>Byte</TH>
<TH width=27%>Windows<BR>
(CP1252)</TH>
<TH width=58%>Macintosh<BR>
(MacRoman)</TH>
</TR>

<TR VALIGN="top">
<TD width=15%>140</TD>
<TD width=27%>Œ</TD>
<TD width=58%>å</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>229</TD>
<TD width=27%>å</TD>
<TD width=58%>Â</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>231</TD>
<TD width=27%>ç</TD>
<TD width=58%>Á</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>232</TD>
<TD width=27%>è</TD>
<TD width=58%>Ë</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>233</TD>
<TD width=27%>é</TD>
<TD width=58%>È</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>Parsers can read in documents written ISO-8859-1, Big-5, or Shift-JIS, but the processing rules treat everything as Unicode. MSXML and other XML parsers perform the conversion while loading XML documents.</P>

<P>There are some limitations to auto-detecting character encodings. For example, 8-bit ASCII text is acceptable UTF-8, but UTF-8 is more than 8-bit ASCII text. For reliable processing, XML documents that use character encodings other than UTF-8 or UTF-16 must include an encoding declaration in the XML declaration. This makes it possible for a parser to read the characters correctly or report errors when it cannot process an encoding.</P>

<P>Because the XML declaration is written in basic ASCII text, parsers can read its contents even if the document is in a very different encoding. The encoding declaration significantly increases the likelihood that documents in encodings other than UTF-8 and UTF-16 will be interpreted correctly.</P>

<P>Some transactions, for example, those carried over HTTP and e-mail protocols, also provide information about character encodings. Microsoft Internet Explorer uses that information in document processing, but it isn't available, for example, if you load an XML document from a local hard drive or even a file server.</P>

<H2 class="dtH2">XML Data Islands and Character Encodings</H2>

<P>XML data islands inside of HTML documents receive different encoding handling, depending on whether the content is stored directly within the <code class="ce">&lt;xml&gt;</code> element or referenced by a <code class="ce">SRC</code> attribute.</P>

<P>XML data islands that contain the XML directly in the HTML document use the encoding of the surrounding HTML document. Because the entire document is assumed to use the same encoding, this approach significantly simplifies parsing.</P>

<P>XML data islands that reference the content through a <code class="ce">SRC</code> attribute are less constrained. The XML documents they reference can have an XML declaration containing a character encoding, and MSXML will use that character encoding. The contents of the data island will be presented as Unicode, but the parser will handle the conversion automatically.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_concepts_00xa.htm">XML Declaration</A></P>

<H4 class="dtH4">Other Resources <IMG SRC="leave-ms.gif" ALT="Other Resources" BORDER=0></H4>

<P><A HREF="http://go.microsoft.com/fwlink/?LinkId=5925">How To Encode XML Data</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
