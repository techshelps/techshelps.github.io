<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Predicates</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmrefpredicates"></A>Predicates</H1>

<P>A predicate is an XPath expression that filters a node-set with respect to an axis and produces a new node-set. This filtering process involves sequentially evaluating the predicate against each node in the node set. Each time that the predicate is evaluated against a node:

<UL type="disc">
	<LI>The context node is the node currently being evaluated.</li>

	<LI>The context size is the number of nodes in the node-set being evaluated.</li>

	<LI>The context position is the position of the context node in the node-set.</li>
</UL>

<P>This last context, that of the context node in the node-set, is relative to the direction that the axis specified in the location step navigates the document tree. Typically, an axis navigates the tree in either a forward or reverse direction:

<UL type="disc">
	<LI>A forward axis is an axis that contains the context node or nodes that are after the context node. The <code class="ce">child::</code>, <code class="ce">descendant::</code>, <code class="ce">descendant-or-self::</code>, <code class="ce">following::</code>, and <code class="ce">following-sibling::</code> axes are forward axes. These forward axes number the nodes in the node-set in document order, starting with the first position as 1.</li>

	<LI>A reverse axis is an axis that contains the context node or nodes that are before the context node. The <code class="ce">ancestor::</code>, <code class="ce">ancestor-or-self::</code>, <code class="ce">preceding::</code>, and <code class="ce">preceding-sibling::</code> axes are reverse axes. These reverse axes number the nodes in the node-set in reverse document order, starting with the first position as 1.</li>
</UL>

<P>As to the remaining axes, the <code class="ce">self::</code> and <code class="ce">parent::</code> axes return a single node. Therefore, the designation of forward or reverse does not make sense for these two axes. There is no order defined for the <code class="ce">attribute::</code> and <code class="ce">namespaces::</code> axes; so they too are neither forward nor reverse axes.</P>

<H2 class="dtH2">Selecting the Nodes</H2>

<P>A predicate expression evaluates to either a numeric or Boolean value.</P>

<P>If the predicate results in a number, XPath compares that number to the context position of the context node. If the number and the position are the same (that is, the context node is in the appropriate position in the tree), the predicate evaluates to true and the context node is included in the new node-set. Otherwise, the context node is excluded from the new node-set.</P>

<P>If the predicate does not result in a number, XPath uses the <code class="ce">boolean</code> function to convert the result to a Boolean value. For example, the predicate <code class="ce">[genre='Computer']</code> results in a node-set. If the context node has a child <code class="ce">&lt;genre&gt;</code> element with the content <code class="ce">Computer</code>, this predicate evaluates to true and the context node is included in the new node-set. Otherwise, the context node is excluded from the new node-set.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;A numeric predicate [x] is equivalent to the Boolean predicate <code class="ce">[position()=x]</code>.</BLOCKQUOTE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_syntax2_7s6r.htm">Location Steps</A> | <A HREF="xpath_syntax2_6tv7.htm">Axes</A> | <A HREF="xpath_syntax2_42gj.htm">Node Tests</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
