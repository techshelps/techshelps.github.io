<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Frequently Asked Questions about the SOM</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - SOM Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="som_faq"></A>Frequently Asked Questions about the SOM</H1>

<P>The following are some frequently asked questions about the SOM.

<UL type="disc">
	<LI><A HREF="#som_faq_schemaobjectthaticanquery">How do I get a schema object that I can query?</A></li>

	<LI><A HREF="#som_faq_schemacacheusedfor">What is the schema cache used for?</A></li>

	<LI><A HREF="#som_faq_schemaversiondoesthesomuse">What schema version does the SOM use?</A></li>

	<LI><A HREF="#som_faq_w3chavetodowiththesom">What does the W3C have to do with the SOM?</A></li>

	<LI><A HREF="#som_faq_domworkwiththesom">How does the DOM work with the SOM?</A></li>

	<LI><A HREF="#som_faq_saxworkwiththesom">How does SAX work with the SOM?</A></li>

	<LI><A HREF="#som_faq_itemcollectionusedfor">What is an item collection used for?</A></li>

	<LI><A HREF="#som_faq_apartmentmodel">Does the SOM support the multi-thread apartment model?</A></li>

	<LI><A HREF="#som_faq_getdeclaration">How has the getDeclaration method changed in MSXML 4.0 and later?</A></li>
</UL>



<H4 class="dtH4"><A NAME="som_faq_schemaobjectthaticanquery"></A>How do I get a schema object that I can query?</H4>

<P>You obtain a schema object from a schema cache. The schema cache is created with the <A HREF="xml_obj_ixmldomschemacollection2_6saa.htm">IXMLDOMSchemaCollection2</A> interface. For more information, see <A HREF="som_concepts_5ti9.htm">Loading a Schema for Use with the ISchema Interface</A>, and the <A HREF="xml_obj_ischema_0sv5.htm">ISchema</A> interface reference topic.</P>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_schemacacheusedfor"></A>What is the schema cache used for?</H4>

<P>The schema cache is an object created with the <A HREF="xml_obj_ixmldomschemacollection2_6saa.htm">IXMLDOMSchemaCollection2</A> interface. The schema cache stores XML Schema documents according to an associated target namespace. The target namespace must be unique for each XML Schema in the cache. </P>

<P>The schema cache was designed to support two types of use. First, it was designed to improve performance through schema caching. This can significantly reduce the overhead when using external schemas for validation.  Secondly, it can be used to override schemas referenced or included inline.</P>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_schemaversiondoesthesomuse"></A>What schema version does the SOM use?</H4>

<P>The SOM uses the XML Schema definition language (XSD) as its schema platform. The W3C recommendation for the XML Schema is found at http://www.w3.org/2001/XMLSchema#intro. This recommendation includes a link to http://www.w3.org/2001/XMLSchema.xsd, the XML Schema that is used to validate XML Schema elements, attributes, and data types.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xsd_ref_7gh1.htm">XML Schema Reference (XSD)</A></P>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_w3chavetodowiththesom"></A>What does the W3C have to do with the SOM?</H4>

<P>The SOM conforms to the W3C specifications, which are available at the Web site www.w3.org/TR/xmlschema-0/. SOM interfaces are created from the schema component definitions. For an example of the definitions for an element, see the specifications document, at URL http://www.w3.org/TR/xmlschema-1/#Element_Declaration_details.</P>

<P>The rest of the definitions can be found throughout the specifications document.</P>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_domworkwiththesom"></A>How does the DOM work with the SOM?</H4>

<P>The DOM has two methods that return a schema object. The first is the <A HREF="xml_mth_dg_4tke.htm">getDeclaration</A> method of the <A HREF="xml_obj_ixmldomschemacollection2_6saa.htm">IXMLDOMSchemaCollection2</A> interface. The second is the <A HREF="xml_mth_dg_2krl.htm">getSchema</A> method of the <A HREF="xml_obj_ixmldomschemacollection2_6saa.htm">IXMLDOMSchemaCollection2</A> interface. For more information, see <A HREF="som_concepts_9r59.htm">Using the DOM with the SOM</A>.</P>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_saxworkwiththesom"></A>How does SAX work with the SOM?</H4>

<P>SAX has two functions that return a schema object. The first is the <A HREF="sax_imxschemadeclhandler_5d44.htm">schemaElementDecl</A> method of the <A HREF="sax_imxschemadeclhandler_9rj9.htm">IMXSchemaDeclHandler</A> interface. The second is the <A HREF="sax_isaxattributes_3des.htm">getTypeFromName</A> method of the <A HREF="sax_isaxattributes_07fp.htm">ISAXAttributes</A> interface. For more information, see <A HREF="som_concepts_15il.htm">Using SAX with the SOM</A>.</P>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_itemcollectionusedfor"></A>What is an item collection used for?</H4>

<P>An item collection is used throughout the SOM for object storage. Many of the interface functions return item collections that contain an array of specific or mixed objects. The item collection is indexed, and begins with the index of zero. The objects returned in the collection implement their specified interface when they are queried individually. Use the <A HREF="xml_obj_ischemaitem_02jp.htm">itemType</A> property of the <A HREF="xml_obj_ischemaitem_0w8d.htm">ISchemaItem</A> interface to get the type of the items in the collection.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_obj_ischemaitemcollection_3kxa.htm">ISchema Item Collection Interface</A></P>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_apartmentmodel"></A>Does the SOM support the multi-thread apartment model?</H4>

<P>Yes, the SOM does support the multi-thread apartment model. You can marshal between rental mode and free threaded model in your application.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>  In MSXML, "free-threaded" means <code class="ce">ThreadingModel='Both'</code>, and cross-thread marshalling is supported.</BLOCKQUOTE>

<BLOCKQUOTE class="dtBlock">
</BLOCKQUOTE>

<P><A HREF="#som_faq">Return to Top</A></P>



<H4 class="dtH4"><A NAME="som_faq_getdeclaration"></A>How has the getDeclaration method changed in MSXML 4.0 and later?</H4>

<P>In MSXML 4.0 Beta 2, the <code class="ce">getDeclaration</code> method was called using an <code class="ce">XMLSchemaCache</code> object. Because of some inconsistencies related to this design, the <code class="ce">getDeclaration</code> call was changed for MSXML 4.0 final release.</P>

<P>The following Visual Basic example shows the syntax used in MSXML 4.0 Beta 2 to make the <code class="ce">getDeclaration</code> method call.</P>

<PRE class="code">set oSchemaCache = CreateObject("Msxml2.XMLSchemaCache.5.0")
nsTarget="http://www.example.microsoft.com/po"
oSchemaCache.add nsTarget, "po.xsd"
set oDoc = CreateObject("Msxml2.DOMDocument.5.0")
oDoc.async = false
oDoc.load "po.xml"
oDoc.setProperty "SelectionLanguage", "XPath"
Set oDecl = oSchemaCache.getDeclaration(oNode)</PRE>

<P>In this design, the appropriate schema was only looked for using the <code class="ce">XMLSchemaCache</code> object, ignoring the possibility that the information returned might not have any relationship to the actual schema information used in document validation or default attribute lookup.</P>

<P>For the final 4.0 release and later versions, the <code class="ce">getDeclaration</code> method has been changed in the following ways:

<OL type="1">
	<LI>For the <code class="ce">XMLSchemaCache</code> object, the <code class="ce">getDeclaration</code> method will now return a result of "E_NOTIMPL", indicating it is not implemented.</li>

	<LI>The <code class="ce">getDeclaration</code> method is still part of the <code class="ce">IXMLDOMSchemaCollection2</code> interface, but will return "E_NOTIMPL" when called from the <code class="ce">IXMLDOMSchemaCollection</code> interface.</li>

	<LI>The <code class="ce">getDeclaration</code> method is now implemented through the <code class="ce">namespaces</code> property of the <code class="ce">DOMDocument2</code> object. </li>

	<LI>The <code class="ce">getDeclaration</code> method has also been modified to include the declarations of XML schemas used by the associated document. This provides access to XML schemas loaded using <code class="ce">xsi:schemaLocation</code>, as well as XML schemas loaded from a schema cache object.</li>
</OL>

<P>The following modified example contains the syntax used to get a declaration in MSXML 5.0.</P>

<PRE class="code">set oDoc = CreateObject("Msxml2.DOMDocument.5.0")
oDoc.async = false
oDoc.load "po.xml"
' Retrieve the declaration for country attribute of the shipTo element.
Set oDecl = oDoc.namespaces.getDeclaration(oDoc.documentElement)
WScript.Echo oDecl.namespaceURI</PRE>

<P><A HREF="#som_faq">Return to Top</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
