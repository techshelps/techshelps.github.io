<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sorting by Two Columns</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XSLT Developer's Guide</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconsortingbytwocolumns"></A>Sorting by Two Columns</H1>

<P>The above example makes it much easier to locate products of a particular category. However, within each category, products are still listed in the order in which they appear in the original document. To make finding products even easier, you might want to sort product names within each category. To do so, you can add a second sort level to the first, by adding a second <code class="ce">&lt;xsl:sort&gt;</code> element.</P>

<H4 class="dtH4">Example</H4>

<P>In the formatted output, note that within the Craftware category, the products are now listed by alphabetical order.</P>

<P class="label"><B>XML File (prodsort.xml)</B></P>

<P>Use <B>prodsort.xml</B>, in <A HREF="xsl_advanced1_6llz.htm">Sample XML Data File for XSLT Sorting</A>. Change the <code class="ce">href</code> attribute to reference <B>prodsort2.xsl</B>.</P>

<P class="label"><B>XSLT File (prodsort2.xsl)</B></P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;xsl:stylesheet version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;

&lt;xsl:template match="/"&gt;
   &lt;HTML&gt;
      &lt;HEAD&gt;
         &lt;TITLE&gt;Wooden Rings and More!&lt;/TITLE&gt;
         &lt;STYLE type="text/css"&gt;
            th {background-color: silver;
               font-family: Tahoma,Verdana,Arial,sans-serif}
            td {background-color: white;
               font-family: Tahoma,Verdana,Arial,sans-serif}
         &lt;/STYLE&gt;
      &lt;/HEAD&gt;
      &lt;BODY&gt;
         &lt;xsl:apply-templates/&gt;
      &lt;/BODY&gt;
   &lt;/HTML&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="products"&gt;
    &lt;TABLE width="75%"&gt;
        &lt;tr&gt;
            &lt;th&gt;Category&lt;/th&gt;
            &lt;th&gt;Prod ID&lt;/th&gt;
            &lt;th&gt;Name/Version&lt;/th&gt;
            &lt;th&gt;Description&lt;/th&gt;
            &lt;th&gt;Price/Units&lt;/th&gt;
        &lt;/tr&gt;
<code><b class="cfe">        </b></code>&lt;xsl:apply-templates&gt;
<code><b class="cfe">        </b></code>    &lt;xsl:sort select="categ"/&gt;
<code><b class="cfe">            &lt;xsl:sort select="name"/&gt;</b></code>
<code><b class="cfe">        </b></code>&lt;/xsl:apply-templates&gt;
    &lt;/TABLE&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="product"&gt;
   &lt;tr&gt;
      &lt;td valign="top"&gt;&lt;xsl:value-of select="categ"/&gt;&lt;/td&gt;
      &lt;td valign="top"&gt;&lt;xsl:value-of select="@prodID"/&gt;&lt;/td&gt;
      &lt;td valign="top"&gt;&lt;xsl:value-of select="concat(name, '/', version)"/&gt;&lt;/td&gt;
      &lt;td valign="top"&gt;&lt;xsl:value-of select="descr"/&gt;&lt;/td&gt;
      &lt;td valign="top" align="center"&gt;&lt;xsl:value-of select="concat(price, ' (', price/@curr, ')')"/&gt;&lt;/td&gt;
   &lt;/tr&gt;
&lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</PRE>

<P class="label"><B>Formatted Output</B></P>

<P class="fig"><IMG SRC="xsltprodsort2.gif" ALT="" BORDER=0></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
