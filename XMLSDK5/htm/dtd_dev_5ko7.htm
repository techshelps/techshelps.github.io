<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Declaring DTDs</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XML Schemas</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmcondtd_declaring"></A>Declaring DTDs</H1>

<P>The World Wide Web Consortium (W3C) XML 1.0 specification specifies the use of document type definitions (DTDs) with XML documents. Although a document must be well formed in order to be fully and successfully parsed, not all XML parsers validate XML against a DTD or schema.</P>

<P>To use a DTD with an XML document, you need to first declare it in the <A HREF="sdk_glossary_8qyh.htm#glo_document_type_declaration">document type declaration</A> statement. To do so, you can use either of the following methods, separately or in combination:

<UL type="disc">
	<LI>Insert the markup declarations that make up the DTD as part of the document type declaration.</li>

	<LI>Declare the location of a file through a <I>URI reference</I> that points to an external file, typically a text file named using the .dtd file extension.</li>
</UL>

<P>For more information about declaring DTDs, see <A HREF="xml_concepts_8tda.htm">DOCTYPE declaration</A>.</P>

<H2 class="dtH2">Declaring an External DTD for System Use</H2>

<P>To reference a personal external DTD, you need to provide a Web URL for the location of the DTD. For example, the following declares a document type called "catalog" with the DTD in a separate file (MyCatalog.dtd) published on an intranet server (MyServer).</P>

<PRE class="code">&lt;?xml version="1.0" standalone="no"?&gt;
&lt;!DOCTYPE catalog SYSTEM "http://MyServer/MyCatalog.dtd"&gt;</PRE>

<P>While the DTD might be available and downloaded to others located on the same local network, the <code class="ce">SYSTEM</code> keyword helps make it clear to the XML parser that the URL is the only method to use to locate the DTD. In this example, if the Web service on MyServer is offline, the DTD will not be found and the document cannot be validated when parsed.</P>

<P>If you are using or providing your DTD as a separate downloadable file that will be copied to the same local folder with your XML document, a simpler way to write the URI reference is just to include the file name, like this:</P>

<PRE class="code">&lt;!DOCTYPE catalog SYSTEM "MyCatalog.dtd"&gt;</PRE>

<P>Optionally, you can include path information to help Windows locate the external DTD file on either a local drive or a UNC file share, as in the following examples:</P>

<PRE class="code">&lt;!DOCTYPE catalog SYSTEM "C:\temp\MyCatalog.dtd"&gt;
&lt;!DOCTYPE catalog SYSTEM "\\MyServer\MyShare\MyCatalog.dtd"&gt;</PRE>

<H2 class="dtH2">Naming a Public External DTD</H2>

<P>If your DTD file is for use with XML documents that are published openly on the Internet, using a standard public naming convention will allow others to find and locate the file. To reference a public external DTD, you typically will use the <code class="ce">PUBLIC</code> keyword in combination with a public identifier and a URI reference, as shown in the following example:</P>

<PRE class="code">&lt;!DOCTYPE rootElement <code><b class="cfe">PUBLIC "PublicIdentifier" </b></code><code class="ce">"URIreference"</code>&gt;</PRE>

<P>This allows an XML application to first attempt to look up the public identifier and resolve it to the correct DTD to use for validating the document. The naming convention widely used for the public identifier is called a formal public identifier (FPI) and consists of the following fields:

<UL type="disc">
	<LI>Type</li>

	<LI>Owner</li>

	<LI>Label</li>

	<LI>Language </li>
</UL>

<H3 class="dtH3">Type</H3>

<P>The <I>type</I> is a "+" or "-" sign. The "+" sign indicates that the file is approved by a standards body such as the International Standards Organization  (ISO). The "-" sign indicates the file is not a recognized standard. Type is the first character in the example below.</P>

<PRE class="code"><B>+</B>//Owner Name//DTD Description_of_DTD//EN//</PRE>

<H3 class="dtH3">Owner</H3>

<P>The <I>owner</I> identifies the person or organization that wrote and maintains the DTD. Owner is highlighted in the example below.</P>

<PRE class="code">+//<code><b class="cfe">Owner Name</b></code>//DTD Description_of_DTD//EN//</PRE>

<H3 class="dtH3">Label</H3>

<P>The <I>label</I> gives a description of the DTD. It begins with a space after the characters "DTD". Label is highlighted in the example below.</P>

<PRE class="code">+//Owner Name//DTD <code><b class="cfe">Description_of_DTD</b></code>//EN//</PRE>

<H3 class="dtH3">Language</H3>

<P>The <I>language</I> is a two-character abbreviation of the language of the XML document to which the DTD applies. The letters EN are used to specify the English language. Language is highlighted in the example below.</P>

<PRE class="code">+//Owner Name//DTD Description_of_DTD//<code><b class="cfe">EN</b></code>//</PRE>

<H2 class="dtH2">Declaring a Public External DTD</H2>

<P>To declare a public external DTD, you use the standard naming convention for the public identifier that names and refers to the DTD. As a backup, a static URL can be placed after the public identifying name and used if the public name fails to resolve.</P>

<P>The declaration in the XML document will look similar to the following:</P>

<PRE class="code">&lt;?xml version="1.0" <code><b class="cfe">standalone="no"</b></code>?&gt;
&lt;!DOCTYPE root element SYSTEM "+//Owner Name//DTD Description_of_DTD//EN//" " http://MyBackupServer/My.dtd</PRE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="dtd_dev_3gpz.htm">Implementing DTDs</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
