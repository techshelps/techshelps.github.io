<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>XPath Examples</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmrefxpathexamples"></A>XPath Examples</H1>

<P>This topic reviews the syntax examples that appear throughout the XPath Reference. All are based on the <A HREF="xpath_syntax2_9wz0.htm">Sample XML File for XPath Syntax (inventory.xml)</A>. For an example of using an XPath expression in a test file, see <A HREF="#xmconexampleofunions">Example of Unions ( | )</A>, at the bottom of this topic.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Expression</TH>
<TH width=50%>Refers to</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">./author</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements within the current context. Note that this is equivalent to the  expression in the next row.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements within the current context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">first.name</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;first.name&gt;</code> elements within the current context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">/bookstore</PRE>
</TD>
<TD width=50%>The document element (<code class="ce">&lt;bookstore&gt;</code>) of this document.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">//author</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements in the document.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book[/bookstore/@specialty = @style]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;book&gt;</code> elements whose <code class="ce">style</code> attribute value is equal to the <code class="ce">specialty</code> attribute value of the <code class="ce">&lt;bookstore&gt;</code> element at the root of the document.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author/first-name</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;first-name&gt;</code> elements that are children of an <code class="ce">&lt;author&gt;</code> element.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">bookstore//title</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;title&gt;</code> elements one or more levels deep in the <code class="ce">&lt;bookstore&gt;</code> element (arbitrary descendants). Note that this is different from the expression in the next row.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">bookstore/*/title</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;title&gt;</code> elements that are grandchildren of <code class="ce">&lt;bookstore&gt;</code> elements.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">bookstore//book/excerpt//emph</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;emph&gt;</code> elements anywhere inside <code class="ce">&lt;excerpt&gt;</code> children of <code class="ce">&lt;book&gt;</code> elements, anywhere inside the <code class="ce">&lt;bookstore&gt;</code> element.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">.//title</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;title&gt;</code> elements one or more levels deep in the current context. Note that this situation is essentially the only one in which the period notation is required.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author/*</PRE>
</TD>
<TD width=50%>All elements that are the children of <code class="ce">&lt;author&gt;</code> elements.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book/*/last-name</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;last-name&gt;</code> elements that are grandchildren of <code class="ce">&lt;book&gt;</code> elements.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">*/*</PRE>
</TD>
<TD width=50%>All grandchildren elements of the current context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">*[@specialty]</PRE>
</TD>
<TD width=50%>All elements with the <code class="ce">specialty</code> attribute.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">@style</PRE>
</TD>
<TD width=50%>The <code class="ce">style</code> attribute of the current context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">price/@exchange</PRE>
</TD>
<TD width=50%>The <code class="ce">exchange</code> attribute on <code class="ce">&lt;price&gt;</code> elements within the current context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">price/@exchange/total</PRE>
</TD>
<TD width=50%>Returns an empty node set, because attributes do not contain element children. This expression is allowed by the XML Path Language (XPath) grammar, but is not strictly valid.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book[@style]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;book&gt;</code> elements with <code class="ce">style</code> attributes, of the current context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book/@style</PRE>
</TD>
<TD width=50%>The <code class="ce">style</code> attribute for all <code class="ce">&lt;book&gt;</code> elements of the current context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">@*</PRE>
</TD>
<TD width=50%>All attributes of the current element context.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">./first-name</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;first-name&gt;</code> elements in the current context node. Note that this is equivalent to the expression in the next row.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">first-name</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;first-name&gt;</code> elements in the current context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[1]</PRE>
</TD>
<TD width=50%>The first <code class="ce">&lt;author&gt;</code> element in the current context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[first-name][3]</PRE>
</TD>
<TD width=50%>The third <code class="ce">&lt;author&gt;</code> element that has a <code class="ce">&lt;first-name&gt;</code> child.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">my:book</PRE>
</TD>
<TD width=50%>The <code class="ce">&lt;book&gt;</code> element from the <code class="ce">my</code> namespace.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">my:*</PRE>
</TD>
<TD width=50%>All elements from the <code class="ce">my</code> namespace.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">@my:*</PRE>
</TD>
<TD width=50%>All attributes from the <code class="ce">my</code> namespace (this does not include unqualified attributes on elements from the <code class="ce">my</code> namespace).</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>Note that indexes are relative to the parent. Consider the following data:</P>

<PRE class="code">&lt;x&gt;
  &lt;y/&gt;
  &lt;y/&gt;
&lt;/x&gt;
&lt;x&gt;
  &lt;y/&gt;
  &lt;y/&gt;
&lt;/x&gt;</PRE>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Expression</TH>
<TH width=50%>Refers to</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">x/y[1]</PRE>
</TD>
<TD width=50%>The first <code class="ce">&lt;y&gt;</code> child of each <code class="ce">&lt;x&gt;</code>. This is equivalent to the expression in the next row.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">x/y[position() = 1]</PRE>
</TD>
<TD width=50%>The first <code class="ce">&lt;y&gt;</code> child of each <code class="ce">&lt;x&gt;</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">(x/y)[1]</PRE>
</TD>
<TD width=50%>The first <code class="ce">&lt;y&gt;</code> from the entire set of <code class="ce">&lt;y&gt;</code> children of <code class="ce">&lt;x&gt;</code> elements.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">x[1]/y[2]</PRE>
</TD>
<TD width=50%>The second <code class="ce">&lt;y&gt;</code> child of the first <code class="ce">&lt;x&gt;</code>.</TD>
</TR>
</table></div>

<P class="fineprint"></P>

<P>The remaining examples refer to the Sample XML file for XPath.</P>

<P class="fineprint"></P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Expression</TH>
<TH width=50%>Refers to</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">book[last()]</code></TD>
<TD width=50%>The last <code class="ce">&lt;book&gt;</code> element of the current context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book/author[last()]</PRE>
</TD>
<TD width=50%>The last <code class="ce">&lt;author&gt;</code> child of each <code class="ce">&lt;book&gt;</code> element of the current context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">(book/author)[last()]</PRE>
</TD>
<TD width=50%>The last <code class="ce">&lt;author&gt;</code> element from the entire set of <code class="ce">&lt;author&gt;</code> children of <code class="ce">&lt;book&gt;</code> elements of the current context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book[excerpt]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;book&gt;</code> elements that contain at least one <code class="ce">&lt;excerpt&gt;</code> element child.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book[excerpt]/title</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;title&gt;</code> elements that are children of <code class="ce">&lt;book&gt;</code> elements that also contain at least one <code class="ce">&lt;excerpt&gt;</code> element child.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book[excerpt]/author[degree]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;degree&gt;</code> element child, and that are children of <code class="ce">&lt;book&gt;</code> elements that also contain at least one <code class="ce">&lt;excerpt&gt;</code> element. </TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book[author/degree]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;book&gt;</code> elements that contain <code class="ce">&lt;author&gt;</code> children that in turn contain at least one <code class="ce">&lt;degree&gt;</code> child.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[degree][award]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;degree&gt;</code> element child and at least one <code class="ce">&lt;award&gt; element child</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[degree and award]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;degree&gt;</code> element child and at least one <code class="ce">&lt;award&gt;</code> element child.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[(degree or award) and publication]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;degree&gt;</code> or <code class="ce">&lt;award&gt;</code> and at least one <code class="ce">&lt;publication&gt;</code> as the children</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[degree and not(publication)]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;degree&gt;</code> element child and that contain no <code class="ce">&lt;publication&gt;</code> element children.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[not(degree or award) and publication]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;publication&gt;</code> element child and contain neither <code class="ce">&lt;degree&gt;</code> nor <code class="ce">&lt;award&gt;</code> element children.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><code class="ce">author[last-name = "Bob"]</code></TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain at least one <code class="ce">&lt;last-name&gt;</code> element child with the value <code class="ce">Bob</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[last-name[1] = "Bob"]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements where the first <code class="ce">&lt;last-name&gt;</code> child element has the value <code class="ce">Bob</code>. Note that this is equivalent to the expression in the next row.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[last-name [position()=1]= "Bob"]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements where the first <code class="ce">&lt;last-name&gt;</code> child element has the value <code class="ce">Bob</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">degree[@from != "Harvard"]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;degree&gt;</code> elements where the <code class="ce">from</code> attribute is not equal to <code class="ce">"Harvard"</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[. = "Matthew Bob"]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements whose value is <code class="ce">Matthew Bob</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[last-name = "Bob" and ../price &amp;gt; 50]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that contain a <code class="ce">&lt;last-name&gt;</code> child element whose value is <code class="ce">Bob</code>, and a <code class="ce">&lt;price&gt;</code> sibling element whose value is greater than 50. </TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">book[position() &amp;lt;= 3]</PRE>
</TD>
<TD width=50%>The first three books (1, 2, 3).</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[not(last-name = "Bob")]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that do no contain <code class="ce">&lt;last-name&gt;</code> child elements with the value <code class="ce">Bob</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[first-name = "Bob"]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that have at least one <code class="ce">&lt;first-name&gt;</code> child with the value <code class="ce">Bob</code>. </TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[* = "Bob"]
<PRE class="code"></PRE>
</PRE>
</TD>
<TD width=50%>all author elements containing any child element whose value is <code class="ce">Bob</code>. </TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">author[last-name = "Bob" and first-name = "Joe"]
<PRE class="code"></PRE>
</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;author&gt;</code> elements that has a <code class="ce">&lt;last-name&gt;</code> child element with the value <code class="ce">Bob</code> and a <code class="ce">&lt;first-name&gt;</code> child element with the value <code class="ce">Joe</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">price[@intl = "Canada"]</PRE>
</TD>
<TD width=50%>All <code class="ce">&lt;price&gt;</code> elements in the context node which have an <code class="ce">intl</code> attribute equal <code class="ce">to</code> <code class="ce">"Canada"</code>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">degree[position() &amp;lt; 3]</PRE>
</TD>
<TD width=50%>The first two <code class="ce">&lt;degree&gt;</code> elements that are children of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">p/text()[2]</PRE>
</TD>
<TD width=50%>The second text node in each <code class="ce">&lt;p&gt;</code> element in the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">ancestor::book[1]</PRE>
</TD>
<TD width=50%>The nearest <code class="ce">&lt;book&gt;</code> ancestor of the context node.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">ancestor::book[author][1]</PRE>
</TD>
<TD width=50%>The nearest <code class="ce">&lt;book&gt;</code> ancestor of the context node and this <code class="ce">&lt;book&gt;</code> element has an <code class="ce">&lt;author&gt;</code> element as its child.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>
<PRE class="code">ancestor::author[parent::book][1]</PRE>
</TD>
<TD width=50%>The nearest <code class="ce">&lt;author&gt;</code> ancestor in the current context and this <code class="ce">&lt;author&gt;</code> element is a child of a <code class="ce">&lt;book&gt;</code> element.</TD>
</TR>
</table></div>

<P class="fineprint"></P>



<H2 class="dtH2"><A NAME="xmconexampleofunions"></A>Example of Unions ( | )</H2>

<P>To demonstrate the union operation, we use the following XPath expression: </P>

<PRE class="code">x | y/x</PRE>

<P>selects all the &lt;x&gt; elements whose values are <I>green</I> or <I>blue</I> in the following XML file:</P>

<P class="label"><B>XML File (data1.xml)</B></P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;?xml-stylesheet type="text/xsl" <B>href="union.xsl"</B>?&gt;
&lt;root&gt;
<B>   &lt;x&gt;green&lt;/x&gt;</B>
   &lt;y&gt;
<B>      &lt;x&gt;blue&lt;/x&gt;</B>
<B>      &lt;x&gt;blue&lt;/x&gt;</B>
   &lt;/y&gt;
   &lt;z&gt;
      &lt;x&gt;red&lt;/x&gt;
      &lt;x&gt;red&lt;/x&gt;
   &lt;/z&gt;
<B>   &lt;x&gt;green&lt;/x&gt;</B>
&lt;/root&gt;</PRE>

<P class="label"><B>XSLT File (union.xsl)</B></P>

<PRE class="code">&lt;?xml version='1.0'?&gt;
&lt;xsl:stylesheet version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;

&lt;xsl:template match="root"&gt;
   &lt;xsl:for-each select="x | y/x"&gt;
      &lt;xsl:value-of select="."/&gt;,
      &lt;xsl:if test="not(position()=last())"&gt;,&lt;/xsl:if&gt;
   &lt;/xsl:for-each&gt;
&lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</PRE>

<P class="label"><B>Formatted Output</B></P>

<P>green,blue,blue,green</P>

<P class="label"><B>Processor Output</B></P>

<PRE class="code">&lt;?xml version="1.0" encoding="UTF-16"?&gt;green,blue,blue,green</PRE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xpath_syntax2_9wz0.htm">Sample XML File for XPath Syntax (inventory.xml)</A> | <A HREF="xpath_syntax2_7z1v.htm">Location Path Examples</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
