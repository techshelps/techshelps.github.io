<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>getDeclaration Method</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin="0" id="bodyID" class = "dtBODY">
<object id="obj_cook" classid="clsid:59CC0C20-679B-11D2-88BD-0800361A1803" style="display:none;"></object>

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - DOM Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmmthixmldomschemacollection2getdeclaration"></A>getDeclaration Method</H1>

<P>Returns an <code class="ce">ISchemaItem</code> object. This object is the declaration of the DOM node that is sent to the function. The declaration specifies the schema information that is used to validate the document item in the DOM node. The <code class="ce">ISchemaItem</code> interface can be used to obtain further information about the schema declaration stored in the <code class="ce">ISchemaItem</code> object.</P>
<div class=filtered><span class="lang">[Script]</span>

<H4 class="dtH4">Implementation Syntax</H4>

<PRE class="syntax">var oSchemaItem = oDom.namespaces.getDeclaration(oDOMNode);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>oDOMNode</I></DT>

<DD>An object. The DOM node for which a declaration object will be returned.</dd>
</DL>

<H4 class="dtH4">Return Values</H4>

<DL>
<DT><I>oSchemaItem</I></DT>

<DD>An object. The schema item object that describes the specified DOM node, passed in the <code class="ce">node</code> parameter.</dd>
</DL>

<H4 class="dtH4">Code Example</H4>

<P>The following VBScript example shows the <code class="ce">getDeclaration</code> method in a schema.</P>

<PRE class="code">' Load the doc.
Set oDoc = CreateObject("Msxml2.DOMDocument.5.0")
oDoc.async = false
oDoc.load "po2.xml"
If (xmlDoc.parseError.errorCode &lt;&gt; 0) Then
&nbsp;&nbsp;&nbsp;Dim myErr
&nbsp;&nbsp;&nbsp;Set myErr = xmlDoc.parseError
&nbsp;&nbsp;&nbsp;MsgBox("You have error " &amp; myErr.reason)
Else
&nbsp;&nbsp;&nbsp;' Retrieve the namespace URI for schema used in
&nbsp;&nbsp;&nbsp;' purchase order document.
&nbsp;&nbsp;&nbsp;Set oDecl = oDoc.namespaces.<B>getDeclaration(oDoc.documentElement)</B>
&nbsp;&nbsp;&nbsp;WScript.Echo oDecl.namespaceURI
End If</PRE>
</div><!-- [Script] -->
<div class=filtered><span class="lang">[Visual Basic]</span>

<H4 class="dtH4">Implementation Syntax</H4>

<PRE class="syntax">Set oSchemaItem = oDom.namespaces.getDeclaration(oDOMNode)</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>oDOMNode</I></DT>

<DD>An object. The DOM node for which a declaration object will be returned.</dd>
</DL>

<H4 class="dtH4">Return Values</H4>

<DL>
<DT><I>oSchemaItem</I></DT>

<DD>An object. The schema item object for the specified DOM node, passed in the <code class="ce">node</code> parameter.</dd>
</DL>
</div><!-- [Visual Basic] -->
<div class=filtered><span class="lang">[C/C++]</span>

<H4 class="dtH4">Syntax</H4>

<PRE class="syntax">HRESULT getDeclaration(IXMLDOMNode* node, ISchemaItem** item);</PRE>

<H4 class="dtH4">Parameters</H4>

<DL>
<DT><I>node [in]</I></DT>

<DD>An object. The DOM node.</dd>

<DT><I>item [out,retval]</I></DT>

<DD>An object. The schema object for the specified DOM.</dd>
</DL>

<H4 class="dtH4">Return Values</H4>

<DL>
<DT>S_OK</DT>

<DD>The value returned if successful.</dd>

<DT>E_INVALIDARG</DT>

<DD>The value returned if the DOM node points to some object other than a Node or NULL.</dd>

<DT>E_POINTER</DT>

<DD>The value returned if the item object is NULL</dd>

<DT>E_FAIL</DT>

<DD>The value returned if the node does not have a corresponding declaration in the schema.</dd>
</DL>
</div><!-- [C/C++] -->

<P>To view reference information for Visual Basic or C/C++ only, click the Language Filter button <IMG SRC="filter.gif" ALT="Language Filter" BORDER=0> in the upper-left corner of the page.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;The syntax <code class="ce">oSchemaCollection.getDeclaration(oDOMNODE)</code> is no longer supported and will return E_NOTIMPL.</BLOCKQUOTE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="xml_obj_ixmldomnode_5xwl.htm">DOM Node Interface</A></P>

<P>Applies to: <A HREF="xml_obj_ixmldomschemacollection2_6saa.htm">IXMLDOMSchemaCollection2</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
