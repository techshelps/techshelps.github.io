<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Context for XPath Expressions</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/xmlsdk.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannertitle">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannertitle" nowrap>Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office - XPath Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="xmconcontextforxpathexpressions"></A>Context for XPath Expressions</H1>

<P>The evaluation of an XPath expression depends on the context against which the expression operates. The context consists of the node against which the expression is evaluated and its associated environment, which includes the following:

<UL type="disc">
	<LI>The position of the context node in the document order, relative to its siblings.</li>

	<LI>The size of the context&#0151;that is, the number of siblings of the context node plus one.</li>

	<LI>Variable bindings with which references to a variable can be resolved.</li>

	<LI>A function library.</li>

	<LI>The namespace declarations in scope for the expression.</li>
</UL>

<P>To better appreciate the concept of context, consider a tree containing nodes. Asking for all nodes named X from the root of the tree returns one set of results, while asking for those nodes from a branch in the tree returns a different set of results. Thus, the result of an expression depends upon the context against which it executes.</P>

<P>XPath expressions can match specific patterns at one particular context, return the results, and perform additional operations relative to the context of the returned nodes. This gives XPath expressions extraordinary flexibility in searching throughout the document tree.</P>

<H2 class="dtH2">Basic XPath Expressions</H2>

<P>The following are basic types of XPath expressions. Each type is described below.

<UL type="disc">
	<LI>Current context</li>

	<LI>Document root</li>

	<LI>Root element</li>

	<LI>Recursive descent</li>

	<LI>Specific element</li>
</UL>

<H4 class="dtH4">Examples</H4>

<P>The following examples show some basic XPath expressions. More complex expressions are possible by combining these simple expressions together and by using the various XPath operators and special characters.

<DL>
<DT><B>Current context</B></DT>

<DD>An expression prefixed with a period and forward slash (./) explicitly uses the current context as the context. For example, the following expression refers to all <code class="ce">&lt;author&gt;</code> elements within the current context:

<PRE class="code">./author</PRE>


<P>Note that this is equivalent to the following:


<PRE class="code">author</PRE>
</dd>

<DT><B>Document root</B></DT>

<DD>An expression prefixed with a forward slash (/) uses the root of the document tree as the context. For example, the following expression refers to the <code class="ce">&lt;bookstore&gt;</code> element at the root of this document:

<PRE class="code">/bookstore</PRE>
</dd>

<DT><B>Root element</B></DT>

<DD>An expression that uses a forward slash followed by an asterisk (/*) uses the root element as the context. For example, the following expression finds the root element of the document:

<PRE class="code">/*</PRE>
</dd>

<DT><B>Recursive descent</B></DT>

<DD>An expression that uses the double forward slash (//) indicates a search that can include zero or more levels of hierarchy. When this operator appears at the beginning of the pattern, the context is relative to the root of the document. For example, the following expression refers to all <code class="ce">&lt;author&gt;</code> elements anywhere within the current document:

<PRE class="code">//author</PRE>


<P>The .// prefix indicates that the context starts at the level in the hierarchy indicated by the current context. 
</dd>

<DT><B>Specific elements</B></DT>

<DD>An expression that starts with an element name refers to a query of the specific element, starting from the current context node. For example, the following expression refers to the <code class="ce">&lt;background.jpg&gt;</code> element within the <code class="ce">&lt;images&gt;</code> element in the current context node:

<PRE class="code">images/background.jpg</PRE>


<P>The following expression refers to the collection of <code class="ce">&lt;book&gt;</code> elements within the <code class="ce">&lt;bookstore&gt;</code> elements in the current context node:


<PRE class="code">bookstore/book</PRE>


<P>The following expression refers to all <code class="ce">&lt;first.name&gt;</code> elements in the current context node:


<PRE class="code">first.name</PRE>


<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;Element names can include the period character (.). These names can be used just like any other name.</BLOCKQUOTE>
</dd>
</DL>

<H2 class="dtH2">Context in the DOM</H2>

<P>When using XPath expressions with the Microsoft XML DOM, the context is the <A HREF="xml_obj_ixmldomnode_5xwl.htm">Node</A> object whose <A HREF="xml_mth_sz_3oz7.htm">selectNodes method</A> or <A HREF="xml_mth_sz_3jol.htm">selectSingleNode method</A> is called.</P>

<P>When using XPath directly from the DOM, you define the context from a particular node. For more information, see <A HREF="xpath_concepts4_6uib.htm">How the DOM Defines the Context for XPath Expressions</A>.</P>

<H2 class="dtH2">Context in XSLT</H2>

<P>When using XPath directly from the XSLT, you define the context by the current node. For more information about how a context is defined, see <A HREF="xpath_concepts3_5k6r.htm">How XSLT Defines the Context for XPath Expressions</A>.</P>

<H4 class="dtH4">Other Resources <IMG SRC="leave-ms.gif" ALT="Other Resources" BORDER=0></H4>

<P><A HREF="http://go.microsoft.com/fwlink/?LinkId=4873">XML Path Language (XPath) Version 1.0</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
</BODY>
</HTML>
