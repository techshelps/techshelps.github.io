<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Использование макрокоманд URL (URL Macros)</title><link rel="stylesheet" href="default.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="MetaProducts Offline Explorer Pro"><link rel="up" href="index.html" title="MetaProducts Offline Explorer Pro"><link rel="prev" href="InternetSpeed.html" title="Настройки: Интернет - Скорость"><link rel="next" href="BurnToCD.html" title="Как записать загруженный web-сайт на CD?"></head><body alink="#0000ff" bgcolor="white" link="#0000ff" text="black" vlink="#840084"><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="Macros"></a>Использование макрокоманд URL (URL Macros)</h2></div></div></div><p>Offline
Explorer Pro и Enterprise поддерживают макрокоманды URL. Макрокоманды
полезны для планирования автоматический загрузки в случаях, когда URL
постоянно меняется.</p><p>Например, сайт новостей о погоде имеет
изображение, которое ежедневно меняется. URL этого изображения содержит
в себе номер дня месяца. Таким образом,</p><p><span class="bold"><strong>http://www.weather.com/image5.png</strong></span> соответствует пятому дню текущего месяца, в то время как</p><p><span class="bold"><strong>http://www.weather.com/image12.png</strong></span> соответствует двенадцатому дню текущего месяца.</p><p>В этом случае поможет следующая макрокоманда URL:</p><p><span class="bold"><strong>http://www.weather.com/image{:day}.png</strong></span></p><p>Когда Offline Explorer начинает загрузку Проекта, то макрокоманды меняют эти значения. Макрокоманда должна начинаться с символа <span class="bold"><strong>{:</strong></span> и заканчиваться символом <span class="bold"><strong>}</strong></span></p><p>Поддерживаются следующие макрокоманды:</p><p><span class="bold"><strong>{:day}</strong></span> текущий день (1 - 31)</p><p><span class="bold"><strong>{:0day}</strong></span> текущий день, включающий при необходимости начальный нуль (01 - 31)</p><p><span class="bold"><strong>{:shortday} </strong></span>день как сокращённое название (Sun-Sat)</p><p><span class="bold"><strong>{:longday}</strong></span> день как полное его название (Sunday-Saturday)</p><p><span class="bold"><strong>{:month}</strong></span> текущий месяц как число без начального нуля (1-12)</p><p><span class="bold"><strong>{:0month} </strong></span>месяц как число с начальным нулём (01-12)</p><p><span class="bold"><strong>{:shortmonth}</strong></span> месяц как сокращённое название (Jan-Dec)</p><p><span class="bold"><strong>{:longmonth}</strong></span> месяц как полное его название (January-December)</p><p><span class="bold"><strong>{:year}</strong></span> текущий год как число из двух цифр (00-99)</p><p><span class="bold"><strong>{:longyear}</strong></span> год как четырёхзначное число (0000-9999)</p><p><span class="bold"><strong>{:week}</strong></span> текущий номер недели без начального нуля (1-51)</p><p><span class="bold"><strong>{:0week}</strong></span> номер недели с начальным нулём (00-51)</p><p><span class="bold"><strong>{:hour}</strong></span> текущий час без начального нуля (0-23)</p><p><span class="bold"><strong>{:0hour}</strong></span> час с начальным нулём (00-23)</p><p><span class="bold"><strong>{:minute}</strong></span> текущая минута без начального нуля (0-59)</p><p><span class="bold"><strong>{:0minute}</strong></span> минута с начальным нулём (00-59)</p><p><span class="bold"><strong>{:second}</strong></span> секунда, в которую стартует загрузка, без начального нуля (0-59)</p><p><span class="bold"><strong>{:0second}</strong></span> секунда с начальным нулём (00-59)</p><p><span class="bold"><strong>{:5..12}</strong></span>
это специальная макрокоманда, которая загрузит URL с числами от 5 до
12. Вы можете также использовать начальный нуль в первом номере.</p><p><span class="bold"><strong>{:0..100|25}</strong></span> разделитель | определяет шаг перечисления. В этом примере будут сгенерированы числа 0, 25, 50, 75, 100.</p><p><span class="bold"><strong>{:a..z}</strong></span> загрузка URL с символами от a до z. Вы можете здесь использовать одиночные буквы от <span class="bold"><strong>A</strong></span> до <span class="bold"><strong>Z</strong></span> и <span class="bold"><strong>a</strong></span> до <span class="bold"><strong>z</strong></span>.</p><p><span class="bold"><strong>{:roman:XIX..XXX}</strong></span>
загрузка URL с римскими цифрами от XIX (19) до XXX (30). Вы можете
также использовать здесь и меньшие числа. Вы можете ввести здесь и
обычные числа, которые будут преобразованы в римские - <span class="bold"><strong>{:roman:19..30}.</strong></span></p><p><span class="bold"><strong>{:Value1,Value2,…,ValueN}</strong></span>
Эта макрокоманда загрузит URL со значениями из разделённого запятыми
списка. Например, Вы можете использовать это для перечисления
государств - <span class="bold"><strong>{:AL,WA,CA,IL} </strong></span></p><p><span class="bold"><strong>{:file=c:\values.txt}</strong></span>
Эта макрокоманда заменит значения на загруженные из указанного
текстового файла. Одно значение в отдельной строке. Если текстовый файл
содержит макрокоманды URL, то они будут проигнорированы.<br>
</p><p><span class="bold"><strong>{:FileURLEncode=c:\post.txt} </strong></span>Аналогично
предыдущему, но текст будет в форме закодированных URL (URL-encoded
символы). Используется для POST-запросов. Например, пробелы в текстовом
файле будут заменены на + и так далее.</p><p><span class="bold"><strong>{:setdate=...} </strong></span>Это специальная макрокоманда, которая позволит Вам изменять дату и время, используемые в вышеприведённых макрокомандах.</p><p>Например, если Вы хотите загрузить изображение, которое создано вчера, то Вы можете определить следующий URL:</p><p><span class="bold"><strong>http://www.weather.com/{:setdate=date-1}image{:day}.png</strong></span></p><p>Вышеприведённый
URL будет использовать вчерашнюю дату {:day} для макрокоманды.
Аналогично Вы можете установить и завтрашнюю дату:</p><p><span class="bold"><strong>http://www.weather.com/{:setdate=date+1}image{:day}.png</strong></span></p><p>Вы можете установить любое число дней для изменения текущей даты. Точно так же Вы можете изменять месяцы:</p><p><span class="bold"><strong>http://www.weather.com/{:setdate=date-5M}image{:day}.png</strong></span></p><p>Для изменения текущего времени используйте формат <span class="bold"><strong>{:setdate=time+17}</strong></span> или <span class="bold"><strong>{:setdate=time-80}</strong></span>, где цифра определяет минуты.</p><p><span class="bold"><strong>{:julian}</strong></span>
Вставляет цифру дня по юлианскому календарю. Юлианская дата
(аббревиатура JD) - простой непрерывный счётчик дней и частей с полудня
Всемирного времени от 1 января 4713 г. до н.э. (по юлианскому
календарю). Эта макрокоманда полезна, если в URL используется
непрерывный счётчик, увеличивающийся каждый день. Вы можете
использовать формы макрокоманд <span class="bold"><strong>{:julian+1000}</strong></span> или <span class="bold"><strong>{:julian-500}</strong></span> для смещения конечного номера.</p><p><span class="bold"><strong>{:JavaScriptTime}</strong></span> вставляет текущие дату/время как число в формате JavaScript функции getTime().</p><p>Для изменения стандартных названий месяцев Вы можете использовать следующие макрокоманды:</p><p><span class="bold"><strong>{:#longmonths:January,February,...,November,December}</strong></span> и <span class="bold"><strong>{:#shortmonths:J,F,M,A,M,J,J,A,S,O,N,D}</strong></span>.
Это особенно хорошо, если Вы загружаете сайты, использующие названия
месяцев на другом языке или стандартные названия месяцев Вашей системы
отличаются от применяющихся на сайте.</p><p>Если изменяется дата или частота повторения в URL, то поможет следующая макрокоманда:</p><p>http://www.srv.com/dir<span class="bold"><strong>{:5..7#1}</strong></span>/file{:#1}.htm</p><p>Которая генерирует три URL:</p><p>http://www.srv.com/dir5/file5.htm</p><p>http://www.srv.com/dir6/file6.htm</p><p>http://www.srv.com/dir7/file7.htm</p><p>Более сложный формат позволяет Вам увеличивать или уменьшать и второе значение: http://www.srv.com/dir<span class="bold"><strong>{:5..7#1}</strong></span>/file<span class="bold"><strong>{:#1+10}.</strong></span>htm</p><p>http://www.srv.com/dir5/file15.htm</p><p>http://www.srv.com/dir6/file16.htm</p><p>http://www.srv.com/dir7/file17.htm</p><p>Вы также можете использовать <span class="bold"><strong>...{:#1-10}...
    </strong></span></p><p>Вы
можете использовать макрокоманды URL в POST-запросах, AutoExport= и
других строках - каждая строка в поле URL, содержащая макрокоманду URL,
будет обработана. Дополнительно для автоэкспорта могут быть полезны
следующие макрокоманды:</p><p><span class="bold"><strong>{:MapFile}</strong></span> вставляет полный путь к файлу Карты Проекта (.map) со списком всех файлов, загруженных Проектом.</p><p><span class="bold"><strong>{:IID}</strong></span> вставляет ID-номер (идентификационный номер) Проекта.</p><p><span class="bold"><strong>{:DD}</strong></span> вставляет полный путь к каталогу загрузки, в котором Проект сохраняет загружаемые файлы.</p><p><span class="bold"><strong>{:ProjectName}</strong></span>
вставляет имя проекта. Может быть полезен в макросах, которые вызывают
исполняемые файлы и передают параметры командной строки для них.</p><p>Макрокоманды URL могут также использоваться в <a href="PropFilters.html" title="Свойства Проекта: Фильтры URL">фильтрах URL</a> (ключевые слова списков Маски исключения/Маски включения в разделах Сервер, Каталог и Имя файла) и в <a href="Substitutes.html" title="Замена адресов URL">замене адресов URL</a>.</p><p>Поддержка
URL Macros в Фильтрах URL позволяет Вам создавать универсальные шаблоны
для некоторых web-сайтов. Для этого предназначен новый набор
макрокоманд:</p><p><span class="bold"><strong>{:server}</strong></span> вставляет имя начального сервера из поля URL. Например, <span class="bold"><strong>www.site.com</strong></span></p><p><span class="bold"><strong>{:domain} </strong></span> вставляет домен сервера из поля URL. Например, если URL http://www.site.com, его домен будет <span class="bold"><strong>site.com</strong></span></p><p><span class="bold"><strong>{:dir}</strong></span> вставляет название начального каталога из поля URL. Например, <span class="bold"><strong>/directory/sub/</strong></span></p><p><span class="bold"><strong>{:filename}</strong></span> вставляет имя начального файла из поля URL. Например, <span class="bold"><strong>file.asp?param</strong></span></p><p><span class="bold"><strong>Переменные</strong></span></p><p>Вы можете определить свои собственные переменные:</p><p><span class="bold"><strong>{:myserv=metaproducts}</strong></span></p><p><span class="bold"><strong>http://www.{:myserv}.com/</strong></span></p><p>Это
поможет сделать универсальный Проект, который может быть легко
копирован для загрузки других сайтов. Переменные макрокоманды могут
использоваться в ключевых словах фильтров URL и правилах замены адресов.</p><p>Если
у Вас в поле URL есть несколько адресов, то Offline Explorer Pro
создаст несколько ключевых слов в Фильтрах URL – по одному в каждом из
указанных URL.</p></div></body></html>