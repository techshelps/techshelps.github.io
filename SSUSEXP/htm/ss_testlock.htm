<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>TESTLOCK</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="ss_testlock"></a>Testlock</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="SS_Utilities">
</object><a href=JavaScript:alink_1.Click()>See Also</a></p>
<p>
Testlock.exe determines whether your network supports native <a href="ssugglossary.htm#gloss_locking">locking</a>.&nbsp; Testlock.exe is installed in the platform-specific (for example, WIN32) subfolder by default.</p>
<p>
The locking system is set in the SRCSAFE.INI file.&nbsp; The primary variable is Lock_Mode, which can be set to either Native or Lockfile.&nbsp; The default is Native.</p>
<p class=label>
<b>To determine the locking system in use on your network:</b>
<ol>
<li>
Install VSS to a drive accessible from two or more computers.<br><br></li>
<li>
From one of the computers, go to the WIN32 folder and run:<p class=tl>
<b>Testlock.exe &lt;folder name&gt;</b></P><p class=tl>
Testlock.exe locks a file, and displays the message "Press any key to continue."&nbsp; Do not press a key yet; leave the program running, and go to step 3.</P><p class=tl>
If Testlock.exe fails and does not display the message, go to the specified folder and delete the file(s) Testlock.*, then try again.&nbsp; Make sure not to delete anything else.</P></li>
<li>
From another computer, run Testlock.exe again, providing the same folder path as before.<p class=tl>
Testlock.exe attempts to lock the same records that the first computer has locked, and report the results.&nbsp; If the lock fails, your network file system supports native locking.&nbsp; If the lock succeeds, you must use the Lockfile variable setting.</P></li>
<li>
Press a key on both computers to end the program.<p class=tl>
If native locking is supported, repeat steps 2 through 4 on various computers on your network, testing each platform combination to make certain the necessary features are supported across your entire network.</P><p class=tl>
To save time, you may leave Testlock.exe running on one computer, and repeat step 3 on every other computer.&nbsp; Then switch to a different "first" computer and repeat the pattern, and so on.</P></li>
</ol>
</BODY>
</HTML>
