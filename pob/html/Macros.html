<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><title>Using URL Macros</title><link rel="stylesheet" href="default.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="MetaProducts Portable Offline Browser"><link rel="up" href="index.html" title="MetaProducts Portable Offline Browser"><link rel="prev" href="InternetSpeed.html" title="Options dialog: Internet - Speed"><link rel="next" href="BurnToCD.html" title="How to burn downloaded Web site to CD?"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="Macros"></a>Using URL Macros</h2></div></div></div><p>Portable Offline Browser supports URL macros. Macros are
    useful for scheduled automatic downloads when URL is changing every
    time.</p><p>For example, a weather site has an image that updates daily. Its URL
    has a day number inside. Thus,</p><p><span class="bold"><strong>http://www.weather.com/image5.png</strong></span>
    corresponds to the 5th day of the current month, while</p><p><span class="bold"><strong>http://www.weather.com/image12.png</strong></span>
    corresponds to the 12th day of the current month.</p><p>In such case, the following URL macros will be useful:</p><p><span class="bold"><strong>http://www.weather.com/image{:day}.png
    </strong></span></p><p>When Portable Offline Browser starts downloading the Project, it substitutes macros
    with their values. Macro should start with <span class="bold"><strong>{:
    </strong></span>symbols and end with <span class="bold"><strong>}</strong></span></p><p>The following macros are supported:</p><p><span class="bold"><strong>{:day}</strong></span> the current day number (1 -
    31)</p><p><span class="bold"><strong>{:0day}</strong></span> the current day with a
    leading zero, when necessary (01 - 31)</p><p><span class="bold"><strong>{:shortday} </strong></span>the day as an
    abbreviation (Sun-Sat)</p><p><span class="bold"><strong>{:longday}</strong></span> the day as a full name
    (Sunday-Saturday)</p><p><span class="bold"><strong>{:month}</strong></span> the current month as a
    number without a leading zero (1-12)</p><p><span class="bold"><strong>{:0month} </strong></span>the month as a number
    with a leading zero (01-12)</p><p><span class="bold"><strong>{:shortmonth} </strong></span>the month as an
    abbreviation (Jan-Dec)</p><p><span class="bold"><strong>{:longmonth}</strong></span> the month as a full
    name (January-December)</p><p><span class="bold"><strong>{:year}</strong></span> the current year as a
    two-digit number (00-99)</p><p><span class="bold"><strong>{:longyear} </strong></span>the year as a
    four-digit number (0000-9999)</p><p><span class="bold"><strong>{:week} </strong></span>the current week number without a
    leading zero (1-51)</p><p><span class="bold"><strong>{:0week} </strong></span>the week number with a leading
    zero (00-51)</p><p><span class="bold"><strong>{:hour} </strong></span>the current hour without a
    leading zero (0-23)</p><p><span class="bold"><strong>{:0hour} </strong></span>the hour with a leading
    zero (00-23)</p><p><span class="bold"><strong>{:minute}</strong></span> the current minute
    without a leading zero (0-59)</p><p><span class="bold"><strong>{:0minute}</strong></span> the minute with a
    leading zero (00-59)</p><p><span class="bold"><strong>{:second}</strong></span> the second when download starts
    without a leading zero (0-59)</p><p><span class="bold"><strong>{:0second}</strong></span> the second with a
    leading zero (00-59)</p><p><span class="bold"><strong>{:5..12}</strong></span> this is a special macro
    which will load URLs with numbers from 5 to 12. You may also use leading
    zeros in the first number.</p><p><span class="bold"><strong>{:0..100|25}</strong></span> the | separator
    defines enumeration step. In this example numbers 0, 25, 50, 75, 100 will
    be generated.</p><p><span class="bold"><strong>{:a..z}</strong></span> to load URLs with letters
    from a to z. You may use single letters from <span class="bold"><strong>A</strong></span> to <span class="bold"><strong>Z </strong></span>and
    <span class="bold"><strong>a</strong></span> to<span class="bold"><strong> z
    </strong></span>here.</p><p><span class="bold"><strong>{:roman:XIX..XXX} </strong></span>to load URLs with
    roman numbers from XIX (19) to XXX (30). You may also use lower-cased
    numbers here. You can specify normal numbers as well that will be
    converted to romans -<span class="bold"><strong>
    {:roman:19..30}.</strong></span></p><p><span class="bold"><strong>{:Value1,Value2,…,ValueN} </strong></span>This
    macro will load URLs with values from the comma-separated list. For
    example, you can use it to enumerate states - <span class="bold"><strong>{:AL,WA,CA,IL} </strong></span></p><p><span class="bold"><strong>{:file=c:\values.txt} </strong></span>This macro be
    replaced with values loaded from the specified text file. One value should
    be specified on a line. If the text file contains URL Macros, they will be
    ignored.</p><p><span class="bold"><strong>{:FileURLEncode=c:\post.txt} </strong></span>The same as above but
    the text will be in URL-Encoded form. It is good for POST requests. For example, all
    space symbols from the text file will be replaced with + and so on.</p><p><span class="bold"><strong>{:setdate=...} </strong></span>This is a special
    macro that allows you to change date and time used in the above
    macros.</p><p>For example, if you want to download an image that was created
    yesterday, you can specify the following URL:</p><p><span class="bold"><strong>http://www.weather.com/{:setdate=date-1}image{:day}.png</strong></span></p><p>The above URL will use yesterday date for the {:day} macro. The same
    way you can set tomorrow date:</p><p><span class="bold"><strong>http://www.weather.com/{:setdate=date+1}image{:day}.png</strong></span></p><p>You can set any number of days to change the current date. You can also change months this way:</p><p><span class="bold"><strong>http://www.weather.com/{:setdate=date-5M}image{:day}.png</strong></span></p><p>To change the current time, use <span class="bold"><strong>{:setdate=time+17}</strong></span> or <span class="bold"><strong>{:setdate=time-80} </strong></span>format, where the number
    specifies minutes.</p><p><span class="bold"><strong>{:julian}</strong></span> Inserts Julian day number
    - Julian dates (abbreviated JD) are simply a continuous count of days and
    fractions since noon Universal Time on January 1, 4713 BCE (on the Julian
    calendar). This macro is useful if a URL uses a continuous counter and
    each new day increases it. You can use <span class="bold"><strong>{:julian+1000}</strong></span> or <span class="bold"><strong>{:julian-500}</strong></span> forms of the macro to offset the
    resulting number.</p><p><span class="bold"><strong>{:JavaScriptTime}</strong></span> Inserts the current date/time as a
    number in JavaScript format.</p><p>To redefine the standard names of months, you can use the following
    macros:</p><p><span class="bold"><strong>{:#longmonths:January,February,...,November,December}
    </strong></span>and<span class="bold"><strong>
    {:#shortmonths:J,F,M,A,M,J,J,A,S,O,N,D}.</strong></span> They are especially
    good if you are downloading sites that use month names in another language
    or your system default month names are different from what a site
    uses.</p><p>When a date or a sequence repeats in a URL, the following macro will
    help:</p><p>http://www.srv.com/dir<span class="bold"><strong>{:5..7#1}</strong></span>/file{:#1}.htm</p><p>This will generate the following three URLs:</p><p>http://www.srv.com/dir5/file5.htm</p><p>http://www.srv.com/dir6/file6.htm</p><p>http://www.srv.com/dir7/file7.htm</p><p>A more complex format allows you to increment or decrement the
    second part: http://www.srv.com/dir<span class="bold"><strong>{:5..7#1}</strong></span>/file<span class="bold"><strong>{:#1+10}.</strong></span>htm</p><p>http://www.srv.com/dir5/file15.htm</p><p>http://www.srv.com/dir6/file16.htm</p><p>http://www.srv.com/dir7/file17.htm</p><p>You can also use ...<span class="bold"><strong>{:#1-10}...
    </strong></span></p><p>You can use URL Macros in POST request, AutoExport= and other lines
    - every line in the URLs field that contains URL Macros will be processed.
    The following macros could be useful in addition to the auto export
    feature:</p><p><span class="bold"><strong>{:MapFile} </strong></span>inserts the full path to
    the Project Map (.map) file with the list of all files that were
    downloaded by the Project.</p><p><span class="bold"><strong>{:IID}</strong></span> inserts the Project ID
    number.</p><p><span class="bold"><strong>{:DD}</strong></span>inserts
    the full path to the Download directory where Project stores downloaded
    files.</p><p><span class="bold"><strong>{:ProjectName}</strong></span>inserts
    the project name. Can be useful in macros that call executables and pass command-line
    parameters to them.</p><p>URL Macros can be also used in <a href="PropFilters.html" title="Project Properties dialog: URL filters sections">URL
    Filters</a> (Included/Excluded keywords lists in Server, Directory and
    Filename sections) and in <a href="Substitutes.html" title="URL Substitutes">URL
    Substitutes.</a></p><p>The support of URL Macros in URL Filters allows you to create
    universal templates for certain Web sites. A new set of macros is
    introduced for this purpose:</p><p><span class="bold"><strong>{:server} </strong></span> inserts the starting
    server name from the URLs field. For example, <span class="bold"><strong>www.site.com</strong></span></p><p><span class="bold"><strong>{:domain} </strong></span> inserts the domain of the
    server from the URLs field. For example, if the URL is http://www.site.com,
    its domain will be <span class="bold"><strong>site.com</strong></span></p><p><span class="bold"><strong>{:dir} </strong></span> inserts the starting
    directory name from the URLs field. For example, <span class="bold"><strong>/directory/sub/</strong></span></p><p><span class="bold"><strong>{:filename}</strong></span> inserts the starting
    filename from the URLs field. For example, <span class="bold"><strong>file.asp?param</strong></span></p><p><span class="bold"><strong>Variables</strong></span></p><p>You may define your own variables:</p><p><span class="bold"><strong>{:myserv=metaproducts}</strong></span></p><p><span class="bold"><strong>http://www.{:myserv}.com/</strong></span></p><p>They help to make a universal Project that can be easily
    copied for downloading other sites. The macro variable can be used in URL Filters
    keywords and URL Substitutes rules.</p><p>If you have several URLs in the URLs field, Portable Offline Browser creates several
    URL Filters keywords - one per each of the specified URLs.</p></div></body></html>
