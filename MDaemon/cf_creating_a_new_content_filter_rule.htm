<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
   <title>Creating a New Content Filter Rule</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="Creating,Creating New Content Filter Rule">
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <link type="text/css" href="styles.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style TYPE="text/css" media="screen"> 
   <!-- 
   body {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
   } 
    #idheaderbg  {
    background: #FFFFFF; 
   }

/* Set the padding in the OUTER div for MSIE and CHM to prevent the 
   width bug and the horizontal scrollbar bug from activating. */ 
  
  #idcontent {    
      width: 100%; 
      padding: 0px !important; 
      padding: 10px 15px 5px 10px; 
     } 

/* Set the padding in the INNER div for all other browsers. */ 
   
  #innerdiv {    
      padding: 10px 5px 5px 10px !important;  
      padding: 0px; 
     } 
   
/* These styles are for the header, the print link 
   and the navigation links. Change .topichead padding
   to 5px 5px 0px 5px if you use the Print Topic link.  */

    .topichead {
       padding: 5px;
    }
    
    .navlinks {
      font-size: 10pt;
    }
    .navlinks a {
      text-decoration: none;
      color: blue;
    }
    .navlinks a:visited {
      text-decoration: none;
      color: blue;
    }
    .navlinks a:hover {
      text-decoration: underline;
      color: blue;
    }
    
   html.nonscroll { 
      overflow:hidden; 
    } 
   body.nonscroll {    
      overflow:hidden; 
      height:100%; 
    } 
   div.nonscroll { 
      overflow:auto; 
    } 
   -->
</style>
   
<style TYPE="text/css" MEDIA="print">
<!--
/* Hide navigation links and add space between header
     and text in the printed version. Not valid for eBooks. */
#idnav { display:none;	 }
.topichead { padding: 5px 5px 20px 5px; }
-->
</style>   

<!-- Style classes for hyperlinks, and float style for paragraph icon drop-ins -->
<style type="text/css">
  img#icon-float-left { float:left; padding: 0px 6px 0px 0px; }

  a {color: #a00; text-decoration: none}
  a:visited {color: #a00}
  a:hover {color: #000; text-decoration: underline}
  a.weblink {color: #a00; text-decoration: underline}
  a.weblink:visited {color: #a00}
  a.weblink:hover {color: #000; text-decoration: underline}
  a.popuplink {color: #a00; text-decoration: none}
  a.popuplink:visited {color: #a00}
  a.popuplink:hover {color: #000; font-weight: bold; text-decoration: underline}
  a.filelink {color: #a00; text-decoration: underline}
  a.filelink:visited {color: #a00}
  a.filelink:hover {color: #000; text-decoration: underline}
  a.inline-toggle {color: #a00; text-decoration: none}
  a.inline-toggle:visited {color: #a00}
  a.inline-toggle:hover {color: #000; text-decoration: underline}

  .fsmall {
  font-size: 10px;
	font-family: Verdana, Helvetica, sans-serif;
	text-align: center;
	margin: 10px 0px 0px 0px;
	}

  .crumbs {font-size: 8pt; margin-bottom: 3px; margin-top: 0px; color: #000}
  .crumbs a {text-decoration: none; color: #a00}
  .crumbs a:visited {text-decoration: none; color: #a00}
  .crumbs a:hover {color: #000; text-decoration: underline;}
  .expander {text-align: right; padding: 0; width: 100%; font-family: Verdana, Helvetica, sans-serif; font-size:9px; font-weight: bold; border-bottom: 2px; border-bottom-style: solid; border-bottom-color: grey; margin-bottom: 1px;}
</style>
 

<script type="text/javascript" src="helpman_topicinit.js"></script>
</head>
<body>
<!--ZOOMSTOP-->

<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; color: #000; background: #fff url( gradient_fade_64px.gif) repeat-x top !important;">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   <a href="security_menu.htm">Security Menu</a> &gt; <a href="cf_and_av.htm">Content Filter and AntiVirus</a> &gt; Content Filter Editor &gt; <a href="cf_content_filter_editor.htm">Rules</a>&nbsp;&gt;</p>
   <p class="p_Heading1"><span class="f_Heading1">Creating a New Content Filter Rule</span></p>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    <a href="javascript: print();"
    		onmouseover="document.images.prntr.src='printer_25_h.png'" 
        onmouseout="document.images.prntr.src='printer_25_n.png'"
        ><img name="prntr" border="0" alt="Print this Topic" title="Print this Topic" src="printer_25_n.png"
        ></a>
     <a href="cf_content_filter_editor.htm"
        onmouseover="document.images.prev.src='nav_left_red_32_h.png'" 
        onmouseout="document.images.prev.src='nav_left_red_32_n.png'"
        ><img name=prev src="nav_left_red_32_n.png" border=0 alt="Previous page" title="Previous page"
        ></a><a href="cf_content_filter_editor.htm"
        onmouseover="document.images.main.src='nav_up_blue_24_h.png'" 
        onmouseout="document.images.main.src='nav_up_blue_24_n.png'"><img name=main src="nav_up_blue_24_n.png" border=0 alt="Return to chapter overview" title="Return to chapter overview"
        ></a><a href="cf_modifying_an_existing_content_filter.htm"
        onmouseover="document.images.next.src='nav_right_red_32_h.png'" 
        onmouseout="document.images.next.src='nav_right_red_32_n.png'"><img name=next src="nav_right_red_32_n.png" border=0 alt="Next page" title="Next page"
        ></a>
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
<!--   -->

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p class="p_BodyText-Center"><img src="content-filter_rules_create-rule.zoom80.png" width="477" height="441" border="0" alt="" style="margin:0 auto;margin:0px;"></p>
<p class="p_BodyText"><span class="f_BodyText">This dialog is used for creating Content Filter Rules. It is reached by clicking the </span><span style="font-style: italic;">New Rule</span><span class="f_BodyText"> button on the Content Filter dialog.</span></p>
<p class="p_DialogSectionHeading"><span class="f_DialogSectionHeading">Create Rule</span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">Name this rule</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">Type a descriptive name for your new rule here. By default it will be called &quot;New Rule #n&quot;.</span></p>
<p class="p_DialogSectionHeading"><span class="f_DialogSectionHeading">Conditions...</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">This box lists the conditions that may be applied to your new rule. Click the checkbox corresponding to any condition that you want to be applied to the new rule. Each enabled condition will appear in the Rule Description box below. Most Conditions will require additional information that you will specify by clicking on the Condition</span><span style="font-family: 'Times New Roman'; color: #010100;">'</span><span class="f_ControlIndent">s hyperlink in the Rule Description box.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the [HEADER] contains</span><span class="f_ControlIndent">—Click any of these options to base your rule on the content of those particular message headers. You must specify the text for which to scan. This condition now supports regular expressions. See <a href="cf_using_regular_expressions_in_content_filter.htm">Using Regular Expressions in Your Filter Rules</a>.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the user defined [# HEADER] contains</span><span class="f_ControlIndent">—Click one or more of these options to base the rule on message headers that you will define. You must specify the new header, and the text for which to scan. This condition now supports regular expressions. See <a href="cf_using_regular_expressions_in_content_filter.htm">Using Regular Expressions in Your Filter Rules</a>.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the MESSAGE BODY contains</span><span class="f_ControlIndent">—This option makes the contents of the message body one of the conditions. This condition requires you to specify a text string for which to search. This condition now supports regular expressions. See <a href="cf_using_regular_expressions_in_content_filter.htm">Using Regular Expressions in Your Filter Rules</a>.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the MESSAGE has Attachment(s)</span><span class="f_ControlIndent">—When this option is selected, the rule will be contingent upon the presence of one or more message attachments. No additional information is required.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the MESSAGE SIZE is greater than</span><span class="f_ControlIndent">—Click this option if you want the rule to be based upon the size of the message. The size must be specified in </span><span style="font-family: 'Arial'; font-style: italic; color: #010100;">KB</span><span class="f_ControlIndent">. Default is 10KB.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the MESSAGE HAS A FILE called</span><span class="f_ControlIndent">—This option will scan for a file attachment with a particular name. The filename must be specified. Wildcards such as *.exe and file *.* are permitted.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If message is INFECTED...</span><span class="f_ControlIndent">—This condition is </span><span style="font-size: 15px; font-family: 'Courier New'; color: #010100;">TRUE</span><span class="f_ControlIndent"> when SecurityPlus for MDaemon determines that a message is infected with a virus.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the EXIT CODE from a previous run process is equal to</span><span class="f_ControlIndent">—If a previous rule in your list utilizes the </span><span style="font-family: 'Arial'; font-style: italic; color: #010100;">Run Process</span><span class="f_ControlIndent"> action, you can use this condition to look for a specific exit code from that process.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If the MESSAGE IS DIGITALLY SIGNED</span><span class="f_ControlIndent">—The condition applies to messages that have been digitally signed. No further information is required by this condition.</span></p>
<p style="text-align: justify; margin: 0px 0px 16px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold;">If SENDER is a member of GROUP...</span><span class="f_ControlIndent">—This condition applies to a message when it is sent by an account that is a member of the account Group designated in the rule.</span></p>
<p style="text-align: justify; margin: 0px 0px 16px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold;">If RECIPIENT is a member of GROUP...</span><span class="f_ControlIndent">— This condition applies to a message when its recipient is a member of the account Group designated in the rule.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">If ALL MESSAGES</span><span class="f_ControlIndent">—Click this option if you want the rule to be applied to all messages. No further information is required; this rule will affect every message except those to which a &quot;Stop Processing Rules&quot; or &quot;Delete Message&quot; action has been applied in a previous rule.</span></p>
<p class="p_DialogSectionHeading"><span class="f_DialogSectionHeading">Actions...</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">MDaemon can perform these actions if a message matches the rule</span><span style="font-family: 'Times New Roman'; color: #010100;">'</span><span class="f_ControlIndent">s conditions. A few Actions will require additional information that you will specify by clicking on the Action</span><span style="font-family: 'Times New Roman'; color: #010100;">'</span><span class="f_ControlIndent">s hyperlink in the Rule Description box.</span></p>
<p class="p_ControlIndent"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Delete Message</span><span class="f_ControlIndent">—Selecting this action will cause the message to be deleted.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Strip All Attachments From Message</span><span class="f_ControlIndent">—This action causes all attachments to be stripped from the message.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Move Message To Bad Message Directory</span><span class="f_ControlIndent">—Click this action to cause a message to be moved to the bad message directory.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Skip n Rules</span><span class="f_ControlIndent">—Selecting this action will cause a specified number of rules to be skipped. This is useful in situations where you may want a rule to be applied in certain circumstances but not in others.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span class="f_ControlIndent">For example: you may wish to delete messages that contain the word &quot;Spam&quot;, but not those that contain &quot;Good Spam&quot;. To accomplish this you could create a rule that deletes messages containing &quot;Spam&quot; and then place above it another rule that states &quot;if the message contains &quot;Good Spam&quot; then Skip 1 Rule&quot;.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Stop Processing Rules</span><span class="f_ControlIndent">—This action will skip all remaining rules.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Copy Message To Specified User(s)</span><span class="f_ControlIndent">—Causes a copy of the message to be sent to one or more recipients. You must specify which recipients are to receive the message.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Append Standard Disclaimer</span><span class="f_ControlIndent">—This action makes it possible for you to create a small amount of text that will be appended as a footer to the message. Alternatively, it can add the contents of a text file.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span class="f_ControlIndent">For example: you could use this rule to include a statement that says &quot;This email originated from my company, please direct any complaints or questions to user01@example.com&quot;.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Add Extra Header Item To Message</span><span class="f_ControlIndent">—This action will add an additional header to the message. You must specify the name of the new header and its value.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Delete A Header Item From Message</span><span class="f_ControlIndent">—This action will remove a header from a message. You must specify the header that you wish to delete.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Send Note To...</span><span class="f_ControlIndent"> —This action will send an email to a particular address. You will be able to specify the recipient, sender, subject, and a small amount of text. You can also configure this action to attach the original message to the note.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span class="f_ControlIndent">For example: you might wish to create a rule that will move all messages containing &quot;This is Spam!&quot; to the bad message directory and create another rule that will send a note to someone letting them know that this has been done.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Remove Digital Signature</span><span class="f_ControlIndent">—Click this action to cause a digital signature to be removed from the message.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Run Process...</span><span class="f_ControlIndent">—This action can be used to run a particular program when a message meets the rule</span><span style="font-family: 'Times New Roman'; color: #010100;">'</span><span class="f_ControlIndent">s conditions. You must specify the path to the program that you wish to run. You can use the </span><span class="f_T_Code">$MESSAGEFILENAME$</span><span class="f_ControlIndent"> macro to pass the name of the message to the process, and you can specify whether or not MDaemon should suspend its operations temporarily or indefinitely while it waits for the process to terminate. Further, you can force the process to terminate and/or run it in a hidden window.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Send Message Through SMS Gateway Server...</span><span class="f_ControlIndent">—Click this option to send the message through an SMS Gateway Server. You must supply the Host or IP Address and the SMS phone number.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Copy Message to Folder...</span><span class="f_ControlIndent">—Use this option to place a copy of the message into a specific folder.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">MOVE the messages to custom QUEUE...</span><span class="f_ControlIndent">—Use this action to move the message into one or more previously created custom mail queues. When moving messages to custom remote mail queues you can use the custom scheduling options on the Event Scheduler to control when those messages will be processed.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Add Line To Text File</span><span class="f_ControlIndent">—This option will cause a line of text to be added to a specific text file. When choosing this action you will have to specify the path to the file and the text that you want to be appended to it. You may use certain MDaemon macros in your text to cause the content filter to dynamically include information about the message such as the sender, recipient, message ID, and so on. Click the Macros button on the &quot;Add line to text file&quot; dialog to display a list of permitted macros.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Move Message to Public Folders...</span><span class="f_ControlIndent">—Use this action to cause the message to be moved to one or more Public Folders.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Search and Replace Words in a Header</span><span class="f_ControlIndent">—Use this option to scan a specified header for certain words and then delete or replace them. When creating this rule, click the &quot;specify information&quot; link in the Rule Description to open the &quot;Header – Search and Replace&quot; dialog on which you will designate the header and words to replace or delete. This action now supports regular expressions. See <a href="cf_using_regular_expressions_in_content_filter.htm">Using Regular Expressions in Your Filter Rules</a>.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Search and Replace Words in the Message Body</span><span class="f_ControlIndent">—Use this option to scan the message body and replace any desired text. This action now supports regular expressions. See <a href="cf_using_regular_expressions_in_content_filter.htm">Using Regular Expressions in Your Filter Rules</a>.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Jump to Rule...</span><span class="f_ControlIndent">—Use this action to jump immediately to a rule further down in the list, skipping over all rules between the two.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Sign with DomainKeys selector...</span><span class="f_ControlIndent">—Use this action if you want the rule to cause a message to contain a <a href="security__dkim_sign.htm">DomainKeys signature</a>. You can also use it if you wish to sign some messages using a selector other than the one designated on the DK &amp; DKIM dialog.</span></p>
<p style="margin: 5px 9px 13px 24px;"><span style="font-size: 15px; font-family: 'Courier New'; font-weight: bold; color: #010100;">Sign with DKIM selector...</span><span class="f_ControlIndent">—Use this action if you want the rule to cause a message to contain a <a href="security__dkim_sign.htm">DKIM signature</a>. You can also use it if you wish to sign some messages using a selector other than the one designated on the DK &amp; DKIM dialog.</span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">Rule description</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">This box displays the new rule</span><span style="font-family: 'Times New Roman'; color: #010100;">'</span><span class="f_ControlIndent">s internal script format. Click any of the rule</span><span style="font-family: 'Times New Roman'; color: #010100;">'</span><span class="f_ControlIndent">s conditions or actions (listed as hyperlinks) and the appropriate editor will be opened for specifying any needed information.</span></p>
<p class="p_SeeAlso" style="border-right: none; border-bottom: none; border-left: none;"><span class="f_SeeAlso">See:</span></p>
<p class="p_SeeAlsoLinks"><span class="f_SeeAlsoLinks"><a href="cf_content_filter_editor.htm">Content Filter Editor</a></span></p>
<p class="p_SeeAlsoLinks"><span class="f_SeeAlsoLinks"><a href="cf_modifying_an_existing_content_filter.htm">Modifying an Existing Content Filter Rule</a></span></p>
<p class="p_SeeAlsoLinks"><span class="f_SeeAlsoLinks"><a href="cf_using_regular_expressions_in_content_filter.htm">Using Regular Expressions in Your Filter Rules</a></span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">&nbsp;</span></p>

<!--ZOOMSTOP-->

</div></div>
<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4
).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body>
</html>
