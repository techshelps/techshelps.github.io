<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Reverse Lookup</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="Reverse Lookup">
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <link type="text/css" href="styles.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style TYPE="text/css" media="screen"> 
   <!-- 
   body {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
   } 
    #idheaderbg  {
    background: #FFFFFF; 
   }

/* Set the padding in the OUTER div for MSIE and CHM to prevent the 
   width bug and the horizontal scrollbar bug from activating. */ 
  
  #idcontent {    
      width: 100%; 
      padding: 0px !important; 
      padding: 10px 15px 5px 10px; 
     } 

/* Set the padding in the INNER div for all other browsers. */ 
   
  #innerdiv {    
      padding: 10px 5px 5px 10px !important;  
      padding: 0px; 
     } 
   
/* These styles are for the header, the print link 
   and the navigation links. Change .topichead padding
   to 5px 5px 0px 5px if you use the Print Topic link.  */

    .topichead {
       padding: 5px;
    }
    
    .navlinks {
      font-size: 10pt;
    }
    .navlinks a {
      text-decoration: none;
      color: blue;
    }
    .navlinks a:visited {
      text-decoration: none;
      color: blue;
    }
    .navlinks a:hover {
      text-decoration: underline;
      color: blue;
    }
    
   html.nonscroll { 
      overflow:hidden; 
    } 
   body.nonscroll {    
      overflow:hidden; 
      height:100%; 
    } 
   div.nonscroll { 
      overflow:auto; 
    } 
   -->
</style>
   
<style TYPE="text/css" MEDIA="print">
<!--
/* Hide navigation links and add space between header
     and text in the printed version. Not valid for eBooks. */
#idnav { display:none;	 }
.topichead { padding: 5px 5px 20px 5px; }
-->
</style>   

<!-- Style classes for hyperlinks, and float style for paragraph icon drop-ins -->
<style type="text/css">
  img#icon-float-left { float:left; padding: 0px 6px 0px 0px; }

  a {color: #a00; text-decoration: none}
  a:visited {color: #a00}
  a:hover {color: #000; text-decoration: underline}
  a.weblink {color: #a00; text-decoration: underline}
  a.weblink:visited {color: #a00}
  a.weblink:hover {color: #000; text-decoration: underline}
  a.popuplink {color: #a00; text-decoration: none}
  a.popuplink:visited {color: #a00}
  a.popuplink:hover {color: #000; font-weight: bold; text-decoration: underline}
  a.filelink {color: #a00; text-decoration: underline}
  a.filelink:visited {color: #a00}
  a.filelink:hover {color: #000; text-decoration: underline}
  a.inline-toggle {color: #a00; text-decoration: none}
  a.inline-toggle:visited {color: #a00}
  a.inline-toggle:hover {color: #000; text-decoration: underline}

  .fsmall {
  font-size: 10px;
	font-family: Verdana, Helvetica, sans-serif;
	text-align: center;
	margin: 10px 0px 0px 0px;
	}

  .crumbs {font-size: 8pt; margin-bottom: 3px; margin-top: 0px; color: #000}
  .crumbs a {text-decoration: none; color: #a00}
  .crumbs a:visited {text-decoration: none; color: #a00}
  .crumbs a:hover {color: #000; text-decoration: underline;}
  .expander {text-align: right; padding: 0; width: 100%; font-family: Verdana, Helvetica, sans-serif; font-size:9px; font-weight: bold; border-bottom: 2px; border-bottom-style: solid; border-bottom-color: grey; margin-bottom: 1px;}
</style>
 

<script type="text/javascript" src="helpman_topicinit.js"></script>
</head>
<body>
<!--ZOOMSTOP-->

<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; color: #000; background: #fff url( gradient_fade_64px.gif) repeat-x top !important;">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   <a href="security_menu.htm">Security Menu</a> &gt; Security Settings &gt; Security Settings&nbsp;&gt;</p>
   <p class="p_Heading1"><span class="f_Heading1">Reverse Lookup</span></p>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    <a href="javascript: print();"
    		onmouseover="document.images.prntr.src='printer_25_h.png'" 
        onmouseout="document.images.prntr.src='printer_25_n.png'"
        ><img name="prntr" border="0" alt="Print this Topic" title="Print this Topic" src="printer_25_n.png"
        ></a>
     <a href="security__ip_shielding.htm"
        onmouseover="document.images.prev.src='nav_left_red_32_h.png'" 
        onmouseout="document.images.prev.src='nav_left_red_32_n.png'"
        ><img name=prev src="nav_left_red_32_n.png" border=0 alt="Previous page" title="Previous page"
        ></a><a href="security_menu.htm"
        onmouseover="document.images.main.src='nav_up_blue_24_h.png'" 
        onmouseout="document.images.main.src='nav_up_blue_24_n.png'"><img name=main src="nav_up_blue_24_n.png" border=0 alt="Return to chapter overview" title="Return to chapter overview"
        ></a><a href="security__pop_before_smtp.htm"
        onmouseover="document.images.next.src='nav_right_red_32_h.png'" 
        onmouseout="document.images.next.src='nav_right_red_32_n.png'"><img name=next src="nav_right_red_32_n.png" border=0 alt="Next page" title="Next page"
        ></a>
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
<!--   -->

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p class="p_BodyText-Center"><img src="security-settings_reverse-lookups.zoom75.png" width="503" height="360" border="0" alt="" style="margin:0 auto;margin:0px;"></p>
<p class="p_BodyText"><span class="f_BodyText">With the options on this screen, MDaemon can be configured to do a reverse lookup on the domain passed in the </span><span style="font-family: 'Courier New'; color: #010100;">HELO/EHLO</span><span class="f_BodyText"> and </span><span style="font-family: 'Courier New'; color: #010100;">MAIL</span><span class="f_BodyText"> commands. When performing the lookups MDaemon will attempt to acquire all of the MX and A record IP addresses for the given domain. Then the IP of the server making the connection is compared to this list in an attempt to determine whether the sender might be using a forged identity.</span></p>
<p class="p_BodyText"><span class="f_BodyText">Oftentimes the sending mail server</span><span style="font-family: 'Times New Roman'; color: #010100;">'</span><span class="f_BodyText">s IP address will not match any known MX or A records for a given domain and yet still be delivering the mail legitimately. The purpose of the Reverse Lookup process is therefore not to exclude mail but to include as much information as possible in the log files, and to provide the means whereby the postmasters can act according to their own local policies regarding these suspicious messages. To that end, an option exists that makes it possible for a special header to be inserted into all messages that do not pass a reverse lookup. The content filter system can then be used to determine the fate of messages containing the header.</span></p>
<p class="p_BodyText"><span class="f_BodyText">You can also perform reverse lookups on pointer records (PTR) of incoming IP addresses. When using this option the connection can be aborted or a warning header inserted into the message if the incoming IP address does not match any PTR record.</span></p>
<p class="p_BodyText"><span class="f_BodyText">Finally, it is generally agreed that accepting mail from sources that identify themselves by using a domain that does not exist should be optional. Therefore, a switch exists that makes it possible for you to refuse messages for which the reverse lookup process returns a &quot;domain not found&quot; message from the DNS server. In such cases, MDaemon will return a </span><span style="font-family: 'Courier New'; color: #010100;">451</span><span class="f_BodyText"> error code, refuse to accept the message, and then allow the SMTP session to progress. However, should you wish to return a </span><span style="font-family: 'Courier New'; color: #010100;">501</span><span class="f_BodyText"> error code, close the socket connection, or do both, other switches are provided for those purposes.</span></p>
<p class="p_BodyText"><span class="f_BodyText">Trusted IP addresses and localhost (127.0.0.1) are always exempt from reverse lookups.</span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">Perform PTR lookup on inbound SMTP connections</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">Enable this option if you want MDaemon to perform pointer record lookups on all inbound SMTP connections.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">...send 501 and close connection if no PTR record exists (caution)</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">If this box is checked then MDaemon will send a </span><span style="font-family: 'Courier New'; color: #010100;">501</span><span class="f_ControlIndent2"> error code (syntax error in parameters or arguments) and close the connection if no PTR record exists for the domain.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">...send 501 and close connection if no PTR record match</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">If this box is checked then MDaemon will send a </span><span style="font-family: 'Courier New'; color: #010100;">501</span><span class="f_ControlIndent2"> error code (syntax error in parameters or arguments) and close the connection if the result of a pointer record lookup fails to match.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">Exempt authenticated sessions (lookup will defer until after MAIL)</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">Click this option if you wish to defer the PTR lookup on inbound SMTP connections until after the SMTP MAIL command in order to see whether or not the connection will use authentication.</span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">Perform lookup on HELO/EHLO domain</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">Click this box if you want a lookup to be performed on the domain name that is reported during the </span><span style="font-family: 'Courier New'; color: #010100;">HELO/EHLO</span><span class="f_ControlIndent"> portion of the session. The </span><span style="font-family: 'Courier New'; color: #010100;">HELO/EHLO</span><span class="f_ControlIndent"> command is used by the client (sending machine) to identify itself to the server. The domain name passed by the client in this command is used by the server to populate the </span><span style="font-family: 'Courier New'; color: #010100;">from</span><span class="f_ControlIndent"> portion of the </span><span style="font-family: 'Courier New'; color: #010100;">Received</span><span class="f_ControlIndent"> header.</span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">Perform lookup on value passed in the MAIL command</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">Enabling this switch will cause a lookup to be performed on the domain name that is passed during the </span><span style="font-family: 'Courier New'; color: #010100;">MAIL</span><span class="f_ControlIndent"> command portion of the mail transaction. The address passed in the </span><span style="font-family: 'Courier New'; color: #010100;">MAIL</span><span class="f_ControlIndent"> command is supposed to be the reverse-path for the message, and is usually the mailbox from which the message is originating. Sometimes, however, it is the address to which error messages should be directed instead.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">...send 501 and close connection on forged identification (caution)</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">Click this check box if you want a 501 error code to be sent and then the connection closed when the result of a lookup appears to be a forged identification.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 49px 14px 48px;"><table cellspacing="0" cellpadding="5" bgcolor="#ffffe6" border="1" style="background-color: #ffffe6; border: solid 1px #000000; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top" width="50" style="width:50px; height:50px; border: none"><p class="p_NoFormat"><img src="forbidden_50_yback.gif" width="50" height="50" border="0" alt=""></p>
</td>
<td valign="top" style="border: none"><p class="p_Notes"><span class="f_Notes">When the result of a reverse lookup states that the server is using a forged identification, this result may frequently be incorrect. It is very common for mail servers to identify themselves with values that do not match their IP addresses. This can be due to ISP limitations and restrictions and other legitimate reasons. For this reason, you should exercise caution before enabling this option. It is likely that using this option could result in your server refusing some legitimate messages.</span></p>
</td>
</tr>
</table>
</div>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">Refuse to accept mail if a lookup returns no MX records (caution)</span><span style="font-size: 11px; font-family: 'Times New Roman'; font-weight: bold;">'</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">Check this box if you wish to refuse MAIL from domains that do not have MX records. This option is disabled by default and should be used with caution, because domains do not need MX records in order to exist, be valid, or send/receive mail.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">Refuse to accept mail if a lookup returns </span><span style="font-size: 11px; font-family: 'Times New Roman'; font-weight: bold;">'</span><span class="f_ControlHeading2">domain not found</span><span style="font-size: 11px; font-family: 'Times New Roman'; font-weight: bold;">'</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">When a lookup results in &quot;</span><span style="font-family: 'Courier New'; color: #010100;">domain not found</span><span class="f_ControlIndent2">&quot;, enabling this option will cause the message to be refused with a </span><span style="font-family: 'Courier New'; color: #010100;">451</span><span class="f_ControlIndent2"> error code (Requested action aborted: local error in processing) and then the session will be allowed to progress normally to its conclusion.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">...send 501 error code (normally sends 451 error code)</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">Enable this checkbox if you want the error code that is sent in response to a &quot;domain not found&quot; result to be </span><span style="font-family: 'Courier New'; color: #010100;">501</span><span class="f_ControlIndent2"> (syntax error in parameters or arguments) instead of </span><span style="font-family: 'Courier New'; color: #010100;">451</span><span class="f_ControlIndent2">.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">...and then close the connection</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">Click this checkbox if you want the connection to be closed immediately instead of allowed to progress when &quot;</span><span style="font-family: 'Courier New'; color: #010100;">domain not found</span><span class="f_ControlIndent2">&quot; is the result of the reverse lookup.</span></p>
<p class="p_ControlHeading2"><span class="f_ControlHeading2">Exempt authenticated sessions (lookup will defer until after MAIL)</span></p>
<p class="p_ControlIndent2"><span class="f_ControlIndent2">Click this option if you wish to defer the lookup until after the SMTP MAIL command in order to see whether or not the connection will use authentication.</span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">Insert lookup results headers into messages</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">Click this checkbox if you want special headers containing the results of the reverse lookups to be included in the message headers. MDaemon will insert one or more of the following headers, depending on which types of lookups you have set MDaemon to perform: &quot;</span><span class="f_PlainText">X-MDPtrLookup-Result:</span><span class="f_ControlIndent">&quot;, &quot;</span><span class="f_PlainText">X-MDHeloLookup-Result:</span><span class="f_ControlIndent">&quot;, and &quot;</span><span class="f_PlainText">X-MDMailLookup-Result:</span><span class="f_ControlIndent">&quot;.</span></p>
<p class="p_ControlHeading"><span class="f_ControlHeading">White list</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">Click this button to open the Reverse Lookup White List dialog. On it you can designate IP addresses, domains, and hosts that you wish to be exempt from reverse lookups.</span></p>
<p class="p_ControlIndent"><span class="f_ControlIndent">&nbsp;</span></p>

<!--ZOOMSTOP-->

</div></div>
<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4
).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
