<html dir="ltr" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:xlink="http://www.w3.org/1999/xlink">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="save" content="history" />
    <xml>
      <MSHelp:TOCTitle Title="Integrating the WPF CAB Libraries with the Composite UI Application Block" />
      <MSHelp:RLTitle Title="Integrating the WPF CAB Libraries with the Composite UI Application Block" />
      <MSHelp:Attr Name="DocSet" Value="docSet" />
      <MSHelp:Attr Name="TopicType" Value="kbOrient" />
      <MSHelp:Attr Name="Locale" Value="kbEnglish" />
      <MSHelp:Attr Name="AssetID" Value="8c286aa5-fc76-4a54-8880-ebab7c3dab2d" />
    </xml>
    <title>Integrating the WPF CAB Libraries with the Composite UI Application Block</title>
    <link rel="stylesheet" type="text/css" href="../local/Classic.css" />
    <script src="../local/EventUtilities.js" type="text/jscript" language="jscript"> </script>
    <script src="../local/SplitScreen.js" type="text/jscript" language="jscript"> </script>
    <script src="../local/Dropdown.js" type="text/jscript" language="jscript"> </script>
    <script src="../local/script.js" type="text/jscript" language="jscript"> </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle" />
    <input type="hidden" id="hiddenScrollOffset" />
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="DropDown image" src="../local/drpdown.gif" />
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif" />
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif" />
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif" />
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif" />
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif" />
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif" />
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif" />
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Integrating the WPF CAB Libraries with the Composite UI Application Block</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td />
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0" style="cursor:default;">
              <img id="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif" />
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label>&#xA0;</span>
            <span id="languageFilterToolTip" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0" style="cursor:default;display:none;">
              <img id="languageFilterImage" alt="DropDown image" src="../local/drpdown.gif" />
              <label id="showAllLabel" for="languageFilterImage" style="display: none;">Language Filter: All</label>
              <label id="multipleLabel" for="languageFilterImage" style="display: none;">Language Filter: Multiple</label>
              <label id="vbLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic</label>
              <label id="csLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
            </span>
          </td>
        </tr>
      </table>
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" />
        <p />
        <p>Microsoft UII for Microsoft Dynamics CRM uses the Microsoft patterns &amp; practices Composite UI Application Block for messaging, visual containment, application loading, state management, and so on. The Composite UI Application Block is designed for applications based on Windows Forms, but UII requires the Composite UI Application Block extensions for Windows Presentation Foundation (WPF) that are implemented by integrating the WPF CAB libraries available from CodePlex. </p>
        <p>
          <b>To integrate the WPF CAB libraries with the Composite UI Application Block</b>
        </p>
        <ol>
          <li>Download the WPF CAB source code from the <a href="http://wpfcab.codeplex.com/releases/view/2005">WPF layer for CAB</a> page on CodePlex.</li>
          <li>Extract the contents of the compressed file to a folder (for example, C:\WPFCAB Source\).</li>
          <li>Open the solution file CompositeUI solution file located in the <b>WPFCAB</b> source code folder.</li>
          <li>Expand the CompositeUI.Windows project.</li>
          <li>In the <b>References</b> folder of the project, remove the references for CompositeUI and ObjectBuilder.</li>
          <li>Right-click the <b>References</b> folder and then click <b>Add Reference</b>.</li>
          <li>Click <b>Browse</b>, and then select the files Microsoft.UII.Practices.CompositeUI.dll and Microsoft.UII.Practices.ObjectBuilder.dll in the folder <i>[Install Directory]</i>\Framework.</li>
          <li>In the <b>WorkSpaces</b> folder of the project, open the ZoneWorkspace.cs file. </li>
          <li>Comment the following method.
        <div class="code">
          <span codeLanguage="CSharp">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>C#</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code</span>
                </th>
              </tr>
              <tr><td colspan="2"><pre>void IComposableWorkspace&lt;FrameworkElement, ZoneSmartPartInfo&gt;.RaiseSmartPartActivating(WorkspaceCancelEventArgs e)
    {
        OnSmartPartActivating(e);}</pre></td></tr>
            </table>
          </span>
        </div>
      <br /></li>
          <li>Change the return types of the following methods from <b>bool</b> to <b>void</b>, as shown in the following table.<table style=""><tr valign="top"><th><p>Method</p></th><th><p>Edited method</p></th></tr><tr valign="top"><td><p>public bool Activate(object smartPart)</p><p>{</p><p>return _composer.Activate(smartPart);</p><p>}</p></td><td><p>public void Activate(object smartPart)</p><p>{</p><p>_composer.Activate(smartPart);</p><p>}</p></td></tr><tr valign="top"><td><p>public bool Show(object smartPart, ISmartPartInfo smartPartInfo)</p><p>{</p><p>return _composer.Show(smartPart, smartPartInfo);</p><p>}</p></td><td><p>public void Show(object smartPart, ISmartPartInfo smartPartInfo)</p><p>{</p><p>_composer.Show(smartPart, smartPartInfo);</p><p>}</p></td></tr><tr valign="top"><td><p>public bool Show(object smartPart)</p><p>{</p><p>return _composer.Show(smartPart);</p><p>}</p></td><td><p>public void Show(object smartPart)</p><p>{</p><p>_composer.Show(smartPart);</p><p>}</p></td></tr></table><br /></li>
          <li>Repeat steps 9 and 10 for the files DeckWorkspace.cs and TabWorkspace.cs.</li>
          <li>Compile the CompositeUI.Windows solution. The build process creates the Microsoft.Practices.CompositeUI.Windows.dll file in the build output folder.</li>
          <li>Copy the DLL file to the UII framework folder (<i>[Install Directory]</i>\Microsoft Uii\Framework), as shown in the following illustration.<br /><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" src="../local/note.gif" />Note:</th></tr><tr><td><b>Note</b>: Copy Microsoft.Practices.CompositeUI.Windows.dll to the framework folder <i>[Install Directory]</i>\Microsoft Uii\Framework. This is a modified version of the <b>WPFCAB</b> assembly.</td></tr></table><p /></div><br /><p><img src="images/1bad08ef-886d-445f-a3eb-388274dd4aae.png" /></p><br /></li>
          <li>Compile the Integrated Agent Desktop project. </li>
        </ol>
        <br />
        <br />
      </div>
      <div id="topicLinks" class="navigationLinks">
        <a href="docSet_04027c38-1901-4cf3-a62f-b6fcd0fd52e5.html">Next Topic</a>
        <span> | </span>
        <a href="docSet_cbd35c40-2aa5-4f9b-8a7a-357d1b83e579.html">Previous Topic</a>
        <span> | </span>
      </div>
      <div id="homeCommunityLinks" class="navigationLinks">
        <a href="http://msdn.microsoft.com">Home</a>
        <span> | </span>
        <a href="http://www.codeplex.com">Community</a>
      </div>
      <div id="footer" style="float: left;">
        <div class="footerLine">
          <img src="../images/footer.gif" alt="Footer image" width="100%" height="3px" />
          <p>Copyright &#xA9; 2013 by Microsoft Corporation. All rights reserved.</p>
        </div>
        <p>
          <a href="mailto:?subject=Integrating the WPF CAB Libraries with the Composite UI Application Block" />
        </p>
        <p />
      </div>
    </div>
  </body>
</html>
