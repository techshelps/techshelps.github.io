<HTML>
<HEAD>
<TITLE>Presenting Results in PowerPoint</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch08d.htm" , "ch08f.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="296"><h1>Presenting Results in PowerPoint</h1></A>
<p>You use slide presentations to communicate information to an audience, and
PowerPoint presentations are especially effective because they organize information in
screen-size segments that audiences can absorb quickly. When you add the Excel chart to
the presentation, you convey data results in an easy-to-understand format.</p>

<A NAME="297"><h2><i>Create a Presentation</i></h2></A>
<ol>
<p><li> In the Visual Basic Editor, click Module on the Insert menu to create a
new code module.</li></p>

<p><li> Add the following <i>CreatePowerPointPres</i> procedure:</li></p>


<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Sub CreatePowerPointPres()
    Dim appPPT As New PowerPoint.Application
    Dim presEnergy As PowerPoint.Presentation
    Dim sldUsage As PowerPoint.Slide
    Dim sgBottom As Single   
End Sub
</pre>
</td></tr>
</table>
</p>

<p>The first declaration defines the variable <i>appPPT</i> as a new instance of the
PowerPoint Application object. The use of the keyword New in the declaration statement
indicates that the first time you use the variable <i>appPPT</i> in code, you create a
new instance. The second and third declarations define a <i>Presentation</i> object and
a <i>Slide</i> object, respectively. The final declaration in the <i>
CreatePowerPointPres</i> procedure defines the variable <i>sgBottom</i> as a Single
data type, which is set to the bottom coordinate of the first slide's title
shape.</p>


<p><li> Add the following Set statements and With&#8230;End block after the
declarations in the <i>CreatePowerPointPres</i> procedure:</li></p>


<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Set presEnergy = appPPT.Presentations.Add
Set sldUsage = presEnergy.Slides.Add(1, ppLayoutTitleOnly)
With sldUsage.Shapes.Placeholders(1)
    With .TextFrame.TextRange
        .Text = &quot;Energy Usage - &quot; &amp; g_sCircuit
        .Font.Bold = True
        .ChangeCase ppCaseUpper
    End With
    sgBottom = .Top + .Height
End With
</pre>
</td></tr>
</table>
</p>

<p>You add the new presentation to the PowerPoint Application object in the first Set
statement, and you add a new slide to the new presentation in the second Set statement.
The new slide has the Title Only layout, which contains only a Title placeholder and no
other preset shapes. The With&#8230;End block following the two Set statements accesses
the properties of the Title placeholder to set the text, make the font bold, and change
the case to uppercase. The last line in the With&#8230;End block sets the variable <i>
sgBottom</i> to the sum of the top coordinate of the Title placeholder plus its
height.</p>


<p><li> After the With&#8230;End block you added in the previous step, add the
following With&#8230;End block. This will add the Excel chart to the first slide in the
presentation:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
g_chtUsage.ChartArea.Copy
With sldUsage.Shapes.Paste
    .Top = sgBottom + 20
    .Height = sldUsage.Master.Height - sgBottom + 20
    .Left = sldUsage.Master.Width / 2 - .Width / 2
End With
</pre>
</td></tr>
</table>
</p>

<p>In order to add the Excel chart to the PowerPoint presentation, you copy the chart
area to the Clipboard and paste it into the <i>Shapes</i> collection of the first slide
in the presentation. The With&#8230;End block then sets the top and left coordinates and
the height of the newly pasted chart shape.</p>


<p><li> After the With&#8230;End block, above End Sub, add the following two lines
to save the presentation with the filename &quot;EnergyPres,&quot; and to display the
PowerPoint application window:</li></p>


<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
presEnergy.SaveAs g_sDBProjectPath &amp; &quot;EnergyPres&quot;
appPPT.Visible = True
</pre>
</td></tr>
</table>
</p>

<p><li> In the Properties window in the Visual Basic Editor, change the Name
property of the code module to modPowerPoint.</li></p>

<p><li> Click the Save button on the Standard toolbar in the Visual Basic Editor
to save changes to the code.</li></p>


<p>You've now added all the code needed to create a PowerPoint presentation.</p>
</ol>

<A NAME="298"><h2><i>Test Your Code</i></h2></A>
<ol>
<p><li> Double-click the modMain project item in the Project Explorer to make the
code window active.</li></p>

<p><li> In the modMain code module, add the following procedure.</li></p>


<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Sub TestCreatingPowerPointPresentation()
    g_sDBProjectPath = Application.CurrentProject.Path &amp; &quot;\&quot;
    modExcel.CreateExcelSheet
    GetDatabaseInfo bReport:=<b>False</b>, bSheet:=<b>False</b>, _
        bPres:=<b>True</b>, bUpdateForm:=<b>False</b>
    modExcel.CreateChart
    modPowerPoint.CreatePowerPointPres
End Sub
</pre>
</td></tr>
</table>
</p>
</ol>

<p>Note the values of the arguments passed to the <i>GetDatabaseInfo</i> procedure. You
set the first argument, <i>bReport,</i> to False because a report created in Word is
not required. You set the second argument, <i>bSheet,</i> also to False. However, 
because you set the third argument, <i>bPres,</i> to True, an Excel spreadsheet and
chart are created in order to copy the chart to the presentation created in PowerPoint.
You set the last argument, <i>bUpdateForm,</i> to False because the Access form is not
displayed.</p> 

<p>When you run the procedure above, the slide should appear as follows: </p>

<p>
<A HREF="javascript:fullSize('G08ovb09x.htm')"> <img src="images/G08ovb09.JPG" width=404 height=319 border=0 ALT = "Click to view at full size."> </A>
</p>


</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>






