<HTML>
<HEAD>
<TITLE>Advanced Scenarios</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch10e.htm" , "ch10g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="405"><h1>Advanced Scenarios</h1></A>
<p>This chapter has so far discussed a common scenario in which you update your custom
command bar controls based on the current selection. Because it 
depends on what is selected and the current view, the state of the command bars is
updated constantly in each of the Office applications. With the combination of the
selection change and window activate events, you can mimic the behavior of built-in
command bar controls with your own control customizations.</p>

<A NAME="406"><h2>Tracking Documents and Active Windows Using a Custom Window Menu</h2></A>
<p>The Window menu contains a list of active document windows; this not only allows the
user to switch between document windows, but also shows which window is the active one.
A combination of events is used to update the Window menu in Word, Excel, and
PowerPoint. </p>

<p>On the CD-ROM version of this book, the file WndMenu2.xls shows how you can use a
combination of events such as window activate, window deactivate, and command bar
control clicks to build your own custom window menu. Open the WndMenu2.xls file in
Excel and click <font size="-2">ALT+F11</font> to display the Visual Basic for Applications project for this
workbook.</p>

<p>When the workbook WndMenu2.xls is opened, the <i>Workbook_Open</i> event procedure in
the ThisWorkbook project item of the workbook is executed. The custom <i>Init</i>
procedure in the Main code module is called, where the Excel event procedures are set
up. The <i>InsertMenu</i> procedure is called from within the <i>Init</i> procedure and
it creates the custom window menu called Window2. The <i>InsertMenu</i> procedure also
sets up the button Click event for any custom command added to the Window2 menu.</p> 

<p>As you open and close workbooks, each workbook's name is either added to or removed
from the Window2 menu. When each window is activated, a check mark appears in the
Window and Window2 menu adjacent to the name of the workbook that is then active. The
WindowActivate and WindowDeactivate events in Excel update where the check mark appears
in the custom Window2 menu.</p> 

<p>Finally, when a custom command is clicked on the Window2 menu, the button Click event
procedure within the <i>CmdBarEvents</i> event class is called. The event procedure
determines which workbook should be activated and adds a check mark on the custom
command that was clicked. When the workbook is closed, the <i>Workbook_BeforeClose</i>
procedure in the ThisWorkbook class module is called. In this procedure, the <i>
Uninit</i> procedure in the Main code module is called and the Window2 menu is deleted.
The lists in the built-in Window menu and the custom Window2 menu will look identical,
as the following figures reveal.</p>

<p>
<A HREF="javascript:fullSize('G10ovb02x.htm')"> <img src="images/G10ovb02.JPG" width=404 height=256 border=0 ALT = "Click to view at full size."> </A>
</p>


<p>
<A HREF="javascript:fullSize('G10ovb03x.htm')"> <img src="images/G10ovb03.JPG" width=404 height=153 border=0 ALT = "Click to view at full size."> </A>
</p>


</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>






