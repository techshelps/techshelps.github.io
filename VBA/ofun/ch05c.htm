<HTML>
<HEAD>
<TITLE>The Document New Event</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05b.htm" , "ch05d.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="168"><h1>The Document New Event</h1></A>
<p>The procedure for the document New event is called <i>after</i> you create a new
document. Word, Excel, or PowerPoint create a new document, display it, and then, if
it's set up in your program, call the document New event. This event can't be
cancelled. You can create new documents with the New command on the File menu or on the
Standard toolbar. The <i>Add</i> method on the <i>Documents, Workbooks</i>, and <i>
Presentations</i> collection objects, described in the 
<a href="ch04a.htm#117">previous chapter</a>, also triggers
the <i>New</i> event procedure.</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Sub App_NewDocument(ByVal Doc As Document)
Sub App_NewWorkbook(ByVal Wb As Workbook)
Sub App_NewPresentation(ByVal Pres As Presentation)
</pre>
</td></tr>
</table>
</p>

<p>There are no differences in how the New event is defined in each application or when
it's called. In all three applications, the application creates the document first
and then calls the event procedure. PowerPoint calls the <i>NewPresentation</i> event procedure after it creates the presentation but
before it displays the New Slide. As previously noted, however, PowerPoint
doesn't 
allow your code to perform operations like closing the newly created presentation in
the <i>NewPresentation</i> event procedure. If the <i>NewPresentation</i> event
procedure executes the code <font face="courier new" size="-1">Pres.Close</font>, an error will occur.</p>

<A NAME="169"><h2>Example Scenario</h2></A>
<p>The following examples for Word, Excel, and PowerPoint each perform the same
operation: when you create a new document, the application adds the text <i>Created
on</i>, followed by the current date and time, to the footer at the bottom left of each
page. The text format for the footer is italicized. The date and time values are static
once they're inserted so their values do not change as the date and time changes.
Although the code to indicate the date format m/d/yy and the hours:minutes and am/pm
formats is different in each application, the same date and time format is
inserted.</p>

<A NAME="170"><h2><i>Set Up the NewDocument Event in Word</i></h2></A>
<p>Before following the steps below, make sure you complete steps 1, 2, and 4 in the
section &quot;<A HREF="ch05b.htm#167">Set Up an Event Procedure</A>&quot; after the Quick Guide.</p>

<ol>
<p><li> In Word, start the Visual Basic Editor and then double-click the Class1
project item in the Project Explorer to make it the active window.</li></p>

<p><li> Click <i>App</i> from the Object drop-down list and then select
NewDocument from the Procedures drop-down list in the class module. In the <i>
NewDocument</i> event procedure, add the following code:</li></p>


<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub App_NewDocument(ByVal Doc As Document)
    With Doc.Sections(1).Footers(wdHeaderFooterPrimary).Range
        .InsertDateTime DateTimeFormat:=&quot;M/d/yy h:mm am/pm&quot;, _
            InsertAsField:=False, DateLanguage:=wdEnglishUS
        .InsertBefore Text:=&quot;Created on &quot;
        .Font.Italic = True
    End With
End Sub
</pre>
</td></tr>
</table>
</p>

<p>To insert a footer in Word, use the Footers property to access the footer text
range of the document. You insert the date and time with the <i>InsertDateTime</i>
method on the <i>Range</i> object and you insert the text 'Created on' before the
date and time with the <i>InsertBefore</i> method.</p>

<p><li> In the Project Explorer, double-click the Module1 project item to make it
the active window, place the cursor in the <i>InitEvents</i> procedure, and press
<font size="-2">F5</font>.</li></p>

<p><li> Switch to Word and click the New button on the Standard toolbar. The
text, date, and time are inserted at the bottom left of each page. To view the footer,
click Print Layout on the View menu and scroll down to the bottom of the page.</li></p>
</ol>

<A NAME="171"><h2><i>Set Up the NewWorkbook Event in Excel</i></h2></A>
<p>To insert a header or footer in Excel, you use the PageSetup property on the <i>
Worksheet</i> object to access the <i>PageSetup</i> object. On the <i>PageSetup</i>
object, you use the LeftFooter property to set the footer. Other similar properties are
CenterFooter, RightFooter, LeftHeader, CenterHeader, and RightHeader. To insert text or
the date and time in any header or footer position in Excel, you need to apply header
and footer information to all the worksheets in a workbook.</p>

<p><div class="sidebar"><blockquote><p><i>Before following the steps below, make sure you complete steps 1, 2, and 4 in the
section &quot;<A HREF="ch05b.htm#167">Set Up an Event Procedure</A>&quot; after the Quick Guide.</i></p></blockquote></div>
</p>

<ol>
<p><li> In Excel, start the Visual Basic Editor and then double-click the Class1
project item in the Project Explorer to make it the active window.</li></p>

<p><li> Click <i>App</i> from the Object drop-down list and then select
NewWorkbook from the Procedures drop-down list in the class module. In the <i>
NewWorkbook</i> event procedure, add the following code:</li></p>


<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub App_NewWorkbook(ByVal Wb As Workbook)
    Dim sh As Worksheet
    For Each sh In Wb.Worksheets
        sh.PageSetup _
            .LeftFooter = &quot;&amp;&quot;&quot;Italic,Italic&quot;&quot;Created on &quot; _
            &amp; FormatDateTime(Date$) &amp; _
            &quot; &quot; &amp; FormatDateTime(Time$) 
    Next sh
End Sub
</pre>
</td></tr>
</table>
</p>

<p>Excel doesn't provide the ability to insert the current date and/or time that
are static and don't change. However, you can use the <i>Date$</i> and <i>Time$</i>
functions built into the Visual Basic for Applications language. If you use &amp;D and
&amp;T in the string assigned to the LeftFooter property, the current date and time
will be displayed in the footer whenever you view the footer or print the worksheet.
The string assigned to the LeftFooter property would then appear as follows:
&quot;&amp;&quot;&quot;Italic&quot;&quot;Created on &amp;D &amp;T&quot;.</p>

<p><li> In the Project Explorer, double-click the Module1 project item to make it
the active window, place the cursor in the <i>InitEvents</i> procedure, and press
<font size="-2">F5</font>.</li></p>

<p><li> Switch to Excel and click the New button on the Standard toolbar.</li></p>

<p>When you view a worksheet normally, you won't see the header and footer. Header
and footer information is only displayed in a worksheet's Print Preview mode and on
printed pages. To see or set headers and footers in Excel, click Page Setup on the File
menu and click the Header/Footer tab. In this example, a custom footer is set.
Therefore, to see the custom footer, click the Custom Footer button between the Header
and Footer previews.</p>
</ol>

<p>
<div class="note"><blockquote>
<b>NOTE</b><hr>
Excel also provides an event that is called when you add a new
worksheet to a workbook. The <i>WorkbookNewSheet</i> event procedure is called when you
add a worksheet by clicking Worksheet on the Insert menu. The event procedure is
defined as: 

<p><table cellpadding=5 width="95%"><tr><td>
<pre>Sub App_WorkbookNewSheet(ByVal Wb As Workbook, _
    ByVal Sh As Object)</pre>
</td></tr></table>
</p>
</blockquote></div>
</p>

<A NAME="172"><h2><i>Set Up the NewPresentation Event in PowerPoint</i></h2></A>
<p>In PowerPoint, you add text to the DateTime placeholder, which is located at the
bottom left of the presentation's slide master by default. The index position of
the DateTime placeholder in the <i>Placeholders</i> collection of the
presentation's slide master is 3 by default. If a different default presentation
template is used when you create new presentations, the DateTime placeholder may not
exist. The PowerPoint example in the Print section near the end of this chapter describes how to write a function to determine if a specific placeholder type 
exists in a presentation.</p>

<p><div class="sidebar"><blockquote><p><i>Before following the steps below, make sure you complete steps 1, 2, and 4 in the
section &quot;<A HREF="ch05b.htm#167">Set Up an Event Procedure</A>&quot; after the Quick Guide.</i></p></blockquote></div>
</p>

<ol>
<p><li> In PowerPoint, start the Visual Basic Editor and then double-click the
Class1 project item in the Project Explorer to make it the active window.</li></p>

<p><li> Click <i>App</i> from the Object drop-down list and then select
NewPresentation from the Procedures drop-down list in the class module. In the <i>
NewPresentation</i> event procedure, add the following code:</li></p>


<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub App_NewPresentation(ByVal Pres As Presentation)
    With Pres
        With .SlideMaster.Shapes.Placeholders(3).TextFrame
            .WordWrap = msoFalse
            .AutoSize = ppAutoSizeShapeToFitText
            With .TextRange
                .Text = &quot;&quot;
                .InsertDateTime _
                    DateTimeFormat:=ppDateTimeMMddyyHmm, _
                    InsertAsField:=msoFalse
                .InsertBefore &quot;Created on &quot;
                .Font.Italic = msoTrue
            End With
        End With
    End With
End Sub
</pre>
</td></tr>
</table>
</p>

<p>You use the <i>SlideMaster</i> object, which you access using the SlideMaster
property on the <i>Presentation</i> object, to set footer information on all the slides
in a presentation. All slides, with the exception of title slides, share the same slide
master. If you set the text in a placeholder on the slide master, it applies to all
slides. In the <i>NewPresentation</i> event procedure, you access the DateTime
placeholder on the <i>Shapes</i> collection of the SlideMaster for the new
presentation.</p>

<p><li> In the Project Explorer, double-click the Module1 project item to make it
the active window, place the cursor in the <i>InitEvents</i> procedure, and press
<font size="-2">F5</font>.</li></p>

<p><li> Switch to PowerPoint and click the New button on the Standard
toolbar.</li></p>



<p>To change the text in the Footer or Slide Number placeholder, select Header and
Footer on the View menu and display the Slide tab.</p>
</ol>

<p>
<div class="note"><blockquote>
<b>NOTE</b><hr>
PowerPoint also provides an event that's called when you add
a new slide to a presentation. The <i>PresentationNewSlide</i> event procedure is called when you
add a slide by clicking New Slide on the Insert menu or by pasting it from another
presentation. The event procedure is defined as: 
<p><table cellpadding=5 width="95%"><tr><td>
<pre>Sub App_PresentationNewSlide(ByVal sld As Slide)</pre>
</td></tr></table>
</p>
</blockquote></div>
</p>

</BODY>
</HTML>






