<HTML>
<HEAD>
<TITLE>The Document Print Event</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch05f.htm" , "ch05h.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="190"><h1>The Document Print Event</h1></A>
<p>The procedure for the document Print event is called <i>before</i> a document is
printed. Word, Excel, or PowerPoint will call the document <i>Print</i> event procedure
if it's set up in your program before the document is printed. In Word and Excel,
this event <i>can</i> be cancelled. Therefore, the name of the event is prefixed with
the word <i>Before</i>. In PowerPoint, this event can't be cancelled and thus, the
event name isn't prefixed with <i>Before</i>.</p>

<p>You can print documents using the Print command on the File menu or 
on the Standard toolbar. The <i>PrintOut</i> method on the <i>Document,
Workbook,</i> 
and <i>Presentation</i> objects, described in the <a href="ch04a.htm">previous chapter</a>, also triggers the
document <i>Print</i> event procedure. In PowerPoint, the print event also triggers
when the <i>PrintOut</i> method on the <i>PrintOptions</i> object, accessed from the
<i>Presentation</i> object, is executed.</p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Sub App_DocumentBeforePrint( _
    ByVal Doc As Document, Cancel As Boolean)
Sub App_WorkbookBeforePrint( _
    ByVal Wb As Workbook, Cancel As Boolean)
Sub App_PresentationPrint(ByVal Pres As Presentation)
</pre>
</td></tr>
</table>
</p>

<A NAME="191"><h2>Example Scenario</h2></A>
<p>The following examples for Word, Excel, and PowerPoint are similar to the examples described after the Quick Guide section in the document <i>New</i> event
procedures. When you print a document, the application adds the text &quot;MyCompany
Confidential&quot; to the header at the top left of each page. Because PowerPoint
doesn't support headers on a slide, it adds text to the footer of each slide. The
added text is formatted to be bolded and its font name set to Arial. You can replace the text string &quot;MyCompany&quot; with the name of your company.</p>

<A NAME="192"><h2><i>Set Up the DocumentBeforePrint Event in Word</i></h2></A>
<p>To insert a header in Word, use the Headers property to access the document's
header text range. The text &quot;MyCompany Confidential&quot; is inserted at the top
left of each page. To view the header, click Print Layout on the View menu and scroll
to the top of the page.</p>

<p><div class="sidebar"><blockquote><p><i>Before following the steps below, make sure you complete steps 1, 2, and 4 in the
section &quot;<A HREF="ch05b.htm#167">Set Up an Event Procedure</A>&quot; after the Quick Guide.</i></p></blockquote></div>
</p>

<ol>
<p><li> In Word, start the Visual Basic Editor and then double-click the Class1
project item in the Project Explorer to make it the active window.</li></p>

<p><li> Click <i>App</i> from the Object drop-down list and then select
Document-BeforePrint from the Procedures drop-down list in the class module. In the <i>
DocumentBeforePrint</i> event procedure, add the following code:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Sub App_DocumentBeforePrint( _
    ByVal Doc As Document, Cancel As Boolean)

    With Doc.Sections(1).Headers(wdHeaderFooterPrimary).Range
        .Text = &quot;MyCompany Confidential&quot;
        With .Font
            .Bold = True
            .Name = &quot;Arial&quot;
        End With
    End With
End Sub
</pre>
</td></tr>
</table>
</p>

<p><li> In the Project Explorer, double-click the Module1 project item to make it
the active window, place the cursor in the <i>InitEvents</i> procedure, and press
<font size="-2">F5</font>.</li></p>

<p><li> Switch to Word and click New on the Standard toolbar to create a new
document.</li></p>

<p><li> Add some text to the document and click the Print option on the File menu.</li></p>
</ol>

<A NAME="193"><h2><i>Set Up the WorkbookBeforePrint Event in Excel</i></h2></A>
<p>In Excel, to insert a header or footer you use the PageSetup property on the <i>
Worksheet</i> object to access the <i>PageSetup</i> object. On the <i>PageSetup</i>
object, you use the LeftHeader property to set the header. To insert text in any header
or footer position, you need to apply header and footer information to all the
worksheets in a workbook.</p>


<p><div class="sidebar"><blockquote><p><i>Before following the steps below, make sure you complete steps 1, 2, and 4 in the
section &quot;<A HREF="ch05b.htm#167">Set Up an Event Procedure</A>&quot; after the Quick Guide.</i></p></blockquote></div>
</p>

<ol>
<p><li> In Excel, start the Visual Basic Editor and then double-click the Class1
project item in the Project Explorer to make it the active window.</li></p>

<p><li> Click <i>App</i> from the Object drop-down list and then select
Workbook-BeforePrint from the Procedures drop-down list in the class module. In the <i>
WorkbookBeforePrint</i> event procedure, add the following code:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub App_WorkbookBeforePrint( _
    ByVal Wb As Workbook, Cancel As Boolean)

    Dim sh As Worksheet
    For Each sh In Wb.Worksheets
        sh.PageSetup.LeftHeader = _
            &quot;&amp;&quot;&quot;Arial,Bold&quot;&quot;MyCompany Confidential&quot;
    Next sh
End Sub
</pre>
</td></tr>
</table>
</p>

<p><li> In the Project Explorer, double-click the Module1 project item to make it
the active window, place the cursor in the <i>InitEvents</i> procedure, and then press
<font size="-2">F5</font>.</li></p>

<p><li> Switch to Excel and click New on the Standard toolbar to create a new
workbook.</li></p>

<p><li> Add some text to the workbook and click the Print button on the File menu.</li></p>
</ol>

<p>As described in the <i>New</i> event procedure for Excel earlier in this chapter,
when you view a worksheet normally, you don't see the header and footer. You only
see header and footer information when the worksheet is in Print Preview mode or when
it's printed. To see or set headers and footers in Excel, click Page Setup on the
File menu and click the Header/Footer tab. In this example, a custom header is set.
Therefore, to see the custom header, click the Custom Header button between the Header
and Footer previews.</p>

<A NAME="194"><h2><i>Set Up the PresentationPrint Event in PowerPoint</i></h2></A>
<p>In this procedure, PowerPoint adds the text &quot;MyCompany Confidential&quot; to
the Footer placeholder, which is located at the bottom center of the presentation's
slide master by default. The index position of the Footer placeholder in the <i>
Placeholders</i> collection of the presentation's slide master is 4 by default. You
use the <i>SlideMaster</i> object, accessed through the SlideMaster property on the <i>
Presentation</i> object, to set footer information on all the slides in a presentation.
All slides, with the exception of title slides, share the same slide master. If you set
the text in a placeholder on the slide master, it applies to all slides.</p>

<p><div class="sidebar"><blockquote><p><i>Before following the steps below, make sure you complete the steps 1, 2, and 4 in
the section &quot;<A HREF="ch05b.htm#167">Set Up an Event Procedure</A>&quot; after the Quick Guide.</i></p></blockquote></div>
</p>

<ol>
<p><li> In PowerPoint, start the Visual Basic Editor and then double-click the
Class1 project item in the Project Explorer to make it the active window.</li></p>

<p><li> Click <i>App</i> from the Object drop-down list and then select
PresentationPrint from the Procedures drop-down list in the class module. In the <i>
PresentationPrint</i> event procedure, add the following code:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub App_PresentationPrint(ByVal Pres As Presentation)
    With Pres
        With .SlideMaster.HeadersFooters.Footer
            .Text = &quot;MyCompany Confidential&quot;
            .Visible = msoTrue
        End With
        With .SlideMaster.Shapes.Placeholders(4) _
                .TextFrame.TextRange.Font
            .Bold = msoTrue
            .Name = &quot;Arial&quot;
        End With
    End With
End Sub
</pre>
</td></tr>
</table>
</p>

<p><li> In the Project Explorer, double-click the Module1 project item to make it
the active window, place the cursor in the <i>InitEvents</i> procedure, and then press
<font size="-2">F5</font>.</li></p>

<p><li> Switch to PowerPoint and click New on the Standard toolbar to create a
new presentation.</li></p>

<p><li> Add some text to the presentation and click the Print button on the File
menu.</li></p>
</ol>

<p>In the preceding <i>PresentationPrint</i> event procedure, the Footer placeholder is
accessed on the <i>Shapes</i> collection of the SlideMaster for the presentation. To
change the text of this placeholder or any other placeholder on a slide master, select
Header and Footer on the View menu and display the Slide tab.</p>

<A NAME="195"><h3>When the Placeholder Doesn't Exist</h3></A>
<p>The index position of the Footer placeholder in the <i>Placeholders</i> collection
of the presentation's slide master is 4 by default. For example, the <i>Print</i>
event procedure you added in the code example above uses the value of 4. However, if
the presentation template applied to the presentation doesn't contain the Footer
placeholder on the slide master, or if the user deleted the Footer placeholder on the
slide master, you use the custom function <i>PlaceholderShape</i> to determine if a
specific placeholder type exists in a presentation and, if it doesn't, to put the
placeholder back in the presentation.</p>

<p>To make the document <i>Print</i> event procedure in PowerPoint more robust, you revise
the <i>Print</i> event procedure with four lines added below the With Pres statement.
The first line declares the variable <i>shpPlaceholder</i>, which is set to the return
value of the custom <i>PlaceholderShape</i> function. This function returns the <i>
Shape</i> object representing the Footer placeholder. You clear the Footer
placeholder's text by setting the TextRange property to an empty string
(&quot;&quot;). Note also the change in the With statement in the last With&#8230End
block in the event procedure. This With&#8230End block sets the font attributes in the
placeholder. You use the <i>shpPlaceholder</i> variable in place of <font face="courier new" size="-1">.SlideMaster.Shapes
_.Placeholders(4)</font>.</p>

<A NAME="196"><h2><i>Retrieve or Add a Placeholder Shape</i></h2></A>
<ol>
<p><li> Replace the code in the <i>PresentationPrint</i> event procedure added
in the previous code example with the following <i>PresentationPrint</i> event
procedure. Also add the custom function <i>PlaceholderShape</i> after the event
procedure.</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub App_PresentationPrint(ByVal Pres As Presentation)
    With Pres
        Dim shpPlaceholder As Shape
        Set shpPlaceholder = PlaceholderShape( _
            .SlideMaster.Shapes, ppPlaceholderFooter, True)
        shpPlaceholder.TextFrame.TextRange = &quot;&quot;

        With .SlideMaster.HeadersFooters.Footer
            .Text = &quot;MyCompany Confidential&quot;
            .Visible = msoTrue
        End With
        With shpPlaceholder.TextFrame.TextRange.Font
            .Bold = msoTrue
            .Name = &quot;Arial&quot;
        End With
    End With
End Sub

Function PlaceholderShape(shpColl As Shapes, _
    iType As PpPlaceholderType, _
    bAddPlaceholderIfMissing As Boolean) As Shape

   Dim shpPlaceHolder As Shape
    For Each shpPlaceHolder In shpColl.Placeholders
        If shpPlaceHolder.PlaceholderFormat.Type = iType Then
            Set PlaceholderShape = shpPlaceHolder
            Exit Function
        End If
    Next shpPlaceHolder
    If bAddPlaceholderIfMissing Then
        Set PlaceholderShape = _
            shpColl.AddPlaceholder(Type:=iType)
    End If
End Function
</pre>
</td></tr>
</table>
</p>

<p><li> In the Project Explorer, double-click the Module1 project item to make it
the active window, place the cursor in the <i>InitEvents</i> procedure, and then press
<font size="-2">F5</font>.</li></p>

<p><li> Switch to PowerPoint and display the slide master by clicking Master on
the View menu and then Slide Master from the submenu. In the slide master, delete the
Footer placeholder.</li></p>

<p><li> Click the Print button on the File menu.</li></p>
</ol>

<p>Because the <i>PlaceholderShape</i> function is generic, you can use it to determine
if a specific type of placeholder exists on a slide and, if it doesn't, to add the
placeholder to the slide or slide master. You need to pass three arguments to the
function. The first is the <i>Shapes</i> collection of the slide or slide master on
which you want to search for a specific type of placeholder. The second argument is the
placeholder type you want to search for. And the third argument is a Boolean indicating
whether the placeholder shape should be added if it doesn't exist in the <i>
Shapes</i> collection.</p>

<p>In this example, the Footer placeholder will be replaced once the <i>
PresentationPrint</i> event procedure is executed. The <a href="ch06a.htm">next chapter</a> provides a full
description of placeholders in PowerPoint.</p>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>






