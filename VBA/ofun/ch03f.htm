<HTML>
<HEAD>
<TITLE>Integrating the Office Assistant into Wizards</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch03e.htm" , "ch03g.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="106"><h1>Integrating the Office Assistant into Wizards</h1></A>
<p>Most of the wizards in Office now have a toggle button alongside the Cancel,
Previous, Next, and Finish navigation buttons in the wizard dialog box. When you press
the toggle button you display the Office Assistant, which displays in its balloon a tip
for the current step in the wizard. Tips are often helpful the first few times you use
a wizard; but once you're familiar with it, you may no longer need them. The
Assistant provides an easy method for creating helpful steps by displaying tips that
you don't have to add directly on the wizard UserForm. In that way, using the
Assistant helps prevent your wizard from appearing cluttered.</p>

<A NAME="107"><h2><i>Add the Assistant Button</i></h2></A>
<ol>
<p><li>Click the frmWizard project item and then click the View Object button in
the Project Explorer.</li></p>

<p><img src="images/W-BTN24.JPG" width=27 height=25 border="0"><br><i>View Object</i></p>

<p><li>Click the ToggleButton control in the Toolbox and then click the
frmWizard UserForm to the left of the Cancel button.</li></p>

<p><img src="images/W-BTN33.JPG" width=27 height=25 border="0"><br><i>ToggleButton control</i></p>

<p><li>In the Properties window, remove the text from the Caption property so
that no caption is displayed, and change the Name property to tglAssistant. (The prefix
<i>tgl</i> represents &quot;toggle.&quot;)</li></p>



<p><li>Click the Picture property, and then click the ellipsis button in the
right column to display the Load Picture dialog box. Change to the Chapter 3 practice
folder and select the bitmap file Assistnt.bmp. Click Open.</li></p>

<p><img src="images/ELIPSES.JPG" width=27 height=25 border="0"><br><i>Ellipsis</i></p>

<p><li>Resize the tglAssistant ToggleButton control so its height is the same as
that of the other navigation buttons and its width equals its height, as shown in the
illustration below.</li></p>

<p>
<img src="images/G03ovb26.JPG" width=379 height=240 border=0>


<p><li>Run the UserForm and click the tglAssistant ToggleButton control. When
you first click it, the control stays pressed. To return the toggle button to its
initial state, click it again.</li></p>
</ol>

<p>Now that you've added the Assistant toggle button to your wizard, you need to
write the code that will determine the current step in the wizard and display the
appropriate tip when the user clicks the Assistant button.</p>

<A NAME="108"><h2><i>Make the Assistant Display a Tip</i></h2></A>
<ol>
<p><li>Close and unload the frmWizard UserForm by clicking the Cancel or Finish
button.</li></p>

<p><li>In the Project Explorer, right-click the Energy Wizard project, and then
click Import File on the shortcut menu. In the Import File dialog box, change to the
Chapter 3 practice folder and select the file modAsst.bas. Click Open.</li></p>
<p>The file modAsst.bas contains all the code that will display tips in the Assistant
balloon and close it when necessary. In the following steps, you'll add calls to
procedures in the standard code module you just imported. The module name is
modAssistant.</p>



<p><li>Select the frmWizard project item and then click the View Code button in
the leftmost corner of the Project Explorer toolbar.</li></p>

<p><img src="images/W-BTN23.JPG" width=27 height=25 border="0"><br><i>View Code</i></p>

<p><li>In the Object drop-down list of the frmWizard Code window, select
UserForm. In the <i>UserForm_Initialize</i> event procedure, add the call to the <i>
VisibleCheck</i> procedure so that the procedure appears as follows:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub UserForm_Initialize()
    m_iTotalSteps = mpgSteps.Pages.Count
    m_sCurStep = &quot;Start&quot;
    mpgSteps.Value = 0
    mpgSteps_Change
    modAssistant.VisibleCheck
End Sub
</pre>
</td></tr>
</table>
</p>

<p>Before the wizard is displayed, the Assistant's visible state is determined in
the <i>VisibleCheck</i> procedure in the modAssistant module. This procedure also
contains code that handles cases where the Assistant isn't installed; if this is
the case, the Assistant button is disabled.</p>
<p><li>On the frmWizard UserForm, double-click the tglAssistant ToggleButton
control. In the <i>tglAssistant_Click</i> event procedure, add the following code:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
modAssistant.ToggleAssistant
</pre>
</td></tr>
</table>
</p>
<p>The <i>ToggleAssistant</i> procedure determines the value of the tglAssistant
ToggleButton control and then decides whether to display or hide the Assistant.</p>

<p><li>In the Object drop-down list of the frmWizard Code window, select
mpgSteps. In the <i>mpgSteps_Change</i> event procedure, add the following If&#8230;Then
condition block after the call to the <i>SetSubway</i> procedure:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
If tglAssistant.Value = True Then
    modAssistant.SetBalloonText
End If
</pre>
</td></tr>
</table>
</p>
<p>Each time the page changes in the wizard, the program evaluates the value of the
Assistant button. If the button is clicked, the program calls the <i>SetBalloonText</i>
procedure and the tip for the current step is displayed in the Assistant balloon.</p>

<p><li>Finally, in the Object drop-down list of the frmWizard Code window,
select cmdCancel and add the following code to the <i>cmdCancel_Click</i> event
procedure, so that the procedure appears as follows:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub cmdCancel_Click()    
   If tglAssistant.Value = True Then
        modAssistant.CloseBalloon
   End If
   Unload Me
End Sub
</pre>
</td></tr>
</table>
</p>

<p>Repeat this step but select cmdFinish from the Object drop-down list. Copy the
identical code from within the <i>cmdCancel_Click</i> event procedure to the <i>
cmdFinish_Click</i> event procedure. Later, when you extend the wizard to perform some
operation in your program, add a line of code that calls a new procedure to conduct
that action. Add the new line after the line Unload Me in the <i>cmdFinish_Click</i>
event procedure.</p>

<p>The If&#8230;Then condition block determines whether the Assistant balloon is
displaying a wizard tip by evaluating the value of the tglAssistant ToggleButton
control. If the toggle button is clicked (in the up position), the Assistant balloon is
closed.</p>

<p><li>Press <font size="-2">F5</font> to run the wizard and then click the Assistant button to display
the tip for the current step.</li></p>

<p>The Assistant balloon should appear and the tip &quot;Start&quot; should appear,
which represents the tip for the currently active step. Click the Next button to see
the next tip and continue through the steps to see the Assistant balloon being updated
to reflect the current step.</p>
<p>
<A HREF="javascript:fullSize('G03ovb27x.htm')"> <img src="images/G03ovb27.JPG" width=404 height=173 border=0 ALT = "Click to view at full size."> </A>
</p>


<p><li>Close and unload the frmWizard UserForm by clicking the Cancel or Finish
button.</li></p>

<p><li>Right-click the frmWizard project item in the Project Explorer and then
click Export File on the shortcut menu. In the Export File dialog box, change to the
Chapter 3 practice folder, and in the File Name text box, type the name <b>
frmWizardTemplateAssistant</b> and click Save.</li></p>
</ol>

<p>The wizard UserForm with navigation buttons, subway map, and Assistant integration
is complete. In step 10, you exported the UserForm so that you can use it as a starting
point when you create a new wizard with a subway map and the Office Assistant.</p>

<p>
<div class="tip"><blockquote><b>TIP</b><hr>
The contents of all three UserForms that you saved in this
chapter&#8212;frmWizardTemplateBasic, frmWizardTemplateSubway, and
frmWizardTemplate-Assistant&#8212;are also provided in the Chapter 3 practice folder of
the practice files CD-ROM. The files are named frmBasic, frmSubwy, and
frmAsst.</blockquote></div>
</p>

</BODY>
</HTML>






