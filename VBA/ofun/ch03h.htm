<HTML>
<HEAD>
<TITLE>Using Dialog Boxes from Windows</TITLE>
<link rel="STYLESHEET" type="text/css" href="Library.css">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<SCRIPT LANGUAGE="JavaScript">
<!--

function fullSize(sURL){
	window.open(sURL,'scrshot','width=500,height=375,top=20,left=20,directories=no , Toolbar = no, resizable = yes, menubar = no, ScrollBars = yes ');
}

function LibraryHeaderNav(sBackward, sForward, sImgLeftOff, sImgLeftOn, sImgRightOff, sImgRightOn, iH, iW, sImgLeftStyle, sImgRightStyle, sImgRuleStyle, sRuleColor, sRuleSize){
	var tableStr;
	//validate questionable args for defs
	tableStr = "<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 border=0 width=100%>";
	tableStr += "<TR VALIGN=top ALIGN=right>";

	tableStr += "<TD align=right class=" + sImgRuleStyle + ">&nbsp;</TD>";	
	
	tableStr += "<TD width=34 align=right class=" + sImgLeftStyle + ">";
	tableStr += "<A href='" + sBackward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgLeftOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgLeftOff + '\'\"';
	tableStr += " SRC='" + sImgLeftOff + "' vspace=0 hspace=0></a></TD>";
	
	tableStr += "<TD width=34 align=left class=" + sImgRightStyle + ">";
	tableStr += "<A href='" + sForward + "'>";
	tableStr += "<IMG HEIGHT=" + iH + " WIDTH=" + iW + " BORDER=0";
	tableStr += ' OnMouseOver=\"this.src=\'' + sImgRightOn + '\'\"';
	tableStr += ' OnMouseOut=\"this.src=\'' + sImgRightOff + '\'\"';
	tableStr += " SRC='" + sImgRightOff + "' vspace=0 hspace=0></a></TD></TR>";

	tableStr += "<TR VALIGN=top>";
	tableStr += "<TD height=3 align=center colspan=3 class=" + sImgRuleStyle + ">";
	tableStr += "<HR color=" + sRuleColor + " size=" + sRuleSize + "></TD></TR></TABLE>";
	//alert(tableStr);
	document.write(tableStr);
}

 																						     //purple is: #aa22aa   orange is: #ff9900
LibraryHeaderNav("ch03g.htm" , "ch03i.htm", "images/unit_o_a1.gif", "images/unit_o_a2.gif", "images/unit_o_b1.gif", "images/unit_o_b2.gif", 18, 34, "unit01", "unit02", "headerrule", "#ff9900", "2");
//--></SCRIPT>

<A NAME="113"><h1>Using Dialog Boxes from Windows</h1></A>
<p>In order to save developers who are writing applications for Windows from having to
create certain dialog boxes from scratch, Windows provides a set of common dialog
boxes. Among them are the File dialog box, which you use to open, save, or browse for
files on your computer or computer network; the Browse For Folder dialog box, which you
use to specify a folder name; and the Color dialog box, which allows you to choose a
specific color.</p>

<p>In the wizard you're creating, you'll take advantage of the File and Browse
For Folder dialog boxes. The code provided in the practice files allows you to use
these dialog boxes without knowing too much about the code itself, which uses more
advanced Windows-based programming techniques. You can learn more about the specifics
of this code and Windows programming using the Visual Basic programming language by
referring to books on the Visual Basic and Windows application programming interfaces
(APIs).</p>

<A NAME="114"><h2><i>Add a Common Windows Dialog Box to Your Wizard</i></h2></A>
<ol>
<p><li>In the Project Explorer, right-click the Energy Wizard project and click
Import File on the shortcut menu. In the Import File dialog box, change to the Chapter 3 practice folder and select the file modFlDlg.bas. Click
Open.</li></p>

<p>The file modFlDlg.bas contains code that allows you to display the Windows system
File dialog box, which is the same dialog box as the Import File dialog box you just
used. The name of the imported standard module is modFileDialog, and it also contains a
user-defined type that you can use to set properties such as the caption in the title
bar of the File dialog box.</p>

<p><li>Click within the MultiPage control and select pgStep1 Page from the
drop-down list in the Properties window. Double-click the first Browse button and add
the following code to the <i>cmdBrowse_Click</i> event procedure, so that the procedure
appears as follows:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub cmdBrowse_Click()
    Dim sFileName As String
    Dim udtFileDialog As FileDialog   
    With udtFileDialog
        .CustomFilter = &quot;Access Database (*.mdb)&quot; &amp; - 
            Chr$(0) &amp; &quot;*.mdb&quot; &amp; Chr$(0) &amp; Chr$(0)
        .DefaultExt = &quot;*.mdb&quot;
        .Title = &quot;Browse&quot;
        sFileName = modFileDialog - 
            .WinFileDialog(udtFileDialog, 1)
    End With
    If Len(sFileName) &gt; 0 Then
        txtDataSource.Text = sFileName
    End If
End Sub
</pre>
</td></tr>
</table>
</p>

<p>The variable <i>udtFileDialog</i> is declared as the user-defined type FileDialog,
which is declared as public in the modFileDialog module. You use the user-defined type
to set the filters that are displayed in the Files Of Type drop-down list in the File
dialog box.</p>

<p>The default extension is then set to the filter extension that the Files Of Type
drop-down list will display first. When you click the cmdBrowse control, you use the
Access Database type filter. The title bar caption of the File dialog box is set to the
text &quot;Browse.&quot;</p>

<p>When you display the dialog box, the folder you'll see by default is the most
recently used folder. The section <A HREF="ch04b.htm#119">File Management</A> in Chapter 4 describes how to set
which folder is initially displayed in this dialog.</p>

<p>The value of sFileName is then set to the value returned by the function <i>
WinFileDialog</i>, which displays the File dialog box. The If&#8230;Then condition block
determines whether you clicked Cancel in the File dialog box or selected a valid file
and clicked Open. If you selected a valid file, the program enters its full path in the
txtDataSource text box. If you clicked Cancel, the value of sFileName is an empty
string.</p>

<p><li>In the Object drop-down list of the module, select cmdBrowseTemplate and
copy the same code to the <i>cmdBrowseTemplate_Click</i> event procedure that you added
in the previous step to the <i>cmdBrowse_Click</i> event procedure. Change the two
lines setting the value of CustomFilter and DefaultExt to the following:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
.CustomFilter = &quot;Document Template (*.dot)&quot; &amp; - 
    Chr$(0) &amp; &quot;*.dot&quot; &amp; Chr$(0) &amp; Chr$(0)
.DefaultExt = &quot;*.dot&quot;
</pre>
</td></tr>
</table>
</p>

<p>When you click the cmdBrowseTemplate control, the filters used are of the Document
Template type.</p>

<p><li>Change the line <font face="courier new" size="-1">txtDataSource.Text = sFileName</font> 
in the <i>
cmdBrowseTemplate_Click</i> event procedure to:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
txtTemplate.Text = sFileName
</pre>
</td></tr>
</table>
</p>

<p>If a valid file was selected, its full path is entered in the txtDataSource text
box.</p>

<p><li>Select pgStep2 Page from the drop-down list in the Properties window and
then select cmdBrowseFolder from the drop-down list in the Properties window. Add the
following code to the <i>cmdBrowseFolder_Click</i> event procedure:</li></p>

<p>
<table cellpadding=5 width="95%"><tr><td>
<pre>
Private Sub cmdBrowseFolder_Click()
    Dim sPath As String    
    sPath = modBrowseFolder.BrowseForFolder
    If Len(sPath) &gt; 0 Then
        txtDestination.Text = sPath
    End If
End Sub
</pre>
</td></tr>
</table>
</p>

<p>The function <i>BrowseForFolder</i> in the modBrowseFolder module displays the
Windows system Browse For Folder dialog box shown below. (Your Browse
For Folder dialog box will look different.)</p>

<p><li>In the Project Explorer, right-click the Energy Wizard project and click
Import File on the shortcut menu. In the Import File dialog box, change to the Chapter
3 practice folder and select the file modBrwse.bas. Click Open.</li></p>

<p>The file modBrwse.bas contains code that allows you to display the Windows system
Browse For Folder dialog box. The name of the imported standard module is
modBrowseFolder.</p>

<p>
<img src="images/G03ovb33.JPG" width=324 height=331 border=0>


<p><li>Click the frmWizard project item and then click the View Object button in
the Project Explorer to display the wizard UserForm.</li></p>

<p><img src="images/W-BTN24.JPG" width=27 height=25 border="0"><br><i>View Object</i></p>

<p><li>Press <font size="-2">F5</font> to run the wizard. Step through the wizard and click each of the Browse buttons in the steps. The wizard now allows you to find the files.</li></p>

<p><li>Close and unload the frmWizard UserForm by clicking the Cancel or Finish
button.</li></p>

<p><li>Right-click the frmWizard project item in the Project Explorer and then
click Export File on the shortcut menu. In the Export File dialog box, change to the
Chapter 3 practice folder, and in the File Name text box, type the name <b>
frmWizardComplete</b> and click Save.</li></p>
</ol>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>






